<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="javascript奇妙的变量类型安全问题"><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>javascript奇妙的变量类型安全问题 | Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E6%B1%A1%E6%9F%93%E9%97%AE%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">变量类型污染问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#js%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">js数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#json%E5%8F%AF%E4%BB%A5%E5%8F%91%E9%80%81%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">json可以发送的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BF%90%E7%AE%97"><span class="toc-number">1.1.2.</span> <span class="toc-text">加运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E5%90%84%E7%A7%8D%E5%B0%8Ftrick"><span class="toc-number">1.1.3.</span> <span class="toc-text">js各种小trick</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#javascript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">2.</span> <span class="toc-text">javascript原型链污染</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.</span> <span class="toc-text">三种属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#proto"><span class="toc-number">2.1.1.</span> <span class="toc-text">__proto__</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prototype%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.2.</span> <span class="toc-text">prototype属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#constructor%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.3.</span> <span class="toc-text">constructor属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE"><span class="toc-number">2.2.</span> <span class="toc-text">原型链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">2.3.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#javascript%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">javascript基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.</span> <span class="toc-text">传输数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-req-params-req-query-req-body"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.req.params&#x2F;req.query&#x2F;req.body</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">3.2.</span> <span class="toc-text">定义变量</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">177</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">javascript奇妙的变量类型安全问题</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-02</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="变量类型污染问题"><a href="#变量类型污染问题" class="headerlink" title="变量类型污染问题"></a>变量类型污染问题</h1><h2 id="js数据类型"><a href="#js数据类型" class="headerlink" title="js数据类型"></a>js数据类型</h2><p><strong>值类型(基本类型)</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">字符串，数字，布尔，对空，未定义，symbol(es6引入一种新的原始数据类型，表示独一无二的值)</span><br></pre></td></tr></table></figure>

<p><strong>引用数据类型</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">对象(object)，数组(array)，函数(function)</span><br></pre></td></tr></table></figure>

<p><strong>对象</strong><br>花括号分割，在括号内部，对象的属性以名称和值对的形式(name : value)来定义<br>属性由逗号分割:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">var person&#x3D;&#123;firstname:&quot;John&quot;,lastname:&quot;Doe&quot;&#125;</span><br><span class="line">此时对象person有三个属性，firstname,lastname</span><br></pre></td></tr></table></figure>

<p><strong>对象属性寻址方式</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;person.lastname;</span><br><span class="line">name&#x3D;person[&quot;lastname&quot;];</span><br></pre></td></tr></table></figure>

<h3 id="json可以发送的数据"><a href="#json可以发送的数据" class="headerlink" title="json可以发送的数据"></a>json可以发送的数据</h3><p>JSON 值可以是：</p>
<ul>
<li><p>数字（整数或浮点数）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">1 #typeof number</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串（在双引号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">&quot;a&quot;#typeof  string</span><br></pre></td></tr></table></figure>
</li>
<li><p>逻辑值（true 或 false）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">true#typeof boolean</span><br></pre></td></tr></table></figure>
</li>
<li><p>数组（在中括号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">[&quot;a&quot;,&quot;b&quot;]#typeof object</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象（在大括号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">&#123;&quot;name&quot;: &quot;Tom&quot;,&quot;Grade&quot;:1, &quot;age&quot;:11, &quot;gender&quot;: &quot;M&quot;&#125; #typeof object</span><br></pre></td></tr></table></figure>
</li>
<li><p>null</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">null#typeof object</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="加运算"><a href="#加运算" class="headerlink" title="加运算"></a>加运算</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">字符串+字符串依然得到字符串</span><br><span class="line">字符串+数组也是，其他都是</span><br><span class="line">但如果不是字符串相加，则为</span><br><span class="line">true+true&#x3D;2#因为true为1</span><br><span class="line">基本上除了Number+Number&#x3D;Number，Bool+Bool&#x3D;Number</span><br></pre></td></tr></table></figure>

<h3 id="js各种小trick"><a href="#js各种小trick" class="headerlink" title="js各种小trick"></a>js各种小trick</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">一个正数的负大数次方为0，负数的则为-0</span><br><span class="line">NaN和NaN不相等</span><br><span class="line">e++&lt;e--肯定满足；做比较时true为1,false为0</span><br><span class="line">任何非空字符串都为真,js中两个等号为弱类型判断</span><br><span class="line">string(大数)返回Infinity;json.parse()可以处理数字</span><br><span class="line">in对数组来说是判断数组的key</span><br><span class="line">括号json.parse()基本一样效果;json.parse()可以解析__proto__</span><br><span class="line">对null变量进行数组寻址会报错，并且null变量为object</span><br></pre></td></tr></table></figure>

<h1 id="javascript原型链污染"><a href="#javascript原型链污染" class="headerlink" title="javascript原型链污染"></a>javascript原型链污染</h1><h2 id="三种属性"><a href="#三种属性" class="headerlink" title="三种属性"></a>三种属性</h2><p>1.__proto__和constructor属性是对象所独有的:<br>2.prototype属性是函数所独有</p>
<p>但是由于JS中函数也是一种对象，所以函数也拥有__proto__和constructor属性</p>
<h3 id="proto"><a href="#proto" class="headerlink" title="__proto__"></a>__proto__</h3><p><strong>proto属性是对象所独有的</strong></p>
<p><strong>作用：</strong>当访问一个对象的属性时，如果该对象内部不存在这个属性，那么他就会去它的proto属性所指向的那个对象（理解为父对象），如果父对象也没有，则在往上找，如果一直到原型链顶端都没有该属性，就会报错</p>
<p>这种通过__proto__属性来连接对象直到null的一条链即为我们所谓的原型链。其实我们平时调用的字符串方法、数组方法、对象方法、函数方法等都是靠__proto__继承而来的。</p>
<h3 id="prototype属性"><a href="#prototype属性" class="headerlink" title="prototype属性"></a>prototype属性</h3><p>它是函数所独有的，是从函数指向对象，并且是函数的原型对象，也就是这个函数（其实所有函数都可以作为构造函数）所创建的实例的原型对象，由此可知</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">f1.__proto__&#x3D;&#x3D;Foo.prototype</span><br></pre></td></tr></table></figure>

<p>**作用:**包含可以由特定类型的所有实例所共享的属性和方法，也就是让该函数所实例化的对象们都可以找到公用的属性和方法，任何函数在创建的时候，其实会默认同时创建该函数的prototype对象</p>
<h3 id="constructor属性"><a href="#constructor属性" class="headerlink" title="constructor属性"></a>constructor属性</h3><p>它是对象才拥有的，他是从一个对象指向一个函数，含义就是指向该对象的构造函数，每个对象都有构造函数</p>
<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>eg:<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005134652.png" alt="img" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var a &#x3D; &#123;&#125;;</span><br><span class="line">console.log(a.__proto__); &#x2F;&#x2F;Object &#123;&#125;</span><br><span class="line">console.log(a.__proto__ &#x3D;&#x3D;&#x3D; a.constructor.prototype); &#x2F;&#x2F;true</span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>1.我们需要牢记两点：①__proto__和constructor属性是对象所独有的；②prototype属性是函数所独有的，因为函数也是一种对象，所以函数也拥有__proto__和constructor属性。</p>
<p>2.__proto__属性的作用就是当访问一个对象的属性时，如果该对象内部不存在这个属性，那么就会去它的__proto__属性所指向的那个对象（父对象）里找，一直找，直到__proto__属性的终点null，再往上找就相当于在null上取值，会报错。通过__proto__属性将对象连接起来的这条链路即我们所谓的原型链。</p>
<p>3.prototype属性的作用就是让该函数所实例化的对象们都可以找到公用的属性和方法，即f1.<strong>proto</strong> === Foo.prototype。(意思是让f1可以找到公用的属性方法，即向上找有prototype给他)</p>
<p>4.constructor属性的含义就是指向该对象的构造函数，所有函数（此时看成对象了）最终的构造函数都指向Function。</p>
<h1 id="javascript基础语法"><a href="#javascript基础语法" class="headerlink" title="javascript基础语法"></a>javascript基础语法</h1><h2 id="传输数据"><a href="#传输数据" class="headerlink" title="传输数据"></a>传输数据</h2><h3 id="1-req-params-req-query-req-body"><a href="#1-req-params-req-query-req-body" class="headerlink" title="1.req.params/req.query/req.body"></a>1.req.params/req.query/req.body</h3><p><strong>req.params</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:&#x2F;modify&#x2F;:file</span><br><span class="line">&#x2F;modify&#x2F;index</span><br><span class="line">那么req.params.file&#x3D;index</span><br></pre></td></tr></table></figure>

<p><strong>req.query</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">?id&#x3D;2</span><br><span class="line">那么req.query.id那么就可以得到2</span><br></pre></td></tr></table></figure>

<p><strong>req.body(针对post请求)</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">post:username&#x3D;adbc</span><br><span class="line">req.body.username&#x3D;adbc</span><br></pre></td></tr></table></figure>

<h2 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h2><p><strong><code>const</code>:</strong> 用于定义不可变变量<br>**<code>var</code> 声明语句<strong>声明一个变量，并可选地将其初始化为一个值<br>**<code>process.env</code></strong>:返回包含用户环境的对象</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">vague huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2021/10/02/javascript奇妙的变量类型安全问题/">http://example.com/2021/10/02/javascript奇妙的变量类型安全问题/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/10/05/TSG2021/"><i class="fa fa-chevron-left">  </i><span>TSG2021+0ctf</span></a></div><div class="next-post pull-right"><a href="/2021/09/30/%E7%BB%BF%E5%9F%8E%E6%9D%AF/"><span>2021绿城杯</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>