<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>javascript奇妙的变量类型安全问题 - Tlife</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tlife"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tlife"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="变量类型污染问题js数据类型值类型(基本类型): 字符串，数字，布尔，对空，未定义，symbol(es6引入一种新的原始数据类型，表示独一无二的值)  引用数据类型: 对象(object)，数组(array)，函数(function)  对象花括号分割，在括号内部，对象的属性以名称和值对的形式(name : value)来定义属性由逗号分割: eg:var person&amp;#x3D;&amp;amp;#123;fi"><meta property="og:type" content="article"><meta property="og:title" content="javascript奇妙的变量类型安全问题"><meta property="og:url" content="http://example.com/2021/10/02/javascript%E5%A5%87%E5%A6%99%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"><meta property="og:site_name" content="Tlife"><meta property="og:description" content="变量类型污染问题js数据类型值类型(基本类型): 字符串，数字，布尔，对空，未定义，symbol(es6引入一种新的原始数据类型，表示独一无二的值)  引用数据类型: 对象(object)，数组(array)，函数(function)  对象花括号分割，在括号内部，对象的属性以名称和值对的形式(name : value)来定义属性由逗号分割: eg:var person&amp;#x3D;&amp;amp;#123;fi"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005134652.png"><meta property="article:published_time" content="2021-10-02T15:58:26.000Z"><meta property="article:modified_time" content="2021-10-05T11:15:33.885Z"><meta property="article:author" content="vague huang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005134652.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/10/02/javascript%E5%A5%87%E5%A6%99%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"},"headline":"javascript奇妙的变量类型安全问题","image":["https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005134652.png"],"datePublished":"2021-10-02T15:58:26.000Z","dateModified":"2021-10-05T11:15:33.885Z","author":{"@type":"Person","name":"vague huang"},"publisher":{"@type":"Organization","name":"Tlife","logo":{"@type":"ImageObject"}},"description":"变量类型污染问题js数据类型值类型(基本类型): 字符串，数字，布尔，对空，未定义，symbol(es6引入一种新的原始数据类型，表示独一无二的值)  引用数据类型: 对象(object)，数组(array)，函数(function)  对象花括号分割，在括号内部，对象的属性以名称和值对的形式(name : value)来定义属性由逗号分割: eg:var person&#x3D;&amp;#123;fi"}</script><link rel="canonical" href="http://example.com/2021/10/02/javascript%E5%A5%87%E5%A6%99%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Tlife</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-10-02T15:58:26.000Z" title="2021/10/2 下午11:58:26">2021-10-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-10-05T11:15:33.885Z" title="2021/10/5 下午7:15:33">2021-10-05</time></span></div></div><h1 class="title is-3 is-size-4-mobile">javascript奇妙的变量类型安全问题</h1><div class="content"><h1 id="变量类型污染问题"><a href="#变量类型污染问题" class="headerlink" title="变量类型污染问题"></a>变量类型污染问题</h1><h2 id="js数据类型"><a href="#js数据类型" class="headerlink" title="js数据类型"></a>js数据类型</h2><p><strong>值类型(基本类型)</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">字符串，数字，布尔，对空，未定义，symbol(es6引入一种新的原始数据类型，表示独一无二的值)</span><br></pre></td></tr></table></figure>

<p><strong>引用数据类型</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">对象(object)，数组(array)，函数(function)</span><br></pre></td></tr></table></figure>

<p><strong>对象</strong><br>花括号分割，在括号内部，对象的属性以名称和值对的形式(name : value)来定义<br>属性由逗号分割:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">var person&#x3D;&#123;firstname:&quot;John&quot;,lastname:&quot;Doe&quot;&#125;</span><br><span class="line">此时对象person有三个属性，firstname,lastname</span><br></pre></td></tr></table></figure>

<p><strong>对象属性寻址方式</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name&#x3D;person.lastname;</span><br><span class="line">name&#x3D;person[&quot;lastname&quot;];</span><br></pre></td></tr></table></figure>

<h3 id="json可以发送的数据"><a href="#json可以发送的数据" class="headerlink" title="json可以发送的数据"></a>json可以发送的数据</h3><p>JSON 值可以是：</p>
<ul>
<li><p>数字（整数或浮点数）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">1 #typeof number</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串（在双引号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">&quot;a&quot;#typeof  string</span><br></pre></td></tr></table></figure>
</li>
<li><p>逻辑值（true 或 false）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">true#typeof boolean</span><br></pre></td></tr></table></figure>
</li>
<li><p>数组（在中括号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">[&quot;a&quot;,&quot;b&quot;]#typeof object</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象（在大括号中）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">&#123;&quot;name&quot;: &quot;Tom&quot;,&quot;Grade&quot;:1, &quot;age&quot;:11, &quot;gender&quot;: &quot;M&quot;&#125; #typeof object</span><br></pre></td></tr></table></figure>
</li>
<li><p>null</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">发送</span><br><span class="line">null#typeof object</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="加运算"><a href="#加运算" class="headerlink" title="加运算"></a>加运算</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">字符串+字符串依然得到字符串</span><br><span class="line">字符串+数组也是，其他都是</span><br><span class="line">但如果不是字符串相加，则为</span><br><span class="line">true+true&#x3D;2#因为true为1</span><br><span class="line">基本上除了Number+Number&#x3D;Number，Bool+Bool&#x3D;Number</span><br></pre></td></tr></table></figure>

<h3 id="js各种小trick"><a href="#js各种小trick" class="headerlink" title="js各种小trick"></a>js各种小trick</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">一个正数的负大数次方为0，负数的则为-0</span><br><span class="line">NaN和NaN不相等</span><br><span class="line">e++&lt;e--肯定满足；做比较时true为1,false为0</span><br><span class="line">任何非空字符串都为真,js中两个等号为弱类型判断</span><br><span class="line">string(大数)返回Infinity;json.parse()可以处理数字</span><br><span class="line">in对数组来说是判断数组的key</span><br><span class="line">括号json.parse()基本一样效果;json.parse()可以解析__proto__</span><br><span class="line">对null变量进行数组寻址会报错，并且null变量为object</span><br></pre></td></tr></table></figure>

<h1 id="javascript原型链污染"><a href="#javascript原型链污染" class="headerlink" title="javascript原型链污染"></a>javascript原型链污染</h1><h2 id="三种属性"><a href="#三种属性" class="headerlink" title="三种属性"></a>三种属性</h2><p>1.__proto__和constructor属性是对象所独有的:<br>2.prototype属性是函数所独有</p>
<p>但是由于JS中函数也是一种对象，所以函数也拥有__proto__和constructor属性</p>
<h3 id="proto"><a href="#proto" class="headerlink" title="__proto__"></a>__proto__</h3><p><strong>proto属性是对象所独有的</strong></p>
<p><strong>作用：</strong>当访问一个对象的属性时，如果该对象内部不存在这个属性，那么他就会去它的proto属性所指向的那个对象（理解为父对象），如果父对象也没有，则在往上找，如果一直到原型链顶端都没有该属性，就会报错</p>
<p>这种通过__proto__属性来连接对象直到null的一条链即为我们所谓的原型链。其实我们平时调用的字符串方法、数组方法、对象方法、函数方法等都是靠__proto__继承而来的。</p>
<h3 id="prototype属性"><a href="#prototype属性" class="headerlink" title="prototype属性"></a>prototype属性</h3><p>它是函数所独有的，是从函数指向对象，并且是函数的原型对象，也就是这个函数（其实所有函数都可以作为构造函数）所创建的实例的原型对象，由此可知</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">f1.__proto__&#x3D;&#x3D;Foo.prototype</span><br></pre></td></tr></table></figure>

<p>**作用:**包含可以由特定类型的所有实例所共享的属性和方法，也就是让该函数所实例化的对象们都可以找到公用的属性和方法，任何函数在创建的时候，其实会默认同时创建该函数的prototype对象</p>
<h3 id="constructor属性"><a href="#constructor属性" class="headerlink" title="constructor属性"></a>constructor属性</h3><p>它是对象才拥有的，他是从一个对象指向一个函数，含义就是指向该对象的构造函数，每个对象都有构造函数</p>
<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>eg:<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005134652.png" alt="img" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var a &#x3D; &#123;&#125;;</span><br><span class="line">console.log(a.__proto__); &#x2F;&#x2F;Object &#123;&#125;</span><br><span class="line">console.log(a.__proto__ &#x3D;&#x3D;&#x3D; a.constructor.prototype); &#x2F;&#x2F;true</span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>1.我们需要牢记两点：①__proto__和constructor属性是对象所独有的；②prototype属性是函数所独有的，因为函数也是一种对象，所以函数也拥有__proto__和constructor属性。</p>
<p>2.__proto__属性的作用就是当访问一个对象的属性时，如果该对象内部不存在这个属性，那么就会去它的__proto__属性所指向的那个对象（父对象）里找，一直找，直到__proto__属性的终点null，再往上找就相当于在null上取值，会报错。通过__proto__属性将对象连接起来的这条链路即我们所谓的原型链。</p>
<p>3.prototype属性的作用就是让该函数所实例化的对象们都可以找到公用的属性和方法，即f1.<strong>proto</strong> === Foo.prototype。(意思是让f1可以找到公用的属性方法，即向上找有prototype给他)</p>
<p>4.constructor属性的含义就是指向该对象的构造函数，所有函数（此时看成对象了）最终的构造函数都指向Function。</p>
<h1 id="javascript基础语法"><a href="#javascript基础语法" class="headerlink" title="javascript基础语法"></a>javascript基础语法</h1><h2 id="传输数据"><a href="#传输数据" class="headerlink" title="传输数据"></a>传输数据</h2><h3 id="1-req-params-req-query-req-body"><a href="#1-req-params-req-query-req-body" class="headerlink" title="1.req.params/req.query/req.body"></a>1.req.params/req.query/req.body</h3><p><strong>req.params</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:&#x2F;modify&#x2F;:file</span><br><span class="line">&#x2F;modify&#x2F;index</span><br><span class="line">那么req.params.file&#x3D;index</span><br></pre></td></tr></table></figure>

<p><strong>req.query</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">?id&#x3D;2</span><br><span class="line">那么req.query.id那么就可以得到2</span><br></pre></td></tr></table></figure>

<p><strong>req.body(针对post请求)</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">post:username&#x3D;adbc</span><br><span class="line">req.body.username&#x3D;adbc</span><br></pre></td></tr></table></figure>

<h2 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h2><p><strong><code>const</code>:</strong> 用于定义不可变变量<br>**<code>var</code> 声明语句<strong>声明一个变量，并可选地将其初始化为一个值<br>**<code>process.env</code></strong>:返回包含用户环境的对象</p>
</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/10/05/TSG2021/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">TSG2021+0ctf</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/09/30/%E7%BB%BF%E5%9F%8E%E6%9D%AF/"><span class="level-item">2021绿城杯</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Tlife</a><p class="is-size-7"><span>&copy; 2023 vague huang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>