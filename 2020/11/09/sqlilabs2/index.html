<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="sqlilabs2"><meta name="keywords" content="sql注入"><meta name="author" content="vague huang"><meta name="copyright" content="vague huang"><title>sqlilabs2 | Tlife</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlilabs%E7%AC%AC%E4%BA%94%E5%85%B3"><span class="toc-number">1.</span> <span class="toc-text">sqlilabs第五关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B2%E6%B3%A8%E6%9C%89%E4%B8%89%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">盲注有三类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E6%98%AFsql%E6%B3%A8%E5%85%A5%E6%88%AA%E5%8F%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">首先是sql注入截取字符串常用函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number"></span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%952"><span class="toc-number"></span> <span class="toc-text">方法2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#proxy-%E5%92%8C%E4%BB%A3%E7%90%86%E7%9B%B8%E5%85%B3"><span class="toc-number">1.</span> <span class="toc-text">proxy 和代理相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#intercept%E6%88%AA%E6%96%AD"><span class="toc-number">2.</span> <span class="toc-text">intercept截断</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Http-history-http%E8%AF%B7%E6%B1%82%E5%8E%86%E5%8F%B2"><span class="toc-number">2.1.</span> <span class="toc-text">Http history(http请求历史)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#websookets-history"><span class="toc-number">2.2.</span> <span class="toc-text">websookets history</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#options%EF%BC%88%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">options（配置选项）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Proxy-Listeners-%E4%BE%A6%E5%90%AC%E7%AB%AF%E5%8F%A3%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.1.</span> <span class="toc-text">Proxy Listeners(侦听端口设置)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E5%85%B3"><span class="toc-number">4.</span> <span class="toc-text">第六关</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">vague huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">203</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Tlife</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">sqlilabs2</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-11-09</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h3 id="sqlilabs第五关"><a href="#sqlilabs第五关" class="headerlink" title="sqlilabs第五关"></a>sqlilabs第五关</h3><p>这次的和之前四关就很不一样了，虽然还是单引号的字符型注入，但是</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201112180754.png" alt="img" style="zoom:50%;">

<p>这个you are in 就很尴尬，除了报错，不然都是you are in。。。。<br>所以要怎么办呢<br>这个时候就要知道什么叫盲注了                                    <a id="more"></a><br><strong>盲注</strong>就是在 sql 注入过程中，sql 语句执行的选择后，选择的数据不能回显 到前端页面。此时，我们需要利用一些方法进行判断或者尝试，这个过程称之为盲注</p>
<h4 id="盲注有三类"><a href="#盲注有三类" class="headerlink" title="盲注有三类"></a>盲注有三类</h4><p>•基于布尔 SQL 盲注<br>•基于时间的 SQL 盲注<br> •基于报错的 SQL 盲注<br>先从布尔sql盲注说起吧</p>
<h4 id="首先是sql注入截取字符串常用函数"><a href="#首先是sql注入截取字符串常用函数" class="headerlink" title="首先是sql注入截取字符串常用函数"></a>首先是sql注入截取字符串常用函数</h4><p><strong>首先是mid（）函数</strong><br><strong>此函数为截取字符串的一部分</strong><br><strong>语法</strong>：MID（column_name,start,[length]）</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201109201708.png" alt="img" style="zoom: 67%;">

<p>eg： str=”123456” mid(str,2,1)  结果为2</p>
<p>例子：</p>
<p>（1）MID(DATABASE(),1,1)&gt;’a’,查看数据库名第一位，MID(DATABASE(),2,1)查看数据库名第二位，依次查看各位字符。</p>
<p>（2）MID((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE  table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;’a’此处column_name参数可以为sql语句，可自行构造sql语句进行注入。</p>
<p><strong>substr()函数</strong><br>  Substr()和substring()函数实现的功能是一样的，均为截取字符串。<br>string substring(string, start, length)<br>string substr(string, start, length)<br><strong>参数描述同mid()函数</strong>，第一个参数为要处理的字符串，start为开始位置，length为截取的长度。<br>例子：<br>(1) substr(DATABASE(),1,1)&gt;’a’,查看数据库名第一位，substr(DATABASE(),2,1)查看数据库名第二位，依次查看各位字符。<br>(2) substr((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE T table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;’a’此处string参数可以为sql语句，可自行构造sql语句进行注入</p>
<p><strong>Left()函数</strong></p>
<p>Left()得到字符串左部指定个数的字符</p>
<p>Left ( string, n )    string为要截取的字符串，n为长度。</p>
<p>Sql用例：</p>
<p>(1) left(database(),1)&gt;’a’,查看数据库名第一位，left(database(),2)&gt;’ab’,查看数据库名前二位。</p>
<p>(2) 同样的string可以为自行构造的sql语句。</p>
<p> 同时也要介绍<strong>ORD()函数</strong>，此函数为返回第一个字符的ASCII码，经常与上面的函数进行组合使用。</p>
<p>例如ORD(MID(DATABASE(),1,1))&gt;114 意为检测database()的第一位ASCII码是否大于114，也即是‘r’<br>资料来源：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcamry/p/5504374.html">https://www.cnblogs.com/lcamry/p/5504374.html</a></p>
<p><strong>length()函数</strong><br>可以用来判断字符数<br>eg：length(database())&gt;5,这个数据库的名称是否大于五个字符<br>资料先放着吧，感觉还是要运用了记忆力会比较深<br>然后回到题目来：<br>此时我们使用length判断数据库名称的长短<br>使用指令and length(database())&gt;=8 画面返回</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201109204923.png" alt="img" style="zoom:50%;">

<p>但是当我 为and length (database())&gt;9的时候<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201109205105.png" alt="img" style="zoom:50%;"></p>
<p>返回了这玩意，说明是错的，也就是这个数据库的字符数是8，想一下我就觉得是security。<br>我们接下来去试试</p>
<h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><p><strong>substr((string, start&lt;,length&gt;)</strong></p>
<p>这里有一种方法是利用 substr(database(),1,1)=’s’  这个函数来一个个试</p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201109205401.png" alt="img" style="zoom:50%;">

<p>发现是可以的，说明第一个字母就是s，然后接下来继续去试，发现就是security</p>
<h2 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h2><p><strong>这里有一种方法是利用burp suite工具：</strong><br>下面是学习过程</p>
<h3 id="proxy-和代理相关"><a href="#proxy-和代理相关" class="headerlink" title="proxy 和代理相关"></a>proxy 和代理相关</h3><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111132418.png" alt="img" style="zoom:50%;">

<h3 id="intercept截断"><a href="#intercept截断" class="headerlink" title="intercept截断"></a>intercept截断</h3><p>默认Intercept is on 按钮出于开启状态 也就是说默认代理截断功能是打开的.此时所有的请求都会被截断,只有手动Forward之后请求才会被发出去<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111164906.png" alt="img" style="zoom:50%;"></p>
<h4 id="Http-history-http请求历史"><a href="#Http-history-http请求历史" class="headerlink" title="Http history(http请求历史)"></a>Http history(http请求历史)</h4><p>所有经过burp suite 的请求 都会被记录到http history中. 上面是请求概要信息 下面是请求详细信息</p>
<img src="file:///C:\Users\10452\AppData\Roaming\Tencent\Users\1045225639\QQ\WinTemp\RichOle\Z5PY{7PM8O]U[L45$NQF`BA.png" alt="img" style="zoom:50%;">

<h4 id="websookets-history"><a href="#websookets-history" class="headerlink" title="websookets history"></a>websookets history</h4><p>有的web时没有界面的，是用一个长链接 类似于api的方式来传输数据 burp suite也是可以截获这类信息的<br><strong>api</strong>是一个通道，是一个接口，负责一个程序和其他软件的沟通，本质是预先定义的函数，就是类似于预设。<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111170041.png" alt="img" style="zoom:50%;"></p>
<h3 id="options（配置选项）"><a href="#options（配置选项）" class="headerlink" title="options（配置选项）"></a>options（配置选项）</h3><h4 id="Proxy-Listeners-侦听端口设置"><a href="#Proxy-Listeners-侦听端口设置" class="headerlink" title="Proxy Listeners(侦听端口设置)"></a>Proxy Listeners(侦听端口设置)</h4><p><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111170332.png" alt="img"></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111170819.png" alt="img" style="zoom:50%;">
点击next 就会生成一张证书 选择路径保存. 然后导入到浏览器,就可以实现https的访问

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111170943.png" alt="img" style="zoom:50%;">
资料来自：https://www.cnblogs.com/php09/p/10412687.html
学习博客：https://blog.csdn.net/qq_35544379/article/details/76696106

<p>弄这个弄得我想吐，我在抓sqlilabs的本地包的时候，一直抓不到 ，我以为是burp的问题，原来是浏览器的问题，人傻了，我试了几个方法，好像修改火狐浏览器的一个高级选项是最有效的，这样你使用localhost输入的时候也可以抓到了</p>
<p>我发现一件事，我再用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and substr(database(),1,1)&#x3D;&#39;s&#39; --+</span><br></pre></td></tr></table></figure>

<p>这个语句的时候，我就在想，我首先知道这个数据库的名称有多长，然后对每个字母单独加一个burp里面的变量符，这样，我是不是就免去了一个个去试的麻烦呢？<br>接下来验证一下<br>根据前面我的做题，我们知道，这个数据库名字的长度肯定是8个字符<br><img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201111201319.png" alt="img" style="zoom:50%;"></p>
<p>首先是这样 然后<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201112180848.png" alt="img" style="zoom: 80%;"></p>
<p>先clear  再分别对每个a进行add  我发现这个方法是不行的，但是我的思路是OK的，因为我发现他有另外一个功能，我接下来直接放图就一目了然了<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201112180344.png" alt="img" style="zoom:50%;"></p>
<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201112180349.png" alt="img" style="zoom:50%;">

<img src="https://raw.githubusercontent.com/Hwwg/myphoto/master/20201112180355.png" alt="img" style="zoom:50%;">

<p>就这样，然后点击star attack就可以，但是我发现这个add from list中选择8个字母好像没有所有排序，所以。。。。。可能还有更好地方法？，那反正这一步大概就是这样了<br>接下来是判断他的库名：库名其实还是要使用<strong>substr</strong>来判断他的库名 其实就是在前三关查询的基础上 加了一个substr  语句是这样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; and substr((select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39;limit 0,1 ),1,1) &#x3D; &#39;e&#39; --+ &#x2F;&#x2F;这边有一点需要说明的是为什么需要加这个limit 0,1  我们知道一个库中可以有很多表，按我的理解是，你如果没有加这个limit0,1 那么数据库以为你要查询的数据数每个表的，也就是说这个语句变成，每个表的第一个字母是e，而不是我们想要的，第一个表的首字母为e。</span><br></pre></td></tr></table></figure>

<p>这边补充一下<strong>limit n,m</strong>的功能和意思<br>limit的使用格式为limit m,n，其中m是指记录开始的位置，从0开始，表示第一条记录，n是指取n条记录<br>例如：limit 0,1 表示从第一条记录开始，取一条记录，在上面那个语句中的意思就是，从第一个表开始取，去一个表的名称</p>
<p>localhost:81/sqli-labs-php7-master/Less-5/?id=1’ and substr((select table_name from information_schema.tables where table_schema=’security’ limit 0,1),1,1)=’e’ –+<br>然后根据之前的经验就是emails 其实也没啥太大区别，后续就是替换substr当中的语句，替换为<br>select column_name from information_schema.columns where table_name =’emails’</p>
<p>还有什么一个字符的就不多说了。<br>其实不一定要用substr 还有其他很多命令，我在下面的关卡看看能不能使用，不能使用的话，后续再整理</p>
<h3 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h3><p>确实和之前一样，但是这边是双引号的报错<br>解题思路和上一次一样，这次我们换换其他指令看看效果：<br>我去查了一下 报错函数是否都需要加and 我是没找到具体说明，但我看每个在使用的时候都有加一个and的<br>接下来我们先用<strong>left</strong><br>其实和substr也差不多，不过 left是规定从左边起，而substr还能规定从哪里开始从哪里结束<br>记代码一样打一下</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">vague huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2020/11/09/sqlilabs2/">http://example.com/2020/11/09/sqlilabs2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/11/16/sqlilabs-3/"><i class="fa fa-chevron-left">  </i><span>sqlilabs 3</span></a></div><div class="next-post pull-right"><a href="/2020/11/07/sqlilabs1/"><span>sqlilabs1</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By vague huang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>